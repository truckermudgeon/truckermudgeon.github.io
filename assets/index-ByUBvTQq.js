var kX=Object.defineProperty;var DX=(e,t,n)=>t in e?kX(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var zX=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var rz=(e,t,n)=>DX(e,typeof t!="symbol"?t+"":t,n);var lRe=zX(Zn=>{function v6(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var xP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oR(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function OX(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var y6={exports:{}},VS={},_6={exports:{}},vr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M_=Symbol.for("react.element"),FX=Symbol.for("react.portal"),NX=Symbol.for("react.fragment"),BX=Symbol.for("react.strict_mode"),UX=Symbol.for("react.profiler"),$X=Symbol.for("react.provider"),VX=Symbol.for("react.context"),jX=Symbol.for("react.forward_ref"),HX=Symbol.for("react.suspense"),GX=Symbol.for("react.memo"),WX=Symbol.for("react.lazy"),iz=Symbol.iterator;function qX(e){return e===null||typeof e!="object"?null:(e=iz&&e[iz]||e["@@iterator"],typeof e=="function"?e:null)}var x6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b6=Object.assign,w6={};function Ng(e,t,n){this.props=e,this.context=t,this.refs=w6,this.updater=n||x6}Ng.prototype.isReactComponent={};Ng.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ng.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function S6(){}S6.prototype=Ng.prototype;function sR(e,t,n){this.props=e,this.context=t,this.refs=w6,this.updater=n||x6}var aR=sR.prototype=new S6;aR.constructor=sR;b6(aR,Ng.prototype);aR.isPureReactComponent=!0;var oz=Array.isArray,M6=Object.prototype.hasOwnProperty,lR={current:null},C6={key:!0,ref:!0,__self:!0,__source:!0};function E6(e,t,n){var r,i={},a=null,c=null;if(t!=null)for(r in t.ref!==void 0&&(c=t.ref),t.key!==void 0&&(a=""+t.key),t)M6.call(t,r)&&!C6.hasOwnProperty(r)&&(i[r]=t[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var f=Array(o),g=0;g<o;g++)f[g]=arguments[g+2];i.children=f}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:M_,type:e,key:a,ref:c,props:i,_owner:lR.current}}function XX(e,t){return{$$typeof:M_,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function cR(e){return typeof e=="object"&&e!==null&&e.$$typeof===M_}function ZX(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var sz=/\/+/g;function jC(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ZX(""+e.key):t.toString(36)}function Ob(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var c=!1;if(e===null)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case M_:case FX:c=!0}}if(c)return c=e,i=i(c),e=r===""?"."+jC(c,0):r,oz(i)?(n="",e!=null&&(n=e.replace(sz,"$&/")+"/"),Ob(i,t,n,"",function(g){return g})):i!=null&&(cR(i)&&(i=XX(i,n+(!i.key||c&&c.key===i.key?"":(""+i.key).replace(sz,"$&/")+"/")+e)),t.push(i)),1;if(c=0,r=r===""?".":r+":",oz(e))for(var o=0;o<e.length;o++){a=e[o];var f=r+jC(a,o);c+=Ob(a,t,n,f,i)}else if(f=qX(e),typeof f=="function")for(e=f.call(e),o=0;!(a=e.next()).done;)a=a.value,f=r+jC(a,o++),c+=Ob(a,t,n,f,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function C1(e,t,n){if(e==null)return e;var r=[],i=0;return Ob(e,r,"","",function(a){return t.call(n,a,i++)}),r}function YX(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ss={current:null},Fb={transition:null},KX={ReactCurrentDispatcher:Ss,ReactCurrentBatchConfig:Fb,ReactCurrentOwner:lR};function T6(){throw Error("act(...) is not supported in production builds of React.")}vr.Children={map:C1,forEach:function(e,t,n){C1(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return C1(e,function(){t++}),t},toArray:function(e){return C1(e,function(t){return t})||[]},only:function(e){if(!cR(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};vr.Component=Ng;vr.Fragment=NX;vr.Profiler=UX;vr.PureComponent=sR;vr.StrictMode=BX;vr.Suspense=HX;vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KX;vr.act=T6;vr.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=b6({},e.props),i=e.key,a=e.ref,c=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,c=lR.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(f in t)M6.call(t,f)&&!C6.hasOwnProperty(f)&&(r[f]=t[f]===void 0&&o!==void 0?o[f]:t[f])}var f=arguments.length-2;if(f===1)r.children=n;else if(1<f){o=Array(f);for(var g=0;g<f;g++)o[g]=arguments[g+2];r.children=o}return{$$typeof:M_,type:e.type,key:i,ref:a,props:r,_owner:c}};vr.createContext=function(e){return e={$$typeof:VX,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:$X,_context:e},e.Consumer=e};vr.createElement=E6;vr.createFactory=function(e){var t=E6.bind(null,e);return t.type=e,t};vr.createRef=function(){return{current:null}};vr.forwardRef=function(e){return{$$typeof:jX,render:e}};vr.isValidElement=cR;vr.lazy=function(e){return{$$typeof:WX,_payload:{_status:-1,_result:e},_init:YX}};vr.memo=function(e,t){return{$$typeof:GX,type:e,compare:t===void 0?null:t}};vr.startTransition=function(e){var t=Fb.transition;Fb.transition={};try{e()}finally{Fb.transition=t}};vr.unstable_act=T6;vr.useCallback=function(e,t){return Ss.current.useCallback(e,t)};vr.useContext=function(e){return Ss.current.useContext(e)};vr.useDebugValue=function(){};vr.useDeferredValue=function(e){return Ss.current.useDeferredValue(e)};vr.useEffect=function(e,t){return Ss.current.useEffect(e,t)};vr.useId=function(){return Ss.current.useId()};vr.useImperativeHandle=function(e,t,n){return Ss.current.useImperativeHandle(e,t,n)};vr.useInsertionEffect=function(e,t){return Ss.current.useInsertionEffect(e,t)};vr.useLayoutEffect=function(e,t){return Ss.current.useLayoutEffect(e,t)};vr.useMemo=function(e,t){return Ss.current.useMemo(e,t)};vr.useReducer=function(e,t,n){return Ss.current.useReducer(e,t,n)};vr.useRef=function(e){return Ss.current.useRef(e)};vr.useState=function(e){return Ss.current.useState(e)};vr.useSyncExternalStore=function(e,t,n){return Ss.current.useSyncExternalStore(e,t,n)};vr.useTransition=function(){return Ss.current.useTransition()};vr.version="18.3.1";_6.exports=vr;var $=_6.exports;const ty=oR($),bP=v6({__proto__:null,default:ty},[$]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JX=$,QX=Symbol.for("react.element"),eZ=Symbol.for("react.fragment"),tZ=Object.prototype.hasOwnProperty,nZ=JX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rZ={key:!0,ref:!0,__self:!0,__source:!0};function P6(e,t,n){var r,i={},a=null,c=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(c=t.ref);for(r in t)tZ.call(t,r)&&!rZ.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:QX,type:e,key:a,ref:c,props:i,_owner:nZ.current}}VS.Fragment=eZ;VS.jsx=P6;VS.jsxs=P6;y6.exports=VS;var ee=y6.exports;const l0={grey:{50:"#FBFCFE",100:"#F0F4F8",200:"#DDE7EE",300:"#CDD7E1",400:"#9FA6AD",500:"#636B74",600:"#555E68",700:"#32383E",800:"#171A1C",900:"#0B0D0E"},blue:{50:"#EDF5FD",100:"#E3EFFB",200:"#C7DFF7",300:"#97C3F0",400:"#4393E4",500:"#0B6BCB",600:"#185EA5",700:"#12467B",800:"#0A2744",900:"#051423"},yellow:{50:"#FEFAF6",100:"#FDF0E1",200:"#FCE1C2",300:"#F3C896",400:"#EA9A3E",500:"#9A5B13",600:"#72430D",700:"#492B08",800:"#2E1B05",900:"#1D1002"},red:{50:"#FEF6F6",100:"#FCE4E4",200:"#F7C5C5",300:"#F09898",400:"#E47474",500:"#C41C1C",600:"#A51818",700:"#7D1212",800:"#430A0A",900:"#240505"},green:{50:"#F6FEF6",100:"#E3FBE3",200:"#C7F7C7",300:"#A1E8A1",400:"#51BC51",500:"#1F7A1F",600:"#136C13",700:"#0A470A",800:"#042F04",900:"#021D02"}},C_="$$joy";function Fy(e){let t="https://mui.com/production-error/?code="+e;for(let n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ue.apply(null,arguments)}var iZ=!1;function oZ(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function sZ(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var aZ=function(){function e(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?r.insertionPoint?a=r.insertionPoint.nextSibling:r.prepend?a=r.container.firstChild:a=r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!iZ:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(sZ(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=oZ(i);try{a.insertRule(r,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){var i;return(i=r.parentNode)==null?void 0:i.removeChild(r)}),this.tags=[],this.ctr=0},e}(),ss="-ms-",Ew="-moz-",Rr="-webkit-",A6="comm",uR="rule",hR="decl",lZ="@import",I6="@keyframes",cZ="@layer",uZ=Math.abs,jS=String.fromCharCode,hZ=Object.assign;function dZ(e,t){return Bo(e,0)^45?(((t<<2^Bo(e,0))<<2^Bo(e,1))<<2^Bo(e,2))<<2^Bo(e,3):0}function R6(e){return e.trim()}function fZ(e,t){return(e=t.exec(e))?e[0]:e}function Lr(e,t,n){return e.replace(t,n)}function wP(e,t){return e.indexOf(t)}function Bo(e,t){return e.charCodeAt(t)|0}function Ny(e,t,n){return e.slice(t,n)}function ac(e){return e.length}function dR(e){return e.length}function E1(e,t){return t.push(e),e}function pZ(e,t){return e.map(t).join("")}var HS=1,dg=1,L6=0,Ws=0,Qi=0,Bg="";function GS(e,t,n,r,i,a,c){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:HS,column:dg,length:c,return:""}}function c0(e,t){return hZ(GS("",null,null,"",null,null,0),e,{length:-e.length},t)}function mZ(){return Qi}function gZ(){return Qi=Ws>0?Bo(Bg,--Ws):0,dg--,Qi===10&&(dg=1,HS--),Qi}function xa(){return Qi=Ws<L6?Bo(Bg,Ws++):0,dg++,Qi===10&&(dg=1,HS++),Qi}function pc(){return Bo(Bg,Ws)}function Nb(){return Ws}function E_(e,t){return Ny(Bg,e,t)}function By(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function k6(e){return HS=dg=1,L6=ac(Bg=e),Ws=0,[]}function D6(e){return Bg="",e}function Bb(e){return R6(E_(Ws-1,SP(e===91?e+2:e===40?e+1:e)))}function vZ(e){for(;(Qi=pc())&&Qi<33;)xa();return By(e)>2||By(Qi)>3?"":" "}function yZ(e,t){for(;--t&&xa()&&!(Qi<48||Qi>102||Qi>57&&Qi<65||Qi>70&&Qi<97););return E_(e,Nb()+(t<6&&pc()==32&&xa()==32))}function SP(e){for(;xa();)switch(Qi){case e:return Ws;case 34:case 39:e!==34&&e!==39&&SP(Qi);break;case 40:e===41&&SP(e);break;case 92:xa();break}return Ws}function _Z(e,t){for(;xa()&&e+Qi!==57;)if(e+Qi===84&&pc()===47)break;return"/*"+E_(t,Ws-1)+"*"+jS(e===47?e:xa())}function xZ(e){for(;!By(pc());)xa();return E_(e,Ws)}function bZ(e){return D6(Ub("",null,null,null,[""],e=k6(e),0,[0],e))}function Ub(e,t,n,r,i,a,c,o,f){for(var g=0,_=0,x=c,M=0,C=0,A=0,L=1,I=1,T=1,z=0,k="",U=i,H=a,V=r,q=k;I;)switch(A=z,z=xa()){case 40:if(A!=108&&Bo(q,x-1)==58){wP(q+=Lr(Bb(z),"&","&\f"),"&\f")!=-1&&(T=-1);break}case 34:case 39:case 91:q+=Bb(z);break;case 9:case 10:case 13:case 32:q+=vZ(A);break;case 92:q+=yZ(Nb()-1,7);continue;case 47:switch(pc()){case 42:case 47:E1(wZ(_Z(xa(),Nb()),t,n),f);break;default:q+="/"}break;case 123*L:o[g++]=ac(q)*T;case 125*L:case 59:case 0:switch(z){case 0:case 125:I=0;case 59+_:T==-1&&(q=Lr(q,/\f/g,"")),C>0&&ac(q)-x&&E1(C>32?lz(q+";",r,n,x-1):lz(Lr(q," ","")+";",r,n,x-2),f);break;case 59:q+=";";default:if(E1(V=az(q,t,n,g,_,i,o,k,U=[],H=[],x),a),z===123)if(_===0)Ub(q,t,V,V,U,a,x,o,H);else switch(M===99&&Bo(q,3)===110?100:M){case 100:case 108:case 109:case 115:Ub(e,V,V,r&&E1(az(e,V,V,0,0,i,o,k,i,U=[],x),H),i,H,x,o,r?U:H);break;default:Ub(q,V,V,V,[""],H,0,o,H)}}g=_=C=0,L=T=1,k=q="",x=c;break;case 58:x=1+ac(q),C=A;default:if(L<1){if(z==123)--L;else if(z==125&&L++==0&&gZ()==125)continue}switch(q+=jS(z),z*L){case 38:T=_>0?1:(q+="\f",-1);break;case 44:o[g++]=(ac(q)-1)*T,T=1;break;case 64:pc()===45&&(q+=Bb(xa())),M=pc(),_=x=ac(k=q+=xZ(Nb())),z++;break;case 45:A===45&&ac(q)==2&&(L=0)}}return a}function az(e,t,n,r,i,a,c,o,f,g,_){for(var x=i-1,M=i===0?a:[""],C=dR(M),A=0,L=0,I=0;A<r;++A)for(var T=0,z=Ny(e,x+1,x=uZ(L=c[A])),k=e;T<C;++T)(k=R6(L>0?M[T]+" "+z:Lr(z,/&\f/g,M[T])))&&(f[I++]=k);return GS(e,t,n,i===0?uR:o,f,g,_)}function wZ(e,t,n){return GS(e,t,n,A6,jS(mZ()),Ny(e,2,-2),0)}function lz(e,t,n,r){return GS(e,t,n,hR,Ny(e,0,r),Ny(e,r+1,-1),r)}function Wm(e,t){for(var n="",r=dR(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function SZ(e,t,n,r){switch(e.type){case cZ:if(e.children.length)break;case lZ:case hR:return e.return=e.return||e.value;case A6:return"";case I6:return e.return=e.value+"{"+Wm(e.children,r)+"}";case uR:e.value=e.props.join(",")}return ac(n=Wm(e.children,r))?e.return=e.value+"{"+n+"}":""}function MZ(e){var t=dR(e);return function(n,r,i,a){for(var c="",o=0;o<t;o++)c+=e[o](n,r,i,a)||"";return c}}function CZ(e){return function(t){t.root||(t=t.return)&&e(t)}}function z6(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var EZ=function(t,n,r){for(var i=0,a=0;i=a,a=pc(),i===38&&a===12&&(n[r]=1),!By(a);)xa();return E_(t,Ws)},TZ=function(t,n){var r=-1,i=44;do switch(By(i)){case 0:i===38&&pc()===12&&(n[r]=1),t[r]+=EZ(Ws-1,n,r);break;case 2:t[r]+=Bb(i);break;case 4:if(i===44){t[++r]=pc()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=jS(i)}while(i=xa());return t},PZ=function(t,n){return D6(TZ(k6(t),n))},cz=new WeakMap,AZ=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,r=t.parent,i=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!cz.get(r))&&!i){cz.set(t,!0);for(var a=[],c=PZ(n,a),o=r.props,f=0,g=0;f<c.length;f++)for(var _=0;_<o.length;_++,g++)t.props[g]=a[f]?c[f].replace(/&\f/g,o[_]):o[_]+" "+c[f]}}},IZ=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function O6(e,t){switch(dZ(e,t)){case 5103:return Rr+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Rr+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Rr+e+Ew+e+ss+e+e;case 6828:case 4268:return Rr+e+ss+e+e;case 6165:return Rr+e+ss+"flex-"+e+e;case 5187:return Rr+e+Lr(e,/(\w+).+(:[^]+)/,Rr+"box-$1$2"+ss+"flex-$1$2")+e;case 5443:return Rr+e+ss+"flex-item-"+Lr(e,/flex-|-self/,"")+e;case 4675:return Rr+e+ss+"flex-line-pack"+Lr(e,/align-content|flex-|-self/,"")+e;case 5548:return Rr+e+ss+Lr(e,"shrink","negative")+e;case 5292:return Rr+e+ss+Lr(e,"basis","preferred-size")+e;case 6060:return Rr+"box-"+Lr(e,"-grow","")+Rr+e+ss+Lr(e,"grow","positive")+e;case 4554:return Rr+Lr(e,/([^-])(transform)/g,"$1"+Rr+"$2")+e;case 6187:return Lr(Lr(Lr(e,/(zoom-|grab)/,Rr+"$1"),/(image-set)/,Rr+"$1"),e,"")+e;case 5495:case 3959:return Lr(e,/(image-set\([^]*)/,Rr+"$1$`$1");case 4968:return Lr(Lr(e,/(.+:)(flex-)?(.*)/,Rr+"box-pack:$3"+ss+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Rr+e+e;case 4095:case 3583:case 4068:case 2532:return Lr(e,/(.+)-inline(.+)/,Rr+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ac(e)-1-t>6)switch(Bo(e,t+1)){case 109:if(Bo(e,t+4)!==45)break;case 102:return Lr(e,/(.+:)(.+)-([^]+)/,"$1"+Rr+"$2-$3$1"+Ew+(Bo(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~wP(e,"stretch")?O6(Lr(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Bo(e,t+1)!==115)break;case 6444:switch(Bo(e,ac(e)-3-(~wP(e,"!important")&&10))){case 107:return Lr(e,":",":"+Rr)+e;case 101:return Lr(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Rr+(Bo(e,14)===45?"inline-":"")+"box$3$1"+Rr+"$2$3$1"+ss+"$2box$3")+e}break;case 5936:switch(Bo(e,t+11)){case 114:return Rr+e+ss+Lr(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Rr+e+ss+Lr(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Rr+e+ss+Lr(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Rr+e+ss+e+e}return e}var RZ=function(t,n,r,i){if(t.length>-1&&!t.return)switch(t.type){case hR:t.return=O6(t.value,t.length);break;case I6:return Wm([c0(t,{value:Lr(t.value,"@","@"+Rr)})],i);case uR:if(t.length)return pZ(t.props,function(a){switch(fZ(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Wm([c0(t,{props:[Lr(a,/:(read-\w+)/,":"+Ew+"$1")]})],i);case"::placeholder":return Wm([c0(t,{props:[Lr(a,/:(plac\w+)/,":"+Rr+"input-$1")]}),c0(t,{props:[Lr(a,/:(plac\w+)/,":"+Ew+"$1")]}),c0(t,{props:[Lr(a,/:(plac\w+)/,ss+"input-$1")]})],i)}return""})}},LZ=[RZ],kZ=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(L){var I=L.getAttribute("data-emotion");I.indexOf(" ")!==-1&&(document.head.appendChild(L),L.setAttribute("data-s",""))})}var i=t.stylisPlugins||LZ,a={},c,o=[];c=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(L){for(var I=L.getAttribute("data-emotion").split(" "),T=1;T<I.length;T++)a[I[T]]=!0;o.push(L)});var f,g=[AZ,IZ];{var _,x=[SZ,CZ(function(L){_.insert(L)})],M=MZ(g.concat(i,x)),C=function(I){return Wm(bZ(I),M)};f=function(I,T,z,k){_=z,C(I?I+"{"+T.styles+"}":T.styles),k&&(A.inserted[T.name]=!0)}}var A={key:n,sheet:new aZ({key:n,container:c,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:a,registered:{},insert:f};return A.sheet.hydrate(o),A},F6={exports:{}},Hr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ao=typeof Symbol=="function"&&Symbol.for,fR=Ao?Symbol.for("react.element"):60103,pR=Ao?Symbol.for("react.portal"):60106,WS=Ao?Symbol.for("react.fragment"):60107,qS=Ao?Symbol.for("react.strict_mode"):60108,XS=Ao?Symbol.for("react.profiler"):60114,ZS=Ao?Symbol.for("react.provider"):60109,YS=Ao?Symbol.for("react.context"):60110,mR=Ao?Symbol.for("react.async_mode"):60111,KS=Ao?Symbol.for("react.concurrent_mode"):60111,JS=Ao?Symbol.for("react.forward_ref"):60112,QS=Ao?Symbol.for("react.suspense"):60113,DZ=Ao?Symbol.for("react.suspense_list"):60120,eM=Ao?Symbol.for("react.memo"):60115,tM=Ao?Symbol.for("react.lazy"):60116,zZ=Ao?Symbol.for("react.block"):60121,OZ=Ao?Symbol.for("react.fundamental"):60117,FZ=Ao?Symbol.for("react.responder"):60118,NZ=Ao?Symbol.for("react.scope"):60119;function Pa(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case fR:switch(e=e.type,e){case mR:case KS:case WS:case XS:case qS:case QS:return e;default:switch(e=e&&e.$$typeof,e){case YS:case JS:case tM:case eM:case ZS:return e;default:return t}}case pR:return t}}}function N6(e){return Pa(e)===KS}Hr.AsyncMode=mR;Hr.ConcurrentMode=KS;Hr.ContextConsumer=YS;Hr.ContextProvider=ZS;Hr.Element=fR;Hr.ForwardRef=JS;Hr.Fragment=WS;Hr.Lazy=tM;Hr.Memo=eM;Hr.Portal=pR;Hr.Profiler=XS;Hr.StrictMode=qS;Hr.Suspense=QS;Hr.isAsyncMode=function(e){return N6(e)||Pa(e)===mR};Hr.isConcurrentMode=N6;Hr.isContextConsumer=function(e){return Pa(e)===YS};Hr.isContextProvider=function(e){return Pa(e)===ZS};Hr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===fR};Hr.isForwardRef=function(e){return Pa(e)===JS};Hr.isFragment=function(e){return Pa(e)===WS};Hr.isLazy=function(e){return Pa(e)===tM};Hr.isMemo=function(e){return Pa(e)===eM};Hr.isPortal=function(e){return Pa(e)===pR};Hr.isProfiler=function(e){return Pa(e)===XS};Hr.isStrictMode=function(e){return Pa(e)===qS};Hr.isSuspense=function(e){return Pa(e)===QS};Hr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===WS||e===KS||e===XS||e===qS||e===QS||e===DZ||typeof e=="object"&&e!==null&&(e.$$typeof===tM||e.$$typeof===eM||e.$$typeof===ZS||e.$$typeof===YS||e.$$typeof===JS||e.$$typeof===OZ||e.$$typeof===FZ||e.$$typeof===NZ||e.$$typeof===zZ)};Hr.typeOf=Pa;F6.exports=Hr;var BZ=F6.exports,B6=BZ,UZ={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},$Z={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},U6={};U6[B6.ForwardRef]=UZ;U6[B6.Memo]=$Z;var VZ=!0;function $6(e,t,n){var r="";return n.split(" ").forEach(function(i){e[i]!==void 0?t.push(e[i]+";"):i&&(r+=i+" ")}),r}var gR=function(t,n,r){var i=t.key+"-"+n.name;(r===!1||VZ===!1)&&t.registered[i]===void 0&&(t.registered[i]=n.styles)},vR=function(t,n,r){gR(t,n,r);var i=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var a=n;do t.insert(n===a?"."+i:"",a,t.sheet,!0),a=a.next;while(a!==void 0)}};function jZ(e){for(var t=0,n,r=0,i=e.length;i>=4;++r,i-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(i){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var HZ={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},GZ=/[A-Z]|^ms/g,WZ=/_EMO_([^_]+?)_([^]*?)_EMO_/g,V6=function(t){return t.charCodeAt(1)===45},uz=function(t){return t!=null&&typeof t!="boolean"},HC=z6(function(e){return V6(e)?e:e.replace(GZ,"-$&").toLowerCase()}),hz=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(WZ,function(r,i,a){return lc={name:i,styles:a,next:lc},i})}return HZ[t]!==1&&!V6(t)&&typeof n=="number"&&n!==0?n+"px":n};function Uy(e,t,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var i=n;if(i.anim===1)return lc={name:i.name,styles:i.styles,next:lc},i.name;var a=n;if(a.styles!==void 0){var c=a.next;if(c!==void 0)for(;c!==void 0;)lc={name:c.name,styles:c.styles,next:lc},c=c.next;var o=a.styles+";";return o}return qZ(e,t,n)}case"function":{if(e!==void 0){var f=lc,g=n(e);return lc=f,Uy(e,t,g)}break}}var _=n;if(t==null)return _;var x=t[_];return x!==void 0?x:_}function qZ(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=Uy(e,t,n[i])+";";else for(var a in n){var c=n[a];if(typeof c!="object"){var o=c;t!=null&&t[o]!==void 0?r+=a+"{"+t[o]+"}":uz(o)&&(r+=HC(a)+":"+hz(a,o)+";")}else if(Array.isArray(c)&&typeof c[0]=="string"&&(t==null||t[c[0]]===void 0))for(var f=0;f<c.length;f++)uz(c[f])&&(r+=HC(a)+":"+hz(a,c[f])+";");else{var g=Uy(e,t,c);switch(a){case"animation":case"animationName":{r+=HC(a)+":"+g+";";break}default:r+=a+"{"+g+"}"}}}return r}var dz=/label:\s*([^\s;{]+)\s*(;|$)/g,lc;function T_(e,t,n){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,i="";lc=void 0;var a=e[0];if(a==null||a.raw===void 0)r=!1,i+=Uy(n,t,a);else{var c=a;i+=c[0]}for(var o=1;o<e.length;o++)if(i+=Uy(n,t,e[o]),r){var f=a;i+=f[o]}dz.lastIndex=0;for(var g="",_;(_=dz.exec(i))!==null;)g+="-"+_[1];var x=jZ(i)+g;return{name:x,styles:i,next:lc}}var XZ=function(t){return t()},j6=bP.useInsertionEffect?bP.useInsertionEffect:!1,H6=j6||XZ,fz=j6||$.useLayoutEffect,ZZ=!1,G6=$.createContext(typeof HTMLElement<"u"?kZ({key:"css"}):null);G6.Provider;var yR=function(t){return $.forwardRef(function(n,r){var i=$.useContext(G6);return t(n,i,r)})},P_=$.createContext({}),_R={}.hasOwnProperty,MP="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",YZ=function(t,n){var r={};for(var i in n)_R.call(n,i)&&(r[i]=n[i]);return r[MP]=t,r},KZ=function(t){var n=t.cache,r=t.serialized,i=t.isStringTag;return gR(n,r,i),H6(function(){return vR(n,r,i)}),null},JZ=yR(function(e,t,n){var r=e.css;typeof r=="string"&&t.registered[r]!==void 0&&(r=t.registered[r]);var i=e[MP],a=[r],c="";typeof e.className=="string"?c=$6(t.registered,a,e.className):e.className!=null&&(c=e.className+" ");var o=T_(a,void 0,$.useContext(P_));c+=t.key+"-"+o.name;var f={};for(var g in e)_R.call(e,g)&&g!=="css"&&g!==MP&&!ZZ&&(f[g]=e[g]);return f.className=c,n&&(f.ref=n),$.createElement($.Fragment,null,$.createElement(KZ,{cache:t,serialized:o,isStringTag:typeof i=="string"}),$.createElement(i,f))}),QZ=JZ,eY=function(t,n){var r=arguments;if(n==null||!_R.call(n,"css"))return $.createElement.apply(void 0,r);var i=r.length,a=new Array(i);a[0]=QZ,a[1]=YZ(t,n);for(var c=2;c<i;c++)a[c]=r[c];return $.createElement.apply(null,a)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(eY);var tY=yR(function(e,t){var n=e.styles,r=T_([n],void 0,$.useContext(P_)),i=$.useRef();return fz(function(){var a=t.key+"-global",c=new t.sheet.constructor({key:a,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),o=!1,f=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return t.sheet.tags.length&&(c.before=t.sheet.tags[0]),f!==null&&(o=!0,f.setAttribute("data-emotion",a),c.hydrate([f])),i.current=[c,o],function(){c.flush()}},[t]),fz(function(){var a=i.current,c=a[0],o=a[1];if(o){a[1]=!1;return}if(r.next!==void 0&&vR(t,r.next,!0),c.tags.length){var f=c.tags[c.tags.length-1].nextElementSibling;c.before=f,c.flush()}t.insert("",r,c,!1)},[t,r.name]),null});function W6(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return T_(t)}function xR(){var e=W6.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var nY=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,rY=z6(function(e){return nY.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),iY=rY,oY=function(t){return t!=="theme"},pz=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?iY:oY},mz=function(t,n,r){var i;if(n){var a=n.shouldForwardProp;i=t.__emotion_forwardProp&&a?function(c){return t.__emotion_forwardProp(c)&&a(c)}:a}return typeof i!="function"&&r&&(i=t.__emotion_forwardProp),i},sY=function(t){var n=t.cache,r=t.serialized,i=t.isStringTag;return gR(n,r,i),H6(function(){return vR(n,r,i)}),null},aY=function e(t,n){var r=t.__emotion_real===t,i=r&&t.__emotion_base||t,a,c;n!==void 0&&(a=n.label,c=n.target);var o=mz(t,n,r),f=o||pz(i),g=!f("as");return function(){var _=arguments,x=r&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(a!==void 0&&x.push("label:"+a+";"),_[0]==null||_[0].raw===void 0)x.push.apply(x,_);else{var M=_[0];x.push(M[0]);for(var C=_.length,A=1;A<C;A++)x.push(_[A],M[A])}var L=yR(function(I,T,z){var k=g&&I.as||i,U="",H=[],V=I;if(I.theme==null){V={};for(var q in I)V[q]=I[q];V.theme=$.useContext(P_)}typeof I.className=="string"?U=$6(T.registered,H,I.className):I.className!=null&&(U=I.className+" ");var J=T_(x.concat(H),T.registered,V);U+=T.key+"-"+J.name,c!==void 0&&(U+=" "+c);var Y=g&&o===void 0?pz(k):f,N={};for(var ne in I)g&&ne==="as"||Y(ne)&&(N[ne]=I[ne]);return N.className=U,z&&(N.ref=z),$.createElement($.Fragment,null,$.createElement(sY,{cache:T,serialized:J,isStringTag:typeof k=="string"}),$.createElement(k,N))});return L.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",L.defaultProps=t.defaultProps,L.__emotion_real=L,L.__emotion_base=i,L.__emotion_styles=x,L.__emotion_forwardProp=o,Object.defineProperty(L,"toString",{value:function(){return"."+c}}),L.withComponent=function(I,T){var z=e(I,ue({},n,T,{shouldForwardProp:mz(L,T,!0)}));return z.apply(void 0,x)},L}},lY=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Tw=aY.bind(null);lY.forEach(function(e){Tw[e]=Tw(e)});function cY(e){return e==null||Object.keys(e).length===0}function $b(e){const{styles:t,defaultTheme:n={}}=e,r=typeof t=="function"?i=>t(cY(i)?n:i):t;return ee.jsx(tY,{styles:r})}function q6(e,t){return Tw(e,t)}const uY=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))};function Un(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function fh(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function X6(e){if($.isValidElement(e)||!fh(e))return e;const t={};return Object.keys(e).forEach(n=>{t[n]=X6(e[n])}),t}function ba(e,t,n={clone:!0}){const r=n.clone?ue({},e):e;return fh(e)&&fh(t)&&Object.keys(t).forEach(i=>{$.isValidElement(t[i])?r[i]=t[i]:fh(t[i])&&Object.prototype.hasOwnProperty.call(e,i)&&fh(e[i])?r[i]=ba(e[i],t[i],n):n.clone?r[i]=fh(t[i])?X6(t[i]):t[i]:r[i]=t[i]}),r}const hY=["values","unit","step"],dY=e=>{const t=Object.keys(e).map(n=>({key:n,val:e[n]}))||[];return t.sort((n,r)=>n.val-r.val),t.reduce((n,r)=>ue({},n,{[r.key]:r.val}),{})};function Z6(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=e,i=Un(e,hY),a=dY(t),c=Object.keys(a);function o(M){return`@media (min-width:${typeof t[M]=="number"?t[M]:M}${n})`}function f(M){return`@media (max-width:${(typeof t[M]=="number"?t[M]:M)-r/100}${n})`}function g(M,C){const A=c.indexOf(C);return`@media (min-width:${typeof t[M]=="number"?t[M]:M}${n}) and (max-width:${(A!==-1&&typeof t[c[A]]=="number"?t[c[A]]:C)-r/100}${n})`}function _(M){return c.indexOf(M)+1<c.length?g(M,c[c.indexOf(M)+1]):o(M)}function x(M){const C=c.indexOf(M);return C===0?o(c[1]):C===c.length-1?f(c[C]):g(M,c[c.indexOf(M)+1]).replace("@media","@media not all and")}return ue({keys:c,values:a,up:o,down:f,between:g,only:_,not:x,unit:n},i)}const fY={borderRadius:4};function ny(e,t){return t?ba(e,t,{clone:!1}):e}const bR={xs:0,sm:600,md:900,lg:1200,xl:1536},gz={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${bR[e]}px)`};function kl(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const a=r.breakpoints||gz;return t.reduce((c,o,f)=>(c[a.up(a.keys[f])]=n(t[f]),c),{})}if(typeof t=="object"){const a=r.breakpoints||gz;return Object.keys(t).reduce((c,o)=>{if(Object.keys(a.values||bR).indexOf(o)!==-1){const f=a.up(o);c[f]=n(t[o],o)}else{const f=o;c[f]=t[f]}return c},{})}return n(t)}function Y6(e={}){var t;return((t=e.keys)==null?void 0:t.reduce((r,i)=>{const a=e.up(i);return r[a]={},r},{}))||{}}function K6(e,t){return e.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},t)}function pY(e,...t){const n=Y6(e),r=[n,...t].reduce((i,a)=>ba(i,a),{});return K6(Object.keys(n),r)}function mY(e,t){if(typeof e!="object")return{};const n={},r=Object.keys(t);return Array.isArray(e)?r.forEach((i,a)=>{a<e.length&&(n[i]=!0)}):r.forEach(i=>{e[i]!=null&&(n[i]=!0)}),n}function GC({values:e,breakpoints:t,base:n}){const r=n||mY(e,t),i=Object.keys(r);if(i.length===0)return e;let a;return i.reduce((c,o,f)=>(Array.isArray(e)?(c[o]=e[f]!=null?e[f]:e[a],a=f):typeof e=="object"?(c[o]=e[o]!=null?e[o]:e[a],a=o):c[o]=e,c),{})}function mn(e){if(typeof e!="string")throw new Error(Fy(7));return e.charAt(0).toUpperCase()+e.slice(1)}function Nh(e,t,n=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&n){const r=`vars.${t}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,e);if(r!=null)return r}return t.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,e)}function Pw(e,t,n,r=n){let i;return typeof e=="function"?i=e(n):Array.isArray(e)?i=e[n]||r:i=Nh(e,n)||r,t&&(i=t(i,r,e)),i}function Bi(e){const{prop:t,cssProperty:n=e.prop,themeKey:r,transform:i}=e,a=c=>{if(c[t]==null)return null;const o=c[t],f=c.theme,g=Nh(f,r)||{};return kl(c,o,x=>{let M=Pw(g,i,x);return x===M&&typeof x=="string"&&(M=Pw(g,i,`${t}${x==="default"?"":mn(x)}`,x)),n===!1?M:{[n]:M}})};return a.propTypes={},a.filterProps=[t],a}function gY(e){const t={};return n=>(t[n]===void 0&&(t[n]=e(n)),t[n])}const vY={m:"margin",p:"padding"},yY={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},vz={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},_Y=gY(e=>{if(e.length>2)if(vz[e])e=vz[e];else return[e];const[t,n]=e.split(""),r=vY[t],i=yY[n]||"";return Array.isArray(i)?i.map(a=>r+a):[r+i]}),wR=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],SR=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...wR,...SR];function A_(e,t,n,r){var i;const a=(i=Nh(e,t,!1))!=null?i:n;return typeof a=="number"?c=>typeof c=="string"?c:a*c:Array.isArray(a)?c=>typeof c=="string"?c:a[c]:typeof a=="function"?a:()=>{}}function MR(e){return A_(e,"spacing",8)}function Af(e,t){if(typeof t=="string"||t==null)return t;const n=Math.abs(t),r=e(n);return t>=0?r:typeof r=="number"?-r:`-${r}`}function xY(e,t){return n=>e.reduce((r,i)=>(r[i]=Af(t,n),r),{})}function bY(e,t,n,r){if(t.indexOf(n)===-1)return null;const i=_Y(n),a=xY(i,r),c=e[n];return kl(e,c,a)}function J6(e,t){const n=MR(e.theme);return Object.keys(e).map(r=>bY(e,t,r,n)).reduce(ny,{})}function Ci(e){return J6(e,wR)}Ci.propTypes={};Ci.filterProps=wR;function Ei(e){return J6(e,SR)}Ei.propTypes={};Ei.filterProps=SR;function Q6(e=8){if(e.mui)return e;const t=MR({spacing:e}),n=(...r)=>(r.length===0?[1]:r).map(a=>{const c=t(a);return typeof c=="number"?`${c}px`:c}).join(" ");return n.mui=!0,n}function nM(...e){const t=e.reduce((r,i)=>(i.filterProps.forEach(a=>{r[a]=i}),r),{}),n=r=>Object.keys(r).reduce((i,a)=>t[a]?ny(i,t[a](r)):i,{});return n.propTypes={},n.filterProps=e.reduce((r,i)=>r.concat(i.filterProps),[]),n}function $a(e){return typeof e!="number"?e:`${e}px solid`}function el(e,t){return Bi({prop:e,themeKey:"borders",transform:t})}const wY=el("border",$a),SY=el("borderTop",$a),MY=el("borderRight",$a),CY=el("borderBottom",$a),EY=el("borderLeft",$a),TY=el("borderColor"),PY=el("borderTopColor"),AY=el("borderRightColor"),IY=el("borderBottomColor"),RY=el("borderLeftColor"),LY=el("outline",$a),kY=el("outlineColor"),rM=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=A_(e.theme,"shape.borderRadius",4),n=r=>({borderRadius:Af(t,r)});return kl(e,e.borderRadius,n)}return null};rM.propTypes={};rM.filterProps=["borderRadius"];nM(wY,SY,MY,CY,EY,TY,PY,AY,IY,RY,rM,LY,kY);const iM=e=>{if(e.gap!==void 0&&e.gap!==null){const t=A_(e.theme,"spacing",8),n=r=>({gap:Af(t,r)});return kl(e,e.gap,n)}return null};iM.propTypes={};iM.filterProps=["gap"];const oM=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=A_(e.theme,"spacing",8),n=r=>({columnGap:Af(t,r)});return kl(e,e.columnGap,n)}return null};oM.propTypes={};oM.filterProps=["columnGap"];const sM=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=A_(e.theme,"spacing",8),n=r=>({rowGap:Af(t,r)});return kl(e,e.rowGap,n)}return null};sM.propTypes={};sM.filterProps=["rowGap"];const DY=Bi({prop:"gridColumn"}),zY=Bi({prop:"gridRow"}),OY=Bi({prop:"gridAutoFlow"}),FY=Bi({prop:"gridAutoColumns"}),NY=Bi({prop:"gridAutoRows"}),BY=Bi({prop:"gridTemplateColumns"}),UY=Bi({prop:"gridTemplateRows"}),$Y=Bi({prop:"gridTemplateAreas"}),VY=Bi({prop:"gridArea"});nM(iM,oM,sM,DY,zY,OY,FY,NY,BY,UY,$Y,VY);function qm(e,t){return t==="grey"?t:e}const jY=Bi({prop:"color",themeKey:"palette",transform:qm}),HY=Bi({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:qm}),GY=Bi({prop:"backgroundColor",themeKey:"palette",transform:qm});nM(jY,HY,GY);function ma(e){return e<=1&&e!==0?`${e*100}%`:e}const WY=Bi({prop:"width",transform:ma}),CR=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=n=>{var r,i;const a=((r=e.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||bR[n];return a?((i=e.theme)==null||(i=i.breakpoints)==null?void 0:i.unit)!=="px"?{maxWidth:`${a}${e.theme.breakpoints.unit}`}:{maxWidth:a}:{maxWidth:ma(n)}};return kl(e,e.maxWidth,t)}return null};CR.filterProps=["maxWidth"];const qY=Bi({prop:"minWidth",transform:ma}),XY=Bi({prop:"height",transform:ma}),ZY=Bi({prop:"maxHeight",transform:ma}),YY=Bi({prop:"minHeight",transform:ma});Bi({prop:"size",cssProperty:"width",transform:ma});Bi({prop:"size",cssProperty:"height",transform:ma});const KY=Bi({prop:"boxSizing"});nM(WY,CR,qY,XY,ZY,YY,KY);const aM={border:{themeKey:"borders",transform:$a},borderTop:{themeKey:"borders",transform:$a},borderRight:{themeKey:"borders",transform:$a},borderBottom:{themeKey:"borders",transform:$a},borderLeft:{themeKey:"borders",transform:$a},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:$a},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:rM},color:{themeKey:"palette",transform:qm},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:qm},backgroundColor:{themeKey:"palette",transform:qm},p:{style:Ei},pt:{style:Ei},pr:{style:Ei},pb:{style:Ei},pl:{style:Ei},px:{style:Ei},py:{style:Ei},padding:{style:Ei},paddingTop:{style:Ei},paddingRight:{style:Ei},paddingBottom:{style:Ei},paddingLeft:{style:Ei},paddingX:{style:Ei},paddingY:{style:Ei},paddingInline:{style:Ei},paddingInlineStart:{style:Ei},paddingInlineEnd:{style:Ei},paddingBlock:{style:Ei},paddingBlockStart:{style:Ei},paddingBlockEnd:{style:Ei},m:{style:Ci},mt:{style:Ci},mr:{style:Ci},mb:{style:Ci},ml:{style:Ci},mx:{style:Ci},my:{style:Ci},margin:{style:Ci},marginTop:{style:Ci},marginRight:{style:Ci},marginBottom:{style:Ci},marginLeft:{style:Ci},marginX:{style:Ci},marginY:{style:Ci},marginInline:{style:Ci},marginInlineStart:{style:Ci},marginInlineEnd:{style:Ci},marginBlock:{style:Ci},marginBlockStart:{style:Ci},marginBlockEnd:{style:Ci},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:iM},rowGap:{style:sM},columnGap:{style:oM},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:ma},maxWidth:{style:CR},minWidth:{transform:ma},height:{transform:ma},maxHeight:{transform:ma},minHeight:{transform:ma},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function JY(...e){const t=e.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(t);return e.every(r=>n.size===Object.keys(r).length)}function QY(e,t){return typeof e=="function"?e(t):e}function eK(){function e(n,r,i,a){const c={[n]:r,theme:i},o=a[n];if(!o)return{[n]:r};const{cssProperty:f=n,themeKey:g,transform:_,style:x}=o;if(r==null)return null;if(g==="typography"&&r==="inherit")return{[n]:r};const M=Nh(i,g)||{};return x?x(c):kl(c,r,A=>{let L=Pw(M,_,A);return A===L&&typeof A=="string"&&(L=Pw(M,_,`${n}${A==="default"?"":mn(A)}`,A)),f===!1?L:{[f]:L}})}function t(n){var r;const{sx:i,theme:a={}}=n||{};if(!i)return null;const c=(r=a.unstable_sxConfig)!=null?r:aM;function o(f){let g=f;if(typeof f=="function")g=f(a);else if(typeof f!="object")return f;if(!g)return null;const _=Y6(a.breakpoints),x=Object.keys(_);let M=_;return Object.keys(g).forEach(C=>{const A=QY(g[C],a);if(A!=null)if(typeof A=="object")if(c[C])M=ny(M,e(C,A,a,c));else{const L=kl({theme:a},A,I=>({[C]:I}));JY(L,A)?M[C]=t({sx:A,theme:a}):M=ny(M,L)}else M=ny(M,e(C,A,a,c))}),K6(x,M)}return Array.isArray(i)?i.map(o):o(i)}return t}const I_=eK();I_.filterProps=["sx"];function eU(e,t){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:t}:n.palette.mode===e?t:{}}const tK=["breakpoints","palette","spacing","shape"];function ER(e={},...t){const{breakpoints:n={},palette:r={},spacing:i,shape:a={}}=e,c=Un(e,tK),o=Z6(n),f=Q6(i);let g=ba({breakpoints:o,direction:"ltr",components:{},palette:ue({mode:"light"},r),spacing:f,shape:ue({},fY,a)},c);return g.applyStyles=eU,g=t.reduce((_,x)=>ba(_,x),g),g.unstable_sxConfig=ue({},aM,c==null?void 0:c.unstable_sxConfig),g.unstable_sx=function(x){return I_({sx:x,theme:this})},g}function nK(e){return Object.keys(e).length===0}function tU(e=null){const t=$.useContext(P_);return!t||nK(t)?e:t}const rK=ER();function TR(e=rK){return tU(e)}function iK({styles:e,themeId:t,defaultTheme:n={}}){const r=TR(n),i=typeof e=="function"?e(t&&r[t]||r):e;return ee.jsx($b,{styles:i})}const oK=["sx"],sK=e=>{var t,n;const r={systemProps:{},otherProps:{}},i=(t=e==null||(n=e.theme)==null?void 0:n.unstable_sxConfig)!=null?t:aM;return Object.keys(e).forEach(a=>{i[a]?r.systemProps[a]=e[a]:r.otherProps[a]=e[a]}),r};function PR(e){const{sx:t}=e,n=Un(e,oK),{systemProps:r,otherProps:i}=sK(n);let a;return Array.isArray(t)?a=[r,...t]:typeof t=="function"?a=(...c)=>{const o=t(...c);return fh(o)?ue({},r,o):r}:a=ue({},r,t),ue({},i,{sx:a})}const yz=e=>e,aK=()=>{let e=yz;return{configure(t){e=t},generate(t){return e(t)},reset(){e=yz}}},nU=aK();function rU(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=rU(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function xi(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=rU(e))&&(r&&(r+=" "),r+=t);return r}const lK=["className","component"];function cK(e={}){const{themeId:t,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:i}=e,a=q6("div",{shouldForwardProp:o=>o!=="theme"&&o!=="sx"&&o!=="as"})(I_);return $.forwardRef(function(f,g){const _=TR(n),x=PR(f),{className:M,component:C="div"}=x,A=Un(x,lK);return ee.jsx(a,ue({as:C,ref:g,className:xi(M,i?i(r):r),theme:t&&_[t]||_},A))})}const iU={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function AR(e,t,n="Mui"){const r=iU[t];return r?`${n}-${r}`:`${nU.generate(e)}-${t}`}function oU(e,t,n="Mui"){const r={};return t.forEach(i=>{r[i]=AR(e,i,n)}),r}const uK=["ownerState"],hK=["variants"],dK=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function fK(e){return Object.keys(e).length===0}function pK(e){return typeof e=="string"&&e.charCodeAt(0)>96}function WC(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const mK=ER(),gK=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function T1({defaultTheme:e,theme:t,themeId:n}){return fK(t)?e:t[n]||t}function vK(e){return e?(t,n)=>n[e]:null}function Vb(e,t){let{ownerState:n}=t,r=Un(t,uK);const i=typeof e=="function"?e(ue({ownerState:n},r)):e;if(Array.isArray(i))return i.flatMap(a=>Vb(a,ue({ownerState:n},r)));if(i&&typeof i=="object"&&Array.isArray(i.variants)){const{variants:a=[]}=i;let o=Un(i,hK);return a.forEach(f=>{let g=!0;typeof f.props=="function"?g=f.props(ue({ownerState:n},r,n)):Object.keys(f.props).forEach(_=>{(n==null?void 0:n[_])!==f.props[_]&&r[_]!==f.props[_]&&(g=!1)}),g&&(Array.isArray(o)||(o=[o]),o.push(typeof f.style=="function"?f.style(ue({ownerState:n},r,n)):f.style))}),o}return i}function sU(e={}){const{themeId:t,defaultTheme:n=mK,rootShouldForwardProp:r=WC,slotShouldForwardProp:i=WC}=e,a=c=>I_(ue({},c,{theme:T1(ue({},c,{defaultTheme:n,themeId:t}))}));return a.__mui_systemSx=!0,(c,o={})=>{uY(c,H=>H.filter(V=>!(V!=null&&V.__mui_systemSx)));const{name:f,slot:g,skipVariantsResolver:_,skipSx:x,overridesResolver:M=vK(gK(g))}=o,C=Un(o,dK),A=_!==void 0?_:g&&g!=="Root"&&g!=="root"||!1,L=x||!1;let I,T=WC;g==="Root"||g==="root"?T=r:g?T=i:pK(c)&&(T=void 0);const z=q6(c,ue({shouldForwardProp:T,label:I},C)),k=H=>typeof H=="function"&&H.__emotion_real!==H||fh(H)?V=>Vb(H,ue({},V,{theme:T1({theme:V.theme,defaultTheme:n,themeId:t})})):H,U=(H,...V)=>{let q=k(H);const J=V?V.map(k):[];f&&M&&J.push(ne=>{const ye=T1(ue({},ne,{defaultTheme:n,themeId:t}));if(!ye.components||!ye.components[f]||!ye.components[f].styleOverrides)return null;const ge=ye.components[f].styleOverrides,Ne={};return Object.entries(ge).forEach(([Ae,ve])=>{Ne[Ae]=Vb(ve,ue({},ne,{theme:ye}))}),M(ne,Ne)}),f&&!A&&J.push(ne=>{var ye;const ge=T1(ue({},ne,{defaultTheme:n,themeId:t})),Ne=ge==null||(ye=ge.components)==null||(ye=ye[f])==null?void 0:ye.variants;return Vb({variants:Ne},ue({},ne,{theme:ge}))}),L||J.push(a);const Y=J.length-V.length;if(Array.isArray(H)&&Y>0){const ne=new Array(Y).fill("");q=[...H,...ne],q.raw=[...H.raw,...ne]}const N=z(q,...J);return c.muiName&&(N.muiName=c.muiName),N};return z.withConfig&&(U.withConfig=z.withConfig),U}}const yK=sU();function aU(e,t){const n=ue({},t);return Object.keys(e).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=ue({},e[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const i=e[r]||{},a=t[r];n[r]={},!a||!Object.keys(a)?n[r]=i:!i||!Object.keys(i)?n[r]=a:(n[r]=ue({},a),Object.keys(i).forEach(c=>{n[r][c]=aU(i[c],a[c])}))}else n[r]===void 0&&(n[r]=e[r])}),n}function _K(e){const{theme:t,name:n,props:r}=e;return!t||!t.components||!t.components[n]||!t.components[n].defaultProps?r:aU(t.components[n].defaultProps,r)}function lU({props:e,name:t,defaultTheme:n,themeId:r}){let i=TR(n);return r&&(i=i[r]||i),_K({theme:i,name:t,props:e})}const su=typeof window<"u"?$.useLayoutEffect:$.useEffect;function xK(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function cU(e){if(e.type)return e;if(e.charAt(0)==="#")return cU(xK(e));const t=e.indexOf("("),n=e.substring(0,t);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(Fy(9,e));let r=e.substring(t+1,e.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(Fy(10,i))}else r=r.split(",");return r=r.map(a=>parseFloat(a)),{type:n,values:r,colorSpace:i}}const Kd=e=>{const t=cU(e);return t.values.slice(0,3).map((n,r)=>t.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};function _z(...e){return e.reduce((t,n)=>n==null?t:function(...i){t.apply(this,i),n.apply(this,i)},()=>{})}function IR(e,t){var n,r;return $.isValidElement(e)&&t.indexOf((n=e.type.muiName)!=null?n:(r=e.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function wa(e){return e&&e.ownerDocument||document}function RR(e){return wa(e).defaultView||window}function Aw(e,t){typeof e=="function"?e(t):e&&(e.current=t)}let xz=0;function bK(e){const[t,n]=$.useState(e),r=e||t;return $.useEffect(()=>{t==null&&(xz+=1,n(`mui-${xz}`))},[t]),r}const bz=bP.useId;function qs(e){if(bz!==void 0){const t=bz();return e??t}return bK(e)}function Xm({controlled:e,default:t,name:n,state:r="value"}){const{current:i}=$.useRef(e!==void 0),[a,c]=$.useState(t),o=i?e:a,f=$.useCallback(g=>{i||c(g)},[]);return[o,f]}function Tl(e){const t=$.useRef(e);return su(()=>{t.current=e}),$.useRef((...n)=>(0,t.current)(...n)).current}function Ur(...e){return $.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(n=>{Aw(n,t)})},e)}const wz={};function wK(e,t){const n=$.useRef(wz);return n.current===wz&&(n.current=e(t)),n}const SK=[];function MK(e){$.useEffect(e,SK)}class R_{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new R_}start(t,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},t)}}function U0(){const e=wK(R_.create).current;return MK(e.disposeEffect),e}let lM=!0,CP=!1;const CK=new R_,EK={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function TK(e){const{type:t,tagName:n}=e;return!!(n==="INPUT"&&EK[t]&&!e.readOnly||n==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function PK(e){e.metaKey||e.altKey||e.ctrlKey||(lM=!0)}function qC(){lM=!1}function AK(){this.visibilityState==="hidden"&&CP&&(lM=!0)}function IK(e){e.addEventListener("keydown",PK,!0),e.addEventListener("mousedown",qC,!0),e.addEventListener("pointerdown",qC,!0),e.addEventListener("touchstart",qC,!0),e.addEventListener("visibilitychange",AK,!0)}function RK(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch{}return lM||TK(t)}function LR(){const e=$.useCallback(i=>{i!=null&&IK(i.ownerDocument)},[]),t=$.useRef(!1);function n(){return t.current?(CP=!0,CK.start(100,()=>{CP=!1}),t.current=!1,!0):!1}function r(i){return RK(i)?(t.current=!0,!0):!1}return{isFocusVisibleRef:t,onFocus:r,onBlur:n,ref:e}}function LK(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}const kK=e=>{const t=$.useRef({});return $.useEffect(()=>{t.current=e}),t.current},DK={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function yr(e,t,n=void 0){const r={};return Object.keys(e).forEach(i=>{r[i]=e[i].reduce((a,c)=>{if(c){const o=t(c);o!==""&&a.push(o),n&&n[c]&&a.push(n[c])}return a},[]).join(" ")}),r}function zK(e){return typeof e=="string"}function uU(e,t,n){return e===void 0||zK(e)?t:ue({},t,{ownerState:ue({},t.ownerState,n)})}function ho(e,t=[]){if(e===void 0)return{};const n={};return Object.keys(e).filter(r=>r.match(/^on[A-Z]/)&&typeof e[r]=="function"&&!t.includes(r)).forEach(r=>{n[r]=e[r]}),n}function Sz(e){if(e===void 0)return{};const t={};return Object.keys(e).filter(n=>!(n.match(/^on[A-Z]/)&&typeof e[n]=="function")).forEach(n=>{t[n]=e[n]}),t}function hU(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:a}=e;if(!t){const C=xi(n==null?void 0:n.className,a,i==null?void 0:i.className,r==null?void 0:r.className),A=ue({},n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),L=ue({},n,i,r);return C.length>0&&(L.className=C),Object.keys(A).length>0&&(L.style=A),{props:L,internalRef:void 0}}const c=ho(ue({},i,r)),o=Sz(r),f=Sz(i),g=t(c),_=xi(g==null?void 0:g.className,n==null?void 0:n.className,a,i==null?void 0:i.className,r==null?void 0:r.className),x=ue({},g==null?void 0:g.style,n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),M=ue({},g,n,f,o);return _.length>0&&(M.className=_),Object.keys(x).length>0&&(M.style=x),{props:M,internalRef:g.ref}}function dU(e,t,n){return typeof e=="function"?e(t,n):e}const OK=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function fU(e){var t;const{elementType:n,externalSlotProps:r,ownerState:i,skipResolvingSlotProps:a=!1}=e,c=Un(e,OK),o=a?{}:dU(r,i),{props:f,internalRef:g}=hU(ue({},c,{externalSlotProps:o})),_=Ur(g,o==null?void 0:o.ref,(t=e.additionalProps)==null?void 0:t.ref);return uU(n,ue({},f,{ref:_}),i)}function cM(e){if(parseInt($.version,10)>=19){var t;return(e==null||(t=e.props)==null?void 0:t.ref)||null}return(e==null?void 0:e.ref)||null}const pU=$.createContext(null);function kR(){return $.useContext(pU)}const FK=typeof Symbol=="function"&&Symbol.for,NK=FK?Symbol.for("mui.nested"):"__THEME_NESTED__";function BK(e,t){return typeof t=="function"?t(e):ue({},e,t)}function UK(e){const{children:t,theme:n}=e,r=kR(),i=$.useMemo(()=>{const a=r===null?n:BK(r,n);return a!=null&&(a[NK]=r!==null),a},[n,r]);return ee.jsx(pU.Provider,{value:i,children:t})}const $K=["value"],VK=$.createContext();function jK(e){let{value:t}=e,n=Un(e,$K);return ee.jsx(VK.Provider,ue({value:t??!0},n))}const HK=$.createContext(void 0);function GK({value:e,children:t}){return ee.jsx(HK.Provider,{value:e,children:t})}const Mz={};function Cz(e,t,n,r=!1){return $.useMemo(()=>{const i=e&&t[e]||t;if(typeof n=="function"){const a=n(i),c=e?ue({},t,{[e]:a}):a;return r?()=>c:c}return e?ue({},t,{[e]:n}):ue({},t,n)},[e,t,n,r])}function WK(e){const{children:t,theme:n,themeId:r}=e,i=tU(Mz),a=kR()||Mz,c=Cz(r,i,n),o=Cz(r,a,n,!0),f=c.direction==="rtl";return ee.jsx(UK,{theme:o,children:ee.jsx(P_.Provider,{value:c,children:ee.jsx(jK,{value:f,children:ee.jsx(GK,{value:c==null?void 0:c.components,children:t})})})})}const DR="mode",zR="color-scheme",mU="data-color-scheme";function qK(e){const{defaultMode:t="light",defaultLightColorScheme:n="light",defaultDarkColorScheme:r="dark",modeStorageKey:i=DR,colorSchemeStorageKey:a=zR,attribute:c=mU,colorSchemeNode:o="document.documentElement",nonce:f}=e||{};return ee.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?f:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  var mode = localStorage.getItem('${i}') || '${t}';
  var colorScheme = '';
  if (mode === 'system') {
    // handle system mode
    var mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = localStorage.getItem('${a}-dark') || '${r}';
    } else {
      colorScheme = localStorage.getItem('${a}-light') || '${n}';
    }
  }
  if (mode === 'light') {
    colorScheme = localStorage.getItem('${a}-light') || '${n}';
  }
  if (mode === 'dark') {
    colorScheme = localStorage.getItem('${a}-dark') || '${r}';
  }
  if (colorScheme) {
    ${o}.setAttribute('${c}', colorScheme);
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function Ez(e){if(typeof window<"u"&&e==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function gU(e,t){if(e.mode==="light"||e.mode==="system"&&e.systemMode==="light")return t("light");if(e.mode==="dark"||e.mode==="system"&&e.systemMode==="dark")return t("dark")}function XK(e){return gU(e,t=>{if(t==="light")return e.lightColorScheme;if(t==="dark")return e.darkColorScheme})}function XC(e,t){if(typeof window>"u")return;let n;try{n=localStorage.getItem(e)||void 0,n||localStorage.setItem(e,t)}catch{}return n||t}function ZK(e){const{defaultMode:t="light",defaultLightColorScheme:n,defaultDarkColorScheme:r,supportedColorSchemes:i=[],modeStorageKey:a=DR,colorSchemeStorageKey:c=zR,storageWindow:o=typeof window>"u"?void 0:window}=e,f=i.join(","),[g,_]=$.useState(()=>{const I=XC(a,t),T=XC(`${c}-light`,n),z=XC(`${c}-dark`,r);return{mode:I,systemMode:Ez(I),lightColorScheme:T,darkColorScheme:z}}),x=XK(g),M=$.useCallback(I=>{_(T=>{if(I===T.mode)return T;const z=I??t;try{localStorage.setItem(a,z)}catch{}return ue({},T,{mode:z,systemMode:Ez(z)})})},[a,t]),C=$.useCallback(I=>{I?typeof I=="string"?I&&!f.includes(I)?console.error(`\`${I}\` does not exist in \`theme.colorSchemes\`.`):_(T=>{const z=ue({},T);return gU(T,k=>{try{localStorage.setItem(`${c}-${k}`,I)}catch{}k==="light"&&(z.lightColorScheme=I),k==="dark"&&(z.darkColorScheme=I)}),z}):_(T=>{const z=ue({},T),k=I.light===null?n:I.light,U=I.dark===null?r:I.dark;if(k)if(!f.includes(k))console.error(`\`${k}\` does not exist in \`theme.colorSchemes\`.`);else{z.lightColorScheme=k;try{localStorage.setItem(`${c}-light`,k)}catch{}}if(U)if(!f.includes(U))console.error(`\`${U}\` does not exist in \`theme.colorSchemes\`.`);else{z.darkColorScheme=U;try{localStorage.setItem(`${c}-dark`,U)}catch{}}return z}):_(T=>{try{localStorage.setItem(`${c}-light`,n),localStorage.setItem(`${c}-dark`,r)}catch{}return ue({},T,{lightColorScheme:n,darkColorScheme:r})})},[f,c,n,r]),A=$.useCallback(I=>{g.mode==="system"&&_(T=>{const z=I!=null&&I.matches?"dark":"light";return T.systemMode===z?T:ue({},T,{systemMode:z})})},[g.mode]),L=$.useRef(A);return L.current=A,$.useEffect(()=>{const I=(...z)=>L.current(...z),T=window.matchMedia("(prefers-color-scheme: dark)");return T.addListener(I),I(T),()=>{T.removeListener(I)}},[]),$.useEffect(()=>{if(o){const I=T=>{const z=T.newValue;typeof T.key=="string"&&T.key.startsWith(c)&&(!z||f.match(z))&&(T.key.endsWith("light")&&C({light:z}),T.key.endsWith("dark")&&C({dark:z})),T.key===a&&(!z||["light","dark","system"].includes(z))&&M(z||t)};return o.addEventListener("storage",I),()=>{o.removeEventListener("storage",I)}}},[C,M,a,c,f,t,o]),ue({},g,{colorScheme:x,setMode:M,setColorScheme:C})}const YK=["colorSchemes","components","generateCssVars","cssVarPrefix"],KK="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function JK(e){const{themeId:t,theme:n={},attribute:r=mU,modeStorageKey:i=DR,colorSchemeStorageKey:a=zR,defaultMode:c="light",defaultColorScheme:o,disableTransitionOnChange:f=!1,resolveTheme:g,excludeVariablesFromRoot:_}=e;(!n.colorSchemes||typeof o=="string"&&!n.colorSchemes[o]||typeof o=="object"&&!n.colorSchemes[o==null?void 0:o.light]||typeof o=="object"&&!n.colorSchemes[o==null?void 0:o.dark])&&console.error(`MUI: \`${o}\` does not exist in \`theme.colorSchemes\`.`);const x=$.createContext(void 0),M=()=>{const T=$.useContext(x);if(!T)throw new Error(Fy(19));return T};function C(T){const{children:z,theme:k=n,modeStorageKey:U=i,colorSchemeStorageKey:H=a,attribute:V=r,defaultMode:q=c,defaultColorScheme:J=o,disableTransitionOnChange:Y=f,storageWindow:N=typeof window>"u"?void 0:window,documentNode:ne=typeof document>"u"?void 0:document,colorSchemeNode:ye=typeof document>"u"?void 0:document.documentElement,colorSchemeSelector:ge=":root",disableNestedContext:Ne=!1,disableStyleSheetGeneration:Ae=!1}=T,ve=$.useRef(!1),Se=kR(),Me=$.useContext(x),Ue=!!Me&&!Ne,Qe=k[t],st=Qe||k,{colorSchemes:ct={},components:Xt={},generateCssVars:je=()=>({vars:{},css:{}}),cssVarPrefix:lt}=st,Ot=Un(st,YK),ut=Object.keys(ct),ot=typeof J=="string"?J:J.light,Tt=typeof J=="string"?J:J.dark,{mode:Ct,setMode:un,systemMode:gn,lightColorScheme:hn,darkColorScheme:We,colorScheme:vn,setColorScheme:Ut}=ZK({supportedColorSchemes:ut,defaultLightColorScheme:ot,defaultDarkColorScheme:Tt,modeStorageKey:U,colorSchemeStorageKey:H,defaultMode:q,storageWindow:N});let tn=Ct,Dt=vn;Ue&&(tn=Me.mode,Dt=Me.colorScheme);const An=tn||(q==="system"?c:q),an=Dt||(An==="dark"?Tt:ot),{css:Le,vars:me}=je(),it=ue({},Ot,{components:Xt,colorSchemes:ct,cssVarPrefix:lt,vars:me,getColorSchemeSelector:kt=>`[${V}="${kt}"] &`}),St={},It={};Object.entries(ct).forEach(([kt,bn])=>{const{css:zt,vars:_e}=je(kt);it.vars=ba(it.vars,_e),kt===an&&(Object.keys(bn).forEach(re=>{bn[re]&&typeof bn[re]=="object"?it[re]=ue({},it[re],bn[re]):it[re]=bn[re]}),it.palette&&(it.palette.colorScheme=kt));const te=typeof J=="string"?J:q==="dark"?J.dark:J.light;if(kt===te){if(_){const re={};_(lt).forEach(Z=>{re[Z]=zt[Z],delete zt[Z]}),St[`[${V}="${kt}"]`]=re}St[`${ge}, [${V}="${kt}"]`]=zt}else It[`${ge===":root"?"":ge}[${V}="${kt}"]`]=zt}),it.vars=ba(it.vars,me),$.useEffect(()=>{Dt&&ye&&ye.setAttribute(V,Dt)},[Dt,V,ye]),$.useEffect(()=>{let kt;if(Y&&ve.current&&ne){const bn=ne.createElement("style");bn.appendChild(ne.createTextNode(KK)),ne.head.appendChild(bn),window.getComputedStyle(ne.body),kt=setTimeout(()=>{ne.head.removeChild(bn)},1)}return()=>{clearTimeout(kt)}},[Dt,Y,ne]),$.useEffect(()=>(ve.current=!0,()=>{ve.current=!1}),[]);const wt=$.useMemo(()=>({allColorSchemes:ut,colorScheme:Dt,darkColorScheme:We,lightColorScheme:hn,mode:tn,setColorScheme:Ut,setMode:un,systemMode:gn}),[ut,Dt,We,hn,tn,Ut,un,gn]);let Zt=!0;(Ae||Ue&&(Se==null?void 0:Se.cssVarPrefix)===lt)&&(Zt=!1);const Lt=ee.jsxs($.Fragment,{children:[Zt&&ee.jsxs($.Fragment,{children:[ee.jsx($b,{styles:{[ge]:Le}}),ee.jsx($b,{styles:St}),ee.jsx($b,{styles:It})]}),ee.jsx(WK,{themeId:Qe?t:void 0,theme:g?g(it):it,children:z})]});return Ue?Lt:ee.jsx(x.Provider,{value:wt,children:Lt})}const A=typeof o=="string"?o:o.light,L=typeof o=="string"?o:o.dark;return{CssVarsProvider:C,useColorScheme:M,getInitColorSchemeScript:T=>qK(ue({attribute:r,colorSchemeStorageKey:a,defaultMode:c,defaultLightColorScheme:A,defaultDarkColorScheme:L,modeStorageKey:i},T))}}function OR(e=""){function t(...r){if(!r.length)return"";const i=r[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${i}${t(...r.slice(1))})`:`, ${i}`}return(r,...i)=>`var(--${e?`${e}-`:""}${r}${t(...i)})`}const Tz=(e,t,n,r=[])=>{let i=e;t.forEach((a,c)=>{c===t.length-1?Array.isArray(i)?i[Number(a)]=n:i&&typeof i=="object"&&(i[a]=n):i&&typeof i=="object"&&(i[a]||(i[a]=r.includes(a)?[]:{}),i=i[a])})},QK=(e,t,n)=>{function r(i,a=[],c=[]){Object.entries(i).forEach(([o,f])=>{(!n||!n([...a,o]))&&f!=null&&(typeof f=="object"&&Object.keys(f).length>0?r(f,[...a,o],Array.isArray(f)?[...c,o]:c):t([...a,o],f,c))})}r(e)},eJ=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>e.includes(r))||e[e.length-1].toLowerCase().indexOf("opacity")>=0?t:`${t}px`:t;function ZC(e,t){const{prefix:n,shouldSkipGeneratingVar:r}=t,i={},a={},c={};return QK(e,(o,f,g)=>{if((typeof f=="string"||typeof f=="number")&&(!r||!r(o,f))){const _=`--${n?`${n}-`:""}${o.join("-")}`;Object.assign(i,{[_]:eJ(o,f)}),Tz(a,o,`var(${_})`,g),Tz(c,o,`var(${_}, ${f})`,g)}},o=>o[0]==="vars"),{css:i,vars:a,varsWithDefaults:c}}function $y(e){"@babel/helpers - typeof";return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$y(e)}function tJ(e,t){if($y(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if($y(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function nJ(e){var t=tJ(e,"string");return $y(t)=="symbol"?t:t+""}const rJ=["colorSchemes","components","defaultColorScheme"];function iJ(e,t){const{colorSchemes:n={},defaultColorScheme:r="light"}=e,i=Un(e,rJ),{vars:a,css:c,varsWithDefaults:o}=ZC(i,t);let f=o;const g={},{[r]:_}=n,x=Un(n,[r].map(nJ));if(Object.entries(x||{}).forEach(([C,A])=>{const{vars:L,css:I,varsWithDefaults:T}=ZC(A,t);f=ba(f,T),g[C]={css:I,vars:L}}),_){const{css:C,vars:A,varsWithDefaults:L}=ZC(_,t);f=ba(f,L),g[r]={css:C,vars:A}}return{vars:f,generateCssVars:C=>{var A;if(!C){var L;const T=ue({},c);return{css:T,vars:a,selector:(t==null||(L=t.getSelector)==null?void 0:L.call(t,C,T))||":root"}}const I=ue({},g[C].css);return{css:I,vars:g[C].vars,selector:(t==null||(A=t.getSelector)==null?void 0:A.call(t,C,I))||":root"}}}}const oJ=["component","direction","spacing","divider","children","className","useFlexGap"],sJ=ER(),aJ=yK("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root});function lJ(e){return lU({props:e,name:"MuiStack",defaultTheme:sJ})}function cJ(e,t){const n=$.Children.toArray(e).filter(Boolean);return n.reduce((r,i,a)=>(r.push(i),a<n.length-1&&r.push($.cloneElement(t,{key:`separator-${a}`})),r),[])}const uJ=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],hJ=({ownerState:e,theme:t})=>{let n=ue({display:"flex",flexDirection:"column"},kl({theme:t},GC({values:e.direction,breakpoints:t.breakpoints.values}),r=>({flexDirection:r})));if(e.spacing){const r=MR(t),i=Object.keys(t.breakpoints.values).reduce((f,g)=>((typeof e.spacing=="object"&&e.spacing[g]!=null||typeof e.direction=="object"&&e.direction[g]!=null)&&(f[g]=!0),f),{}),a=GC({values:e.direction,base:i}),c=GC({values:e.spacing,base:i});typeof a=="object"&&Object.keys(a).forEach((f,g,_)=>{if(!a[f]){const M=g>0?a[_[g-1]]:"column";a[f]=M}}),n=ba(n,kl({theme:t},c,(f,g)=>e.useFlexGap?{gap:Af(r,f)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${uJ(g?a[g]:e.direction)}`]:Af(r,f)}}))}return n=pY(t.breakpoints,n),n};function dJ(e={}){const{createStyledComponent:t=aJ,useThemeProps:n=lJ,componentName:r="MuiStack"}=e,i=()=>yr({root:["root"]},f=>AR(r,f),{}),a=t(hJ);return $.forwardRef(function(f,g){const _=n(f),x=PR(_),{component:M="div",direction:C="column",spacing:A=0,divider:L,children:I,className:T,useFlexGap:z=!1}=x,k=Un(x,oJ),U={direction:C,spacing:A,useFlexGap:z},H=i();return ee.jsx(a,ue({as:M,ownerState:U,ref:g,className:xi(H.root,T)},k,{children:L?cJ(I,L):I}))})}const fJ=ue({},aM,{borderRadius:{themeKey:"radius"},boxShadow:{themeKey:"shadow"},fontFamily:{themeKey:"fontFamily"},fontSize:{themeKey:"fontSize"},fontWeight:{themeKey:"fontWeight"},letterSpacing:{themeKey:"letterSpacing"},lineHeight:{themeKey:"lineHeight"}});function pJ(e){var t;return!!e[0].match(/^(typography|variants|breakpoints)$/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((t=e[1])!=null&&t.match(/^(mode)$/))||e[0]==="focus"&&e[1]!=="thickness"}const br=(e,t)=>AR(e,t,"Mui"),gr=(e,t)=>oU(e,t,"Mui"),mJ=e=>e&&typeof e=="object"&&Object.keys(e).some(t=>{var n;return(n=t.match)==null?void 0:n.call(t,/^(plain(Hover|Active|Disabled)?(Color|Bg)|outlined(Hover|Active|Disabled)?(Color|Border|Bg)|soft(Hover|Active|Disabled)?(Color|Bg)|solid(Hover|Active|Disabled)?(Color|Bg))$/)}),Pz=(e,t,n)=>{t.includes("Color")&&(e.color=n),t.includes("Bg")&&(e.backgroundColor=n),t.includes("Border")&&(e.borderColor=n)},Az=(e,t,n)=>{const r={};return Object.entries(t||{}).forEach(([i,a])=>{if(i.match(new RegExp(`${e}(color|bg|border)`,"i"))&&a){const c=n?n(i):a;i.includes("Disabled")&&(r.pointerEvents="none",r.cursor="default",r["--Icon-color"]="currentColor"),i.match(/(Hover|Active|Disabled)/)||(r["--variant-borderWidth"]||(r["--variant-borderWidth"]="0px"),i.includes("Border")&&(r["--variant-borderWidth"]="1px",r.border="var(--variant-borderWidth) solid")),Pz(r,i,c)}}),r},ts=(e,t)=>{let n={};{const{getCssVar:r,palette:i}=t;Object.entries(i).forEach(a=>{const[c,o]=a;mJ(o)&&typeof o=="object"&&(n=ue({},n,{[c]:Az(e,o,f=>`var(--variant-${f}, ${r(`palette-${c}-${f}`,i[c][f])})`)}))})}return n.context=Az(e,{plainColor:"var(--variant-plainColor)",plainHoverColor:"var(--variant-plainHoverColor)",plainHoverBg:"var(--variant-plainHoverBg)",plainActiveBg:"var(--variant-plainActiveBg)",plainDisabledColor:"var(--variant-plainDisabledColor)",outlinedColor:"var(--variant-outlinedColor)",outlinedBorder:"var(--variant-outlinedBorder)",outlinedHoverColor:"var(--variant-outlinedHoverColor)",outlinedHoverBorder:"var(--variant-outlinedHoverBorder)",outlinedHoverBg:"var(--variant-outlinedHoverBg)",outlinedActiveBg:"var(--variant-outlinedActiveBg)",outlinedDisabledColor:"var(--variant-outlinedDisabledColor)",outlinedDisabledBorder:"var(--variant-outlinedDisabledBorder)",softColor:"var(--variant-softColor)",softBg:"var(--variant-softBg)",softHoverColor:"var(--variant-softHoverColor)",softHoverBg:"var(--variant-softHoverBg)",softActiveBg:"var(--variant-softActiveBg)",softDisabledColor:"var(--variant-softDisabledColor)",softDisabledBg:"var(--variant-softDisabledBg)",solidColor:"var(--variant-solidColor)",solidBg:"var(--variant-solidBg)",solidHoverBg:"var(--variant-solidHoverBg)",solidActiveBg:"var(--variant-solidActiveBg)",solidDisabledColor:"var(--variant-solidDisabledColor)",solidDisabledBg:"var(--variant-solidDisabledBg)"}),n},gJ=["cssVarPrefix","breakpoints","spacing","components","variants","shouldSkipGeneratingVar"],vJ=["colorSchemes"],yJ=(e="joy")=>OR(e);function vU(e){var t,n,r,i,a,c,o,f,g,_;const x=e||{},{cssVarPrefix:M="joy",breakpoints:C,spacing:A,components:L,variants:I,shouldSkipGeneratingVar:T=pJ}=x,z=Un(x,gJ),k=yJ(M),U={primary:l0.blue,neutral:l0.grey,danger:l0.red,success:l0.green,warning:l0.yellow,common:{white:"#FFF",black:"#000"}},H=ot=>{var Tt;const Ct=ot.split("-"),un=Ct[1],gn=Ct[2];return k(ot,(Tt=U[un])==null?void 0:Tt[gn])},V=ot=>({plainColor:H(`palette-${ot}-500`),plainHoverBg:H(`palette-${ot}-100`),plainActiveBg:H(`palette-${ot}-200`),plainDisabledColor:H("palette-neutral-400"),outlinedColor:H(`palette-${ot}-500`),outlinedBorder:H(`palette-${ot}-300`),outlinedHoverBg:H(`palette-${ot}-100`),outlinedActiveBg:H(`palette-${ot}-200`),outlinedDisabledColor:H("palette-neutral-400"),outlinedDisabledBorder:H("palette-neutral-200"),softColor:H(`palette-${ot}-700`),softBg:H(`palette-${ot}-100`),softHoverBg:H(`palette-${ot}-200`),softActiveColor:H(`palette-${ot}-800`),softActiveBg:H(`palette-${ot}-300`),softDisabledColor:H("palette-neutral-400"),softDisabledBg:H("palette-neutral-50"),solidColor:H("palette-common-white"),solidBg:H(`palette-${ot}-500`),solidHoverBg:H(`palette-${ot}-600`),solidActiveBg:H(`palette-${ot}-700`),solidDisabledColor:H("palette-neutral-400"),solidDisabledBg:H("palette-neutral-100")}),q=ot=>({plainColor:H(`palette-${ot}-300`),plainHoverBg:H(`palette-${ot}-800`),plainActiveBg:H(`palette-${ot}-700`),plainDisabledColor:H("palette-neutral-500"),outlinedColor:H(`palette-${ot}-200`),outlinedBorder:H(`palette-${ot}-700`),outlinedHoverBg:H(`palette-${ot}-800`),outlinedActiveBg:H(`palette-${ot}-700`),outlinedDisabledColor:H("palette-neutral-500"),outlinedDisabledBorder:H("palette-neutral-800"),softColor:H(`palette-${ot}-200`),softBg:H(`palette-${ot}-800`),softHoverBg:H(`palette-${ot}-700`),softActiveColor:H(`palette-${ot}-100`),softActiveBg:H(`palette-${ot}-600`),softDisabledColor:H("palette-neutral-500"),softDisabledBg:H("palette-neutral-800"),solidColor:H("palette-common-white"),solidBg:H(`palette-${ot}-500`),solidHoverBg:H(`palette-${ot}-600`),solidActiveBg:H(`palette-${ot}-700`),solidDisabledColor:H("palette-neutral-500"),solidDisabledBg:H("palette-neutral-800")}),J={palette:{mode:"light",primary:ue({},U.primary,V("primary")),neutral:ue({},U.neutral,V("neutral"),{plainColor:H("palette-neutral-700"),plainHoverColor:H("palette-neutral-900"),outlinedColor:H("palette-neutral-700")}),danger:ue({},U.danger,V("danger")),success:ue({},U.success,V("success")),warning:ue({},U.warning,V("warning")),common:{white:"#FFF",black:"#000"},text:{primary:H("palette-neutral-800"),secondary:H("palette-neutral-700"),tertiary:H("palette-neutral-600"),icon:H("palette-neutral-500")},background:{body:H("palette-common-white"),surface:H("palette-neutral-50"),popup:H("palette-common-white"),level1:H("palette-neutral-100"),level2:H("palette-neutral-200"),level3:H("palette-neutral-300"),tooltip:H("palette-neutral-500"),backdrop:`rgba(${k("palette-neutral-darkChannel",Kd(U.neutral[900]))} / 0.25)`},divider:`rgba(${k("palette-neutral-mainChannel",Kd(U.neutral[500]))} / 0.2)`,focusVisible:H("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"21 21 21",shadowOpacity:"0.08"},Y={palette:{mode:"dark",primary:ue({},U.primary,q("primary")),neutral:ue({},U.neutral,q("neutral"),{plainColor:H("palette-neutral-300"),plainHoverColor:H("palette-neutral-300")}),danger:ue({},U.danger,q("danger")),success:ue({},U.success,q("success")),warning:ue({},U.warning,q("warning")),common:{white:"#FFF",black:"#000"},text:{primary:H("palette-neutral-100"),secondary:H("palette-neutral-300"),tertiary:H("palette-neutral-400"),icon:H("palette-neutral-400")},background:{body:H("palette-common-black"),surface:H("palette-neutral-900"),popup:H("palette-common-black"),level1:H("palette-neutral-800"),level2:H("palette-neutral-700"),level3:H("palette-neutral-600"),tooltip:H("palette-neutral-600"),backdrop:`rgba(${k("palette-neutral-darkChannel",Kd(U.neutral[50]))} / 0.25)`},divider:`rgba(${k("palette-neutral-mainChannel",Kd(U.neutral[500]))} / 0.16)`,focusVisible:H("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"0 0 0",shadowOpacity:"0.6"},N='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',ne=ue({body:`"Inter", ${k(`fontFamily-fallback, ${N}`)}`,display:`"Inter", ${k(`fontFamily-fallback, ${N}`)}`,code:"Source Code Pro,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace",fallback:N},z.fontFamily),ye=ue({sm:300,md:500,lg:600,xl:700},z.fontWeight),ge=ue({xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem",xl2:"1.5rem",xl3:"1.875rem",xl4:"2.25rem"},z.fontSize),Ne=ue({xs:"1.33334",sm:"1.42858",md:"1.5",lg:"1.55556",xl:"1.66667"},z.lineHeight),Ae=(t=(n=z.colorSchemes)==null||(n=n.light)==null?void 0:n.shadowRing)!=null?t:J.shadowRing,ve=(r=(i=z.colorSchemes)==null||(i=i.light)==null?void 0:i.shadowChannel)!=null?r:J.shadowChannel,Se=(a=(c=z.colorSchemes)==null||(c=c.light)==null?void 0:c.shadowOpacity)!=null?a:J.shadowOpacity,Me={colorSchemes:{light:J,dark:Y},fontSize:ge,fontFamily:ne,fontWeight:ye,focus:{thickness:"2px",selector:`&.${br("","focusVisible")}, &:focus-visible`,default:{outlineOffset:`var(--focus-outline-offset, ${k("focus-thickness",(o=(f=z.focus)==null?void 0:f.thickness)!=null?o:"2px")})`,outline:`${k("focus-thickness",(g=(_=z.focus)==null?void 0:_.thickness)!=null?g:"2px")} solid ${k("palette-focusVisible",U.primary[500])}`}},lineHeight:Ne,radius:{xs:"2px",sm:"6px",md:"8px",lg:"12px",xl:"16px"},shadow:{xs:`${k("shadowRing",Ae)}, 0px 1px 2px 0px rgba(${k("shadowChannel",ve)} / ${k("shadowOpacity",Se)})`,sm:`${k("shadowRing",Ae)}, 0px 1px 2px 0px rgba(${k("shadowChannel",ve)} / ${k("shadowOpacity",Se)}), 0px 2px 4px 0px rgba(${k("shadowChannel",ve)} / ${k("shadowOpacity",Se)})`,md:`${k("shadowRing",Ae)}, 0px 2px 8px -2px rgba(${k("shadowChannel",ve)} / ${k("shadowOpacity",Se)}), 0px 6px 12px -2px rgba(${k("shadowChannel",ve)} / ${k("shadowOpacity",Se)})`,lg:`${k("shadowRing",Ae)}, 0px 2px 8px -2px rgba(${k("shadowChannel",ve)} / ${k("shadowOpacity",Se)}), 0px 12px 16px -4px rgba(${k("shadowChannel",ve)} / ${k("shadowOpacity",Se)})`,xl:`${k("shadowRing",Ae)}, 0px 2px 8px -2px rgba(${k("shadowChannel",ve)} / ${k("shadowOpacity",Se)}), 0px 20px 24px -4px rgba(${k("shadowChannel",ve)} / ${k("shadowOpacity",Se)})`},zIndex:{badge:1,table:10,popup:1e3,modal:1300,snackbar:1400,tooltip:1500},typography:{h1:{fontFamily:k(`fontFamily-display, ${ne.display}`),fontWeight:k(`fontWeight-xl, ${ye.xl}`),fontSize:k(`fontSize-xl4, ${ge.xl4}`),lineHeight:k(`lineHeight-xs, ${Ne.xs}`),letterSpacing:"-0.025em",color:k(`palette-text-primary, ${J.palette.text.primary}`)},h2:{fontFamily:k(`fontFamily-display, ${ne.display}`),fontWeight:k(`fontWeight-xl, ${ye.xl}`),fontSize:k(`fontSize-xl3, ${ge.xl3}`),lineHeight:k(`lineHeight-xs, ${Ne.xs}`),letterSpacing:"-0.025em",color:k(`palette-text-primary, ${J.palette.text.primary}`)},h3:{fontFamily:k(`fontFamily-display, ${ne.display}`),fontWeight:k(`fontWeight-lg, ${ye.lg}`),fontSize:k(`fontSize-xl2, ${ge.xl2}`),lineHeight:k(`lineHeight-xs, ${Ne.xs}`),letterSpacing:"-0.025em",color:k(`palette-text-primary, ${J.palette.text.primary}`)},h4:{fontFamily:k(`fontFamily-display, ${ne.display}`),fontWeight:k(`fontWeight-lg, ${ye.lg}`),fontSize:k(`fontSize-xl, ${ge.xl}`),lineHeight:k(`lineHeight-md, ${Ne.md}`),letterSpacing:"-0.025em",color:k(`palette-text-primary, ${J.palette.text.primary}`)},"title-lg":{fontFamily:k(`fontFamily-body, ${ne.body}`),fontWeight:k(`fontWeight-lg, ${ye.lg}`),fontSize:k(`fontSize-lg, ${ge.lg}`),lineHeight:k(`lineHeight-xs, ${Ne.xs}`),color:k(`palette-text-primary, ${J.palette.text.primary}`)},"title-md":{fontFamily:k(`fontFamily-body, ${ne.body}`),fontWeight:k(`fontWeight-md, ${ye.md}`),fontSize:k(`fontSize-md, ${ge.md}`),lineHeight:k(`lineHeight-md, ${Ne.md}`),color:k(`palette-text-primary, ${J.palette.text.primary}`)},"title-sm":{fontFamily:k(`fontFamily-body, ${ne.body}`),fontWeight:k(`fontWeight-md, ${ye.md}`),fontSize:k(`fontSize-sm, ${ge.sm}`),lineHeight:k(`lineHeight-sm, ${Ne.sm}`),color:k(`palette-text-primary, ${J.palette.text.primary}`)},"body-lg":{fontFamily:k(`fontFamily-body, ${ne.body}`),fontSize:k(`fontSize-lg, ${ge.lg}`),lineHeight:k(`lineHeight-md, ${Ne.md}`),color:k(`palette-text-secondary, ${J.palette.text.secondary}`)},"body-md":{fontFamily:k(`fontFamily-body, ${ne.body}`),fontSize:k(`fontSize-md, ${ge.md}`),lineHeight:k(`lineHeight-md, ${Ne.md}`),color:k(`palette-text-secondary, ${J.palette.text.secondary}`)},"body-sm":{fontFamily:k(`fontFamily-body, ${ne.body}`),fontSize:k(`fontSize-sm, ${ge.sm}`),lineHeight:k(`lineHeight-md, ${Ne.md}`),color:k(`palette-text-tertiary, ${J.palette.text.tertiary}`)},"body-xs":{fontFamily:k(`fontFamily-body, ${ne.body}`),fontWeight:k(`fontWeight-md, ${ye.md}`),fontSize:k(`fontSize-xs, ${ge.xs}`),lineHeight:k(`lineHeight-md, ${Ne.md}`),color:k(`palette-text-tertiary, ${J.palette.text.tertiary}`)}}},Ue=z?ba(Me,z):Me,{colorSchemes:Qe}=Ue,st=Un(Ue,vJ),ct=ue({colorSchemes:Qe},st,{breakpoints:Z6(C??{}),components:ba({MuiSvgIcon:{defaultProps:{fontSize:"xl2"},styleOverrides:{root:({ownerState:ot,theme:Tt})=>{var Ct;const un=ot.instanceFontSize;return ue({margin:"var(--Icon-margin)"},ot.fontSize&&ot.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${Tt.vars.fontSize[ot.fontSize]})`},!ot.htmlColor&&ue({color:`var(--Icon-color, ${ct.vars.palette.text.icon})`},ot.color&&ot.color!=="inherit"&&Tt.vars.palette[ot.color]&&{color:`rgba(${(Ct=Tt.vars.palette[ot.color])==null?void 0:Ct.mainChannel} / 1)`}),un&&un!=="inherit"&&{"--Icon-fontSize":Tt.vars.fontSize[un]})}}}},L),cssVarPrefix:M,getCssVar:k,spacing:Q6(A)});function Xt(ot,Tt){Object.keys(Tt).forEach(Ct=>{const un={main:"500",light:"200",dark:"700"};ot==="dark"&&(un.main=400),!Tt[Ct].mainChannel&&Tt[Ct][un.main]&&(Tt[Ct].mainChannel=Kd(Tt[Ct][un.main])),!Tt[Ct].lightChannel&&Tt[Ct][un.light]&&(Tt[Ct].lightChannel=Kd(Tt[Ct][un.light])),!Tt[Ct].darkChannel&&Tt[Ct][un.dark]&&(Tt[Ct].darkChannel=Kd(Tt[Ct][un.dark]))})}Object.entries(ct.colorSchemes).forEach(([ot,Tt])=>{Xt(ot,Tt.palette)});const je={prefix:M,shouldSkipGeneratingVar:T},{vars:lt,generateCssVars:Ot}=iJ(ue({colorSchemes:Qe},st),je);ct.vars=lt,ct.generateCssVars=Ot,ct.unstable_sxConfig=ue({},fJ,e==null?void 0:e.unstable_sxConfig),ct.unstable_sx=function(Tt){return I_({sx:Tt,theme:this})},ct.getColorSchemeSelector=ot=>ot==="light"?"&":`&[data-joy-color-scheme="${ot}"], [data-joy-color-scheme="${ot}"] &`;const ut={getCssVar:k,palette:ct.colorSchemes.light.palette};return ct.variants=ba({plain:ts("plain",ut),plainHover:ts("plainHover",ut),plainActive:ts("plainActive",ut),plainDisabled:ts("plainDisabled",ut),outlined:ts("outlined",ut),outlinedHover:ts("outlinedHover",ut),outlinedActive:ts("outlinedActive",ut),outlinedDisabled:ts("outlinedDisabled",ut),soft:ts("soft",ut),softHover:ts("softHover",ut),softActive:ts("softActive",ut),softDisabled:ts("softDisabled",ut),solid:ts("solid",ut),solidHover:ts("solidHover",ut),solidActive:ts("solidActive",ut),solidDisabled:ts("solidDisabled",ut)},I),ct.palette=ue({},ct.colorSchemes.light.palette,{colorScheme:"light"}),ct.shouldSkipGeneratingVar=T,ct.applyStyles=eU,ct}const Ug=vU(),u0={attribute:"data-joy-color-scheme",colorSchemeStorageKey:"joy-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"joy-mode"},{CssVarsProvider:_J,useColorScheme:FR,getInitColorSchemeScript:uRe}=JK({themeId:C_,theme:Ug,attribute:u0.attribute,modeStorageKey:u0.modeStorageKey,colorSchemeStorageKey:u0.colorSchemeStorageKey,defaultColorScheme:{light:u0.defaultLightColorScheme,dark:u0.defaultDarkColorScheme}}),nn=sU({defaultTheme:Ug,themeId:C_});function wr({props:e,name:t}){return lU({props:e,name:t,defaultTheme:ue({},Ug,{components:{}}),themeId:C_})}function xJ(e){return ee.jsx(iK,ue({},e,{defaultTheme:Ug,themeId:C_}))}function Iz(e,t,n=(r,i)=>r===i){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}const bJ={disableDefaultClasses:!1},wJ=$.createContext(bJ);function SJ(e){const{disableDefaultClasses:t}=$.useContext(wJ);return n=>t?"":e(n)}function MJ(e){const{rootElementName:t="",componentName:n}=e,[r,i]=$.useState(t.toUpperCase()),a=$.useCallback(c=>{var o;i((o=c==null?void 0:c.tagName)!=null?o:"")},[]);return[r,a]}const yU="base";function CJ(e){return`${yU}--${e}`}function EJ(e,t){return`${yU}-${e}-${t}`}function _U(e,t){const n=iU[t];return n?CJ(n):EJ(e,t)}function TJ(e,t){const n={};return t.forEach(r=>{n[r]=_U(e,r)}),n}function Mc(e={}){const{disabled:t=!1,focusableWhenDisabled:n,href:r,rootRef:i,tabIndex:a,to:c,type:o,rootElementName:f}=e,g=$.useRef(null),[_,x]=$.useState(!1),{isFocusVisibleRef:M,onFocus:C,onBlur:A,ref:L}=LR(),[I,T]=$.useState(!1);t&&!n&&I&&T(!1),$.useEffect(()=>{M.current=I},[I,M]);const[z,k]=MJ({rootElementName:f??(r||c?"a":void 0),componentName:"Button"}),U=Ae=>ve=>{var Se;I&&ve.preventDefault(),(Se=Ae.onMouseLeave)==null||Se.call(Ae,ve)},H=Ae=>ve=>{var Se;A(ve),M.current===!1&&T(!1),(Se=Ae.onBlur)==null||Se.call(Ae,ve)},V=Ae=>ve=>{var Se;if(g.current||(g.current=ve.currentTarget),C(ve),M.current===!0){var Me;T(!0),(Me=Ae.onFocusVisible)==null||Me.call(Ae,ve)}(Se=Ae.onFocus)==null||Se.call(Ae,ve)},q=()=>{const Ae=g.current;return z==="BUTTON"||z==="INPUT"&&["button","submit","reset"].includes(Ae==null?void 0:Ae.type)||z==="A"&&(Ae==null?void 0:Ae.href)},J=Ae=>ve=>{if(!t){var Se;(Se=Ae.onClick)==null||Se.call(Ae,ve)}},Y=Ae=>ve=>{var Se;t||(x(!0),document.addEventListener("mouseup",()=>{x(!1)},{once:!0})),(Se=Ae.onMouseDown)==null||Se.call(Ae,ve)},N=Ae=>ve=>{var Se;if((Se=Ae.onKeyDown)==null||Se.call(Ae,ve),!ve.defaultMuiPrevented&&(ve.target===ve.currentTarget&&!q()&&ve.key===" "&&ve.preventDefault(),ve.target===ve.currentTarget&&ve.key===" "&&!t&&x(!0),ve.target===ve.currentTarget&&!q()&&ve.key==="Enter"&&!t)){var Me;(Me=Ae.onClick)==null||Me.call(Ae,ve),ve.preventDefault()}},ne=Ae=>ve=>{var Se;if(ve.target===ve.currentTarget&&x(!1),(Se=Ae.onKeyUp)==null||Se.call(Ae,ve),ve.target===ve.currentTarget&&!q()&&!t&&ve.key===" "&&!ve.defaultMuiPrevented){var Me;(Me=Ae.onClick)==null||Me.call(Ae,ve)}},ye=Ur(k,i,L,g),ge={};return a!==void 0&&(ge.tabIndex=a),z==="BUTTON"?(ge.type=o??"button",n?ge["aria-disabled"]=t:ge.disabled=t):z==="INPUT"?o&&["button","submit","reset"].includes(o)&&(n?ge["aria-disabled"]=t:ge.disabled=t):z!==""&&(!r&&!c&&(ge.role="button",ge.tabIndex=a??0),t&&(ge["aria-disabled"]=t,ge.tabIndex=n?a??0:-1)),{getRootProps:(Ae={})=>{const ve=ue({},ho(e),ho(Ae)),Se=ue({type:o},ve,ge,Ae,{onBlur:H(ve),onClick:J(ve),onFocus:V(ve),onKeyDown:N(ve),onKeyUp:ne(ve),onMouseDown:Y(ve),onMouseLeave:U(ve),ref:ye});return delete Se.onFocusVisible,Se},focusVisible:I,setFocusVisible:T,active:_,rootRef:ye}}function Rz(e){return e.substring(2).toLowerCase()}function PJ(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function AJ(e){const{children:t,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:i,touchEvent:a="onTouchEnd"}=e,c=$.useRef(!1),o=$.useRef(null),f=$.useRef(!1),g=$.useRef(!1);$.useEffect(()=>(setTimeout(()=>{f.current=!0},0),()=>{f.current=!1}),[]);const _=Ur(cM(t),o),x=Tl(A=>{const L=g.current;g.current=!1;const I=wa(o.current);if(!f.current||!o.current||"clientX"in A&&PJ(A,I))return;if(c.current){c.current=!1;return}let T;A.composedPath?T=A.composedPath().indexOf(o.current)>-1:T=!I.documentElement.contains(A.target)||o.current.contains(A.target),!T&&(n||!L)&&i(A)}),M=A=>L=>{g.current=!0;const I=t.props[A];I&&I(L)},C={ref:_};return a!==!1&&(C[a]=M(a)),$.useEffect(()=>{if(a!==!1){const A=Rz(a),L=wa(o.current),I=()=>{c.current=!0};return L.addEventListener(A,x),L.addEventListener("touchmove",I),()=>{L.removeEventListener(A,x),L.removeEventListener("touchmove",I)}}},[x,a]),r!==!1&&(C[r]=M(r)),$.useEffect(()=>{if(r!==!1){const A=Rz(r),L=wa(o.current);return L.addEventListener(A,x),()=>{L.removeEventListener(A,x)}}},[x,r]),ee.jsx($.Fragment,{children:$.cloneElement(t,C)})}const uM=$.createContext(null);function IJ(e,t){return e===t}const YC={},Lz=()=>{};function EP(e,t){const n=ue({},e);return Object.keys(t).forEach(r=>{t[r]!==void 0&&(n[r]=t[r])}),n}function RJ(e){const{nextState:t,initialState:n,stateComparers:r,onStateChange:i,controlledProps:a,lastActionRef:c}=e,o=$.useRef(n);$.useEffect(()=>{if(c.current===null)return;const f=EP(o.current,a);Object.keys(t).forEach(g=>{var _;const x=(_=r[g])!=null?_:IJ,M=t[g],C=f[g];if(C==null&&M!=null||C!=null&&M==null||C!=null&&M!=null&&!x(M,C)){var A,L;i==null||i((A=c.current.event)!=null?A:null,g,M,(L=c.current.type)!=null?L:"",t)}}),o.current=t,c.current=null},[o,t,c,i,r,a])}function xU(e){const t=$.useRef(null),{reducer:n,initialState:r,controlledProps:i=YC,stateComparers:a=YC,onStateChange:c=Lz,actionContext:o,componentName:f=""}=e;$.useRef(i);const g=$.useCallback((C,A)=>{t.current=A;const L=EP(C,i);return n(L,A)},[i,n]),[_,x]=$.useReducer(g,r),M=$.useCallback(C=>{x(ue({},C,{context:o}))},[o]);return RJ({nextState:_,initialState:r,stateComparers:a??YC,onStateChange:c??Lz,controlledProps:i,lastActionRef:t}),[EP(_,i),M]}const Cl={blur:"dropdown:blur",escapeKeyDown:"dropdown:escapeKeyDown",toggle:"dropdown:toggle",open:"dropdown:open",close:"dropdown:close"};function LJ(e,t){switch(t.type){case Cl.blur:return{open:!1,changeReason:t.event};case Cl.escapeKeyDown:return{open:!1,changeReason:t.event};case Cl.toggle:return{open:!e.open,changeReason:t.event};case Cl.open:return{open:!0,changeReason:t.event};case Cl.close:return{open:!1,changeReason:t.event};default:throw new Error("Unhandled action")}}function kJ(e={}){const{defaultOpen:t,onOpenChange:n,open:r,componentName:i="useDropdown"}=e,[a,c]=$.useState(""),[o,f]=$.useState(null),g=$.useRef(null),_=$.useCallback((L,I,T,z)=>{I==="open"&&(n==null||n(L,T)),g.current=z},[n]),x=$.useMemo(()=>r!==void 0?{open:r}:{},[r]),[M,C]=xU({controlledProps:x,initialState:t?{open:!0,changeReason:null}:{open:!1,changeReason:null},onStateChange:_,reducer:LJ,componentName:i});return $.useEffect(()=>{!M.open&&g.current!==null&&g.current!==Cl.blur&&(o==null||o.focus())},[M.open,o]),{contextValue:{state:M,dispatch:C,popupId:a,registerPopup:c,registerTrigger:f,triggerElement:o},open:M.open}}function DJ(e){const{children:t,open:n,defaultOpen:r,onOpenChange:i}=e,{contextValue:a}=kJ({defaultOpen:r,onOpenChange:i,open:n});return ee.jsx(uM.Provider,{value:a,children:t})}const zJ=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function OJ(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:t}function FJ(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const t=r=>e.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=t(`[name="${e.name}"]:checked`);return n||(n=t(`[name="${e.name}"]`)),n!==e}function NJ(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||FJ(e))}function BJ(e){const t=[],n=[];return Array.from(e.querySelectorAll(zJ)).forEach((r,i)=>{const a=OJ(r);a===-1||!NJ(r)||(a===0?t.push(r):n.push({documentOrder:i,tabIndex:a,node:r}))}),n.sort((r,i)=>r.tabIndex===i.tabIndex?r.documentOrder-i.documentOrder:r.tabIndex-i.tabIndex).map(r=>r.node).concat(t)}function UJ(){return!0}function $J(e){const{children:t,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:i=!1,getTabbable:a=BJ,isEnabled:c=UJ,open:o}=e,f=$.useRef(!1),g=$.useRef(null),_=$.useRef(null),x=$.useRef(null),M=$.useRef(null),C=$.useRef(!1),A=$.useRef(null),L=Ur(cM(t),A),I=$.useRef(null);$.useEffect(()=>{!o||!A.current||(C.current=!n)},[n,o]),$.useEffect(()=>{if(!o||!A.current)return;const k=wa(A.current);return A.current.contains(k.activeElement)||(A.current.hasAttribute("tabIndex")||A.current.setAttribute("tabIndex","-1"),C.current&&A.current.focus()),()=>{i||(x.current&&x.current.focus&&(f.current=!0,x.current.focus()),x.current=null)}},[o]),$.useEffect(()=>{if(!o||!A.current)return;const k=wa(A.current),U=q=>{I.current=q,!(r||!c()||q.key!=="Tab")&&k.activeElement===A.current&&q.shiftKey&&(f.current=!0,_.current&&_.current.focus())},H=()=>{const q=A.current;if(q===null)return;if(!k.hasFocus()||!c()||f.current){f.current=!1;return}if(q.contains(k.activeElement)||r&&k.activeElement!==g.current&&k.activeElement!==_.current)return;if(k.activeElement!==M.current)M.current=null;else if(M.current!==null)return;if(!C.current)return;let J=[];if((k.activeElement===g.current||k.activeElement===_.current)&&(J=a(A.current)),J.length>0){var Y,N;const ne=!!((Y=I.current)!=null&&Y.shiftKey&&((N=I.current)==null?void 0:N.key)==="Tab"),ye=J[0],ge=J[J.length-1];typeof ye!="string"&&typeof ge!="string"&&(ne?ge.focus():ye.focus())}else q.focus()};k.addEventListener("focusin",H),k.addEventListener("keydown",U,!0);const V=setInterval(()=>{k.activeElement&&k.activeElement.tagName==="BODY"&&H()},50);return()=>{clearInterval(V),k.removeEventListener("focusin",H),k.removeEventListener("keydown",U,!0)}},[n,r,i,c,o,a]);const T=k=>{x.current===null&&(x.current=k.relatedTarget),C.current=!0,M.current=k.target;const U=t.props.onFocus;U&&U(k)},z=k=>{x.current===null&&(x.current=k.relatedTarget),C.current=!0};return ee.jsxs($.Fragment,{children:[ee.jsx("div",{tabIndex:o?0:-1,onFocus:z,ref:g,"data-testid":"sentinelStart"}),$.cloneElement(t,{ref:L,onFocus:T}),ee.jsx("div",{tabIndex:o?0:-1,onFocus:z,ref:_,"data-testid":"sentinelEnd"})]})}const VJ=$.createContext(void 0);function jJ(){return $.useContext(VJ)}function HJ(e={}){const{defaultValue:t,disabled:n=!1,error:r=!1,onBlur:i,onChange:a,onFocus:c,required:o=!1,value:f,inputRef:g}=e,_=jJ();let x,M,C,A,L;if(_){var I,T,z;x=void 0,M=(I=_.disabled)!=null?I:!1,C=(T=_.error)!=null?T:!1,A=(z=_.required)!=null?z:!1,L=_.value}else x=t,M=n,C=r,A=o,L=f;const{current:k}=$.useRef(L!=null),U=$.useCallback(Ae=>{},[]),H=$.useRef(null),V=Ur(H,g,U),[q,J]=$.useState(!1);$.useEffect(()=>{!_&&M&&q&&(J(!1),i==null||i())},[_,M,q,i]);const Y=Ae=>ve=>{var Se;if(_!=null&&_.disabled){ve.stopPropagation();return}if((Se=Ae.onFocus)==null||Se.call(Ae,ve),_&&_.onFocus){var Me;_==null||(Me=_.onFocus)==null||Me.call(_)}else J(!0)},N=Ae=>ve=>{var Se;(Se=Ae.onBlur)==null||Se.call(Ae,ve),_&&_.onBlur?_.onBlur():J(!1)},ne=Ae=>(ve,...Se)=>{var Me,Ue;if(!k&&(ve.target||H.current)==null)throw new Error(Fy(17));_==null||(Me=_.onChange)==null||Me.call(_,ve),(Ue=Ae.onChange)==null||Ue.call(Ae,ve,...Se)},ye=Ae=>ve=>{var Se;H.current&&ve.currentTarget===ve.target&&H.current.focus(),(Se=Ae.onClick)==null||Se.call(Ae,ve)};return{disabled:M,error:C,focused:q,formControlContext:_,getInputProps:(Ae={})=>{const Se=ue({},{onBlur:i,onChange:a,onFocus:c},ho(Ae)),Me=ue({},Se,{onBlur:N(Se),onChange:ne(Se),onFocus:Y(Se)});return ue({},Me,{"aria-invalid":C||void 0,defaultValue:x,value:L,required:A,disabled:M},Ae,{ref:V},Me)},getRootProps:(Ae={})=>{const ve=ho(e,["onBlur","onChange","onFocus"]),Se=ue({},ve,ho(Ae));return ue({},Ae,Se,{onClick:ye(Se)})},inputRef:V,required:A,value:L}}const Xr={blur:"list:blur",focus:"list:focus",itemClick:"list:itemClick",itemHover:"list:itemHover",itemsChange:"list:itemsChange",keyDown:"list:keyDown",resetHighlight:"list:resetHighlight",highlightLast:"list:highlightLast",textNavigation:"list:textNavigation",clearSelection:"list:clearSelection"};function GJ(e,t,n,r,i,a){if(n.length===0||!r&&n.every((o,f)=>i(o,f)))return-1;let c=e;for(;;){if(!a&&t==="next"&&c===n.length||!a&&t==="previous"&&c===-1)return-1;if(r?!1:i(n[c],c))c+=t==="next"?1:-1,a&&(c=(c+n.length)%n.length);else return c}}function Mo(e,t,n){var r;const{items:i,isItemDisabled:a,disableListWrap:c,disabledItemsFocusable:o,itemComparer:f,focusManagement:g}=n,_=g==="DOM"?0:-1,x=i.length-1,M=e==null?-1:i.findIndex(T=>f(T,e));let C,A,L=!c;switch(t){case"reset":if(_===-1)return null;C=0,A="next",L=!1;break;case"start":C=0,A="next",L=!1;break;case"end":C=x,A="previous",L=!1;break;default:{const T=M+t;T<0?!L&&M!==-1||Math.abs(t)>1?(C=0,A="next"):(C=x,A="previous"):T>x?!L||Math.abs(t)>1?(C=x,A="previous"):(C=0,A="next"):(C=T,A=t>=0?"next":"previous")}}const I=GJ(C,A,i,o,a,L);return I===-1&&e!==null&&!a(e,M)?e:(r=i[I])!=null?r:null}function WJ(e,t,n,r){return n==="none"?[]:n==="single"?r(t[0],e)?t:[e]:t.some(i=>r(i,e))?t.filter(i=>!r(i,e)):[...t,e]}function NR(e,t,n){const{itemComparer:r,isItemDisabled:i,selectionMode:a,items:c}=n,{selectedValues:o}=t,f=c.findIndex(_=>r(e,_));if(i(e,f))return t;const g=WJ(e,o,a,r);return ue({},t,{selectedValues:g,highlightedValue:e})}function qJ(e,t,n){const r=t.highlightedValue,{orientation:i,pageSize:a}=n;switch(e){case"Home":return ue({},t,{highlightedValue:Mo(r,"start",n)});case"End":return ue({},t,{highlightedValue:Mo(r,"end",n)});case"PageUp":return ue({},t,{highlightedValue:Mo(r,-a,n)});case"PageDown":return ue({},t,{highlightedValue:Mo(r,a,n)});case"ArrowUp":if(i!=="vertical")break;return ue({},t,{highlightedValue:Mo(r,-1,n)});case"ArrowDown":if(i!=="vertical")break;return ue({},t,{highlightedValue:Mo(r,1,n)});case"ArrowLeft":{if(i==="vertical")break;return ue({},t,{highlightedValue:Mo(r,i==="horizontal-ltr"?-1:1,n)})}case"ArrowRight":{if(i==="vertical")break;return ue({},t,{highlightedValue:Mo(r,i==="horizontal-ltr"?1:-1,n)})}case"Enter":case" ":return t.highlightedValue===null?t:NR(t.highlightedValue,t,n)}return t}function XJ(e,t){return t.focusManagement==="DOM"?e:ue({},e,{highlightedValue:null})}function ZJ(e,t,n){var r;const i=(r=n(e))==null?void 0:r.trim().toLowerCase();return!i||i.length===0?!1:i.indexOf(t)===0}function YJ(e,t,n){const{items:r,isItemDisabled:i,disabledItemsFocusable:a,getItemAsString:c}=n,o=t.length>1;let f=o?e.highlightedValue:Mo(e.highlightedValue,1,n);for(let g=0;g<r.length;g+=1){if(!f||!o&&e.highlightedValue===f)return e;if(ZJ(f,t,c)&&(!i(f,r.indexOf(f))||a))return ue({},e,{highlightedValue:f});f=Mo(f,1,n)}return e}function KJ(e,t,n,r){var i;const{itemComparer:a,focusManagement:c}=r;let o=null;if(n.highlightedValue!=null){var f;o=(f=e.find(x=>a(x,n.highlightedValue)))!=null?f:null}else c==="DOM"&&t.length===0&&(o=Mo(null,"reset",r));const _=((i=n.selectedValues)!=null?i:[]).filter(x=>e.some(M=>a(M,x)));return ue({},n,{highlightedValue:o,selectedValues:_})}function JJ(e,t){return ue({},e,{highlightedValue:Mo(null,"reset",t)})}function QJ(e,t){return ue({},e,{highlightedValue:Mo(null,"end",t)})}function eQ(e,t){return ue({},e,{selectedValues:[],highlightedValue:Mo(null,"reset",t)})}function hM(e,t){const{type:n,context:r}=t;switch(n){case Xr.keyDown:return qJ(t.key,e,r);case Xr.itemClick:return NR(t.item,e,r);case Xr.blur:return XJ(e,r);case Xr.textNavigation:return YJ(e,t.searchString,r);case Xr.itemsChange:return KJ(t.items,t.previousItems,e,r);case Xr.resetHighlight:return JJ(e,r);case Xr.highlightLast:return QJ(e,r);case Xr.clearSelection:return eQ(e,r);default:return e}}const tQ=500;function nQ(e){const t=$.useRef({searchString:"",lastTime:null});return $.useCallback(n=>{if(n.key.length===1&&n.key!==" "){const r=t.current,i=n.key.toLowerCase(),a=performance.now();r.searchString.length>0&&r.lastTime&&a-r.lastTime>tQ?r.searchString=i:(r.searchString.length!==1||i!==r.searchString)&&(r.searchString+=i),r.lastTime=a,e(r.searchString,n)}},[e])}const kz={},rQ=()=>{},iQ=(e,t)=>e===t,oQ=()=>!1,sQ=e=>typeof e=="string"?e:String(e),aQ=()=>({highlightedValue:null,selectedValues:[]});function BR(e){const{controlledProps:t=kz,disabledItemsFocusable:n=!1,disableListWrap:r=!1,focusManagement:i="activeDescendant",getInitialState:a=aQ,getItemDomElement:c,getItemId:o,isItemDisabled:f=oQ,rootRef:g,onStateChange:_=rQ,items:x,itemComparer:M=iQ,getItemAsString:C=sQ,onChange:A,onHighlightChange:L,onItemsChange:I,orientation:T="vertical",pageSize:z=5,reducerActionContext:k=kz,selectionMode:U="single",stateReducer:H,componentName:V="useList"}=e,q=$.useRef(null),J=Ur(g,q),Y=$.useCallback((ut,ot,Tt)=>{if(L==null||L(ut,ot,Tt),i==="DOM"&&ot!=null&&(Tt===Xr.itemClick||Tt===Xr.keyDown||Tt===Xr.textNavigation)){var Ct;c==null||(Ct=c(ot))==null||Ct.focus()}},[c,L,i]),N=$.useMemo(()=>({highlightedValue:M,selectedValues:(ut,ot)=>Iz(ut,ot,M)}),[M]),ne=$.useCallback((ut,ot,Tt,Ct,un)=>{switch(_==null||_(ut,ot,Tt,Ct,un),ot){case"highlightedValue":Y(ut,Tt,Ct);break;case"selectedValues":A==null||A(ut,Tt,Ct);break}},[Y,A,_]),ye=$.useMemo(()=>({disabledItemsFocusable:n,disableListWrap:r,focusManagement:i,isItemDisabled:f,itemComparer:M,items:x,getItemAsString:C,onHighlightChange:Y,orientation:T,pageSize:z,selectionMode:U,stateComparers:N}),[n,r,i,f,M,x,C,Y,T,z,U,N]),ge=a(),Ne=H??hM,Ae=$.useMemo(()=>ue({},k,ye),[k,ye]),[ve,Se]=xU({reducer:Ne,actionContext:Ae,initialState:ge,controlledProps:t,stateComparers:N,onStateChange:ne,componentName:V}),{highlightedValue:Me,selectedValues:Ue}=ve,Qe=nQ((ut,ot)=>Se({type:Xr.textNavigation,event:ot,searchString:ut})),st=$.useRef([]);$.useEffect(()=>{Iz(st.current,x,M)||(Se({type:Xr.itemsChange,event:null,items:x,previousItems:st.current}),st.current=x,I==null||I(x))},[x,M,Se,I]);const ct=ut=>ot=>{var Tt;if((Tt=ut.onKeyDown)==null||Tt.call(ut,ot),ot.defaultMuiPrevented)return;const Ct=["Home","End","PageUp","PageDown"];T==="vertical"?Ct.push("ArrowUp","ArrowDown"):Ct.push("ArrowLeft","ArrowRight"),i==="activeDescendant"&&Ct.push(" ","Enter"),Ct.includes(ot.key)&&ot.preventDefault(),Se({type:Xr.keyDown,key:ot.key,event:ot}),Qe(ot)},Xt=ut=>ot=>{var Tt,Ct;(Tt=ut.onBlur)==null||Tt.call(ut,ot),!ot.defaultMuiPrevented&&((Ct=q.current)!=null&&Ct.contains(ot.relatedTarget)||Se({type:Xr.blur,event:ot}))},je=(ut={})=>{const ot=ho(ut);return ue({},ut,{"aria-activedescendant":i==="activeDescendant"&&Me!=null?o(Me):void 0,tabIndex:i==="DOM"?-1:0,ref:J},ot,{onBlur:Xt(ot),onKeyDown:ct(ot)})},lt=$.useCallback(ut=>{const ot=(Ue??[]).some(un=>un!=null&&M(ut,un)),Tt=Me!=null&&M(ut,Me);return{focusable:i==="DOM",highlighted:Tt,selected:ot}},[M,Ue,Me,i]),Ot=$.useMemo(()=>({dispatch:Se,getItemState:lt}),[Se,lt]);return $.useDebugValue({state:ve}),{contextValue:Ot,dispatch:Se,getRootProps:je,rootRef:J,state:ve}}const Jh=$.createContext(null);function UR(e){const{handlePointerOverEvents:t=!1,item:n}=e,r=$.useContext(Jh);if(!r)throw new Error("useListItem must be used within a ListProvider");const{dispatch:i,getItemState:a}=r,{highlighted:c,selected:o,focusable:f}=a(n),g=$.useCallback(C=>A=>{var L;(L=C.onClick)==null||L.call(C,A),!A.defaultPrevented&&i({type:Xr.itemClick,item:n,event:A})},[i,n]),_=$.useCallback(C=>A=>{var L;(L=C.onMouseOver)==null||L.call(C,A),!A.defaultPrevented&&i({type:Xr.itemHover,item:n,event:A})},[i,n]);let x;return f&&(x=c?0:-1),{getRootProps:(C={})=>{const A=ho(C);return ue({},C,{onClick:g(A),onPointerOver:t?_(A):void 0,tabIndex:x})},highlighted:c,selected:o}}function lQ(e,t){if(t.type===Xr.itemHover)return ue({},e,{highlightedValue:t.item});const n=hM(e,t);if(n.highlightedValue===null&&t.context.items.length>0)return ue({},n,{highlightedValue:t.context.items[0]});if(t.type===Xr.keyDown&&t.event.key==="Escape")return ue({},n,{open:!1});if(t.type===Xr.blur){var r;if(!((r=t.context.listboxRef.current)!=null&&r.contains(t.event.relatedTarget))){var i,a;const c=(i=t.context.listboxRef.current)==null?void 0:i.getAttribute("id"),o=(a=t.event.relatedTarget)==null?void 0:a.getAttribute("aria-controls");return c&&o&&c===o?n:ue({},n,{open:!1,highlightedValue:t.context.items[0]})}}return n}const L_=$.createContext(null);function cQ(e){const t=Array.from(e.keys()).map(n=>{const r=e.get(n);return{key:n,subitem:r}});return t.sort((n,r)=>{const i=n.subitem.ref.current,a=r.subitem.ref.current;return i===null||a===null||i===a?0:i.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_PRECEDING?1:-1}),new Map(t.map(n=>[n.key,n.subitem]))}function dM(){const[e,t]=$.useState(new Map),n=$.useRef(new Set),r=$.useCallback(function(g){n.current.delete(g),t(_=>{const x=new Map(_);return x.delete(g),x})},[]),i=$.useCallback(function(g,_){let x;return typeof g=="function"?x=g(n.current):x=g,n.current.add(x),t(M=>{const C=new Map(M);return C.set(x,_),C}),{id:x,deregister:()=>r(x)}},[r]),a=$.useMemo(()=>cQ(e),[e]),c=$.useCallback(function(g){return Array.from(a.keys()).indexOf(g)},[a]);return{contextValue:$.useMemo(()=>({getItemIndex:c,registerItem:i,totalSubitemCount:e.size}),[c,i,e.size]),subitems:a}}function fM(e,t){const n=$.useContext(L_);if(n===null)throw new Error("useCompoundItem must be used within a useCompoundParent");const{registerItem:r}=n,[i,a]=$.useState(typeof e=="function"?void 0:e);return su(()=>{const{id:c,deregister:o}=r(e,t);return a(c),o},[r,t,e]),{id:i,index:i!==void 0?n.getItemIndex(i):-1,totalItemCount:n.totalSubitemCount}}function au(e,t){return function(r={}){const i=ue({},r,e(r));return ue({},i,t(i))}}const uQ={dispatch:()=>{},popupId:"",registerPopup:()=>{},registerTrigger:()=>{},state:{open:!0,changeReason:null},triggerElement:null};function hQ(e={}){var t,n;const{listboxRef:r,onItemsChange:i,id:a,disabledItemsFocusable:c=!0,disableListWrap:o=!1,autoFocus:f=!0,componentName:g="useMenu"}=e,_=$.useRef(null),x=Ur(_,r),M=(t=qs(a))!=null?t:"",{state:{open:C,changeReason:A},dispatch:L,triggerElement:I,registerPopup:T}=(n=$.useContext(uM))!=null?n:uQ,z=$.useRef(C),{subitems:k,contextValue:U}=dM(),H=$.useMemo(()=>Array.from(k.keys()),[k]),V=$.useCallback(Ue=>{var Qe,st;return Ue==null?null:(Qe=(st=k.get(Ue))==null?void 0:st.ref.current)!=null?Qe:null},[k]),q=$.useCallback(Ue=>{var Qe;return(k==null||(Qe=k.get(Ue))==null?void 0:Qe.disabled)||!1},[k]),J=$.useCallback(Ue=>{var Qe,st;return((Qe=k.get(Ue))==null?void 0:Qe.label)||((st=k.get(Ue))==null||(st=st.ref.current)==null?void 0:st.innerText)},[k]),Y=$.useMemo(()=>({listboxRef:_}),[_]),{dispatch:N,getRootProps:ne,contextValue:ye,state:{highlightedValue:ge},rootRef:Ne}=BR({disabledItemsFocusable:c,disableListWrap:o,focusManagement:"DOM",getItemDomElement:V,getInitialState:()=>({selectedValues:[],highlightedValue:null}),isItemDisabled:q,items:H,getItemAsString:J,rootRef:x,onItemsChange:i,reducerActionContext:Y,selectionMode:"none",stateReducer:lQ,componentName:g});su(()=>{T(M)},[M,T]),su(()=>{C&&(A==null?void 0:A.type)==="keydown"&&A.key==="ArrowUp"&&N({type:Xr.highlightLast,event:A})},[C,A,N]),$.useEffect(()=>{if(C&&f&&ge&&!z.current){var Ue;(Ue=k.get(ge))==null||(Ue=Ue.ref)==null||(Ue=Ue.current)==null||Ue.focus()}},[C,f,ge,k,H]),$.useEffect(()=>{var Ue;if((Ue=_.current)!=null&&Ue.contains(document.activeElement)&&ge!==null){var Qe;k==null||(Qe=k.get(ge))==null||(Qe=Qe.ref.current)==null||Qe.focus()}},[ge,k]);const Ae=Ue=>Qe=>{var st,ct;(st=Ue.onBlur)==null||st.call(Ue,Qe),!Qe.defaultMuiPrevented&&((ct=_.current)!=null&&ct.contains(Qe.relatedTarget)||Qe.relatedTarget===I||L({type:Cl.blur,event:Qe}))},ve=Ue=>Qe=>{var st;(st=Ue.onKeyDown)==null||st.call(Ue,Qe),!Qe.defaultMuiPrevented&&Qe.key==="Escape"&&L({type:Cl.escapeKeyDown,event:Qe})},Se=(Ue={})=>({onBlur:Ae(Ue),onKeyDown:ve(Ue)}),Me=(Ue={})=>{const Qe=au(Se,ne),st=ho(Ue);return ue({},Ue,st,Qe(st),{id:M,role:"menu"})};return $.useDebugValue({subitems:k,highlightedValue:ge}),{contextValue:ue({},U,ye),dispatch:N,getListboxProps:Me,highlightedValue:ge,listboxRef:Ne,menuItems:k,open:C,triggerElement:I}}function dQ(e){const{value:t,children:n}=e,{dispatch:r,getItemIndex:i,getItemState:a,registerItem:c,totalSubitemCount:o}=t,f=$.useMemo(()=>({dispatch:r,getItemState:a,getItemIndex:i}),[r,i,a]),g=$.useMemo(()=>({getItemIndex:i,registerItem:c,totalSubitemCount:o}),[c,i,o]);return ee.jsx(L_.Provider,{value:g,children:ee.jsx(Jh.Provider,{value:f,children:n})})}var bU={exports:{}},Aa={},wU={exports:{}},SU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Me,Ue){var Qe=Me.length;Me.push(Ue);e:for(;0<Qe;){var st=Qe-1>>>1,ct=Me[st];if(0<i(ct,Ue))Me[st]=Ue,Me[Qe]=ct,Qe=st;else break e}}function n(Me){return Me.length===0?null:Me[0]}function r(Me){if(Me.length===0)return null;var Ue=Me[0],Qe=Me.pop();if(Qe!==Ue){Me[0]=Qe;e:for(var st=0,ct=Me.length,Xt=ct>>>1;st<Xt;){var je=2*(st+1)-1,lt=Me[je],Ot=je+1,ut=Me[Ot];if(0>i(lt,Qe))Ot<ct&&0>i(ut,lt)?(Me[st]=ut,Me[Ot]=Qe,st=Ot):(Me[st]=lt,Me[je]=Qe,st=je);else if(Ot<ct&&0>i(ut,Qe))Me[st]=ut,Me[Ot]=Qe,st=Ot;else break e}}return Ue}function i(Me,Ue){var Qe=Me.sortIndex-Ue.sortIndex;return Qe!==0?Qe:Me.id-Ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var c=Date,o=c.now();e.unstable_now=function(){return c.now()-o}}var f=[],g=[],_=1,x=null,M=3,C=!1,A=!1,L=!1,I=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(Me){for(var Ue=n(g);Ue!==null;){if(Ue.callback===null)r(g);else if(Ue.startTime<=Me)r(g),Ue.sortIndex=Ue.expirationTime,t(f,Ue);else break;Ue=n(g)}}function U(Me){if(L=!1,k(Me),!A)if(n(f)!==null)A=!0,ve(H);else{var Ue=n(g);Ue!==null&&Se(U,Ue.startTime-Me)}}function H(Me,Ue){A=!1,L&&(L=!1,T(J),J=-1),C=!0;var Qe=M;try{for(k(Ue),x=n(f);x!==null&&(!(x.expirationTime>Ue)||Me&&!ne());){var st=x.callback;if(typeof st=="function"){x.callback=null,M=x.priorityLevel;var ct=st(x.expirationTime<=Ue);Ue=e.unstable_now(),typeof ct=="function"?x.callback=ct:x===n(f)&&r(f),k(Ue)}else r(f);x=n(f)}if(x!==null)var Xt=!0;else{var je=n(g);je!==null&&Se(U,je.startTime-Ue),Xt=!1}return Xt}finally{x=null,M=Qe,C=!1}}var V=!1,q=null,J=-1,Y=5,N=-1;function ne(){return!(e.unstable_now()-N<Y)}function ye(){if(q!==null){var Me=e.unstable_now();N=Me;var Ue=!0;try{Ue=q(!0,Me)}finally{Ue?ge():(V=!1,q=null)}}else V=!1}var ge;if(typeof z=="function")ge=function(){z(ye)};else if(typeof MessageChannel<"u"){var Ne=new MessageChannel,Ae=Ne.port2;Ne.port1.onmessage=ye,ge=function(){Ae.postMessage(null)}}else ge=function(){I(ye,0)};function ve(Me){q=Me,V||(V=!0,ge())}function Se(Me,Ue){J=I(function(){Me(e.unstable_now())},Ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Me){Me.callback=null},e.unstable_continueExecution=function(){A||C||(A=!0,ve(H))},e.unstable_forceFrameRate=function(Me){0>Me||125<Me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<Me?Math.floor(1e3/Me):5},e.unstable_getCurrentPriorityLevel=function(){return M},e.unstable_getFirstCallbackNode=function(){return n(f)},e.unstable_next=function(Me){switch(M){case 1:case 2:case 3:var Ue=3;break;default:Ue=M}var Qe=M;M=Ue;try{return Me()}finally{M=Qe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Me,Ue){switch(Me){case 1:case 2:case 3:case 4:case 5:break;default:Me=3}var Qe=M;M=Me;try{return Ue()}finally{M=Qe}},e.unstable_scheduleCallback=function(Me,Ue,Qe){var st=e.unstable_now();switch(typeof Qe=="object"&&Qe!==null?(Qe=Qe.delay,Qe=typeof Qe=="number"&&0<Qe?st+Qe:st):Qe=st,Me){case 1:var ct=-1;break;case 2:ct=250;break;case 5:ct=1073741823;break;case 4:ct=1e4;break;default:ct=5e3}return ct=Qe+ct,Me={id:_++,callback:Ue,priorityLevel:Me,startTime:Qe,expirationTime:ct,sortIndex:-1},Qe>st?(Me.sortIndex=Qe,t(g,Me),n(f)===null&&Me===n(g)&&(L?(T(J),J=-1):L=!0,Se(U,Qe-st))):(Me.sortIndex=ct,t(f,Me),A||C||(A=!0,ve(H))),Me},e.unstable_shouldYield=ne,e.unstable_wrapCallback=function(Me){var Ue=M;return function(){var Qe=M;M=Ue;try{return Me.apply(this,arguments)}finally{M=Qe}}}})(SU);wU.exports=SU;var fQ=wU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pQ=$,Ea=fQ;function dn(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var MU=new Set,Vy={};function Hf(e,t){fg(e,t),fg(e+"Capture",t)}function fg(e,t){for(Vy[e]=t,e=0;e<t.length;e++)MU.add(t[e])}var lu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),TP=Object.prototype.hasOwnProperty,mQ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Dz={},zz={};function gQ(e){return TP.call(zz,e)?!0:TP.call(Dz,e)?!1:mQ.test(e)?zz[e]=!0:(Dz[e]=!0,!1)}function vQ(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function yQ(e,t,n,r){if(t===null||typeof t>"u"||vQ(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ms(e,t,n,r,i,a,c){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=c}var Wo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Wo[e]=new Ms(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Wo[t]=new Ms(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Wo[e]=new Ms(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Wo[e]=new Ms(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Wo[e]=new Ms(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Wo[e]=new Ms(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Wo[e]=new Ms(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Wo[e]=new Ms(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Wo[e]=new Ms(e,5,!1,e.toLowerCase(),null,!1,!1)});var $R=/[\-:]([a-z])/g;function VR(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($R,VR);Wo[t]=new Ms(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($R,VR);Wo[t]=new Ms(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($R,VR);Wo[t]=new Ms(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Wo[e]=new Ms(e,1,!1,e.toLowerCase(),null,!1,!1)});Wo.xlinkHref=new Ms("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Wo[e]=new Ms(e,1,!1,e.toLowerCase(),null,!0,!0)});function jR(e,t,n,r){var i=Wo.hasOwnProperty(t)?Wo[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(yQ(t,n,i,r)&&(n=null),r||i===null?gQ(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var _u=pQ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,P1=Symbol.for("react.element"),Em=Symbol.for("react.portal"),Tm=Symbol.for("react.fragment"),HR=Symbol.for("react.strict_mode"),PP=Symbol.for("react.profiler"),CU=Symbol.for("react.provider"),EU=Symbol.for("react.context"),GR=Symbol.for("react.forward_ref"),AP=Symbol.for("react.suspense"),IP=Symbol.for("react.suspense_list"),WR=Symbol.for("react.memo"),hh=Symbol.for("react.lazy"),TU=Symbol.for("react.offscreen"),Oz=Symbol.iterator;function h0(e){return e===null||typeof e!="object"?null:(e=Oz&&e[Oz]||e["@@iterator"],typeof e=="function"?e:null)}var bi=Object.assign,KC;function $0(e){if(KC===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);KC=t&&t[1]||""}return`
`+KC+e}var JC=!1;function QC(e,t){if(!e||JC)return"";JC=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(g){var r=g}Reflect.construct(e,[],t)}else{try{t.call()}catch(g){r=g}e.call(t.prototype)}else{try{throw Error()}catch(g){r=g}e()}}catch(g){if(g&&r&&typeof g.stack=="string"){for(var i=g.stack.split(`
`),a=r.stack.split(`
`),c=i.length-1,o=a.length-1;1<=c&&0<=o&&i[c]!==a[o];)o--;for(;1<=c&&0<=o;c--,o--)if(i[c]!==a[o]){if(c!==1||o!==1)do if(c--,o--,0>o||i[c]!==a[o]){var f=`
`+i[c].replace(" at new "," at ");return e.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",e.displayName)),f}while(1<=c&&0<=o);break}}}finally{JC=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?$0(e):""}function _Q(e){switch(e.tag){case 5:return $0(e.type);case 16:return $0("Lazy");case 13:return $0("Suspense");case 19:return $0("SuspenseList");case 0:case 2:case 15:return e=QC(e.type,!1),e;case 11:return e=QC(e.type.render,!1),e;case 1:return e=QC(e.type,!0),e;default:return""}}function RP(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Tm:return"Fragment";case Em:return"Portal";case PP:return"Profiler";case HR:return"StrictMode";case AP:return"Suspense";case IP:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case EU:return(e.displayName||"Context")+".Consumer";case CU:return(e._context.displayName||"Context")+".Provider";case GR:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case WR:return t=e.displayName||null,t!==null?t:RP(e.type)||"Memo";case hh:t=e._payload,e=e._init;try{return RP(e(t))}catch{}}return null}function xQ(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return RP(t);case 8:return t===HR?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Bh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function PU(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function bQ(e){var t=PU(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(c){r=""+c,a.call(this,c)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(c){r=""+c},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function A1(e){e._valueTracker||(e._valueTracker=bQ(e))}function AU(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=PU(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Iw(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function LP(e,t){var n=t.checked;return bi({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Fz(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Bh(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function IU(e,t){t=t.checked,t!=null&&jR(e,"checked",t,!1)}function kP(e,t){IU(e,t);var n=Bh(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?DP(e,t.type,n):t.hasOwnProperty("defaultValue")&&DP(e,t.type,Bh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Nz(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function DP(e,t,n){(t!=="number"||Iw(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var V0=Array.isArray;function Zm(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Bh(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function zP(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(dn(91));return bi({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Bz(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(dn(92));if(V0(n)){if(1<n.length)throw Error(dn(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Bh(n)}}function RU(e,t){var n=Bh(t.value),r=Bh(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Uz(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function LU(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function OP(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?LU(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var I1,kU=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(I1=I1||document.createElement("div"),I1.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=I1.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function jy(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ry={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wQ=["Webkit","ms","Moz","O"];Object.keys(ry).forEach(function(e){wQ.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ry[t]=ry[e]})});function DU(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ry.hasOwnProperty(e)&&ry[e]?(""+t).trim():t+"px"}function zU(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=DU(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var SQ=bi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function FP(e,t){if(t){if(SQ[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(dn(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(dn(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(dn(61))}if(t.style!=null&&typeof t.style!="object")throw Error(dn(62))}}function NP(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var BP=null;function qR(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var UP=null,Ym=null,Km=null;function $z(e){if(e=z_(e)){if(typeof UP!="function")throw Error(dn(280));var t=e.stateNode;t&&(t=yM(t),UP(e.stateNode,e.type,t))}}function OU(e){Ym?Km?Km.push(e):Km=[e]:Ym=e}function FU(){if(Ym){var e=Ym,t=Km;if(Km=Ym=null,$z(e),t)for(e=0;e<t.length;e++)$z(t[e])}}function NU(e,t){return e(t)}function BU(){}var eE=!1;function UU(e,t,n){if(eE)return e(t,n);eE=!0;try{return NU(e,t,n)}finally{eE=!1,(Ym!==null||Km!==null)&&(BU(),FU())}}function Hy(e,t){var n=e.stateNode;if(n===null)return null;var r=yM(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(dn(231,t,typeof n));return n}var $P=!1;if(lu)try{var d0={};Object.defineProperty(d0,"passive",{get:function(){$P=!0}}),window.addEventListener("test",d0,d0),window.removeEventListener("test",d0,d0)}catch{$P=!1}function MQ(e,t,n,r,i,a,c,o,f){var g=Array.prototype.slice.call(arguments,3);try{t.apply(n,g)}catch(_){this.onError(_)}}var iy=!1,Rw=null,Lw=!1,VP=null,CQ={onError:function(e){iy=!0,Rw=e}};function EQ(e,t,n,r,i,a,c,o,f){iy=!1,Rw=null,MQ.apply(CQ,arguments)}function TQ(e,t,n,r,i,a,c,o,f){if(EQ.apply(this,arguments),iy){if(iy){var g=Rw;iy=!1,Rw=null}else throw Error(dn(198));Lw||(Lw=!0,VP=g)}}function Gf(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function $U(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Vz(e){if(Gf(e)!==e)throw Error(dn(188))}function PQ(e){var t=e.alternate;if(!t){if(t=Gf(e),t===null)throw Error(dn(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Vz(i),e;if(a===r)return Vz(i),t;a=a.sibling}throw Error(dn(188))}if(n.return!==r.return)n=i,r=a;else{for(var c=!1,o=i.child;o;){if(o===n){c=!0,n=i,r=a;break}if(o===r){c=!0,r=i,n=a;break}o=o.sibling}if(!c){for(o=a.child;o;){if(o===n){c=!0,n=a,r=i;break}if(o===r){c=!0,r=a,n=i;break}o=o.sibling}if(!c)throw Error(dn(189))}}if(n.alternate!==r)throw Error(dn(190))}if(n.tag!==3)throw Error(dn(188));return n.stateNode.current===n?e:t}function VU(e){return e=PQ(e),e!==null?jU(e):null}function jU(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=jU(e);if(t!==null)return t;e=e.sibling}return null}var HU=Ea.unstable_scheduleCallback,jz=Ea.unstable_cancelCallback,AQ=Ea.unstable_shouldYield,IQ=Ea.unstable_requestPaint,Oi=Ea.unstable_now,RQ=Ea.unstable_getCurrentPriorityLevel,XR=Ea.unstable_ImmediatePriority,GU=Ea.unstable_UserBlockingPriority,kw=Ea.unstable_NormalPriority,LQ=Ea.unstable_LowPriority,WU=Ea.unstable_IdlePriority,pM=null,mc=null;function kQ(e){if(mc&&typeof mc.onCommitFiberRoot=="function")try{mc.onCommitFiberRoot(pM,e,void 0,(e.current.flags&128)===128)}catch{}}var Al=Math.clz32?Math.clz32:OQ,DQ=Math.log,zQ=Math.LN2;function OQ(e){return e>>>=0,e===0?32:31-(DQ(e)/zQ|0)|0}var R1=64,L1=4194304;function j0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Dw(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,c=n&268435455;if(c!==0){var o=c&~i;o!==0?r=j0(o):(a&=c,a!==0&&(r=j0(a)))}else c=n&~i,c!==0?r=j0(c):a!==0&&(r=j0(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Al(t),i=1<<n,r|=e[n],t&=~i;return r}function FQ(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function NQ(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var c=31-Al(a),o=1<<c,f=i[c];f===-1?(!(o&n)||o&r)&&(i[c]=FQ(o,t)):f<=t&&(e.expiredLanes|=o),a&=~o}}function jP(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function qU(){var e=R1;return R1<<=1,!(R1&4194240)&&(R1=64),e}function tE(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function k_(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Al(t),e[t]=n}function BQ(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Al(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function ZR(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Al(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Vr=0;function XU(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ZU,YR,YU,KU,JU,HP=!1,k1=[],Mh=null,Ch=null,Eh=null,Gy=new Map,Wy=new Map,ph=[],UQ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hz(e,t){switch(e){case"focusin":case"focusout":Mh=null;break;case"dragenter":case"dragleave":Ch=null;break;case"mouseover":case"mouseout":Eh=null;break;case"pointerover":case"pointerout":Gy.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wy.delete(t.pointerId)}}function f0(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=z_(t),t!==null&&YR(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function $Q(e,t,n,r,i){switch(t){case"focusin":return Mh=f0(Mh,e,t,n,r,i),!0;case"dragenter":return Ch=f0(Ch,e,t,n,r,i),!0;case"mouseover":return Eh=f0(Eh,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Gy.set(a,f0(Gy.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Wy.set(a,f0(Wy.get(a)||null,e,t,n,r,i)),!0}return!1}function QU(e){var t=gf(e.target);if(t!==null){var n=Gf(t);if(n!==null){if(t=n.tag,t===13){if(t=$U(n),t!==null){e.blockedOn=t,JU(e.priority,function(){YU(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function jb(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=GP(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);BP=r,n.target.dispatchEvent(r),BP=null}else return t=z_(n),t!==null&&YR(t),e.blockedOn=n,!1;t.shift()}return!0}function Gz(e,t,n){jb(e)&&n.delete(t)}function VQ(){HP=!1,Mh!==null&&jb(Mh)&&(Mh=null),Ch!==null&&jb(Ch)&&(Ch=null),Eh!==null&&jb(Eh)&&(Eh=null),Gy.forEach(Gz),Wy.forEach(Gz)}function p0(e,t){e.blockedOn===t&&(e.blockedOn=null,HP||(HP=!0,Ea.unstable_scheduleCallback(Ea.unstable_NormalPriority,VQ)))}function qy(e){function t(i){return p0(i,e)}if(0<k1.length){p0(k1[0],e);for(var n=1;n<k1.length;n++){var r=k1[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Mh!==null&&p0(Mh,e),Ch!==null&&p0(Ch,e),Eh!==null&&p0(Eh,e),Gy.forEach(t),Wy.forEach(t),n=0;n<ph.length;n++)r=ph[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<ph.length&&(n=ph[0],n.blockedOn===null);)QU(n),n.blockedOn===null&&ph.shift()}var Jm=_u.ReactCurrentBatchConfig,zw=!0;function jQ(e,t,n,r){var i=Vr,a=Jm.transition;Jm.transition=null;try{Vr=1,KR(e,t,n,r)}finally{Vr=i,Jm.transition=a}}function HQ(e,t,n,r){var i=Vr,a=Jm.transition;Jm.transition=null;try{Vr=4,KR(e,t,n,r)}finally{Vr=i,Jm.transition=a}}function KR(e,t,n,r){if(zw){var i=GP(e,t,n,r);if(i===null)hE(e,t,r,Ow,n),Hz(e,r);else if($Q(i,e,t,n,r))r.stopPropagation();else if(Hz(e,r),t&4&&-1<UQ.indexOf(e)){for(;i!==null;){var a=z_(i);if(a!==null&&ZU(a),a=GP(e,t,n,r),a===null&&hE(e,t,r,Ow,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else hE(e,t,r,null,n)}}var Ow=null;function GP(e,t,n,r){if(Ow=null,e=qR(r),e=gf(e),e!==null)if(t=Gf(e),t===null)e=null;else if(n=t.tag,n===13){if(e=$U(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ow=e,null}function e$(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RQ()){case XR:return 1;case GU:return 4;case kw:case LQ:return 16;case WU:return 536870912;default:return 16}default:return 16}}var _h=null,JR=null,Hb=null;function t$(){if(Hb)return Hb;var e,t=JR,n=t.length,r,i="value"in _h?_h.value:_h.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var c=n-e;for(r=1;r<=c&&t[n-r]===i[a-r];r++);return Hb=i.slice(e,1<r?1-r:void 0)}function Gb(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function D1(){return!0}function Wz(){return!1}function Ia(e){function t(n,r,i,a,c){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=c,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?D1:Wz,this.isPropagationStopped=Wz,this}return bi(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=D1)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=D1)},persist:function(){},isPersistent:D1}),t}var $g={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},QR=Ia($g),D_=bi({},$g,{view:0,detail:0}),GQ=Ia(D_),nE,rE,m0,mM=bi({},D_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:e3,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==m0&&(m0&&e.type==="mousemove"?(nE=e.screenX-m0.screenX,rE=e.screenY-m0.screenY):rE=nE=0,m0=e),nE)},movementY:function(e){return"movementY"in e?e.movementY:rE}}),qz=Ia(mM),WQ=bi({},mM,{dataTransfer:0}),qQ=Ia(WQ),XQ=bi({},D_,{relatedTarget:0}),iE=Ia(XQ),ZQ=bi({},$g,{animationName:0,elapsedTime:0,pseudoElement:0}),YQ=Ia(ZQ),KQ=bi({},$g,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),JQ=Ia(KQ),QQ=bi({},$g,{data:0}),Xz=Ia(QQ),eee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ree(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=nee[e])?!!t[e]:!1}function e3(){return ree}var iee=bi({},D_,{key:function(e){if(e.key){var t=eee[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Gb(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?tee[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:e3,charCode:function(e){return e.type==="keypress"?Gb(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Gb(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),oee=Ia(iee),see=bi({},mM,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zz=Ia(see),aee=bi({},D_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:e3}),lee=Ia(aee),cee=bi({},$g,{propertyName:0,elapsedTime:0,pseudoElement:0}),uee=Ia(cee),hee=bi({},mM,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),dee=Ia(hee),fee=[9,13,27,32],t3=lu&&"CompositionEvent"in window,oy=null;lu&&"documentMode"in document&&(oy=document.documentMode);var pee=lu&&"TextEvent"in window&&!oy,n$=lu&&(!t3||oy&&8<oy&&11>=oy),Yz=" ",Kz=!1;function r$(e,t){switch(e){case"keyup":return fee.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i$(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Pm=!1;function mee(e,t){switch(e){case"compositionend":return i$(t);case"keypress":return t.which!==32?null:(Kz=!0,Yz);case"textInput":return e=t.data,e===Yz&&Kz?null:e;default:return null}}function gee(e,t){if(Pm)return e==="compositionend"||!t3&&r$(e,t)?(e=t$(),Hb=JR=_h=null,Pm=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return n$&&t.locale!=="ko"?null:t.data;default:return null}}var vee={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jz(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!vee[e.type]:t==="textarea"}function o$(e,t,n,r){OU(r),t=Fw(t,"onChange"),0<t.length&&(n=new QR("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var sy=null,Xy=null;function yee(e){g$(e,0)}function gM(e){var t=Rm(e);if(AU(t))return e}function _ee(e,t){if(e==="change")return t}var s$=!1;if(lu){var oE;if(lu){var sE="oninput"in document;if(!sE){var Qz=document.createElement("div");Qz.setAttribute("oninput","return;"),sE=typeof Qz.oninput=="function"}oE=sE}else oE=!1;s$=oE&&(!document.documentMode||9<document.documentMode)}function eO(){sy&&(sy.detachEvent("onpropertychange",a$),Xy=sy=null)}function a$(e){if(e.propertyName==="value"&&gM(Xy)){var t=[];o$(t,Xy,e,qR(e)),UU(yee,t)}}function xee(e,t,n){e==="focusin"?(eO(),sy=t,Xy=n,sy.attachEvent("onpropertychange",a$)):e==="focusout"&&eO()}function bee(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return gM(Xy)}function wee(e,t){if(e==="click")return gM(t)}function See(e,t){if(e==="input"||e==="change")return gM(t)}function Mee(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Dl=typeof Object.is=="function"?Object.is:Mee;function Zy(e,t){if(Dl(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!TP.call(t,i)||!Dl(e[i],t[i]))return!1}return!0}function tO(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function nO(e,t){var n=tO(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=tO(n)}}function l$(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?l$(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function c$(){for(var e=window,t=Iw();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Iw(e.document)}return t}function n3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Cee(e){var t=c$(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&l$(n.ownerDocument.documentElement,n)){if(r!==null&&n3(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=nO(n,a);var c=nO(n,r);i&&c&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==c.node||e.focusOffset!==c.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(c.node,c.offset)):(t.setEnd(c.node,c.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Eee=lu&&"documentMode"in document&&11>=document.documentMode,Am=null,WP=null,ay=null,qP=!1;function rO(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qP||Am==null||Am!==Iw(r)||(r=Am,"selectionStart"in r&&n3(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ay&&Zy(ay,r)||(ay=r,r=Fw(WP,"onSelect"),0<r.length&&(t=new QR("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Am)))}function z1(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Im={animationend:z1("Animation","AnimationEnd"),animationiteration:z1("Animation","AnimationIteration"),animationstart:z1("Animation","AnimationStart"),transitionend:z1("Transition","TransitionEnd")},aE={},u$={};lu&&(u$=document.createElement("div").style,"AnimationEvent"in window||(delete Im.animationend.animation,delete Im.animationiteration.animation,delete Im.animationstart.animation),"TransitionEvent"in window||delete Im.transitionend.transition);function vM(e){if(aE[e])return aE[e];if(!Im[e])return e;var t=Im[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in u$)return aE[e]=t[n];return e}var h$=vM("animationend"),d$=vM("animationiteration"),f$=vM("animationstart"),p$=vM("transitionend"),m$=new Map,iO="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qh(e,t){m$.set(e,t),Hf(t,[e])}for(var lE=0;lE<iO.length;lE++){var cE=iO[lE],Tee=cE.toLowerCase(),Pee=cE[0].toUpperCase()+cE.slice(1);Qh(Tee,"on"+Pee)}Qh(h$,"onAnimationEnd");Qh(d$,"onAnimationIteration");Qh(f$,"onAnimationStart");Qh("dblclick","onDoubleClick");Qh("focusin","onFocus");Qh("focusout","onBlur");Qh(p$,"onTransitionEnd");fg("onMouseEnter",["mouseout","mouseover"]);fg("onMouseLeave",["mouseout","mouseover"]);fg("onPointerEnter",["pointerout","pointerover"]);fg("onPointerLeave",["pointerout","pointerover"]);Hf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var H0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Aee=new Set("cancel close invalid load scroll toggle".split(" ").concat(H0));function oO(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,TQ(r,t,void 0,e),e.currentTarget=null}function g$(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var c=r.length-1;0<=c;c--){var o=r[c],f=o.instance,g=o.currentTarget;if(o=o.listener,f!==a&&i.isPropagationStopped())break e;oO(i,o,g),a=f}else for(c=0;c<r.length;c++){if(o=r[c],f=o.instance,g=o.currentTarget,o=o.listener,f!==a&&i.isPropagationStopped())break e;oO(i,o,g),a=f}}}if(Lw)throw e=VP,Lw=!1,VP=null,e}function ui(e,t){var n=t[JP];n===void 0&&(n=t[JP]=new Set);var r=e+"__bubble";n.has(r)||(v$(t,e,2,!1),n.add(r))}function uE(e,t,n){var r=0;t&&(r|=4),v$(n,e,r,t)}var O1="_reactListening"+Math.random().toString(36).slice(2);function Yy(e){if(!e[O1]){e[O1]=!0,MU.forEach(function(n){n!=="selectionchange"&&(Aee.has(n)||uE(n,!1,e),uE(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[O1]||(t[O1]=!0,uE("selectionchange",!1,t))}}function v$(e,t,n,r){switch(e$(t)){case 1:var i=jQ;break;case 4:i=HQ;break;default:i=KR}n=i.bind(null,t,n,e),i=void 0,!$P||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function hE(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var c=r.tag;if(c===3||c===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(c===4)for(c=r.return;c!==null;){var f=c.tag;if((f===3||f===4)&&(f=c.stateNode.containerInfo,f===i||f.nodeType===8&&f.parentNode===i))return;c=c.return}for(;o!==null;){if(c=gf(o),c===null)return;if(f=c.tag,f===5||f===6){r=a=c;continue e}o=o.parentNode}}r=r.return}UU(function(){var g=a,_=qR(n),x=[];e:{var M=m$.get(e);if(M!==void 0){var C=QR,A=e;switch(e){case"keypress":if(Gb(n)===0)break e;case"keydown":case"keyup":C=oee;break;case"focusin":A="focus",C=iE;break;case"focusout":A="blur",C=iE;break;case"beforeblur":case"afterblur":C=iE;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=qz;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=qQ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=lee;break;case h$:case d$:case f$:C=YQ;break;case p$:C=uee;break;case"scroll":C=GQ;break;case"wheel":C=dee;break;case"copy":case"cut":case"paste":C=JQ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=Zz}var L=(t&4)!==0,I=!L&&e==="scroll",T=L?M!==null?M+"Capture":null:M;L=[];for(var z=g,k;z!==null;){k=z;var U=k.stateNode;if(k.tag===5&&U!==null&&(k=U,T!==null&&(U=Hy(z,T),U!=null&&L.push(Ky(z,U,k)))),I)break;z=z.return}0<L.length&&(M=new C(M,A,null,n,_),x.push({event:M,listeners:L}))}}if(!(t&7)){e:{if(M=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",M&&n!==BP&&(A=n.relatedTarget||n.fromElement)&&(gf(A)||A[cu]))break e;if((C||M)&&(M=_.window===_?_:(M=_.ownerDocument)?M.defaultView||M.parentWindow:window,C?(A=n.relatedTarget||n.toElement,C=g,A=A?gf(A):null,A!==null&&(I=Gf(A),A!==I||A.tag!==5&&A.tag!==6)&&(A=null)):(C=null,A=g),C!==A)){if(L=qz,U="onMouseLeave",T="onMouseEnter",z="mouse",(e==="pointerout"||e==="pointerover")&&(L=Zz,U="onPointerLeave",T="onPointerEnter",z="pointer"),I=C==null?M:Rm(C),k=A==null?M:Rm(A),M=new L(U,z+"leave",C,n,_),M.target=I,M.relatedTarget=k,U=null,gf(_)===g&&(L=new L(T,z+"enter",A,n,_),L.target=k,L.relatedTarget=I,U=L),I=U,C&&A)t:{for(L=C,T=A,z=0,k=L;k;k=jp(k))z++;for(k=0,U=T;U;U=jp(U))k++;for(;0<z-k;)L=jp(L),z--;for(;0<k-z;)T=jp(T),k--;for(;z--;){if(L===T||T!==null&&L===T.alternate)break t;L=jp(L),T=jp(T)}L=null}else L=null;C!==null&&sO(x,M,C,L,!1),A!==null&&I!==null&&sO(x,I,A,L,!0)}}e:{if(M=g?Rm(g):window,C=M.nodeName&&M.nodeName.toLowerCase(),C==="select"||C==="input"&&M.type==="file")var H=_ee;else if(Jz(M))if(s$)H=See;else{H=bee;var V=xee}else(C=M.nodeName)&&C.toLowerCase()==="input"&&(M.type==="checkbox"||M.type==="radio")&&(H=wee);if(H&&(H=H(e,g))){o$(x,H,n,_);break e}V&&V(e,M,g),e==="focusout"&&(V=M._wrapperState)&&V.controlled&&M.type==="number"&&DP(M,"number",M.value)}switch(V=g?Rm(g):window,e){case"focusin":(Jz(V)||V.contentEditable==="true")&&(Am=V,WP=g,ay=null);break;case"focusout":ay=WP=Am=null;break;case"mousedown":qP=!0;break;case"contextmenu":case"mouseup":case"dragend":qP=!1,rO(x,n,_);break;case"selectionchange":if(Eee)break;case"keydown":case"keyup":rO(x,n,_)}var q;if(t3)e:{switch(e){case"compositionstart":var J="onCompositionStart";break e;case"compositionend":J="onCompositionEnd";break e;case"compositionupdate":J="onCompositionUpdate";break e}J=void 0}else Pm?r$(e,n)&&(J="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(J="onCompositionStart");J&&(n$&&n.locale!=="ko"&&(Pm||J!=="onCompositionStart"?J==="onCompositionEnd"&&Pm&&(q=t$()):(_h=_,JR="value"in _h?_h.value:_h.textContent,Pm=!0)),V=Fw(g,J),0<V.length&&(J=new Xz(J,e,null,n,_),x.push({event:J,listeners:V}),q?J.data=q:(q=i$(n),q!==null&&(J.data=q)))),(q=pee?mee(e,n):gee(e,n))&&(g=Fw(g,"onBeforeInput"),0<g.length&&(_=new Xz("onBeforeInput","beforeinput",null,n,_),x.push({event:_,listeners:g}),_.data=q))}g$(x,t)})}function Ky(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Fw(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Hy(e,n),a!=null&&r.unshift(Ky(e,a,i)),a=Hy(e,t),a!=null&&r.push(Ky(e,a,i))),e=e.return}return r}function jp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function sO(e,t,n,r,i){for(var a=t._reactName,c=[];n!==null&&n!==r;){var o=n,f=o.alternate,g=o.stateNode;if(f!==null&&f===r)break;o.tag===5&&g!==null&&(o=g,i?(f=Hy(n,a),f!=null&&c.unshift(Ky(n,f,o))):i||(f=Hy(n,a),f!=null&&c.push(Ky(n,f,o)))),n=n.return}c.length!==0&&e.push({event:t,listeners:c})}var Iee=/\r\n?/g,Ree=/\u0000|\uFFFD/g;function aO(e){return(typeof e=="string"?e:""+e).replace(Iee,`
`).replace(Ree,"")}function F1(e,t,n){if(t=aO(t),aO(e)!==t&&n)throw Error(dn(425))}function Nw(){}var XP=null,ZP=null;function YP(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var KP=typeof setTimeout=="function"?setTimeout:void 0,Lee=typeof clearTimeout=="function"?clearTimeout:void 0,lO=typeof Promise=="function"?Promise:void 0,kee=typeof queueMicrotask=="function"?queueMicrotask:typeof lO<"u"?function(e){return lO.resolve(null).then(e).catch(Dee)}:KP;function Dee(e){setTimeout(function(){throw e})}function dE(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),qy(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);qy(t)}function Th(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function cO(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Vg=Math.random().toString(36).slice(2),uc="__reactFiber$"+Vg,Jy="__reactProps$"+Vg,cu="__reactContainer$"+Vg,JP="__reactEvents$"+Vg,zee="__reactListeners$"+Vg,Oee="__reactHandles$"+Vg;function gf(e){var t=e[uc];if(t)return t;for(var n=e.parentNode;n;){if(t=n[cu]||n[uc]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=cO(e);e!==null;){if(n=e[uc])return n;e=cO(e)}return t}e=n,n=e.parentNode}return null}function z_(e){return e=e[uc]||e[cu],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Rm(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(dn(33))}function yM(e){return e[Jy]||null}var QP=[],Lm=-1;function ed(e){return{current:e}}function hi(e){0>Lm||(e.current=QP[Lm],QP[Lm]=null,Lm--)}function si(e,t){Lm++,QP[Lm]=e.current,e.current=t}var Uh={},cs=ed(Uh),Bs=ed(!1),If=Uh;function pg(e,t){var n=e.type.contextTypes;if(!n)return Uh;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Us(e){return e=e.childContextTypes,e!=null}function Bw(){hi(Bs),hi(cs)}function uO(e,t,n){if(cs.current!==Uh)throw Error(dn(168));si(cs,t),si(Bs,n)}function y$(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(dn(108,xQ(e)||"Unknown",i));return bi({},n,r)}function Uw(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Uh,If=cs.current,si(cs,e),si(Bs,Bs.current),!0}function hO(e,t,n){var r=e.stateNode;if(!r)throw Error(dn(169));n?(e=y$(e,t,If),r.__reactInternalMemoizedMergedChildContext=e,hi(Bs),hi(cs),si(cs,e)):hi(Bs),si(Bs,n)}var Yc=null,_M=!1,fE=!1;function _$(e){Yc===null?Yc=[e]:Yc.push(e)}function Fee(e){_M=!0,_$(e)}function td(){if(!fE&&Yc!==null){fE=!0;var e=0,t=Vr;try{var n=Yc;for(Vr=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Yc=null,_M=!1}catch(i){throw Yc!==null&&(Yc=Yc.slice(e+1)),HU(XR,td),i}finally{Vr=t,fE=!1}}return null}var km=[],Dm=0,$w=null,Vw=0,Va=[],ja=0,Rf=null,Qc=1,eu="";function sf(e,t){km[Dm++]=Vw,km[Dm++]=$w,$w=e,Vw=t}function x$(e,t,n){Va[ja++]=Qc,Va[ja++]=eu,Va[ja++]=Rf,Rf=e;var r=Qc;e=eu;var i=32-Al(r)-1;r&=~(1<<i),n+=1;var a=32-Al(t)+i;if(30<a){var c=i-i%5;a=(r&(1<<c)-1).toString(32),r>>=c,i-=c,Qc=1<<32-Al(t)+i|n<<i|r,eu=a+e}else Qc=1<<a|n<<i|r,eu=e}function r3(e){e.return!==null&&(sf(e,1),x$(e,1,0))}function i3(e){for(;e===$w;)$w=km[--Dm],km[Dm]=null,Vw=km[--Dm],km[Dm]=null;for(;e===Rf;)Rf=Va[--ja],Va[ja]=null,eu=Va[--ja],Va[ja]=null,Qc=Va[--ja],Va[ja]=null}var Sa=null,ya=null,mi=!1,Ml=null;function b$(e,t){var n=Wa(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function dO(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Sa=e,ya=Th(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Sa=e,ya=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Rf!==null?{id:Qc,overflow:eu}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Wa(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Sa=e,ya=null,!0):!1;default:return!1}}function eA(e){return(e.mode&1)!==0&&(e.flags&128)===0}function tA(e){if(mi){var t=ya;if(t){var n=t;if(!dO(e,t)){if(eA(e))throw Error(dn(418));t=Th(n.nextSibling);var r=Sa;t&&dO(e,t)?b$(r,n):(e.flags=e.flags&-4097|2,mi=!1,Sa=e)}}else{if(eA(e))throw Error(dn(418));e.flags=e.flags&-4097|2,mi=!1,Sa=e}}}function fO(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Sa=e}function N1(e){if(e!==Sa)return!1;if(!mi)return fO(e),mi=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!YP(e.type,e.memoizedProps)),t&&(t=ya)){if(eA(e))throw w$(),Error(dn(418));for(;t;)b$(e,t),t=Th(t.nextSibling)}if(fO(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(dn(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){ya=Th(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}ya=null}}else ya=Sa?Th(e.stateNode.nextSibling):null;return!0}function w$(){for(var e=ya;e;)e=Th(e.nextSibling)}function mg(){ya=Sa=null,mi=!1}function o3(e){Ml===null?Ml=[e]:Ml.push(e)}var Nee=_u.ReactCurrentBatchConfig;function g0(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(dn(309));var r=n.stateNode}if(!r)throw Error(dn(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(c){var o=i.refs;c===null?delete o[a]:o[a]=c},t._stringRef=a,t)}if(typeof e!="string")throw Error(dn(284));if(!n._owner)throw Error(dn(290,e))}return e}function B1(e,t){throw e=Object.prototype.toString.call(t),Error(dn(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function pO(e){var t=e._init;return t(e._payload)}function S$(e){function t(T,z){if(e){var k=T.deletions;k===null?(T.deletions=[z],T.flags|=16):k.push(z)}}function n(T,z){if(!e)return null;for(;z!==null;)t(T,z),z=z.sibling;return null}function r(T,z){for(T=new Map;z!==null;)z.key!==null?T.set(z.key,z):T.set(z.index,z),z=z.sibling;return T}function i(T,z){return T=Rh(T,z),T.index=0,T.sibling=null,T}function a(T,z,k){return T.index=k,e?(k=T.alternate,k!==null?(k=k.index,k<z?(T.flags|=2,z):k):(T.flags|=2,z)):(T.flags|=1048576,z)}function c(T){return e&&T.alternate===null&&(T.flags|=2),T}function o(T,z,k,U){return z===null||z.tag!==6?(z=xE(k,T.mode,U),z.return=T,z):(z=i(z,k),z.return=T,z)}function f(T,z,k,U){var H=k.type;return H===Tm?_(T,z,k.props.children,U,k.key):z!==null&&(z.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===hh&&pO(H)===z.type)?(U=i(z,k.props),U.ref=g0(T,z,k),U.return=T,U):(U=Jb(k.type,k.key,k.props,null,T.mode,U),U.ref=g0(T,z,k),U.return=T,U)}function g(T,z,k,U){return z===null||z.tag!==4||z.stateNode.containerInfo!==k.containerInfo||z.stateNode.implementation!==k.implementation?(z=bE(k,T.mode,U),z.return=T,z):(z=i(z,k.children||[]),z.return=T,z)}function _(T,z,k,U,H){return z===null||z.tag!==7?(z=Mf(k,T.mode,U,H),z.return=T,z):(z=i(z,k),z.return=T,z)}function x(T,z,k){if(typeof z=="string"&&z!==""||typeof z=="number")return z=xE(""+z,T.mode,k),z.return=T,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case P1:return k=Jb(z.type,z.key,z.props,null,T.mode,k),k.ref=g0(T,null,z),k.return=T,k;case Em:return z=bE(z,T.mode,k),z.return=T,z;case hh:var U=z._init;return x(T,U(z._payload),k)}if(V0(z)||h0(z))return z=Mf(z,T.mode,k,null),z.return=T,z;B1(T,z)}return null}function M(T,z,k,U){var H=z!==null?z.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return H!==null?null:o(T,z,""+k,U);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case P1:return k.key===H?f(T,z,k,U):null;case Em:return k.key===H?g(T,z,k,U):null;case hh:return H=k._init,M(T,z,H(k._payload),U)}if(V0(k)||h0(k))return H!==null?null:_(T,z,k,U,null);B1(T,k)}return null}function C(T,z,k,U,H){if(typeof U=="string"&&U!==""||typeof U=="number")return T=T.get(k)||null,o(z,T,""+U,H);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case P1:return T=T.get(U.key===null?k:U.key)||null,f(z,T,U,H);case Em:return T=T.get(U.key===null?k:U.key)||null,g(z,T,U,H);case hh:var V=U._init;return C(T,z,k,V(U._payload),H)}if(V0(U)||h0(U))return T=T.get(k)||null,_(z,T,U,H,null);B1(z,U)}return null}function A(T,z,k,U){for(var H=null,V=null,q=z,J=z=0,Y=null;q!==null&&J<k.length;J++){q.index>J?(Y=q,q=null):Y=q.sibling;var N=M(T,q,k[J],U);if(N===null){q===null&&(q=Y);break}e&&q&&N.alternate===null&&t(T,q),z=a(N,z,J),V===null?H=N:V.sibling=N,V=N,q=Y}if(J===k.length)return n(T,q),mi&&sf(T,J),H;if(q===null){for(;J<k.length;J++)q=x(T,k[J],U),q!==null&&(z=a(q,z,J),V===null?H=q:V.sibling=q,V=q);return mi&&sf(T,J),H}for(q=r(T,q);J<k.length;J++)Y=C(q,T,J,k[J],U),Y!==null&&(e&&Y.alternate!==null&&q.delete(Y.key===null?J:Y.key),z=a(Y,z,J),V===null?H=Y:V.sibling=Y,V=Y);return e&&q.forEach(function(ne){return t(T,ne)}),mi&&sf(T,J),H}function L(T,z,k,U){var H=h0(k);if(typeof H!="function")throw Error(dn(150));if(k=H.call(k),k==null)throw Error(dn(151));for(var V=H=null,q=z,J=z=0,Y=null,N=k.next();q!==null&&!N.done;J++,N=k.next()){q.index>J?(Y=q,q=null):Y=q.sibling;var ne=M(T,q,N.value,U);if(ne===null){q===null&&(q=Y);break}e&&q&&ne.alternate===null&&t(T,q),z=a(ne,z,J),V===null?H=ne:V.sibling=ne,V=ne,q=Y}if(N.done)return n(T,q),mi&&sf(T,J),H;if(q===null){for(;!N.done;J++,N=k.next())N=x(T,N.value,U),N!==null&&(z=a(N,z,J),V===null?H=N:V.sibling=N,V=N);return mi&&sf(T,J),H}for(q=r(T,q);!N.done;J++,N=k.next())N=C(q,T,J,N.value,U),N!==null&&(e&&N.alternate!==null&&q.delete(N.key===null?J:N.key),z=a(N,z,J),V===null?H=N:V.sibling=N,V=N);return e&&q.forEach(function(ye){return t(T,ye)}),mi&&sf(T,J),H}function I(T,z,k,U){if(typeof k=="object"&&k!==null&&k.type===Tm&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case P1:e:{for(var H=k.key,V=z;V!==null;){if(V.key===H){if(H=k.type,H===Tm){if(V.tag===7){n(T,V.sibling),z=i(V,k.props.children),z.return=T,T=z;break e}}else if(V.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===hh&&pO(H)===V.type){n(T,V.sibling),z=i(V,k.props),z.ref=g0(T,V,k),z.return=T,T=z;break e}n(T,V);break}else t(T,V);V=V.sibling}k.type===Tm?(z=Mf(k.props.children,T.mode,U,k.key),z.return=T,T=z):(U=Jb(k.type,k.key,k.props,null,T.mode,U),U.ref=g0(T,z,k),U.return=T,T=U)}return c(T);case Em:e:{for(V=k.key;z!==null;){if(z.key===V)if(z.tag===4&&z.stateNode.containerInfo===k.containerInfo&&z.stateNode.implementation===k.implementation){n(T,z.sibling),z=i(z,k.children||[]),z.return=T,T=z;break e}else{n(T,z);break}else t(T,z);z=z.sibling}z=bE(k,T.mode,U),z.return=T,T=z}return c(T);case hh:return V=k._init,I(T,z,V(k._payload),U)}if(V0(k))return A(T,z,k,U);if(h0(k))return L(T,z,k,U);B1(T,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,z!==null&&z.tag===6?(n(T,z.sibling),z=i(z,k),z.return=T,T=z):(n(T,z),z=xE(k,T.mode,U),z.return=T,T=z),c(T)):n(T,z)}return I}var gg=S$(!0),M$=S$(!1),jw=ed(null),Hw=null,zm=null,s3=null;function a3(){s3=zm=Hw=null}function l3(e){var t=jw.current;hi(jw),e._currentValue=t}function nA(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Qm(e,t){Hw=e,s3=zm=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Fs=!0),e.firstContext=null)}function Za(e){var t=e._currentValue;if(s3!==e)if(e={context:e,memoizedValue:t,next:null},zm===null){if(Hw===null)throw Error(dn(308));zm=e,Hw.dependencies={lanes:0,firstContext:e}}else zm=zm.next=e;return t}var vf=null;function c3(e){vf===null?vf=[e]:vf.push(e)}function C$(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,c3(t)):(n.next=i.next,i.next=n),t.interleaved=n,uu(e,r)}function uu(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var dh=!1;function u3(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function E$(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ru(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ph(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Pr&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,uu(e,n)}return i=r.interleaved,i===null?(t.next=t,c3(r)):(t.next=i.next,i.next=t),r.interleaved=t,uu(e,n)}function Wb(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ZR(e,n)}}function mO(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var c={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=c:a=a.next=c,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Gw(e,t,n,r){var i=e.updateQueue;dh=!1;var a=i.firstBaseUpdate,c=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var f=o,g=f.next;f.next=null,c===null?a=g:c.next=g,c=f;var _=e.alternate;_!==null&&(_=_.updateQueue,o=_.lastBaseUpdate,o!==c&&(o===null?_.firstBaseUpdate=g:o.next=g,_.lastBaseUpdate=f))}if(a!==null){var x=i.baseState;c=0,_=g=f=null,o=a;do{var M=o.lane,C=o.eventTime;if((r&M)===M){_!==null&&(_=_.next={eventTime:C,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var A=e,L=o;switch(M=t,C=n,L.tag){case 1:if(A=L.payload,typeof A=="function"){x=A.call(C,x,M);break e}x=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=L.payload,M=typeof A=="function"?A.call(C,x,M):A,M==null)break e;x=bi({},x,M);break e;case 2:dh=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,M=i.effects,M===null?i.effects=[o]:M.push(o))}else C={eventTime:C,lane:M,tag:o.tag,payload:o.payload,callback:o.callback,next:null},_===null?(g=_=C,f=x):_=_.next=C,c|=M;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;M=o,o=M.next,M.next=null,i.lastBaseUpdate=M,i.shared.pending=null}}while(!0);if(_===null&&(f=x),i.baseState=f,i.firstBaseUpdate=g,i.lastBaseUpdate=_,t=i.shared.interleaved,t!==null){i=t;do c|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);kf|=c,e.lanes=c,e.memoizedState=x}}function gO(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(dn(191,i));i.call(r)}}}var O_={},gc=ed(O_),Qy=ed(O_),e_=ed(O_);function yf(e){if(e===O_)throw Error(dn(174));return e}function h3(e,t){switch(si(e_,t),si(Qy,e),si(gc,O_),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:OP(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=OP(t,e)}hi(gc),si(gc,t)}function vg(){hi(gc),hi(Qy),hi(e_)}function T$(e){yf(e_.current);var t=yf(gc.current),n=OP(t,e.type);t!==n&&(si(Qy,e),si(gc,n))}function d3(e){Qy.current===e&&(hi(gc),hi(Qy))}var yi=ed(0);function Ww(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var pE=[];function f3(){for(var e=0;e<pE.length;e++)pE[e]._workInProgressVersionPrimary=null;pE.length=0}var qb=_u.ReactCurrentDispatcher,mE=_u.ReactCurrentBatchConfig,Lf=0,_i=null,co=null,Co=null,qw=!1,ly=!1,t_=0,Bee=0;function ns(){throw Error(dn(321))}function p3(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Dl(e[n],t[n]))return!1;return!0}function m3(e,t,n,r,i,a){if(Lf=a,_i=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,qb.current=e===null||e.memoizedState===null?jee:Hee,e=n(r,i),ly){a=0;do{if(ly=!1,t_=0,25<=a)throw Error(dn(301));a+=1,Co=co=null,t.updateQueue=null,qb.current=Gee,e=n(r,i)}while(ly)}if(qb.current=Xw,t=co!==null&&co.next!==null,Lf=0,Co=co=_i=null,qw=!1,t)throw Error(dn(300));return e}function g3(){var e=t_!==0;return t_=0,e}function oc(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Co===null?_i.memoizedState=Co=e:Co=Co.next=e,Co}function Ya(){if(co===null){var e=_i.alternate;e=e!==null?e.memoizedState:null}else e=co.next;var t=Co===null?_i.memoizedState:Co.next;if(t!==null)Co=t,co=e;else{if(e===null)throw Error(dn(310));co=e,e={memoizedState:co.memoizedState,baseState:co.baseState,baseQueue:co.baseQueue,queue:co.queue,next:null},Co===null?_i.memoizedState=Co=e:Co=Co.next=e}return Co}function n_(e,t){return typeof t=="function"?t(e):t}function gE(e){var t=Ya(),n=t.queue;if(n===null)throw Error(dn(311));n.lastRenderedReducer=e;var r=co,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var c=i.next;i.next=a.next,a.next=c}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var o=c=null,f=null,g=a;do{var _=g.lane;if((Lf&_)===_)f!==null&&(f=f.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),r=g.hasEagerState?g.eagerState:e(r,g.action);else{var x={lane:_,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};f===null?(o=f=x,c=r):f=f.next=x,_i.lanes|=_,kf|=_}g=g.next}while(g!==null&&g!==a);f===null?c=r:f.next=o,Dl(r,t.memoizedState)||(Fs=!0),t.memoizedState=r,t.baseState=c,t.baseQueue=f,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,_i.lanes|=a,kf|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function vE(e){var t=Ya(),n=t.queue;if(n===null)throw Error(dn(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var c=i=i.next;do a=e(a,c.action),c=c.next;while(c!==i);Dl(a,t.memoizedState)||(Fs=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function P$(){}function A$(e,t){var n=_i,r=Ya(),i=t(),a=!Dl(r.memoizedState,i);if(a&&(r.memoizedState=i,Fs=!0),r=r.queue,v3(L$.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||Co!==null&&Co.memoizedState.tag&1){if(n.flags|=2048,r_(9,R$.bind(null,n,r,i,t),void 0,null),Po===null)throw Error(dn(349));Lf&30||I$(n,t,i)}return i}function I$(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=_i.updateQueue,t===null?(t={lastEffect:null,stores:null},_i.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function R$(e,t,n,r){t.value=n,t.getSnapshot=r,k$(t)&&D$(e)}function L$(e,t,n){return n(function(){k$(t)&&D$(e)})}function k$(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Dl(e,n)}catch{return!0}}function D$(e){var t=uu(e,1);t!==null&&Il(t,e,1,-1)}function vO(e){var t=oc();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n_,lastRenderedState:e},t.queue=e,e=e.dispatch=Vee.bind(null,_i,e),[t.memoizedState,e]}function r_(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=_i.updateQueue,t===null?(t={lastEffect:null,stores:null},_i.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function z$(){return Ya().memoizedState}function Xb(e,t,n,r){var i=oc();_i.flags|=e,i.memoizedState=r_(1|t,n,void 0,r===void 0?null:r)}function xM(e,t,n,r){var i=Ya();r=r===void 0?null:r;var a=void 0;if(co!==null){var c=co.memoizedState;if(a=c.destroy,r!==null&&p3(r,c.deps)){i.memoizedState=r_(t,n,a,r);return}}_i.flags|=e,i.memoizedState=r_(1|t,n,a,r)}function yO(e,t){return Xb(8390656,8,e,t)}function v3(e,t){return xM(2048,8,e,t)}function O$(e,t){return xM(4,2,e,t)}function F$(e,t){return xM(4,4,e,t)}function N$(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function B$(e,t,n){return n=n!=null?n.concat([e]):null,xM(4,4,N$.bind(null,t,e),n)}function y3(){}function U$(e,t){var n=Ya();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&p3(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $$(e,t){var n=Ya();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&p3(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function V$(e,t,n){return Lf&21?(Dl(n,t)||(n=qU(),_i.lanes|=n,kf|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Fs=!0),e.memoizedState=n)}function Uee(e,t){var n=Vr;Vr=n!==0&&4>n?n:4,e(!0);var r=mE.transition;mE.transition={};try{e(!1),t()}finally{Vr=n,mE.transition=r}}function j$(){return Ya().memoizedState}function $ee(e,t,n){var r=Ih(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},H$(e))G$(t,n);else if(n=C$(e,t,n,r),n!==null){var i=ws();Il(n,e,r,i),W$(n,t,r)}}function Vee(e,t,n){var r=Ih(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(H$(e))G$(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var c=t.lastRenderedState,o=a(c,n);if(i.hasEagerState=!0,i.eagerState=o,Dl(o,c)){var f=t.interleaved;f===null?(i.next=i,c3(t)):(i.next=f.next,f.next=i),t.interleaved=i;return}}catch{}finally{}n=C$(e,t,i,r),n!==null&&(i=ws(),Il(n,e,r,i),W$(n,t,r))}}function H$(e){var t=e.alternate;return e===_i||t!==null&&t===_i}function G$(e,t){ly=qw=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function W$(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ZR(e,n)}}var Xw={readContext:Za,useCallback:ns,useContext:ns,useEffect:ns,useImperativeHandle:ns,useInsertionEffect:ns,useLayoutEffect:ns,useMemo:ns,useReducer:ns,useRef:ns,useState:ns,useDebugValue:ns,useDeferredValue:ns,useTransition:ns,useMutableSource:ns,useSyncExternalStore:ns,useId:ns,unstable_isNewReconciler:!1},jee={readContext:Za,useCallback:function(e,t){return oc().memoizedState=[e,t===void 0?null:t],e},useContext:Za,useEffect:yO,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Xb(4194308,4,N$.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Xb(4194308,4,e,t)},useInsertionEffect:function(e,t){return Xb(4,2,e,t)},useMemo:function(e,t){var n=oc();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=oc();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=$ee.bind(null,_i,e),[r.memoizedState,e]},useRef:function(e){var t=oc();return e={current:e},t.memoizedState=e},useState:vO,useDebugValue:y3,useDeferredValue:function(e){return oc().memoizedState=e},useTransition:function(){var e=vO(!1),t=e[0];return e=Uee.bind(null,e[1]),oc().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=_i,i=oc();if(mi){if(n===void 0)throw Error(dn(407));n=n()}else{if(n=t(),Po===null)throw Error(dn(349));Lf&30||I$(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,yO(L$.bind(null,r,a,e),[e]),r.flags|=2048,r_(9,R$.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=oc(),t=Po.identifierPrefix;if(mi){var n=eu,r=Qc;n=(r&~(1<<32-Al(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=t_++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Bee++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Hee={readContext:Za,useCallback:U$,useContext:Za,useEffect:v3,useImperativeHandle:B$,useInsertionEffect:O$,useLayoutEffect:F$,useMemo:$$,useReducer:gE,useRef:z$,useState:function(){return gE(n_)},useDebugValue:y3,useDeferredValue:function(e){var t=Ya();return V$(t,co.memoizedState,e)},useTransition:function(){var e=gE(n_)[0],t=Ya().memoizedState;return[e,t]},useMutableSource:P$,useSyncExternalStore:A$,useId:j$,unstable_isNewReconciler:!1},Gee={readContext:Za,useCallback:U$,useContext:Za,useEffect:v3,useImperativeHandle:B$,useInsertionEffect:O$,useLayoutEffect:F$,useMemo:$$,useReducer:vE,useRef:z$,useState:function(){return vE(n_)},useDebugValue:y3,useDeferredValue:function(e){var t=Ya();return co===null?t.memoizedState=e:V$(t,co.memoizedState,e)},useTransition:function(){var e=vE(n_)[0],t=Ya().memoizedState;return[e,t]},useMutableSource:P$,useSyncExternalStore:A$,useId:j$,unstable_isNewReconciler:!1};function wl(e,t){if(e&&e.defaultProps){t=bi({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function rA(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:bi({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var bM={isMounted:function(e){return(e=e._reactInternals)?Gf(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ws(),i=Ih(e),a=ru(r,i);a.payload=t,n!=null&&(a.callback=n),t=Ph(e,a,i),t!==null&&(Il(t,e,i,r),Wb(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ws(),i=Ih(e),a=ru(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=Ph(e,a,i),t!==null&&(Il(t,e,i,r),Wb(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ws(),r=Ih(e),i=ru(n,r);i.tag=2,t!=null&&(i.callback=t),t=Ph(e,i,r),t!==null&&(Il(t,e,r,n),Wb(t,e,r))}};function _O(e,t,n,r,i,a,c){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,c):t.prototype&&t.prototype.isPureReactComponent?!Zy(n,r)||!Zy(i,a):!0}function q$(e,t,n){var r=!1,i=Uh,a=t.contextType;return typeof a=="object"&&a!==null?a=Za(a):(i=Us(t)?If:cs.current,r=t.contextTypes,a=(r=r!=null)?pg(e,i):Uh),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=bM,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function xO(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&bM.enqueueReplaceState(t,t.state,null)}function iA(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},u3(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Za(a):(a=Us(t)?If:cs.current,i.context=pg(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(rA(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&bM.enqueueReplaceState(i,i.state,null),Gw(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function yg(e,t){try{var n="",r=t;do n+=_Q(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function yE(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function oA(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Wee=typeof WeakMap=="function"?WeakMap:Map;function X$(e,t,n){n=ru(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Yw||(Yw=!0,mA=r),oA(e,t)},n}function Z$(e,t,n){n=ru(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){oA(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){oA(e,t),typeof r!="function"&&(Ah===null?Ah=new Set([this]):Ah.add(this));var c=t.stack;this.componentDidCatch(t.value,{componentStack:c!==null?c:""})}),n}function bO(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Wee;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=ste.bind(null,e,t,n),t.then(e,e))}function wO(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function SO(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ru(-1,1),t.tag=2,Ph(n,t,1))),n.lanes|=1),e)}var qee=_u.ReactCurrentOwner,Fs=!1;function ys(e,t,n,r){t.child=e===null?M$(t,null,n,r):gg(t,e.child,n,r)}function MO(e,t,n,r,i){n=n.render;var a=t.ref;return Qm(t,i),r=m3(e,t,n,r,a,i),n=g3(),e!==null&&!Fs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,hu(e,t,i)):(mi&&n&&r3(t),t.flags|=1,ys(e,t,r,i),t.child)}function CO(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!E3(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,Y$(e,t,a,r,i)):(e=Jb(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var c=a.memoizedProps;if(n=n.compare,n=n!==null?n:Zy,n(c,r)&&e.ref===t.ref)return hu(e,t,i)}return t.flags|=1,e=Rh(a,r),e.ref=t.ref,e.return=t,t.child=e}function Y$(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Zy(a,r)&&e.ref===t.ref)if(Fs=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(Fs=!0);else return t.lanes=e.lanes,hu(e,t,i)}return sA(e,t,n,r,i)}function K$(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},si(Fm,ca),ca|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,si(Fm,ca),ca|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,si(Fm,ca),ca|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,si(Fm,ca),ca|=r;return ys(e,t,i,n),t.child}function J$(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function sA(e,t,n,r,i){var a=Us(n)?If:cs.current;return a=pg(t,a),Qm(t,i),n=m3(e,t,n,r,a,i),r=g3(),e!==null&&!Fs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,hu(e,t,i)):(mi&&r&&r3(t),t.flags|=1,ys(e,t,n,i),t.child)}function EO(e,t,n,r,i){if(Us(n)){var a=!0;Uw(t)}else a=!1;if(Qm(t,i),t.stateNode===null)Zb(e,t),q$(t,n,r),iA(t,n,r,i),r=!0;else if(e===null){var c=t.stateNode,o=t.memoizedProps;c.props=o;var f=c.context,g=n.contextType;typeof g=="object"&&g!==null?g=Za(g):(g=Us(n)?If:cs.current,g=pg(t,g));var _=n.getDerivedStateFromProps,x=typeof _=="function"||typeof c.getSnapshotBeforeUpdate=="function";x||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(o!==r||f!==g)&&xO(t,c,r,g),dh=!1;var M=t.memoizedState;c.state=M,Gw(t,r,c,i),f=t.memoizedState,o!==r||M!==f||Bs.current||dh?(typeof _=="function"&&(rA(t,n,_,r),f=t.memoizedState),(o=dh||_O(t,n,o,r,M,f,g))?(x||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=f),c.props=r,c.state=f,c.context=g,r=o):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{c=t.stateNode,E$(e,t),o=t.memoizedProps,g=t.type===t.elementType?o:wl(t.type,o),c.props=g,x=t.pendingProps,M=c.context,f=n.contextType,typeof f=="object"&&f!==null?f=Za(f):(f=Us(n)?If:cs.current,f=pg(t,f));var C=n.getDerivedStateFromProps;(_=typeof C=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(o!==x||M!==f)&&xO(t,c,r,f),dh=!1,M=t.memoizedState,c.state=M,Gw(t,r,c,i);var A=t.memoizedState;o!==x||M!==A||Bs.current||dh?(typeof C=="function"&&(rA(t,n,C,r),A=t.memoizedState),(g=dh||_O(t,n,g,r,M,A,f)||!1)?(_||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(r,A,f),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(r,A,f)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||o===e.memoizedProps&&M===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&M===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=A),c.props=r,c.state=A,c.context=f,r=g):(typeof c.componentDidUpdate!="function"||o===e.memoizedProps&&M===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&M===e.memoizedState||(t.flags|=1024),r=!1)}return aA(e,t,n,r,a,i)}function aA(e,t,n,r,i,a){J$(e,t);var c=(t.flags&128)!==0;if(!r&&!c)return i&&hO(t,n,!1),hu(e,t,a);r=t.stateNode,qee.current=t;var o=c&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&c?(t.child=gg(t,e.child,null,a),t.child=gg(t,null,o,a)):ys(e,t,o,a),t.memoizedState=r.state,i&&hO(t,n,!0),t.child}function Q$(e){var t=e.stateNode;t.pendingContext?uO(e,t.pendingContext,t.pendingContext!==t.context):t.context&&uO(e,t.context,!1),h3(e,t.containerInfo)}function TO(e,t,n,r,i){return mg(),o3(i),t.flags|=256,ys(e,t,n,r),t.child}var lA={dehydrated:null,treeContext:null,retryLane:0};function cA(e){return{baseLanes:e,cachePool:null,transitions:null}}function e8(e,t,n){var r=t.pendingProps,i=yi.current,a=!1,c=(t.flags&128)!==0,o;if((o=c)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),si(yi,i&1),e===null)return tA(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(c=r.children,e=r.fallback,a?(r=t.mode,a=t.child,c={mode:"hidden",children:c},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=c):a=MM(c,r,0,null),e=Mf(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=cA(n),t.memoizedState=lA,e):_3(t,c));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return Xee(e,t,c,r,o,i,n);if(a){a=r.fallback,c=t.mode,i=e.child,o=i.sibling;var f={mode:"hidden",children:r.children};return!(c&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=f,t.deletions=null):(r=Rh(i,f),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Rh(o,a):(a=Mf(a,c,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,c=e.child.memoizedState,c=c===null?cA(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~n,t.memoizedState=lA,r}return a=e.child,e=a.sibling,r=Rh(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function _3(e,t){return t=MM({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function U1(e,t,n,r){return r!==null&&o3(r),gg(t,e.child,null,n),e=_3(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Xee(e,t,n,r,i,a,c){if(n)return t.flags&256?(t.flags&=-257,r=yE(Error(dn(422))),U1(e,t,c,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=MM({mode:"visible",children:r.children},i,0,null),a=Mf(a,i,c,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&gg(t,e.child,null,c),t.child.memoizedState=cA(c),t.memoizedState=lA,a);if(!(t.mode&1))return U1(e,t,c,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,a=Error(dn(419)),r=yE(a,r,void 0),U1(e,t,c,r)}if(o=(c&e.childLanes)!==0,Fs||o){if(r=Po,r!==null){switch(c&-c){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|c)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,uu(e,i),Il(r,e,i,-1))}return C3(),r=yE(Error(dn(421))),U1(e,t,c,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=ate.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ya=Th(i.nextSibling),Sa=t,mi=!0,Ml=null,e!==null&&(Va[ja++]=Qc,Va[ja++]=eu,Va[ja++]=Rf,Qc=e.id,eu=e.overflow,Rf=t),t=_3(t,r.children),t.flags|=4096,t)}function PO(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),nA(e.return,t,n)}function _E(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function t8(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(ys(e,t,r.children,n),r=yi.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&PO(e,n,t);else if(e.tag===19)PO(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(si(yi,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Ww(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),_E(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Ww(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}_E(t,!0,n,null,a);break;case"together":_E(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Zb(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function hu(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),kf|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(dn(153));if(t.child!==null){for(e=t.child,n=Rh(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Rh(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Zee(e,t,n){switch(t.tag){case 3:Q$(t),mg();break;case 5:T$(t);break;case 1:Us(t.type)&&Uw(t);break;case 4:h3(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;si(jw,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(si(yi,yi.current&1),t.flags|=128,null):n&t.child.childLanes?e8(e,t,n):(si(yi,yi.current&1),e=hu(e,t,n),e!==null?e.sibling:null);si(yi,yi.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return t8(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),si(yi,yi.current),r)break;return null;case 22:case 23:return t.lanes=0,K$(e,t,n)}return hu(e,t,n)}var n8,uA,r8,i8;n8=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};uA=function(){};r8=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,yf(gc.current);var a=null;switch(n){case"input":i=LP(e,i),r=LP(e,r),a=[];break;case"select":i=bi({},i,{value:void 0}),r=bi({},r,{value:void 0}),a=[];break;case"textarea":i=zP(e,i),r=zP(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Nw)}FP(n,r);var c;n=null;for(g in i)if(!r.hasOwnProperty(g)&&i.hasOwnProperty(g)&&i[g]!=null)if(g==="style"){var o=i[g];for(c in o)o.hasOwnProperty(c)&&(n||(n={}),n[c]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Vy.hasOwnProperty(g)?a||(a=[]):(a=a||[]).push(g,null));for(g in r){var f=r[g];if(o=i!=null?i[g]:void 0,r.hasOwnProperty(g)&&f!==o&&(f!=null||o!=null))if(g==="style")if(o){for(c in o)!o.hasOwnProperty(c)||f&&f.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in f)f.hasOwnProperty(c)&&o[c]!==f[c]&&(n||(n={}),n[c]=f[c])}else n||(a||(a=[]),a.push(g,n)),n=f;else g==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,o=o?o.__html:void 0,f!=null&&o!==f&&(a=a||[]).push(g,f)):g==="children"?typeof f!="string"&&typeof f!="number"||(a=a||[]).push(g,""+f):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(Vy.hasOwnProperty(g)?(f!=null&&g==="onScroll"&&ui("scroll",e),a||o===f||(a=[])):(a=a||[]).push(g,f))}n&&(a=a||[]).push("style",n);var g=a;(t.updateQueue=g)&&(t.flags|=4)}};i8=function(e,t,n,r){n!==r&&(t.flags|=4)};function v0(e,t){if(!mi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function rs(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Yee(e,t,n){var r=t.pendingProps;switch(i3(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rs(t),null;case 1:return Us(t.type)&&Bw(),rs(t),null;case 3:return r=t.stateNode,vg(),hi(Bs),hi(cs),f3(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(N1(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ml!==null&&(yA(Ml),Ml=null))),uA(e,t),rs(t),null;case 5:d3(t);var i=yf(e_.current);if(n=t.type,e!==null&&t.stateNode!=null)r8(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(dn(166));return rs(t),null}if(e=yf(gc.current),N1(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[uc]=t,r[Jy]=a,e=(t.mode&1)!==0,n){case"dialog":ui("cancel",r),ui("close",r);break;case"iframe":case"object":case"embed":ui("load",r);break;case"video":case"audio":for(i=0;i<H0.length;i++)ui(H0[i],r);break;case"source":ui("error",r);break;case"img":case"image":case"link":ui("error",r),ui("load",r);break;case"details":ui("toggle",r);break;case"input":Fz(r,a),ui("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},ui("invalid",r);break;case"textarea":Bz(r,a),ui("invalid",r)}FP(n,a),i=null;for(var c in a)if(a.hasOwnProperty(c)){var o=a[c];c==="children"?typeof o=="string"?r.textContent!==o&&(a.suppressHydrationWarning!==!0&&F1(r.textContent,o,e),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&F1(r.textContent,o,e),i=["children",""+o]):Vy.hasOwnProperty(c)&&o!=null&&c==="onScroll"&&ui("scroll",r)}switch(n){case"input":A1(r),Nz(r,a,!0);break;case"textarea":A1(r),Uz(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Nw)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{c=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=LU(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),n==="select"&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[uc]=t,e[Jy]=r,n8(e,t,!1,!1),t.stateNode=e;e:{switch(c=NP(n,r),n){case"dialog":ui("cancel",e),ui("close",e),i=r;break;case"iframe":case"object":case"embed":ui("load",e),i=r;break;case"video":case"audio":for(i=0;i<H0.length;i++)ui(H0[i],e);i=r;break;case"source":ui("error",e),i=r;break;case"img":case"image":case"link":ui("error",e),ui("load",e),i=r;break;case"details":ui("toggle",e),i=r;break;case"input":Fz(e,r),i=LP(e,r),ui("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=bi({},r,{value:void 0}),ui("invalid",e);break;case"textarea":Bz(e,r),i=zP(e,r),ui("invalid",e);break;default:i=r}FP(n,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var f=o[a];a==="style"?zU(e,f):a==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&kU(e,f)):a==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&jy(e,f):typeof f=="number"&&jy(e,""+f):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Vy.hasOwnProperty(a)?f!=null&&a==="onScroll"&&ui("scroll",e):f!=null&&jR(e,a,f,c))}switch(n){case"input":A1(e),Nz(e,r,!1);break;case"textarea":A1(e),Uz(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Bh(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?Zm(e,!!r.multiple,a,!1):r.defaultValue!=null&&Zm(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Nw)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return rs(t),null;case 6:if(e&&t.stateNode!=null)i8(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(dn(166));if(n=yf(e_.current),yf(gc.current),N1(t)){if(r=t.stateNode,n=t.memoizedProps,r[uc]=t,(a=r.nodeValue!==n)&&(e=Sa,e!==null))switch(e.tag){case 3:F1(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&F1(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[uc]=t,t.stateNode=r}return rs(t),null;case 13:if(hi(yi),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(mi&&ya!==null&&t.mode&1&&!(t.flags&128))w$(),mg(),t.flags|=98560,a=!1;else if(a=N1(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(dn(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(dn(317));a[uc]=t}else mg(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;rs(t),a=!1}else Ml!==null&&(yA(Ml),Ml=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||yi.current&1?uo===0&&(uo=3):C3())),t.updateQueue!==null&&(t.flags|=4),rs(t),null);case 4:return vg(),uA(e,t),e===null&&Yy(t.stateNode.containerInfo),rs(t),null;case 10:return l3(t.type._context),rs(t),null;case 17:return Us(t.type)&&Bw(),rs(t),null;case 19:if(hi(yi),a=t.memoizedState,a===null)return rs(t),null;if(r=(t.flags&128)!==0,c=a.rendering,c===null)if(r)v0(a,!1);else{if(uo!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(c=Ww(e),c!==null){for(t.flags|=128,v0(a,!1),r=c.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,c=a.alternate,c===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,e=c.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return si(yi,yi.current&1|2),t.child}e=e.sibling}a.tail!==null&&Oi()>_g&&(t.flags|=128,r=!0,v0(a,!1),t.lanes=4194304)}else{if(!r)if(e=Ww(c),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),v0(a,!0),a.tail===null&&a.tailMode==="hidden"&&!c.alternate&&!mi)return rs(t),null}else 2*Oi()-a.renderingStartTime>_g&&n!==1073741824&&(t.flags|=128,r=!0,v0(a,!1),t.lanes=4194304);a.isBackwards?(c.sibling=t.child,t.child=c):(n=a.last,n!==null?n.sibling=c:t.child=c,a.last=c)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Oi(),t.sibling=null,n=yi.current,si(yi,r?n&1|2:n&1),t):(rs(t),null);case 22:case 23:return M3(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?ca&1073741824&&(rs(t),t.subtreeFlags&6&&(t.flags|=8192)):rs(t),null;case 24:return null;case 25:return null}throw Error(dn(156,t.tag))}function Kee(e,t){switch(i3(t),t.tag){case 1:return Us(t.type)&&Bw(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return vg(),hi(Bs),hi(cs),f3(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return d3(t),null;case 13:if(hi(yi),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(dn(340));mg()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return hi(yi),null;case 4:return vg(),null;case 10:return l3(t.type._context),null;case 22:case 23:return M3(),null;case 24:return null;default:return null}}var $1=!1,ls=!1,Jee=typeof WeakSet=="function"?WeakSet:Set,On=null;function Om(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ii(e,t,r)}else n.current=null}function hA(e,t,n){try{n()}catch(r){Ii(e,t,r)}}var AO=!1;function Qee(e,t){if(XP=zw,e=c$(),n3(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var c=0,o=-1,f=-1,g=0,_=0,x=e,M=null;t:for(;;){for(var C;x!==n||i!==0&&x.nodeType!==3||(o=c+i),x!==a||r!==0&&x.nodeType!==3||(f=c+r),x.nodeType===3&&(c+=x.nodeValue.length),(C=x.firstChild)!==null;)M=x,x=C;for(;;){if(x===e)break t;if(M===n&&++g===i&&(o=c),M===a&&++_===r&&(f=c),(C=x.nextSibling)!==null)break;x=M,M=x.parentNode}x=C}n=o===-1||f===-1?null:{start:o,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(ZP={focusedElem:e,selectionRange:n},zw=!1,On=t;On!==null;)if(t=On,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,On=e;else for(;On!==null;){t=On;try{var A=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var L=A.memoizedProps,I=A.memoizedState,T=t.stateNode,z=T.getSnapshotBeforeUpdate(t.elementType===t.type?L:wl(t.type,L),I);T.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var k=t.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(dn(163))}}catch(U){Ii(t,t.return,U)}if(e=t.sibling,e!==null){e.return=t.return,On=e;break}On=t.return}return A=AO,AO=!1,A}function cy(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&hA(t,n,a)}i=i.next}while(i!==r)}}function wM(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function dA(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function o8(e){var t=e.alternate;t!==null&&(e.alternate=null,o8(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[uc],delete t[Jy],delete t[JP],delete t[zee],delete t[Oee])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function s8(e){return e.tag===5||e.tag===3||e.tag===4}function IO(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||s8(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function fA(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Nw));else if(r!==4&&(e=e.child,e!==null))for(fA(e,t,n),e=e.sibling;e!==null;)fA(e,t,n),e=e.sibling}function pA(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(pA(e,t,n),e=e.sibling;e!==null;)pA(e,t,n),e=e.sibling}var Fo=null,Sl=!1;function eh(e,t,n){for(n=n.child;n!==null;)a8(e,t,n),n=n.sibling}function a8(e,t,n){if(mc&&typeof mc.onCommitFiberUnmount=="function")try{mc.onCommitFiberUnmount(pM,n)}catch{}switch(n.tag){case 5:ls||Om(n,t);case 6:var r=Fo,i=Sl;Fo=null,eh(e,t,n),Fo=r,Sl=i,Fo!==null&&(Sl?(e=Fo,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Fo.removeChild(n.stateNode));break;case 18:Fo!==null&&(Sl?(e=Fo,n=n.stateNode,e.nodeType===8?dE(e.parentNode,n):e.nodeType===1&&dE(e,n),qy(e)):dE(Fo,n.stateNode));break;case 4:r=Fo,i=Sl,Fo=n.stateNode.containerInfo,Sl=!0,eh(e,t,n),Fo=r,Sl=i;break;case 0:case 11:case 14:case 15:if(!ls&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,c=a.destroy;a=a.tag,c!==void 0&&(a&2||a&4)&&hA(n,t,c),i=i.next}while(i!==r)}eh(e,t,n);break;case 1:if(!ls&&(Om(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ii(n,t,o)}eh(e,t,n);break;case 21:eh(e,t,n);break;case 22:n.mode&1?(ls=(r=ls)||n.memoizedState!==null,eh(e,t,n),ls=r):eh(e,t,n);break;default:eh(e,t,n)}}function RO(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Jee),t.forEach(function(r){var i=lte.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ml(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,c=t,o=c;e:for(;o!==null;){switch(o.tag){case 5:Fo=o.stateNode,Sl=!1;break e;case 3:Fo=o.stateNode.containerInfo,Sl=!0;break e;case 4:Fo=o.stateNode.containerInfo,Sl=!0;break e}o=o.return}if(Fo===null)throw Error(dn(160));a8(a,c,i),Fo=null,Sl=!1;var f=i.alternate;f!==null&&(f.return=null),i.return=null}catch(g){Ii(i,t,g)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)l8(t,e),t=t.sibling}function l8(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),Kl(e),r&4){try{cy(3,e,e.return),wM(3,e)}catch(L){Ii(e,e.return,L)}try{cy(5,e,e.return)}catch(L){Ii(e,e.return,L)}}break;case 1:ml(t,e),Kl(e),r&512&&n!==null&&Om(n,n.return);break;case 5:if(ml(t,e),Kl(e),r&512&&n!==null&&Om(n,n.return),e.flags&32){var i=e.stateNode;try{jy(i,"")}catch(L){Ii(e,e.return,L)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,c=n!==null?n.memoizedProps:a,o=e.type,f=e.updateQueue;if(e.updateQueue=null,f!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&IU(i,a),NP(o,c);var g=NP(o,a);for(c=0;c<f.length;c+=2){var _=f[c],x=f[c+1];_==="style"?zU(i,x):_==="dangerouslySetInnerHTML"?kU(i,x):_==="children"?jy(i,x):jR(i,_,x,g)}switch(o){case"input":kP(i,a);break;case"textarea":RU(i,a);break;case"select":var M=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var C=a.value;C!=null?Zm(i,!!a.multiple,C,!1):M!==!!a.multiple&&(a.defaultValue!=null?Zm(i,!!a.multiple,a.defaultValue,!0):Zm(i,!!a.multiple,a.multiple?[]:"",!1))}i[Jy]=a}catch(L){Ii(e,e.return,L)}}break;case 6:if(ml(t,e),Kl(e),r&4){if(e.stateNode===null)throw Error(dn(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(L){Ii(e,e.return,L)}}break;case 3:if(ml(t,e),Kl(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qy(t.containerInfo)}catch(L){Ii(e,e.return,L)}break;case 4:ml(t,e),Kl(e);break;case 13:ml(t,e),Kl(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(w3=Oi())),r&4&&RO(e);break;case 22:if(_=n!==null&&n.memoizedState!==null,e.mode&1?(ls=(g=ls)||_,ml(t,e),ls=g):ml(t,e),Kl(e),r&8192){if(g=e.memoizedState!==null,(e.stateNode.isHidden=g)&&!_&&e.mode&1)for(On=e,_=e.child;_!==null;){for(x=On=_;On!==null;){switch(M=On,C=M.child,M.tag){case 0:case 11:case 14:case 15:cy(4,M,M.return);break;case 1:Om(M,M.return);var A=M.stateNode;if(typeof A.componentWillUnmount=="function"){r=M,n=M.return;try{t=r,A.props=t.memoizedProps,A.state=t.memoizedState,A.componentWillUnmount()}catch(L){Ii(r,n,L)}}break;case 5:Om(M,M.return);break;case 22:if(M.memoizedState!==null){kO(x);continue}}C!==null?(C.return=M,On=C):kO(x)}_=_.sibling}e:for(_=null,x=e;;){if(x.tag===5){if(_===null){_=x;try{i=x.stateNode,g?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=x.stateNode,f=x.memoizedProps.style,c=f!=null&&f.hasOwnProperty("display")?f.display:null,o.style.display=DU("display",c))}catch(L){Ii(e,e.return,L)}}}else if(x.tag===6){if(_===null)try{x.stateNode.nodeValue=g?"":x.memoizedProps}catch(L){Ii(e,e.return,L)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===e)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===e)break e;for(;x.sibling===null;){if(x.return===null||x.return===e)break e;_===x&&(_=null),x=x.return}_===x&&(_=null),x.sibling.return=x.return,x=x.sibling}}break;case 19:ml(t,e),Kl(e),r&4&&RO(e);break;case 21:break;default:ml(t,e),Kl(e)}}function Kl(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(s8(n)){var r=n;break e}n=n.return}throw Error(dn(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(jy(i,""),r.flags&=-33);var a=IO(e);pA(e,a,i);break;case 3:case 4:var c=r.stateNode.containerInfo,o=IO(e);fA(e,o,c);break;default:throw Error(dn(161))}}catch(f){Ii(e,e.return,f)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ete(e,t,n){On=e,c8(e)}function c8(e,t,n){for(var r=(e.mode&1)!==0;On!==null;){var i=On,a=i.child;if(i.tag===22&&r){var c=i.memoizedState!==null||$1;if(!c){var o=i.alternate,f=o!==null&&o.memoizedState!==null||ls;o=$1;var g=ls;if($1=c,(ls=f)&&!g)for(On=i;On!==null;)c=On,f=c.child,c.tag===22&&c.memoizedState!==null?DO(i):f!==null?(f.return=c,On=f):DO(i);for(;a!==null;)On=a,c8(a),a=a.sibling;On=i,$1=o,ls=g}LO(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,On=a):LO(e)}}function LO(e){for(;On!==null;){var t=On;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ls||wM(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!ls)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:wl(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&gO(t,a,r);break;case 3:var c=t.updateQueue;if(c!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}gO(t,c,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var f=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var g=t.alternate;if(g!==null){var _=g.memoizedState;if(_!==null){var x=_.dehydrated;x!==null&&qy(x)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(dn(163))}ls||t.flags&512&&dA(t)}catch(M){Ii(t,t.return,M)}}if(t===e){On=null;break}if(n=t.sibling,n!==null){n.return=t.return,On=n;break}On=t.return}}function kO(e){for(;On!==null;){var t=On;if(t===e){On=null;break}var n=t.sibling;if(n!==null){n.return=t.return,On=n;break}On=t.return}}function DO(e){for(;On!==null;){var t=On;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{wM(4,t)}catch(f){Ii(t,n,f)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(f){Ii(t,i,f)}}var a=t.return;try{dA(t)}catch(f){Ii(t,a,f)}break;case 5:var c=t.return;try{dA(t)}catch(f){Ii(t,c,f)}}}catch(f){Ii(t,t.return,f)}if(t===e){On=null;break}var o=t.sibling;if(o!==null){o.return=t.return,On=o;break}On=t.return}}var tte=Math.ceil,Zw=_u.ReactCurrentDispatcher,x3=_u.ReactCurrentOwner,qa=_u.ReactCurrentBatchConfig,Pr=0,Po=null,eo=null,jo=0,ca=0,Fm=ed(0),uo=0,i_=null,kf=0,SM=0,b3=0,uy=null,Ds=null,w3=0,_g=1/0,Zc=null,Yw=!1,mA=null,Ah=null,V1=!1,xh=null,Kw=0,hy=0,gA=null,Yb=-1,Kb=0;function ws(){return Pr&6?Oi():Yb!==-1?Yb:Yb=Oi()}function Ih(e){return e.mode&1?Pr&2&&jo!==0?jo&-jo:Nee.transition!==null?(Kb===0&&(Kb=qU()),Kb):(e=Vr,e!==0||(e=window.event,e=e===void 0?16:e$(e.type)),e):1}function Il(e,t,n,r){if(50<hy)throw hy=0,gA=null,Error(dn(185));k_(e,n,r),(!(Pr&2)||e!==Po)&&(e===Po&&(!(Pr&2)&&(SM|=n),uo===4&&mh(e,jo)),$s(e,r),n===1&&Pr===0&&!(t.mode&1)&&(_g=Oi()+500,_M&&td()))}function $s(e,t){var n=e.callbackNode;NQ(e,t);var r=Dw(e,e===Po?jo:0);if(r===0)n!==null&&jz(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&jz(n),t===1)e.tag===0?Fee(zO.bind(null,e)):_$(zO.bind(null,e)),kee(function(){!(Pr&6)&&td()}),n=null;else{switch(XU(r)){case 1:n=XR;break;case 4:n=GU;break;case 16:n=kw;break;case 536870912:n=WU;break;default:n=kw}n=v8(n,u8.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function u8(e,t){if(Yb=-1,Kb=0,Pr&6)throw Error(dn(327));var n=e.callbackNode;if(eg()&&e.callbackNode!==n)return null;var r=Dw(e,e===Po?jo:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Jw(e,r);else{t=r;var i=Pr;Pr|=2;var a=d8();(Po!==e||jo!==t)&&(Zc=null,_g=Oi()+500,Sf(e,t));do try{ite();break}catch(o){h8(e,o)}while(!0);a3(),Zw.current=a,Pr=i,eo!==null?t=0:(Po=null,jo=0,t=uo)}if(t!==0){if(t===2&&(i=jP(e),i!==0&&(r=i,t=vA(e,i))),t===1)throw n=i_,Sf(e,0),mh(e,r),$s(e,Oi()),n;if(t===6)mh(e,r);else{if(i=e.current.alternate,!(r&30)&&!nte(i)&&(t=Jw(e,r),t===2&&(a=jP(e),a!==0&&(r=a,t=vA(e,a))),t===1))throw n=i_,Sf(e,0),mh(e,r),$s(e,Oi()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(dn(345));case 2:af(e,Ds,Zc);break;case 3:if(mh(e,r),(r&130023424)===r&&(t=w3+500-Oi(),10<t)){if(Dw(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){ws(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=KP(af.bind(null,e,Ds,Zc),t);break}af(e,Ds,Zc);break;case 4:if(mh(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var c=31-Al(r);a=1<<c,c=t[c],c>i&&(i=c),r&=~a}if(r=i,r=Oi()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*tte(r/1960))-r,10<r){e.timeoutHandle=KP(af.bind(null,e,Ds,Zc),r);break}af(e,Ds,Zc);break;case 5:af(e,Ds,Zc);break;default:throw Error(dn(329))}}}return $s(e,Oi()),e.callbackNode===n?u8.bind(null,e):null}function vA(e,t){var n=uy;return e.current.memoizedState.isDehydrated&&(Sf(e,t).flags|=256),e=Jw(e,t),e!==2&&(t=Ds,Ds=n,t!==null&&yA(t)),e}function yA(e){Ds===null?Ds=e:Ds.push.apply(Ds,e)}function nte(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Dl(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function mh(e,t){for(t&=~b3,t&=~SM,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Al(t),r=1<<n;e[n]=-1,t&=~r}}function zO(e){if(Pr&6)throw Error(dn(327));eg();var t=Dw(e,0);if(!(t&1))return $s(e,Oi()),null;var n=Jw(e,t);if(e.tag!==0&&n===2){var r=jP(e);r!==0&&(t=r,n=vA(e,r))}if(n===1)throw n=i_,Sf(e,0),mh(e,t),$s(e,Oi()),n;if(n===6)throw Error(dn(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,af(e,Ds,Zc),$s(e,Oi()),null}function S3(e,t){var n=Pr;Pr|=1;try{return e(t)}finally{Pr=n,Pr===0&&(_g=Oi()+500,_M&&td())}}function Df(e){xh!==null&&xh.tag===0&&!(Pr&6)&&eg();var t=Pr;Pr|=1;var n=qa.transition,r=Vr;try{if(qa.transition=null,Vr=1,e)return e()}finally{Vr=r,qa.transition=n,Pr=t,!(Pr&6)&&td()}}function M3(){ca=Fm.current,hi(Fm)}function Sf(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Lee(n)),eo!==null)for(n=eo.return;n!==null;){var r=n;switch(i3(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Bw();break;case 3:vg(),hi(Bs),hi(cs),f3();break;case 5:d3(r);break;case 4:vg();break;case 13:hi(yi);break;case 19:hi(yi);break;case 10:l3(r.type._context);break;case 22:case 23:M3()}n=n.return}if(Po=e,eo=e=Rh(e.current,null),jo=ca=t,uo=0,i_=null,b3=SM=kf=0,Ds=uy=null,vf!==null){for(t=0;t<vf.length;t++)if(n=vf[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var c=a.next;a.next=i,r.next=c}n.pending=r}vf=null}return e}function h8(e,t){do{var n=eo;try{if(a3(),qb.current=Xw,qw){for(var r=_i.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}qw=!1}if(Lf=0,Co=co=_i=null,ly=!1,t_=0,x3.current=null,n===null||n.return===null){uo=1,i_=t,eo=null;break}e:{var a=e,c=n.return,o=n,f=t;if(t=jo,o.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var g=f,_=o,x=_.tag;if(!(_.mode&1)&&(x===0||x===11||x===15)){var M=_.alternate;M?(_.updateQueue=M.updateQueue,_.memoizedState=M.memoizedState,_.lanes=M.lanes):(_.updateQueue=null,_.memoizedState=null)}var C=wO(c);if(C!==null){C.flags&=-257,SO(C,c,o,a,t),C.mode&1&&bO(a,g,t),t=C,f=g;var A=t.updateQueue;if(A===null){var L=new Set;L.add(f),t.updateQueue=L}else A.add(f);break e}else{if(!(t&1)){bO(a,g,t),C3();break e}f=Error(dn(426))}}else if(mi&&o.mode&1){var I=wO(c);if(I!==null){!(I.flags&65536)&&(I.flags|=256),SO(I,c,o,a,t),o3(yg(f,o));break e}}a=f=yg(f,o),uo!==4&&(uo=2),uy===null?uy=[a]:uy.push(a),a=c;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var T=X$(a,f,t);mO(a,T);break e;case 1:o=f;var z=a.type,k=a.stateNode;if(!(a.flags&128)&&(typeof z.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Ah===null||!Ah.has(k)))){a.flags|=65536,t&=-t,a.lanes|=t;var U=Z$(a,o,t);mO(a,U);break e}}a=a.return}while(a!==null)}p8(n)}catch(H){t=H,eo===n&&n!==null&&(eo=n=n.return);continue}break}while(!0)}function d8(){var e=Zw.current;return Zw.current=Xw,e===null?Xw:e}function C3(){(uo===0||uo===3||uo===2)&&(uo=4),Po===null||!(kf&268435455)&&!(SM&268435455)||mh(Po,jo)}function Jw(e,t){var n=Pr;Pr|=2;var r=d8();(Po!==e||jo!==t)&&(Zc=null,Sf(e,t));do try{rte();break}catch(i){h8(e,i)}while(!0);if(a3(),Pr=n,Zw.current=r,eo!==null)throw Error(dn(261));return Po=null,jo=0,uo}function rte(){for(;eo!==null;)f8(eo)}function ite(){for(;eo!==null&&!AQ();)f8(eo)}function f8(e){var t=g8(e.alternate,e,ca);e.memoizedProps=e.pendingProps,t===null?p8(e):eo=t,x3.current=null}function p8(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Kee(n,t),n!==null){n.flags&=32767,eo=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{uo=6,eo=null;return}}else if(n=Yee(n,t,ca),n!==null){eo=n;return}if(t=t.sibling,t!==null){eo=t;return}eo=t=e}while(t!==null);uo===0&&(uo=5)}function af(e,t,n){var r=Vr,i=qa.transition;try{qa.transition=null,Vr=1,ote(e,t,n,r)}finally{qa.transition=i,Vr=r}return null}function ote(e,t,n,r){do eg();while(xh!==null);if(Pr&6)throw Error(dn(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(dn(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(BQ(e,a),e===Po&&(eo=Po=null,jo=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||V1||(V1=!0,v8(kw,function(){return eg(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=qa.transition,qa.transition=null;var c=Vr;Vr=1;var o=Pr;Pr|=4,x3.current=null,Qee(e,n),l8(n,e),Cee(ZP),zw=!!XP,ZP=XP=null,e.current=n,ete(n),IQ(),Pr=o,Vr=c,qa.transition=a}else e.current=n;if(V1&&(V1=!1,xh=e,Kw=i),a=e.pendingLanes,a===0&&(Ah=null),kQ(n.stateNode),$s(e,Oi()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Yw)throw Yw=!1,e=mA,mA=null,e;return Kw&1&&e.tag!==0&&eg(),a=e.pendingLanes,a&1?e===gA?hy++:(hy=0,gA=e):hy=0,td(),null}function eg(){if(xh!==null){var e=XU(Kw),t=qa.transition,n=Vr;try{if(qa.transition=null,Vr=16>e?16:e,xh===null)var r=!1;else{if(e=xh,xh=null,Kw=0,Pr&6)throw Error(dn(331));var i=Pr;for(Pr|=4,On=e.current;On!==null;){var a=On,c=a.child;if(On.flags&16){var o=a.deletions;if(o!==null){for(var f=0;f<o.length;f++){var g=o[f];for(On=g;On!==null;){var _=On;switch(_.tag){case 0:case 11:case 15:cy(8,_,a)}var x=_.child;if(x!==null)x.return=_,On=x;else for(;On!==null;){_=On;var M=_.sibling,C=_.return;if(o8(_),_===g){On=null;break}if(M!==null){M.return=C,On=M;break}On=C}}}var A=a.alternate;if(A!==null){var L=A.child;if(L!==null){A.child=null;do{var I=L.sibling;L.sibling=null,L=I}while(L!==null)}}On=a}}if(a.subtreeFlags&2064&&c!==null)c.return=a,On=c;else e:for(;On!==null;){if(a=On,a.flags&2048)switch(a.tag){case 0:case 11:case 15:cy(9,a,a.return)}var T=a.sibling;if(T!==null){T.return=a.return,On=T;break e}On=a.return}}var z=e.current;for(On=z;On!==null;){c=On;var k=c.child;if(c.subtreeFlags&2064&&k!==null)k.return=c,On=k;else e:for(c=z;On!==null;){if(o=On,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:wM(9,o)}}catch(H){Ii(o,o.return,H)}if(o===c){On=null;break e}var U=o.sibling;if(U!==null){U.return=o.return,On=U;break e}On=o.return}}if(Pr=i,td(),mc&&typeof mc.onPostCommitFiberRoot=="function")try{mc.onPostCommitFiberRoot(pM,e)}catch{}r=!0}return r}finally{Vr=n,qa.transition=t}}return!1}function OO(e,t,n){t=yg(n,t),t=X$(e,t,1),e=Ph(e,t,1),t=ws(),e!==null&&(k_(e,1,t),$s(e,t))}function Ii(e,t,n){if(e.tag===3)OO(e,e,n);else for(;t!==null;){if(t.tag===3){OO(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ah===null||!Ah.has(r))){e=yg(n,e),e=Z$(t,e,1),t=Ph(t,e,1),e=ws(),t!==null&&(k_(t,1,e),$s(t,e));break}}t=t.return}}function ste(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=ws(),e.pingedLanes|=e.suspendedLanes&n,Po===e&&(jo&n)===n&&(uo===4||uo===3&&(jo&130023424)===jo&&500>Oi()-w3?Sf(e,0):b3|=n),$s(e,t)}function m8(e,t){t===0&&(e.mode&1?(t=L1,L1<<=1,!(L1&130023424)&&(L1=4194304)):t=1);var n=ws();e=uu(e,t),e!==null&&(k_(e,t,n),$s(e,n))}function ate(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),m8(e,n)}function lte(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(dn(314))}r!==null&&r.delete(t),m8(e,n)}var g8;g8=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Bs.current)Fs=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Fs=!1,Zee(e,t,n);Fs=!!(e.flags&131072)}else Fs=!1,mi&&t.flags&1048576&&x$(t,Vw,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Zb(e,t),e=t.pendingProps;var i=pg(t,cs.current);Qm(t,n),i=m3(null,t,r,e,i,n);var a=g3();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Us(r)?(a=!0,Uw(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,u3(t),i.updater=bM,t.stateNode=i,i._reactInternals=t,iA(t,r,e,n),t=aA(null,t,r,!0,a,n)):(t.tag=0,mi&&a&&r3(t),ys(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Zb(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=ute(r),e=wl(r,e),i){case 0:t=sA(null,t,r,e,n);break e;case 1:t=EO(null,t,r,e,n);break e;case 11:t=MO(null,t,r,e,n);break e;case 14:t=CO(null,t,r,wl(r.type,e),n);break e}throw Error(dn(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:wl(r,i),sA(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:wl(r,i),EO(e,t,r,i,n);case 3:e:{if(Q$(t),e===null)throw Error(dn(387));r=t.pendingProps,a=t.memoizedState,i=a.element,E$(e,t),Gw(t,r,null,n);var c=t.memoizedState;if(r=c.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=yg(Error(dn(423)),t),t=TO(e,t,r,n,i);break e}else if(r!==i){i=yg(Error(dn(424)),t),t=TO(e,t,r,n,i);break e}else for(ya=Th(t.stateNode.containerInfo.firstChild),Sa=t,mi=!0,Ml=null,n=M$(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(mg(),r===i){t=hu(e,t,n);break e}ys(e,t,r,n)}t=t.child}return t;case 5:return T$(t),e===null&&tA(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,c=i.children,YP(r,i)?c=null:a!==null&&YP(r,a)&&(t.flags|=32),J$(e,t),ys(e,t,c,n),t.child;case 6:return e===null&&tA(t),null;case 13:return e8(e,t,n);case 4:return h3(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=gg(t,null,r,n):ys(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:wl(r,i),MO(e,t,r,i,n);case 7:return ys(e,t,t.pendingProps,n),t.child;case 8:return ys(e,t,t.pendingProps.children,n),t.child;case 12:return ys(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,c=i.value,si(jw,r._currentValue),r._currentValue=c,a!==null)if(Dl(a.value,c)){if(a.children===i.children&&!Bs.current){t=hu(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){c=a.child;for(var f=o.firstContext;f!==null;){if(f.context===r){if(a.tag===1){f=ru(-1,n&-n),f.tag=2;var g=a.updateQueue;if(g!==null){g=g.shared;var _=g.pending;_===null?f.next=f:(f.next=_.next,_.next=f),g.pending=f}}a.lanes|=n,f=a.alternate,f!==null&&(f.lanes|=n),nA(a.return,n,t),o.lanes|=n;break}f=f.next}}else if(a.tag===10)c=a.type===t.type?null:a.child;else if(a.tag===18){if(c=a.return,c===null)throw Error(dn(341));c.lanes|=n,o=c.alternate,o!==null&&(o.lanes|=n),nA(c,n,t),c=a.sibling}else c=a.child;if(c!==null)c.return=a;else for(c=a;c!==null;){if(c===t){c=null;break}if(a=c.sibling,a!==null){a.return=c.return,c=a;break}c=c.return}a=c}ys(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Qm(t,n),i=Za(i),r=r(i),t.flags|=1,ys(e,t,r,n),t.child;case 14:return r=t.type,i=wl(r,t.pendingProps),i=wl(r.type,i),CO(e,t,r,i,n);case 15:return Y$(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:wl(r,i),Zb(e,t),t.tag=1,Us(r)?(e=!0,Uw(t)):e=!1,Qm(t,n),q$(t,r,i),iA(t,r,i,n),aA(null,t,r,!0,e,n);case 19:return t8(e,t,n);case 22:return K$(e,t,n)}throw Error(dn(156,t.tag))};function v8(e,t){return HU(e,t)}function cte(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wa(e,t,n,r){return new cte(e,t,n,r)}function E3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ute(e){if(typeof e=="function")return E3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===GR)return 11;if(e===WR)return 14}return 2}function Rh(e,t){var n=e.alternate;return n===null?(n=Wa(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Jb(e,t,n,r,i,a){var c=2;if(r=e,typeof e=="function")E3(e)&&(c=1);else if(typeof e=="string")c=5;else e:switch(e){case Tm:return Mf(n.children,i,a,t);case HR:c=8,i|=8;break;case PP:return e=Wa(12,n,t,i|2),e.elementType=PP,e.lanes=a,e;case AP:return e=Wa(13,n,t,i),e.elementType=AP,e.lanes=a,e;case IP:return e=Wa(19,n,t,i),e.elementType=IP,e.lanes=a,e;case TU:return MM(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case CU:c=10;break e;case EU:c=9;break e;case GR:c=11;break e;case WR:c=14;break e;case hh:c=16,r=null;break e}throw Error(dn(130,e==null?e:typeof e,""))}return t=Wa(c,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function Mf(e,t,n,r){return e=Wa(7,e,r,t),e.lanes=n,e}function MM(e,t,n,r){return e=Wa(22,e,r,t),e.elementType=TU,e.lanes=n,e.stateNode={isHidden:!1},e}function xE(e,t,n){return e=Wa(6,e,null,t),e.lanes=n,e}function bE(e,t,n){return t=Wa(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function hte(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tE(0),this.expirationTimes=tE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tE(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function T3(e,t,n,r,i,a,c,o,f){return e=new hte(e,t,n,o,f),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Wa(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},u3(a),e}function dte(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Em,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function y8(e){if(!e)return Uh;e=e._reactInternals;e:{if(Gf(e)!==e||e.tag!==1)throw Error(dn(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Us(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(dn(171))}if(e.tag===1){var n=e.type;if(Us(n))return y$(e,n,t)}return t}function _8(e,t,n,r,i,a,c,o,f){return e=T3(n,r,!0,e,i,a,c,o,f),e.context=y8(null),n=e.current,r=ws(),i=Ih(n),a=ru(r,i),a.callback=t??null,Ph(n,a,i),e.current.lanes=i,k_(e,i,r),$s(e,r),e}function CM(e,t,n,r){var i=t.current,a=ws(),c=Ih(i);return n=y8(n),t.context===null?t.context=n:t.pendingContext=n,t=ru(a,c),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ph(i,t,c),e!==null&&(Il(e,i,c,a),Wb(e,i,c)),c}function Qw(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function FO(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function P3(e,t){FO(e,t),(e=e.alternate)&&FO(e,t)}var x8=typeof reportError=="function"?reportError:function(e){console.error(e)};function A3(e){this._internalRoot=e}EM.prototype.render=A3.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(dn(409));CM(e,t,null,null)};EM.prototype.unmount=A3.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Df(function(){CM(null,e,null,null)}),t[cu]=null}};function EM(e){this._internalRoot=e}EM.prototype.unstable_scheduleHydration=function(e){if(e){var t=KU();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ph.length&&t!==0&&t<ph[n].priority;n++);ph.splice(n,0,e),n===0&&QU(e)}};function I3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function TM(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function NO(){}function fte(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var g=Qw(c);a.call(g)}}var c=_8(t,r,e,0,null,!1,!1,"",NO);return e._reactRootContainer=c,e[cu]=c.current,Yy(e.nodeType===8?e.parentNode:e),Df(),c}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var g=Qw(f);o.call(g)}}var f=T3(e,0,!1,null,null,!1,!1,"",NO);return e._reactRootContainer=f,e[cu]=f.current,Yy(e.nodeType===8?e.parentNode:e),Df(function(){CM(t,f,n,r)}),f}function PM(e,t,n,r,i){var a=n._reactRootContainer;if(a){var c=a;if(typeof i=="function"){var o=i;i=function(){var f=Qw(c);o.call(f)}}CM(t,c,e,i)}else c=fte(n,t,e,i,r);return Qw(c)}ZU=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=j0(t.pendingLanes);n!==0&&(ZR(t,n|1),$s(t,Oi()),!(Pr&6)&&(_g=Oi()+500,td()))}break;case 13:Df(function(){var r=uu(e,1);if(r!==null){var i=ws();Il(r,e,1,i)}}),P3(e,1)}};YR=function(e){if(e.tag===13){var t=uu(e,134217728);if(t!==null){var n=ws();Il(t,e,134217728,n)}P3(e,134217728)}};YU=function(e){if(e.tag===13){var t=Ih(e),n=uu(e,t);if(n!==null){var r=ws();Il(n,e,t,r)}P3(e,t)}};KU=function(){return Vr};JU=function(e,t){var n=Vr;try{return Vr=e,t()}finally{Vr=n}};UP=function(e,t,n){switch(t){case"input":if(kP(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=yM(r);if(!i)throw Error(dn(90));AU(r),kP(r,i)}}}break;case"textarea":RU(e,n);break;case"select":t=n.value,t!=null&&Zm(e,!!n.multiple,t,!1)}};NU=S3;BU=Df;var pte={usingClientEntryPoint:!1,Events:[z_,Rm,yM,OU,FU,S3]},y0={findFiberByHostInstance:gf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mte={bundleType:y0.bundleType,version:y0.version,rendererPackageName:y0.rendererPackageName,rendererConfig:y0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_u.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=VU(e),e===null?null:e.stateNode},findFiberByHostInstance:y0.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var j1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!j1.isDisabled&&j1.supportsFiber)try{pM=j1.inject(mte),mc=j1}catch{}}Aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pte;Aa.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I3(t))throw Error(dn(200));return dte(e,t,null,n)};Aa.createRoot=function(e,t){if(!I3(e))throw Error(dn(299));var n=!1,r="",i=x8;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=T3(e,1,!1,null,null,n,!1,r,i),e[cu]=t.current,Yy(e.nodeType===8?e.parentNode:e),new A3(t)};Aa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(dn(188)):(e=Object.keys(e).join(","),Error(dn(268,e)));return e=VU(t),e=e===null?null:e.stateNode,e};Aa.flushSync=function(e){return Df(e)};Aa.hydrate=function(e,t,n){if(!TM(t))throw Error(dn(200));return PM(null,e,t,!0,n)};Aa.hydrateRoot=function(e,t,n){if(!I3(e))throw Error(dn(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",c=x8;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),t=_8(t,null,e,1,n??null,i,!1,a,c),e[cu]=t.current,Yy(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new EM(t)};Aa.render=function(e,t,n){if(!TM(t))throw Error(dn(200));return PM(null,e,t,!1,n)};Aa.unmountComponentAtNode=function(e){if(!TM(e))throw Error(dn(40));return e._reactRootContainer?(Df(function(){PM(null,null,e,!1,function(){e._reactRootContainer=null,e[cu]=null})}),!0):!1};Aa.unstable_batchedUpdates=S3;Aa.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!TM(n))throw Error(dn(200));if(e==null||e._reactInternals===void 0)throw Error(dn(38));return PM(e,t,n,!1,r)};Aa.version="18.3.1-next-f1338f8080-20240426";function b8(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(b8)}catch(e){console.error(e)}}b8(),bU.exports=Aa;var F_=bU.exports;function gte(e){return typeof e=="function"?e():e}const w8=$.forwardRef(function(t,n){const{children:r,container:i,disablePortal:a=!1}=t,[c,o]=$.useState(null),f=Ur($.isValidElement(r)?cM(r):null,n);if(su(()=>{a||o(gte(i)||document.body)},[i,a]),su(()=>{if(c&&!a)return Aw(n,c),()=>{Aw(n,null)}},[n,c,a]),a){if($.isValidElement(r)){const g={ref:f};return $.cloneElement(r,g)}return ee.jsx($.Fragment,{children:r})}return ee.jsx($.Fragment,{children:c&&F_.createPortal(r,c)})});function vte(e={}){const{disabled:t=!1,focusableWhenDisabled:n,rootRef:r}=e,i=$.useContext(uM);if(i===null)throw new Error("useMenuButton: no menu context available.");const{state:a,dispatch:c,registerTrigger:o,popupId:f}=i,{getRootProps:g,rootRef:_,active:x}=Mc({disabled:t,focusableWhenDisabled:n,rootRef:r}),M=Ur(_,o),C=T=>z=>{var k;(k=T.onClick)==null||k.call(T,z),!z.defaultMuiPrevented&&c({type:Cl.toggle,event:z})},A=T=>z=>{var k;(k=T.onKeyDown)==null||k.call(T,z),!z.defaultMuiPrevented&&(z.key==="ArrowDown"||z.key==="ArrowUp")&&(z.preventDefault(),c({type:Cl.open,event:z}))},L=(T={})=>({onClick:C(T),onKeyDown:A(T)});return{active:x,getRootProps:(T={})=>{const z=ho(T),k=au(L,g);return ue({"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":f},T,z,k(z),{tabIndex:0,ref:M})},open:a.open,rootRef:M}}function yte(e){return`menu-item-${e.size}`}const _te={dispatch:()=>{},popupId:"",registerPopup:()=>{},registerTrigger:()=>{},state:{open:!0,changeReason:null},triggerElement:null};function xte(e){var t;const{disabled:n=!1,id:r,rootRef:i,label:a,disableFocusOnHover:c=!1}=e,o=qs(r),f=$.useRef(null),g=$.useMemo(()=>({disabled:n,id:o??"",label:a,ref:f}),[n,o,a]),{dispatch:_}=(t=$.useContext(uM))!=null?t:_te,{getRootProps:x,highlighted:M}=UR({item:o,handlePointerOverEvents:!c}),{index:C,totalItemCount:A}=fM(o??yte,g),{getRootProps:L,focusVisible:I,rootRef:T}=Mc({disabled:n,focusableWhenDisabled:!0}),z=Ur(T,i,f);$.useDebugValue({id:o,highlighted:M,disabled:n,label:a});const k=V=>q=>{var J;(J=V.onClick)==null||J.call(V,q),!q.defaultMuiPrevented&&_({type:Cl.close,event:q})},U=(V={})=>ue({},V,{onClick:k(V)});function H(V={}){const q=ho(V),J=au(U,au(L,x));return ue({},V,q,J(q),{id:o,ref:z,role:"menuitem"})}return o===void 0?{getRootProps:H,disabled:!1,focusVisible:I,highlighted:!1,index:-1,totalItemCount:0,rootRef:z}:{getRootProps:H,disabled:n,focusVisible:I,highlighted:M,index:C,totalItemCount:A,rootRef:z}}function bte(e){const t=$.useContext(Jh);if(!t)throw new Error("MenuItem: ListContext was not found.");const n=qs(e),{getItemState:r,dispatch:i}=t;let a;n!=null?a=r(n):a={focusable:!0,highlighted:!1,selected:!1};const{highlighted:c,selected:o,focusable:f}=a,g=$.useCallback(x=>{if(x!==n)throw new Error(["Base UI MenuItem: Tried to access the state of another MenuItem.",`itemValue: ${x} | id: ${n}`,"This is unsupported when the MenuItem uses the MenuItemContextStabilizer as a performance optimization."].join("/n"));return{highlighted:c,selected:o,focusable:f}},[c,o,f,n]);return{contextValue:$.useMemo(()=>({dispatch:i,getItemState:g}),[i,g]),id:n}}function wte(e){const t=wa(e);return t.body===e?RR(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function dy(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function BO(e){return parseInt(RR(e).getComputedStyle(e).paddingRight,10)||0}function Ste(e){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName)!==-1,r=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return n||r}function UO(e,t,n,r,i){const a=[t,n,...r];[].forEach.call(e.children,c=>{const o=a.indexOf(c)===-1,f=!Ste(c);o&&f&&dy(c,i)})}function wE(e,t){let n=-1;return e.some((r,i)=>t(r)?(n=i,!0):!1),n}function Mte(e,t){const n=[],r=e.container;if(!t.disableScrollLock){if(wte(r)){const c=LK(wa(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${BO(r)+c}px`;const o=wa(r).querySelectorAll(".mui-fixed");[].forEach.call(o,f=>{n.push({value:f.style.paddingRight,property:"padding-right",el:f}),f.style.paddingRight=`${BO(f)+c}px`})}let a;if(r.parentNode instanceof DocumentFragment)a=wa(r).body;else{const c=r.parentElement,o=RR(r);a=(c==null?void 0:c.nodeName)==="HTML"&&o.getComputedStyle(c).overflowY==="scroll"?c:r}n.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return()=>{n.forEach(({value:a,el:c,property:o})=>{a?c.style.setProperty(o,a):c.style.removeProperty(o)})}}function Cte(e){const t=[];return[].forEach.call(e.children,n=>{n.getAttribute("aria-hidden")==="true"&&t.push(n)}),t}class Ete{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(t,n){let r=this.modals.indexOf(t);if(r!==-1)return r;r=this.modals.length,this.modals.push(t),t.modalRef&&dy(t.modalRef,!1);const i=Cte(n);UO(n,t.mount,t.modalRef,i,!0);const a=wE(this.containers,c=>c.container===n);return a!==-1?(this.containers[a].modals.push(t),r):(this.containers.push({modals:[t],container:n,restore:null,hiddenSiblings:i}),r)}mount(t,n){const r=wE(this.containers,a=>a.modals.indexOf(t)!==-1),i=this.containers[r];i.restore||(i.restore=Mte(i,n))}remove(t,n=!0){const r=this.modals.indexOf(t);if(r===-1)return r;const i=wE(this.containers,c=>c.modals.indexOf(t)!==-1),a=this.containers[i];if(a.modals.splice(a.modals.indexOf(t),1),this.modals.splice(r,1),a.modals.length===0)a.restore&&a.restore(),t.modalRef&&dy(t.modalRef,n),UO(a.container,t.mount,t.modalRef,a.hiddenSiblings,!1),this.containers.splice(i,1);else{const c=a.modals[a.modals.length-1];c.modalRef&&dy(c.modalRef,!1)}return r}isTopModal(t){return this.modals.length>0&&this.modals[this.modals.length-1]===t}}function Tte(e){return typeof e=="function"?e():e}function Pte(e){return e?e.props.hasOwnProperty("in"):!1}const Ate=new Ete;function Ite(e){const{container:t,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:i=Ate,closeAfterTransition:a=!1,onTransitionEnter:c,onTransitionExited:o,children:f,onClose:g,open:_,rootRef:x}=e,M=$.useRef({}),C=$.useRef(null),A=$.useRef(null),L=Ur(A,x),[I,T]=$.useState(!_),z=Pte(f);let k=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(k=!1);const U=()=>wa(C.current),H=()=>(M.current.modalRef=A.current,M.current.mount=C.current,M.current),V=()=>{i.mount(H(),{disableScrollLock:r}),A.current&&(A.current.scrollTop=0)},q=Tl(()=>{const ve=Tte(t)||U().body;i.add(H(),ve),A.current&&V()}),J=$.useCallback(()=>i.isTopModal(H()),[i]),Y=Tl(ve=>{C.current=ve,ve&&(_&&J()?V():A.current&&dy(A.current,k))}),N=$.useCallback(()=>{i.remove(H(),k)},[k,i]);$.useEffect(()=>()=>{N()},[N]),$.useEffect(()=>{_?q():(!z||!a)&&N()},[_,N,z,a,q]);const ne=ve=>Se=>{var Me;(Me=ve.onKeyDown)==null||Me.call(ve,Se),!(Se.key!=="Escape"||Se.which===229||!J())&&(n||(Se.stopPropagation(),g&&g(Se,"escapeKeyDown")))},ye=ve=>Se=>{var Me;(Me=ve.onClick)==null||Me.call(ve,Se),Se.target===Se.currentTarget&&g&&g(Se,"backdropClick")};return{getRootProps:(ve={})=>{const Se=ho(e);delete Se.onTransitionEnter,delete Se.onTransitionExited;const Me=ue({},Se,ve);return ue({role:"presentation"},Me,{onKeyDown:ne(Me),ref:L})},getBackdropProps:(ve={})=>{const Se=ve;return ue({"aria-hidden":!0},Se,{onClick:ye(Se),open:_})},getTransitionProps:()=>{const ve=()=>{T(!1),c&&c()},Se=()=>{T(!0),o&&o(),a&&N()};return{onEnter:_z(ve,f==null?void 0:f.props.onEnter),onExited:_z(Se,f==null?void 0:f.props.onExited)}},rootRef:L,portalRef:Y,isTopModal:J,exited:I,hasTransition:z}}function Rte(e){const{value:t,label:n,disabled:r,rootRef:i,id:a}=e,{getRootProps:c,highlighted:o,selected:f}=UR({item:t}),{getRootProps:g,rootRef:_}=Mc({disabled:r,focusableWhenDisabled:!0}),x=qs(a),M=$.useRef(null),C=$.useMemo(()=>({disabled:r,label:n,value:t,ref:M,id:x}),[r,n,t,x]),{index:A}=fM(t,C),L=Ur(i,M,_),I=z=>k=>{var U;(U=z.onKeyDown)==null||U.call(z,k),!k.defaultMuiPrevented&&[" ","Enter"].includes(k.key)&&(k.defaultMuiPrevented=!0)},T=(z={})=>({onKeyDown:I(z)});return{getRootProps:(z={})=>{const k=ho(z),U=au(c,au(g,T));return ue({},z,k,U(k),{id:x,ref:L,role:"option","aria-selected":f})},highlighted:o,index:A,selected:f,rootRef:L}}function Lte(e){const t=$.useContext(Jh);if(!t)throw new Error("Option: ListContext was not found.");const{getItemState:n,dispatch:r}=t,{highlighted:i,selected:a,focusable:c}=n(e),o=$.useCallback(g=>{if(g!==e)throw new Error(["Base UI Option: Tried to access the state of another Option.","This is unsupported when the Option uses the OptionContextStabilizer as a performance optimization."].join("/n"));return{highlighted:i,selected:a,focusable:c}},[i,a,c,e]);return{contextValue:$.useMemo(()=>({dispatch:r,getItemState:o}),[r,o])}}var Vs="top",Ka="bottom",Ja="right",js="left",R3="auto",N_=[Vs,Ka,Ja,js],xg="start",o_="end",kte="clippingParents",S8="viewport",_0="popper",Dte="reference",$O=N_.reduce(function(e,t){return e.concat([t+"-"+xg,t+"-"+o_])},[]),M8=[].concat(N_,[R3]).reduce(function(e,t){return e.concat([t,t+"-"+xg,t+"-"+o_])},[]),zte="beforeRead",Ote="read",Fte="afterRead",Nte="beforeMain",Bte="main",Ute="afterMain",$te="beforeWrite",Vte="write",jte="afterWrite",Hte=[zte,Ote,Fte,Nte,Bte,Ute,$te,Vte,jte];function bc(e){return e?(e.nodeName||"").toLowerCase():null}function Ta(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function zf(e){var t=Ta(e).Element;return e instanceof t||e instanceof Element}function Xa(e){var t=Ta(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function L3(e){if(typeof ShadowRoot>"u")return!1;var t=Ta(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function Gte(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var r=t.styles[n]||{},i=t.attributes[n]||{},a=t.elements[n];!Xa(a)||!bc(a)||(Object.assign(a.style,r),Object.keys(i).forEach(function(c){var o=i[c];o===!1?a.removeAttribute(c):a.setAttribute(c,o===!0?"":o)}))})}function Wte(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(r){var i=t.elements[r],a=t.attributes[r]||{},c=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:n[r]),o=c.reduce(function(f,g){return f[g]="",f},{});!Xa(i)||!bc(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(f){i.removeAttribute(f)}))})}}const qte={name:"applyStyles",enabled:!0,phase:"write",fn:Gte,effect:Wte,requires:["computeStyles"]};function vc(e){return e.split("-")[0]}var Cf=Math.max,eS=Math.min,bg=Math.round;function _A(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function C8(){return!/^((?!chrome|android).)*safari/i.test(_A())}function wg(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var r=e.getBoundingClientRect(),i=1,a=1;t&&Xa(e)&&(i=e.offsetWidth>0&&bg(r.width)/e.offsetWidth||1,a=e.offsetHeight>0&&bg(r.height)/e.offsetHeight||1);var c=zf(e)?Ta(e):window,o=c.visualViewport,f=!C8()&&n,g=(r.left+(f&&o?o.offsetLeft:0))/i,_=(r.top+(f&&o?o.offsetTop:0))/a,x=r.width/i,M=r.height/a;return{width:x,height:M,top:_,right:g+x,bottom:_+M,left:g,x:g,y:_}}function k3(e){var t=wg(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function E8(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&L3(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function du(e){return Ta(e).getComputedStyle(e)}function Xte(e){return["table","td","th"].indexOf(bc(e))>=0}function nd(e){return((zf(e)?e.ownerDocument:e.document)||window.document).documentElement}function AM(e){return bc(e)==="html"?e:e.assignedSlot||e.parentNode||(L3(e)?e.host:null)||nd(e)}function VO(e){return!Xa(e)||du(e).position==="fixed"?null:e.offsetParent}function Zte(e){var t=/firefox/i.test(_A()),n=/Trident/i.test(_A());if(n&&Xa(e)){var r=du(e);if(r.position==="fixed")return null}var i=AM(e);for(L3(i)&&(i=i.host);Xa(i)&&["html","body"].indexOf(bc(i))<0;){var a=du(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||t&&a.willChange==="filter"||t&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function B_(e){for(var t=Ta(e),n=VO(e);n&&Xte(n)&&du(n).position==="static";)n=VO(n);return n&&(bc(n)==="html"||bc(n)==="body"&&du(n).position==="static")?t:n||Zte(e)||t}function D3(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function fy(e,t,n){return Cf(e,eS(t,n))}function Yte(e,t,n){var r=fy(e,t,n);return r>n?n:r}function T8(){return{top:0,right:0,bottom:0,left:0}}function P8(e){return Object.assign({},T8(),e)}function A8(e,t){return t.reduce(function(n,r){return n[r]=e,n},{})}var Kte=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,P8(typeof t!="number"?t:A8(t,N_))};function Jte(e){var t,n=e.state,r=e.name,i=e.options,a=n.elements.arrow,c=n.modifiersData.popperOffsets,o=vc(n.placement),f=D3(o),g=[js,Ja].indexOf(o)>=0,_=g?"height":"width";if(!(!a||!c)){var x=Kte(i.padding,n),M=k3(a),C=f==="y"?Vs:js,A=f==="y"?Ka:Ja,L=n.rects.reference[_]+n.rects.reference[f]-c[f]-n.rects.popper[_],I=c[f]-n.rects.reference[f],T=B_(a),z=T?f==="y"?T.clientHeight||0:T.clientWidth||0:0,k=L/2-I/2,U=x[C],H=z-M[_]-x[A],V=z/2-M[_]/2+k,q=fy(U,V,H),J=f;n.modifiersData[r]=(t={},t[J]=q,t.centerOffset=q-V,t)}}function Qte(e){var t=e.state,n=e.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=t.elements.popper.querySelector(i),!i)||E8(t.elements.popper,i)&&(t.elements.arrow=i))}const ene={name:"arrow",enabled:!0,phase:"main",fn:Jte,effect:Qte,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Sg(e){return e.split("-")[1]}var tne={top:"auto",right:"auto",bottom:"auto",left:"auto"};function nne(e,t){var n=e.x,r=e.y,i=t.devicePixelRatio||1;return{x:bg(n*i)/i||0,y:bg(r*i)/i||0}}function jO(e){var t,n=e.popper,r=e.popperRect,i=e.placement,a=e.variation,c=e.offsets,o=e.position,f=e.gpuAcceleration,g=e.adaptive,_=e.roundOffsets,x=e.isFixed,M=c.x,C=M===void 0?0:M,A=c.y,L=A===void 0?0:A,I=typeof _=="function"?_({x:C,y:L}):{x:C,y:L};C=I.x,L=I.y;var T=c.hasOwnProperty("x"),z=c.hasOwnProperty("y"),k=js,U=Vs,H=window;if(g){var V=B_(n),q="clientHeight",J="clientWidth";if(V===Ta(n)&&(V=nd(n),du(V).position!=="static"&&o==="absolute"&&(q="scrollHeight",J="scrollWidth")),V=V,i===Vs||(i===js||i===Ja)&&a===o_){U=Ka;var Y=x&&V===H&&H.visualViewport?H.visualViewport.height:V[q];L-=Y-r.height,L*=f?1:-1}if(i===js||(i===Vs||i===Ka)&&a===o_){k=Ja;var N=x&&V===H&&H.visualViewport?H.visualViewport.width:V[J];C-=N-r.width,C*=f?1:-1}}var ne=Object.assign({position:o},g&&tne),ye=_===!0?nne({x:C,y:L},Ta(n)):{x:C,y:L};if(C=ye.x,L=ye.y,f){var ge;return Object.assign({},ne,(ge={},ge[U]=z?"0":"",ge[k]=T?"0":"",ge.transform=(H.devicePixelRatio||1)<=1?"translate("+C+"px, "+L+"px)":"translate3d("+C+"px, "+L+"px, 0)",ge))}return Object.assign({},ne,(t={},t[U]=z?L+"px":"",t[k]=T?C+"px":"",t.transform="",t))}function rne(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=r===void 0?!0:r,a=n.adaptive,c=a===void 0?!0:a,o=n.roundOffsets,f=o===void 0?!0:o,g={placement:vc(t.placement),variation:Sg(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,jO(Object.assign({},g,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:c,roundOffsets:f})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,jO(Object.assign({},g,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const ine={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:rne,data:{}};var H1={passive:!0};function one(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,a=i===void 0?!0:i,c=r.resize,o=c===void 0?!0:c,f=Ta(t.elements.popper),g=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&g.forEach(function(_){_.addEventListener("scroll",n.update,H1)}),o&&f.addEventListener("resize",n.update,H1),function(){a&&g.forEach(function(_){_.removeEventListener("scroll",n.update,H1)}),o&&f.removeEventListener("resize",n.update,H1)}}const sne={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:one,data:{}};var ane={left:"right",right:"left",bottom:"top",top:"bottom"};function Qb(e){return e.replace(/left|right|bottom|top/g,function(t){return ane[t]})}var lne={start:"end",end:"start"};function HO(e){return e.replace(/start|end/g,function(t){return lne[t]})}function z3(e){var t=Ta(e),n=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:n,scrollTop:r}}function O3(e){return wg(nd(e)).left+z3(e).scrollLeft}function cne(e,t){var n=Ta(e),r=nd(e),i=n.visualViewport,a=r.clientWidth,c=r.clientHeight,o=0,f=0;if(i){a=i.width,c=i.height;var g=C8();(g||!g&&t==="fixed")&&(o=i.offsetLeft,f=i.offsetTop)}return{width:a,height:c,x:o+O3(e),y:f}}function une(e){var t,n=nd(e),r=z3(e),i=(t=e.ownerDocument)==null?void 0:t.body,a=Cf(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),c=Cf(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-r.scrollLeft+O3(e),f=-r.scrollTop;return du(i||n).direction==="rtl"&&(o+=Cf(n.clientWidth,i?i.clientWidth:0)-a),{width:a,height:c,x:o,y:f}}function F3(e){var t=du(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function I8(e){return["html","body","#document"].indexOf(bc(e))>=0?e.ownerDocument.body:Xa(e)&&F3(e)?e:I8(AM(e))}function py(e,t){var n;t===void 0&&(t=[]);var r=I8(e),i=r===((n=e.ownerDocument)==null?void 0:n.body),a=Ta(r),c=i?[a].concat(a.visualViewport||[],F3(r)?r:[]):r,o=t.concat(c);return i?o:o.concat(py(AM(c)))}function xA(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function hne(e,t){var n=wg(e,!1,t==="fixed");return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}function GO(e,t,n){return t===S8?xA(cne(e,n)):zf(t)?hne(t,n):xA(une(nd(e)))}function dne(e){var t=py(AM(e)),n=["absolute","fixed"].indexOf(du(e).position)>=0,r=n&&Xa(e)?B_(e):e;return zf(r)?t.filter(function(i){return zf(i)&&E8(i,r)&&bc(i)!=="body"}):[]}function fne(e,t,n,r){var i=t==="clippingParents"?dne(e):[].concat(t),a=[].concat(i,[n]),c=a[0],o=a.reduce(function(f,g){var _=GO(e,g,r);return f.top=Cf(_.top,f.top),f.right=eS(_.right,f.right),f.bottom=eS(_.bottom,f.bottom),f.left=Cf(_.left,f.left),f},GO(e,c,r));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function R8(e){var t=e.reference,n=e.element,r=e.placement,i=r?vc(r):null,a=r?Sg(r):null,c=t.x+t.width/2-n.width/2,o=t.y+t.height/2-n.height/2,f;switch(i){case Vs:f={x:c,y:t.y-n.height};break;case Ka:f={x:c,y:t.y+t.height};break;case Ja:f={x:t.x+t.width,y:o};break;case js:f={x:t.x-n.width,y:o};break;default:f={x:t.x,y:t.y}}var g=i?D3(i):null;if(g!=null){var _=g==="y"?"height":"width";switch(a){case xg:f[g]=f[g]-(t[_]/2-n[_]/2);break;case o_:f[g]=f[g]+(t[_]/2-n[_]/2);break}}return f}function s_(e,t){t===void 0&&(t={});var n=t,r=n.placement,i=r===void 0?e.placement:r,a=n.strategy,c=a===void 0?e.strategy:a,o=n.boundary,f=o===void 0?kte:o,g=n.rootBoundary,_=g===void 0?S8:g,x=n.elementContext,M=x===void 0?_0:x,C=n.altBoundary,A=C===void 0?!1:C,L=n.padding,I=L===void 0?0:L,T=P8(typeof I!="number"?I:A8(I,N_)),z=M===_0?Dte:_0,k=e.rects.popper,U=e.elements[A?z:M],H=fne(zf(U)?U:U.contextElement||nd(e.elements.popper),f,_,c),V=wg(e.elements.reference),q=R8({reference:V,element:k,strategy:"absolute",placement:i}),J=xA(Object.assign({},k,q)),Y=M===_0?J:V,N={top:H.top-Y.top+T.top,bottom:Y.bottom-H.bottom+T.bottom,left:H.left-Y.left+T.left,right:Y.right-H.right+T.right},ne=e.modifiersData.offset;if(M===_0&&ne){var ye=ne[i];Object.keys(N).forEach(function(ge){var Ne=[Ja,Ka].indexOf(ge)>=0?1:-1,Ae=[Vs,Ka].indexOf(ge)>=0?"y":"x";N[ge]+=ye[Ae]*Ne})}return N}function pne(e,t){t===void 0&&(t={});var n=t,r=n.placement,i=n.boundary,a=n.rootBoundary,c=n.padding,o=n.flipVariations,f=n.allowedAutoPlacements,g=f===void 0?M8:f,_=Sg(r),x=_?o?$O:$O.filter(function(A){return Sg(A)===_}):N_,M=x.filter(function(A){return g.indexOf(A)>=0});M.length===0&&(M=x);var C=M.reduce(function(A,L){return A[L]=s_(e,{placement:L,boundary:i,rootBoundary:a,padding:c})[vc(L)],A},{});return Object.keys(C).sort(function(A,L){return C[A]-C[L]})}function mne(e){if(vc(e)===R3)return[];var t=Qb(e);return[HO(e),t,HO(t)]}function gne(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,a=i===void 0?!0:i,c=n.altAxis,o=c===void 0?!0:c,f=n.fallbackPlacements,g=n.padding,_=n.boundary,x=n.rootBoundary,M=n.altBoundary,C=n.flipVariations,A=C===void 0?!0:C,L=n.allowedAutoPlacements,I=t.options.placement,T=vc(I),z=T===I,k=f||(z||!A?[Qb(I)]:mne(I)),U=[I].concat(k).reduce(function(je,lt){return je.concat(vc(lt)===R3?pne(t,{placement:lt,boundary:_,rootBoundary:x,padding:g,flipVariations:A,allowedAutoPlacements:L}):lt)},[]),H=t.rects.reference,V=t.rects.popper,q=new Map,J=!0,Y=U[0],N=0;N<U.length;N++){var ne=U[N],ye=vc(ne),ge=Sg(ne)===xg,Ne=[Vs,Ka].indexOf(ye)>=0,Ae=Ne?"width":"height",ve=s_(t,{placement:ne,boundary:_,rootBoundary:x,altBoundary:M,padding:g}),Se=Ne?ge?Ja:js:ge?Ka:Vs;H[Ae]>V[Ae]&&(Se=Qb(Se));var Me=Qb(Se),Ue=[];if(a&&Ue.push(ve[ye]<=0),o&&Ue.push(ve[Se]<=0,ve[Me]<=0),Ue.every(function(je){return je})){Y=ne,J=!1;break}q.set(ne,Ue)}if(J)for(var Qe=A?3:1,st=function(lt){var Ot=U.find(function(ut){var ot=q.get(ut);if(ot)return ot.slice(0,lt).every(function(Tt){return Tt})});if(Ot)return Y=Ot,"break"},ct=Qe;ct>0;ct--){var Xt=st(ct);if(Xt==="break")break}t.placement!==Y&&(t.modifiersData[r]._skip=!0,t.placement=Y,t.reset=!0)}}const vne={name:"flip",enabled:!0,phase:"main",fn:gne,requiresIfExists:["offset"],data:{_skip:!1}};function WO(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function qO(e){return[Vs,Ja,Ka,js].some(function(t){return e[t]>=0})}function yne(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,a=t.modifiersData.preventOverflow,c=s_(t,{elementContext:"reference"}),o=s_(t,{altBoundary:!0}),f=WO(c,r),g=WO(o,i,a),_=qO(f),x=qO(g);t.modifiersData[n]={referenceClippingOffsets:f,popperEscapeOffsets:g,isReferenceHidden:_,hasPopperEscaped:x},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":_,"data-popper-escaped":x})}const _ne={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:yne};function xne(e,t,n){var r=vc(e),i=[js,Vs].indexOf(r)>=0?-1:1,a=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,c=a[0],o=a[1];return c=c||0,o=(o||0)*i,[js,Ja].indexOf(r)>=0?{x:o,y:c}:{x:c,y:o}}function bne(e){var t=e.state,n=e.options,r=e.name,i=n.offset,a=i===void 0?[0,0]:i,c=M8.reduce(function(_,x){return _[x]=xne(x,t.rects,a),_},{}),o=c[t.placement],f=o.x,g=o.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=f,t.modifiersData.popperOffsets.y+=g),t.modifiersData[r]=c}const wne={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:bne};function Sne(e){var t=e.state,n=e.name;t.modifiersData[n]=R8({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const Mne={name:"popperOffsets",enabled:!0,phase:"read",fn:Sne,data:{}};function Cne(e){return e==="x"?"y":"x"}function Ene(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,a=i===void 0?!0:i,c=n.altAxis,o=c===void 0?!1:c,f=n.boundary,g=n.rootBoundary,_=n.altBoundary,x=n.padding,M=n.tether,C=M===void 0?!0:M,A=n.tetherOffset,L=A===void 0?0:A,I=s_(t,{boundary:f,rootBoundary:g,padding:x,altBoundary:_}),T=vc(t.placement),z=Sg(t.placement),k=!z,U=D3(T),H=Cne(U),V=t.modifiersData.popperOffsets,q=t.rects.reference,J=t.rects.popper,Y=typeof L=="function"?L(Object.assign({},t.rects,{placement:t.placement})):L,N=typeof Y=="number"?{mainAxis:Y,altAxis:Y}:Object.assign({mainAxis:0,altAxis:0},Y),ne=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,ye={x:0,y:0};if(V){if(a){var ge,Ne=U==="y"?Vs:js,Ae=U==="y"?Ka:Ja,ve=U==="y"?"height":"width",Se=V[U],Me=Se+I[Ne],Ue=Se-I[Ae],Qe=C?-J[ve]/2:0,st=z===xg?q[ve]:J[ve],ct=z===xg?-J[ve]:-q[ve],Xt=t.elements.arrow,je=C&&Xt?k3(Xt):{width:0,height:0},lt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:T8(),Ot=lt[Ne],ut=lt[Ae],ot=fy(0,q[ve],je[ve]),Tt=k?q[ve]/2-Qe-ot-Ot-N.mainAxis:st-ot-Ot-N.mainAxis,Ct=k?-q[ve]/2+Qe+ot+ut+N.mainAxis:ct+ot+ut+N.mainAxis,un=t.elements.arrow&&B_(t.elements.arrow),gn=un?U==="y"?un.clientTop||0:un.clientLeft||0:0,hn=(ge=ne==null?void 0:ne[U])!=null?ge:0,We=Se+Tt-hn-gn,vn=Se+Ct-hn,Ut=fy(C?eS(Me,We):Me,Se,C?Cf(Ue,vn):Ue);V[U]=Ut,ye[U]=Ut-Se}if(o){var tn,Dt=U==="x"?Vs:js,An=U==="x"?Ka:Ja,an=V[H],Le=H==="y"?"height":"width",me=an+I[Dt],it=an-I[An],St=[Vs,js].indexOf(T)!==-1,It=(tn=ne==null?void 0:ne[H])!=null?tn:0,wt=St?me:an-q[Le]-J[Le]-It+N.altAxis,Zt=St?an+q[Le]+J[Le]-It-N.altAxis:it,Lt=C&&St?Yte(wt,an,Zt):fy(C?wt:me,an,C?Zt:it);V[H]=Lt,ye[H]=Lt-an}t.modifiersData[r]=ye}}const Tne={name:"preventOverflow",enabled:!0,phase:"main",fn:Ene,requiresIfExists:["offset"]};function Pne(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Ane(e){return e===Ta(e)||!Xa(e)?z3(e):Pne(e)}function Ine(e){var t=e.getBoundingClientRect(),n=bg(t.width)/e.offsetWidth||1,r=bg(t.height)/e.offsetHeight||1;return n!==1||r!==1}function Rne(e,t,n){n===void 0&&(n=!1);var r=Xa(t),i=Xa(t)&&Ine(t),a=nd(t),c=wg(e,i,n),o={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(r||!r&&!n)&&((bc(t)!=="body"||F3(a))&&(o=Ane(t)),Xa(t)?(f=wg(t,!0),f.x+=t.clientLeft,f.y+=t.clientTop):a&&(f.x=O3(a))),{x:c.left+o.scrollLeft-f.x,y:c.top+o.scrollTop-f.y,width:c.width,height:c.height}}function Lne(e){var t=new Map,n=new Set,r=[];e.forEach(function(a){t.set(a.name,a)});function i(a){n.add(a.name);var c=[].concat(a.requires||[],a.requiresIfExists||[]);c.forEach(function(o){if(!n.has(o)){var f=t.get(o);f&&i(f)}}),r.push(a)}return e.forEach(function(a){n.has(a.name)||i(a)}),r}function kne(e){var t=Lne(e);return Hte.reduce(function(n,r){return n.concat(t.filter(function(i){return i.phase===r}))},[])}function Dne(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function zne(e){var t=e.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(t).map(function(n){return t[n]})}var XO={placement:"bottom",modifiers:[],strategy:"absolute"};function ZO(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function One(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,r=n===void 0?[]:n,i=t.defaultOptions,a=i===void 0?XO:i;return function(o,f,g){g===void 0&&(g=a);var _={placement:"bottom",orderedModifiers:[],options:Object.assign({},XO,a),modifiersData:{},elements:{reference:o,popper:f},attributes:{},styles:{}},x=[],M=!1,C={state:_,setOptions:function(T){var z=typeof T=="function"?T(_.options):T;L(),_.options=Object.assign({},a,_.options,z),_.scrollParents={reference:zf(o)?py(o):o.contextElement?py(o.contextElement):[],popper:py(f)};var k=kne(zne([].concat(r,_.options.modifiers)));return _.orderedModifiers=k.filter(function(U){return U.enabled}),A(),C.update()},forceUpdate:function(){if(!M){var T=_.elements,z=T.reference,k=T.popper;if(ZO(z,k)){_.rects={reference:Rne(z,B_(k),_.options.strategy==="fixed"),popper:k3(k)},_.reset=!1,_.placement=_.options.placement,_.orderedModifiers.forEach(function(N){return _.modifiersData[N.name]=Object.assign({},N.data)});for(var U=0;U<_.orderedModifiers.length;U++){if(_.reset===!0){_.reset=!1,U=-1;continue}var H=_.orderedModifiers[U],V=H.fn,q=H.options,J=q===void 0?{}:q,Y=H.name;typeof V=="function"&&(_=V({state:_,options:J,name:Y,instance:C})||_)}}}},update:Dne(function(){return new Promise(function(I){C.forceUpdate(),I(_)})}),destroy:function(){L(),M=!0}};if(!ZO(o,f))return C;C.setOptions(g).then(function(I){!M&&g.onFirstUpdate&&g.onFirstUpdate(I)});function A(){_.orderedModifiers.forEach(function(I){var T=I.name,z=I.options,k=z===void 0?{}:z,U=I.effect;if(typeof U=="function"){var H=U({state:_,name:T,instance:C,options:k}),V=function(){};x.push(H||V)}})}function L(){x.forEach(function(I){return I()}),x=[]}return C}}var Fne=[sne,Mne,ine,qte,wne,vne,Tne,ene,_ne],Nne=One({defaultModifiers:Fne});const L8="Popper";function Bne(e){return _U(L8,e)}TJ(L8,["root"]);const Une=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],$ne=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function Vne(e,t){if(t==="ltr")return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function bA(e){return typeof e=="function"?e():e}function jne(e){return e.nodeType!==void 0}const Hne=()=>yr({root:["root"]},SJ(Bne)),Gne={},Wne=$.forwardRef(function(t,n){var r;const{anchorEl:i,children:a,direction:c,disablePortal:o,modifiers:f,open:g,placement:_,popperOptions:x,popperRef:M,slotProps:C={},slots:A={},TransitionProps:L}=t,I=Un(t,Une),T=$.useRef(null),z=Ur(T,n),k=$.useRef(null),U=Ur(k,M),H=$.useRef(U);su(()=>{H.current=U},[U]),$.useImperativeHandle(M,()=>k.current,[]);const V=Vne(_,c),[q,J]=$.useState(V),[Y,N]=$.useState(bA(i));$.useEffect(()=>{k.current&&k.current.forceUpdate()}),$.useEffect(()=>{i&&N(bA(i))},[i]),su(()=>{if(!Y||!g)return;const Ae=Me=>{J(Me.placement)};let ve=[{name:"preventOverflow",options:{altBoundary:o}},{name:"flip",options:{altBoundary:o}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Me})=>{Ae(Me)}}];f!=null&&(ve=ve.concat(f)),x&&x.modifiers!=null&&(ve=ve.concat(x.modifiers));const Se=Nne(Y,T.current,ue({placement:V},x,{modifiers:ve}));return H.current(Se),()=>{Se.destroy(),H.current(null)}},[Y,o,f,g,x,V]);const ne={placement:q};L!==null&&(ne.TransitionProps=L);const ye=Hne(),ge=(r=A.root)!=null?r:"div",Ne=fU({elementType:ge,externalSlotProps:C.root,externalForwardedProps:I,additionalProps:{role:"tooltip",ref:z},ownerState:t,className:ye.root});return ee.jsx(ge,ue({},Ne,{children:typeof a=="function"?a(ne):a}))}),IM=$.forwardRef(function(t,n){const{anchorEl:r,children:i,container:a,direction:c="ltr",disablePortal:o=!1,keepMounted:f=!1,modifiers:g,open:_,placement:x="bottom",popperOptions:M=Gne,popperRef:C,style:A,transition:L=!1,slotProps:I={},slots:T={}}=t,z=Un(t,$ne),[k,U]=$.useState(!0),H=()=>{U(!1)},V=()=>{U(!0)};if(!f&&!_&&(!L||k))return null;let q;if(a)q=a;else if(r){const N=bA(r);q=N&&jne(N)?wa(N).body:wa(null).body}const J=!_&&f&&(!L||k)?"none":void 0,Y=L?{in:_,onEnter:H,onExited:V}:void 0;return ee.jsx(w8,{disablePortal:o,container:q,children:ee.jsx(Wne,ue({anchorEl:r,direction:c,disablePortal:o,modifiers:g,ref:n,open:L?!k:_,placement:x,popperOptions:M,popperRef:C,slotProps:I,slots:T},z,{style:ue({position:"fixed",top:0,left:0,display:J},A),TransitionProps:Y,children:i}))})}),tS={buttonClick:"buttonClick",browserAutoFill:"browserAutoFill"},qne=e=>{const{label:t,value:n}=e;return typeof t=="string"?t:typeof n=="string"?n:String(e)};function Xne(e,t){const{open:n}=e,{context:{selectionMode:r}}=t;if(t.type===tS.buttonClick){var i;const f=(i=e.selectedValues[0])!=null?i:Mo(null,"start",t.context);return ue({},e,{open:!n,highlightedValue:n?null:f})}if(t.type===tS.browserAutoFill)return NR(t.item,e,t.context);const a=hM(e,t);switch(t.type){case Xr.keyDown:if(e.open){if(t.event.key==="Escape")return ue({},a,{open:!1})}else{if(t.event.key==="ArrowDown"){var c;return ue({},e,{open:!0,highlightedValue:(c=e.selectedValues[0])!=null?c:Mo(null,"start",t.context)})}if(t.event.key==="ArrowUp"){var o;return ue({},e,{open:!0,highlightedValue:(o=e.selectedValues[0])!=null?o:Mo(null,"end",t.context)})}}break;case Xr.itemClick:if(r==="single")return ue({},a,{open:!1});break;case Xr.blur:return ue({},a,{open:!1});default:return a}return a}function Zne(e){return Array.isArray(e)?e.length===0?"":JSON.stringify(e.map(t=>t.value)):(e==null?void 0:e.value)==null?"":typeof e.value=="string"||typeof e.value=="number"?e.value:JSON.stringify(e.value)}function Yne(e){const{areOptionsEqual:t,buttonRef:n,defaultOpen:r=!1,defaultValue:i,disabled:a=!1,listboxId:c,listboxRef:o,multiple:f=!1,name:g,required:_,onChange:x,onHighlightChange:M,onOpenChange:C,open:A,options:L,getOptionAsString:I=qne,getSerializedValue:T=Zne,value:z,componentName:k="useSelect"}=e,U=$.useRef(null),H=Ur(n,U),V=$.useRef(null),q=qs(c);let J;z===void 0&&i===void 0?J=[]:i!==void 0&&(f?J=i:J=i==null?[]:[i]);const Y=$.useMemo(()=>{if(z!==void 0)return f?z:z==null?[]:[z]},[z,f]),{subitems:N,contextValue:ne}=dM(),ye=$.useMemo(()=>L!=null?new Map(L.map((_e,te)=>[_e.value,{value:_e.value,label:_e.label,disabled:_e.disabled,ref:$.createRef(),id:`${q}_${te}`}])):N,[L,N,q]),ge=Ur(o,V),{getRootProps:Ne,active:Ae,focusVisible:ve,rootRef:Se}=Mc({disabled:a,rootRef:H}),Me=$.useMemo(()=>Array.from(ye.keys()),[ye]),Ue=$.useCallback(_e=>{if(t!==void 0){const te=Me.find(re=>t(re,_e));return ye.get(te)}return ye.get(_e)},[ye,t,Me]),Qe=$.useCallback(_e=>{var te;const re=Ue(_e);return(te=re==null?void 0:re.disabled)!=null?te:!1},[Ue]),st=$.useCallback(_e=>{const te=Ue(_e);return te?I(te):""},[Ue,I]),ct=$.useMemo(()=>({selectedValues:Y,open:A}),[Y,A]),Xt=$.useCallback(_e=>{var te;return(te=ye.get(_e))==null?void 0:te.id},[ye]),je=$.useCallback((_e,te)=>{if(f)x==null||x(_e,te);else{var re;x==null||x(_e,(re=te[0])!=null?re:null)}},[f,x]),lt=$.useCallback((_e,te)=>{M==null||M(_e,te??null)},[M]),Ot=$.useCallback((_e,te,re)=>{if(te==="open"&&(C==null||C(re),re===!1&&(_e==null?void 0:_e.type)!=="blur")){var Z;(Z=U.current)==null||Z.focus()}},[C]),ut=$.useCallback(_e=>{var te,re;return _e==null?null:(te=(re=N.get(_e))==null?void 0:re.ref.current)!=null?te:null},[N]),ot={getInitialState:()=>{var _e;return{highlightedValue:null,selectedValues:(_e=J)!=null?_e:[],open:r}},getItemId:Xt,controlledProps:ct,focusManagement:"DOM",getItemDomElement:ut,itemComparer:t,isItemDisabled:Qe,rootRef:ge,onChange:je,onHighlightChange:lt,onStateChange:Ot,reducerActionContext:$.useMemo(()=>({multiple:f}),[f]),items:Me,getItemAsString:st,selectionMode:f?"multiple":"single",stateReducer:Xne,componentName:k},{dispatch:Tt,getRootProps:Ct,contextValue:un,state:{open:gn,highlightedValue:hn,selectedValues:We},rootRef:vn}=BR(ot),Ut=$.useRef(gn);su(()=>{if(gn&&hn!==null){var _e;const te=(_e=Ue(hn))==null?void 0:_e.ref;if(!V.current||!(te!=null&&te.current))return;Ut.current||te.current.focus({preventScroll:!0});const re=V.current.getBoundingClientRect(),Z=te.current.getBoundingClientRect();Z.top<re.top?V.current.scrollTop-=re.top-Z.top:Z.bottom>re.bottom&&(V.current.scrollTop+=Z.bottom-re.bottom)}},[gn,hn,Ue]);const tn=$.useCallback(_e=>Ue(_e),[Ue]),Dt=_e=>te=>{var re;if(_e==null||(re=_e.onClick)==null||re.call(_e,te),!te.defaultMuiPrevented){const Z={type:tS.buttonClick,event:te};Tt(Z)}},An=_e=>te=>{var re;(re=_e.onKeyDown)==null||re.call(_e,te),!te.defaultMuiPrevented&&(te.key==="ArrowDown"||te.key==="ArrowUp")&&(te.preventDefault(),Tt({type:Xr.keyDown,key:te.key,event:te}))},an=(_e={})=>({onClick:Dt(_e),onKeyDown:An(_e)}),Le=(_e={})=>ue({},_e,an(_e),{role:"combobox","aria-expanded":gn,"aria-controls":q}),me=(_e={})=>{const te=ho(_e),re=au(Le,Ne);return ue({},_e,re(te))},it=_e=>te=>{var re,Z;(re=_e.onBlur)==null||re.call(_e,te),!te.defaultMuiPrevented&&((Z=V.current)!=null&&Z.contains(te.relatedTarget)||te.relatedTarget===U.current)&&(te.defaultMuiPrevented=!0)},St=(_e={})=>({onBlur:it(_e)}),It=(_e={})=>{const te=ho(_e),re=au(St,Ct);return ue({id:q,role:"listbox","aria-multiselectable":f?"true":void 0},_e,re(te))};$.useDebugValue({selectedOptions:We,highlightedOption:hn,open:gn});const wt=$.useMemo(()=>ue({},un,ne),[un,ne]);let Zt;e.multiple?Zt=We:Zt=We.length>0?We[0]:null;let Lt;if(f)Lt=Zt.map(_e=>tn(_e)).filter(_e=>_e!==void 0);else{var kt;Lt=(kt=tn(Zt))!=null?kt:null}const bn=_e=>te=>{var re;if(_e==null||(re=_e.onChange)==null||re.call(_e,te),te.defaultMuiPrevented)return;const Z=ye.get(te.target.value);te.target.value===""?Tt({type:Xr.clearSelection}):Z!==void 0&&Tt({type:tS.browserAutoFill,item:Z.value,event:te})};return{buttonActive:Ae,buttonFocusVisible:ve,buttonRef:Se,contextValue:wt,disabled:a,dispatch:Tt,getButtonProps:me,getHiddenInputProps:(_e={})=>{const te=ho(_e);return ue({name:g,tabIndex:-1,"aria-hidden":!0,required:_?!0:void 0,value:T(Lt),style:DK},_e,{onChange:bn(te)})},getListboxProps:It,getOptionMetadata:tn,listboxRef:vn,open:gn,options:Me,value:Zt,highlightedOption:hn}}function Kne(e){const{value:t,children:n}=e,{dispatch:r,getItemIndex:i,getItemState:a,registerItem:c,totalSubitemCount:o}=t,f=$.useMemo(()=>({dispatch:r,getItemState:a,getItemIndex:i}),[r,i,a]),g=$.useMemo(()=>({getItemIndex:i,registerItem:c,totalSubitemCount:o}),[c,i,o]);return ee.jsx(L_.Provider,{value:g,children:ee.jsx(Jh.Provider,{value:f,children:n})})}function Jne(e={}){const{autoHideDuration:t=null,disableWindowBlurListener:n=!1,onClose:r,open:i,resumeHideDuration:a}=e,c=U0();$.useEffect(()=>{if(!i)return;function T(z){z.defaultPrevented||(z.key==="Escape"||z.key==="Esc")&&(r==null||r(z,"escapeKeyDown"))}return document.addEventListener("keydown",T),()=>{document.removeEventListener("keydown",T)}},[i,r]);const o=Tl((T,z)=>{r==null||r(T,z)}),f=Tl(T=>{!r||T==null||c.start(T,()=>{o(null,"timeout")})});$.useEffect(()=>(i&&f(t),c.clear),[i,t,f,c]);const g=T=>{r==null||r(T,"clickaway")},_=c.clear,x=$.useCallback(()=>{t!=null&&f(a??t*.5)},[t,a,f]),M=T=>z=>{const k=T.onBlur;k==null||k(z),x()},C=T=>z=>{const k=T.onFocus;k==null||k(z),_()},A=T=>z=>{const k=T.onMouseEnter;k==null||k(z),_()},L=T=>z=>{const k=T.onMouseLeave;k==null||k(z),x()};return $.useEffect(()=>{if(!n&&i)return window.addEventListener("focus",x),window.addEventListener("blur",_),()=>{window.removeEventListener("focus",x),window.removeEventListener("blur",_)}},[n,i,x,_]),{getRootProps:(T={})=>{const z=ue({},ho(e),ho(T));return ue({role:"presentation"},T,z,{onBlur:M(z),onFocus:C(z),onMouseEnter:A(z),onMouseLeave:L(z)})},onClickAway:g}}function Qne(e){const{checked:t,defaultChecked:n,disabled:r,onBlur:i,onChange:a,onFocus:c,onFocusVisible:o,readOnly:f,required:g}=e,[_,x]=Xm({controlled:t,default:!!n,name:"Switch",state:"checked"}),M=J=>Y=>{var N;Y.nativeEvent.defaultPrevented||(x(Y.target.checked),a==null||a(Y),(N=J.onChange)==null||N.call(J,Y))},{isFocusVisibleRef:C,onBlur:A,onFocus:L,ref:I}=LR(),[T,z]=$.useState(!1);r&&T&&z(!1),$.useEffect(()=>{C.current=T},[T,C]);const k=$.useRef(null),U=J=>Y=>{var N;k.current||(k.current=Y.currentTarget),L(Y),C.current===!0&&(z(!0),o==null||o(Y)),c==null||c(Y),(N=J.onFocus)==null||N.call(J,Y)},H=J=>Y=>{var N;A(Y),C.current===!1&&z(!1),i==null||i(Y),(N=J.onBlur)==null||N.call(J,Y)},V=Ur(I,k);return{checked:_,disabled:!!r,focusVisible:T,getInputProps:(J={})=>ue({checked:t,defaultChecked:n,disabled:r,readOnly:f,ref:V,required:g,type:"checkbox",role:"switch","aria-checked":t},J,{onChange:M(J),onFocus:U(J),onBlur:H(J)}),inputRef:V,readOnly:!!f}}function ere(e){const{value:t,defaultValue:n,onChange:r,orientation:i="horizontal",direction:a="ltr",selectionFollowsFocus:c=!1}=e,[o,f]=Xm({controlled:t,default:n,name:"Tabs",state:"value"}),g=$.useCallback((I,T)=>{f(T),r==null||r(I,T)},[r,f]),{subitems:_,contextValue:x}=dM(),M=$.useRef(()=>{}),C=$.useCallback(I=>{var T;return(T=_.get(I))==null?void 0:T.id},[_]),A=$.useCallback(I=>M.current(I),[]),L=$.useCallback(I=>{M.current=I},[]);return{contextValue:ue({direction:a,getTabId:A,getTabPanelId:C,onSelected:g,orientation:i,registerTabIdLookup:L,selectionFollowsFocus:c,value:o},x)}}const k8=$.createContext(null);function RM(){const e=$.useContext(k8);if(e==null)throw new Error("No TabsContext provided");return e}function tre(e){const{value:t,children:n}=e,{direction:r,getItemIndex:i,onSelected:a,orientation:c,registerItem:o,registerTabIdLookup:f,selectionFollowsFocus:g,totalSubitemCount:_,value:x,getTabId:M,getTabPanelId:C}=t,A=$.useMemo(()=>({getItemIndex:i,registerItem:o,totalSubitemCount:_}),[o,i,_]),L=$.useMemo(()=>({direction:r,getTabId:M,getTabPanelId:C,onSelected:a,orientation:c,registerTabIdLookup:f,selectionFollowsFocus:g,value:x}),[r,M,C,a,c,f,g,x]);return ee.jsx(L_.Provider,{value:A,children:ee.jsx(k8.Provider,{value:L,children:n})})}function nre(e){return e.size}function rre(e){const{value:t,id:n,rootRef:r}=e,i=RM();if(i===null)throw new Error("No TabContext provided");const{value:a,getTabId:c}=i,o=qs(n),f=$.useRef(null),g=Ur(f,r),_=$.useMemo(()=>({id:o,ref:f}),[o]),{id:x}=fM(t??nre,_),M=x!==a,C=x!==void 0?c(x):void 0;return{hidden:M,getRootProps:(L={})=>ue({"aria-labelledby":C??void 0,hidden:M,id:o??void 0},L,{ref:g}),rootRef:g}}const D8={valueChange:"valueChange"};function ire(e,t){if(t.type===D8.valueChange)return ue({},e,{highlightedValue:t.value});const n=hM(e,t),{context:{selectionFollowsFocus:r}}=t;if(t.type===Xr.itemsChange){if(n.selectedValues.length>0)return ue({},n,{highlightedValue:n.selectedValues[0]});Mo(null,"reset",t.context)}return r&&n.highlightedValue!=null?ue({},n,{selectedValues:[n.highlightedValue]}):n}function ore(e){var t;const{rootRef:n}=e,{direction:r="ltr",onSelected:i,orientation:a="horizontal",value:c,registerTabIdLookup:o,selectionFollowsFocus:f}=RM(),{subitems:g,contextValue:_}=dM(),x=$.useCallback(ne=>{var ye;return(ye=g.get(ne))==null?void 0:ye.id},[g]);o(x);const M=$.useMemo(()=>Array.from(g.keys()),[g]),C=$.useCallback(ne=>{var ye,ge;return ne==null?null:(ye=(ge=g.get(ne))==null?void 0:ge.ref.current)!=null?ye:null},[g]),A=r==="rtl";let L;a==="vertical"?L="vertical":L=A?"horizontal-rtl":"horizontal-ltr";const I=$.useCallback((ne,ye)=>{var ge;i(ne,(ge=ye[0])!=null?ge:null)},[i]),T=$.useMemo(()=>c===void 0?{}:c!=null?{selectedValues:[c]}:{selectedValues:[]},[c]),z=$.useCallback(ne=>{var ye,ge;return(ye=(ge=g.get(ne))==null?void 0:ge.disabled)!=null?ye:!1},[g]),{contextValue:k,dispatch:U,getRootProps:H,state:{highlightedValue:V,selectedValues:q},rootRef:J}=BR({controlledProps:T,disabledItemsFocusable:!f,focusManagement:"DOM",getItemDomElement:C,isItemDisabled:z,items:M,rootRef:n,onChange:I,orientation:L,reducerActionContext:$.useMemo(()=>({selectionFollowsFocus:f||!1}),[f]),selectionMode:"single",stateReducer:ire});$.useEffect(()=>{c!==void 0&&c!=null&&U({type:D8.valueChange,value:c})},[U,c]);const Y=(ne={})=>ue({},ne,H(ne),{"aria-orientation":a==="vertical"?"vertical":void 0,role:"tablist"});return{contextValue:$.useMemo(()=>ue({},_,k),[_,k]),dispatch:U,getRootProps:Y,highlightedValue:V,isRtl:A,orientation:a,rootRef:J,selectedValue:(t=q[0])!=null?t:null}}function sre(e){const{value:t,children:n}=e,{dispatch:r,getItemIndex:i,getItemState:a,registerItem:c,totalSubitemCount:o}=t,f=$.useMemo(()=>({dispatch:r,getItemState:a,getItemIndex:i}),[r,i,a]),g=$.useMemo(()=>({getItemIndex:i,registerItem:c,totalSubitemCount:o}),[c,i,o]);return ee.jsx(L_.Provider,{value:g,children:ee.jsx(Jh.Provider,{value:f,children:n})})}function are(e){return e.size}function lre(e){const{value:t,rootRef:n,disabled:r=!1,id:i}=e,a=$.useRef(null),c=qs(i),{value:o,selectionFollowsFocus:f,getTabPanelId:g}=RM(),_=$.useMemo(()=>({disabled:r,ref:a,id:c}),[r,a,c]),{id:x,index:M,totalItemCount:C}=fM(t??are,_),{getRootProps:A,highlighted:L,selected:I}=UR({item:x}),{getRootProps:T,rootRef:z,active:k,focusVisible:U,setFocusVisible:H}=Mc({disabled:r,focusableWhenDisabled:!f,type:"button"}),V=Ur(a,n,z),q=x!==void 0?g(x):void 0;return{getRootProps:(Y={})=>{const N=ho(Y),ne=au(A,T);return ue({},Y,ne(N),{role:"tab","aria-controls":q,"aria-selected":I,id:c,ref:V})},active:k,focusVisible:U,highlighted:L,index:M,rootRef:V,selected:I||x===o,setFocusVisible:H,totalTabsCount:C}}function YO(e){return typeof e.normalize<"u"?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e}function z8(e={}){const{ignoreAccents:t=!0,ignoreCase:n=!0,limit:r,matchFrom:i="any",stringify:a,trim:c=!1}=e;return(o,{inputValue:f,getOptionLabel:g})=>{let _=c?f.trim():f;n&&(_=_.toLowerCase()),t&&(_=YO(_));const x=_?o.filter(M=>{let C=(a||g)(M);return n&&(C=C.toLowerCase()),t&&(C=YO(C)),i==="start"?C.indexOf(_)===0:C.indexOf(_)>-1}):o;return typeof r=="number"?x.slice(0,r):x}}function G1(e,t){for(let n=0;n<e.length;n+=1)if(t(e[n]))return n;return-1}const cre=z8(),KO=5,ure=e=>{var t;return e.current!==null&&((t=e.current.parentElement)==null?void 0:t.contains(document.activeElement))},hre=[];function dre(e){const{unstable_isActiveElementInListbox:t=ure,unstable_classNamePrefix:n="Mui",autoComplete:r=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:c=!1,clearOnBlur:o=!e.freeSolo,clearOnEscape:f=!1,componentName:g="useAutocomplete",defaultValue:_=e.multiple?hre:null,disableClearable:x=!1,disableCloseOnSelect:M=!1,disabled:C,disabledItemsFocusable:A=!1,disableListWrap:L=!1,filterOptions:I=cre,filterSelectedOptions:T=!1,freeSolo:z=!1,getOptionDisabled:k,getOptionKey:U,getOptionLabel:H=xt=>{var Ze;return(Ze=xt.label)!=null?Ze:xt},groupBy:V,handleHomeEndKeys:q=!e.freeSolo,id:J,includeInputInList:Y=!1,inputValue:N,isOptionEqualToValue:ne=(xt,Ze)=>xt===Ze,multiple:ye=!1,onChange:ge,onClose:Ne,onHighlightChange:Ae,onInputChange:ve,onOpen:Se,open:Me,openOnFocus:Ue=!1,options:Qe,readOnly:st=!1,selectOnFocus:ct=!e.freeSolo,value:Xt}=e,je=qs(J);let lt=H;lt=xt=>{const Ze=H(xt);return typeof Ze!="string"?String(Ze):Ze};const Ot=$.useRef(!1),ut=$.useRef(!0),ot=$.useRef(null),Tt=$.useRef(null),[Ct,un]=$.useState(null),[gn,hn]=$.useState(-1),We=i?0:-1,vn=$.useRef(We),[Ut,tn]=Xm({controlled:Xt,default:_,name:g}),[Dt,An]=Xm({controlled:N,default:"",name:g,state:"inputValue"}),[an,Le]=$.useState(!1),me=$.useCallback((xt,Ze)=>{if(!(ye?Ut.length<Ze.length:Ze!==null)&&!o)return;let Wt;if(ye)Wt="";else if(Ze==null)Wt="";else{const pn=lt(Ze);Wt=typeof pn=="string"?pn:""}Dt!==Wt&&(An(Wt),ve&&ve(xt,Wt,"reset"))},[lt,Dt,ye,ve,An,o,Ut]),[it,St]=Xm({controlled:Me,default:!1,name:g,state:"open"}),[It,wt]=$.useState(!0),Zt=!ye&&Ut!=null&&Dt===lt(Ut),Lt=it&&!st,kt=Lt?I(Qe.filter(xt=>!(T&&(ye?Ut:[Ut]).some(Ze=>Ze!==null&&ne(xt,Ze)))),{inputValue:Zt&&It?"":Dt,getOptionLabel:lt}):[],bn=kK({filteredOptions:kt,value:Ut,inputValue:Dt});$.useEffect(()=>{const xt=Ut!==bn.value;an&&!xt||z&&!xt||me(null,Ut)},[Ut,me,an,bn.value,z]);const zt=it&&kt.length>0&&!st,_e=Tl(xt=>{xt===-1?ot.current.focus():Ct.querySelector(`[data-tag-index="${xt}"]`).focus()});$.useEffect(()=>{ye&&gn>Ut.length-1&&(hn(-1),_e(-1))},[Ut,ye,gn,_e]);function te(xt,Ze){if(!Tt.current||xt<0||xt>=kt.length)return-1;let Rt=xt;for(;;){const Wt=Tt.current.querySelector(`[data-option-index="${Rt}"]`),pn=A?!1:!Wt||Wt.disabled||Wt.getAttribute("aria-disabled")==="true";if(Wt&&Wt.hasAttribute("tabindex")&&!pn)return Rt;if(Ze==="next"?Rt=(Rt+1)%kt.length:Rt=(Rt-1+kt.length)%kt.length,Rt===xt)return-1}}const re=Tl(({event:xt,index:Ze,reason:Rt="auto"})=>{if(vn.current=Ze,Ze===-1?ot.current.removeAttribute("aria-activedescendant"):ot.current.setAttribute("aria-activedescendant",`${je}-option-${Ze}`),Ae&&Ae(xt,Ze===-1?null:kt[Ze],Rt),!Tt.current)return;const Wt=Tt.current.querySelector(`[role="option"].${n}-focused`);Wt&&(Wt.classList.remove(`${n}-focused`),Wt.classList.remove(`${n}-focusVisible`));let pn=Tt.current;if(Tt.current.getAttribute("role")!=="listbox"&&(pn=Tt.current.parentElement.querySelector('[role="listbox"]')),!pn)return;if(Ze===-1){pn.scrollTop=0;return}const ur=Tt.current.querySelector(`[data-option-index="${Ze}"]`);if(ur&&(ur.classList.add(`${n}-focused`),Rt==="keyboard"&&ur.classList.add(`${n}-focusVisible`),pn.scrollHeight>pn.clientHeight&&Rt!=="mouse"&&Rt!=="touch")){const Xn=ur,pe=pn.clientHeight+pn.scrollTop,nt=Xn.offsetTop+Xn.offsetHeight;nt>pe?pn.scrollTop=nt-pn.clientHeight:Xn.offsetTop-Xn.offsetHeight*(V?1.3:0)<pn.scrollTop&&(pn.scrollTop=Xn.offsetTop-Xn.offsetHeight*(V?1.3:0))}}),Z=Tl(({event:xt,diff:Ze,direction:Rt="next",reason:Wt="auto"})=>{if(!Lt)return;const ur=te((()=>{const Xn=kt.length-1;if(Ze==="reset")return We;if(Ze==="start")return 0;if(Ze==="end")return Xn;const pe=vn.current+Ze;return pe<0?pe===-1&&Y?-1:L&&vn.current!==-1||Math.abs(Ze)>1?0:Xn:pe>Xn?pe===Xn+1&&Y?-1:L||Math.abs(Ze)>1?Xn:0:pe})(),Rt);if(re({index:ur,reason:Wt,event:xt}),r&&Ze!=="reset")if(ur===-1)ot.current.value=Dt;else{const Xn=lt(kt[ur]);ot.current.value=Xn,Xn.toLowerCase().indexOf(Dt.toLowerCase())===0&&Dt.length>0&&ot.current.setSelectionRange(Dt.length,Xn.length)}}),le=()=>{const xt=(Ze,Rt)=>{const Wt=Ze?lt(Ze):"",pn=Rt?lt(Rt):"";return Wt===pn};if(vn.current!==-1&&bn.filteredOptions&&bn.filteredOptions.length!==kt.length&&bn.inputValue===Dt&&(ye?Ut.length===bn.value.length&&bn.value.every((Ze,Rt)=>lt(Ut[Rt])===lt(Ze)):xt(bn.value,Ut))){const Ze=bn.filteredOptions[vn.current];if(Ze)return G1(kt,Rt=>lt(Rt)===lt(Ze))}return-1},Te=$.useCallback(()=>{if(!Lt)return;const xt=le();if(xt!==-1){vn.current=xt;return}const Ze=ye?Ut[0]:Ut;if(kt.length===0||Ze==null){Z({diff:"reset"});return}if(Tt.current){if(Ze!=null){const Rt=kt[vn.current];if(ye&&Rt&&G1(Ut,pn=>ne(Rt,pn))!==-1)return;const Wt=G1(kt,pn=>ne(pn,Ze));Wt===-1?Z({diff:"reset"}):re({index:Wt});return}if(vn.current>=kt.length-1){re({index:kt.length-1});return}re({index:vn.current})}},[kt.length,ye?!1:Ut,T,Z,re,Lt,Dt,ye]),Ve=Tl(xt=>{Aw(Tt,xt),xt&&Te()});$.useEffect(()=>{Te()},[Te]);const fe=xt=>{it||(St(!0),wt(!0),Se&&Se(xt))},xe=(xt,Ze)=>{it&&(St(!1),Ne&&Ne(xt,Ze))},Re=(xt,Ze,Rt,Wt)=>{if(ye){if(Ut.length===Ze.length&&Ut.every((pn,ur)=>pn===Ze[ur]))return}else if(Ut===Ze)return;ge&&ge(xt,Ze,Rt,Wt),tn(Ze)},De=$.useRef(!1),ze=(xt,Ze,Rt="selectOption",Wt="options")=>{let pn=Rt,ur=Ze;if(ye){ur=Array.isArray(Ut)?Ut.slice():[];const Xn=G1(ur,pe=>ne(Ze,pe));Xn===-1?ur.push(Ze):Wt!=="freeSolo"&&(ur.splice(Xn,1),pn="removeOption")}me(xt,ur),Re(xt,ur,pn,{option:Ze}),!M&&(!xt||!xt.ctrlKey&&!xt.metaKey)&&xe(xt,pn),(c===!0||c==="touch"&&De.current||c==="mouse"&&!De.current)&&ot.current.blur()};function Je(xt,Ze){if(xt===-1)return-1;let Rt=xt;for(;;){if(Ze==="next"&&Rt===Ut.length||Ze==="previous"&&Rt===-1)return-1;const Wt=Ct.querySelector(`[data-tag-index="${Rt}"]`);if(!Wt||!Wt.hasAttribute("tabindex")||Wt.disabled||Wt.getAttribute("aria-disabled")==="true")Rt+=Ze==="next"?1:-1;else return Rt}}const Oe=(xt,Ze)=>{if(!ye)return;Dt===""&&xe(xt,"toggleInput");let Rt=gn;gn===-1?Dt===""&&Ze==="previous"&&(Rt=Ut.length-1):(Rt+=Ze==="next"?1:-1,Rt<0&&(Rt=0),Rt===Ut.length&&(Rt=-1)),Rt=Je(Rt,Ze),hn(Rt),_e(Rt)},Et=xt=>{Ot.current=!0,An(""),ve&&ve(xt,"","clear"),Re(xt,ye?[]:null,"clear")},Ft=xt=>Ze=>{if(xt.onKeyDown&&xt.onKeyDown(Ze),!Ze.defaultMuiPrevented&&(gn!==-1&&["ArrowLeft","ArrowRight"].indexOf(Ze.key)===-1&&(hn(-1),_e(-1)),Ze.which!==229))switch(Ze.key){case"Home":Lt&&q&&(Ze.preventDefault(),Z({diff:"start",direction:"next",reason:"keyboard",event:Ze}));break;case"End":Lt&&q&&(Ze.preventDefault(),Z({diff:"end",direction:"previous",reason:"keyboard",event:Ze}));break;case"PageUp":Ze.preventDefault(),Z({diff:-KO,direction:"previous",reason:"keyboard",event:Ze}),fe(Ze);break;case"PageDown":Ze.preventDefault(),Z({diff:KO,direction:"next",reason:"keyboard",event:Ze}),fe(Ze);break;case"ArrowDown":Ze.preventDefault(),Z({diff:1,direction:"next",reason:"keyboard",event:Ze}),fe(Ze);break;case"ArrowUp":Ze.preventDefault(),Z({diff:-1,direction:"previous",reason:"keyboard",event:Ze}),fe(Ze);break;case"ArrowLeft":Oe(Ze,"previous");break;case"ArrowRight":Oe(Ze,"next");break;case"Enter":if(vn.current!==-1&&Lt){const Rt=kt[vn.current],Wt=k?k(Rt):!1;if(Ze.preventDefault(),Wt)return;ze(Ze,Rt,"selectOption"),r&&ot.current.setSelectionRange(ot.current.value.length,ot.current.value.length)}else z&&Dt!==""&&Zt===!1&&(ye&&Ze.preventDefault(),ze(Ze,Dt,"createOption","freeSolo"));break;case"Escape":Lt?(Ze.preventDefault(),Ze.stopPropagation(),xe(Ze,"escape")):f&&(Dt!==""||ye&&Ut.length>0)&&(Ze.preventDefault(),Ze.stopPropagation(),Et(Ze));break;case"Backspace":if(ye&&!st&&Dt===""&&Ut.length>0){const Rt=gn===-1?Ut.length-1:gn,Wt=Ut.slice();Wt.splice(Rt,1),Re(Ze,Wt,"removeOption",{option:Ut[Rt]})}break;case"Delete":if(ye&&!st&&Dt===""&&Ut.length>0&&gn!==-1){const Rt=gn,Wt=Ut.slice();Wt.splice(Rt,1),Re(Ze,Wt,"removeOption",{option:Ut[Rt]})}break}},be=xt=>{Le(!0),Ue&&!Ot.current&&fe(xt)},qe=xt=>{if(t(Tt)){ot.current.focus();return}Le(!1),ut.current=!0,Ot.current=!1,a&&vn.current!==-1&&Lt?ze(xt,kt[vn.current],"blur"):a&&z&&Dt!==""?ze(xt,Dt,"blur","freeSolo"):o&&me(xt,Ut),xe(xt,"blur")},tt=xt=>{const Ze=xt.target.value;Dt!==Ze&&(An(Ze),wt(!1),ve&&ve(xt,Ze,"input")),Ze===""?!x&&!ye&&Re(xt,null,"clear"):fe(xt)},At=xt=>{const Ze=Number(xt.currentTarget.getAttribute("data-option-index"));vn.current!==Ze&&re({event:xt,index:Ze,reason:"mouse"})},Ht=xt=>{re({event:xt,index:Number(xt.currentTarget.getAttribute("data-option-index")),reason:"touch"}),De.current=!0},Yt=xt=>{const Ze=Number(xt.currentTarget.getAttribute("data-option-index"));ze(xt,kt[Ze],"selectOption"),De.current=!1},qt=xt=>Ze=>{const Rt=Ut.slice();Rt.splice(xt,1),Re(Ze,Rt,"removeOption",{option:Ut[xt]})},Gt=xt=>{it?xe(xt,"toggleInput"):fe(xt)},yn=xt=>{xt.currentTarget.contains(xt.target)&&xt.target.getAttribute("id")!==je&&xt.preventDefault()},gt=xt=>{xt.currentTarget.contains(xt.target)&&(ot.current.focus(),ct&&ut.current&&ot.current.selectionEnd-ot.current.selectionStart===0&&ot.current.select(),ut.current=!1)},In=xt=>{!C&&(Dt===""||!it)&&Gt(xt)};let cn=z&&Dt.length>0;cn=cn||(ye?Ut.length>0:Ut!==null);let Nn=kt;return V&&(Nn=kt.reduce((xt,Ze,Rt)=>{const Wt=V(Ze);return xt.length>0&&xt[xt.length-1].group===Wt?xt[xt.length-1].options.push(Ze):xt.push({key:Rt,index:Rt,group:Wt,options:[Ze]}),xt},[])),C&&an&&qe(),{getRootProps:(xt={})=>ue({"aria-owns":zt?`${je}-listbox`:null},xt,{onKeyDown:Ft(xt),onMouseDown:yn,onClick:gt}),getInputLabelProps:()=>({id:`${je}-label`,htmlFor:je}),getInputProps:()=>({id:je,value:Dt,onBlur:qe,onFocus:be,onChange:tt,onMouseDown:In,"aria-activedescendant":Lt?"":null,"aria-autocomplete":r?"both":"list","aria-controls":zt?`${je}-listbox`:void 0,"aria-expanded":zt,autoComplete:"off",ref:ot,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:C}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:Et}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:Gt}),getTagProps:({index:xt})=>ue({key:xt,"data-tag-index":xt,tabIndex:-1},!st&&{onDelete:qt(xt)}),getListboxProps:()=>({role:"listbox",id:`${je}-listbox`,"aria-labelledby":`${je}-label`,ref:Ve,onMouseDown:xt=>{xt.preventDefault()}}),getOptionProps:({index:xt,option:Ze})=>{var Rt;const Wt=(ye?Ut:[Ut]).some(ur=>ur!=null&&ne(Ze,ur)),pn=k?k(Ze):!1;return{key:(Rt=U==null?void 0:U(Ze))!=null?Rt:lt(Ze),tabIndex:-1,role:"option",id:`${je}-option-${xt}`,onMouseMove:At,onClick:Yt,onTouchStart:Ht,"data-option-index":xt,"aria-disabled":pn,"aria-selected":Wt}},id:je,inputValue:Dt,value:Ut,dirty:cn,expanded:Lt&&Ct,popupOpen:Lt,focused:an||gn!==-1,anchorEl:Ct,setAnchorEl:un,focusedTag:gn,groupedOptions:Nn}}const fre=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],pre=["component","slots","slotProps"],mre=["component"];function wn(e,t){const{className:n,elementType:r,ownerState:i,externalForwardedProps:a,getSlotOwnerState:c,internalForwardedProps:o}=t,f=Un(t,fre),{component:g,slots:_={[e]:void 0},slotProps:x={[e]:void 0}}=a,M=Un(a,pre),C=_[e]||r,A=dU(x[e],i),L=hU(ue({className:n},f,{externalForwardedProps:e==="root"?M:void 0,externalSlotProps:A})),{props:{component:I},internalRef:T}=L,z=Un(L.props,mre),k=Ur(T,A==null?void 0:A.ref,t.ref),U=c?c(z):{},H=ue({},i,U),V=e==="root"?I||g:I,q=uU(C,ue({},e==="root"&&!g&&!_[e]&&o,e!=="root"&&!_[e]&&o,z,V&&{as:V},{ref:k}),H);return Object.keys(U).forEach(J=>{delete q[J]}),[C,q]}function gre(e){return br("MuiListItem",e)}const nS=gr("MuiListItem",["root","startAction","endAction","nested","nesting","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]),rS=$.createContext(!1),jg=$.createContext(!1),O8=$.createContext(!1),N3=$.createContext(void 0),F8=$.createContext(void 0),LM=$.createContext(void 0),vre=["component","className","children","nested","sticky","variant","color","startAction","endAction","role","slots","slotProps"],yre=e=>{const{sticky:t,nested:n,nesting:r,variant:i,color:a}=e,c={root:["root",n&&"nested",r&&"nesting",t&&"sticky",a&&`color${mn(a)}`,i&&`variant${mn(i)}`],startAction:["startAction"],endAction:["endAction"]};return yr(c,gre,{})},_re=nn("li")(({theme:e,ownerState:t})=>{var n;return[!t.nested&&{"--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItemButton-marginBlock":"calc(-1 * var(--ListItem-paddingY))",alignItems:"center",gap:"var(--ListItem-gap)",marginInline:"var(--ListItem-marginInline)"},t.nested&&{"--NestedList-marginRight":"calc(-1 * var(--ListItem-paddingRight))","--NestedList-marginLeft":"calc(-1 * var(--ListItem-paddingLeft))","--NestedListItem-paddingLeft":"calc(var(--ListItem-paddingLeft) + var(--List-nestedInsetStart))","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItem-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))",flexDirection:"column"},ue({"--unstable_actionRadius":"calc(var(--ListItem-radius) - var(--variant-borderWidth, 0px))"},t.startAction&&{"--unstable_startActionWidth":"2rem"},t.endAction&&{"--unstable_endActionWidth":"2.5rem"},{boxSizing:"border-box",borderRadius:"var(--ListItem-radius)",display:"var(--_ListItem-display)","&:not([hidden])":{"--_ListItem-display":"var(--_List-markerDisplay, flex)"},flex:"none",listStyleType:"var(--_List-markerType, disc)",position:"relative",paddingBlockStart:t.nested?0:"var(--ListItem-paddingY)",paddingBlockEnd:t.nested?0:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)"},t["data-first-child"]===void 0&&ue({},t.row?{marginInlineStart:"var(--List-gap)"}:{marginBlockStart:"var(--List-gap)"}),t.row&&t.wrap&&{marginInlineStart:"var(--List-gap)",marginBlockStart:"var(--List-gap)"},{minBlockSize:"var(--ListItem-minHeight)"},t.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:`var(--ListItem-stickyBackground, ${e.vars.palette.background.body})`},{[`.${nS.nested} > &`]:{"--_ListItem-display":"flex"}}),(n=e.variants[t.variant])==null?void 0:n[t.color]]}),xre=nn(_re,{name:"JoyListItem",slot:"Root",overridesResolver:(e,t)=>t.root})({}),bre=nn("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(e,t)=>t.startAction})(({ownerState:e})=>({display:"inherit",position:"absolute",top:e.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",left:0,transform:"translate(var(--ListItem-startActionTranslateX), -50%)",zIndex:1})),wre=nn("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(e,t)=>t.startAction})(({ownerState:e})=>({display:"inherit",position:"absolute",top:e.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",right:0,transform:"translate(var(--ListItem-endActionTranslateX), -50%)"})),rd=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyListItem"}),i=$.useContext(LM),a=$.useContext(N3),c=$.useContext(jg),o=$.useContext(O8),f=$.useContext(rS),{component:g,className:_,children:x,nested:M=!1,sticky:C=!1,variant:A="plain",color:L="neutral",startAction:I,endAction:T,role:z,slots:k={},slotProps:U={}}=r,H=Un(r,vre),[V,q]=$.useState(""),[J,Y]=(a==null?void 0:a.split(":"))||["",""],N=g||(J&&!J.match(/^(ul|ol|menu)$/)?"div":void 0);let ne=i==="menu"?"none":void 0;a&&(ne={menu:"none",menubar:"none",group:"presentation"}[Y]),z&&(ne=z);const ye=ue({},r,{sticky:C,startAction:I,endAction:T,row:c,wrap:o,variant:A,color:L,nesting:f,nested:M,component:N,role:ne}),ge=yre(ye),Ne=ue({},H,{component:N,slots:k,slotProps:U}),[Ae,ve]=wn("root",{additionalProps:{role:ne},ref:n,className:xi(ge.root,_),elementType:xre,externalForwardedProps:Ne,ownerState:ye}),[Se,Me]=wn("startAction",{className:ge.startAction,elementType:bre,externalForwardedProps:Ne,ownerState:ye}),[Ue,Qe]=wn("endAction",{className:ge.endAction,elementType:wre,externalForwardedProps:Ne,ownerState:ye});return ee.jsx(F8.Provider,{value:q,children:ee.jsx(rS.Provider,{value:M?V||!0:!1,children:ee.jsxs(Ae,ue({},ve,{children:[I&&ee.jsx(Se,ue({},Me,{children:I})),$.Children.map(x,(st,ct)=>{var Xt;return $.isValidElement(st)?$.cloneElement(st,ue({},ct===0&&{"data-first-child":""},IR(st,["ListItem"])&&{component:((Xt=st.props)==null?void 0:Xt.component)||"div"})):st}),T&&ee.jsx(Ue,ue({},Qe,{children:T}))]}))})})});rd.muiName="ListItem";const kM={"--NestedList-marginRight":"0px","--NestedList-marginLeft":"0px","--NestedListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px"};function U_(e){const{children:t,nested:n,row:r=!1,wrap:i=!1}=e,a=ee.jsx(jg.Provider,{value:r,children:ee.jsx(O8.Provider,{value:i,children:$.Children.map(t,(c,o)=>$.isValidElement(c)?$.cloneElement(c,ue({},o===0&&{"data-first-child":""},o===$.Children.count(t)-1&&{"data-last-child":""})):c)})});return n===void 0?a:ee.jsx(rS.Provider,{value:n,children:a})}const Wf=({theme:e,ownerState:t},n)=>{let r={};function i(a){if(typeof a=="function"){const c=a(e);i(c)}else Array.isArray(a)?a.forEach(c=>{typeof c!="boolean"&&i(c)}):typeof a=="object"&&(r=ue({},r,a))}return t.sx&&(i(t.sx),n.forEach(a=>{const c=r[a];if(typeof c=="string"||typeof c=="number")if(a==="borderRadius")if(typeof c=="number")r[a]=`${c}px`;else{var o;r[a]=((o=e.vars)==null?void 0:o.radius[c])||c}else["p","padding","m","margin"].indexOf(a)!==-1&&typeof c=="number"?r[a]=e.spacing(c):r[a]=c;else typeof c=="function"?r[a]=c(e):r[a]=void 0})),r};function Sre(e){return br("MuiList",e)}const Mre=gr("MuiList",["root","nesting","scoped","sizeSm","sizeMd","sizeLg","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","horizontal","vertical"]),Cre=$.createContext(void 0),Ere=["component","className","children","size","orientation","wrap","variant","color","role","slots","slotProps"],Tre=e=>{const{variant:t,color:n,size:r,nesting:i,orientation:a,instanceSize:c}=e,o={root:["root",a,t&&`variant${mn(t)}`,n&&`color${mn(n)}`,!c&&!i&&r&&`size${mn(r)}`,c&&`size${mn(c)}`,i&&"nesting"]};return yr(o,Sre,{})},$_=nn("ul")(({theme:e,ownerState:t})=>{var n;const{p:r,padding:i,borderRadius:a}=Wf({theme:e,ownerState:t},["p","padding","borderRadius"]);function c(o){return o==="sm"?{"--ListDivider-gap":"0.25rem","--ListItem-minHeight":"2rem","--ListItem-paddingY":"3px","--ListItem-paddingX":t.marker?"3px":"0.5rem","--ListItem-gap":"0.5rem","--ListItemDecorator-size":t.orientation==="horizontal"?"1.5rem":"2rem","--Icon-fontSize":e.vars.fontSize.lg}:o==="md"?{"--ListDivider-gap":"0.375rem","--ListItem-minHeight":"2.25rem","--ListItem-paddingY":"0.25rem","--ListItem-paddingX":t.marker?"0.25rem":"0.75rem","--ListItem-gap":"0.625rem","--ListItemDecorator-size":t.orientation==="horizontal"?"1.75rem":"2.5rem","--Icon-fontSize":e.vars.fontSize.xl}:o==="lg"?{"--ListDivider-gap":"0.5rem","--ListItem-minHeight":"2.75rem","--ListItem-paddingY":"0.375rem","--ListItem-paddingX":t.marker?"0.5rem":"1rem","--ListItem-gap":"0.75rem","--ListItemDecorator-size":t.orientation==="horizontal"?"2.25rem":"3rem","--Icon-fontSize":e.vars.fontSize.xl2}:{}}return[t.nesting&&ue({},c(t.instanceSize),{"--ListItem-paddingRight":"var(--ListItem-paddingX)","--ListItem-paddingLeft":"var(--NestedListItem-paddingLeft)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px",padding:0},t.marker&&{paddingInlineStart:"calc(3ch - var(--_List-markerDeduct, 0px))"},{marginInlineStart:"var(--NestedList-marginLeft)",marginInlineEnd:"var(--NestedList-marginRight)",marginBlockStart:"var(--List-gap)",marginBlockEnd:"initial"}),!t.nesting&&ue({},c(t.size),{"--List-gap":"0px","--List-nestedInsetStart":"0px","--ListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItem-paddingRight":"var(--ListItem-paddingX)"},t.marker&&{"--_List-markerDeduct":"1ch"},{"--unstable_List-childRadius":"calc(max(var(--List-radius) - var(--List-padding), min(var(--List-padding) / 2, var(--List-radius) / 2)) - var(--variant-borderWidth, 0px))","--ListItem-radius":"var(--unstable_List-childRadius)","--ListItem-startActionTranslateX":"calc(0.5 * var(--ListItem-paddingLeft))","--ListItem-endActionTranslateX":"calc(-0.5 * var(--ListItem-paddingRight))",margin:"initial"},e.typography[`body-${t.size}`],t.orientation==="horizontal"?ue({},t.wrap?{padding:"var(--List-padding)",marginInlineStart:"calc(-1 * var(--List-gap))",marginBlockStart:"calc(-1 * var(--List-gap))"}:{paddingInline:"var(--List-padding, var(--ListDivider-gap))",paddingBlock:"var(--List-padding)"}):{paddingBlock:"var(--List-padding, var(--ListDivider-gap))",paddingInline:"var(--List-padding)"},t.marker&&{paddingInlineStart:"3ch"}),ue({boxSizing:"border-box",borderRadius:"var(--List-radius)",listStyle:"none",display:"flex",flexDirection:t.orientation==="horizontal"?"row":"column"},t.wrap&&{flexWrap:"wrap"},t.marker&&{"--_List-markerDisplay":"list-item","--_List-markerType":t.marker,lineHeight:"calc(var(--ListItem-minHeight) - 2 * var(--ListItem-paddingY))"},{flexGrow:1,position:"relative"},(n=e.variants[t.variant])==null?void 0:n[t.color],{"--unstable_List-borderWidth":"var(--variant-borderWidth, 0px)"},a!==void 0&&{"--List-radius":a},r!==void 0&&{"--List-padding":r},i!==void 0&&{"--List-padding":i})]}),Pre=nn($_,{name:"JoyList",slot:"Root",overridesResolver:(e,t)=>t.root})({}),DM=$.forwardRef(function(t,n){var r;const i=$.useContext(rS),a=$.useContext(LM),c=$.useContext(Cre),o=wr({props:t,name:"JoyList"}),{component:f,className:g,children:_,size:x,orientation:M="vertical",wrap:C=!1,variant:A="plain",color:L="neutral",role:I,slots:T={},slotProps:z={}}=o,k=Un(o,Ere),U=x||((r=t.size)!=null?r:"md");let H;a&&(H="group"),c&&(H="presentation"),I&&(H=I);const V=ue({},o,{instanceSize:t.size,size:U,nesting:i,orientation:M,wrap:C,variant:A,color:L,role:H}),q=Tre(V),J=ue({},k,{component:f,slots:T,slotProps:z}),[Y,N]=wn("root",{ref:n,className:xi(q.root,g),elementType:Pre,externalForwardedProps:J,ownerState:V,additionalProps:{as:f,role:H,"aria-labelledby":typeof i=="string"?i:void 0}});return ee.jsx(Y,ue({},N,{children:ee.jsx(N3.Provider,{value:`${typeof f=="string"?f:""}:${H||""}`,children:ee.jsx(U_,{row:M==="horizontal",wrap:C,children:_})})}))}),ew=gr("MuiListItemButton",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","variantPlain","variantSoft","variantOutlined","variantSolid"]),B3=$.createContext("horizontal"),V_=nn("div")(({theme:e,ownerState:t})=>{var n,r,i,a,c,o;return ue({"--Icon-margin":"initial","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,WebkitTapHighlightColor:"transparent",boxSizing:"border-box",position:"relative",font:"inherit",display:"flex",flexDirection:"row",alignItems:"center",alignSelf:"stretch",gap:"var(--ListItem-gap)"},t.orientation==="vertical"&&{flexDirection:"column",justifyContent:"center"},{textAlign:"initial",textDecoration:"initial",backgroundColor:"initial",cursor:"pointer",marginInline:"var(--ListItemButton-marginInline)",marginBlock:"var(--ListItemButton-marginBlock)"},t["data-first-child"]===void 0&&{marginInlineStart:t.row?"var(--List-gap)":void 0,marginBlockStart:t.row?void 0:"var(--List-gap)"},{paddingBlock:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px))",paddingInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItem-startActionWidth, var(--unstable_startActionWidth, 0px)))",paddingInlineEnd:"calc(var(--ListItem-paddingRight) + var(--ListItem-endActionWidth, var(--unstable_endActionWidth, 0px)))",minBlockSize:"var(--ListItem-minHeight)",border:"1px solid transparent",borderRadius:"var(--ListItem-radius)",flex:"var(--unstable_ListItem-flex, none)",fontSize:"inherit",lineHeight:"inherit",minInlineSize:0,[e.focus.selector]:ue({},e.focus.default,{zIndex:1})},(n=e.variants[t.variant])==null?void 0:n[t.color],{"&:active":(r=e.variants[`${t.variant}Active`])==null?void 0:r[t.color],[`.${nS.root} > &`]:{"--unstable_ListItem-flex":"1 0 0%"},[`&.${ew.selected}`]:ue({},(i=e.variants[`${t.variant}Active`])==null?void 0:i[t.color],{"--Icon-color":"currentColor"}),[`&:not(.${ew.selected}, [aria-selected="true"])`]:{"&:hover":(a=e.variants[`${t.variant}Hover`])==null?void 0:a[t.color],"&:active":(c=e.variants[`${t.variant}Active`])==null?void 0:c[t.color]},[`&.${ew.disabled}`]:ue({},(o=e.variants[`${t.variant}Disabled`])==null?void 0:o[t.color])})});nn(V_,{name:"JoyListItemButton",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>ue({},!e.row&&{[`&.${ew.selected}`]:{fontWeight:t.vars.fontWeight.md}}));function Are(e){return br("MuiSvgIcon",e)}gr("MuiSvgIcon",["root","colorInherit","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","fontSizeInherit","fontSizeXs","fontSizeSm","fontSizeMd","fontSizeLg","fontSizeXl","fontSizeXl2","fontSizeXl3","fontSizeXl4","sizeSm","sizeMd","sizeLg"]);const Ire=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox","size","slots","slotProps"],Rre=e=>{const{color:t,size:n,fontSize:r}=e,i={root:["root",t&&t!=="inherit"&&`color${mn(t)}`,n&&`size${mn(n)}`,r&&`fontSize${mn(r)}`]};return yr(i,Are,{})},JO={sm:"xl",md:"xl2",lg:"xl3"},Lre=nn("svg",{name:"JoySvgIcon",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n;return ue({},t.instanceSize&&{"--Icon-fontSize":e.vars.fontSize[JO[t.instanceSize]]},t.instanceFontSize&&t.instanceFontSize!=="inherit"&&{"--Icon-fontSize":e.vars.fontSize[t.instanceFontSize]},{userSelect:"none",margin:"var(--Icon-margin)",width:"1em",height:"1em",display:"inline-block",fill:t.hasSvgAsChild?void 0:"currentColor",flexShrink:0,fontSize:`var(--Icon-fontSize, ${e.vars.fontSize[JO[t.size]]||"unset"})`},t.fontSize&&t.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${e.fontSize[t.fontSize]})`},!t.htmlColor&&ue({color:`var(--Icon-color, ${e.vars.palette.text.icon})`},t.color==="inherit"&&{color:"inherit"},t.color!=="inherit"&&e.vars.palette[t.color]&&{color:`rgba(${(n=e.vars.palette[t.color])==null?void 0:n.mainChannel} / 1)`}))}),QO=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoySvgIcon"}),{children:i,className:a,color:c,component:o="svg",fontSize:f,htmlColor:g,inheritViewBox:_=!1,titleAccess:x,viewBox:M="0 0 24 24",size:C="md",slots:A={},slotProps:L={}}=r,I=Un(r,Ire),T=$.isValidElement(i)&&i.type==="svg",z=ue({},r,{color:c,component:o,size:C,instanceSize:t.size,fontSize:f,instanceFontSize:t.fontSize,inheritViewBox:_,viewBox:M,hasSvgAsChild:T}),k=Rre(z),U=ue({},I,{component:o,slots:A,slotProps:L}),[H,V]=wn("root",{ref:n,className:xi(k.root,a),elementType:Lre,externalForwardedProps:U,ownerState:z,additionalProps:ue({color:g,focusable:!1},x&&{role:"img"},!x&&{"aria-hidden":!0},!_&&{viewBox:M},T&&i.props)});return ee.jsxs(H,ue({},V,{children:[T?i.props.children:i,x?ee.jsx("title",{children:x}):null]}))});function Hg(e,t){function n(r,i){return ee.jsx(QO,ue({"data-testid":`${t}Icon`,ref:i},r,{children:e}))}return n.muiName=QO.muiName,$.memo($.forwardRef(n))}const U3=e=>t=>`--${e?`${e}-`:""}${t.replace(/^--/,"")}`,Mg="data-skip-inverted-colors",N8=`& :not([${Mg}], [${Mg}] *)`,B8=e=>{var t,n,r,i,a,c,o,f,g,_,x,M,C,A,L,I,T,z,k,U,H,V;const q=U3(e.cssVarPrefix);return{"--variant-plainColor":"var(--variant-plainColor) !important","--variant-plainHoverColor":"var(--variant-plainHoverColor) !important","--variant-plainHoverBg":"var(--variant-plainHoverBg) !important","--variant-plainActiveBg":"var(--variant-plainActiveBg) !important","--variant-plainDisabledColor":"var(--variant-plainDisabledColor) !important","--variant-outlinedColor":"var(--variant-outlinedColor) !important","--variant-outlinedBorder":"var(--variant-outlinedBorder) !important","--variant-outlinedHoverColor":"var(--variant-outlinedHoverColor) !important","--variant-outlinedHoverBorder":"var(--variant-outlinedHoverBorder) !important","--variant-outlinedHoverBg":"var(--variant-outlinedHoverBg) !important","--variant-outlinedActiveBg":"var(--variant-outlinedActiveBg) !important","--variant-outlinedDisabledColor":"var(--variant-outlinedDisabledColor) !important","--variant-outlinedDisabledBorder":"var(--variant-outlinedDisabledBorder) !important","--variant-softColor":"var(--variant-softColor) !important","--variant-softHoverColor":"var(--variant-softHoverColor) !important","--variant-softBg":"var(--variant-softBg) !important","--variant-softHoverBg":"var(--variant-softHoverBg) !important","--variant-softActiveBg":"var(--variant-softActiveBg) !important","--variant-softActiveColor":"var(--variant-softActiveColor) !important","--variant-softDisabledColor":"var(--variant-softDisabledColor) !important","--variant-softDisabledBg":"var(--variant-softDisabledBg) !important","--variant-solidColor":"var(--variant-solidColor) !important","--variant-solidBg":"var(--variant-solidBg) !important","--variant-solidHoverBg":"var(--variant-solidHoverBg) !important","--variant-solidActiveBg":"var(--variant-solidActiveBg) !important","--variant-solidDisabledColor":"var(--variant-solidDisabledColor) !important","--variant-solidDisabledBg":"var(--variant-solidDisabledBg) !important","--Badge-ringColor":"var(--Badge-ringColor) !important",colorScheme:"unset",[e.getColorSchemeSelector("light")]:{[q("--palette-focusVisible")]:`${(t=e.colorSchemes.light)==null?void 0:t.palette.focusVisible} !important`,[q("--palette-background-body")]:`${(n=e.colorSchemes.light)==null?void 0:n.palette.background.body} !important`,[q("--palette-background-surface")]:`${(r=e.colorSchemes.light)==null?void 0:r.palette.background.surface} !important`,[q("--palette-background-popup")]:`${(i=e.colorSchemes.light)==null?void 0:i.palette.background.popup} !important`,[q("--palette-background-level1")]:`${(a=e.colorSchemes.light)==null?void 0:a.palette.background.level1} !important`,[q("--palette-background-level2")]:`${(c=e.colorSchemes.light)==null?void 0:c.palette.background.level2} !important`,[q("--palette-background-level3")]:`${(o=e.colorSchemes.light)==null?void 0:o.palette.background.level3} !important`,[q("--palette-text-primary")]:`${(f=e.colorSchemes.light)==null?void 0:f.palette.text.primary} !important`,[q("--palette-text-secondary")]:`${(g=e.colorSchemes.light)==null?void 0:g.palette.text.secondary} !important`,[q("--palette-text-tertiary")]:`${(_=e.colorSchemes.light)==null?void 0:_.palette.text.tertiary} !important`,[q("--palette-divider")]:`${(x=e.colorSchemes.light)==null?void 0:x.palette.divider} !important`},[e.getColorSchemeSelector("dark")]:{[q("--palette-focusVisible")]:`${(M=e.colorSchemes.dark)==null?void 0:M.palette.focusVisible} !important`,[q("--palette-background-body")]:`${(C=e.colorSchemes.dark)==null?void 0:C.palette.background.body} !important`,[q("--palette-background-surface")]:`${(A=e.colorSchemes.dark)==null?void 0:A.palette.background.surface} !important`,[q("--palette-background-popup")]:`${(L=e.colorSchemes.dark)==null?void 0:L.palette.background.popup} !important`,[q("--palette-background-level1")]:`${(I=e.colorSchemes.dark)==null?void 0:I.palette.background.level1} !important`,[q("--palette-background-level2")]:`${(T=e.colorSchemes.dark)==null?void 0:T.palette.background.level2} !important`,[q("--palette-background-level3")]:`${(z=e.colorSchemes.dark)==null?void 0:z.palette.background.level3} !important`,[q("--palette-text-primary")]:`${(k=e.colorSchemes.dark)==null?void 0:k.palette.text.primary} !important`,[q("--palette-text-secondary")]:`${(U=e.colorSchemes.dark)==null?void 0:U.palette.text.secondary} !important`,[q("--palette-text-tertiary")]:`${(H=e.colorSchemes.dark)==null?void 0:H.palette.text.tertiary} !important`,[q("--palette-divider")]:`${(V=e.colorSchemes.dark)==null?void 0:V.palette.divider} !important`}}};function kre(e){return e.theme!==void 0}const j_=e=>t=>{const n=kre(t)?t.theme:t,r=OR(n.cssVarPrefix),i=U3(n.cssVarPrefix),a=c=>{const o=c.split("-");return r(c,n.palette[o[1]][o[2]])};return{[N8]:{"--Badge-ringColor":a(`palette-${e}-solidBg`),"--Icon-color":"currentColor",[`${n.getColorSchemeSelector("light")}, ${n.getColorSchemeSelector("dark")}`]:{colorScheme:"dark",[i("--palette-focusVisible")]:a(`palette-${e}-200`),[i("--palette-background-body")]:"rgba(0 0 0 / 0.1)",[i("--palette-background-surface")]:"rgba(0 0 0 / 0.06)",[i("--palette-background-popup")]:a(`palette-${e}-700`),[i("--palette-background-level1")]:`rgba(${a(`palette-${e}-darkChannel`)} / 0.2)`,[i("--palette-background-level2")]:`rgba(${a(`palette-${e}-darkChannel`)} / 0.36)`,[i("--palette-background-level3")]:`rgba(${a(`palette-${e}-darkChannel`)} / 0.6)`,[i("--palette-text-primary")]:a("palette-common-white"),[i("--palette-text-secondary")]:a(`palette-${e}-200`),[i("--palette-text-tertiary")]:a(`palette-${e}-300`),[i("--palette-text-icon")]:a(`palette-${e}-200`),[i("--palette-divider")]:`rgba(${a(`palette-${e}-lightChannel`)} / 0.32)`,"--variant-plainColor":a(`palette-${e}-50`),"--variant-plainHoverColor":"#fff","--variant-plainHoverBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${a(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-outlinedColor":a(`palette-${e}-50`),"--variant-outlinedBorder":`rgba(${a(`palette-${e}-lightChannel`)} / 0.5)`,"--variant-outlinedHoverColor":"#fff","--variant-outlinedHoverBorder":a(`palette-${e}-300`),"--variant-outlinedHoverBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${a(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":"rgba(255 255 255 / 0.2)","--variant-softColor":a("palette-common-white"),"--variant-softHoverColor":a("palette-common-white"),"--variant-softBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.24)`,"--variant-softHoverBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.36)`,"--variant-softActiveBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.16)`,"--variant-softActiveColor":"#fff","--variant-softDisabledColor":`rgba(${a(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.1)`,"--variant-solidColor":a(`palette-${e}-${e==="neutral"?"600":"500"}`),"--variant-solidBg":a("palette-common-white"),"--variant-solidHoverBg":a("palette-common-white"),"--variant-solidActiveBg":a(`palette-${e}-100`),"--variant-solidDisabledColor":`rgba(${a(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.1)`}},[`&, & [${Mg}]`]:B8(n)}},H_=e=>t=>{const{theme:n=t}=t,r=OR(n.cssVarPrefix),i=U3(n.cssVarPrefix),a=c=>{const o=c.split("-");return r(c,n.palette[o[1]][o[2]])};return{[N8]:{"--Badge-ringColor":a(`palette-${e}-softBg`),"--Icon-color":"currentColor",[n.getColorSchemeSelector("dark")]:{[i("--palette-focusVisible")]:a(`palette-${e}-300`),[i("--palette-background-body")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.1)`,[i("--palette-background-surface")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.08)`,[i("--palette-background-level1")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.2)`,[i("--palette-background-level2")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.4)`,[i("--palette-background-level3")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.6)`,[i("--palette-text-primary")]:a(`palette-${e}-100`),[i("--palette-text-secondary")]:`rgba(${a(`palette-${e}-lightChannel`)} / 0.72)`,[i("--palette-text-tertiary")]:`rgba(${a(`palette-${e}-lightChannel`)} / 0.6)`,[i("--palette-text-icon")]:`rgba(${a(`palette-${e}-lightChannel`)} / 0.6)`,[i("--palette-divider")]:`rgba(${a(`palette-${e}-lightChannel`)} / 0.2)`,"--variant-plainColor":`rgba(${a(`palette-${e}-lightChannel`)} / 1)`,"--variant-plainHoverColor":a(`palette-${e}-50`),"--variant-plainHoverBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.16)`,"--variant-plainActiveBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-outlinedColor":`rgba(${a(`palette-${e}-lightChannel`)} / 1)`,"--variant-outlinedHoverColor":a(`palette-${e}-50`),"--variant-outlinedBg":"initial","--variant-outlinedBorder":`rgba(${a(`palette-${e}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverBorder":a(`palette-${e}-600`),"--variant-outlinedHoverBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.16)`,"--variant-outlinedActiveBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":`rgba(${a(`palette-${e}-mainChannel`)} / 0.2)`,"--variant-softColor":a(`palette-${e}-200`),"--variant-softBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.24)`,"--variant-softHoverColor":"#fff","--variant-softHoverBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-softActiveBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.48)`,"--variant-softDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-solidColor":"#fff","--variant-solidBg":a(`palette-${e}-500`),"--variant-solidHoverColor":"#fff","--variant-solidHoverBg":a(`palette-${e}-600`),"--variant-solidActiveBg":a(`palette-${e}-600`),"--variant-solidDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.12)`},[n.getColorSchemeSelector("light")]:{[i("--palette-focusVisible")]:a(`palette-${e}-500`),[i("--palette-background-body")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.1)`,[i("--palette-background-surface")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.08)`,[i("--palette-background-level1")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.2)`,[i("--palette-background-level2")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.32)`,[i("--palette-background-level3")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.48)`,[i("--palette-text-primary")]:a(`palette-${e}-700`),[i("--palette-text-secondary")]:`rgba(${a(`palette-${e}-darkChannel`)} / 0.8)`,[i("--palette-text-tertiary")]:`rgba(${a(`palette-${e}-darkChannel`)} / 0.68)`,[i("--palette-text-icon")]:a(`palette-${e}-500`),[i("--palette-divider")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-plainColor":`rgba(${a(`palette-${e}-darkChannel`)} / 0.8)`,"--variant-plainHoverColor":`rgba(${a(`palette-${e}-darkChannel`)} / 1)`,"--variant-plainHoverBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.24)`,"--variant-plainDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-outlinedColor":`rgba(${a(`palette-${e}-mainChannel`)} / 1)`,"--variant-outlinedBorder":`rgba(${a(`palette-${e}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverColor":a(`palette-${e}-600`),"--variant-outlinedHoverBorder":a(`palette-${e}-300`),"--variant-outlinedHoverBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.24)`,"--variant-outlinedDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-outlinedDisabledBorder":`rgba(${a(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-softColor":a(`palette-${e}-600`),"--variant-softBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.8)`,"--variant-softHoverColor":a(`palette-${e}-700`),"--variant-softHoverBg":a(`palette-${e}-200`),"--variant-softActiveBg":a(`palette-${e}-300`),"--variant-softDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-softDisabledBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.08)`,"--variant-solidColor":a("palette-common-white"),"--variant-solidBg":a(`palette-${e}-${e==="neutral"?"700":"500"}`),"--variant-solidHoverColor":a("palette-common-white"),"--variant-solidHoverBg":a(`palette-${e}-600`),"--variant-solidActiveBg":a(`palette-${e}-600`),"--variant-solidDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-solidDisabledBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.08)`}},[`&, & [${Mg}]`]:B8(n)}},U8=Hg(ee.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Dre=Hg(ee.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),$8=$.createContext(void 0);function lf(e,t){let n=t,r=e;return e==="outlined"&&(n="neutral",r="plain"),e==="plain"&&(n="neutral"),{variant:r,color:n}}function zM(e,t,n=!1){const r=$.useContext($8),[i,a]=typeof r=="string"?r.split(":"):[],c=lf(i||void 0,a||void 0);return c.variant=e||c.variant,c.color=t||(n?a:c.color),c}function OM({children:e,color:t,variant:n}){return ee.jsx($8.Provider,{value:`${n||""}:${t||""}`,children:e})}function zre(e){return br("MuiIconButton",e)}gr("MuiIconButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","loading","loadingIndicator"]);const $3=$.createContext({}),V8=$.createContext(void 0);function Ore(e){return br("MuiCircularProgress",e)}gr("MuiCircularProgress",["root","determinate","svg","track","progress","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);let Fre=e=>e,e5;const Nre=["color","backgroundColor"],Bre=["children","className","color","size","variant","thickness","determinate","value","component","slots","slotProps"],Ure=xR({"0%":{transform:"rotate(-90deg)"},"100%":{transform:"rotate(270deg)"}}),$re=e=>{const{determinate:t,color:n,variant:r,size:i}=e,a={root:["root",t&&"determinate",n&&`color${mn(n)}`,r&&`variant${mn(r)}`,i&&`size${mn(i)}`],svg:["svg"],track:["track"],progress:["progress"]};return yr(a,Ore,{})};function Hp(e,t){return`var(--CircularProgress-${e}Thickness, var(--CircularProgress-thickness, ${t}))`}const Vre=nn("span",{name:"JoyCircularProgress",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var n,r,i,a;const c=((n=t.variants[e.variant])==null?void 0:n[e.color])||{},{color:o,backgroundColor:f}=c,g=Un(c,Nre);return ue({"--Icon-fontSize":"calc(0.4 * var(--_root-size))","--CircularProgress-trackColor":f,"--CircularProgress-progressColor":o,"--CircularProgress-percent":e.value,"--CircularProgress-linecap":"round"},e.size==="sm"&&{"--_root-size":"var(--CircularProgress-size, 24px)","--_track-thickness":Hp("track","3px"),"--_progress-thickness":Hp("progress","3px")},e.instanceSize==="sm"&&{"--CircularProgress-size":"24px"},e.size==="md"&&{"--_track-thickness":Hp("track","6px"),"--_progress-thickness":Hp("progress","6px"),"--_root-size":"var(--CircularProgress-size, 40px)"},e.instanceSize==="md"&&{"--CircularProgress-size":"40px"},e.size==="lg"&&{"--_track-thickness":Hp("track","8px"),"--_progress-thickness":Hp("progress","8px"),"--_root-size":"var(--CircularProgress-size, 64px)"},e.instanceSize==="lg"&&{"--CircularProgress-size":"64px"},e.thickness&&{"--_track-thickness":`${e.thickness}px`,"--_progress-thickness":`${e.thickness}px`},{"--_thickness-diff":"calc(var(--_track-thickness) - var(--_progress-thickness))","--_inner-size":"calc(var(--_root-size) - 2 * var(--variant-borderWidth, 0px))","--_outlined-inset":"max(var(--_track-thickness), var(--_progress-thickness))",width:"var(--_root-size)",height:"var(--_root-size)",borderRadius:"var(--_root-size)",margin:"var(--CircularProgress-margin)",boxSizing:"border-box",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0,position:"relative",color:o},e.children&&{fontFamily:t.vars.fontFamily.body,fontWeight:t.vars.fontWeight.md,fontSize:"calc(0.2 * var(--_root-size))"},g,e.variant==="outlined"&&{"&::before":ue({content:'""',display:"block",position:"absolute",borderRadius:"inherit",top:"var(--_outlined-inset)",left:"var(--_outlined-inset)",right:"var(--_outlined-inset)",bottom:"var(--_outlined-inset)"},g)},e.variant==="soft"&&{"--CircularProgress-trackColor":t.variants.soft.neutral.backgroundColor,"--CircularProgress-progressColor":(r=t.variants.solid)==null?void 0:r[e.color].backgroundColor},e.variant==="solid"&&{"--CircularProgress-trackColor":(i=t.variants.softHover)==null?void 0:i[e.color].backgroundColor,"--CircularProgress-progressColor":(a=t.variants.solid)==null?void 0:a[e.color].backgroundColor})}),jre=nn("svg",{name:"JoyCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({width:"inherit",height:"inherit",display:"inherit",boxSizing:"inherit",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))"}),Hre=nn("circle",{name:"JoyCircularProgress",slot:"track",overridesResolver:(e,t)=>t.track})({cx:"50%",cy:"50%",r:"calc(var(--_inner-size) / 2 - var(--_track-thickness) / 2 + min(0px, var(--_thickness-diff) / 2))",fill:"transparent",strokeWidth:"var(--_track-thickness)",stroke:"var(--CircularProgress-trackColor)"}),Gre=nn("circle",{name:"JoyCircularProgress",slot:"progress",overridesResolver:(e,t)=>t.progress})({"--_progress-radius":"calc(var(--_inner-size) / 2 - var(--_progress-thickness) / 2 - max(0px, var(--_thickness-diff) / 2))","--_progress-length":"calc(2 * 3.1415926535 * var(--_progress-radius))",cx:"50%",cy:"50%",r:"var(--_progress-radius)",fill:"transparent",strokeWidth:"var(--_progress-thickness)",stroke:"var(--CircularProgress-progressColor)",strokeLinecap:"var(--CircularProgress-linecap, round)",strokeDasharray:"var(--_progress-length)",strokeDashoffset:"calc(var(--_progress-length) - var(--CircularProgress-percent) * var(--_progress-length) / 100)",transformOrigin:"center",transform:"rotate(-90deg)"},({ownerState:e})=>!e.determinate&&W6(e5||(e5=Fre`
      animation: var(--CircularProgress-circulation, 0.8s linear 0s infinite normal none running)
        ${0};
    `),Ure)),V3=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyCircularProgress"}),{children:i,className:a,color:c="primary",size:o="md",variant:f="soft",thickness:g,determinate:_=!1,value:x=_?0:25,component:M,slots:C={},slotProps:A={}}=r,L=Un(r,Bre),I=ue({},r,{color:c,size:o,variant:f,thickness:g,value:x,determinate:_,instanceSize:t.size}),T=$re(I),z=ue({},L,{component:M,slots:C,slotProps:A}),[k,U]=wn("root",{ref:n,className:xi(T.root,a),elementType:Vre,externalForwardedProps:z,ownerState:I,additionalProps:ue({role:"progressbar",style:{"--CircularProgress-percent":x}},x&&_&&{"aria-valuenow":Math.round(typeof x=="number"?x:Number(x||0))})}),[H,V]=wn("svg",{className:T.svg,elementType:jre,externalForwardedProps:z,ownerState:I}),[q,J]=wn("track",{className:T.track,elementType:Hre,externalForwardedProps:z,ownerState:I}),[Y,N]=wn("progress",{className:T.progress,elementType:Gre,externalForwardedProps:z,ownerState:I});return ee.jsxs(k,ue({},U,{children:[ee.jsxs(H,ue({},V,{children:[ee.jsx(q,ue({},J)),ee.jsx(Y,ue({},N))]})),i]}))}),Wre=["children","action","component","color","disabled","variant","loading","loadingIndicator","size","slots","slotProps"],qre=e=>{const{color:t,disabled:n,focusVisible:r,focusVisibleClassName:i,size:a,variant:c,loading:o}=e,f={root:["root",n&&"disabled",r&&"focusVisible",c&&`variant${mn(c)}`,t&&`color${mn(t)}`,a&&`size${mn(a)}`,o&&"loading"],loadingIndicator:["loadingIndicator"]},g=yr(f,zre,{});return r&&i&&(g.root+=` ${i}`),g},G_=nn("button")(({theme:e,ownerState:t})=>{var n,r,i,a;return[ue({"--Icon-margin":"initial","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon},t.instanceSize&&{"--IconButton-size":{sm:"2rem",md:"2.25rem",lg:"2.75rem"}[t.instanceSize]},t.size==="sm"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.6)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:e.vars.fontSize.sm,paddingInline:"2px"},t.size==="md"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.25rem) / 1.5)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2.25rem)",minHeight:"var(--IconButton-size, 2.25rem)",fontSize:e.vars.fontSize.md,paddingInline:"0.25rem"},t.size==="lg"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.75rem) / 1.571)","--CircularProgress-size":"28px","--CircularProgress-thickness":"4px",minWidth:"var(--IconButton-size, 2.75rem)",minHeight:"var(--IconButton-size, 2.75rem)",fontSize:e.vars.fontSize.lg,paddingInline:"0.375rem"},{WebkitTapHighlightColor:"transparent",paddingBlock:0,fontFamily:e.vars.fontFamily.body,fontWeight:e.vars.fontWeight.md,margin:"var(--IconButton-margin)",borderRadius:`var(--IconButton-radius, ${e.vars.radius.sm})`,border:"none",boxSizing:"border-box",backgroundColor:"transparent",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",[e.focus.selector]:ue({"--Icon-color":"currentColor"},e.focus.default)}),ue({},(n=e.variants[t.variant])==null?void 0:n[t.color],{"&:hover":{"@media (hover: hover)":ue({"--Icon-color":"currentColor"},(r=e.variants[`${t.variant}Hover`])==null?void 0:r[t.color])},'&:active, &[aria-pressed="true"]':ue({"--Icon-color":"currentColor"},(i=e.variants[`${t.variant}Active`])==null?void 0:i[t.color]),"&:disabled":(a=e.variants[`${t.variant}Disabled`])==null?void 0:a[t.color]})]}),Xre=nn(G_,{name:"JoyIconButton",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Zre=nn("span",{name:"JoyIconButton",slot:"LoadingIndicator",overridesResolver:(e,t)=>t.loadingIndicator})(({theme:e,ownerState:t})=>{var n,r;return ue({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=e.variants[t.variant])==null||(n=n[t.color])==null?void 0:n.color},t.disabled&&{color:(r=e.variants[`${t.variant}Disabled`])==null||(r=r[t.color])==null?void 0:r.color})}),fu=$.forwardRef(function(t,n){var r;const i=wr({props:t,name:"JoyIconButton"}),{children:a,action:c,component:o="button",color:f="neutral",disabled:g,variant:_="plain",loading:x=!1,loadingIndicator:M,size:C="md",slots:A={},slotProps:L={}}=i,I=Un(i,Wre),T=$.useContext($3),z=$.useContext(V8),k=t.variant||T.variant||_,U=t.size||T.size||C,H=t.color||T.color||f,V=(r=t.loading||t.disabled)!=null?r:T.disabled||x||g,q=$.useRef(null),J=Ur(q,n),{focusVisible:Y,setFocusVisible:N,getRootProps:ne}=Mc(ue({},i,{disabled:V,rootRef:J})),ye=M??ee.jsx(V3,{color:H,thickness:{sm:2,md:3,lg:4}[U]||3});$.useImperativeHandle(c,()=>({focusVisible:()=>{var ct;N(!0),(ct=q.current)==null||ct.focus()}}),[N]);const ge=ue({},i,{component:o,color:H,disabled:V,variant:k,loading:x,size:U,focusVisible:Y,instanceSize:t.size}),Ne=qre(ge),Ae=ct=>{var Xt;let je=i.onClick;if(typeof L.root=="function"?je=L.root(ge).onClick:L.root&&(je=L.root.onClick),(Xt=je)==null||Xt(ct),z){var lt;(lt=z.onClick)==null||lt.call(z,ct,i.value)}};let ve=i["aria-pressed"];typeof L.root=="function"?ve=L.root(ge)["aria-pressed"]:L.root&&(ve=L.root["aria-pressed"]),z!=null&&z.value&&(Array.isArray(z.value)?ve=z.value.indexOf(i.value)!==-1:ve=z.value===i.value);const Se=ue({},I,{component:o,slots:A,slotProps:L}),[Me,Ue]=wn("root",{ref:n,className:Ne.root,elementType:Xre,getSlotProps:ne,externalForwardedProps:Se,ownerState:ge,additionalProps:{onClick:Ae,"aria-pressed":ve}}),[Qe,st]=wn("loadingIndicator",{className:Ne.loadingIndicator,elementType:Zre,externalForwardedProps:Se,ownerState:ge});return ee.jsx(Me,ue({},Ue,{children:x?ee.jsx(Qe,ue({},st,{children:ye})):a}))});fu.muiName="IconButton";function Yre(e){return br("MuiChip",e)}const wA=gr("MuiChip",["root","clickable","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","disabled","endDecorator","focusVisible","label","labelSm","labelMd","labelLg","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantSolid","variantSoft","variantOutlined"]),j8=$.createContext({disabled:void 0,variant:void 0,color:void 0}),Kre=["children","className","color","onClick","disabled","size","variant","startDecorator","endDecorator","component","slots","slotProps"],Jre=e=>{const{disabled:t,size:n,color:r,clickable:i,variant:a,focusVisible:c}=e,o={root:["root",t&&"disabled",r&&`color${mn(r)}`,n&&`size${mn(n)}`,a&&`variant${mn(a)}`,i&&"clickable"],action:["action",t&&"disabled",c&&"focusVisible"],label:["label",n&&`label${mn(n)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return yr(o,Yre,{})},Qre=nn("div",{name:"JoyChip",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r,i;const a=(n=e.variants[t.variant])==null?void 0:n[t.color],{borderRadius:c}=Wf({theme:e,ownerState:t},["borderRadius"]);return[ue({"--Chip-decoratorChildOffset":"min(calc(var(--Chip-paddingInline) - (var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2), var(--Chip-paddingInline))","--Chip-decoratorChildRadius":"max(var(--_Chip-radius) - var(--variant-borderWidth, 0px) - var(--_Chip-paddingBlock), min(var(--_Chip-paddingBlock) + var(--variant-borderWidth, 0px), var(--_Chip-radius) / 2))","--Chip-deleteRadius":"var(--Chip-decoratorChildRadius)","--Chip-deleteSize":"var(--Chip-decoratorChildHeight)","--Avatar-radius":"var(--Chip-decoratorChildRadius)","--Avatar-size":"var(--Chip-decoratorChildHeight)","--Icon-margin":"initial","--Icon-color":"currentColor","--unstable_actionRadius":"var(--_Chip-radius)"},t.size==="sm"&&{"--Chip-paddingInline":"0.375rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 2 * var(--variant-borderWidth))","--Icon-fontSize":e.vars.fontSize.sm,"--_Chip-minHeight":"var(--Chip-minHeight, 1.25rem)",gap:"3px"},t.size==="md"&&{"--Chip-paddingInline":"0.5rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.25rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":e.vars.fontSize.md,"--_Chip-minHeight":"var(--Chip-minHeight, 1.5rem)",gap:"0.25rem"},t.size==="lg"&&{"--Chip-paddingInline":"0.75rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.375rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":e.vars.fontSize.lg,"--_Chip-minHeight":"var(--Chip-minHeight, 1.75rem)",gap:"0.375rem"},{"--_Chip-radius":"var(--Chip-radius, 1.5rem)","--_Chip-paddingBlock":"max((var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2, 0px)",minHeight:"var(--_Chip-minHeight)",maxWidth:"max-content",paddingInline:"var(--Chip-paddingInline)",borderRadius:"var(--_Chip-radius)",position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",textDecoration:"none",verticalAlign:"middle",boxSizing:"border-box"},e.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[t.size]}`],{fontWeight:e.vars.fontWeight.md,[`&.${wA.disabled}`]:{color:(r=e.variants[`${t.variant}Disabled`])==null||(r=r[t.color])==null?void 0:r.color}}),...t.clickable?[{"--variant-borderWidth":"0px",color:a==null?void 0:a.color}]:[ue({backgroundColor:e.vars.palette.background.surface},a,{[`&.${wA.disabled}`]:(i=e.variants[`${t.variant}Disabled`])==null?void 0:i[t.color]})],c!==void 0&&{"--_Chip-radius":c}]}),eie=nn("span",{name:"JoyChip",slot:"Label",overridesResolver:(e,t)=>t.label})(({ownerState:e})=>ue({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",order:1,minInlineSize:0,flexGrow:1},e.clickable&&{zIndex:1,pointerEvents:"none"})),tie=nn("button",{name:"JoyChip",slot:"Action",overridesResolver:(e,t)=>t.action})(({theme:e,ownerState:t})=>{var n,r,i,a;return[{"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,position:"absolute",zIndex:0,top:0,left:0,bottom:0,right:0,width:"100%",border:"none",cursor:"pointer",padding:"initial",margin:"initial",backgroundColor:"initial",textDecoration:"none",borderRadius:"inherit",[e.focus.selector]:e.focus.default},ue({backgroundColor:e.vars.palette.background.surface},(n=e.variants[t.variant])==null?void 0:n[t.color]),{"&:hover":{"@media (hover: hover)":(r=e.variants[`${t.variant}Hover`])==null?void 0:r[t.color]}},{"&:active":(i=e.variants[`${t.variant}Active`])==null?void 0:i[t.color]},{[`&.${wA.disabled}`]:(a=e.variants[`${t.variant}Disabled`])==null?void 0:a[t.color]}]}),nie=nn("span",{name:"JoyChip",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({"--Avatar-marginInlineStart":"calc(var(--Chip-decoratorChildOffset) * -1)","--IconButton-margin":"0 calc(-1 * var(--Chip-paddingInline) / 3) 0 calc(var(--Chip-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Chip-paddingInline) / -4)",display:"inherit",order:0,zIndex:1,pointerEvents:"none"}),rie=nn("span",{name:"JoyChip",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({"--IconButton-margin":"0 calc(var(--Chip-decoratorChildOffset) * -1) 0 calc(-1 * var(--Chip-paddingInline) / 3)","--Icon-margin":"0 calc(var(--Chip-paddingInline) / -4) 0 0",display:"inherit",order:2,zIndex:1,pointerEvents:"none"}),H8=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyChip"}),{children:i,className:a,color:c="neutral",onClick:o,disabled:f=!1,size:g="md",variant:_="soft",startDecorator:x,endDecorator:M,component:C,slots:A={},slotProps:L={}}=r,I=Un(r,Kre),T=!!o||!!L.action,z=ue({},r,{disabled:f,size:g,color:c,variant:_,clickable:T,focusVisible:!1}),k=typeof L.action=="function"?L.action(z):L.action,U=$.useRef(null),{focusVisible:H,getRootProps:V}=Mc(ue({},k,{disabled:f,rootRef:U}));z.focusVisible=H;const q=Jre(z),J=ue({},I,{component:C,slots:A,slotProps:L}),[Y,N]=wn("root",{ref:n,className:xi(q.root,a),elementType:Qre,externalForwardedProps:J,ownerState:z}),[ne,ye]=wn("label",{className:q.label,elementType:eie,externalForwardedProps:J,ownerState:z}),ge=qs(ye.id),[Ne,Ae]=wn("action",{className:q.action,elementType:tie,externalForwardedProps:J,ownerState:z,getSlotProps:V,additionalProps:{"aria-labelledby":ge,as:k==null?void 0:k.component,onClick:o}}),[ve,Se]=wn("startDecorator",{className:q.startDecorator,elementType:nie,externalForwardedProps:J,ownerState:z}),[Me,Ue]=wn("endDecorator",{className:q.endDecorator,elementType:rie,externalForwardedProps:J,ownerState:z}),Qe=$.useMemo(()=>({disabled:f}),[f]);return ee.jsx(j8.Provider,{value:Qe,children:ee.jsx(OM,{variant:_,color:c,children:ee.jsxs(Y,ue({},N,{children:[T&&ee.jsx(Ne,ue({},Ae)),ee.jsx(ne,ue({},ye,{id:ge,children:i})),x&&ee.jsx(ve,ue({},Se,{children:x})),M&&ee.jsx(Me,ue({},Ue,{children:M}))]}))})})}),iie=Hg(ee.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Cancel");function oie(e){return br("MuiChipDelete",e)}gr("MuiChipDelete",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSolid","variantSoft","variantOutlined"]);var t5;const sie=["children","variant","color","disabled","onKeyDown","onDelete","onClick","component","slots","slotProps"],aie=["onDelete"],lie=e=>{const{focusVisible:t,variant:n,color:r,disabled:i}=e,a={root:["root",i&&"disabled",t&&"focusVisible",n&&`variant${mn(n)}`,r&&`color${mn(r)}`]};return yr(a,oie,{})},cie=nn(G_,{name:"JoyChipDelete",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({"--IconButton-size":"var(--Chip-deleteSize, 2rem)","--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.3)",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:e.vars.fontSize.sm,paddingInline:"2px",pointerEvents:"visible",borderRadius:"var(--Chip-deleteRadius, 50%)",zIndex:1,padding:0})),uie=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyChipDelete"}),{children:i,variant:a="plain",color:c="neutral",disabled:o,onKeyDown:f,onDelete:g,onClick:_,component:x,slots:M={},slotProps:C={}}=r,A=Un(r,sie),L=$.useContext(j8),{variant:I=a,color:T=c}=zM(t.variant,t.color,!0),z=t.color||T,k=o??L.disabled,U=$.useRef(null),H=Ur(U,n),{focusVisible:V,getRootProps:q}=Mc(ue({},r,{disabled:k,rootRef:H})),J=ue({},r,{disabled:k,variant:I,color:z,focusVisible:V}),Y=lie(J),N=ue({},A,{component:x,slots:M,slotProps:C}),ne=ve=>{!k&&g&&g(ve),_&&_(ve)},ye=ve=>{["Backspace","Enter","Delete"].includes(ve.key)&&(ve.preventDefault(),!k&&g&&g(ve)),f&&f(ve)},[ge,Ne]=wn("root",{ref:n,elementType:cie,getSlotProps:q,externalForwardedProps:N,ownerState:J,additionalProps:{as:x,onKeyDown:ye,onClick:ne},className:Y.root}),Ae=Un(Ne,aie);return ee.jsx(ge,ue({},Ae,{children:i??(t5||(t5=ee.jsx(iie,{})))}))});function hie(e){return br("MuiInput",e)}const G8=gr("MuiInput",["root","input","formControl","focused","disabled","error","adornedStart","adornedEnd","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid","fullWidth","startDecorator","endDecorator"]),FM=$.createContext(void 0),die=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoFocus","className","defaultValue","disabled","disabledInProp","error","id","name","onClick","onChange","onKeyDown","onKeyUp","onFocus","onBlur","placeholder","readOnly","required","type","value"];function fie(e,t){var n;const r=$.useContext(FM),{"aria-describedby":i,"aria-label":a,"aria-labelledby":c,autoComplete:o,autoFocus:f,className:g,defaultValue:_,disabled:x,disabledInProp:M,error:C,id:A,name:L,onClick:I,onChange:T,onKeyDown:z,onKeyUp:k,onFocus:U,onBlur:H,placeholder:V,readOnly:q,required:J,type:Y,value:N}=e,ne=Un(e,die),{getRootProps:ye,getInputProps:ge,focused:Ne,error:Ae,disabled:ve}=HJ({disabled:(n=M??(r==null?void 0:r.disabled))!=null?n:x,defaultValue:_,error:C,onBlur:H,onClick:I,onChange:T,onFocus:U,required:J??(r==null?void 0:r.required),value:N}),Se={[t.disabled]:ve,[t.error]:Ae,[t.focused]:Ne,[t.formControl]:!!r,[g]:g},Me={[t.disabled]:ve};return ue({formControl:r,propsToForward:{"aria-describedby":i,"aria-label":a,"aria-labelledby":c,autoComplete:o,autoFocus:f,disabled:ve,id:A,onKeyDown:z,onKeyUp:k,name:L,placeholder:V,readOnly:q,type:Y},rootStateClasses:Se,inputStateClasses:Me,getRootProps:ye,getInputProps:ge,focused:Ne,error:Ae,disabled:ve},ne)}const pie=["propsToForward","rootStateClasses","inputStateClasses","getRootProps","getInputProps","formControl","focused","error","disabled","fullWidth","size","color","variant","startDecorator","endDecorator","component","slots","slotProps"],mie=e=>{const{disabled:t,fullWidth:n,variant:r,color:i,size:a}=e,c={root:["root",t&&"disabled",n&&"fullWidth",r&&`variant${mn(r)}`,i&&`color${mn(i)}`,a&&`size${mn(a)}`],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return yr(c,hie,{})},W8=nn("div")(({theme:e,ownerState:t})=>{var n,r,i,a,c,o;const f=(n=e.variants[`${t.variant}`])==null?void 0:n[t.color];return[ue({"--Input-radius":e.vars.radius.sm,"--Input-gap":"0.5rem","--Input-placeholderColor":"inherit","--Input-placeholderOpacity":.64,"--Input-decoratorColor":e.vars.palette.text.icon,"--Input-focused":"0","--Input-focusedThickness":e.vars.focus.thickness,"--Input-focusedHighlight":(r=e.vars.palette[t.color==="neutral"?"primary":t.color])==null?void 0:r[500],[`&:not([${Mg}])`]:ue({},t.instanceColor&&{"--_Input-focusedHighlight":(i=e.vars.palette[t.instanceColor==="neutral"?"primary":t.instanceColor])==null?void 0:i[500]},{"--Input-focusedHighlight":`var(--_Input-focusedHighlight, ${e.vars.palette.focusVisible})`})},t.size==="sm"&&{"--Input-minHeight":"2rem","--Input-paddingInline":"0.5rem","--Input-decoratorChildHeight":"min(1.5rem, var(--Input-minHeight))","--Icon-fontSize":e.vars.fontSize.xl},t.size==="md"&&{"--Input-minHeight":"2.25rem","--Input-paddingInline":"0.75rem","--Input-decoratorChildHeight":"min(1.75rem, var(--Input-minHeight))","--Icon-fontSize":e.vars.fontSize.xl2},t.size==="lg"&&{"--Input-minHeight":"2.75rem","--Input-paddingInline":"1rem","--Input-gap":"0.75rem","--Input-decoratorChildHeight":"min(2.25rem, var(--Input-minHeight))","--Icon-fontSize":e.vars.fontSize.xl2},{"--Input-decoratorChildOffset":"min(calc(var(--Input-paddingInline) - (var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2), var(--Input-paddingInline))","--_Input-paddingBlock":"max((var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2, 0px)","--Input-decoratorChildRadius":"max(var(--Input-radius) - var(--variant-borderWidth, 0px) - var(--_Input-paddingBlock), min(var(--_Input-paddingBlock) + var(--variant-borderWidth, 0px), var(--Input-radius) / 2))","--Button-minHeight":"var(--Input-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Input-decoratorChildHeight)","--Button-radius":"var(--Input-decoratorChildRadius)","--IconButton-radius":"var(--Input-decoratorChildRadius)",boxSizing:"border-box"},t.variant!=="plain"&&{boxShadow:e.shadow.xs},{minWidth:0,minHeight:"var(--Input-minHeight)"},t.fullWidth&&{width:"100%"},{cursor:"text",position:"relative",display:"flex",paddingInline:"var(--Input-paddingInline)",borderRadius:"var(--Input-radius)"},e.typography[`body-${t.size}`],f,{backgroundColor:(a=f==null?void 0:f.backgroundColor)!=null?a:e.vars.palette.background.surface,"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)",boxShadow:"var(--Input-focusedInset, inset) 0 0 0 calc(var(--Input-focused) * var(--Input-focusedThickness)) var(--Input-focusedHighlight)"}}),{"&:hover":ue({},(c=e.variants[`${t.variant}Hover`])==null?void 0:c[t.color],{backgroundColor:null}),[`&.${G8.disabled}`]:(o=e.variants[`${t.variant}Disabled`])==null?void 0:o[t.color],"&:focus-within::before":{"--Input-focused":"1"}}]}),q8=nn("input")(({ownerState:e})=>({border:"none",minWidth:0,outline:0,padding:0,flex:1,color:"inherit",backgroundColor:"transparent",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"inherit",textOverflow:"ellipsis","&:-webkit-autofill":ue({paddingInline:"var(--Input-paddingInline)"},!e.startDecorator&&{marginInlineStart:"calc(-1 * var(--Input-paddingInline))",paddingInlineStart:"var(--Input-paddingInline)",borderTopLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"},!e.endDecorator&&{marginInlineEnd:"calc(-1 * var(--Input-paddingInline))",paddingInlineEnd:"var(--Input-paddingInline)",borderTopRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"}),"&::-webkit-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-moz-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&:-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"}})),X8=nn("div")({"--Button-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Input-paddingInline) / -4)",display:"inherit",alignItems:"center",paddingBlock:"var(--unstable_InputPaddingBlock)",flexWrap:"wrap",marginInlineEnd:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),Z8=nn("div")({"--Button-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Input-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",marginInlineStart:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),gie=nn(W8,{name:"JoyInput",slot:"Root",overridesResolver:(e,t)=>t.root})({}),vie=nn(q8,{name:"JoyInput",slot:"Input",overridesResolver:(e,t)=>t.input})({}),yie=nn(X8,{name:"JoyInput",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({}),_ie=nn(Z8,{name:"JoyInput",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({}),xie=$.forwardRef(function(t,n){var r,i,a,c,o,f;const g=wr({props:t,name:"JoyInput"}),_=fie(ue({},g,{disabledInProp:t.disabled}),G8),{propsToForward:x,rootStateClasses:M,inputStateClasses:C,getRootProps:A,getInputProps:L,formControl:I,focused:T,error:z=!1,disabled:k,fullWidth:U=!1,size:H="md",color:V="neutral",variant:q="outlined",startDecorator:J,endDecorator:Y,component:N,slots:ne={},slotProps:ye={}}=_,ge=Un(_,pie),Ne=(r=(i=t.error)!=null?i:I==null?void 0:I.error)!=null?r:z,Ae=(a=(c=t.size)!=null?c:I==null?void 0:I.size)!=null?a:H,ve=(o=t.color)!=null?o:Ne?"danger":(f=I==null?void 0:I.color)!=null?f:V,Se=ue({instanceColor:Ne?"danger":t.color},g,{fullWidth:U,color:ve,disabled:k,error:Ne,focused:T,size:Ae,variant:q}),Me=mie(Se),Ue=ue({},ge,{component:N,slots:ne,slotProps:ye}),[Qe,st]=wn("root",{ref:n,className:[Me.root,M],elementType:gie,getSlotProps:A,externalForwardedProps:Ue,ownerState:Se}),[ct,Xt]=wn("input",ue({},I&&{additionalProps:{id:I.htmlFor,"aria-describedby":I["aria-describedby"]}},{className:[Me.input,C],elementType:vie,getSlotProps:L,internalForwardedProps:x,externalForwardedProps:Ue,ownerState:Se})),[je,lt]=wn("startDecorator",{className:Me.startDecorator,elementType:yie,externalForwardedProps:Ue,ownerState:Se}),[Ot,ut]=wn("endDecorator",{className:Me.endDecorator,elementType:_ie,externalForwardedProps:Ue,ownerState:Se});return ee.jsxs(Qe,ue({},st,{children:[J&&ee.jsx(je,ue({},lt,{children:J})),ee.jsx(ct,ue({},Xt)),Y&&ee.jsx(Ot,ue({},ut,{children:Y}))]}))});function bie(e){return br("MuiListSubheader",e)}gr("MuiListSubheader",["root","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const wie=["component","className","children","id","sticky","variant","color","slots","slotProps"],Sie=e=>{const{variant:t,color:n,sticky:r}=e,i={root:["root",r&&"sticky",n&&`color${mn(n)}`,t&&`variant${mn(t)}`]};return yr(i,bie,{})},Mie=nn("div",{name:"JoyListSubheader",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r;return ue({boxSizing:"border-box",display:"flex",alignItems:"center",marginInline:"var(--ListItem-marginInline)",paddingBlock:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)",minBlockSize:"var(--ListItem-minHeight)"},e.typography["body-xs"],{fontSize:"max(0.75em, 0.625rem)",textTransform:"uppercase",letterSpacing:"0.1em"},t.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:"var(--ListItem-stickyBackground)"},{color:t.color?`var(--_Link-color, rgba(${(n=e.vars.palette[t.color])==null?void 0:n.mainChannel} / 1))`:e.vars.palette.text.tertiary},t.instanceColor&&{[`&:not([${Mg}])`]:{"--_Link-color":e.vars.palette.text.secondary}},(r=e.variants[t.variant])==null?void 0:r[t.color])}),Cie=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyListSubheader"}),{component:i,className:a,children:c,id:o,sticky:f=!1,variant:g,color:_,slots:x={},slotProps:M={}}=r,C=Un(r,wie),A=qs(o),L=$.useContext(F8);$.useEffect(()=>{L&&L(A||"")},[L,A]);const I=ue({instanceColor:t.color},r,{id:A,sticky:f,variant:g,color:g?_??"neutral":_}),T=Sie(I),z=ue({},C,{component:i,slots:x,slotProps:M}),[k,U]=wn("root",{ref:n,className:xi(T.root,a),elementType:Mie,externalForwardedProps:z,ownerState:I,additionalProps:{as:i,id:A}});return ee.jsx(k,ue({},U,{children:c}))});function Eie(e){return br("MuiAutocomplete",e)}const gh=gr("MuiAutocomplete",["root","wrapper","input","startDecorator","endDecorator","formControl","focused","disabled","error","multiple","limitTag","hasPopupIcon","hasClearIcon","clearIndicator","popupIndicator","popupIndicatorOpen","listbox","option","loading","noOptions","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]),Y8=nn($_)(({theme:e,ownerState:t})=>{var n;const r=(n=e.variants[t.variant])==null?void 0:n[t.color];return ue({"--focus-outline-offset":`calc(${e.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":(r==null?void 0:r.backgroundColor)||(r==null?void 0:r.background)||e.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},kM,{boxShadow:e.shadow.md,borderRadius:`var(--List-radius, ${e.vars.radius.sm})`},!(r!=null&&r.backgroundColor)&&{backgroundColor:e.vars.palette.background.popup},{zIndex:e.vars.zIndex.popup,overflow:"auto",maxHeight:"40vh",position:"relative","&:empty":{visibility:"hidden"},[`& .${nS.nested}, & .${nS.nested} .${Mre.root}`]:{position:"initial"}})});nn(Y8,{name:"JoyAutocompleteListbox",slot:"Root",overridesResolver:(e,t)=>t.root})({});function Tie(e){return br("MuiAutocompleteOption",e)}gr("MuiAutocompleteOption",["root","focused","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const Pie=["children","component","color","variant","className","slots","slotProps"],Aie=e=>{const{color:t,variant:n}=e,r={root:["root",t&&`color${mn(t)}`,n&&`variant${mn(n)}`]};return yr(r,Tie,{})},K8=nn(V_)(({theme:e,ownerState:t})=>{var n,r;return{'&[aria-disabled="true"]':(n=e.variants[`${t.variant}Disabled`])==null?void 0:n[t.color],'&[aria-selected="true"]':ue({},(r=e.variants[`${t.variant}Active`])==null?void 0:r[t.color],{fontWeight:e.vars.fontWeight.md})}}),Iie=nn(K8,{name:"JoyAutocompleteOption",slot:"Root",overridesResolver:(e,t)=>t.root})({}),J8=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyAutocompleteOption"}),{children:i,component:a="li",color:c="neutral",variant:o="plain",className:f,slots:g={},slotProps:_={}}=r,x=Un(r,Pie),{variant:M=o,color:C=c}=zM(t.variant,t.color),A=ue({},r,{component:a,color:C,variant:M}),L=Aie(A),I=ue({},x,{component:a,slots:g,slotProps:_}),[T,z]=wn("root",{ref:n,className:xi(L.root,f),elementType:Iie,externalForwardedProps:I,ownerState:A,additionalProps:{as:a,role:"option"}});return ee.jsx(T,ue({},z,{children:i}))});var n5,r5;const Rie=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoHighlight","autoSelect","autoFocus","blurOnSelect","clearIcon","clearOnBlur","clearOnEscape","clearText","closeText","defaultValue","disableCloseOnSelect","disabledItemsFocusable","disableListWrap","disableClearable","disabled","endDecorator","error","filterOptions","filterSelectedOptions","forcePopupIcon","freeSolo","getLimitTagsText","getOptionDisabled","getOptionKey","getOptionLabel","handleHomeEndKeys","includeInputInList","isOptionEqualToValue","groupBy","id","inputValue","limitTags","loading","loadingText","multiple","name","noOptionsText","onChange","onClose","onHighlightChange","onInputChange","onOpen","open","openOnFocus","openText","options","placeholder","popupIcon","readOnly","renderGroup","renderOption","renderTags","required","type","startDecorator","size","color","variant","value","component","selectOnFocus","slots","slotProps"],Lie=["onDelete"],kie=["key"],Die=["onBlur","onFocus","onMouseDown"],zie=["key"],Oie=e=>e.current!==null&&e.current.contains(document.activeElement),Fie=e=>{var t;return(t=e.label)!=null?t:e},Nie=e=>`+${e}`,Bie=e=>ee.jsxs(rd,{nested:!0,children:[ee.jsx(Cie,{sticky:!0,children:e.group}),ee.jsx(DM,{children:e.children})]},e.key),Uie=e=>{const{disabled:t,focused:n,hasClearIcon:r,hasPopupIcon:i,popupOpen:a,variant:c,color:o,size:f,multiple:g}=e,_={root:["root",n&&"focused",r&&"hasClearIcon",i&&"hasPopupIcon",c&&`variant${mn(c)}`,o&&`color${mn(o)}`,f&&`size${mn(f)}`],wrapper:["wrapper",g&&"multiple"],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",a&&"popupIndicatorOpen",t&&"disabled"],listbox:["listbox"],option:["option"],loading:["loading"],noOptions:["noOptions"],limitTag:["limitTag"]};return yr(_,Eie,{})},$ie=nn(W8,{name:"JoyAutocomplete",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>ue({},e.size==="sm"&&{"--Autocomplete-wrapperGap":"3px"},e.size==="md"&&{"--Autocomplete-wrapperGap":"3px"},e.size==="lg"&&{"--Autocomplete-wrapperGap":"4px"},{"@media (pointer: fine)":{[`&:hover .${gh.clearIndicator}`]:{visibility:"visible"}}},e.multiple&&!e.startDecorator&&{paddingInlineStart:0})),Vie=nn("div",{name:"JoyAutocomplete",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})(({ownerState:e})=>({flex:1,minWidth:0,display:"flex",alignItems:"center",flexWrap:"wrap",gap:"var(--Autocomplete-wrapperGap)",[`&.${gh.multiple}`]:ue({paddingBlock:"var(--Autocomplete-wrapperGap)"},!e.startDecorator&&{paddingInlineStart:"var(--Autocomplete-wrapperGap)"},!e.endDecorator&&{paddingInlineEnd:"var(--Autocomplete-wrapperGap)"})})),jie=nn(q8,{name:"JoyAutocomplete",slot:"Input",overridesResolver:(e,t)=>t.input})(({ownerState:e})=>ue({minWidth:30,minHeight:"var(--Chip-minHeight)"},e.multiple&&{marginInlineStart:"calc(var(--Autocomplete-wrapperGap) * 2.5)"})),Hie=nn(X8,{name:"JoyAutocomplete",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({}),Gie=nn(Z8,{name:"JoyAutocomplete",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})(({ownerState:e})=>ue({},(e.hasClearIcon||e.hasPopupIcon)&&{"--Button-margin":"0px","--IconButton-margin":"0px","--Icon-margin":"0px"})),Wie=nn(G_,{name:"JoyAutocomplete",slot:"ClearIndicator",overridesResolver:(e,t)=>t.clearIndicator})(({ownerState:e})=>ue({alignSelf:"center"},!e.hasPopupIcon&&{marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)"},{marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",visibility:e.focused?"visible":"hidden"})),qie=nn(G_,{name:"JoyAutocomplete",slot:"PopupIndicator",overridesResolver:(e,t)=>t.popupIndicator})({alignSelf:"center",marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)",[`&.${gh.popupIndicatorOpen}`]:{transform:"rotate(180deg)","--Icon-color":"currentColor"}}),Xie=nn(Y8,{name:"JoyAutocomplete",slot:"Listbox",overridesResolver:(e,t)=>t.listbox})(({theme:e})=>({zIndex:`var(--unstable_popup-zIndex, ${e.vars.zIndex.popup})`})),Zie=nn(K8,{name:"JoyAutocomplete",slot:"Option",overridesResolver:(e,t)=>t.option})({}),Yie=nn(rd,{name:"JoyAutocomplete",slot:"Loading",overridesResolver:(e,t)=>t.loading})(({theme:e})=>({color:(e.vars||e).palette.text.secondary})),Kie=nn(rd,{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(e,t)=>t.noOptions})(({theme:e})=>({color:(e.vars||e).palette.text.secondary})),Jie=nn("div",{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(e,t)=>t.noOptions})({marginInlineStart:"calc(var(--Input-paddingInline) / 2)",marginBlockStart:"var(--_Input-paddingBlock)"}),iS=$.forwardRef(function(t,n){var r,i,a,c,o,f,g;const _=wr({props:t,name:"JoyAutocomplete"}),{"aria-describedby":x,"aria-label":M,"aria-labelledby":C,autoFocus:A,clearIcon:L=n5||(n5=ee.jsx(U8,{fontSize:"md"})),clearText:I="Clear",closeText:T="Close",disableClearable:z=!1,disabled:k,endDecorator:U,error:H=!1,forcePopupIcon:V="auto",freeSolo:q=!1,getLimitTagsText:J=Nie,getOptionLabel:Y=Fie,groupBy:N,id:ne,limitTags:ye=-1,loading:ge=!1,loadingText:Ne="Loading",multiple:Ae=!1,name:ve,noOptionsText:Se="No options",openText:Me="Open",placeholder:Ue,popupIcon:Qe=r5||(r5=ee.jsx(Dre,{})),readOnly:st=!1,renderGroup:ct=Bie,renderOption:Xt,renderTags:je,required:lt,type:Ot,startDecorator:ut,size:ot="md",color:Tt="neutral",variant:Ct="outlined",component:un,slots:gn={},slotProps:hn={}}=_,We=Un(_,Rie),vn=$.useContext(FM),Ut=(r=(i=t.error)!=null?i:vn==null?void 0:vn.error)!=null?r:H,tn=(a=(c=t.size)!=null?c:vn==null?void 0:vn.size)!=null?a:ot,Dt=(o=t.color)!=null?o:Ut?"danger":(f=vn==null?void 0:vn.color)!=null?f:Tt,An=(g=k??(vn==null?void 0:vn.disabled))!=null?g:!1,{getRootProps:an,getInputProps:Le,getPopupIndicatorProps:me,getClearProps:it,getTagProps:St,getListboxProps:It,getOptionProps:wt,value:Zt,dirty:Lt,popupOpen:kt,focused:bn,focusedTag:zt,anchorEl:_e,setAnchorEl:te,inputValue:re,groupedOptions:Z}=dre(ue({},_,{id:ne??(vn==null?void 0:vn.htmlFor),componentName:"Autocomplete",unstable_classNamePrefix:"Mui",unstable_isActiveElementInListbox:Oie})),{onMouseDown:le}=Le(),{onClick:Te}=an(),Ve=!z&&!An&&Lt&&!st,fe=(!q||V===!0)&&V!==!1,xe=ue({instanceColor:t.color},_,{value:Zt,disabled:An,focused:bn,getOptionLabel:Y,hasOptions:!!Z.length,hasClearIcon:Ve,hasPopupIcon:fe,inputFocused:zt===-1,popupOpen:kt,size:tn,color:Dt,variant:Ct}),Re=Uie(xe),De=ue({},We,{component:un,slots:gn,slotProps:hn});let ze;if(Ae&&Zt.length>0){const Nt=zn=>{const _n=St(zn),{onDelete:Rn}=_n,jn=Un(_n,Lie);return ue({disabled:An,size:tn,onClick:Rn},jn)};je?ze=je(Zt,Nt,xe):ze=Zt.map((zn,_n)=>{const Rn=Nt({index:_n}),{key:jn}=Rn,fr=Un(Rn,kie);return ee.jsx(H8,{size:tn,variant:"soft",color:"neutral",endDecorator:ee.jsx(uie,ue({},fr),jn),sx:{minWidth:0},children:Y(zn)},_n)})}const Je=Ur(n,te),Oe={[gh.disabled]:An,[gh.error]:Ut,[gh.focused]:bn,[gh.formControl]:!!vn},[Et,Ft]=wn("root",{ref:Je,className:[Re.root,Oe],elementType:$ie,externalForwardedProps:De,ownerState:xe,getSlotProps:an,additionalProps:{onClick:Nt=>{Te&&Te(Nt),Nt.currentTarget===Nt.target&&le&&le(Nt)}}}),[be,qe]=wn("wrapper",{className:Re.wrapper,elementType:Vie,externalForwardedProps:De,ownerState:xe}),tt={[gh.disabled]:An},[At,Ht]=wn("input",{className:[Re.input,tt],elementType:jie,getSlotProps:Nt=>{const zn=Le(),{onBlur:_n,onFocus:Rn,onMouseDown:jn}=zn,fr=Un(zn,Die);return ue({},fr,{onBlur:pr=>{var Yn;_n==null||_n(pr),(Yn=Nt.onBlur)==null||Yn.call(Nt,pr)},onFocus:pr=>{var Yn;Rn==null||Rn(pr),(Yn=Nt.onFocus)==null||Yn.call(Nt,pr)},onMouseDown:pr=>{var Yn;jn==null||jn(pr),(Yn=Nt.onMouseDown)==null||Yn.call(Nt,pr)}})},externalForwardedProps:De,ownerState:xe,additionalProps:{autoFocus:A,placeholder:Ue,name:ve,readOnly:st,disabled:An,required:lt??(vn==null?void 0:vn.required),type:Ot,"aria-invalid":Ut||void 0,"aria-label":M,"aria-labelledby":C,"aria-describedby":x??(vn==null?void 0:vn["aria-describedby"])}}),[Yt,qt]=wn("startDecorator",{className:Re.startDecorator,elementType:Hie,externalForwardedProps:De,ownerState:xe}),[Gt,yn]=wn("endDecorator",{className:Re.endDecorator,elementType:Gie,externalForwardedProps:De,ownerState:xe}),[gt,In]=wn("clearIndicator",{className:Re.clearIndicator,elementType:Wie,getSlotProps:it,externalForwardedProps:De,ownerState:xe,getSlotOwnerState:Nt=>({size:Nt.size||tn,variant:Nt.variant||lf(Ct,Dt).variant||"plain",color:Nt.color||lf(Ct,Dt).color||"neutral",disableColorInversion:!!t.color}),additionalProps:{"aria-label":I,title:I}}),[cn,Nn]=wn("popupIndicator",{className:Re.popupIndicator,elementType:qie,getSlotProps:me,externalForwardedProps:De,ownerState:xe,getSlotOwnerState:Nt=>({size:Nt.size||tn,variant:Nt.variant||lf(Ct,Dt).variant||"plain",color:Nt.color||lf(Ct,Dt).color||"neutral",disableColorInversion:!!t.color}),additionalProps:{disabled:An,"aria-label":kt?T:Me,title:kt?T:Me,type:"button"}}),[xt,Ze]=wn("listbox",{className:Re.listbox,elementType:Xie,getSlotProps:It,externalForwardedProps:De,ownerState:xe,getSlotOwnerState:Nt=>({size:Nt.size||tn,variant:Nt.variant||Ct,color:Nt.color||Dt,disableColorInversion:!Nt.disablePortal}),additionalProps:{anchorEl:_e,open:kt,style:_e?{width:_e.clientWidth}:{}}}),[Rt,Wt]=wn("loading",{className:Re.loading,elementType:Yie,externalForwardedProps:De,ownerState:xe}),[pn,ur]=wn("noOptions",{className:Re.noOptions,elementType:Kie,externalForwardedProps:De,ownerState:xe,additionalProps:{role:"presentation",onMouseDown:Nt=>{Nt.preventDefault()}}}),[Xn,pe]=wn("limitTag",{className:Re.limitTag,elementType:Jie,externalForwardedProps:De,ownerState:xe});if(ye>-1&&Array.isArray(ze)){const Nt=ze.length-ye;!bn&&Nt>0&&(ze=ze.splice(0,ye),ze.push(ee.jsx(Xn,ue({},pe,{children:J(Nt)}),ze.length)))}const[nt,vt]=wn("option",{className:Re.option,elementType:Zie,externalForwardedProps:De,ownerState:xe,getSlotOwnerState:Nt=>({variant:Nt.variant||lf(Ct,Dt).variant||"plain",color:Nt.color||lf(Ct,Dt).color||"neutral",disableColorInversion:!Ze.disablePortal}),additionalProps:{as:"li"}}),at=Xt||((Nt,zn)=>{const{key:_n}=Nt,Rn=Un(Nt,zie);return ee.jsx(nt,ue({},Rn,{children:Y(zn)}),_n)}),Kt=(Nt,zn)=>{const _n=wt({option:Nt,index:zn});return at(ue({},vt,_n),Nt,{selected:!!_n["aria-selected"],inputValue:re,ownerState:xe})},fn=$.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...Ze.modifiers||[]],[Ze.modifiers]);let Qt=null;if(_e){var ln;Qt=ee.jsx(OM,{variant:Ct,color:Dt,children:ee.jsx(U_,{nested:!0,children:ee.jsxs(xt,ue({},Ze,{className:xi(Ze.className),modifiers:fn},!((ln=_.slots)!=null&&ln.listbox)&&{as:IM,slots:{root:Ze.as||"ul"}},{children:[Z.map((Nt,zn)=>{if(N){const _n=Nt;return ct({key:String(_n.key),group:_n.group,children:_n.options.map((Rn,jn)=>Kt(Rn,_n.index+jn))})}return Kt(Nt,zn)}),ge&&Z.length===0?ee.jsx(Rt,ue({},Wt,{children:Ne})):null,Z.length===0&&!q&&!ge?ee.jsx(pn,ue({},ur,{children:Se})):null]}))})})}return ee.jsxs($.Fragment,{children:[ee.jsxs(Et,ue({},Ft,{children:[ut&&ee.jsx(Yt,ue({},qt,{children:ut})),ee.jsxs(be,ue({},qe,{children:[ze,ee.jsx(At,ue({},Ht))]})),U&&ee.jsx(Gt,ue({},yn,{children:U})),Ve?ee.jsx(gt,ue({},In,{children:L})):null,fe?ee.jsx(cn,ue({},Nn,{children:Qe})):null]})),Qt]})}),Qie=oU("MuiBox",["root"]),eoe=cK({themeId:C_,defaultTheme:Ug,defaultClassName:Qie.root,generateClassName:nU.generate});function toe(e){return br("MuiTypography",e)}gr("MuiTypography",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","noWrap","gutterBottom","startDecorator","endDecorator","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const noe=["color","textColor"],roe=["component","gutterBottom","noWrap","level","levelMapping","children","endDecorator","startDecorator","variant","slots","slotProps"],SA=$.createContext(!1),ioe=$.createContext(!1),ooe=e=>{const{gutterBottom:t,noWrap:n,level:r,color:i,variant:a}=e,c={root:["root",r,t&&"gutterBottom",n&&"noWrap",i&&`color${mn(i)}`,a&&`variant${mn(a)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return yr(c,toe,{})},soe=nn("span",{name:"JoyTypography",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({display:"inline-flex",marginInlineEnd:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),aoe=nn("span",{name:"JoyTypography",slot:"endDecorator",overridesResolver:(e,t)=>t.endDecorator})({display:"inline-flex",marginInlineStart:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),loe=nn("span",{name:"JoyTypography",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r,i,a,c;const o=t.level!=="inherit"?(n=e.typography[t.level])==null?void 0:n.lineHeight:"1";return ue({"--Icon-fontSize":`calc(1em * ${o})`},t.color&&{"--Icon-color":"currentColor"},{margin:"var(--Typography-margin, 0px)"},t.nesting?{display:"inline"}:ue({display:"block"},t.unstable_hasSkeleton&&{position:"relative"}),(t.startDecorator||t.endDecorator)&&ue({display:"flex",alignItems:"center"},t.nesting&&ue({display:"inline-flex"},t.startDecorator&&{verticalAlign:"bottom"})),t.level&&t.level!=="inherit"&&e.typography[t.level],{fontSize:`var(--Typography-fontSize, ${t.level&&t.level!=="inherit"&&(r=(i=e.typography[t.level])==null?void 0:i.fontSize)!=null?r:"inherit"})`},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.color&&{color:`var(--variant-plainColor, rgba(${(a=e.vars.palette[t.color])==null?void 0:a.mainChannel} / 1))`},t.variant&&ue({borderRadius:e.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},!t.nesting&&{marginInline:"-0.25em"},(c=e.variants[t.variant])==null?void 0:c[t.color]))}),i5={h1:"h1",h2:"h2",h3:"h3",h4:"h4","title-lg":"p","title-md":"p","title-sm":"p","body-lg":"p","body-md":"p","body-sm":"p","body-xs":"span",inherit:"p"},oi=$.forwardRef(function(t,n){var r;const i=wr({props:t,name:"JoyTypography"}),{color:a,textColor:c}=i,o=Un(i,noe),f=$.useContext(SA),g=$.useContext(ioe),_=PR(ue({},o,{color:c})),{component:x,gutterBottom:M=!1,noWrap:C=!1,level:A="body-md",levelMapping:L=i5,children:I,endDecorator:T,startDecorator:z,variant:k,slots:U={},slotProps:H={}}=_,V=Un(_,roe),q=(r=t.color)!=null?r:k?a??"neutral":a,J=f||g?t.level||"inherit":A,Y=IR(I,["Skeleton"]),N=x||(f?"span":L[J]||i5[J]||"span"),ne=ue({},_,{level:J,component:N,color:q,gutterBottom:M,noWrap:C,nesting:f,variant:k,unstable_hasSkeleton:Y}),ye=ooe(ne),ge=ue({},V,{component:N,slots:U,slotProps:H}),[Ne,Ae]=wn("root",{ref:n,className:ye.root,elementType:loe,externalForwardedProps:ge,ownerState:ne}),[ve,Se]=wn("startDecorator",{className:ye.startDecorator,elementType:soe,externalForwardedProps:ge,ownerState:ne}),[Me,Ue]=wn("endDecorator",{className:ye.endDecorator,elementType:aoe,externalForwardedProps:ge,ownerState:ne});return ee.jsx(SA.Provider,{value:!0,children:ee.jsxs(Ne,ue({},Ae,{children:[z&&ee.jsx(ve,ue({},Se,{children:z})),Y?$.cloneElement(I,{variant:I.props.variant||"inline"}):I,T&&ee.jsx(Me,ue({},Ue,{children:T}))]}))})});oi.muiName="Typography";function coe(e){return br("MuiButton",e)}const o5=gr("MuiButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]),uoe=["children","action","color","variant","size","fullWidth","startDecorator","endDecorator","loading","loadingPosition","loadingIndicator","disabled","component","slots","slotProps"],hoe=e=>{const{color:t,disabled:n,focusVisible:r,focusVisibleClassName:i,fullWidth:a,size:c,variant:o,loading:f}=e,g={root:["root",n&&"disabled",r&&"focusVisible",a&&"fullWidth",o&&`variant${mn(o)}`,t&&`color${mn(t)}`,c&&`size${mn(c)}`,f&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]},_=yr(g,coe,{});return r&&i&&(_.root+=` ${i}`),_},doe=nn("span",{name:"JoyButton",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),foe=nn("span",{name:"JoyButton",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),poe=nn("span",{name:"JoyButton",slot:"LoadingCenter",overridesResolver:(e,t)=>t.loadingIndicatorCenter})(({theme:e,ownerState:t})=>{var n,r;return ue({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=e.variants[t.variant])==null||(n=n[t.color])==null?void 0:n.color},t.disabled&&{color:(r=e.variants[`${t.variant}Disabled`])==null||(r=r[t.color])==null?void 0:r.color})}),Q8=({theme:e,ownerState:t})=>{var n,r,i,a;return[ue({"--Icon-margin":"initial","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon},t.size==="sm"&&{"--Icon-fontSize":e.vars.fontSize.lg,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.375rem",minHeight:"var(--Button-minHeight, 2rem)",fontSize:e.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.25rem)",paddingInline:"0.75rem"},t.size==="md"&&{"--Icon-fontSize":e.vars.fontSize.xl,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.5rem",minHeight:"var(--Button-minHeight, 2.25rem)",fontSize:e.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.375rem)",paddingInline:"1rem"},t.size==="lg"&&{"--Icon-fontSize":e.vars.fontSize.xl2,"--CircularProgress-size":"28px","--CircularProgress-thickness":"4px","--Button-gap":"0.75rem",minHeight:"var(--Button-minHeight, 2.75rem)",fontSize:e.vars.fontSize.md,paddingBlock:"var(--Button-paddingBlock, 0.5rem)",paddingInline:"1.5rem"},{WebkitTapHighlightColor:"transparent",boxSizing:"border-box",borderRadius:`var(--Button-radius, ${e.vars.radius.sm})`,margin:"var(--Button-margin)",border:"none",backgroundColor:"transparent",cursor:"pointer",userSelect:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",textDecoration:"none",fontFamily:e.vars.fontFamily.body,fontWeight:e.vars.fontWeight.lg,lineHeight:e.vars.lineHeight.md},t.fullWidth&&{width:"100%"},{[e.focus.selector]:e.focus.default}),ue({},(n=e.variants[t.variant])==null?void 0:n[t.color],{"&:hover":{"@media (hover: hover)":(r=e.variants[`${t.variant}Hover`])==null?void 0:r[t.color]},'&:active, &[aria-pressed="true"]':(i=e.variants[`${t.variant}Active`])==null?void 0:i[t.color],[`&.${o5.disabled}`]:(a=e.variants[`${t.variant}Disabled`])==null?void 0:a[t.color]},t.loadingPosition==="center"&&{[`&.${o5.loading}`]:{color:"transparent"}})]},moe=nn("button",{name:"JoyButton",slot:"Root",overridesResolver:(e,t)=>t.root})(Q8),eV=$.forwardRef(function(t,n){var r;const i=wr({props:t,name:"JoyButton"}),{children:a,action:c,color:o="primary",variant:f="solid",size:g="md",fullWidth:_=!1,startDecorator:x,endDecorator:M,loading:C=!1,loadingPosition:A="center",loadingIndicator:L,disabled:I,component:T,slots:z={},slotProps:k={}}=i,U=Un(i,uoe),H=$.useContext($3),V=$.useContext(V8),q=t.variant||H.variant||f,J=t.size||H.size||g,Y=t.color||H.color||o,N=(r=t.loading||t.disabled)!=null?r:H.disabled||C||I,ne=$.useRef(null),ye=Ur(ne,n),{focusVisible:ge,setFocusVisible:Ne,getRootProps:Ae}=Mc(ue({},i,{disabled:N,rootRef:ye})),ve=L??ee.jsx(V3,{color:Y,thickness:{sm:2,md:3,lg:4}[J]||3});$.useImperativeHandle(c,()=>({focusVisible:()=>{var Ct;Ne(!0),(Ct=ne.current)==null||Ct.focus()}}),[Ne]);const Se=ue({},i,{color:Y,fullWidth:_,variant:q,size:J,focusVisible:ge,loading:C,loadingPosition:A,disabled:N}),Me=hoe(Se),Ue=Ct=>{var un;let gn=i.onClick;if(typeof k.root=="function"?gn=k.root(Se).onClick:k.root&&(gn=k.root.onClick),(un=gn)==null||un(Ct),V){var hn;(hn=V.onClick)==null||hn.call(V,Ct,i.value)}};let Qe=i["aria-pressed"];typeof k.root=="function"?Qe=k.root(Se)["aria-pressed"]:k.root&&(Qe=k.root["aria-pressed"]),V!=null&&V.value&&(Array.isArray(V.value)?Qe=V.value.indexOf(i.value)!==-1:Qe=V.value===i.value);const st=ue({},U,{component:T,slots:z,slotProps:k}),[ct,Xt]=wn("root",{ref:n,className:Me.root,elementType:moe,externalForwardedProps:st,getSlotProps:Ae,ownerState:Se,additionalProps:{onClick:Ue,"aria-pressed":Qe}}),[je,lt]=wn("startDecorator",{className:Me.startDecorator,elementType:doe,externalForwardedProps:st,ownerState:Se}),[Ot,ut]=wn("endDecorator",{className:Me.endDecorator,elementType:foe,externalForwardedProps:st,ownerState:Se}),[ot,Tt]=wn("loadingIndicatorCenter",{className:Me.loadingIndicatorCenter,elementType:poe,externalForwardedProps:st,ownerState:Se});return ee.jsxs(ct,ue({},Xt,{children:[(x||C&&A==="start")&&ee.jsx(je,ue({},lt,{children:C&&A==="start"?ve:x})),a,C&&A==="center"&&ee.jsx(ot,ue({},Tt,{children:ve})),(M||C&&A==="end")&&ee.jsx(Ot,ue({},ut,{children:C&&A==="end"?ve:M}))]}))});eV.muiName="Button";function goe(e){return br("MuiCard",e)}gr("MuiCard",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","horizontal","vertical"]);const voe=["className","color","component","invertedColors","size","variant","children","orientation","slots","slotProps"],yoe=e=>{const{size:t,variant:n,color:r,orientation:i}=e,a={root:["root",i,n&&`variant${mn(n)}`,r&&`color${mn(r)}`,t&&`size${mn(t)}`]};return yr(a,goe,{})},_oe=nn("div")(({theme:e,ownerState:t})=>{var n;const{p:r,padding:i,borderRadius:a}=Wf({theme:e,ownerState:t},["p","padding","borderRadius"]);return[ue({"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,"--Card-childRadius":"max((var(--Card-radius) - var(--variant-borderWidth, 0px)) - var(--Card-padding), min(var(--Card-padding) / 2, (var(--Card-radius) - var(--variant-borderWidth, 0px)) / 2))","--AspectRatio-radius":"var(--Card-childRadius)","--unstable_actionMargin":"calc(-1 * var(--variant-borderWidth, 0px))","--unstable_actionRadius":"var(--Card-radius)","--CardCover-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--CardOverflow-offset":"calc(-1 * var(--Card-padding))","--CardOverflow-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--Divider-inset":"calc(-1 * var(--Card-padding))"},t.size==="sm"&&{"--Card-radius":e.vars.radius.sm,"--Card-padding":"0.625rem",gap:"0.5rem"},t.size==="md"&&{"--Card-radius":e.vars.radius.md,"--Card-padding":"1rem",gap:"0.75rem 1rem"},t.size==="lg"&&{"--Card-radius":e.vars.radius.lg,"--Card-padding":"1.5rem",gap:"1rem 1.5rem"},{padding:"var(--Card-padding)",borderRadius:"var(--Card-radius)",backgroundColor:e.vars.palette.background.surface,position:"relative",display:"flex",flexDirection:t.orientation==="horizontal"?"row":"column"},e.typography[`body-${t.size}`],t.variant==="solid"&&t.color&&t.invertedColors&&j_(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&H_(t.color)(e),(n=e.variants[t.variant])==null?void 0:n[t.color]),r!==void 0&&{"--Card-padding":r},i!==void 0&&{"--Card-padding":i},a!==void 0&&{"--Card-radius":a}]}),xoe=nn(_oe,{name:"JoyCard",slot:"Root",overridesResolver:(e,t)=>t.root})({}),MA=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyCard"}),{className:i,color:a="neutral",component:c="div",invertedColors:o=!1,size:f="md",variant:g="outlined",children:_,orientation:x="vertical",slots:M={},slotProps:C={}}=r,A=Un(r,voe),L=ue({},r,{color:a,component:c,orientation:x,size:f,variant:g,invertedColors:o}),I=yoe(L),T=ue({},A,{component:c,slots:M,slotProps:C}),[z,k]=wn("root",{ref:n,className:xi(I.root,i),elementType:xoe,externalForwardedProps:T,ownerState:L});return ee.jsx(z,ue({},k,{children:$.Children.map(_,(U,H)=>{if(!$.isValidElement(U))return U;const V={};if(IR(U,["Divider"])){var q,J;const Y=U.props;V.inset=(q=Y==null?void 0:Y.inset)!=null?q:"context";const N=x==="vertical"?"horizontal":"vertical";V.orientation=(J=Y==null?void 0:Y.orientation)!=null?J:N}return H===0&&(V["data-first-child"]=""),H===$.Children.count(_)-1&&(V["data-last-child"]=""),$.cloneElement(U,V)})}))}),tV=gr("MuiCardOverflow",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);function boe(e){return br("MuiDivider",e)}gr("MuiDivider",["root","horizontal","vertical","insetContext","insetNone"]);const nV=nn("div")(({ownerState:e})=>({display:"flex",flexDirection:e.orientation==="horizontal"?"row":"column",flex:9999,zIndex:1,columnGap:"var(--Card-padding)",rowGap:"max(2px, calc(0.1875 * var(--Card-padding)))",padding:"var(--unstable_padding)",[`.${tV.root} > &`]:{"--unstable_padding":"calc(var(--Card-padding) * 0.75) 0px"}}));nn(nV,{name:"JoyCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})({});const woe=gr("MuiModalDialog",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","layoutCenter","layoutFullscreen"]);function Soe(e){return br("MuiCheckbox",e)}const Ef=gr("MuiCheckbox",["root","checkbox","action","input","label","checked","disabled","focusVisible","indeterminate","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantOutlined","variantSoft","variantSolid"]),Moe=Hg(ee.jsx("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L9 16.17z"}),"Check"),Coe=Hg(ee.jsx("path",{d:"M19 13H5c-.55 0-1-.45-1-1s.45-1 1-1h14c.55 0 1 .45 1 1s-.45 1-1 1z"}),"HorizontalRule"),Eoe=["checked","uncheckedIcon","checkedIcon","label","defaultChecked","disabled","disableIcon","overlay","id","indeterminate","indeterminateIcon","name","onBlur","onChange","onFocus","onFocusVisible","readOnly","required","value","color","variant","size","component","slots","slotProps"],Toe=e=>{const{checked:t,disabled:n,disableIcon:r,focusVisible:i,color:a,variant:c,size:o,indeterminate:f}=e,g={root:["root",t&&"checked",n&&"disabled",i&&"focusVisible",c&&`variant${mn(c)}`,a&&`color${mn(a)}`,o&&`size${mn(o)}`],checkbox:["checkbox",t&&"checked",f&&"indeterminate",n&&"disabled"],action:["action",t&&"checked",r&&n&&"disabled",i&&"focusVisible"],input:["input"],label:["label"]};return yr(g,Soe,{})},Poe=nn("span",{name:"JoyCheckbox",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var n,r,i;return ue({"--Icon-fontSize":"var(--Checkbox-size)"},e.size==="sm"&&{"--Checkbox-size":"1rem","& ~ *":{"--FormHelperText-margin":"0 0 0 1.5rem"},fontSize:t.vars.fontSize.sm,gap:"var(--Checkbox-gap, 0.5rem)"},e.size==="md"&&{"--Checkbox-size":"1.25rem","& ~ *":{"--FormHelperText-margin":"0.25rem 0 0 1.875rem"},fontSize:t.vars.fontSize.md,gap:"var(--Checkbox-gap, 0.625rem)"},e.size==="lg"&&{"--Checkbox-size":"1.5rem","& ~ *":{"--FormHelperText-margin":"0.375rem 0 0 2.25rem"},fontSize:t.vars.fontSize.lg,gap:"var(--Checkbox-gap, 0.75rem)"},{position:e.overlay?"initial":"relative",display:"inline-flex",fontFamily:t.vars.fontFamily.body,lineHeight:"var(--Checkbox-size)",color:t.vars.palette.text.primary,[`&.${Ef.disabled}`]:{color:(n=t.variants.plainDisabled)==null||(n=n[e.color])==null?void 0:n.color}},e.disableIcon&&{color:(r=t.variants[e.variant])==null||(r=r[e.color])==null?void 0:r.color,[`&.${Ef.disabled}`]:{color:(i=t.variants[`${e.variant}Disabled`])==null||(i=i[e.color])==null?void 0:i.color}})}),Aoe=nn("span",{name:"JoyCheckbox",slot:"Checkbox",overridesResolver:(e,t)=>t.checkbox})(({theme:e,ownerState:t})=>{var n,r,i,a,c;const o=(n=e.variants[`${t.variant}`])==null?void 0:n[t.color];return[ue({"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,boxSizing:"border-box",borderRadius:`min(${e.vars.radius.sm}, 0.25rem)`,width:"var(--Checkbox-size)",height:"var(--Checkbox-size)",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},t.disableIcon&&{display:"contents"},{[`&.${Ef.checked}, &.${Ef.indeterminate}`]:{"--Icon-color":"currentColor"}}),...t.disableIcon?[]:[ue({},o,{backgroundColor:(r=o==null?void 0:o.backgroundColor)!=null?r:e.vars.palette.background.surface}),{"&:hover":{"@media (hover: hover)":(i=e.variants[`${t.variant}Hover`])==null?void 0:i[t.color]}},{"&:active":(a=e.variants[`${t.variant}Active`])==null?void 0:a[t.color]},{[`&.${Ef.disabled}`]:(c=e.variants[`${t.variant}Disabled`])==null?void 0:c[t.color]}]]}),Ioe=nn("span",{name:"JoyCheckbox",slot:"Action",overridesResolver:(e,t)=>t.action})(({theme:e,ownerState:t})=>{var n,r,i,a;return[{borderRadius:`var(--Checkbox-actionRadius, ${t.overlay?"var(--unstable_actionRadius, inherit)":"inherit"})`,textAlign:"left",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))",bottom:"calc(-1 * var(--variant-borderWidth, 0px))",right:"calc(-1 * var(--variant-borderWidth, 0px))",zIndex:1,[e.focus.selector]:e.focus.default},...t.disableIcon?[(n=e.variants[t.variant])==null?void 0:n[t.color],{"&:hover":(r=e.variants[`${t.variant}Hover`])==null?void 0:r[t.color]},{"&:active":(i=e.variants[`${t.variant}Active`])==null?void 0:i[t.color]},{[`&.${Ef.disabled}`]:(a=e.variants[`${t.variant}Disabled`])==null?void 0:a[t.color]}]:[]]}),Roe=nn("input",{name:"JoyCheckbox",slot:"Input",overridesResolver:(e,t)=>t.input})(()=>({margin:0,opacity:0,position:"absolute",width:"100%",height:"100%",cursor:"pointer"})),Loe=nn("label",{name:"JoyCheckbox",slot:"Label",overridesResolver:(e,t)=>t.label})(({ownerState:e})=>ue({flex:1,minWidth:0},e.disableIcon&&{zIndex:1,pointerEvents:"none"})),koe=ee.jsx(Moe,{}),Doe=ee.jsx(Coe,{}),Of=$.forwardRef(function(t,n){var r,i,a,c,o;const f=wr({props:t,name:"JoyCheckbox"}),{checked:g,uncheckedIcon:_,checkedIcon:x=koe,label:M,defaultChecked:C,disabled:A,disableIcon:L=!1,overlay:I,id:T,indeterminate:z=!1,indeterminateIcon:k=Doe,name:U,onBlur:H,onChange:V,onFocus:q,onFocusVisible:J,readOnly:Y,required:N,value:ne,color:ye,variant:ge,size:Ne="md",component:Ae,slots:ve={},slotProps:Se={}}=f,Me=Un(f,Eoe),Ue=$.useContext(FM),Qe=(r=(i=t.disabled)!=null?i:Ue==null?void 0:Ue.disabled)!=null?r:A,st=(a=(c=t.size)!=null?c:Ue==null?void 0:Ue.size)!=null?a:Ne,ct=qs(T??(Ue==null?void 0:Ue.htmlFor)),Xt={checked:g,defaultChecked:C,disabled:Qe,onBlur:H,onChange:V,onFocus:q,onFocusVisible:J},{getInputProps:je,checked:lt,disabled:Ot,focusVisible:ut}=Qne(Xt),ot=lt||z,un=ot?ge||"solid":ge||"outlined",gn=t.color||(Ue!=null&&Ue.error?"danger":(o=Ue==null?void 0:Ue.color)!=null?o:ye),vn=ue({},f,{checked:lt,disabled:Ot,disableIcon:L,overlay:I,focusVisible:ut,color:ot?gn||"primary":gn||"neutral",variant:un,size:st}),Ut=Toe(vn),tn=ue({},Me,{component:Ae,slots:ve,slotProps:Se}),[Dt,An]=wn("root",{ref:n,className:Ut.root,elementType:Poe,externalForwardedProps:tn,ownerState:vn}),[an,Le]=wn("checkbox",{className:Ut.checkbox,elementType:Aoe,externalForwardedProps:tn,ownerState:vn}),[me,it]=wn("action",{className:Ut.action,elementType:Ioe,externalForwardedProps:tn,ownerState:vn}),[St,It]=wn("input",{additionalProps:ue({id:ct,name:U,value:ne,readOnly:Y,role:void 0,required:N??(Ue==null?void 0:Ue.required),"aria-describedby":Ue==null?void 0:Ue["aria-describedby"]},z&&{"aria-checked":"mixed"}),className:Ut.input,elementType:Roe,externalForwardedProps:tn,getSlotProps:je,ownerState:vn}),[wt,Zt]=wn("label",{additionalProps:{htmlFor:ct},className:Ut.label,elementType:Loe,externalForwardedProps:tn,ownerState:vn});let Lt=_;return L?Lt=null:z?Lt=k:lt&&(Lt=x),ee.jsxs(Dt,ue({},An,{children:[ee.jsxs(an,ue({},Le,{children:[ee.jsx(me,ue({},it,{children:ee.jsx(St,ue({},It))})),Lt]})),M&&ee.jsx(SA.Provider,{value:!0,children:ee.jsx(wt,ue({},Zt,{children:M}))})]}))});function zoe(e){const{children:t,disableColorScheme:n=!1}=e;return ee.jsxs($.Fragment,{children:[ee.jsx(xJ,{styles:r=>{var i,a;const c={};n||Object.entries(r.colorSchemes).forEach(([f,g])=>{var _;c[r.getColorSchemeSelector(f).replace(/\s*&/,"")]={colorScheme:(_=g.palette)==null?void 0:_.mode}});const o=(i=(a=r.components)==null||(a=a.JoyTypography)==null||(a=a.defaultProps)==null?void 0:a.level)!=null?i:"body-md";return ue({html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:r.vars.fontWeight.lg},body:ue({margin:0,color:r.vars.palette.text.primary,fontFamily:r.vars.fontFamily.body},r.typography[o],{backgroundColor:r.vars.palette.background.body,"@media print":{backgroundColor:r.vars.palette.common.white},"&::backdrop":{backgroundColor:r.vars.palette.background.backdrop}})},c)},defaultTheme:Ug}),t]})}function Ooe(e){return br("MuiDialogContent",e)}gr("MuiDialogContent",["root"]);const NM=$.createContext(void 0);function Foe(e){return br("MuiDialogTitle",e)}const rV=gr("MuiDialogTitle",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]),Noe=["component","children","orientation","slots","slotProps"],Boe=()=>yr({root:["root"]},Ooe,{}),Uoe=nn(nV,{name:"JoyDialogContent",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({color:`var(--DialogContent-color, ${e.vars.palette.text.tertiary})`,overflow:"auto",margin:"var(--unstable_DialogContent-margin)",[`.${woe.root} > .${rV.root} + &`]:{"--unstable_DialogContent-margin":"-0.375em 0 0 0"}})),iV=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyDialogContent"}),i=$.useContext(NM),{component:a="div",children:c,orientation:o="vertical",slots:f={},slotProps:g={}}=r,_=Un(r,Noe),x=ue({},_,{component:a,slots:f,slotProps:g}),M=ue({},r,{component:a,orientation:o}),C=Boe(),[A,L]=wn("root",{ref:n,className:C.root,elementType:Uoe,externalForwardedProps:x,ownerState:M,additionalProps:{id:i==null?void 0:i.describedBy}});return ee.jsx(A,ue({},L,{children:c}))}),j3=$.createContext(void 0),$oe=["component","children","variant","color","level","slots","slotProps"],Voe=e=>{const{level:t,color:n,variant:r}=e,i={root:["root",t,n&&`color${mn(n)}`,r&&`variant${mn(r)}`]};return yr(i,Foe,{})},joe=nn("h2",{name:"JoyDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r;const i=t.level!=="inherit"?(n=e.typography[t.level])==null?void 0:n.lineHeight:"1";return ue({"--Icon-fontSize":`calc(1em * ${i})`},t.color&&{"--Icon-color":"currentColor"},{display:"flex",gap:"clamp(4px, 0.375em, 0.75rem)",margin:"var(--unstable_DialogTitle-margin, 0px)"},t.level&&t.level!=="inherit"&&e.typography[t.level],{color:"inherit"},t.variant&&ue({borderRadius:e.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},(r=e.variants[t.variant])==null?void 0:r[t.color]),{[`.${tV.root} > &`]:{"--unstable_DialogTitle-margin":"var(--Card-padding) 0"}})}),Hoe={sm:"title-md",md:"title-lg",lg:"h4"},oV=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyDialogTitle"}),i=$.useContext(j3),a=$.useContext(NM),{component:c="h2",children:o,variant:f,color:g,level:_=Hoe[i||"md"],slots:x={},slotProps:M={}}=r,C=Un(r,$oe),A=t.color||(f?g??"neutral":g),L=ue({},C,{component:c,slots:x,slotProps:M}),I=ue({},r,{component:c,color:A,variant:f,level:_}),T=Voe(I),[z,k]=wn("root",{ref:n,className:T.root,elementType:joe,externalForwardedProps:L,ownerState:I,additionalProps:{id:a==null?void 0:a.labelledBy}});return ee.jsx(z,ue({},k,{children:o}))}),Goe=["className","children","component","inset","orientation","role","slots","slotProps"],Woe=e=>{const{orientation:t,inset:n}=e,r={root:["root",t,n&&`inset${mn(n)}`]};return yr(r,boe,{})},sV=nn("hr",{name:"JoyDivider",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>ue({"--Divider-thickness":"1px","--Divider-lineColor":e.vars.palette.divider},t.inset==="none"&&{"--_Divider-inset":"0px"},t.inset==="context"&&{"--_Divider-inset":"var(--Divider-inset, 0px)"},{margin:"initial",marginInline:t.orientation==="vertical"?"initial":"var(--_Divider-inset)",marginBlock:t.orientation==="vertical"?"var(--_Divider-inset)":"initial",position:"relative",alignSelf:"stretch",flexShrink:0},t.children?ue({"--Divider-gap":e.spacing(1),"--Divider-childPosition":"50%",display:"flex",flexDirection:t.orientation==="vertical"?"column":"row",alignItems:"center",whiteSpace:"nowrap",textAlign:"center",border:0},e.typography["body-sm"],{"&::before, &::after":{position:"relative",inlineSize:t.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:t.orientation==="vertical"?"initial":"var(--Divider-thickness)",backgroundColor:"var(--Divider-lineColor)",content:'""'},"&::before":{marginInlineEnd:t.orientation==="vertical"?"initial":"min(var(--Divider-childPosition) * 999, var(--Divider-gap))",marginBlockEnd:t.orientation==="vertical"?"min(var(--Divider-childPosition) * 999, var(--Divider-gap))":"initial",flexBasis:"var(--Divider-childPosition)"},"&::after":{marginInlineStart:t.orientation==="vertical"?"initial":"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))",marginBlockStart:t.orientation==="vertical"?"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))":"initial",flexBasis:"calc(100% - var(--Divider-childPosition))"}}):{border:"none",listStyle:"none",backgroundColor:"var(--Divider-lineColor)",inlineSize:t.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:t.orientation==="vertical"?"initial":"var(--Divider-thickness)"})),a_=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyDivider"}),{className:i,children:a,component:c=a!=null?"div":"hr",inset:o,orientation:f="horizontal",role:g=c!=="hr"?"separator":void 0,slots:_={},slotProps:x={}}=r,M=Un(r,Goe),C=ue({},r,{inset:o,role:g,orientation:f,component:c}),A=Woe(C),L=ue({},M,{component:c,slots:_,slotProps:x}),[I,T]=wn("root",{ref:n,className:xi(A.root,i),elementType:sV,externalForwardedProps:L,ownerState:C,additionalProps:ue({as:c,role:g},g==="separator"&&f==="vertical"&&{"aria-orientation":"vertical"})});return ee.jsx(I,ue({},T,{children:a}))});a_.muiName="Divider";const aV=$.createContext(void 0),lV=nn("div")(({ownerState:e,theme:t})=>ue({"--unstable_popup-zIndex":`calc(${t.vars.zIndex.modal} + 1)`,'& ~ [role="listbox"]':{"--unstable_popup-zIndex":`calc(${t.vars.zIndex.modal} + 1)`},position:"fixed",zIndex:t.vars.zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&{visibility:"hidden"}));nn(lV,{name:"JoyModal",slot:"Root",overridesResolver:(e,t)=>t.root})({});const cV=nn("div")(({theme:e})=>({zIndex:-1,position:"fixed",right:0,bottom:0,top:0,left:0,backgroundColor:e.vars.palette.background.backdrop,WebkitTapHighlightColor:"transparent",backdropFilter:"blur(8px)"}));nn(cV,{name:"JoyModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({});function qoe(e){return br("MuiDrawer",e)}gr("MuiDrawer",["root","hidden","backdrop","content","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const Xoe=["children","anchor","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","color","variant","invertedColors","size","onClose","onKeyDown","open","component","slots","slotProps"],Zoe=e=>{const{open:t,variant:n,color:r,size:i}=e,a={root:["root",!t&&"hidden",n&&`variant${mn(n)}`,r&&`color${mn(r)}`,i&&`size${mn(i)}`],backdrop:["backdrop"],content:["content"]};return yr(a,qoe,{})},Yoe=nn(lV,{name:"JoyDrawer",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>ue({"--Drawer-transitionDuration":"0.3s","--Drawer-transitionFunction":"ease","--ModalClose-radius":"max((var(--Drawer-contentRadius) - var(--variant-borderWidth, 0px)) - var(--ModalClose-inset), min(var(--ModalClose-inset) / 2, (var(--Drawer-contentRadius) - var(--variant-borderWidth, 0px)) / 2))"},e.size==="sm"&&{"--ModalClose-inset":"0.5rem","--Drawer-verticalSize":"clamp(350px, 30%, 100%)","--Drawer-horizontalSize":"clamp(256px, 20%, 100%)","--Drawer-titleMargin":"0.625rem 0.75rem calc(0.625rem / 2)"},e.size==="md"&&{"--ModalClose-inset":"0.5rem","--Drawer-verticalSize":"clamp(400px, 45%, 100%)","--Drawer-horizontalSize":"clamp(300px, 30%, 100%)","--Drawer-titleMargin":"0.75rem 0.75rem calc(0.75rem / 2)"},e.size==="lg"&&{"--ModalClose-inset":"0.75rem","--Drawer-verticalSize":"clamp(500px, 60%, 100%)","--Drawer-horizontalSize":"clamp(440px, 60%, 100%)","--Drawer-titleMargin":"1rem 1rem calc(1rem / 2)"},{transitionProperty:"visibility",transitionDelay:e.open?"0s":"var(--Drawer-transitionDuration)"},!e.open&&{visibility:"hidden"})),Koe=nn(cV,{name:"JoyDrawer",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})(({ownerState:e})=>({opacity:e.open?1:0,transition:"opacity var(--Drawer-transitionDuration) ease-in-out"})),Joe=nn("div",{name:"JoyDrawer",slot:"Content",overridesResolver:(e,t)=>t.content})(({theme:e,ownerState:t})=>{var n;return ue({},e.typography[`body-${t.size}`],{boxShadow:e.shadow.md,backgroundColor:e.vars.palette.background.surface,outline:0,display:"flex",flexDirection:"column",position:"fixed",boxSizing:"border-box",overflow:"auto"},t.anchor==="left"&&{top:0,left:0,transform:t.open?"translateX(0)":"translateX(-100%)"},t.anchor==="right"&&{top:0,right:0,transform:t.open?"translateX(0)":"translateX(100%)"},t.anchor==="top"&&{top:0,transform:t.open?"translateY(0)":"translateY(-100%)"},t.anchor==="bottom"&&{bottom:0,transform:t.open?"translateY(0)":"translateY(100%)"},{height:t.anchor.match(/(left|right)/)?"100%":"min(100vh, var(--Drawer-verticalSize))",width:t.anchor.match(/(top|bottom)/)?"100vw":"min(100vw, var(--Drawer-horizontalSize))",transition:"transform var(--Drawer-transitionDuration) var(--Drawer-transitionFunction)"},t.variant==="solid"&&t.color&&t.invertedColors&&j_(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&H_(t.color)(e),(n=e.variants[t.variant])==null?void 0:n[t.color],{[`& > .${rV.root}`]:{"--unstable_DialogTitle-margin":"var(--Drawer-titleMargin)"}})}),uV=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyDrawer"}),{children:i,anchor:a="left",container:c,disableAutoFocus:o=!1,disableEnforceFocus:f=!1,disableEscapeKeyDown:g=!1,disablePortal:_=!1,disableRestoreFocus:x=!1,disableScrollLock:M=!1,hideBackdrop:C=!1,color:A="neutral",variant:L="plain",invertedColors:I=!1,size:T="md",onClose:z,open:k,component:U,slots:H={},slotProps:V={}}=r,q=Un(r,Xoe),J=ue({},r,{anchor:a,disableAutoFocus:o,disableEnforceFocus:f,disableEscapeKeyDown:g,disablePortal:_,disableRestoreFocus:x,disableScrollLock:M,hideBackdrop:C,invertedColors:I,color:A,variant:L,size:T}),{getRootProps:Y,getBackdropProps:N,rootRef:ne,portalRef:ye,isTopModal:ge}=Ite(ue({},J,{rootRef:n,children:null})),Ne=Zoe(J),Ae=ue({},q,{component:U,slots:H,slotProps:V}),ve=qs(),Se=qs(),Me=$.useMemo(()=>({variant:L,color:A,labelledBy:ve,describedBy:Se}),[A,L,ve,Se]),[Ue,Qe]=wn("root",{ref:ne,className:Ne.root,elementType:Yoe,externalForwardedProps:Ae,getSlotProps:Y,ownerState:J}),[st,ct]=wn("backdrop",{className:Ne.backdrop,elementType:Koe,externalForwardedProps:Ae,getSlotProps:N,ownerState:J}),[Xt,je]=wn("content",{className:Ne.content,elementType:Joe,additionalProps:{tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":ve,"aria-describedby":Se},externalForwardedProps:Ae,ownerState:J});return ee.jsx(aV.Provider,{value:z,children:ee.jsx(j3.Provider,{value:T,children:ee.jsx(NM.Provider,{value:Me,children:ee.jsx(w8,{ref:ye,container:c,disablePortal:_,children:ee.jsxs(Ue,ue({},Qe,{children:[C?null:ee.jsx(st,ue({},ct)),ee.jsx($J,{disableEnforceFocus:f,disableAutoFocus:o,disableRestoreFocus:x,isEnabled:ge,open:k,children:ee.jsx(Xt,ue({},je,{children:i}))})]}))})})})})});function Qoe(e){return br("MuiListDivider",e)}gr("MuiListDivider",["root","insetGutter","insetStartDecorator","insetStartContent","horizontal","vertical"]);const ese=["component","role","className","children","inset","orientation","slots","slotProps"],tse=e=>{const{orientation:t,inset:n}=e,r={root:["root",t,n&&n!=="context"&&`inset${mn(n)}`]};return yr(r,Qoe,{})},nse=nn(sV,{name:"JoyListDivider",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>ue({},e.inset==="context"&&{"--Divider-inset":"calc(-1 * var(--List-padding))"},e.row&&ue({marginInline:"var(--ListDivider-gap)"},e.inset==="gutter"&&{marginBlock:"var(--ListItem-paddingY)"},e["data-first-child"]===void 0&&{marginInlineStart:"calc(var(--List-gap) + var(--ListDivider-gap))"}),!e.row&&ue({},e["data-first-child"]===void 0&&{marginBlockStart:"calc(var(--List-gap) + var(--ListDivider-gap))"},{marginBlockEnd:"var(--ListDivider-gap)"},e.inset==="gutter"&&{marginInlineStart:"var(--ListItem-paddingLeft)",marginInlineEnd:"var(--ListItem-paddingRight)"},e.inset==="startDecorator"&&{marginInlineStart:"var(--ListItem-paddingLeft)"},e.inset==="startContent"&&{marginInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItemDecorator-size))"}))),CA=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyListDivider"}),i=$.useContext(jg),a=$.useContext(N3),{component:c,role:o,className:f,children:g,inset:_="context",orientation:x,slots:M={},slotProps:C={}}=r,A=Un(r,ese),[L]=(a==null?void 0:a.split(":"))||["",""],I=c||(L&&!L.match(/^(ul|ol|menu)$/)?"div":"li"),T=o||(I==="li"?"separator":void 0),z=x||(i?"vertical":"horizontal"),k=ue({},r,{inset:_,row:i,orientation:z,component:I,role:T}),U=tse(k),H=ue({},A,{component:I,slots:M,slotProps:C}),[V,q]=wn("root",{ref:n,className:xi(U.root,f),elementType:nse,externalForwardedProps:H,ownerState:k,additionalProps:ue({as:I,role:T},T==="separator"&&z==="vertical"&&{"aria-orientation":"vertical"})});return ee.jsx(V,ue({},q,{children:g}))});function rse(e){return br("MuiListItemContent",e)}gr("MuiListItemContent",["root"]);const ise=["component","className","children","slots","slotProps"],ose=()=>yr({root:["root"]},rse,{}),sse=nn("div",{name:"JoyListItemContent",slot:"Root",overridesResolver:(e,t)=>t.root})({flex:"1 1 auto",minWidth:0}),l_=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyListItemContent"}),{component:i,className:a,children:c,slots:o={},slotProps:f={}}=r,g=Un(r,ise),_=ue({},r),x=ose(),M=ue({},g,{component:i,slots:o,slotProps:f}),[C,A]=wn("root",{ref:n,className:xi(x.root,a),elementType:sse,externalForwardedProps:M,ownerState:_});return ee.jsx(C,ue({},A,{children:c}))});function ase(e){return br("MuiListItemDecorator",e)}gr("MuiListItemDecorator",["root"]);const lse=["component","className","children","slots","slotProps"],cse=()=>yr({root:["root"]},ase,{}),use=nn("span",{name:"JoyListItemDecorator",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>ue({boxSizing:"border-box",display:"inline-flex",alignItems:`var(--unstable_ListItemDecorator-alignItems, ${e.parentOrientation==="horizontal"?"center":"initial"})`},e.parentOrientation==="horizontal"?{minInlineSize:"var(--ListItemDecorator-size)",marginInlineEnd:"calc(-1 * var(--ListItem-gap))"}:{minBlockSize:"var(--ListItemDecorator-size)",justifyContent:"center",marginBlockEnd:"calc(-1 * var(--ListItem-gap))"})),tg=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyListItemDecorator"}),{component:i,className:a,children:c,slots:o={},slotProps:f={}}=r,g=Un(r,lse),_=$.useContext(B3),x=ue({parentOrientation:_},r),M=cse(),C=ue({},g,{component:i,slots:o,slotProps:f}),[A,L]=wn("root",{ref:n,className:xi(M.root,a),elementType:use,externalForwardedProps:C,ownerState:x});return ee.jsx(A,ue({},L,{children:c}))});function hse(e){return br("MuiMenu",e)}gr("MuiMenu",["root","listbox","expanded","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const dse=["actions","children","color","component","disablePortal","keepMounted","id","invertedColors","onItemsChange","modifiers","variant","size","slots","slotProps"],fse=e=>{const{open:t,variant:n,color:r,size:i}=e,a={root:["root",t&&"expanded",n&&`variant${mn(n)}`,r&&`color${mn(r)}`,i&&`size${mn(i)}`],listbox:["listbox"]};return yr(a,hse,{})},s5=nn($_,{name:"JoyMenu",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r;const i=(n=e.variants[t.variant])==null?void 0:n[t.color];return[ue({"--focus-outline-offset":`calc(${e.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":(i==null?void 0:i.backgroundColor)||(i==null?void 0:i.background)||e.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},kM,{borderRadius:`var(--List-radius, ${e.vars.radius.sm})`,boxShadow:e.shadow.md,overflow:"auto",zIndex:`var(--unstable_popup-zIndex, ${e.vars.zIndex.popup})`},!(i!=null&&i.backgroundColor)&&{backgroundColor:e.vars.palette.background.popup},t.variant==="solid"&&t.color&&t.invertedColors&&j_(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&H_(t.color)(e),(r=e.variants[t.variant])==null?void 0:r[t.color])]}),hV=$.forwardRef(function(t,n){var r;const i=wr({props:t,name:"JoyMenu"}),{actions:a,children:c,color:o="neutral",component:f,disablePortal:g=!1,keepMounted:_=!1,id:x,invertedColors:M=!1,onItemsChange:C,modifiers:A,variant:L="outlined",size:I="md",slots:T={},slotProps:z={}}=i,k=Un(i,dse),{contextValue:U,getListboxProps:H,dispatch:V,open:q,triggerElement:J}=hQ({onItemsChange:C,id:x,listboxRef:n});$.useImperativeHandle(a,()=>({dispatch:V,resetHighlight:()=>V({type:Xr.resetHighlight,event:null})}),[V]);const Y=ue({},i,{disablePortal:g,invertedColors:M,color:o,variant:L,size:I,open:q,nesting:!1,row:!1}),N=fse(Y),ne=ue({},k,{component:f,slots:T,slotProps:z}),ye=$.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...A||[]],[A]),ge=fU({elementType:s5,getSlotProps:H,externalForwardedProps:ne,externalSlotProps:{},ownerState:Y,additionalProps:{anchorEl:J,open:q&&J!==null,disablePortal:g,keepMounted:_,modifiers:ye},className:N.root});return ee.jsx(s5,ue({},ge,!((r=i.slots)!=null&&r.root)&&{as:IM,slots:{root:f||"ul"}},{children:ee.jsx(dQ,{value:U,children:ee.jsx(OM,{variant:M?void 0:L,color:o,children:ee.jsx(LM.Provider,{value:"menu",children:ee.jsx(U_,{nested:!0,children:c})})})})}))});function pse(e){return br("MuiMenuButton",e)}gr("MuiMenuButton",["root","colorPrimary","colorNeutral","colorDanger","colorInfo","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]);const mse=["children","color","component","disabled","endDecorator","loading","loadingPosition","loadingIndicator","size","slotProps","slots","startDecorator","variant"],gse=e=>{const{color:t,disabled:n,fullWidth:r,size:i,variant:a,loading:c}=e,o={root:["root",n&&"disabled",r&&"fullWidth",a&&`variant${mn(a)}`,t&&`color${mn(t)}`,i&&`size${mn(i)}`,c&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]};return yr(o,pse,{})},vse=nn("button",{name:"JoyMenuButton",slot:"Root",overridesResolver:(e,t)=>t.root})(Q8),yse=nn("span",{name:"JoyMenuButton",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),_se=nn("span",{name:"JoyMenuButton",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),xse=nn("span",{name:"JoyMenuButton",slot:"LoadingCenter",overridesResolver:(e,t)=>t.loadingIndicatorCenter})(({theme:e,ownerState:t})=>{var n,r;return ue({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=e.variants[t.variant])==null||(n=n[t.color])==null?void 0:n.color},t.disabled&&{color:(r=e.variants[`${t.variant}Disabled`])==null||(r=r[t.color])==null?void 0:r.color})}),bse=$.forwardRef(function(t,n){var r;const i=wr({props:t,name:"JoyMenuButton"}),{children:a,color:c="neutral",component:o,disabled:f=!1,endDecorator:g,loading:_=!1,loadingPosition:x="center",loadingIndicator:M,size:C="md",slotProps:A={},slots:L={},startDecorator:I,variant:T="outlined"}=i,z=Un(i,mse),k=$.useContext($3),U=t.variant||k.variant||T,H=t.size||k.size||C,V=(r=t.disabled)!=null?r:k.disabled||f||_,{getRootProps:q,open:J,active:Y}=vte({rootRef:n,disabled:V}),N=M??ee.jsx(V3,{color:c,thickness:{sm:2,md:3,lg:4}[H]||3}),ne=ue({},i,{active:Y,color:c,disabled:V,open:J,size:H,variant:U}),ye=gse(ne),ge=ue({},z,{component:o,slots:L,slotProps:A}),[Ne,Ae]=wn("root",{elementType:vse,getSlotProps:q,externalForwardedProps:ge,ref:n,ownerState:ne,className:ye.root}),[ve,Se]=wn("startDecorator",{className:ye.startDecorator,elementType:yse,externalForwardedProps:ge,ownerState:ne}),[Me,Ue]=wn("endDecorator",{className:ye.endDecorator,elementType:_se,externalForwardedProps:ge,ownerState:ne}),[Qe,st]=wn("loadingIndicatorCenter",{className:ye.loadingIndicatorCenter,elementType:xse,externalForwardedProps:ge,ownerState:ne});return ee.jsxs(Ne,ue({},Ae,{children:[(I||_&&x==="start")&&ee.jsx(ve,ue({},Se,{children:_&&x==="start"?N:I})),a,_&&x==="center"&&ee.jsx(Qe,ue({},st,{children:N})),(g||_&&x==="end")&&ee.jsx(Me,ue({},Ue,{children:_&&x==="end"?N:g}))]}))});function wse(e){return br("MuiMenuItem",e)}gr("MuiMenuItem",["root","focusVisible","disabled","selected","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const Sse=["children","disabled","component","selected","color","orientation","variant","slots","slotProps","id"],Mse=e=>{const{focusVisible:t,disabled:n,selected:r,color:i,variant:a}=e,c={root:["root",t&&"focusVisible",n&&"disabled",r&&"selected",i&&`color${mn(i)}`,a&&`variant${mn(a)}`]};return yr(c,wse,{})},Cse=nn(V_,{name:"JoyMenuItem",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Ese=$.memo($.forwardRef(function(t,n){const r=wr({props:t,name:"JoyMenuItem"}),i=$.useContext(jg),{children:a,disabled:c=!1,component:o="li",selected:f=!1,color:g="neutral",orientation:_="horizontal",variant:x="plain",slots:M={},slotProps:C={},id:A}=r,L=Un(r,Sse),{variant:I=x,color:T=g}=zM(t.variant,t.color),{getRootProps:z,disabled:k,focusVisible:U}=xte({id:A,disabled:c,rootRef:n}),H=ue({},r,{component:o,color:T,disabled:k,focusVisible:U,orientation:_,selected:f,row:i,variant:I}),V=Mse(H),q=ue({},L,{component:o,slots:M,slotProps:C}),[J,Y]=wn("root",{ref:n,elementType:Cse,getSlotProps:z,externalForwardedProps:q,className:V.root,ownerState:H});return ee.jsx(B3.Provider,{value:_,children:ee.jsx(J,ue({},Y,{children:a}))})})),_f=$.forwardRef(function(t,n){const{contextValue:r,id:i}=bte(t.id);return ee.jsx(Jh.Provider,{value:r,children:ee.jsx(Ese,ue({},t,{id:i,ref:n}))})});function Tse(e){return br("MuiModalClose",e)}gr("MuiModalClose",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);var a5;const Pse=["component","color","variant","size","onClick","slots","slotProps"],Ase=e=>{const{variant:t,color:n,disabled:r,focusVisible:i,size:a}=e,c={root:["root",r&&"disabled",i&&"focusVisible",t&&`variant${mn(t)}`,n&&`color${mn(n)}`,a&&`size${mn(a)}`]};return yr(c,Tse,{})},Ise=nn(G_,{name:"JoyModalClose",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var n;return ue({},e.size==="sm"&&{"--IconButton-size":"1.75rem"},e.size==="md"&&{"--IconButton-size":"2rem"},e.size==="lg"&&{"--IconButton-size":"2.25rem"},{position:"absolute",zIndex:1,top:"var(--ModalClose-inset, 0.625rem)",right:"var(--ModalClose-inset, 0.625rem)",borderRadius:`var(--ModalClose-radius, ${t.vars.radius.sm})`},!((n=t.variants[e.variant])!=null&&(n=n[e.color])!=null&&n.backgroundColor)&&{color:t.vars.palette.text.secondary})}),Rse={plain:"plain",outlined:"plain",soft:"soft",solid:"solid"},dV=$.forwardRef(function(t,n){var r,i,a,c,o,f;const g=wr({props:t,name:"JoyModalClose"}),{component:_="button",color:x="neutral",variant:M="plain",size:C="md",onClick:A,slots:L={},slotProps:I={}}=g,T=Un(g,Pse),z=$.useContext(aV),k=$.useContext(NM),U=(r=(i=t.variant)!=null?i:Rse[k==null?void 0:k.variant])!=null?r:M,H=(a=(c=t.color)!=null?c:k==null?void 0:k.color)!=null?a:x,V=$.useContext(j3),q=(o=(f=t.size)!=null?f:V)!=null?o:C,{focusVisible:J,getRootProps:Y}=Mc(ue({},g,{rootRef:n})),N=ue({},g,{color:H,component:_,variant:U,size:q,focusVisible:J}),ne=Ase(N),[ye,ge]=wn("root",{ref:n,elementType:Ise,getSlotProps:Y,externalForwardedProps:ue({onClick:Ne=>{z==null||z(Ne,"closeClick"),A==null||A(Ne)}},T,{component:_,slots:L,slotProps:I}),className:ne.root,ownerState:N});return ee.jsx(ye,ue({},ge,{children:a5||(a5=ee.jsx(U8,{}))}))});function Lse(e){return br("MuiOption",e)}const kse=gr("MuiOption",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","highlighted","variantPlain","variantSoft","variantOutlined","variantSolid"]),Dse=["component","children","disabled","value","label","variant","color","slots","slotProps"],zse=e=>{const{disabled:t,highlighted:n,selected:r}=e;return yr({root:["root",t&&"disabled",n&&"highlighted",r&&"selected"]},Lse,{})},Ose=nn(V_,{name:"JoyOption",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n;const r=(n=e.variants[`${t.variant}Hover`])==null?void 0:n[t.color];return{[`&.${kse.highlighted}:not([aria-selected="true"])`]:{backgroundColor:r==null?void 0:r.backgroundColor}}}),Fse=$.memo($.forwardRef(function(t,n){var r;const i=wr({props:t,name:"JoyOption"}),{component:a="li",children:c,disabled:o=!1,value:f,label:g,variant:_="plain",color:x="neutral",slots:M={},slotProps:C={}}=i,A=Un(i,Dse),L=$.useContext(jg),{variant:I=_,color:T=x}=zM(t.variant,t.color),z=$.useRef(null),k=Ur(z,n),U=g??(typeof c=="string"?c:(r=z.current)==null?void 0:r.innerText),{getRootProps:H,selected:V,highlighted:q,index:J}=Rte({disabled:o,label:U,value:f,rootRef:k}),Y=ue({},i,{disabled:o,selected:V,highlighted:q,index:J,component:a,variant:I,color:T,row:L}),N=zse(Y),ne=ue({},A,{component:a,slots:M,slotProps:C}),[ye,ge]=wn("root",{ref:n,getSlotProps:H,elementType:Ose,externalForwardedProps:ne,className:N.root,ownerState:Y});return ee.jsx(ye,ue({},ge,{children:c}))})),Nse=$.forwardRef(function(t,n){const{contextValue:r}=Lte(t.value);return ee.jsx(Jh.Provider,{value:r,children:ee.jsx(Fse,ue({},t,{ref:n}))})}),Bse=Hg(ee.jsx("path",{d:"m12 5.83 2.46 2.46c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 3.7a.9959.9959 0 0 0-1.41 0L8.12 6.88c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 5.83zm0 12.34-2.46-2.46a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l3.17 3.18c.39.39 1.02.39 1.41 0l3.17-3.17c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L12 18.17z"}),"Unfold");function Use(e){return br("MuiSelect",e)}const ng=gr("MuiSelect",["root","button","indicator","startDecorator","endDecorator","popper","listbox","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","focusVisible","disabled","expanded","multiple"]);var l5;const $se=["action","autoFocus","children","defaultValue","defaultListboxOpen","disabled","getSerializedValue","placeholder","listboxId","listboxOpen","onChange","onListboxOpenChange","onClose","renderValue","required","value","size","variant","color","startDecorator","endDecorator","indicator","aria-describedby","aria-label","aria-labelledby","id","name","multiple","slots","slotProps"];function Vse(e){var t;return Array.isArray(e)?ee.jsx($.Fragment,{children:e.map(n=>n.label).join(", ")}):(t=e==null?void 0:e.label)!=null?t:""}const jse=[{name:"offset",options:{offset:[0,4]}},{name:"equalWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:e})=>{e.styles.popper.width=`${e.rects.reference.width}px`}}],Hse=e=>{const{color:t,disabled:n,focusVisible:r,size:i,variant:a,open:c,multiple:o}=e,f={root:["root",n&&"disabled",r&&"focusVisible",c&&"expanded",a&&`variant${mn(a)}`,t&&`color${mn(t)}`,i&&`size${mn(i)}`,o&&"multiple"],button:["button"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],indicator:["indicator",c&&"expanded"],listbox:["listbox",c&&"expanded",n&&"disabled"]};return yr(f,Use,{})},Gse=nn("div",{name:"JoySelect",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r,i,a,c;const o=(n=e.variants[`${t.variant}`])==null?void 0:n[t.color],{borderRadius:f}=Wf({theme:e,ownerState:t},["borderRadius"]);return[ue({"--Select-radius":e.vars.radius.sm,"--Select-gap":"0.5rem","--Select-placeholderOpacity":.64,"--Select-decoratorColor":e.vars.palette.text.icon,"--Select-focusedThickness":e.vars.focus.thickness,"--Select-focusedHighlight":(r=e.vars.palette[t.color==="neutral"?"primary":t.color])==null?void 0:r[500],'&:not([data-inverted-colors="false"])':ue({},t.instanceColor&&{"--_Select-focusedHighlight":(i=e.vars.palette[t.instanceColor==="neutral"?"primary":t.instanceColor])==null?void 0:i[500]},{"--Select-focusedHighlight":e.vars.palette.focusVisible}),"--Select-indicatorColor":o!=null&&o.backgroundColor?o==null?void 0:o.color:e.vars.palette.text.tertiary},t.size==="sm"&&{"--Select-minHeight":"2rem","--Select-paddingInline":"0.5rem","--Select-decoratorChildHeight":"min(1.5rem, var(--Select-minHeight))","--Icon-fontSize":e.vars.fontSize.xl},t.size==="md"&&{"--Select-minHeight":"2.25rem","--Select-paddingInline":"0.75rem","--Select-decoratorChildHeight":"min(1.75rem, var(--Select-minHeight))","--Icon-fontSize":e.vars.fontSize.xl2},t.size==="lg"&&{"--Select-minHeight":"2.75rem","--Select-paddingInline":"1rem","--Select-decoratorChildHeight":"min(2.375rem, var(--Select-minHeight))","--Icon-fontSize":e.vars.fontSize.xl2},{"--Select-decoratorChildOffset":"min(calc(var(--Select-paddingInline) - (var(--Select-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Select-decoratorChildHeight)) / 2), var(--Select-paddingInline))","--_Select-paddingBlock":"max((var(--Select-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Select-decoratorChildHeight)) / 2, 0px)","--Select-decoratorChildRadius":"max(var(--Select-radius) - var(--variant-borderWidth, 0px) - var(--_Select-paddingBlock), min(var(--_Select-paddingBlock) + var(--variant-borderWidth, 0px), var(--Select-radius) / 2))","--Button-minHeight":"var(--Select-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Select-decoratorChildHeight)","--Button-radius":"var(--Select-decoratorChildRadius)","--IconButton-radius":"var(--Select-decoratorChildRadius)",boxSizing:"border-box"},t.variant!=="plain"&&{boxShadow:e.shadow.xs},{minWidth:0,minHeight:"var(--Select-minHeight)",position:"relative",display:"flex",alignItems:"center",borderRadius:"var(--Select-radius)",cursor:"pointer"},!(o!=null&&o.backgroundColor)&&{backgroundColor:e.vars.palette.background.surface},t.size&&{paddingBlock:{sm:2,md:3,lg:4}[t.size]},{paddingInline:"var(--Select-paddingInline)"},e.typography[`body-${t.size}`],o,{"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)"},[`&.${ng.focusVisible}`]:{"--Select-indicatorColor":o==null?void 0:o.color,"&::before":{boxShadow:"inset 0 0 0 var(--Select-focusedThickness) var(--Select-focusedHighlight)"}},[`&.${ng.disabled}`]:{"--Select-indicatorColor":"inherit"}}),{"&:hover":(a=e.variants[`${t.variant}Hover`])==null?void 0:a[t.color],[`&.${ng.disabled}`]:(c=e.variants[`${t.variant}Disabled`])==null?void 0:c[t.color]},f!==void 0&&{"--Select-radius":f}]}),Wse=nn("button",{name:"JoySelect",slot:"Button",overridesResolver:(e,t)=>t.button})(({ownerState:e})=>ue({border:0,outline:0,background:"none",padding:0,fontSize:"inherit",color:"inherit",alignSelf:"stretch",display:"flex",alignItems:"center",flex:1,fontFamily:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden"},(e.value===null||e.value===void 0)&&{opacity:"var(--Select-placeholderOpacity)"},{"&::before":{content:'""',display:"block",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))",right:"calc(-1 * var(--variant-borderWidth, 0px))",bottom:"calc(-1 * var(--variant-borderWidth, 0px))",borderRadius:"var(--Select-radius)"}})),qse=nn($_,{name:"JoySelect",slot:"Listbox",overridesResolver:(e,t)=>t.listbox})(({theme:e,ownerState:t})=>{var n;const r=(n=e.variants[t.variant])==null?void 0:n[t.color];return ue({"--focus-outline-offset":`calc(${e.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":(r==null?void 0:r.backgroundColor)||(r==null?void 0:r.background)||e.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},kM,{minWidth:"max-content",maxHeight:"44vh",overflow:"auto",outline:0,boxShadow:e.shadow.md,borderRadius:`var(--List-radius, ${e.vars.radius.sm})`,zIndex:`var(--unstable_popup-zIndex, ${e.vars.zIndex.popup})`},!(r!=null&&r.backgroundColor)&&{backgroundColor:e.vars.palette.background.popup})}),Xse=nn("span",{name:"JoySelect",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({"--Button-margin":"0 0 0 calc(var(--Select-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Select-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Select-paddingInline) / -4)",display:"inherit",alignItems:"center",color:"var(--Select-decoratorColor)",marginInlineEnd:"var(--Select-gap)"}),Zse=nn("span",{name:"JoySelect",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({"--Button-margin":"0 calc(var(--Select-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Select-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Select-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",color:"var(--Select-decoratorColor)",marginInlineStart:"var(--Select-gap)"}),Yse=nn("span",{name:"JoySelect",slot:"Indicator"})(({ownerState:e,theme:t})=>ue({},e.size==="sm"&&{"--Icon-fontSize":t.vars.fontSize.lg},e.size==="md"&&{"--Icon-fontSize":t.vars.fontSize.xl},e.size==="lg"&&{"--Icon-fontSize":t.vars.fontSize.xl2},{"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,display:"inherit",alignItems:"center",marginInlineStart:"var(--Select-gap)",marginInlineEnd:"calc(var(--Select-paddingInline) / -4)",[`.${ng.endDecorator} + &`]:{marginInlineStart:"calc(var(--Select-gap) / 2)"},[`&.${ng.expanded}, .${ng.disabled} > &`]:{"--Icon-color":"currentColor"}})),Kse=$.forwardRef(function(t,n){var r,i,a,c,o,f,g;const _=wr({props:t,name:"JoySelect"}),x=_,{action:M,autoFocus:C,children:A,defaultValue:L,defaultListboxOpen:I=!1,disabled:T,getSerializedValue:z,placeholder:k,listboxId:U,listboxOpen:H,onChange:V,onListboxOpenChange:q,onClose:J,renderValue:Y,required:N=!1,value:ne,size:ye="md",variant:ge="outlined",color:Ne="neutral",startDecorator:Ae,endDecorator:ve,indicator:Se=l5||(l5=ee.jsx(Bse,{})),"aria-describedby":Me,"aria-label":Ue,"aria-labelledby":Qe,id:st,name:ct,multiple:Xt=!1,slots:je={},slotProps:lt={}}=x,Ot=Un(x,$se),ut=$.useContext(FM),ot=(r=(i=t.disabled)!=null?i:ut==null?void 0:ut.disabled)!=null?r:T,Tt=(a=(c=t.size)!=null?c:ut==null?void 0:ut.size)!=null?a:ye,Ct=(o=t.color)!=null?o:ut!=null&&ut.error?"danger":(f=ut==null?void 0:ut.color)!=null?f:Ne,un=Y??Vse,[gn,hn]=$.useState(null),We=$.useRef(null),vn=$.useRef(null),Ut=Ur(n,We);$.useImperativeHandle(M,()=>({focusVisible:()=>{var Et;(Et=vn.current)==null||Et.focus()}}),[]),$.useEffect(()=>{hn(We.current)},[]),$.useEffect(()=>{C&&vn.current.focus()},[C]);const tn=$.useCallback(Et=>{q==null||q(Et),Et||J==null||J()},[J,q]),{buttonActive:Dt,buttonFocusVisible:An,contextValue:an,disabled:Le,getButtonProps:me,getListboxProps:it,getHiddenInputProps:St,getOptionMetadata:It,open:wt,value:Zt}=Yne({buttonRef:vn,defaultOpen:I,defaultValue:L,disabled:ot,getSerializedValue:z,listboxId:U,multiple:Xt,name:ct,required:N,onChange:V,onOpenChange:tn,open:H,value:ne}),Lt=ue({},_,{active:Dt,defaultListboxOpen:I,disabled:Le,focusVisible:An,open:wt,renderValue:un,value:Zt,size:Tt,variant:ge,color:Ct}),kt=Hse(Lt),bn=ue({},Ot,{slots:je,slotProps:lt}),zt=$.useMemo(()=>{let Et;if(Xt)Et=Zt.map(be=>It(be)).filter(be=>be!==void 0);else{var Ft;Et=(Ft=It(Zt))!=null?Ft:null}return Et},[It,Zt,Xt]),[_e,te]=wn("root",{ref:Ut,className:kt.root,elementType:Gse,externalForwardedProps:bn,ownerState:Lt}),[re,Z]=wn("button",{additionalProps:{"aria-describedby":Me??(ut==null?void 0:ut["aria-describedby"]),"aria-label":Ue,"aria-labelledby":Qe??(ut==null?void 0:ut.labelId),"aria-required":N?"true":void 0,id:st??(ut==null?void 0:ut.htmlFor),name:ct},className:kt.button,elementType:Wse,externalForwardedProps:bn,getSlotProps:me,ownerState:Lt}),[le,Te]=wn("listbox",{additionalProps:{anchorEl:gn,open:wt,placement:"bottom",keepMounted:!0},className:kt.listbox,elementType:qse,externalForwardedProps:bn,getSlotProps:it,ownerState:ue({},Lt,{nesting:!1,row:!1,wrap:!1}),getSlotOwnerState:Et=>({size:Et.size||Tt,variant:Et.variant||ge,color:Et.color||(Et.disablePortal?Ct:Ne),disableColorInversion:!Et.disablePortal})}),[Ve,fe]=wn("startDecorator",{className:kt.startDecorator,elementType:Xse,externalForwardedProps:bn,ownerState:Lt}),[xe,Re]=wn("endDecorator",{className:kt.endDecorator,elementType:Zse,externalForwardedProps:bn,ownerState:Lt}),[De,ze]=wn("indicator",{className:kt.indicator,elementType:Yse,externalForwardedProps:bn,ownerState:Lt}),Je=$.useMemo(()=>[...jse,...Te.modifiers||[]],[Te.modifiers]);let Oe=k;return(Array.isArray(zt)&&zt.length>0||!Array.isArray(zt)&&zt)&&(Oe=un(zt)),ee.jsxs($.Fragment,{children:[ee.jsxs(_e,ue({},te,{children:[Ae&&ee.jsx(Ve,ue({},fe,{children:Ae})),ee.jsx(re,ue({},Z,{children:Oe})),ve&&ee.jsx(xe,ue({},Re,{children:ve})),Se&&ee.jsx(De,ue({},ze,{children:Se})),ee.jsx("input",ue({},St()))]})),gn&&ee.jsx(le,ue({},Te,{className:xi(Te.className),modifiers:Je},!((g=_.slots)!=null&&g.listbox)&&{as:IM,slots:{root:Te.as||"ul"}},{children:ee.jsx(Kne,{value:an,children:ee.jsx(OM,{variant:ge,color:Ne,children:ee.jsx(LM.Provider,{value:"select",children:ee.jsx(U_,{nested:!0,children:A})})})})}))]})});function Jse(e){return br("MuiSheet",e)}gr("MuiSheet",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const Qse=["className","color","component","variant","invertedColors","slots","slotProps"],eae=e=>{const{variant:t,color:n}=e,r={root:["root",t&&`variant${mn(t)}`,n&&`color${mn(n)}`]};return yr(r,Jse,{})},tae=nn("div",{name:"JoySheet",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r;const i=(n=e.variants[t.variant])==null?void 0:n[t.color],{borderRadius:a,bgcolor:c,backgroundColor:o,background:f}=Wf({theme:e,ownerState:t},["borderRadius","bgcolor","backgroundColor","background"]),g=Nh(e,`palette.${c}`)||c||Nh(e,`palette.${o}`)||o||f||(i==null?void 0:i.backgroundColor)||(i==null?void 0:i.background)||e.vars.palette.background.surface;return[ue({"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,"--ListItem-stickyBackground":g==="transparent"?"initial":g,"--Sheet-background":g==="transparent"?"initial":g},a!==void 0&&{"--List-radius":`calc(${a} - var(--variant-borderWidth, 0px))`,"--unstable_actionRadius":`calc(${a} - var(--variant-borderWidth, 0px))`},{backgroundColor:e.vars.palette.background.surface,position:"relative"}),ue({},e.typography["body-md"],t.variant==="solid"&&t.color&&t.invertedColors&&j_(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&H_(t.color)(e),(r=e.variants[t.variant])==null?void 0:r[t.color],i)]}),fV=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoySheet"}),{className:i,color:a="neutral",component:c="div",variant:o="plain",invertedColors:f=!1,slots:g={},slotProps:_={}}=r,x=Un(r,Qse),M=ue({},r,{color:a,component:c,invertedColors:f,variant:o}),C=eae(M),A=ue({},x,{component:c,slots:g,slotProps:_}),[L,I]=wn("root",{ref:n,className:xi(C.root,i),elementType:tae,externalForwardedProps:A,ownerState:M});return ee.jsx(L,ue({},I))});function nae(e){return br("MuiSnackbar",e)}gr("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","endDecorator","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantOutlined","variantSoft","variantSolid"]);const rae=["anchorOrigin","animationDuration","autoHideDuration","color","children","className","component","disableWindowBlurListener","endDecorator","invertedColors","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","onUnmount","open","resumeHideDuration","size","slots","slotProps","startDecorator","variant"];let pV=e=>e,c5,u5;const iae=e=>{const{variant:t,color:n,size:r,anchorOrigin:i}=e,a={root:["root",r&&`size${mn(r)}`,n&&`color${mn(n)}`,t&&`variant${mn(t)}`,`anchorOrigin${mn(i.vertical)}${mn(i.horizontal)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return yr(a,nae,{})},oae=xR(c5||(c5=pV`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
  }
`)),sae=xR(u5||(u5=pV`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
`)),aae=nn("div",{name:"JoySnackbar",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r,i,a,c,o,f;const{p:g,padding:_,borderRadius:x}=Wf({theme:e,ownerState:t},["p","padding","borderRadius"]);return[ue({"--Snackbar-radius":e.vars.radius.sm,"--Snackbar-decoratorChildRadius":"max((var(--Snackbar-radius) - var(--variant-borderWidth, 0px)) - var(--Snackbar-padding), min(var(--Snackbar-padding) + var(--variant-borderWidth, 0px), var(--Snackbar-radius) / 2))","--Button-minHeight":"var(--Snackbar-decoratorChildHeight)","--IconButton-size":"var(--Snackbar-decoratorChildHeight)","--Button-radius":"var(--Snackbar-decoratorChildRadius)","--IconButton-radius":"var(--Snackbar-decoratorChildRadius)","--Icon-color":"currentColor"},t.size==="sm"&&{"--Snackbar-padding":"0.75rem","--Snackbar-inset":"0.5rem","--Snackbar-decoratorChildHeight":"1.5rem","--Icon-fontSize":e.vars.fontSize.xl,gap:"0.5rem"},t.size==="md"&&{"--Snackbar-padding":"1rem","--Snackbar-inset":"0.75rem","--Snackbar-decoratorChildHeight":"2rem","--Icon-fontSize":e.vars.fontSize.xl,gap:"0.625rem"},t.size==="lg"&&{"--Snackbar-padding":"1.25rem","--Snackbar-inset":"1rem","--Snackbar-decoratorChildHeight":"2.375rem","--Icon-fontSize":e.vars.fontSize.xl2,gap:"0.875rem"},{zIndex:e.vars.zIndex.snackbar,position:"fixed",display:"flex",alignItems:"center",minWidth:300,top:((n=t.anchorOrigin)==null?void 0:n.vertical)==="top"?"var(--Snackbar-inset)":void 0,left:((r=t.anchorOrigin)==null?void 0:r.horizontal)==="left"?"var(--Snackbar-inset)":void 0,bottom:((i=t.anchorOrigin)==null?void 0:i.vertical)==="bottom"?"var(--Snackbar-inset)":void 0,right:((a=t.anchorOrigin)==null?void 0:a.horizontal)==="right"?"var(--Snackbar-inset)":void 0},((c=t.anchorOrigin)==null?void 0:c.horizontal)==="center"&&{"--Snackbar-translateX":"-50%",left:"50%",transform:"translateX(var(--Snackbar-translateX))"},((o=t.anchorOrigin)==null?void 0:o.vertical)==="top"&&{"--_Snackbar-anchorBottom":"-1"},{animation:`${oae} ${t.animationDuration}ms forwards`},!t.open&&{animationName:sae},{boxShadow:e.vars.shadow.lg,backgroundColor:e.vars.palette.background.surface,padding:"var(--Snackbar-padding)",borderRadius:"var(--Snackbar-radius)"},e.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[t.size]}`],t.variant==="solid"&&t.color&&t.invertedColors&&j_(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&H_(t.color)(e),(f=e.variants[t.variant])==null?void 0:f[t.color]),g!==void 0&&{"--Snackbar-padding":g},_!==void 0&&{"--Snackbar-padding":_},x!==void 0&&{"--Snackbar-radius":x}]}),lae=nn("span",{name:"JoySnackbar",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({display:"inherit",flex:"none"}),cae=nn("span",{name:"JoySnackbar",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({display:"inherit",flex:"none",marginLeft:"auto"}),uae={vertical:"bottom",horizontal:"right"},mV=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoySnackbar"}),{anchorOrigin:i=uae,animationDuration:a=300,autoHideDuration:c=null,color:o="neutral",children:f,className:g,component:_,disableWindowBlurListener:x=!1,endDecorator:M,invertedColors:C=!1,onUnmount:A,open:L,size:I="md",slots:T={},slotProps:z,startDecorator:k,variant:U="outlined"}=r,H=Un(r,rae),[V,q]=$.useState(!0),[J,Y]=$.useState(!1),N=$.useRef(A);N.current=A,$.useEffect(()=>{if(L)Y(!1),q(!1);else{Y(!0);const je=setTimeout(()=>{var lt;q(!0),Y(!1),(lt=N.current)==null||lt.call(N)},a);return()=>{clearTimeout(je)}}},[L,a]);const ne=ue({},r,{anchorOrigin:i,autoHideDuration:c,color:o,animationDuration:a,disableWindowBlurListener:x,invertedColors:C,size:I,variant:U});delete ne.onUnmount;const ye=iae(ne),{getRootProps:ge,onClickAway:Ne}=Jne(ne),Ae=je=>{J||Ne(je)},ve=ue({},H,{component:_,slots:T,slotProps:z}),[Se,Me]=wn("root",{ref:n,className:xi(ye.root,g),elementType:aae,externalForwardedProps:ve,getSlotProps:ge,ownerState:ne}),[Ue,Qe]=wn("startDecorator",{className:ye.startDecorator,elementType:lae,externalForwardedProps:ve,ownerState:ne}),[st,ct]=wn("endDecorator",{className:ye.endDecorator,elementType:cae,externalForwardedProps:ve,ownerState:ne}),Xt=T.clickAway||AJ;return!L&&V?null:ee.jsx(Xt,ue({onClickAway:Ae},typeof(z==null?void 0:z.clickAway)=="function"?z.clickAway(ne):z==null?void 0:z.clickAway,{children:ee.jsxs(Se,ue({},Me,{children:[k&&ee.jsx(Ue,ue({},Qe,{children:k})),f,M&&ee.jsx(st,ue({},ct,{children:M}))]}))}))}),Ga=dJ({createStyledComponent:nn("div",{name:"JoyStack",slot:"Root",overridesResolver:(e,t)=>t.root}),useThemeProps:e=>wr({props:e,name:"JoyStack"})});function hae(e){return br("MuiTab",e)}const dae=gr("MuiTab",["root","disabled","focusVisible","selected","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]),fae=["action","children","value","disabled","onChange","onClick","onFocus","component","orientation","variant","color","disableIndicator","indicatorPlacement","indicatorInset","slots","slotProps"],pae=e=>{const{selected:t,disabled:n,focusVisible:r,variant:i,color:a,orientation:c}=e,o={root:["root",c,n&&"disabled",r&&"focusVisible",t&&"selected",i&&`variant${mn(i)}`,a&&`color${mn(a)}`]};return yr(o,hae,{})},mae=nn(V_,{name:"JoyTab",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>[{flex:"initial",justifyContent:e.row?"center":"initial","--unstable_ListItemDecorator-alignItems":"center","--unstable_offset":"min(calc(-1 * var(--variant-borderWidth, 0px)), -1px)"},!e.disableIndicator&&{'&[aria-selected="true"]':{"--Tab-indicatorColor":"currentColor",zIndex:1},"&::after":{content:'""',display:"block",position:"absolute",margin:"auto",background:"var(--Tab-indicatorColor)",borderRadius:"var(--Tab-indicatorRadius)"}},!e.disableIndicator&&e.indicatorPlacement==="bottom"&&{paddingBottom:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorThickness)",width:"var(--Tab-indicatorSize)",left:e.indicatorInset?"var(--ListItem-paddingLeft)":"var(--unstable_offset)",right:e.indicatorInset?"var(--ListItem-paddingRight)":"var(--unstable_offset)",bottom:"calc(-1px - var(--unstable_TabList-underlineBottom, 0px))"}},!e.disableIndicator&&e.indicatorPlacement==="top"&&{paddingTop:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorThickness)",width:"var(--Tab-indicatorSize)",left:e.indicatorInset?"var(--ListItem-paddingLeft)":"var(--unstable_offset)",right:e.indicatorInset?"var(--ListItem-paddingRight)":"var(--unstable_offset)",top:"calc(-1px - var(--unstable_TabList-underlineTop, 0px))"}},!e.disableIndicator&&e.indicatorPlacement==="right"&&{paddingRight:"calc(var(--ListItem-paddingRight) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorSize)",width:"var(--Tab-indicatorThickness)",top:e.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",bottom:e.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",right:"calc(-1px - var(--unstable_TabList-underlineRight, 0px))"}},!e.disableIndicator&&e.indicatorPlacement==="left"&&{paddingLeft:"calc(var(--ListItem-paddingLeft) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorSize)",width:"var(--Tab-indicatorThickness)",top:e.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",bottom:e.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",left:"calc(-1px - var(--unstable_TabList-underlineLeft, 0px))"}}]),SE=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyTab"}),i=$.useContext(jg),{action:a,children:c,disabled:o=!1,component:f="button",orientation:g="horizontal",variant:_="plain",color:x="neutral",disableIndicator:M=!1,indicatorPlacement:C=i?"bottom":"right",indicatorInset:A=!1,slots:L={},slotProps:I={}}=r,T=Un(r,fae),z=$.useRef(null),k=Ur(z,n),{active:U,focusVisible:H,setFocusVisible:V,selected:q,getRootProps:J}=lre(ue({},r,{rootRef:k}));$.useImperativeHandle(a,()=>({focusVisible:()=>{V(!0),z.current.focus()}}),[V]);const Y=ue({},r,{disableIndicator:M,indicatorPlacement:C,indicatorInset:A,orientation:g,row:i,active:U,focusVisible:H,disabled:o,selected:q,variant:_,color:x}),N=pae(Y),ne=ue({},T,{component:f,slots:L,slotProps:I}),[ye,ge]=wn("root",{ref:n,elementType:mae,getSlotProps:J,externalForwardedProps:ne,ownerState:Y,className:N.root});return ee.jsx(B3.Provider,{value:g,children:ee.jsx(ye,ue({},ge,{children:c}))})}),H3=$.createContext("md");function gae(e){return br("MuiTabList",e)}gr("MuiTabList",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const vae=["component","children","variant","color","size","disableUnderline","underlinePlacement","tabFlex","sticky","slots","slotProps"],yae=e=>{const{orientation:t,size:n,variant:r,color:i}=e,a={root:["root",t,r&&`variant${mn(r)}`,i&&`color${mn(i)}`,n&&`size${mn(n)}`]};return yr(a,gae,{})},_ae=nn($_,{name:"JoyTabList",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n;const r=(n=e.variants[t.variant])==null?void 0:n[t.color];return ue({"--List-gap":"0px","--ListDivider-gap":"0px","--ListItem-paddingX":"var(--Tabs-spacing)","--ListItem-gap":"0.375rem","--unstable_TabList-hasUnderline":t.disableUnderline?"var(--unknown,)":"initial"},kM,{flexGrow:"initial",flexDirection:t.orientation==="vertical"?"column":"row",borderRadius:"var(--List-radius, 0px)",padding:"var(--List-padding, 0px)",zIndex:1},t.sticky&&{position:"sticky",top:t.sticky==="top"?"calc(-1 * var(--Tabs-padding, 0px))":"initial",bottom:t.sticky==="bottom"?"calc(-1 * var(--Tabs-padding, 0px))":"initial",backgroundColor:(r==null?void 0:r.backgroundColor)||`var(--TabList-stickyBackground, ${e.vars.palette.background.body})`},!t.disableUnderline&&ue({},t.underlinePlacement==="bottom"&&{"--unstable_TabList-underlineBottom":"1px",paddingBottom:1,boxShadow:`inset 0 -1px ${e.vars.palette.divider}`},t.underlinePlacement==="top"&&{"--unstable_TabList-underlineTop":"1px",paddingTop:1,boxShadow:`inset 0 1px ${e.vars.palette.divider}`},t.underlinePlacement==="right"&&{"--unstable_TabList-underlineRight":"1px",paddingRight:1,boxShadow:`inset -1px 0 ${e.vars.palette.divider}`},t.underlinePlacement==="left"&&{"--unstable_TabList-underlineLeft":"1px",paddingLeft:1,boxShadow:`inset 1px 0 ${e.vars.palette.divider}`}),t.tabFlex&&{[`& .${dae.root}`]:{flex:t.tabFlex}})}),xae=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyTabList"}),i=$.useContext(H3),{isRtl:a,orientation:c,getRootProps:o,contextValue:f}=ore({rootRef:n}),{component:g="div",children:_,variant:x="plain",color:M="neutral",size:C,disableUnderline:A=!1,underlinePlacement:L=c==="horizontal"?"bottom":"right",tabFlex:I,sticky:T,slots:z={},slotProps:k={}}=r,U=Un(r,vae),V=ue({},r,{isRtl:a,orientation:c,variant:x,color:M,size:C??i,sticky:T,tabFlex:I,nesting:!1,disableUnderline:A,underlinePlacement:L}),q=yae(V),J=ue({},U,{component:g,slots:z,slotProps:k}),[Y,N]=wn("root",{ref:n,elementType:_ae,getSlotProps:o,externalForwardedProps:J,ownerState:V,className:q.root});return ee.jsx(Y,ue({},N,{children:ee.jsx(sre,{value:f,children:ee.jsx(U_,{row:c==="horizontal",nested:!0,children:_})})}))});function bae(e){return br("MuiTabPanel",e)}gr("MuiTabPanel",["root","hidden","sizeSm","sizeMd","sizeLg","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const wae=["children","value","component","color","variant","size","slots","slotProps","keepMounted"],Sae=e=>{const{hidden:t,size:n,variant:r,color:i,orientation:a}=e,c={root:["root",t&&"hidden",n&&`size${mn(n)}`,a,r&&`variant${mn(r)}`,i&&`color${mn(i)}`,n&&`size${mn(n)}`]};return yr(c,bae,{})},Mae=nn("div",{name:"JoyTabPanel",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n;return ue({display:t.hidden?"none":"block",padding:"var(--Tabs-spacing)",flexGrow:1,fontFamily:e.vars.fontFamily.body},e.typography[`body-${t.size}`],(n=e.variants[t.variant])==null?void 0:n[t.color])}),ME=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyTabPanel"}),{orientation:i}=RM()||{orientation:"horizontal"},a=$.useContext(H3),{children:c,value:o=0,component:f,color:g="neutral",variant:_="plain",size:x,slots:M={},slotProps:C={},keepMounted:A=!1}=r,L=Un(r,wae),{hidden:I,getRootProps:T}=rre(ue({},r,{value:o})),k=ue({},r,{orientation:i,hidden:I,size:x??a,color:g,variant:_}),U=Sae(k),H=ue({},L,{component:f,slots:M,slotProps:C}),[V,q]=wn("root",{ref:n,elementType:Mae,getSlotProps:T,externalForwardedProps:H,additionalProps:{role:"tabpanel",ref:n,as:f},ownerState:k,className:U.root});return A?ee.jsx(V,ue({},q,{children:c})):ee.jsx(V,ue({},q,{children:!I&&c}))});function Cae(e){return br("MuiTabs",e)}gr("MuiTabs",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const Eae=["children","value","defaultValue","orientation","direction","component","onChange","selectionFollowsFocus","variant","color","size","slots","slotProps"],Tae=e=>{const{orientation:t,variant:n,color:r,size:i}=e,a={root:["root",t,n&&`variant${mn(n)}`,r&&`color${mn(r)}`,i&&`size${mn(i)}`]};return yr(a,Cae,{})},Pae=nn("div",{name:"JoyTabs",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var n,r;const i=(n=t.variants[e.variant])==null?void 0:n[e.color],{bgcolor:a,backgroundColor:c,background:o,p:f,padding:g}=Wf({theme:t,ownerState:e},["bgcolor","backgroundColor","background","p","padding"]),_=Nh(t,`palette.${a}`)||a||Nh(t,`palette.${c}`)||c||o||(i==null?void 0:i.backgroundColor)||(i==null?void 0:i.background)||t.vars.palette.background.surface;return ue({},e.size==="sm"&&{"--Tabs-spacing":"0.75rem"},e.size==="md"&&{"--Tabs-spacing":"1rem"},e.size==="lg"&&{"--Tabs-spacing":"1.25rem"},{"--Tab-indicatorThickness":"2px","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,"--TabList-stickyBackground":_==="transparent"?"initial":_,display:"flex",flexDirection:"column"},e.orientation==="vertical"&&{flexDirection:"row"},{backgroundColor:t.vars.palette.background.surface,position:"relative"},t.typography[`body-${e.size}`],(r=t.variants[e.variant])==null?void 0:r[e.color],f!==void 0&&{"--Tabs-padding":f},g!==void 0&&{"--Tabs-padding":g})}),h5=$.forwardRef(function(t,n){const r=wr({props:t,name:"JoyTabs"}),{children:i,value:a,defaultValue:c,orientation:o="horizontal",direction:f="ltr",component:g,variant:_="plain",color:x="neutral",size:M="md",slots:C={},slotProps:A={}}=r,L=Un(r,Eae),I=c||(a===void 0?0:void 0),{contextValue:T}=ere(ue({},r,{orientation:o,defaultValue:I})),z=ue({},r,{orientation:o,direction:f,variant:_,color:x,size:M}),k=Tae(z),U=ue({},L,{component:g,slots:C,slotProps:A}),[H,V]=wn("root",{ref:n,elementType:Pae,externalForwardedProps:U,additionalProps:{ref:n,as:g},ownerState:z,className:k.root});return ee.jsx(H,ue({},V,{children:ee.jsx(tre,{value:T,children:ee.jsx(H3.Provider,{value:M,children:i})})}))});function Aae(e){return br("MuiTooltip",e)}gr("MuiTooltip",["root","tooltipArrow","arrow","touch","placementLeft","placementRight","placementTop","placementBottom","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);const Iae=["children","className","component","arrow","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","disablePortal","direction","keepMounted","modifiers","placement","title","color","variant","size","slots","slotProps"],Rae=e=>{const{arrow:t,variant:n,color:r,size:i,placement:a,touch:c}=e,o={root:["root",t&&"tooltipArrow",c&&"touch",i&&`size${mn(i)}`,r&&`color${mn(r)}`,n&&`variant${mn(n)}`,`tooltipPlacement${mn(a.split("-")[0])}`],arrow:["arrow"]};return yr(o,Aae,{})},Lae=nn("div",{name:"JoyTooltip",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var n,r,i;const a=(n=t.variants[e.variant])==null?void 0:n[e.color];return ue({},e.size==="sm"&&{"--Icon-fontSize":t.vars.fontSize.md,"--Tooltip-arrowSize":"8px",padding:t.spacing(.25,.625)},e.size==="md"&&{"--Icon-fontSize":t.vars.fontSize.lg,"--Tooltip-arrowSize":"10px",padding:t.spacing(.5,.75)},e.size==="lg"&&{"--Icon-fontSize":t.vars.fontSize.xl,"--Tooltip-arrowSize":"12px",padding:t.spacing(.75,1)},{zIndex:t.vars.zIndex.tooltip,borderRadius:t.vars.radius.sm,boxShadow:t.shadow.sm,wordWrap:"break-word",position:"relative"},e.disableInteractive&&{pointerEvents:"none"},t.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[e.size]}`],a,!a.backgroundColor&&{backgroundColor:t.vars.palette.background.surface},{"&::before":{content:'""',display:"block",position:"absolute",width:(r=e.placement)!=null&&r.match(/(top|bottom)/)?"100%":"calc(10px + var(--variant-borderWidth, 0px))",height:(i=e.placement)!=null&&i.match(/(top|bottom)/)?"calc(10px + var(--variant-borderWidth, 0px))":"100%"},'&[data-popper-placement*="bottom"]::before':{top:0,left:0,transform:"translateY(-100%)"},'&[data-popper-placement*="left"]::before':{top:0,right:0,transform:"translateX(100%)"},'&[data-popper-placement*="right"]::before':{top:0,left:0,transform:"translateX(-100%)"},'&[data-popper-placement*="top"]::before':{bottom:0,left:0,transform:"translateY(100%)"}})}),kae=nn("span",{name:"JoyTooltip",slot:"Arrow",overridesResolver:(e,t)=>t.arrow})(({theme:e,ownerState:t})=>{var n,r,i;const a=(n=e.variants[t.variant])==null?void 0:n[t.color];return{"--unstable_Tooltip-arrowRotation":0,width:"var(--Tooltip-arrowSize)",height:"var(--Tooltip-arrowSize)",boxSizing:"border-box","&::before":{content:'""',display:"block",position:"absolute",width:0,height:0,border:"calc(var(--Tooltip-arrowSize) / 2) solid",borderLeftColor:"transparent",borderBottomColor:"transparent",borderTopColor:(r=a==null?void 0:a.backgroundColor)!=null?r:e.vars.palette.background.surface,borderRightColor:(i=a==null?void 0:a.backgroundColor)!=null?i:e.vars.palette.background.surface,borderRadius:"0px 2px 0px 0px",boxShadow:`var(--variant-borderWidth, 0px) calc(-1 * var(--variant-borderWidth, 0px)) 0px 0px ${a.borderColor}`,transformOrigin:"center center",transform:"rotate(calc(-45deg + 90deg * var(--unstable_Tooltip-arrowRotation)))"},'[data-popper-placement*="bottom"] &':{top:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="top"] &':{"--unstable_Tooltip-arrowRotation":2,bottom:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="left"] &':{"--unstable_Tooltip-arrowRotation":1,right:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="right"] &':{"--unstable_Tooltip-arrowRotation":3,left:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"}}});let W1=!1;const d5=new R_;let x0={x:0,y:0};function f5(e,t){return n=>{t&&t(n),e(n)}}function p5(e,t){return(n,...r)=>{t&&t(n,...r),e(n,...r)}}const gV=$.forwardRef(function(t,n){var r;const i=wr({props:t,name:"JoyTooltip"}),{children:a,className:c,component:o,arrow:f=!1,describeChild:g=!1,disableFocusListener:_=!1,disableHoverListener:x=!1,disableInteractive:M=!1,disableTouchListener:C=!1,enterDelay:A=100,enterNextDelay:L=0,enterTouchDelay:I=700,followCursor:T=!1,id:z,leaveDelay:k=0,leaveTouchDelay:U=1500,onClose:H,onOpen:V,open:q,disablePortal:J,direction:Y,keepMounted:N,modifiers:ne,placement:ye="bottom",title:ge,color:Ne="neutral",variant:Ae="solid",size:ve="md",slots:Se={},slotProps:Me={}}=i,Ue=Un(i,Iae),[Qe,st]=$.useState(),[ct,Xt]=$.useState(null),je=$.useRef(!1),lt=M||T,Ot=U0(),ut=U0(),ot=U0(),Tt=U0(),[Ct,un]=Xm({controlled:q,default:!1,name:"Tooltip",state:"open"});let gn=Ct;const hn=qs(z),We=$.useRef(void 0),vn=Tl(()=>{We.current!==void 0&&(document.body.style.WebkitUserSelect=We.current,We.current=void 0),Tt.clear()});$.useEffect(()=>vn,[vn]);const Ut=Ft=>{d5.clear(),W1=!0,un(!0),V&&!gn&&V(Ft)},tn=Tl(Ft=>{d5.start(800+k,()=>{W1=!1}),un(!1),H&&gn&&H(Ft),Ot.start(150,()=>{je.current=!1})}),Dt=Ft=>{je.current&&Ft.type!=="touchstart"||(Qe&&Qe.removeAttribute("title"),ut.clear(),ot.clear(),A||W1&&L?ut.start(W1?L:A,()=>{Ut(Ft)}):Ut(Ft))},An=Ft=>{ut.clear(),ot.start(k,()=>{tn(Ft)})},{isFocusVisibleRef:an,onBlur:Le,onFocus:me,ref:it}=LR(),[,St]=$.useState(!1),It=Ft=>{Le(Ft),an.current===!1&&(St(!1),An(Ft))},wt=Ft=>{Qe||st(Ft.currentTarget),me(Ft),an.current===!0&&(St(!0),Dt(Ft))},Zt=Ft=>{je.current=!0;const be=a.props;be.onTouchStart&&be.onTouchStart(Ft)},Lt=Ft=>{Zt(Ft),ot.clear(),Ot.clear(),vn(),We.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Tt.start(I,()=>{document.body.style.WebkitUserSelect=We.current,Dt(Ft)})},kt=Ft=>{a.props.onTouchEnd&&a.props.onTouchEnd(Ft),vn(),ot.start(U,()=>{tn(Ft)})};$.useEffect(()=>{if(!gn)return;function Ft(be){(be.key==="Escape"||be.key==="Esc")&&tn(be)}return document.addEventListener("keydown",Ft),()=>{document.removeEventListener("keydown",Ft)}},[tn,gn]);const bn=Ur(st,n),zt=Ur(it,bn),_e=Ur(cM(a),zt);typeof ge!="number"&&!ge&&(gn=!1);const te=$.useRef(null),re=Ft=>{const be=a.props;be.onMouseMove&&be.onMouseMove(Ft),x0={x:Ft.clientX,y:Ft.clientY},te.current&&te.current.update()},Z={},le=typeof ge=="string";g?(Z.title=!gn&&le&&!x?ge:null,Z["aria-describedby"]=gn?hn:null):(Z["aria-label"]=le?ge:null,Z["aria-labelledby"]=gn&&!le?hn:null);const Te=ue({},Z,Ue,{component:o},a.props,{className:xi(c,a.props.className),onTouchStart:Zt,ref:_e},T?{onMouseMove:re}:{}),Ve={};C||(Te.onTouchStart=Lt,Te.onTouchEnd=kt),x||(Te.onMouseOver=f5(Dt,Te.onMouseOver),Te.onMouseLeave=f5(An,Te.onMouseLeave),lt||(Ve.onMouseOver=Dt,Ve.onMouseLeave=An)),_||(Te.onFocus=p5(wt,Te.onFocus),Te.onBlur=p5(It,Te.onBlur),lt||(Ve.onFocus=wt,Ve.onBlur=It));const fe=ue({},i,{arrow:f,disableInteractive:lt,placement:ye,touch:je.current,color:Ne,variant:Ae,size:ve}),xe=Rae(fe),Re=ue({},Ue,{component:o,slots:Se,slotProps:Me}),De=$.useMemo(()=>[{name:"arrow",enabled:!!ct,options:{element:ct,padding:6}},{name:"offset",options:{offset:[0,10]}},...ne||[]],[ct,ne]),[ze,Je]=wn("root",{additionalProps:ue({id:hn,popperRef:te,placement:ye,anchorEl:T?{getBoundingClientRect:()=>({top:x0.y,left:x0.x,right:x0.x,bottom:x0.y,width:0,height:0})}:Qe,open:Qe?gn:!1,disablePortal:J,keepMounted:N,direction:Y,modifiers:De},Ve),ref:null,className:xe.root,elementType:Lae,externalForwardedProps:Re,ownerState:fe}),[Oe,Et]=wn("arrow",{ref:Xt,className:xe.arrow,elementType:kae,externalForwardedProps:Re,ownerState:fe});return ee.jsxs($.Fragment,{children:[$.isValidElement(a)&&$.cloneElement(a,Te),ee.jsxs(ze,ue({},Je,!((r=i.slots)!=null&&r.root)&&{as:IM,slots:{root:o||"div"}},{children:[ge,f?ee.jsx(Oe,ue({},Et)):null]}))]})});var vV,m5=F_;vV=m5.createRoot,m5.hydrateRoot;var G3={};Object.defineProperty(G3,"__esModule",{value:!0});G3.parse=Uae;G3.serialize=$ae;const Dae=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,zae=/^[\u0021-\u003A\u003C-\u007E]*$/,Oae=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,Fae=/^[\u0020-\u003A\u003D-\u007E]*$/,Nae=Object.prototype.toString,Bae=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function Uae(e,t){const n=new Bae,r=e.length;if(r<2)return n;const i=(t==null?void 0:t.decode)||Vae;let a=0;do{const c=e.indexOf("=",a);if(c===-1)break;const o=e.indexOf(";",a),f=o===-1?r:o;if(c>f){a=e.lastIndexOf(";",c-1)+1;continue}const g=g5(e,a,c),_=v5(e,c,g),x=e.slice(g,_);if(n[x]===void 0){let M=g5(e,c+1,f),C=v5(e,f,M);const A=i(e.slice(M,C));n[x]=A}a=f+1}while(a<r);return n}function g5(e,t,n){do{const r=e.charCodeAt(t);if(r!==32&&r!==9)return t}while(++t<n);return n}function v5(e,t,n){for(;t>n;){const r=e.charCodeAt(--t);if(r!==32&&r!==9)return t+1}return n}function $ae(e,t,n){const r=(n==null?void 0:n.encode)||encodeURIComponent;if(!Dae.test(e))throw new TypeError(`argument name is invalid: ${e}`);const i=r(t);if(!zae.test(i))throw new TypeError(`argument val is invalid: ${t}`);let a=e+"="+i;if(!n)return a;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);a+="; Max-Age="+n.maxAge}if(n.domain){if(!Oae.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);a+="; Domain="+n.domain}if(n.path){if(!Fae.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);a+="; Path="+n.path}if(n.expires){if(!jae(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);a+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(a+="; HttpOnly"),n.secure&&(a+="; Secure"),n.partitioned&&(a+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"none":a+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return a}function Vae(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function jae(e){return Nae.call(e)==="[object Date]"}/**
 * react-router v7.6.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var yV=e=>{throw TypeError(e)},Hae=(e,t,n)=>t.has(e)||yV("Cannot "+n),CE=(e,t,n)=>(Hae(e,t,"read from private field"),n?n.call(e):t.get(e)),Gae=(e,t,n)=>t.has(e)?yV("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),y5="popstate";function Wae(e={}){function t(r,i){let{pathname:a,search:c,hash:o}=r.location;return c_("",{pathname:a,search:c,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:$h(i)}return Xae(t,n,null,e)}function cr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ni(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function qae(){return Math.random().toString(36).substring(2,10)}function _5(e,t){return{usr:e.state,key:e.key,idx:t}}function c_(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?id(t):t,state:n,key:t&&t.key||r||qae()}}function $h({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function id(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function Xae(e,t,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,c=i.history,o="POP",f=null,g=_();g==null&&(g=0,c.replaceState({...c.state,idx:g},""));function _(){return(c.state||{idx:null}).idx}function x(){o="POP";let I=_(),T=I==null?null:I-g;g=I,f&&f({action:o,location:L.location,delta:T})}function M(I,T){o="PUSH";let z=c_(L.location,I,T);g=_()+1;let k=_5(z,g),U=L.createHref(z);try{c.pushState(k,"",U)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;i.location.assign(U)}a&&f&&f({action:o,location:L.location,delta:1})}function C(I,T){o="REPLACE";let z=c_(L.location,I,T);g=_();let k=_5(z,g),U=L.createHref(z);c.replaceState(k,"",U),a&&f&&f({action:o,location:L.location,delta:0})}function A(I){return _V(I)}let L={get action(){return o},get location(){return e(i,c)},listen(I){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(y5,x),f=I,()=>{i.removeEventListener(y5,x),f=null}},createHref(I){return t(i,I)},createURL:A,encodeLocation(I){let T=A(I);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:M,replace:C,go(I){return c.go(I)}};return L}function _V(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),cr(n,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:$h(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}var G0,x5=class{constructor(e){if(Gae(this,G0,new Map),e)for(let[t,n]of e)this.set(t,n)}get(e){if(CE(this,G0).has(e))return CE(this,G0).get(e);if(e.defaultValue!==void 0)return e.defaultValue;throw new Error("No value found for context")}set(e,t){CE(this,G0).set(e,t)}};G0=new WeakMap;var Zae=new Set(["lazy","caseSensitive","path","id","index","children"]);function Yae(e){return Zae.has(e)}var Kae=new Set(["lazy","caseSensitive","path","id","index","unstable_middleware","children"]);function Jae(e){return Kae.has(e)}function Qae(e){return e.index===!0}function oS(e,t,n=[],r={}){return e.map((i,a)=>{let c=[...n,String(a)],o=typeof i.id=="string"?i.id:c.join("-");if(cr(i.index!==!0||!i.children,"Cannot specify children on an index route"),cr(!r[o],`Found a route id collision on id "${o}".  Route id's must be globally unique within Data Router usages`),Qae(i)){let f={...i,...t(i),id:o};return r[o]=f,f}else{let f={...i,...t(i),id:o,children:void 0};return r[o]=f,i.children&&(f.children=oS(i.children,t,c,r)),f}})}function vh(e,t,n="/"){return tw(e,t,n,!1)}function tw(e,t,n,r){let i=typeof t=="string"?id(t):t,a=Qa(i.pathname||"/",n);if(a==null)return null;let c=xV(e);tle(c);let o=null;for(let f=0;o==null&&f<c.length;++f){let g=dle(a);o=ule(c[f],g,r)}return o}function ele(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],handle:n.handle}}function xV(e,t=[],n=[],r=""){let i=(a,c,o)=>{let f={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:c,route:a};f.relativePath.startsWith("/")&&(cr(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length));let g=yc([r,f.relativePath]),_=n.concat(f);a.children&&a.children.length>0&&(cr(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),xV(a.children,t,_,g)),!(a.path==null&&!a.index)&&t.push({path:g,score:lle(g,a.index),routesMeta:_})};return e.forEach((a,c)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))i(a,c);else for(let f of bV(a.path))i(a,c,f)}),t}function bV(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let c=bV(r.join("/")),o=[];return o.push(...c.map(f=>f===""?a:[a,f].join("/"))),i&&o.push(...c),o.map(f=>e.startsWith("/")&&f===""?"/":f)}function tle(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:cle(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var nle=/^:[\w-]+$/,rle=3,ile=2,ole=1,sle=10,ale=-2,b5=e=>e==="*";function lle(e,t){let n=e.split("/"),r=n.length;return n.some(b5)&&(r+=ale),t&&(r+=ile),n.filter(i=>!b5(i)).reduce((i,a)=>i+(nle.test(a)?rle:a===""?ole:sle),r)}function cle(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function ule(e,t,n=!1){let{routesMeta:r}=e,i={},a="/",c=[];for(let o=0;o<r.length;++o){let f=r[o],g=o===r.length-1,_=a==="/"?t:t.slice(a.length)||"/",x=sS({path:f.relativePath,caseSensitive:f.caseSensitive,end:g},_),M=f.route;if(!x&&g&&n&&!r[r.length-1].route.index&&(x=sS({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},_)),!x)return null;Object.assign(i,x.params),c.push({params:i,pathname:yc([a,x.pathname]),pathnameBase:mle(yc([a,x.pathnameBase])),route:M}),x.pathnameBase!=="/"&&(a=yc([a,x.pathnameBase]))}return c}function sS(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=hle(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],c=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((g,{paramName:_,isOptional:x},M)=>{if(_==="*"){let A=o[M]||"";c=a.slice(0,a.length-A.length).replace(/(.)\/+$/,"$1")}const C=o[M];return x&&!C?g[_]=void 0:g[_]=(C||"").replace(/%2F/g,"/"),g},{}),pathname:a,pathnameBase:c,pattern:e}}function hle(e,t=!1,n=!0){Ni(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,o,f)=>(r.push({paramName:o,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function dle(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ni(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Qa(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function fle(e,t="/"){let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?id(e):e;return{pathname:n?n.startsWith("/")?n:ple(n,t):t,search:gle(r),hash:vle(i)}}function ple(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function EE(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wV(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function W3(e){let t=wV(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function q3(e,t,n,r=!1){let i;typeof e=="string"?i=id(e):(i={...e},cr(!i.pathname||!i.pathname.includes("?"),EE("?","pathname","search",i)),cr(!i.pathname||!i.pathname.includes("#"),EE("#","pathname","hash",i)),cr(!i.search||!i.search.includes("#"),EE("#","search","hash",i)));let a=e===""||i.pathname==="",c=a?"/":i.pathname,o;if(c==null)o=n;else{let x=t.length-1;if(!r&&c.startsWith("..")){let M=c.split("/");for(;M[0]==="..";)M.shift(),x-=1;i.pathname=M.join("/")}o=x>=0?t[x]:"/"}let f=fle(i,o),g=c&&c!=="/"&&c.endsWith("/"),_=(a||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(g||_)&&(f.pathname+="/"),f}var yc=e=>e.join("/").replace(/\/\/+/g,"/"),mle=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),gle=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,vle=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,aS=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function u_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var SV=["POST","PUT","PATCH","DELETE"],yle=new Set(SV),_le=["GET",...SV],xle=new Set(_le),ble=new Set([301,302,303,307,308]),wle=new Set([307,308]),TE={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Sle={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},b0={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},X3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mle=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),MV="remix-router-transitions",CV=Symbol("ResetLoaderData");function Cle(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";cr(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.hydrationRouteProperties||[],i=e.mapRouteProperties||Mle,a={},c=oS(e.routes,i,void 0,a),o,f=e.basename||"/",g=e.dataStrategy||Ile,_={unstable_middleware:!1,...e.future},x=null,M=new Set,C=null,A=null,L=null,I=e.hydrationData!=null,T=vh(c,e.history.location,f),z=!1,k=null,U;if(T==null&&!e.patchRoutesOnNavigation){let be=Ba(404,{pathname:e.history.location.pathname}),{matches:qe,route:tt}=k5(c);U=!0,T=qe,k={[tt.id]:be}}else if(T&&!e.hydrationData&&Je(T,c,e.history.location.pathname).active&&(T=null),T)if(T.some(be=>be.route.lazy))U=!1;else if(!T.some(be=>be.route.loader))U=!0;else{let be=e.hydrationData?e.hydrationData.loaderData:null,qe=e.hydrationData?e.hydrationData.errors:null;if(qe){let tt=T.findIndex(At=>qe[At.route.id]!==void 0);U=T.slice(0,tt+1).every(At=>!TA(At.route,be,qe))}else U=T.every(tt=>!TA(tt.route,be,qe))}else{U=!1,T=[];let be=Je(null,c,e.history.location.pathname);be.active&&be.matches&&(z=!0,T=be.matches)}let H,V={historyAction:e.history.action,location:e.history.location,matches:T,initialized:U,navigation:TE,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||k,fetchers:new Map,blockers:new Map},q="POP",J=!1,Y,N=!1,ne=new Map,ye=null,ge=!1,Ne=!1,Ae=new Set,ve=new Map,Se=0,Me=-1,Ue=new Map,Qe=new Set,st=new Map,ct=new Map,Xt=new Set,je=new Map,lt,Ot=null;function ut(){if(x=e.history.listen(({action:be,location:qe,delta:tt})=>{if(lt){lt(),lt=void 0;return}Ni(je.size===0||tt!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let At=Ve({currentLocation:V.location,nextLocation:qe,historyAction:be});if(At&&tt!=null){let Ht=new Promise(Yt=>{lt=Yt});e.history.go(tt*-1),Te(At,{state:"blocked",location:qe,proceed(){Te(At,{state:"proceeding",proceed:void 0,reset:void 0,location:qe}),Ht.then(()=>e.history.go(tt))},reset(){let Yt=new Map(V.blockers);Yt.set(At,b0),Ct({blockers:Yt})}});return}return We(be,qe)}),n){$le(t,ne);let be=()=>Vle(t,ne);t.addEventListener("pagehide",be),ye=()=>t.removeEventListener("pagehide",be)}return V.initialized||We("POP",V.location,{initialHydration:!0}),H}function ot(){x&&x(),ye&&ye(),M.clear(),Y&&Y.abort(),V.fetchers.forEach((be,qe)=>kt(qe)),V.blockers.forEach((be,qe)=>le(qe))}function Tt(be){return M.add(be),()=>M.delete(be)}function Ct(be,qe={}){V={...V,...be};let tt=[],At=[];V.fetchers.forEach((Ht,Yt)=>{Ht.state==="idle"&&(Xt.has(Yt)?tt.push(Yt):At.push(Yt))}),Xt.forEach(Ht=>{!V.fetchers.has(Ht)&&!ve.has(Ht)&&tt.push(Ht)}),[...M].forEach(Ht=>Ht(V,{deletedFetchers:tt,viewTransitionOpts:qe.viewTransitionOpts,flushSync:qe.flushSync===!0})),tt.forEach(Ht=>kt(Ht)),At.forEach(Ht=>V.fetchers.delete(Ht))}function un(be,qe,{flushSync:tt}={}){var gt,In;let At=V.actionData!=null&&V.navigation.formMethod!=null&&da(V.navigation.formMethod)&&V.navigation.state==="loading"&&((gt=be.state)==null?void 0:gt._isRedirect)!==!0,Ht;qe.actionData?Object.keys(qe.actionData).length>0?Ht=qe.actionData:Ht=null:At?Ht=V.actionData:Ht=null;let Yt=qe.loaderData?R5(V.loaderData,qe.loaderData,qe.matches||[],qe.errors):V.loaderData,qt=V.blockers;qt.size>0&&(qt=new Map(qt),qt.forEach((cn,Nn)=>qt.set(Nn,b0)));let Gt=J===!0||V.navigation.formMethod!=null&&da(V.navigation.formMethod)&&((In=be.state)==null?void 0:In._isRedirect)!==!0;o&&(c=o,o=void 0),ge||q==="POP"||(q==="PUSH"?e.history.push(be,be.state):q==="REPLACE"&&e.history.replace(be,be.state));let yn;if(q==="POP"){let cn=ne.get(V.location.pathname);cn&&cn.has(be.pathname)?yn={currentLocation:V.location,nextLocation:be}:ne.has(be.pathname)&&(yn={currentLocation:be,nextLocation:V.location})}else if(N){let cn=ne.get(V.location.pathname);cn?cn.add(be.pathname):(cn=new Set([be.pathname]),ne.set(V.location.pathname,cn)),yn={currentLocation:V.location,nextLocation:be}}Ct({...qe,actionData:Ht,loaderData:Yt,historyAction:q,location:be,initialized:!0,navigation:TE,revalidation:"idle",restoreScrollPosition:ze(be,qe.matches||V.matches),preventScrollReset:Gt,blockers:qt},{viewTransitionOpts:yn,flushSync:tt===!0}),q="POP",J=!1,N=!1,ge=!1,Ne=!1,Ot==null||Ot.resolve(),Ot=null}async function gn(be,qe){if(typeof be=="number"){e.history.go(be);return}let tt=EA(V.location,V.matches,f,be,qe==null?void 0:qe.fromRouteId,qe==null?void 0:qe.relative),{path:At,submission:Ht,error:Yt}=w5(!1,tt,qe),qt=V.location,Gt=c_(V.location,At,qe&&qe.state);Gt={...Gt,...e.history.encodeLocation(Gt)};let yn=qe&&qe.replace!=null?qe.replace:void 0,gt="PUSH";yn===!0?gt="REPLACE":yn===!1||Ht!=null&&da(Ht.formMethod)&&Ht.formAction===V.location.pathname+V.location.search&&(gt="REPLACE");let In=qe&&"preventScrollReset"in qe?qe.preventScrollReset===!0:void 0,cn=(qe&&qe.flushSync)===!0,Nn=Ve({currentLocation:qt,nextLocation:Gt,historyAction:gt});if(Nn){Te(Nn,{state:"blocked",location:Gt,proceed(){Te(Nn,{state:"proceeding",proceed:void 0,reset:void 0,location:Gt}),gn(be,qe)},reset(){let xt=new Map(V.blockers);xt.set(Nn,b0),Ct({blockers:xt})}});return}await We(gt,Gt,{submission:Ht,pendingError:Yt,preventScrollReset:In,replace:qe&&qe.replace,enableViewTransition:qe&&qe.viewTransition,flushSync:cn})}function hn(){Ot||(Ot=jle()),It(),Ct({revalidation:"loading"});let be=Ot.promise;return V.navigation.state==="submitting"?be:V.navigation.state==="idle"?(We(V.historyAction,V.location,{startUninterruptedRevalidation:!0}),be):(We(q||V.historyAction,V.navigation.location,{overrideNavigation:V.navigation,enableViewTransition:N===!0}),be)}async function We(be,qe,tt){Y&&Y.abort(),Y=null,q=be,ge=(tt&&tt.startUninterruptedRevalidation)===!0,De(V.location,V.matches),J=(tt&&tt.preventScrollReset)===!0,N=(tt&&tt.enableViewTransition)===!0;let At=o||c,Ht=tt&&tt.overrideNavigation,Yt=tt!=null&&tt.initialHydration&&V.matches&&V.matches.length>0&&!z?V.matches:vh(At,qe,f),qt=(tt&&tt.flushSync)===!0;if(Yt&&V.initialized&&!Ne&&Ole(V.location,qe)&&!(tt&&tt.submission&&da(tt.submission.formMethod))){un(qe,{matches:Yt},{flushSync:qt});return}let Gt=Je(Yt,At,qe.pathname);if(Gt.active&&Gt.matches&&(Yt=Gt.matches),!Yt){let{error:Rt,notFoundMatches:Wt,route:pn}=fe(qe.pathname);un(qe,{matches:Wt,loaderData:{},errors:{[pn.id]:Rt}},{flushSync:qt});return}Y=new AbortController;let yn=vm(e.history,qe,Y.signal,tt&&tt.submission),gt=new x5(e.unstable_getContext?await e.unstable_getContext():void 0),In;if(tt&&tt.pendingError)In=[df(Yt).route.id,{type:"error",error:tt.pendingError}];else if(tt&&tt.submission&&da(tt.submission.formMethod)){let Rt=await vn(yn,qe,tt.submission,Yt,gt,Gt.active,tt&&tt.initialHydration===!0,{replace:tt.replace,flushSync:qt});if(Rt.shortCircuited)return;if(Rt.pendingActionResult){let[Wt,pn]=Rt.pendingActionResult;if(ha(pn)&&u_(pn.error)&&pn.error.status===404){Y=null,un(qe,{matches:Rt.matches,loaderData:{},errors:{[Wt]:pn.error}});return}}Yt=Rt.matches||Yt,In=Rt.pendingActionResult,Ht=PE(qe,tt.submission),qt=!1,Gt.active=!1,yn=vm(e.history,yn.url,yn.signal)}let{shortCircuited:cn,matches:Nn,loaderData:xt,errors:Ze}=await Ut(yn,qe,Yt,gt,Gt.active,Ht,tt&&tt.submission,tt&&tt.fetcherSubmission,tt&&tt.replace,tt&&tt.initialHydration===!0,qt,In);cn||(Y=null,un(qe,{matches:Nn||Yt,...L5(In),loaderData:xt,errors:Ze}))}async function vn(be,qe,tt,At,Ht,Yt,qt,Gt={}){It();let yn=Ble(qe,tt);if(Ct({navigation:yn},{flushSync:Gt.flushSync===!0}),Yt){let cn=await Oe(At,qe.pathname,be.signal);if(cn.type==="aborted")return{shortCircuited:!0};if(cn.type==="error"){let Nn=df(cn.partialMatches).route.id;return{matches:cn.partialMatches,pendingActionResult:[Nn,{type:"error",error:cn.error}]}}else if(cn.matches)At=cn.matches;else{let{notFoundMatches:Nn,error:xt,route:Ze}=fe(qe.pathname);return{matches:Nn,pendingActionResult:[Ze.id,{type:"error",error:xt}]}}}let gt,In=W0(At,qe);if(!In.route.action&&!In.route.lazy)gt={type:"error",error:Ba(405,{method:be.method,pathname:qe.pathname,routeId:In.route.id})};else{let cn=rg(i,a,be,At,In,qt?[]:r,Ht),Nn=await it(be,cn,Ht,null);if(gt=Nn[In.route.id],!gt){for(let xt of At)if(Nn[xt.route.id]){gt=Nn[xt.route.id];break}}if(be.signal.aborted)return{shortCircuited:!0}}if(xf(gt)){let cn;return Gt&&Gt.replace!=null?cn=Gt.replace:cn=P5(gt.response.headers.get("Location"),new URL(be.url),f)===V.location.pathname+V.location.search,await me(be,gt,!0,{submission:tt,replace:cn}),{shortCircuited:!0}}if(ha(gt)){let cn=df(At,In.route.id);return(Gt&&Gt.replace)!==!0&&(q="PUSH"),{matches:At,pendingActionResult:[cn.route.id,gt,In.route.id]}}return{matches:At,pendingActionResult:[In.route.id,gt]}}async function Ut(be,qe,tt,At,Ht,Yt,qt,Gt,yn,gt,In,cn){let Nn=Yt||PE(qe,qt),xt=qt||Gt||z5(Nn),Ze=!ge&&!gt;if(Ht){if(Ze){let ln=tn(cn);Ct({navigation:Nn,...ln!==void 0?{actionData:ln}:{}},{flushSync:In})}let Qt=await Oe(tt,qe.pathname,be.signal);if(Qt.type==="aborted")return{shortCircuited:!0};if(Qt.type==="error"){let ln=df(Qt.partialMatches).route.id;return{matches:Qt.partialMatches,loaderData:{},errors:{[ln]:Qt.error}}}else if(Qt.matches)tt=Qt.matches;else{let{error:ln,notFoundMatches:Nt,route:zn}=fe(qe.pathname);return{matches:Nt,loaderData:{},errors:{[zn.id]:ln}}}}let Rt=o||c,{dsMatches:Wt,revalidatingFetchers:pn}=S5(be,At,i,a,e.history,V,tt,xt,qe,gt?[]:r,gt===!0,Ne,Ae,Xt,st,Qe,Rt,f,e.patchRoutesOnNavigation!=null,cn);if(Me=++Se,!e.dataStrategy&&!Wt.some(Qt=>Qt.shouldLoad)&&pn.length===0){let Qt=te();return un(qe,{matches:tt,loaderData:{},errors:cn&&ha(cn[1])?{[cn[0]]:cn[1].error}:null,...L5(cn),...Qt?{fetchers:new Map(V.fetchers)}:{}},{flushSync:In}),{shortCircuited:!0}}if(Ze){let Qt={};if(!Ht){Qt.navigation=Nn;let ln=tn(cn);ln!==void 0&&(Qt.actionData=ln)}pn.length>0&&(Qt.fetchers=Dt(pn)),Ct(Qt,{flushSync:In})}pn.forEach(Qt=>{zt(Qt.key),Qt.controller&&ve.set(Qt.key,Qt.controller)});let ur=()=>pn.forEach(Qt=>zt(Qt.key));Y&&Y.signal.addEventListener("abort",ur);let{loaderResults:Xn,fetcherResults:pe}=await St(Wt,pn,be,At);if(be.signal.aborted)return{shortCircuited:!0};Y&&Y.signal.removeEventListener("abort",ur),pn.forEach(Qt=>ve.delete(Qt.key));let nt=q1(Xn);if(nt)return await me(be,nt.result,!0,{replace:yn}),{shortCircuited:!0};if(nt=q1(pe),nt)return Qe.add(nt.key),await me(be,nt.result,!0,{replace:yn}),{shortCircuited:!0};let{loaderData:vt,errors:ft}=I5(V,tt,Xn,cn,pn,pe);gt&&V.errors&&(ft={...V.errors,...ft});let at=te(),Kt=re(Me),fn=at||Kt||pn.length>0;return{matches:tt,loaderData:vt,errors:ft,...fn?{fetchers:new Map(V.fetchers)}:{}}}function tn(be){if(be&&!ha(be[1]))return{[be[0]]:be[1].data};if(V.actionData)return Object.keys(V.actionData).length===0?null:V.actionData}function Dt(be){return be.forEach(qe=>{let tt=V.fetchers.get(qe.key),At=w0(void 0,tt?tt.data:void 0);V.fetchers.set(qe.key,At)}),new Map(V.fetchers)}async function An(be,qe,tt,At){zt(be);let Ht=(At&&At.flushSync)===!0,Yt=o||c,qt=EA(V.location,V.matches,f,tt,qe,At==null?void 0:At.relative),Gt=vh(Yt,qt,f),yn=Je(Gt,Yt,qt);if(yn.active&&yn.matches&&(Gt=yn.matches),!Gt){Zt(be,qe,Ba(404,{pathname:qt}),{flushSync:Ht});return}let{path:gt,submission:In,error:cn}=w5(!0,qt,At);if(cn){Zt(be,qe,cn,{flushSync:Ht});return}let Nn=W0(Gt,gt),xt=new x5(e.unstable_getContext?await e.unstable_getContext():void 0),Ze=(At&&At.preventScrollReset)===!0;if(In&&da(In.formMethod)){await an(be,qe,gt,Nn,Gt,xt,yn.active,Ht,Ze,In);return}st.set(be,{routeId:qe,path:gt}),await Le(be,qe,gt,Nn,Gt,xt,yn.active,Ht,Ze,In)}async function an(be,qe,tt,At,Ht,Yt,qt,Gt,yn,gt){It(),st.delete(be);function In(Rn){if(!Rn.route.action&&!Rn.route.lazy){let jn=Ba(405,{method:gt.formMethod,pathname:tt,routeId:qe});return Zt(be,qe,jn,{flushSync:Gt}),!0}return!1}if(!qt&&In(At))return;let cn=V.fetchers.get(be);wt(be,Ule(gt,cn),{flushSync:Gt});let Nn=new AbortController,xt=vm(e.history,tt,Nn.signal,gt);if(qt){let Rn=await Oe(Ht,tt,xt.signal,be);if(Rn.type==="aborted")return;if(Rn.type==="error"){Zt(be,qe,Rn.error,{flushSync:Gt});return}else if(Rn.matches){if(Ht=Rn.matches,At=W0(Ht,tt),In(At))return}else{Zt(be,qe,Ba(404,{pathname:tt}),{flushSync:Gt});return}}ve.set(be,Nn);let Ze=Se,Rt=rg(i,a,xt,Ht,At,r,Yt),pn=(await it(xt,Rt,Yt,be))[At.route.id];if(xt.signal.aborted){ve.get(be)===Nn&&ve.delete(be);return}if(Xt.has(be)){if(xf(pn)||ha(pn)){wt(be,ch(void 0));return}}else{if(xf(pn))if(ve.delete(be),Me>Ze){wt(be,ch(void 0));return}else return Qe.add(be),wt(be,w0(gt)),me(xt,pn,!1,{fetcherSubmission:gt,preventScrollReset:yn});if(ha(pn)){Zt(be,qe,pn.error);return}}let ur=V.navigation.location||V.location,Xn=vm(e.history,ur,Nn.signal),pe=o||c,nt=V.navigation.state!=="idle"?vh(pe,V.navigation.location,f):V.matches;cr(nt,"Didn't find any matches after fetcher action");let vt=++Se;Ue.set(be,vt);let ft=w0(gt,pn.data);V.fetchers.set(be,ft);let{dsMatches:at,revalidatingFetchers:Kt}=S5(Xn,Yt,i,a,e.history,V,nt,gt,ur,r,!1,Ne,Ae,Xt,st,Qe,pe,f,e.patchRoutesOnNavigation!=null,[At.route.id,pn]);Kt.filter(Rn=>Rn.key!==be).forEach(Rn=>{let jn=Rn.key,fr=V.fetchers.get(jn),pr=w0(void 0,fr?fr.data:void 0);V.fetchers.set(jn,pr),zt(jn),Rn.controller&&ve.set(jn,Rn.controller)}),Ct({fetchers:new Map(V.fetchers)});let fn=()=>Kt.forEach(Rn=>zt(Rn.key));Nn.signal.addEventListener("abort",fn);let{loaderResults:Qt,fetcherResults:ln}=await St(at,Kt,Xn,Yt);if(Nn.signal.aborted)return;if(Nn.signal.removeEventListener("abort",fn),Ue.delete(be),ve.delete(be),Kt.forEach(Rn=>ve.delete(Rn.key)),V.fetchers.has(be)){let Rn=ch(pn.data);V.fetchers.set(be,Rn)}let Nt=q1(Qt);if(Nt)return me(Xn,Nt.result,!1,{preventScrollReset:yn});if(Nt=q1(ln),Nt)return Qe.add(Nt.key),me(Xn,Nt.result,!1,{preventScrollReset:yn});let{loaderData:zn,errors:_n}=I5(V,nt,Qt,void 0,Kt,ln);re(vt),V.navigation.state==="loading"&&vt>Me?(cr(q,"Expected pending action"),Y&&Y.abort(),un(V.navigation.location,{matches:nt,loaderData:zn,errors:_n,fetchers:new Map(V.fetchers)})):(Ct({errors:_n,loaderData:R5(V.loaderData,zn,nt,_n),fetchers:new Map(V.fetchers)}),Ne=!1)}async function Le(be,qe,tt,At,Ht,Yt,qt,Gt,yn,gt){let In=V.fetchers.get(be);wt(be,w0(gt,In?In.data:void 0),{flushSync:Gt});let cn=new AbortController,Nn=vm(e.history,tt,cn.signal);if(qt){let pn=await Oe(Ht,tt,Nn.signal,be);if(pn.type==="aborted")return;if(pn.type==="error"){Zt(be,qe,pn.error,{flushSync:Gt});return}else if(pn.matches)Ht=pn.matches,At=W0(Ht,tt);else{Zt(be,qe,Ba(404,{pathname:tt}),{flushSync:Gt});return}}ve.set(be,cn);let xt=Se,Ze=rg(i,a,Nn,Ht,At,r,Yt),Wt=(await it(Nn,Ze,Yt,be))[At.route.id];if(ve.get(be)===cn&&ve.delete(be),!Nn.signal.aborted){if(Xt.has(be)){wt(be,ch(void 0));return}if(xf(Wt))if(Me>xt){wt(be,ch(void 0));return}else{Qe.add(be),await me(Nn,Wt,!1,{preventScrollReset:yn});return}if(ha(Wt)){Zt(be,qe,Wt.error);return}wt(be,ch(Wt.data))}}async function me(be,qe,tt,{submission:At,fetcherSubmission:Ht,preventScrollReset:Yt,replace:qt}={}){qe.response.headers.has("X-Remix-Revalidate")&&(Ne=!0);let Gt=qe.response.headers.get("Location");cr(Gt,"Expected a Location header on the redirect Response"),Gt=P5(Gt,new URL(be.url),f);let yn=c_(V.location,Gt,{_isRedirect:!0});if(n){let Ze=!1;if(qe.response.headers.has("X-Remix-Reload-Document"))Ze=!0;else if(X3.test(Gt)){const Rt=_V(Gt,!0);Ze=Rt.origin!==t.location.origin||Qa(Rt.pathname,f)==null}if(Ze){qt?t.location.replace(Gt):t.location.assign(Gt);return}}Y=null;let gt=qt===!0||qe.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:In,formAction:cn,formEncType:Nn}=V.navigation;!At&&!Ht&&In&&cn&&Nn&&(At=z5(V.navigation));let xt=At||Ht;if(wle.has(qe.response.status)&&xt&&da(xt.formMethod))await We(gt,yn,{submission:{...xt,formAction:Gt},preventScrollReset:Yt||J,enableViewTransition:tt?N:void 0});else{let Ze=PE(yn,At);await We(gt,yn,{overrideNavigation:Ze,fetcherSubmission:Ht,preventScrollReset:Yt||J,enableViewTransition:tt?N:void 0})}}async function it(be,qe,tt,At){let Ht,Yt={};try{Ht=await Rle(g,be,qe,At,tt,!1)}catch(qt){return qe.filter(Gt=>Gt.shouldLoad).forEach(Gt=>{Yt[Gt.route.id]={type:"error",error:qt}}),Yt}if(be.signal.aborted)return Yt;for(let[qt,Gt]of Object.entries(Ht))if(Fle(Gt)){let yn=Gt.result;Yt[qt]={type:"redirect",response:Dle(yn,be,qt,qe,f)}}else Yt[qt]=await kle(Gt);return Yt}async function St(be,qe,tt,At){let Ht=it(tt,be,At,null),Yt=Promise.all(qe.map(async yn=>{if(yn.matches&&yn.match&&yn.request&&yn.controller){let In=(await it(yn.request,yn.matches,At,yn.key))[yn.match.route.id];return{[yn.key]:In}}else return Promise.resolve({[yn.key]:{type:"error",error:Ba(404,{pathname:yn.path})}})})),qt=await Ht,Gt=(await Yt).reduce((yn,gt)=>Object.assign(yn,gt),{});return{loaderResults:qt,fetcherResults:Gt}}function It(){Ne=!0,st.forEach((be,qe)=>{ve.has(qe)&&Ae.add(qe),zt(qe)})}function wt(be,qe,tt={}){V.fetchers.set(be,qe),Ct({fetchers:new Map(V.fetchers)},{flushSync:(tt&&tt.flushSync)===!0})}function Zt(be,qe,tt,At={}){let Ht=df(V.matches,qe);kt(be),Ct({errors:{[Ht.route.id]:tt},fetchers:new Map(V.fetchers)},{flushSync:(At&&At.flushSync)===!0})}function Lt(be){return ct.set(be,(ct.get(be)||0)+1),Xt.has(be)&&Xt.delete(be),V.fetchers.get(be)||Sle}function kt(be){let qe=V.fetchers.get(be);ve.has(be)&&!(qe&&qe.state==="loading"&&Ue.has(be))&&zt(be),st.delete(be),Ue.delete(be),Qe.delete(be),Xt.delete(be),Ae.delete(be),V.fetchers.delete(be)}function bn(be){let qe=(ct.get(be)||0)-1;qe<=0?(ct.delete(be),Xt.add(be)):ct.set(be,qe),Ct({fetchers:new Map(V.fetchers)})}function zt(be){let qe=ve.get(be);qe&&(qe.abort(),ve.delete(be))}function _e(be){for(let qe of be){let tt=Lt(qe),At=ch(tt.data);V.fetchers.set(qe,At)}}function te(){let be=[],qe=!1;for(let tt of Qe){let At=V.fetchers.get(tt);cr(At,`Expected fetcher: ${tt}`),At.state==="loading"&&(Qe.delete(tt),be.push(tt),qe=!0)}return _e(be),qe}function re(be){let qe=[];for(let[tt,At]of Ue)if(At<be){let Ht=V.fetchers.get(tt);cr(Ht,`Expected fetcher: ${tt}`),Ht.state==="loading"&&(zt(tt),Ue.delete(tt),qe.push(tt))}return _e(qe),qe.length>0}function Z(be,qe){let tt=V.blockers.get(be)||b0;return je.get(be)!==qe&&je.set(be,qe),tt}function le(be){V.blockers.delete(be),je.delete(be)}function Te(be,qe){let tt=V.blockers.get(be)||b0;cr(tt.state==="unblocked"&&qe.state==="blocked"||tt.state==="blocked"&&qe.state==="blocked"||tt.state==="blocked"&&qe.state==="proceeding"||tt.state==="blocked"&&qe.state==="unblocked"||tt.state==="proceeding"&&qe.state==="unblocked",`Invalid blocker state transition: ${tt.state} -> ${qe.state}`);let At=new Map(V.blockers);At.set(be,qe),Ct({blockers:At})}function Ve({currentLocation:be,nextLocation:qe,historyAction:tt}){if(je.size===0)return;je.size>1&&Ni(!1,"A router only supports one blocker at a time");let At=Array.from(je.entries()),[Ht,Yt]=At[At.length-1],qt=V.blockers.get(Ht);if(!(qt&&qt.state==="proceeding")&&Yt({currentLocation:be,nextLocation:qe,historyAction:tt}))return Ht}function fe(be){let qe=Ba(404,{pathname:be}),tt=o||c,{matches:At,route:Ht}=k5(tt);return{notFoundMatches:At,route:Ht,error:qe}}function xe(be,qe,tt){if(C=be,L=qe,A=tt||null,!I&&V.navigation===TE){I=!0;let At=ze(V.location,V.matches);At!=null&&Ct({restoreScrollPosition:At})}return()=>{C=null,L=null,A=null}}function Re(be,qe){return A&&A(be,qe.map(At=>ele(At,V.loaderData)))||be.key}function De(be,qe){if(C&&L){let tt=Re(be,qe);C[tt]=L()}}function ze(be,qe){if(C){let tt=Re(be,qe),At=C[tt];if(typeof At=="number")return At}return null}function Je(be,qe,tt){if(e.patchRoutesOnNavigation)if(be){if(Object.keys(be[0].params).length>0)return{active:!0,matches:tw(qe,tt,f,!0)}}else return{active:!0,matches:tw(qe,tt,f,!0)||[]};return{active:!1,matches:null}}async function Oe(be,qe,tt,At){if(!e.patchRoutesOnNavigation)return{type:"success",matches:be};let Ht=be;for(;;){let Yt=o==null,qt=o||c,Gt=a;try{await e.patchRoutesOnNavigation({signal:tt,path:qe,matches:Ht,fetcherKey:At,patch:(In,cn)=>{tt.aborted||M5(In,cn,qt,Gt,i)}})}catch(In){return{type:"error",error:In,partialMatches:Ht}}finally{Yt&&!tt.aborted&&(c=[...c])}if(tt.aborted)return{type:"aborted"};let yn=vh(qt,qe,f);if(yn)return{type:"success",matches:yn};let gt=tw(qt,qe,f,!0);if(!gt||Ht.length===gt.length&&Ht.every((In,cn)=>In.route.id===gt[cn].route.id))return{type:"success",matches:null};Ht=gt}}function Et(be){a={},o=oS(be,i,void 0,a)}function Ft(be,qe){let tt=o==null;M5(be,qe,o||c,a,i),tt&&(c=[...c],Ct({}))}return H={get basename(){return f},get future(){return _},get state(){return V},get routes(){return c},get window(){return t},initialize:ut,subscribe:Tt,enableScrollRestoration:xe,navigate:gn,fetch:An,revalidate:hn,createHref:be=>e.history.createHref(be),encodeLocation:be=>e.history.encodeLocation(be),getFetcher:Lt,deleteFetcher:bn,dispose:ot,getBlocker:Z,deleteBlocker:le,patchRoutes:Ft,_internalFetchControllers:ve,_internalSetRoutes:Et},H}function Ele(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function EA(e,t,n,r,i,a){let c,o;if(i){c=[];for(let g of t)if(c.push(g),g.route.id===i){o=g;break}}else c=t,o=t[t.length-1];let f=q3(r||".",W3(c),Qa(e.pathname,n)||e.pathname,a==="path");if(r==null&&(f.search=e.search,f.hash=e.hash),(r==null||r===""||r===".")&&o){let g=Z3(f.search);if(o.route.index&&!g)f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index";else if(!o.route.index&&g){let _=new URLSearchParams(f.search),x=_.getAll("index");_.delete("index"),x.filter(C=>C).forEach(C=>_.append("index",C));let M=_.toString();f.search=M?`?${M}`:""}}return n!=="/"&&(f.pathname=f.pathname==="/"?n:yc([n,f.pathname])),$h(f)}function w5(e,t,n){if(!n||!Ele(n))return{path:t};if(n.formMethod&&!Nle(n.formMethod))return{path:t,error:Ba(405,{method:n.formMethod})};let r=()=>({path:t,error:Ba(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),c=RV(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!da(a))return r();let x=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((M,[C,A])=>`${M}${C}=${A}
`,""):String(n.body);return{path:t,submission:{formMethod:a,formAction:c,formEncType:n.formEncType,formData:void 0,json:void 0,text:x}}}else if(n.formEncType==="application/json"){if(!da(a))return r();try{let x=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:a,formAction:c,formEncType:n.formEncType,formData:void 0,json:x,text:void 0}}}catch{return r()}}}cr(typeof FormData=="function","FormData is not available in this environment");let o,f;if(n.formData)o=AA(n.formData),f=n.formData;else if(n.body instanceof FormData)o=AA(n.body),f=n.body;else if(n.body instanceof URLSearchParams)o=n.body,f=A5(o);else if(n.body==null)o=new URLSearchParams,f=new FormData;else try{o=new URLSearchParams(n.body),f=A5(o)}catch{return r()}let g={formMethod:a,formAction:c,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:f,json:void 0,text:void 0};if(da(g.formMethod))return{path:t,submission:g};let _=id(t);return e&&_.search&&Z3(_.search)&&o.append("index",""),_.search=`?${o}`,{path:$h(_),submission:g}}function S5(e,t,n,r,i,a,c,o,f,g,_,x,M,C,A,L,I,T,z,k){var ge;let U=k?ha(k[1])?k[1].error:k[1].data:void 0,H=i.createURL(a.location),V=i.createURL(f),q;if(_&&a.errors){let Ne=Object.keys(a.errors)[0];q=c.findIndex(Ae=>Ae.route.id===Ne)}else if(k&&ha(k[1])){let Ne=k[0];q=c.findIndex(Ae=>Ae.route.id===Ne)-1}let J=k?k[1].statusCode:void 0,Y=J&&J>=400,N={currentUrl:H,currentParams:((ge=a.matches[0])==null?void 0:ge.params)||{},nextUrl:V,nextParams:c[0].params,...o,actionResult:U,actionStatus:J},ne=c.map((Ne,Ae)=>{let{route:ve}=Ne,Se=null;if(q!=null&&Ae>q?Se=!1:ve.lazy?Se=!0:ve.loader==null?Se=!1:_?Se=TA(ve,a.loaderData,a.errors):Tle(a.loaderData,a.matches[Ae],Ne)&&(Se=!0),Se!==null)return PA(n,r,e,Ne,g,t,Se);let Me=Y?!1:x||H.pathname+H.search===V.pathname+V.search||H.search!==V.search||Ple(a.matches[Ae],Ne),Ue={...N,defaultShouldRevalidate:Me},Qe=lS(Ne,Ue);return PA(n,r,e,Ne,g,t,Qe,Ue)}),ye=[];return A.forEach((Ne,Ae)=>{if(_||!c.some(Xt=>Xt.route.id===Ne.routeId)||C.has(Ae))return;let ve=a.fetchers.get(Ae),Se=ve&&ve.state!=="idle"&&ve.data===void 0,Me=vh(I,Ne.path,T);if(!Me){if(z&&Se)return;ye.push({key:Ae,routeId:Ne.routeId,path:Ne.path,matches:null,match:null,request:null,controller:null});return}if(L.has(Ae))return;let Ue=W0(Me,Ne.path),Qe=new AbortController,st=vm(i,Ne.path,Qe.signal),ct=null;if(M.has(Ae))M.delete(Ae),ct=rg(n,r,st,Me,Ue,g,t);else if(Se)x&&(ct=rg(n,r,st,Me,Ue,g,t));else{let Xt={...N,defaultShouldRevalidate:Y?!1:x};lS(Ue,Xt)&&(ct=rg(n,r,st,Me,Ue,g,t,Xt))}ct&&ye.push({key:Ae,routeId:Ne.routeId,path:Ne.path,matches:ct,match:Ue,request:st,controller:Qe})}),{dsMatches:ne,revalidatingFetchers:ye}}function TA(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&e.id in t,i=n!=null&&n[e.id]!==void 0;return!r&&i?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!i}function Tle(e,t,n){let r=!t||n.route.id!==t.route.id,i=!e.hasOwnProperty(n.route.id);return r||i}function Ple(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function lS(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function M5(e,t,n,r,i){let a;if(e){let f=r[e];cr(f,`No route found to patch children into: routeId = ${e}`),f.children||(f.children=[]),a=f.children}else a=n;let c=t.filter(f=>!a.some(g=>EV(f,g))),o=oS(c,i,[e||"_","patch",String((a==null?void 0:a.length)||"0")],r);a.push(...o)}function EV(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var i;return(i=t.children)==null?void 0:i.some(a=>EV(n,a))}):!1}var C5=new WeakMap,TV=({key:e,route:t,manifest:n,mapRouteProperties:r})=>{let i=n[t.id];if(cr(i,"No route found in manifest"),!i.lazy||typeof i.lazy!="object")return;let a=i.lazy[e];if(!a)return;let c=C5.get(i);c||(c={},C5.set(i,c));let o=c[e];if(o)return o;let f=(async()=>{let g=Yae(e),x=i[e]!==void 0&&e!=="hasErrorBoundary";if(g)Ni(!g,"Route property "+e+" is not a supported lazy route property. This property will be ignored."),c[e]=Promise.resolve();else if(x)Ni(!1,`Route "${i.id}" has a static property "${e}" defined. The lazy property will be ignored.`);else{let M=await a();M!=null&&(Object.assign(i,{[e]:M}),Object.assign(i,r(i)))}typeof i.lazy=="object"&&(i.lazy[e]=void 0,Object.values(i.lazy).every(M=>M===void 0)&&(i.lazy=void 0))})();return c[e]=f,f},E5=new WeakMap;function Ale(e,t,n,r,i){let a=n[e.id];if(cr(a,"No route found in manifest"),!e.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof e.lazy=="function"){let _=E5.get(a);if(_)return{lazyRoutePromise:_,lazyHandlerPromise:_};let x=(async()=>{cr(typeof e.lazy=="function","No lazy route function found");let M=await e.lazy(),C={};for(let A in M){let L=M[A];if(L===void 0)continue;let I=Jae(A),z=a[A]!==void 0&&A!=="hasErrorBoundary";I?Ni(!I,"Route property "+A+" is not a supported property to be returned from a lazy route function. This property will be ignored."):z?Ni(!z,`Route "${a.id}" has a static property "${A}" defined but its lazy function is also returning a value for this property. The lazy route property "${A}" will be ignored.`):C[A]=L}Object.assign(a,C),Object.assign(a,{...r(a),lazy:void 0})})();return E5.set(a,x),x.catch(()=>{}),{lazyRoutePromise:x,lazyHandlerPromise:x}}let c=Object.keys(e.lazy),o=[],f;for(let _ of c){if(i&&i.includes(_))continue;let x=TV({key:_,route:e,manifest:n,mapRouteProperties:r});x&&(o.push(x),_===t&&(f=x))}let g=o.length>0?Promise.all(o).then(()=>{}):void 0;return g==null||g.catch(()=>{}),f==null||f.catch(()=>{}),{lazyRoutePromise:g,lazyHandlerPromise:f}}async function T5(e){let t=e.matches.filter(i=>i.shouldLoad),n={};return(await Promise.all(t.map(i=>i.resolve()))).forEach((i,a)=>{n[t[a].route.id]=i}),n}async function Ile(e){return e.matches.some(t=>t.route.unstable_middleware)?PV(e,!1,()=>T5(e),(t,n)=>({[n]:{type:"error",result:t}})):T5(e)}async function PV(e,t,n,r){let{matches:i,request:a,params:c,context:o}=e,f={handlerResult:void 0};try{let g=i.flatMap(x=>x.route.unstable_middleware?x.route.unstable_middleware.map(M=>[x.route.id,M]):[]),_=await AV({request:a,params:c,context:o},g,t,f,n);return t?_:f.handlerResult}catch(g){if(!f.middlewareError)throw g;let _=await r(f.middlewareError.error,f.middlewareError.routeId);return f.handlerResult?Object.assign(f.handlerResult,_):_}}async function AV(e,t,n,r,i,a=0){let{request:c}=e;if(c.signal.aborted)throw c.signal.reason?c.signal.reason:new Error(`Request aborted without an \`AbortSignal.reason\`: ${c.method} ${c.url}`);let o=t[a];if(!o)return r.handlerResult=await i(),r.handlerResult;let[f,g]=o,_=!1,x,M=async()=>{if(_)throw new Error("You may only call `next()` once per middleware");_=!0,await AV(e,t,n,r,i,a+1)};try{let C=await g({request:e.request,params:e.params,context:e.context},M);return _?C===void 0?x:C:M()}catch(C){throw r.middlewareError?r.middlewareError.error!==C&&(r.middlewareError={routeId:f,error:C}):r.middlewareError={routeId:f,error:C},C}}function IV(e,t,n,r,i){let a=TV({key:"unstable_middleware",route:r.route,manifest:t,mapRouteProperties:e}),c=Ale(r.route,da(n.method)?"action":"loader",t,e,i);return{middleware:a,route:c.lazyRoutePromise,handler:c.lazyHandlerPromise}}function PA(e,t,n,r,i,a,c,o=null){let f=!1,g=IV(e,t,n,r,i);return{...r,_lazyPromises:g,shouldLoad:c,unstable_shouldRevalidateArgs:o,unstable_shouldCallHandler(_){return f=!0,o?typeof _=="boolean"?lS(r,{...o,defaultShouldRevalidate:_}):lS(r,o):c},resolve(_){return f||c||_&&n.method==="GET"&&(r.route.lazy||r.route.loader)?Lle({request:n,match:r,lazyHandlerPromise:g==null?void 0:g.handler,lazyRoutePromise:g==null?void 0:g.route,handlerOverride:_,scopedContext:a}):Promise.resolve({type:"data",result:void 0})}}}function rg(e,t,n,r,i,a,c,o=null){return r.map(f=>f.route.id!==i.route.id?{...f,shouldLoad:!1,unstable_shouldRevalidateArgs:o,unstable_shouldCallHandler:()=>!1,_lazyPromises:IV(e,t,n,f,a),resolve:()=>Promise.resolve({type:"data",result:void 0})}:PA(e,t,n,f,a,c,!0,o))}async function Rle(e,t,n,r,i,a){n.some(g=>{var _;return(_=g._lazyPromises)==null?void 0:_.middleware})&&await Promise.all(n.map(g=>{var _;return(_=g._lazyPromises)==null?void 0:_.middleware}));let c={request:t,params:n[0].params,context:i,matches:n},f=await e({...c,fetcherKey:r,unstable_runClientMiddleware:g=>{let _=c;return PV(_,!1,()=>g({..._,fetcherKey:r,unstable_runClientMiddleware:()=>{throw new Error("Cannot call `unstable_runClientMiddleware()` from within an `unstable_runClientMiddleware` handler")}}),(x,M)=>({[M]:{type:"error",result:x}}))}});try{await Promise.all(n.flatMap(g=>{var _,x;return[(_=g._lazyPromises)==null?void 0:_.handler,(x=g._lazyPromises)==null?void 0:x.route]}))}catch{}return f}async function Lle({request:e,match:t,lazyHandlerPromise:n,lazyRoutePromise:r,handlerOverride:i,scopedContext:a}){let c,o,f=da(e.method),g=f?"action":"loader",_=x=>{let M,C=new Promise((I,T)=>M=T);o=()=>M(),e.signal.addEventListener("abort",o);let A=I=>typeof x!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${g}" [routeId: ${t.route.id}]`)):x({request:e,params:t.params,context:a},...I!==void 0?[I]:[]),L=(async()=>{try{return{type:"data",result:await(i?i(T=>A(T)):A())}}catch(I){return{type:"error",result:I}}})();return Promise.race([L,C])};try{let x=f?t.route.action:t.route.loader;if(n||r)if(x){let M,[C]=await Promise.all([_(x).catch(A=>{M=A}),n,r]);if(M!==void 0)throw M;c=C}else{await n;let M=f?t.route.action:t.route.loader;if(M)[c]=await Promise.all([_(M),r]);else if(g==="action"){let C=new URL(e.url),A=C.pathname+C.search;throw Ba(405,{method:e.method,pathname:A,routeId:t.route.id})}else return{type:"data",result:void 0}}else if(x)c=await _(x);else{let M=new URL(e.url),C=M.pathname+M.search;throw Ba(404,{pathname:C})}}catch(x){return{type:"error",result:x}}finally{o&&e.signal.removeEventListener("abort",o)}return c}async function kle(e){var r,i,a,c,o,f;let{result:t,type:n}=e;if(LV(t)){let g;try{let _=t.headers.get("Content-Type");_&&/\bapplication\/json\b/.test(_)?t.body==null?g=null:g=await t.json():g=await t.text()}catch(_){return{type:"error",error:_}}return n==="error"?{type:"error",error:new aS(t.status,t.statusText,g),statusCode:t.status,headers:t.headers}:{type:"data",data:g,statusCode:t.status,headers:t.headers}}return n==="error"?D5(t)?t.data instanceof Error?{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"error",error:new aS(((a=t.init)==null?void 0:a.status)||500,void 0,t.data),statusCode:u_(t)?t.status:void 0,headers:(c=t.init)!=null&&c.headers?new Headers(t.init.headers):void 0}:{type:"error",error:t,statusCode:u_(t)?t.status:void 0}:D5(t)?{type:"data",data:t.data,statusCode:(o=t.init)==null?void 0:o.status,headers:(f=t.init)!=null&&f.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function Dle(e,t,n,r,i){let a=e.headers.get("Location");if(cr(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!X3.test(a)){let c=r.slice(0,r.findIndex(o=>o.route.id===n)+1);a=EA(new URL(t.url),c,i,a),e.headers.set("Location",a)}return e}function P5(e,t,n){if(X3.test(e)){let r=e,i=r.startsWith("//")?new URL(t.protocol+r):new URL(r),a=Qa(i.pathname,n)!=null;if(i.origin===t.origin&&a)return i.pathname+i.search+i.hash}return e}function vm(e,t,n,r){let i=e.createURL(RV(t)).toString(),a={signal:n};if(r&&da(r.formMethod)){let{formMethod:c,formEncType:o}=r;a.method=c.toUpperCase(),o==="application/json"?(a.headers=new Headers({"Content-Type":o}),a.body=JSON.stringify(r.json)):o==="text/plain"?a.body=r.text:o==="application/x-www-form-urlencoded"&&r.formData?a.body=AA(r.formData):a.body=r.formData}return new Request(i,a)}function AA(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function A5(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function zle(e,t,n,r=!1,i=!1){let a={},c=null,o,f=!1,g={},_=n&&ha(n[1])?n[1].error:void 0;return e.forEach(x=>{if(!(x.route.id in t))return;let M=x.route.id,C=t[M];if(cr(!xf(C),"Cannot handle redirect results in processLoaderData"),ha(C)){let A=C.error;if(_!==void 0&&(A=_,_=void 0),c=c||{},i)c[M]=A;else{let L=df(e,M);c[L.route.id]==null&&(c[L.route.id]=A)}r||(a[M]=CV),f||(f=!0,o=u_(C.error)?C.error.status:500),C.headers&&(g[M]=C.headers)}else a[M]=C.data,C.statusCode&&C.statusCode!==200&&!f&&(o=C.statusCode),C.headers&&(g[M]=C.headers)}),_!==void 0&&n&&(c={[n[0]]:_},n[2]&&(a[n[2]]=void 0)),{loaderData:a,errors:c,statusCode:o||200,loaderHeaders:g}}function I5(e,t,n,r,i,a){let{loaderData:c,errors:o}=zle(t,n,r);return i.filter(f=>!f.matches||f.matches.some(g=>g.shouldLoad)).forEach(f=>{let{key:g,match:_,controller:x}=f,M=a[g];if(cr(M,"Did not find corresponding fetcher result"),!(x&&x.signal.aborted))if(ha(M)){let C=df(e.matches,_==null?void 0:_.route.id);o&&o[C.route.id]||(o={...o,[C.route.id]:M.error}),e.fetchers.delete(g)}else if(xf(M))cr(!1,"Unhandled fetcher revalidation redirect");else{let C=ch(M.data);e.fetchers.set(g,C)}}),{loaderData:c,errors:o}}function R5(e,t,n,r){let i=Object.entries(t).filter(([,a])=>a!==CV).reduce((a,[c,o])=>(a[c]=o,a),{});for(let a of n){let c=a.route.id;if(!t.hasOwnProperty(c)&&e.hasOwnProperty(c)&&a.route.loader&&(i[c]=e[c]),r&&r.hasOwnProperty(c))break}return i}function L5(e){return e?ha(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function df(e,t){return(t?e.slice(0,e.findIndex(r=>r.route.id===t)+1):[...e]).reverse().find(r=>r.route.hasErrorBoundary===!0)||e[0]}function k5(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Ba(e,{pathname:t,routeId:n,method:r,type:i,message:a}={}){let c="Unknown Server Error",o="Unknown @remix-run/router error";return e===400?(c="Bad Request",r&&t&&n?o=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:i==="invalid-body"&&(o="Unable to encode submission body")):e===403?(c="Forbidden",o=`Route "${n}" does not match URL "${t}"`):e===404?(c="Not Found",o=`No route matches URL "${t}"`):e===405&&(c="Method Not Allowed",r&&t&&n?o=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(o=`Invalid request method "${r.toUpperCase()}"`)),new aS(e||500,c,new Error(o),!0)}function q1(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,i]=t[n];if(xf(i))return{key:r,result:i}}}function RV(e){let t=typeof e=="string"?id(e):e;return $h({...t,hash:""})}function Ole(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function Fle(e){return LV(e.result)&&ble.has(e.result.status)}function ha(e){return e.type==="error"}function xf(e){return(e&&e.type)==="redirect"}function D5(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function LV(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function Nle(e){return xle.has(e.toUpperCase())}function da(e){return yle.has(e.toUpperCase())}function Z3(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function W0(e,t){let n=typeof t=="string"?id(t).search:t.search;if(e[e.length-1].route.index&&Z3(n||""))return e[e.length-1];let r=wV(e);return r[r.length-1]}function z5(e){let{formMethod:t,formAction:n,formEncType:r,text:i,formData:a,json:c}=e;if(!(!t||!n||!r)){if(i!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(a!=null)return{formMethod:t,formAction:n,formEncType:r,formData:a,json:void 0,text:void 0};if(c!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:c,text:void 0}}}function PE(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Ble(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function w0(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function Ule(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function ch(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function $le(e,t){try{let n=e.sessionStorage.getItem(MV);if(n){let r=JSON.parse(n);for(let[i,a]of Object.entries(r||{}))a&&Array.isArray(a)&&t.set(i,new Set(a||[]))}}catch{}}function Vle(e,t){if(t.size>0){let n={};for(let[r,i]of t)n[r]=[...i];try{e.sessionStorage.setItem(MV,JSON.stringify(n))}catch(r){Ni(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function jle(){let e,t,n=new Promise((r,i)=>{e=async a=>{r(a);try{await n}catch{}},t=async a=>{i(a);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var qf=$.createContext(null);qf.displayName="DataRouter";var W_=$.createContext(null);W_.displayName="DataRouterState";var Y3=$.createContext({isTransitioning:!1});Y3.displayName="ViewTransition";var kV=$.createContext(new Map);kV.displayName="Fetchers";var Hle=$.createContext(null);Hle.displayName="Await";var Cc=$.createContext(null);Cc.displayName="Navigation";var BM=$.createContext(null);BM.displayName="Location";var xu=$.createContext({outlet:null,matches:[],isDataRoute:!1});xu.displayName="Route";var K3=$.createContext(null);K3.displayName="RouteError";function Gle(e,{relative:t}={}){cr(q_(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=$.useContext(Cc),{hash:i,pathname:a,search:c}=X_(e,{relative:t}),o=a;return n!=="/"&&(o=a==="/"?n:yc([n,a])),r.createHref({pathname:o,search:c,hash:i})}function q_(){return $.useContext(BM)!=null}function od(){return cr(q_(),"useLocation() may be used only in the context of a <Router> component."),$.useContext(BM).location}var DV="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function zV(e){$.useContext(Cc).static||$.useLayoutEffect(e)}function OV(){let{isDataRoute:e}=$.useContext(xu);return e?ice():Wle()}function Wle(){cr(q_(),"useNavigate() may be used only in the context of a <Router> component.");let e=$.useContext(qf),{basename:t,navigator:n}=$.useContext(Cc),{matches:r}=$.useContext(xu),{pathname:i}=od(),a=JSON.stringify(W3(r)),c=$.useRef(!1);return zV(()=>{c.current=!0}),$.useCallback((f,g={})=>{if(Ni(c.current,DV),!c.current)return;if(typeof f=="number"){n.go(f);return}let _=q3(f,JSON.parse(a),i,g.relative==="path");e==null&&t!=="/"&&(_.pathname=_.pathname==="/"?t:yc([t,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[t,n,a,i,e])}$.createContext(null);function X_(e,{relative:t}={}){let{matches:n}=$.useContext(xu),{pathname:r}=od(),i=JSON.stringify(W3(n));return $.useMemo(()=>q3(e,JSON.parse(i),r,t==="path"),[e,i,r,t])}function qle(e,t,n,r){cr(q_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=$.useContext(Cc),{matches:a}=$.useContext(xu),c=a[a.length-1],o=c?c.params:{},f=c?c.pathname:"/",g=c?c.pathnameBase:"/",_=c&&c.route;{let T=_&&_.path||"";FV(f,!_||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let x=od(),M;M=x;let C=M.pathname||"/",A=C;if(g!=="/"){let T=g.replace(/^\//,"").split("/");A="/"+C.replace(/^\//,"").split("/").slice(T.length).join("/")}let L=vh(e,{pathname:A});return Ni(_||L!=null,`No routes matched location "${M.pathname}${M.search}${M.hash}" `),Ni(L==null||L[L.length-1].route.element!==void 0||L[L.length-1].route.Component!==void 0||L[L.length-1].route.lazy!==void 0,`Matched leaf route at location "${M.pathname}${M.search}${M.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),Jle(L&&L.map(T=>Object.assign({},T,{params:Object.assign({},o,T.params),pathname:yc([g,i.encodeLocation?i.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?g:yc([g,i.encodeLocation?i.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),a,n,r)}function Xle(){let e=rce(),t=u_(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},c=null;return console.error("Error handled by React Router default ErrorBoundary:",e),c=$.createElement($.Fragment,null,$.createElement("p",null," Hey developer "),$.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",$.createElement("code",{style:a},"ErrorBoundary")," or"," ",$.createElement("code",{style:a},"errorElement")," prop on your route.")),$.createElement($.Fragment,null,$.createElement("h2",null,"Unexpected Application Error!"),$.createElement("h3",{style:{fontStyle:"italic"}},t),n?$.createElement("pre",{style:i},n):null,c)}var Zle=$.createElement(Xle,null),Yle=class extends $.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?$.createElement(xu.Provider,{value:this.props.routeContext},$.createElement(K3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Kle({routeContext:e,match:t,children:n}){let r=$.useContext(qf);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),$.createElement(xu.Provider,{value:e},n)}function Jle(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,a=n==null?void 0:n.errors;if(a!=null){let f=i.findIndex(g=>g.route.id&&(a==null?void 0:a[g.route.id])!==void 0);cr(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,f+1))}let c=!1,o=-1;if(n)for(let f=0;f<i.length;f++){let g=i[f];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(o=f),g.route.id){let{loaderData:_,errors:x}=n,M=g.route.loader&&!_.hasOwnProperty(g.route.id)&&(!x||x[g.route.id]===void 0);if(g.route.lazy||M){c=!0,o>=0?i=i.slice(0,o+1):i=[i[0]];break}}}return i.reduceRight((f,g,_)=>{let x,M=!1,C=null,A=null;n&&(x=a&&g.route.id?a[g.route.id]:void 0,C=g.route.errorElement||Zle,c&&(o<0&&_===0?(FV("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),M=!0,A=null):o===_&&(M=!0,A=g.route.hydrateFallbackElement||null)));let L=t.concat(i.slice(0,_+1)),I=()=>{let T;return x?T=C:M?T=A:g.route.Component?T=$.createElement(g.route.Component,null):g.route.element?T=g.route.element:T=f,$.createElement(Kle,{match:g,routeContext:{outlet:f,matches:L,isDataRoute:n!=null},children:T})};return n&&(g.route.ErrorBoundary||g.route.errorElement||_===0)?$.createElement(Yle,{location:n.location,revalidation:n.revalidation,component:C,error:x,children:I(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):I()},null)}function J3(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Qle(e){let t=$.useContext(qf);return cr(t,J3(e)),t}function ece(e){let t=$.useContext(W_);return cr(t,J3(e)),t}function tce(e){let t=$.useContext(xu);return cr(t,J3(e)),t}function Q3(e){let t=tce(e),n=t.matches[t.matches.length-1];return cr(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function nce(){return Q3("useRouteId")}function rce(){var r;let e=$.useContext(K3),t=ece("useRouteError"),n=Q3("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function ice(){let{router:e}=Qle("useNavigate"),t=Q3("useNavigate"),n=$.useRef(!1);return zV(()=>{n.current=!0}),$.useCallback(async(i,a={})=>{Ni(n.current,DV),n.current&&(typeof i=="number"?e.navigate(i):await e.navigate(i,{fromRouteId:t,...a}))},[e,t])}var O5={};function FV(e,t,n){!t&&!O5[e]&&(O5[e]=!0,Ni(!1,n))}var F5={};function N5(e,t){!e&&!F5[t]&&(F5[t]=!0,console.warn(t))}function oce(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&Ni(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:$.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&Ni(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:$.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&Ni(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:$.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var sce=["HydrateFallback","hydrateFallbackElement"],ace=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function lce({router:e,flushSync:t}){let[n,r]=$.useState(e.state),[i,a]=$.useState(),[c,o]=$.useState({isTransitioning:!1}),[f,g]=$.useState(),[_,x]=$.useState(),[M,C]=$.useState(),A=$.useRef(new Map),L=$.useCallback((k,{deletedFetchers:U,flushSync:H,viewTransitionOpts:V})=>{k.fetchers.forEach((J,Y)=>{J.data!==void 0&&A.current.set(Y,J.data)}),U.forEach(J=>A.current.delete(J)),N5(H===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let q=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(N5(V==null||q,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!V||!q){t&&H?t(()=>r(k)):$.startTransition(()=>r(k));return}if(t&&H){t(()=>{_&&(f&&f.resolve(),_.skipTransition()),o({isTransitioning:!0,flushSync:!0,currentLocation:V.currentLocation,nextLocation:V.nextLocation})});let J=e.window.document.startViewTransition(()=>{t(()=>r(k))});J.finished.finally(()=>{t(()=>{g(void 0),x(void 0),a(void 0),o({isTransitioning:!1})})}),t(()=>x(J));return}_?(f&&f.resolve(),_.skipTransition(),C({state:k,currentLocation:V.currentLocation,nextLocation:V.nextLocation})):(a(k),o({isTransitioning:!0,flushSync:!1,currentLocation:V.currentLocation,nextLocation:V.nextLocation}))},[e.window,t,_,f]);$.useLayoutEffect(()=>e.subscribe(L),[e,L]),$.useEffect(()=>{c.isTransitioning&&!c.flushSync&&g(new ace)},[c]),$.useEffect(()=>{if(f&&i&&e.window){let k=i,U=f.promise,H=e.window.document.startViewTransition(async()=>{$.startTransition(()=>r(k)),await U});H.finished.finally(()=>{g(void 0),x(void 0),a(void 0),o({isTransitioning:!1})}),x(H)}},[i,f,e.window]),$.useEffect(()=>{f&&i&&n.location.key===i.location.key&&f.resolve()},[f,_,n.location,i]),$.useEffect(()=>{!c.isTransitioning&&M&&(a(M.state),o({isTransitioning:!0,flushSync:!1,currentLocation:M.currentLocation,nextLocation:M.nextLocation}),C(void 0))},[c.isTransitioning,M]);let I=$.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:k=>e.navigate(k),push:(k,U,H)=>e.navigate(k,{state:U,preventScrollReset:H==null?void 0:H.preventScrollReset}),replace:(k,U,H)=>e.navigate(k,{replace:!0,state:U,preventScrollReset:H==null?void 0:H.preventScrollReset})}),[e]),T=e.basename||"/",z=$.useMemo(()=>({router:e,navigator:I,static:!1,basename:T}),[e,I,T]);return $.createElement($.Fragment,null,$.createElement(qf.Provider,{value:z},$.createElement(W_.Provider,{value:n},$.createElement(kV.Provider,{value:A.current},$.createElement(Y3.Provider,{value:c},$.createElement(hce,{basename:T,location:n.location,navigationType:n.historyAction,navigator:I},$.createElement(cce,{routes:e.routes,future:e.future,state:n})))))),null)}var cce=$.memo(uce);function uce({routes:e,future:t,state:n}){return qle(e,void 0,n,t)}function nw(e){cr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function hce({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:i,static:a=!1}){cr(!q_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=e.replace(/^\/*/,"/"),o=$.useMemo(()=>({basename:c,navigator:i,static:a,future:{}}),[c,i,a]);typeof n=="string"&&(n=id(n));let{pathname:f="/",search:g="",hash:_="",state:x=null,key:M="default"}=n,C=$.useMemo(()=>{let A=Qa(f,c);return A==null?null:{location:{pathname:A,search:g,hash:_,state:x,key:M},navigationType:r}},[c,f,g,_,x,M,r]);return Ni(C!=null,`<Router basename="${c}"> is not able to match the URL "${f}${g}${_}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:$.createElement(Cc.Provider,{value:o},$.createElement(BM.Provider,{children:t,value:C}))}function IA(e,t=[]){let n=[];return $.Children.forEach(e,(r,i)=>{if(!$.isValidElement(r))return;let a=[...t,i];if(r.type===$.Fragment){n.push.apply(n,IA(r.props.children,a));return}cr(r.type===nw,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),cr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let c={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=IA(r.props.children,a)),n.push(c)}),n}var dce=IA,rw="get",iw="application/x-www-form-urlencoded";function UM(e){return e!=null&&typeof e.tagName=="string"}function fce(e){return UM(e)&&e.tagName.toLowerCase()==="button"}function pce(e){return UM(e)&&e.tagName.toLowerCase()==="form"}function mce(e){return UM(e)&&e.tagName.toLowerCase()==="input"}function gce(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function vce(e,t){return e.button===0&&(!t||t==="_self")&&!gce(e)}function RA(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function yce(e,t){let n=RA(e);return t&&t.forEach((r,i)=>{n.has(i)||t.getAll(i).forEach(a=>{n.append(i,a)})}),n}var X1=null;function _ce(){if(X1===null)try{new FormData(document.createElement("form"),0),X1=!1}catch{X1=!0}return X1}var xce=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function AE(e){return e!=null&&!xce.has(e)?(Ni(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${iw}"`),null):e}function bce(e,t){let n,r,i,a,c;if(pce(e)){let o=e.getAttribute("action");r=o?Qa(o,t):null,n=e.getAttribute("method")||rw,i=AE(e.getAttribute("enctype"))||iw,a=new FormData(e)}else if(fce(e)||mce(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||o.getAttribute("action");if(r=f?Qa(f,t):null,n=e.getAttribute("formmethod")||o.getAttribute("method")||rw,i=AE(e.getAttribute("formenctype"))||AE(o.getAttribute("enctype"))||iw,a=new FormData(o,e),!_ce()){let{name:g,type:_,value:x}=e;if(_==="image"){let M=g?`${g}.`:"";a.append(`${M}x`,"0"),a.append(`${M}y`,"0")}else g&&a.append(g,x)}}else{if(UM(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=rw,r=null,i=iw,c=e}return a&&i==="text/plain"&&(c=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:c}}function eL(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function wce(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Sce(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Mce(e,t,n){let r=await Promise.all(e.map(async i=>{let a=t.routes[i.route.id];if(a){let c=await wce(a,n);return c.links?c.links():[]}return[]}));return Pce(r.flat(1).filter(Sce).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function B5(e,t,n,r,i,a){let c=(f,g)=>n[g]?f.route.id!==n[g].route.id:!0,o=(f,g)=>{var _;return n[g].pathname!==f.pathname||((_=n[g].route.path)==null?void 0:_.endsWith("*"))&&n[g].params["*"]!==f.params["*"]};return a==="assets"?t.filter((f,g)=>c(f,g)||o(f,g)):a==="data"?t.filter((f,g)=>{var x;let _=r.routes[f.route.id];if(!_||!_.hasLoader)return!1;if(c(f,g)||o(f,g))return!0;if(f.route.shouldRevalidate){let M=f.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((x=n[0])==null?void 0:x.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof M=="boolean")return M}return!0}):[]}function Cce(e,t,{includeHydrateFallback:n}={}){return Ece(e.map(r=>{let i=t.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function Ece(e){return[...new Set(e)]}function Tce(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function Pce(e,t){let n=new Set;return new Set(t),e.reduce((r,i)=>{let a=JSON.stringify(Tce(i));return n.has(a)||(n.add(a),r.push({key:a,link:i})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Ace=new Set([100,101,204,205]);function Ice(e,t){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname="_root.data":t&&Qa(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function NV(){let e=$.useContext(qf);return eL(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Rce(){let e=$.useContext(W_);return eL(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var tL=$.createContext(void 0);tL.displayName="FrameworkContext";function BV(){let e=$.useContext(tL);return eL(e,"You must render this element inside a <HydratedRouter> element"),e}function Lce(e,t){let n=$.useContext(tL),[r,i]=$.useState(!1),[a,c]=$.useState(!1),{onFocus:o,onBlur:f,onMouseEnter:g,onMouseLeave:_,onTouchStart:x}=t,M=$.useRef(null);$.useEffect(()=>{if(e==="render"&&c(!0),e==="viewport"){let L=T=>{T.forEach(z=>{c(z.isIntersecting)})},I=new IntersectionObserver(L,{threshold:.5});return M.current&&I.observe(M.current),()=>{I.disconnect()}}},[e]),$.useEffect(()=>{if(r){let L=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(L)}}},[r]);let C=()=>{i(!0)},A=()=>{i(!1),c(!1)};return n?e!=="intent"?[a,M,{}]:[a,M,{onFocus:S0(o,C),onBlur:S0(f,A),onMouseEnter:S0(g,C),onMouseLeave:S0(_,A),onTouchStart:S0(x,C)}]:[!1,M,{}]}function S0(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function kce({page:e,...t}){let{router:n}=NV(),r=$.useMemo(()=>vh(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?$.createElement(zce,{page:e,matches:r,...t}):null}function Dce(e){let{manifest:t,routeModules:n}=BV(),[r,i]=$.useState([]);return $.useEffect(()=>{let a=!1;return Mce(e,t,n).then(c=>{a||i(c)}),()=>{a=!0}},[e,t,n]),r}function zce({page:e,matches:t,...n}){let r=od(),{manifest:i,routeModules:a}=BV(),{basename:c}=NV(),{loaderData:o,matches:f}=Rce(),g=$.useMemo(()=>B5(e,t,f,i,r,"data"),[e,t,f,i,r]),_=$.useMemo(()=>B5(e,t,f,i,r,"assets"),[e,t,f,i,r]),x=$.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let A=new Set,L=!1;if(t.forEach(T=>{var k;let z=i.routes[T.route.id];!z||!z.hasLoader||(!g.some(U=>U.route.id===T.route.id)&&T.route.id in o&&((k=a[T.route.id])!=null&&k.shouldRevalidate)||z.hasClientLoader?L=!0:A.add(T.route.id))}),A.size===0)return[];let I=Ice(e,c);return L&&A.size>0&&I.searchParams.set("_routes",t.filter(T=>A.has(T.route.id)).map(T=>T.route.id).join(",")),[I.pathname+I.search]},[c,o,r,i,g,t,e,a]),M=$.useMemo(()=>Cce(_,i),[_,i]),C=Dce(_);return $.createElement($.Fragment,null,x.map(A=>$.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...n})),M.map(A=>$.createElement("link",{key:A,rel:"modulepreload",href:A,...n})),C.map(({key:A,link:L})=>$.createElement("link",{key:A,...L})))}function Oce(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var UV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{UV&&(window.__reactRouterVersion="7.6.3")}catch{}function Fce(e,t){return Cle({basename:t==null?void 0:t.basename,unstable_getContext:t==null?void 0:t.unstable_getContext,future:t==null?void 0:t.future,history:Wae({window:t==null?void 0:t.window}),hydrationData:Nce(),routes:e,mapRouteProperties:oce,hydrationRouteProperties:sce,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function Nce(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:Bce(e.errors)}),e}function Bce(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,i]of t)if(i&&i.__type==="RouteErrorResponse")n[r]=new aS(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let a=window[i.__subType];if(typeof a=="function")try{let c=new a(i.message);c.stack="",n[r]=c}catch{}}if(n[r]==null){let a=new Error(i.message);a.stack="",n[r]=a}}else n[r]=i;return n}var $V=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,VV=$.forwardRef(function({onClick:t,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:c,state:o,target:f,to:g,preventScrollReset:_,viewTransition:x,...M},C){let{basename:A}=$.useContext(Cc),L=typeof g=="string"&&$V.test(g),I,T=!1;if(typeof g=="string"&&L&&(I=g,UV))try{let Y=new URL(window.location.href),N=g.startsWith("//")?new URL(Y.protocol+g):new URL(g),ne=Qa(N.pathname,A);N.origin===Y.origin&&ne!=null?g=ne+N.search+N.hash:T=!0}catch{Ni(!1,`<Link to="${g}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let z=Gle(g,{relative:i}),[k,U,H]=Lce(r,M),V=jce(g,{replace:c,state:o,target:f,preventScrollReset:_,relative:i,viewTransition:x});function q(Y){t&&t(Y),Y.defaultPrevented||V(Y)}let J=$.createElement("a",{...M,...H,href:I||z,onClick:T||a?t:q,ref:Oce(C,U),target:f,"data-discover":!L&&n==="render"?"true":void 0});return k&&!L?$.createElement($.Fragment,null,J,$.createElement(kce,{page:z})):J});VV.displayName="Link";var Uce=$.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:c,viewTransition:o,children:f,...g},_){let x=X_(c,{relative:g.relative}),M=od(),C=$.useContext(W_),{navigator:A,basename:L}=$.useContext(Cc),I=C!=null&&Zce(x)&&o===!0,T=A.encodeLocation?A.encodeLocation(x).pathname:x.pathname,z=M.pathname,k=C&&C.navigation&&C.navigation.location?C.navigation.location.pathname:null;n||(z=z.toLowerCase(),k=k?k.toLowerCase():null,T=T.toLowerCase()),k&&L&&(k=Qa(k,L)||k);const U=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let H=z===T||!i&&z.startsWith(T)&&z.charAt(U)==="/",V=k!=null&&(k===T||!i&&k.startsWith(T)&&k.charAt(T.length)==="/"),q={isActive:H,isPending:V,isTransitioning:I},J=H?t:void 0,Y;typeof r=="function"?Y=r(q):Y=[r,H?"active":null,V?"pending":null,I?"transitioning":null].filter(Boolean).join(" ");let N=typeof a=="function"?a(q):a;return $.createElement(VV,{...g,"aria-current":J,className:Y,ref:_,style:N,to:c,viewTransition:o},typeof f=="function"?f(q):f)});Uce.displayName="NavLink";var $ce=$.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:i,state:a,method:c=rw,action:o,onSubmit:f,relative:g,preventScrollReset:_,viewTransition:x,...M},C)=>{let A=qce(),L=Xce(o,{relative:g}),I=c.toLowerCase()==="get"?"get":"post",T=typeof o=="string"&&$V.test(o),z=k=>{if(f&&f(k),k.defaultPrevented)return;k.preventDefault();let U=k.nativeEvent.submitter,H=(U==null?void 0:U.getAttribute("formmethod"))||c;A(U||k.currentTarget,{fetcherKey:t,method:H,navigate:n,replace:i,state:a,relative:g,preventScrollReset:_,viewTransition:x})};return $.createElement("form",{ref:C,method:I,action:L,onSubmit:r?f:z,...M,"data-discover":!T&&e==="render"?"true":void 0})});$ce.displayName="Form";function Vce(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jV(e){let t=$.useContext(qf);return cr(t,Vce(e)),t}function jce(e,{target:t,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:c}={}){let o=OV(),f=od(),g=X_(e,{relative:a});return $.useCallback(_=>{if(vce(_,t)){_.preventDefault();let x=n!==void 0?n:$h(f)===$h(g);o(e,{replace:x,state:r,preventScrollReset:i,relative:a,viewTransition:c})}},[f,o,g,n,r,t,e,i,a,c])}function Hce(e){Ni(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=$.useRef(RA(e)),n=$.useRef(!1),r=od(),i=$.useMemo(()=>yce(r.search,n.current?null:t.current),[r.search]),a=OV(),c=$.useCallback((o,f)=>{const g=RA(typeof o=="function"?o(i):o);n.current=!0,a("?"+g,f)},[a,i]);return[i,c]}var Gce=0,Wce=()=>`__${String(++Gce)}__`;function qce(){let{router:e}=jV("useSubmit"),{basename:t}=$.useContext(Cc),n=nce();return $.useCallback(async(r,i={})=>{let{action:a,method:c,encType:o,formData:f,body:g}=bce(r,t);if(i.navigate===!1){let _=i.fetcherKey||Wce();await e.fetch(_,n,i.action||a,{preventScrollReset:i.preventScrollReset,formData:f,body:g,formMethod:i.method||c,formEncType:i.encType||o,flushSync:i.flushSync})}else await e.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:f,body:g,formMethod:i.method||c,formEncType:i.encType||o,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,t,n])}function Xce(e,{relative:t}={}){let{basename:n}=$.useContext(Cc),r=$.useContext(xu);cr(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...X_(e||".",{relative:t})},c=od();if(e==null){a.search=c.search;let o=new URLSearchParams(a.search),f=o.getAll("index");if(f.some(_=>_==="")){o.delete("index"),f.filter(x=>x).forEach(x=>o.append("index",x));let _=o.toString();a.search=_?`?${_}`:""}}return(!e||e===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:yc([n,a.pathname])),$h(a)}function Zce(e,t={}){let n=$.useContext(Y3);cr(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=jV("useViewTransitionState"),i=X_(e,{relative:t.relative});if(!n.isTransitioning)return!1;let a=Qa(n.currentLocation.pathname,r)||n.currentLocation.pathname,c=Qa(n.nextLocation.pathname,r)||n.nextLocation.pathname;return sS(i.pathname,c)!=null||sS(i.pathname,a)!=null}[...Ace];/**
 * react-router v7.6.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yce(e){return $.createElement(lce,{flushSync:F_.flushSync,...e})}const U5=e=>e,Kce=()=>{let e=U5;return{configure(t){e=t},generate(t){return e(t)},reset(){e=U5}}},Jce=Kce();function Ff(e,...t){const n=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(r=>n.searchParams.append("args[]",r)),`Minified MUI error #${e}; visit ${n} for the full message.`}function Cg(e){if(typeof e!="string")throw new Error(Ff(7));return e.charAt(0).toUpperCase()+e.slice(1)}function Qce(e,t,n=void 0){const r={};for(const i in e){const a=e[i];let c="",o=!0;for(let f=0;f<a.length;f+=1){const g=a[f];g&&(c+=(o===!0?"":" ")+t(g),o=!1,n&&n[g]&&(c+=" "+n[g]))}r[i]=c}return r}var HV={exports:{}},Jr={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nL=Symbol.for("react.transitional.element"),rL=Symbol.for("react.portal"),$M=Symbol.for("react.fragment"),VM=Symbol.for("react.strict_mode"),jM=Symbol.for("react.profiler"),HM=Symbol.for("react.consumer"),GM=Symbol.for("react.context"),WM=Symbol.for("react.forward_ref"),qM=Symbol.for("react.suspense"),XM=Symbol.for("react.suspense_list"),ZM=Symbol.for("react.memo"),YM=Symbol.for("react.lazy"),eue=Symbol.for("react.view_transition"),tue=Symbol.for("react.client.reference");function tl(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case nL:switch(e=e.type,e){case $M:case jM:case VM:case qM:case XM:case eue:return e;default:switch(e=e&&e.$$typeof,e){case GM:case WM:case YM:case ZM:return e;case HM:return e;default:return t}}case rL:return t}}}Jr.ContextConsumer=HM;Jr.ContextProvider=GM;Jr.Element=nL;Jr.ForwardRef=WM;Jr.Fragment=$M;Jr.Lazy=YM;Jr.Memo=ZM;Jr.Portal=rL;Jr.Profiler=jM;Jr.StrictMode=VM;Jr.Suspense=qM;Jr.SuspenseList=XM;Jr.isContextConsumer=function(e){return tl(e)===HM};Jr.isContextProvider=function(e){return tl(e)===GM};Jr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===nL};Jr.isForwardRef=function(e){return tl(e)===WM};Jr.isFragment=function(e){return tl(e)===$M};Jr.isLazy=function(e){return tl(e)===YM};Jr.isMemo=function(e){return tl(e)===ZM};Jr.isPortal=function(e){return tl(e)===rL};Jr.isProfiler=function(e){return tl(e)===jM};Jr.isStrictMode=function(e){return tl(e)===VM};Jr.isSuspense=function(e){return tl(e)===qM};Jr.isSuspenseList=function(e){return tl(e)===XM};Jr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===$M||e===jM||e===VM||e===qM||e===XM||typeof e=="object"&&e!==null&&(e.$$typeof===YM||e.$$typeof===ZM||e.$$typeof===GM||e.$$typeof===HM||e.$$typeof===WM||e.$$typeof===tue||e.getModuleId!==void 0)};Jr.typeOf=tl;HV.exports=Jr;var GV=HV.exports;function Kc(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function WV(e){if($.isValidElement(e)||GV.isValidElementType(e)||!Kc(e))return e;const t={};return Object.keys(e).forEach(n=>{t[n]=WV(e[n])}),t}function Ma(e,t,n={clone:!0}){const r=n.clone?{...e}:e;return Kc(e)&&Kc(t)&&Object.keys(t).forEach(i=>{$.isValidElement(t[i])||GV.isValidElementType(t[i])?r[i]=t[i]:Kc(t[i])&&Object.prototype.hasOwnProperty.call(e,i)&&Kc(e[i])?r[i]=Ma(e[i],t[i],n):n.clone?r[i]=Kc(t[i])?WV(t[i]):t[i]:r[i]=t[i]}),r}function my(e,t){return t?Ma(e,t,{clone:!1}):e}function $5(e,t){if(!e.containerQueries)return t;const n=Object.keys(t).filter(r=>r.startsWith("@container")).sort((r,i)=>{var c,o;const a=/min-width:\s*([0-9.]+)/;return+(((c=r.match(a))==null?void 0:c[1])||0)-+(((o=i.match(a))==null?void 0:o[1])||0)});return n.length?n.reduce((r,i)=>{const a=t[i];return delete r[i],r[i]=a,r},{...t}):t}function nue(e,t){return t==="@"||t.startsWith("@")&&(e.some(n=>t.startsWith(`@${n}`))||!!t.match(/^@\d/))}function rue(e,t){const n=t.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,i]=n,a=Number.isNaN(+r)?r||0:+r;return e.containerQueries(i).up(a)}function iue(e){const t=(a,c)=>a.replace("@media",c?`@container ${c}`:"@container");function n(a,c){a.up=(...o)=>t(e.breakpoints.up(...o),c),a.down=(...o)=>t(e.breakpoints.down(...o),c),a.between=(...o)=>t(e.breakpoints.between(...o),c),a.only=(...o)=>t(e.breakpoints.only(...o),c),a.not=(...o)=>{const f=t(e.breakpoints.not(...o),c);return f.includes("not all and")?f.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):f}}const r={},i=a=>(n(r,a),r);return n(i),{...e,containerQueries:i}}const KM={xs:0,sm:600,md:900,lg:1200,xl:1536},V5={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${KM[e]}px)`},oue={containerQueries:e=>({up:t=>{let n=typeof t=="number"?t:KM[t]||t;return typeof n=="number"&&(n=`${n}px`),e?`@container ${e} (min-width:${n})`:`@container (min-width:${n})`}})};function pu(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const a=r.breakpoints||V5;return t.reduce((c,o,f)=>(c[a.up(a.keys[f])]=n(t[f]),c),{})}if(typeof t=="object"){const a=r.breakpoints||V5;return Object.keys(t).reduce((c,o)=>{if(nue(a.keys,o)){const f=rue(r.containerQueries?r:oue,o);f&&(c[f]=n(t[o],o))}else if(Object.keys(a.values||KM).includes(o)){const f=a.up(o);c[f]=n(t[o],o)}else{const f=o;c[f]=t[f]}return c},{})}return n(t)}function sue(e={}){var n;return((n=e.keys)==null?void 0:n.reduce((r,i)=>{const a=e.up(i);return r[a]={},r},{}))||{}}function j5(e,t){return e.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},t)}function JM(e,t,n=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&n){const r=`vars.${t}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,e);if(r!=null)return r}return t.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,e)}function cS(e,t,n,r=n){let i;return typeof e=="function"?i=e(n):Array.isArray(e)?i=e[n]||r:i=JM(e,n)||r,t&&(i=t(i,r,e)),i}function Ui(e){const{prop:t,cssProperty:n=e.prop,themeKey:r,transform:i}=e,a=c=>{if(c[t]==null)return null;const o=c[t],f=c.theme,g=JM(f,r)||{};return pu(c,o,x=>{let M=cS(g,i,x);return x===M&&typeof x=="string"&&(M=cS(g,i,`${t}${x==="default"?"":Cg(x)}`,x)),n===!1?M:{[n]:M}})};return a.propTypes={},a.filterProps=[t],a}function aue(e){const t={};return n=>(t[n]===void 0&&(t[n]=e(n)),t[n])}const lue={m:"margin",p:"padding"},cue={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},H5={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},uue=aue(e=>{if(e.length>2)if(H5[e])e=H5[e];else return[e];const[t,n]=e.split(""),r=lue[t],i=cue[n]||"";return Array.isArray(i)?i.map(a=>r+a):[r+i]}),iL=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],oL=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...iL,...oL];function Z_(e,t,n,r){const i=JM(e,t,!0)??n;return typeof i=="number"||typeof i=="string"?a=>typeof a=="string"?a:typeof i=="string"?i.startsWith("var(")&&a===0?0:i.startsWith("var(")&&a===1?i:`calc(${a} * ${i})`:i*a:Array.isArray(i)?a=>{if(typeof a=="string")return a;const c=Math.abs(a),o=i[c];return a>=0?o:typeof o=="number"?-o:typeof o=="string"&&o.startsWith("var(")?`calc(-1 * ${o})`:`-${o}`}:typeof i=="function"?i:()=>{}}function sL(e){return Z_(e,"spacing",8)}function Y_(e,t){return typeof t=="string"||t==null?t:e(t)}function hue(e,t){return n=>e.reduce((r,i)=>(r[i]=Y_(t,n),r),{})}function due(e,t,n,r){if(!t.includes(n))return null;const i=uue(n),a=hue(i,r),c=e[n];return pu(e,c,a)}function qV(e,t){const n=sL(e.theme);return Object.keys(e).map(r=>due(e,t,r,n)).reduce(my,{})}function Ti(e){return qV(e,iL)}Ti.propTypes={};Ti.filterProps=iL;function Pi(e){return qV(e,oL)}Pi.propTypes={};Pi.filterProps=oL;function QM(...e){const t=e.reduce((r,i)=>(i.filterProps.forEach(a=>{r[a]=i}),r),{}),n=r=>Object.keys(r).reduce((i,a)=>t[a]?my(i,t[a](r)):i,{});return n.propTypes={},n.filterProps=e.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Ha(e){return typeof e!="number"?e:`${e}px solid`}function nl(e,t){return Ui({prop:e,themeKey:"borders",transform:t})}const fue=nl("border",Ha),pue=nl("borderTop",Ha),mue=nl("borderRight",Ha),gue=nl("borderBottom",Ha),vue=nl("borderLeft",Ha),yue=nl("borderColor"),_ue=nl("borderTopColor"),xue=nl("borderRightColor"),bue=nl("borderBottomColor"),wue=nl("borderLeftColor"),Sue=nl("outline",Ha),Mue=nl("outlineColor"),e2=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=Z_(e.theme,"shape.borderRadius",4),n=r=>({borderRadius:Y_(t,r)});return pu(e,e.borderRadius,n)}return null};e2.propTypes={};e2.filterProps=["borderRadius"];QM(fue,pue,mue,gue,vue,yue,_ue,xue,bue,wue,e2,Sue,Mue);const t2=e=>{if(e.gap!==void 0&&e.gap!==null){const t=Z_(e.theme,"spacing",8),n=r=>({gap:Y_(t,r)});return pu(e,e.gap,n)}return null};t2.propTypes={};t2.filterProps=["gap"];const n2=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=Z_(e.theme,"spacing",8),n=r=>({columnGap:Y_(t,r)});return pu(e,e.columnGap,n)}return null};n2.propTypes={};n2.filterProps=["columnGap"];const r2=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=Z_(e.theme,"spacing",8),n=r=>({rowGap:Y_(t,r)});return pu(e,e.rowGap,n)}return null};r2.propTypes={};r2.filterProps=["rowGap"];const Cue=Ui({prop:"gridColumn"}),Eue=Ui({prop:"gridRow"}),Tue=Ui({prop:"gridAutoFlow"}),Pue=Ui({prop:"gridAutoColumns"}),Aue=Ui({prop:"gridAutoRows"}),Iue=Ui({prop:"gridTemplateColumns"}),Rue=Ui({prop:"gridTemplateRows"}),Lue=Ui({prop:"gridTemplateAreas"}),kue=Ui({prop:"gridArea"});QM(t2,n2,r2,Cue,Eue,Tue,Pue,Aue,Iue,Rue,Lue,kue);function ig(e,t){return t==="grey"?t:e}const Due=Ui({prop:"color",themeKey:"palette",transform:ig}),zue=Ui({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:ig}),Oue=Ui({prop:"backgroundColor",themeKey:"palette",transform:ig});QM(Due,zue,Oue);function ga(e){return e<=1&&e!==0?`${e*100}%`:e}const Fue=Ui({prop:"width",transform:ga}),aL=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=n=>{var i,a,c,o,f;const r=((c=(a=(i=e.theme)==null?void 0:i.breakpoints)==null?void 0:a.values)==null?void 0:c[n])||KM[n];return r?((f=(o=e.theme)==null?void 0:o.breakpoints)==null?void 0:f.unit)!=="px"?{maxWidth:`${r}${e.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:ga(n)}};return pu(e,e.maxWidth,t)}return null};aL.filterProps=["maxWidth"];const Nue=Ui({prop:"minWidth",transform:ga}),Bue=Ui({prop:"height",transform:ga}),Uue=Ui({prop:"maxHeight",transform:ga}),$ue=Ui({prop:"minHeight",transform:ga});Ui({prop:"size",cssProperty:"width",transform:ga});Ui({prop:"size",cssProperty:"height",transform:ga});const Vue=Ui({prop:"boxSizing"});QM(Fue,aL,Nue,Bue,Uue,$ue,Vue);const i2={border:{themeKey:"borders",transform:Ha},borderTop:{themeKey:"borders",transform:Ha},borderRight:{themeKey:"borders",transform:Ha},borderBottom:{themeKey:"borders",transform:Ha},borderLeft:{themeKey:"borders",transform:Ha},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Ha},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:e2},color:{themeKey:"palette",transform:ig},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:ig},backgroundColor:{themeKey:"palette",transform:ig},p:{style:Pi},pt:{style:Pi},pr:{style:Pi},pb:{style:Pi},pl:{style:Pi},px:{style:Pi},py:{style:Pi},padding:{style:Pi},paddingTop:{style:Pi},paddingRight:{style:Pi},paddingBottom:{style:Pi},paddingLeft:{style:Pi},paddingX:{style:Pi},paddingY:{style:Pi},paddingInline:{style:Pi},paddingInlineStart:{style:Pi},paddingInlineEnd:{style:Pi},paddingBlock:{style:Pi},paddingBlockStart:{style:Pi},paddingBlockEnd:{style:Pi},m:{style:Ti},mt:{style:Ti},mr:{style:Ti},mb:{style:Ti},ml:{style:Ti},mx:{style:Ti},my:{style:Ti},margin:{style:Ti},marginTop:{style:Ti},marginRight:{style:Ti},marginBottom:{style:Ti},marginLeft:{style:Ti},marginX:{style:Ti},marginY:{style:Ti},marginInline:{style:Ti},marginInlineStart:{style:Ti},marginInlineEnd:{style:Ti},marginBlock:{style:Ti},marginBlockStart:{style:Ti},marginBlockEnd:{style:Ti},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:t2},rowGap:{style:r2},columnGap:{style:n2},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:ga},maxWidth:{style:aL},minWidth:{transform:ga},height:{transform:ga},maxHeight:{transform:ga},minHeight:{transform:ga},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function jue(...e){const t=e.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(t);return e.every(r=>n.size===Object.keys(r).length)}function Hue(e,t){return typeof e=="function"?e(t):e}function Gue(){function e(n,r,i,a){const c={[n]:r,theme:i},o=a[n];if(!o)return{[n]:r};const{cssProperty:f=n,themeKey:g,transform:_,style:x}=o;if(r==null)return null;if(g==="typography"&&r==="inherit")return{[n]:r};const M=JM(i,g)||{};return x?x(c):pu(c,r,A=>{let L=cS(M,_,A);return A===L&&typeof A=="string"&&(L=cS(M,_,`${n}${A==="default"?"":Cg(A)}`,A)),f===!1?L:{[f]:L}})}function t(n){const{sx:r,theme:i={},nested:a}=n||{};if(!r)return null;const c=i.unstable_sxConfig??i2;function o(f){let g=f;if(typeof f=="function")g=f(i);else if(typeof f!="object")return f;if(!g)return null;const _=sue(i.breakpoints),x=Object.keys(_);let M=_;return Object.keys(g).forEach(C=>{const A=Hue(g[C],i);if(A!=null)if(typeof A=="object")if(c[C])M=my(M,e(C,A,i,c));else{const L=pu({theme:i},A,I=>({[C]:I}));jue(L,A)?M[C]=t({sx:A,theme:i,nested:!0}):M=my(M,L)}else M=my(M,e(C,A,i,c))}),!a&&i.modularCssLayers?{"@layer sx":$5(i,j5(x,M))}:$5(i,j5(x,M))}return Array.isArray(r)?r.map(o):o(r)}return t}const Eg=Gue();Eg.filterProps=["sx"];function Wue(e,t){return Tw(e,t)}function que(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}const G5=[];function Tf(e){return G5[0]=e,T_(G5)}const Xue=e=>{const t=Object.keys(e).map(n=>({key:n,val:e[n]}))||[];return t.sort((n,r)=>n.val-r.val),t.reduce((n,r)=>({...n,[r.key]:r.val}),{})};function Zue(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...i}=e,a=Xue(t),c=Object.keys(a);function o(M){return`@media (min-width:${typeof t[M]=="number"?t[M]:M}${n})`}function f(M){return`@media (max-width:${(typeof t[M]=="number"?t[M]:M)-r/100}${n})`}function g(M,C){const A=c.indexOf(C);return`@media (min-width:${typeof t[M]=="number"?t[M]:M}${n}) and (max-width:${(A!==-1&&typeof t[c[A]]=="number"?t[c[A]]:C)-r/100}${n})`}function _(M){return c.indexOf(M)+1<c.length?g(M,c[c.indexOf(M)+1]):o(M)}function x(M){const C=c.indexOf(M);return C===0?o(c[1]):C===c.length-1?f(c[C]):g(M,c[c.indexOf(M)+1]).replace("@media","@media not all and")}return{keys:c,values:a,up:o,down:f,between:g,only:_,not:x,unit:n,...i}}const Yue={borderRadius:4};function XV(e=8,t=sL({spacing:e})){if(e.mui)return e;const n=(...r)=>(r.length===0?[1]:r).map(a=>{const c=t(a);return typeof c=="number"?`${c}px`:c}).join(" ");return n.mui=!0,n}function Kue(e,t){var r;const n=this;if(n.vars){if(!((r=n.colorSchemes)!=null&&r[e])||typeof n.getColorSchemeSelector!="function")return{};let i=n.getColorSchemeSelector(e);return i==="&"?t:((i.includes("data-")||i.includes("."))&&(i=`*:where(${i.replace(/\s*&$/,"")}) &`),{[i]:t})}return n.palette.mode===e?t:{}}function ZV(e={},...t){const{breakpoints:n={},palette:r={},spacing:i,shape:a={},...c}=e,o=Zue(n),f=XV(i);let g=Ma({breakpoints:o,direction:"ltr",components:{},palette:{mode:"light",...r},spacing:f,shape:{...Yue,...a}},c);return g=iue(g),g.applyStyles=Kue,g=t.reduce((_,x)=>Ma(_,x),g),g.unstable_sxConfig={...i2,...c==null?void 0:c.unstable_sxConfig},g.unstable_sx=function(x){return Eg({sx:x,theme:this})},g}const Jue={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function YV(e,t,n="Mui"){const r=Jue[t];return r?`${n}-${r}`:`${Jce.generate(e)}-${t}`}function Que(e,t,n="Mui"){const r={};return t.forEach(i=>{r[i]=YV(e,i,n)}),r}function KV(e){const{variants:t,...n}=e,r={variants:t,style:Tf(n),isProcessed:!0};return r.style===n||t&&t.forEach(i=>{typeof i.style!="function"&&(i.style=Tf(i.style))}),r}const ehe=ZV();function IE(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function bf(e,t){return t&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}function the(e){return e?(t,n)=>n[e]:null}function nhe(e,t,n){e.theme=ohe(e.theme)?n:e.theme[t]||e.theme}function ow(e,t,n){const r=typeof t=="function"?t(e):t;if(Array.isArray(r))return r.flatMap(i=>ow(e,i,n));if(Array.isArray(r==null?void 0:r.variants)){let i;if(r.isProcessed)i=n?bf(r.style,n):r.style;else{const{variants:a,...c}=r;i=n?bf(Tf(c),n):c}return JV(e,r.variants,[i],n)}return r!=null&&r.isProcessed?n?bf(Tf(r.style),n):r.style:n?bf(Tf(r),n):r}function JV(e,t,n=[],r=void 0){var a;let i;e:for(let c=0;c<t.length;c+=1){const o=t[c];if(typeof o.props=="function"){if(i??(i={...e,...e.ownerState,ownerState:e.ownerState}),!o.props(i))continue}else for(const f in o.props)if(e[f]!==o.props[f]&&((a=e.ownerState)==null?void 0:a[f])!==o.props[f])continue e;typeof o.style=="function"?(i??(i={...e,...e.ownerState,ownerState:e.ownerState}),n.push(r?bf(Tf(o.style(i)),r):o.style(i))):n.push(r?bf(Tf(o.style),r):o.style)}return n}function rhe(e={}){const{themeId:t,defaultTheme:n=ehe,rootShouldForwardProp:r=IE,slotShouldForwardProp:i=IE}=e;function a(o){nhe(o,t,n)}return(o,f={})=>{que(o,V=>V.filter(q=>q!==Eg));const{name:g,slot:_,skipVariantsResolver:x,skipSx:M,overridesResolver:C=the(ahe(_)),...A}=f,L=g&&g.startsWith("Mui")||_?"components":"custom",I=x!==void 0?x:_&&_!=="Root"&&_!=="root"||!1,T=M||!1;let z=IE;_==="Root"||_==="root"?z=r:_?z=i:she(o)&&(z=void 0);const k=Wue(o,{shouldForwardProp:z,label:ihe(),...A}),U=V=>{if(V.__emotion_real===V)return V;if(typeof V=="function")return function(J){return ow(J,V,J.theme.modularCssLayers?L:void 0)};if(Kc(V)){const q=KV(V);return function(Y){return q.variants?ow(Y,q,Y.theme.modularCssLayers?L:void 0):Y.theme.modularCssLayers?bf(q.style,L):q.style}}return V},H=(...V)=>{const q=[],J=V.map(U),Y=[];if(q.push(a),g&&C&&Y.push(function(ge){var Se,Me;const Ae=(Me=(Se=ge.theme.components)==null?void 0:Se[g])==null?void 0:Me.styleOverrides;if(!Ae)return null;const ve={};for(const Ue in Ae)ve[Ue]=ow(ge,Ae[Ue],ge.theme.modularCssLayers?"theme":void 0);return C(ge,ve)}),g&&!I&&Y.push(function(ge){var ve,Se;const Ne=ge.theme,Ae=(Se=(ve=Ne==null?void 0:Ne.components)==null?void 0:ve[g])==null?void 0:Se.variants;return Ae?JV(ge,Ae,[],ge.theme.modularCssLayers?"theme":void 0):null}),T||Y.push(Eg),Array.isArray(J[0])){const ye=J.shift(),ge=new Array(q.length).fill(""),Ne=new Array(Y.length).fill("");let Ae;Ae=[...ge,...ye,...Ne],Ae.raw=[...ge,...ye.raw,...Ne],q.unshift(Ae)}const N=[...q,...J,...Y],ne=k(...N);return o.muiName&&(ne.muiName=o.muiName),ne};return k.withConfig&&(H.withConfig=k.withConfig),H}}function ihe(e,t){return void 0}function ohe(e){for(const t in e)return!1;return!0}function she(e){return typeof e=="string"&&e.charCodeAt(0)>96}function ahe(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}function LA(e,t,n=!1){const r={...t};for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const a=i;if(a==="components"||a==="slots")r[a]={...e[a],...r[a]};else if(a==="componentsProps"||a==="slotProps"){const c=e[a],o=t[a];if(!o)r[a]=c||{};else if(!c)r[a]=o;else{r[a]={...o};for(const f in c)if(Object.prototype.hasOwnProperty.call(c,f)){const g=f;r[a][g]=LA(c[g],o[g],n)}}}else a==="className"&&n&&t.className?r.className=xi(e==null?void 0:e.className,t==null?void 0:t.className):a==="style"&&n&&t.style?r.style={...e==null?void 0:e.style,...t==null?void 0:t.style}:r[a]===void 0&&(r[a]=e[a])}return r}function lhe(e,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,n))}function lL(e,t=0,n=1){return lhe(e,t,n)}function che(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function Vh(e){if(e.type)return e;if(e.charAt(0)==="#")return Vh(che(e));const t=e.indexOf("("),n=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(Ff(9,e));let r=e.substring(t+1,e.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(i))throw new Error(Ff(10,i))}else r=r.split(",");return r=r.map(a=>parseFloat(a)),{type:n,values:r,colorSpace:i}}const uhe=e=>{const t=Vh(e);return t.values.slice(0,3).map((n,r)=>t.type.includes("hsl")&&r!==0?`${n}%`:n).join(" ")},q0=(e,t)=>{try{return uhe(e)}catch{return e}};function o2(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return t.includes("rgb")?r=r.map((i,a)=>a<3?parseInt(i,10):i):t.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),t.includes("color")?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${t}(${r})`}function QV(e){e=Vh(e);const{values:t}=e,n=t[0],r=t[1]/100,i=t[2]/100,a=r*Math.min(i,1-i),c=(g,_=(g+n/30)%12)=>i-a*Math.max(Math.min(_-3,9-_,1),-1);let o="rgb";const f=[Math.round(c(0)*255),Math.round(c(8)*255),Math.round(c(4)*255)];return e.type==="hsla"&&(o+="a",f.push(t[3])),o2({type:o,values:f})}function kA(e){e=Vh(e);let t=e.type==="hsl"||e.type==="hsla"?Vh(QV(e)).values:e.values;return t=t.map(n=>(e.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function hhe(e,t){const n=kA(e),r=kA(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function dhe(e,t){return e=Vh(e),t=lL(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,o2(e)}function Z1(e,t,n){try{return dhe(e,t)}catch{return e}}function cL(e,t){if(e=Vh(e),t=lL(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return o2(e)}function Yr(e,t,n){try{return cL(e,t)}catch{return e}}function uL(e,t){if(e=Vh(e),t=lL(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return o2(e)}function Kr(e,t,n){try{return uL(e,t)}catch{return e}}function fhe(e,t=.15){return kA(e)>.5?cL(e,t):uL(e,t)}function Y1(e,t,n){try{return fhe(e,t)}catch{return e}}const phe=$.createContext(void 0);function mhe(e){const{theme:t,name:n,props:r}=e;if(!t||!t.components||!t.components[n])return r;const i=t.components[n];return i.defaultProps?LA(i.defaultProps,r,t.components.mergeClassNameAndStyle):!i.styleOverrides&&!i.variants?LA(i,r,t.components.mergeClassNameAndStyle):r}function ghe({props:e,name:t}){const n=$.useContext(phe);return mhe({props:e,name:t,theme:{components:n}})}const W5={theme:void 0};function vhe(e){let t,n;return function(i){let a=t;return(a===void 0||i.theme!==n)&&(W5.theme=i.theme,a=KV(e(W5)),t=a,n=i.theme),a}}function yhe(e=""){function t(...r){if(!r.length)return"";const i=r[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${i}${t(...r.slice(1))})`:`, ${i}`}return(r,...i)=>`var(--${e?`${e}-`:""}${r}${t(...i)})`}const q5=(e,t,n,r=[])=>{let i=e;t.forEach((a,c)=>{c===t.length-1?Array.isArray(i)?i[Number(a)]=n:i&&typeof i=="object"&&(i[a]=n):i&&typeof i=="object"&&(i[a]||(i[a]=r.includes(a)?[]:{}),i=i[a])})},_he=(e,t,n)=>{function r(i,a=[],c=[]){Object.entries(i).forEach(([o,f])=>{(!n||!n([...a,o]))&&f!=null&&(typeof f=="object"&&Object.keys(f).length>0?r(f,[...a,o],Array.isArray(f)?[...c,o]:c):t([...a,o],f,c))})}r(e)},xhe=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>e.includes(r))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function RE(e,t){const{prefix:n,shouldSkipGeneratingVar:r}=t||{},i={},a={},c={};return _he(e,(o,f,g)=>{if((typeof f=="string"||typeof f=="number")&&(!r||!r(o,f))){const _=`--${n?`${n}-`:""}${o.join("-")}`,x=xhe(o,f);Object.assign(i,{[_]:x}),q5(a,o,`var(${_})`,g),q5(c,o,`var(${_}, ${x})`,g)}},o=>o[0]==="vars"),{css:i,vars:a,varsWithDefaults:c}}function bhe(e,t={}){const{getSelector:n=I,disableCssColorScheme:r,colorSchemeSelector:i}=t,{colorSchemes:a={},components:c,defaultColorScheme:o="light",...f}=e,{vars:g,css:_,varsWithDefaults:x}=RE(f,t);let M=x;const C={},{[o]:A,...L}=a;if(Object.entries(L||{}).forEach(([k,U])=>{const{vars:H,css:V,varsWithDefaults:q}=RE(U,t);M=Ma(M,q),C[k]={css:V,vars:H}}),A){const{css:k,vars:U,varsWithDefaults:H}=RE(A,t);M=Ma(M,H),C[o]={css:k,vars:U}}function I(k,U){var V,q;let H=i;if(i==="class"&&(H=".%s"),i==="data"&&(H="[data-%s]"),i!=null&&i.startsWith("data-")&&!i.includes("%s")&&(H=`[${i}="%s"]`),k){if(H==="media")return e.defaultColorScheme===k?":root":{[`@media (prefers-color-scheme: ${((q=(V=a[k])==null?void 0:V.palette)==null?void 0:q.mode)||k})`]:{":root":U}};if(H)return e.defaultColorScheme===k?`:root, ${H.replace("%s",String(k))}`:H.replace("%s",String(k))}return":root"}return{vars:M,generateThemeVars:()=>{let k={...g};return Object.entries(C).forEach(([,{vars:U}])=>{k=Ma(k,U)}),k},generateStyleSheets:()=>{var J,Y;const k=[],U=e.defaultColorScheme||"light";function H(N,ne){Object.keys(ne).length&&k.push(typeof N=="string"?{[N]:{...ne}}:N)}H(n(void 0,{..._}),_);const{[U]:V,...q}=C;if(V){const{css:N}=V,ne=(Y=(J=a[U])==null?void 0:J.palette)==null?void 0:Y.mode,ye=!r&&ne?{colorScheme:ne,...N}:{...N};H(n(U,{...ye}),ye)}return Object.entries(q).forEach(([N,{css:ne}])=>{var Ne,Ae;const ye=(Ae=(Ne=a[N])==null?void 0:Ne.palette)==null?void 0:Ae.mode,ge=!r&&ye?{colorScheme:ye,...ne}:{...ne};H(n(N,{...ge}),ge)}),k}}}function whe(e){return function(n){return e==="media"?`@media (prefers-color-scheme: ${n})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${n}"] &`:e==="class"?`.${n} &`:e==="data"?`[data-${n}] &`:`${e.replace("%s",n)} &`:"&"}}const h_={black:"#000",white:"#fff"},She={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Gp={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Wp={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},M0={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},qp={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Xp={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Zp={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};function ej(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:h_.white,default:h_.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const Mhe=ej();function tj(){return{text:{primary:h_.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:h_.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const X5=tj();function Z5(e,t,n,r){const i=r.light||r,a=r.dark||r*1.5;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:t==="light"?e.light=uL(e.main,i):t==="dark"&&(e.dark=cL(e.main,a)))}function Che(e="light"){return e==="dark"?{main:qp[200],light:qp[50],dark:qp[400]}:{main:qp[700],light:qp[400],dark:qp[800]}}function Ehe(e="light"){return e==="dark"?{main:Gp[200],light:Gp[50],dark:Gp[400]}:{main:Gp[500],light:Gp[300],dark:Gp[700]}}function The(e="light"){return e==="dark"?{main:Wp[500],light:Wp[300],dark:Wp[700]}:{main:Wp[700],light:Wp[400],dark:Wp[800]}}function Phe(e="light"){return e==="dark"?{main:Xp[400],light:Xp[300],dark:Xp[700]}:{main:Xp[700],light:Xp[500],dark:Xp[900]}}function Ahe(e="light"){return e==="dark"?{main:Zp[400],light:Zp[300],dark:Zp[700]}:{main:Zp[800],light:Zp[500],dark:Zp[900]}}function Ihe(e="light"){return e==="dark"?{main:M0[400],light:M0[300],dark:M0[700]}:{main:"#ed6c02",light:M0[500],dark:M0[900]}}function hL(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:r=.2,...i}=e,a=e.primary||Che(t),c=e.secondary||Ehe(t),o=e.error||The(t),f=e.info||Phe(t),g=e.success||Ahe(t),_=e.warning||Ihe(t);function x(L){return hhe(L,X5.text.primary)>=n?X5.text.primary:Mhe.text.primary}const M=({color:L,name:I,mainShade:T=500,lightShade:z=300,darkShade:k=700})=>{if(L={...L},!L.main&&L[T]&&(L.main=L[T]),!L.hasOwnProperty("main"))throw new Error(Ff(11,I?` (${I})`:"",T));if(typeof L.main!="string")throw new Error(Ff(12,I?` (${I})`:"",JSON.stringify(L.main)));return Z5(L,"light",z,r),Z5(L,"dark",k,r),L.contrastText||(L.contrastText=x(L.main)),L};let C;return t==="light"?C=ej():t==="dark"&&(C=tj()),Ma({common:{...h_},mode:t,primary:M({color:a,name:"primary"}),secondary:M({color:c,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:M({color:o,name:"error"}),warning:M({color:_,name:"warning"}),info:M({color:f,name:"info"}),success:M({color:g,name:"success"}),grey:She,contrastThreshold:n,getContrastText:x,augmentColor:M,tonalOffset:r,...C},i)}function Rhe(e){const t={};return Object.entries(e).forEach(r=>{const[i,a]=r;typeof a=="object"&&(t[i]=`${a.fontStyle?`${a.fontStyle} `:""}${a.fontVariant?`${a.fontVariant} `:""}${a.fontWeight?`${a.fontWeight} `:""}${a.fontStretch?`${a.fontStretch} `:""}${a.fontSize||""}${a.lineHeight?`/${a.lineHeight} `:""}${a.fontFamily||""}`)}),t}function Lhe(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}function khe(e){return Math.round(e*1e5)/1e5}const Y5={textTransform:"uppercase"},K5='"Roboto", "Helvetica", "Arial", sans-serif';function Dhe(e,t){const{fontFamily:n=K5,fontSize:r=14,fontWeightLight:i=300,fontWeightRegular:a=400,fontWeightMedium:c=500,fontWeightBold:o=700,htmlFontSize:f=16,allVariants:g,pxToRem:_,...x}=typeof t=="function"?t(e):t,M=r/14,C=_||(I=>`${I/f*M}rem`),A=(I,T,z,k,U)=>({fontFamily:n,fontWeight:I,fontSize:C(T),lineHeight:z,...n===K5?{letterSpacing:`${khe(k/T)}em`}:{},...U,...g}),L={h1:A(i,96,1.167,-1.5),h2:A(i,60,1.2,-.5),h3:A(a,48,1.167,0),h4:A(a,34,1.235,.25),h5:A(a,24,1.334,0),h6:A(c,20,1.6,.15),subtitle1:A(a,16,1.75,.15),subtitle2:A(c,14,1.57,.1),body1:A(a,16,1.5,.15),body2:A(a,14,1.43,.15),button:A(c,14,1.75,.4,Y5),caption:A(a,12,1.66,.4),overline:A(a,12,2.66,1,Y5),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Ma({htmlFontSize:f,pxToRem:C,fontFamily:n,fontSize:r,fontWeightLight:i,fontWeightRegular:a,fontWeightMedium:c,fontWeightBold:o,...L},x,{clone:!1})}const zhe=.2,Ohe=.14,Fhe=.12;function fi(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${zhe})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${Ohe})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${Fhe})`].join(",")}const Nhe=["none",fi(0,2,1,-1,0,1,1,0,0,1,3,0),fi(0,3,1,-2,0,2,2,0,0,1,5,0),fi(0,3,3,-2,0,3,4,0,0,1,8,0),fi(0,2,4,-1,0,4,5,0,0,1,10,0),fi(0,3,5,-1,0,5,8,0,0,1,14,0),fi(0,3,5,-1,0,6,10,0,0,1,18,0),fi(0,4,5,-2,0,7,10,1,0,2,16,1),fi(0,5,5,-3,0,8,10,1,0,3,14,2),fi(0,5,6,-3,0,9,12,1,0,3,16,2),fi(0,6,6,-3,0,10,14,1,0,4,18,3),fi(0,6,7,-4,0,11,15,1,0,4,20,3),fi(0,7,8,-4,0,12,17,2,0,5,22,4),fi(0,7,8,-4,0,13,19,2,0,5,24,4),fi(0,7,9,-4,0,14,21,2,0,5,26,4),fi(0,8,9,-5,0,15,22,2,0,6,28,5),fi(0,8,10,-5,0,16,24,2,0,6,30,5),fi(0,8,11,-5,0,17,26,2,0,6,32,5),fi(0,9,11,-5,0,18,28,2,0,7,34,6),fi(0,9,12,-6,0,19,29,2,0,7,36,6),fi(0,10,13,-6,0,20,31,3,0,8,38,7),fi(0,10,13,-6,0,21,33,3,0,8,40,7),fi(0,10,14,-6,0,22,35,3,0,8,42,7),fi(0,11,14,-7,0,23,36,3,0,9,44,8),fi(0,11,15,-7,0,24,38,3,0,9,46,8)],Bhe={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Uhe={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function J5(e){return`${Math.round(e)}ms`}function $he(e){if(!e)return 0;const t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function Vhe(e){const t={...Bhe,...e.easing},n={...Uhe,...e.duration};return{getAutoHeightDuration:$he,create:(i=["all"],a={})=>{const{duration:c=n.standard,easing:o=t.easeInOut,delay:f=0,...g}=a;return(Array.isArray(i)?i:[i]).map(_=>`${_} ${typeof c=="string"?c:J5(c)} ${o} ${typeof f=="string"?f:J5(f)}`).join(",")},...e,easing:t,duration:n}}const jhe={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function Hhe(e){return Kc(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function nj(e={}){const t={...e};function n(r){const i=Object.entries(r);for(let a=0;a<i.length;a++){const[c,o]=i[a];!Hhe(o)||c.startsWith("unstable_")?delete r[c]:Kc(o)&&(r[c]={...o},n(r[c]))}}return n(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function DA(e={},...t){const{breakpoints:n,mixins:r={},spacing:i,palette:a={},transitions:c={},typography:o={},shape:f,...g}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(Ff(20));const _=hL(a),x=ZV(e);let M=Ma(x,{mixins:Lhe(x.breakpoints,r),palette:_,shadows:Nhe.slice(),typography:Dhe(_,o),transitions:Vhe(c),zIndex:{...jhe}});return M=Ma(M,g),M=t.reduce((C,A)=>Ma(C,A),M),M.unstable_sxConfig={...i2,...g==null?void 0:g.unstable_sxConfig},M.unstable_sx=function(A){return Eg({sx:A,theme:this})},M.toRuntimeSource=nj,M}function Ghe(e){let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,Math.round(t*10)/1e3}const Whe=[...Array(25)].map((e,t)=>{if(t===0)return"none";const n=Ghe(t);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function rj(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function ij(e){return e==="dark"?Whe:[]}function qhe(e){const{palette:t={mode:"light"},opacity:n,overlays:r,...i}=e,a=hL(t);return{palette:a,opacity:{...rj(a.mode),...n},overlays:r||ij(a.mode),...i}}function Xhe(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((t=e[1])!=null&&t.match(/(mode|contrastThreshold|tonalOffset)/))}const Zhe=e=>[...[...Array(25)].map((t,n)=>`--${e?`${e}-`:""}overlays-${n}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],Yhe=e=>(t,n)=>{const r=e.rootSelector||":root",i=e.colorSchemeSelector;let a=i;if(i==="class"&&(a=".%s"),i==="data"&&(a="[data-%s]"),i!=null&&i.startsWith("data-")&&!i.includes("%s")&&(a=`[${i}="%s"]`),e.defaultColorScheme===t){if(t==="dark"){const c={};return Zhe(e.cssVarPrefix).forEach(o=>{c[o]=n[o],delete n[o]}),a==="media"?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:c}}:a?{[a.replace("%s",t)]:c,[`${r}, ${a.replace("%s",t)}`]:n}:{[r]:{...n,...c}}}if(a&&a!=="media")return`${r}, ${a.replace("%s",String(t))}`}else if(t){if(a==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[r]:n}};if(a)return a.replace("%s",String(t))}return r};function Khe(e,t){t.forEach(n=>{e[n]||(e[n]={})})}function Bt(e,t,n){!e[t]&&n&&(e[t]=n)}function X0(e){return typeof e!="string"||!e.startsWith("hsl")?e:QV(e)}function Uc(e,t){`${t}Channel`in e||(e[`${t}Channel`]=q0(X0(e[t])))}function Jhe(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const Jl=e=>{try{return e()}catch{}},Qhe=(e="mui")=>yhe(e);function LE(e,t,n,r){if(!t)return;t=t===!0?{}:t;const i=r==="dark"?"dark":"light";if(!n){e[r]=qhe({...t,palette:{mode:i,...t==null?void 0:t.palette}});return}const{palette:a,...c}=DA({...n,palette:{mode:i,...t==null?void 0:t.palette}});return e[r]={...t,palette:a,opacity:{...rj(i),...t==null?void 0:t.opacity},overlays:(t==null?void 0:t.overlays)||ij(i)},c}function ede(e={},...t){const{colorSchemes:n={light:!0},defaultColorScheme:r,disableCssColorScheme:i=!1,cssVarPrefix:a="mui",shouldSkipGeneratingVar:c=Xhe,colorSchemeSelector:o=n.light&&n.dark?"media":void 0,rootSelector:f=":root",...g}=e,_=Object.keys(n)[0],x=r||(n.light&&_!=="light"?"light":_),M=Qhe(a),{[x]:C,light:A,dark:L,...I}=n,T={...I};let z=C;if((x==="dark"&&!("dark"in n)||x==="light"&&!("light"in n))&&(z=!0),!z)throw new Error(Ff(21,x));const k=LE(T,z,g,x);A&&!T.light&&LE(T,A,void 0,"light"),L&&!T.dark&&LE(T,L,void 0,"dark");let U={defaultColorScheme:x,...k,cssVarPrefix:a,colorSchemeSelector:o,rootSelector:f,getCssVar:M,colorSchemes:T,font:{...Rhe(k.typography),...k.font},spacing:Jhe(g.spacing)};Object.keys(U.colorSchemes).forEach(Y=>{const N=U.colorSchemes[Y].palette,ne=ye=>{const ge=ye.split("-"),Ne=ge[1],Ae=ge[2];return M(ye,N[Ne][Ae])};if(N.mode==="light"&&(Bt(N.common,"background","#fff"),Bt(N.common,"onBackground","#000")),N.mode==="dark"&&(Bt(N.common,"background","#000"),Bt(N.common,"onBackground","#fff")),Khe(N,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),N.mode==="light"){Bt(N.Alert,"errorColor",Yr(N.error.light,.6)),Bt(N.Alert,"infoColor",Yr(N.info.light,.6)),Bt(N.Alert,"successColor",Yr(N.success.light,.6)),Bt(N.Alert,"warningColor",Yr(N.warning.light,.6)),Bt(N.Alert,"errorFilledBg",ne("palette-error-main")),Bt(N.Alert,"infoFilledBg",ne("palette-info-main")),Bt(N.Alert,"successFilledBg",ne("palette-success-main")),Bt(N.Alert,"warningFilledBg",ne("palette-warning-main")),Bt(N.Alert,"errorFilledColor",Jl(()=>N.getContrastText(N.error.main))),Bt(N.Alert,"infoFilledColor",Jl(()=>N.getContrastText(N.info.main))),Bt(N.Alert,"successFilledColor",Jl(()=>N.getContrastText(N.success.main))),Bt(N.Alert,"warningFilledColor",Jl(()=>N.getContrastText(N.warning.main))),Bt(N.Alert,"errorStandardBg",Kr(N.error.light,.9)),Bt(N.Alert,"infoStandardBg",Kr(N.info.light,.9)),Bt(N.Alert,"successStandardBg",Kr(N.success.light,.9)),Bt(N.Alert,"warningStandardBg",Kr(N.warning.light,.9)),Bt(N.Alert,"errorIconColor",ne("palette-error-main")),Bt(N.Alert,"infoIconColor",ne("palette-info-main")),Bt(N.Alert,"successIconColor",ne("palette-success-main")),Bt(N.Alert,"warningIconColor",ne("palette-warning-main")),Bt(N.AppBar,"defaultBg",ne("palette-grey-100")),Bt(N.Avatar,"defaultBg",ne("palette-grey-400")),Bt(N.Button,"inheritContainedBg",ne("palette-grey-300")),Bt(N.Button,"inheritContainedHoverBg",ne("palette-grey-A100")),Bt(N.Chip,"defaultBorder",ne("palette-grey-400")),Bt(N.Chip,"defaultAvatarColor",ne("palette-grey-700")),Bt(N.Chip,"defaultIconColor",ne("palette-grey-700")),Bt(N.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Bt(N.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Bt(N.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Bt(N.LinearProgress,"primaryBg",Kr(N.primary.main,.62)),Bt(N.LinearProgress,"secondaryBg",Kr(N.secondary.main,.62)),Bt(N.LinearProgress,"errorBg",Kr(N.error.main,.62)),Bt(N.LinearProgress,"infoBg",Kr(N.info.main,.62)),Bt(N.LinearProgress,"successBg",Kr(N.success.main,.62)),Bt(N.LinearProgress,"warningBg",Kr(N.warning.main,.62)),Bt(N.Skeleton,"bg",`rgba(${ne("palette-text-primaryChannel")} / 0.11)`),Bt(N.Slider,"primaryTrack",Kr(N.primary.main,.62)),Bt(N.Slider,"secondaryTrack",Kr(N.secondary.main,.62)),Bt(N.Slider,"errorTrack",Kr(N.error.main,.62)),Bt(N.Slider,"infoTrack",Kr(N.info.main,.62)),Bt(N.Slider,"successTrack",Kr(N.success.main,.62)),Bt(N.Slider,"warningTrack",Kr(N.warning.main,.62));const ye=Y1(N.background.default,.8);Bt(N.SnackbarContent,"bg",ye),Bt(N.SnackbarContent,"color",Jl(()=>N.getContrastText(ye))),Bt(N.SpeedDialAction,"fabHoverBg",Y1(N.background.paper,.15)),Bt(N.StepConnector,"border",ne("palette-grey-400")),Bt(N.StepContent,"border",ne("palette-grey-400")),Bt(N.Switch,"defaultColor",ne("palette-common-white")),Bt(N.Switch,"defaultDisabledColor",ne("palette-grey-100")),Bt(N.Switch,"primaryDisabledColor",Kr(N.primary.main,.62)),Bt(N.Switch,"secondaryDisabledColor",Kr(N.secondary.main,.62)),Bt(N.Switch,"errorDisabledColor",Kr(N.error.main,.62)),Bt(N.Switch,"infoDisabledColor",Kr(N.info.main,.62)),Bt(N.Switch,"successDisabledColor",Kr(N.success.main,.62)),Bt(N.Switch,"warningDisabledColor",Kr(N.warning.main,.62)),Bt(N.TableCell,"border",Kr(Z1(N.divider,1),.88)),Bt(N.Tooltip,"bg",Z1(N.grey[700],.92))}if(N.mode==="dark"){Bt(N.Alert,"errorColor",Kr(N.error.light,.6)),Bt(N.Alert,"infoColor",Kr(N.info.light,.6)),Bt(N.Alert,"successColor",Kr(N.success.light,.6)),Bt(N.Alert,"warningColor",Kr(N.warning.light,.6)),Bt(N.Alert,"errorFilledBg",ne("palette-error-dark")),Bt(N.Alert,"infoFilledBg",ne("palette-info-dark")),Bt(N.Alert,"successFilledBg",ne("palette-success-dark")),Bt(N.Alert,"warningFilledBg",ne("palette-warning-dark")),Bt(N.Alert,"errorFilledColor",Jl(()=>N.getContrastText(N.error.dark))),Bt(N.Alert,"infoFilledColor",Jl(()=>N.getContrastText(N.info.dark))),Bt(N.Alert,"successFilledColor",Jl(()=>N.getContrastText(N.success.dark))),Bt(N.Alert,"warningFilledColor",Jl(()=>N.getContrastText(N.warning.dark))),Bt(N.Alert,"errorStandardBg",Yr(N.error.light,.9)),Bt(N.Alert,"infoStandardBg",Yr(N.info.light,.9)),Bt(N.Alert,"successStandardBg",Yr(N.success.light,.9)),Bt(N.Alert,"warningStandardBg",Yr(N.warning.light,.9)),Bt(N.Alert,"errorIconColor",ne("palette-error-main")),Bt(N.Alert,"infoIconColor",ne("palette-info-main")),Bt(N.Alert,"successIconColor",ne("palette-success-main")),Bt(N.Alert,"warningIconColor",ne("palette-warning-main")),Bt(N.AppBar,"defaultBg",ne("palette-grey-900")),Bt(N.AppBar,"darkBg",ne("palette-background-paper")),Bt(N.AppBar,"darkColor",ne("palette-text-primary")),Bt(N.Avatar,"defaultBg",ne("palette-grey-600")),Bt(N.Button,"inheritContainedBg",ne("palette-grey-800")),Bt(N.Button,"inheritContainedHoverBg",ne("palette-grey-700")),Bt(N.Chip,"defaultBorder",ne("palette-grey-700")),Bt(N.Chip,"defaultAvatarColor",ne("palette-grey-300")),Bt(N.Chip,"defaultIconColor",ne("palette-grey-300")),Bt(N.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Bt(N.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Bt(N.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Bt(N.LinearProgress,"primaryBg",Yr(N.primary.main,.5)),Bt(N.LinearProgress,"secondaryBg",Yr(N.secondary.main,.5)),Bt(N.LinearProgress,"errorBg",Yr(N.error.main,.5)),Bt(N.LinearProgress,"infoBg",Yr(N.info.main,.5)),Bt(N.LinearProgress,"successBg",Yr(N.success.main,.5)),Bt(N.LinearProgress,"warningBg",Yr(N.warning.main,.5)),Bt(N.Skeleton,"bg",`rgba(${ne("palette-text-primaryChannel")} / 0.13)`),Bt(N.Slider,"primaryTrack",Yr(N.primary.main,.5)),Bt(N.Slider,"secondaryTrack",Yr(N.secondary.main,.5)),Bt(N.Slider,"errorTrack",Yr(N.error.main,.5)),Bt(N.Slider,"infoTrack",Yr(N.info.main,.5)),Bt(N.Slider,"successTrack",Yr(N.success.main,.5)),Bt(N.Slider,"warningTrack",Yr(N.warning.main,.5));const ye=Y1(N.background.default,.98);Bt(N.SnackbarContent,"bg",ye),Bt(N.SnackbarContent,"color",Jl(()=>N.getContrastText(ye))),Bt(N.SpeedDialAction,"fabHoverBg",Y1(N.background.paper,.15)),Bt(N.StepConnector,"border",ne("palette-grey-600")),Bt(N.StepContent,"border",ne("palette-grey-600")),Bt(N.Switch,"defaultColor",ne("palette-grey-300")),Bt(N.Switch,"defaultDisabledColor",ne("palette-grey-600")),Bt(N.Switch,"primaryDisabledColor",Yr(N.primary.main,.55)),Bt(N.Switch,"secondaryDisabledColor",Yr(N.secondary.main,.55)),Bt(N.Switch,"errorDisabledColor",Yr(N.error.main,.55)),Bt(N.Switch,"infoDisabledColor",Yr(N.info.main,.55)),Bt(N.Switch,"successDisabledColor",Yr(N.success.main,.55)),Bt(N.Switch,"warningDisabledColor",Yr(N.warning.main,.55)),Bt(N.TableCell,"border",Yr(Z1(N.divider,1),.68)),Bt(N.Tooltip,"bg",Z1(N.grey[700],.92))}Uc(N.background,"default"),Uc(N.background,"paper"),Uc(N.common,"background"),Uc(N.common,"onBackground"),Uc(N,"divider"),Object.keys(N).forEach(ye=>{const ge=N[ye];ye!=="tonalOffset"&&ge&&typeof ge=="object"&&(ge.main&&Bt(N[ye],"mainChannel",q0(X0(ge.main))),ge.light&&Bt(N[ye],"lightChannel",q0(X0(ge.light))),ge.dark&&Bt(N[ye],"darkChannel",q0(X0(ge.dark))),ge.contrastText&&Bt(N[ye],"contrastTextChannel",q0(X0(ge.contrastText))),ye==="text"&&(Uc(N[ye],"primary"),Uc(N[ye],"secondary")),ye==="action"&&(ge.active&&Uc(N[ye],"active"),ge.selected&&Uc(N[ye],"selected")))})}),U=t.reduce((Y,N)=>Ma(Y,N),U);const H={prefix:a,disableCssColorScheme:i,shouldSkipGeneratingVar:c,getSelector:Yhe(U)},{vars:V,generateThemeVars:q,generateStyleSheets:J}=bhe(U,H);return U.vars=V,Object.entries(U.colorSchemes[U.defaultColorScheme]).forEach(([Y,N])=>{U[Y]=N}),U.generateThemeVars=q,U.generateStyleSheets=J,U.generateSpacing=function(){return XV(g.spacing,sL(this))},U.getColorSchemeSelector=whe(o),U.spacing=U.generateSpacing(),U.shouldSkipGeneratingVar=c,U.unstable_sxConfig={...i2,...g==null?void 0:g.unstable_sxConfig},U.unstable_sx=function(N){return Eg({sx:N,theme:this})},U.toRuntimeSource=nj,U}function Q5(e,t,n){e.colorSchemes&&n&&(e.colorSchemes[t]={...n!==!0&&n,palette:hL({...n===!0?{}:n.palette,mode:t})})}function tde(e={},...t){const{palette:n,cssVariables:r=!1,colorSchemes:i=n?void 0:{light:!0},defaultColorScheme:a=n==null?void 0:n.mode,...c}=e,o=a||"light",f=i==null?void 0:i[o],g={...i,...n?{[o]:{...typeof f!="boolean"&&f,palette:n}}:void 0};if(r===!1){if(!("colorSchemes"in e))return DA(e,...t);let _=n;"palette"in e||g[o]&&(g[o]!==!0?_=g[o].palette:o==="dark"&&(_={mode:"dark"}));const x=DA({...e,palette:_},...t);return x.defaultColorScheme=o,x.colorSchemes=g,x.palette.mode==="light"&&(x.colorSchemes.light={...g.light!==!0&&g.light,palette:x.palette},Q5(x,"dark",g.dark)),x.palette.mode==="dark"&&(x.colorSchemes.dark={...g.dark!==!0&&g.dark,palette:x.palette},Q5(x,"light",g.light)),x}return!n&&!("light"in g)&&o==="light"&&(g.light=!0),ede({...c,colorSchemes:g,defaultColorScheme:o,...typeof r!="boolean"&&r},...t)}const nde=tde(),rde="$$material";function ide(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const ode=e=>ide(e)&&e!=="classes",sde=rhe({themeId:rde,defaultTheme:nde,rootShouldForwardProp:ode}),ade=vhe;function lde(e){return ghe(e)}function cde(e){return YV("MuiSvgIcon",e)}Que("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const ude=e=>{const{color:t,fontSize:n,classes:r}=e,i={root:["root",t!=="inherit"&&`color${Cg(t)}`,`fontSize${Cg(n)}`]};return Qce(i,cde,r)},hde=sde("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.color!=="inherit"&&t[`color${Cg(n.color)}`],t[`fontSize${Cg(n.fontSize)}`]]}})(ade(({theme:e})=>{var t,n,r,i,a,c,o,f,g,_,x,M,C,A;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(i=(t=e.transitions)==null?void 0:t.create)==null?void 0:i.call(t,"fill",{duration:(r=(n=(e.vars??e).transitions)==null?void 0:n.duration)==null?void 0:r.shorter}),variants:[{props:L=>!L.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((c=(a=e.typography)==null?void 0:a.pxToRem)==null?void 0:c.call(a,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((f=(o=e.typography)==null?void 0:o.pxToRem)==null?void 0:f.call(o,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((_=(g=e.typography)==null?void 0:g.pxToRem)==null?void 0:_.call(g,35))||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,L])=>L&&L.main).map(([L])=>{var I,T;return{props:{color:L},style:{color:(T=(I=(e.vars??e).palette)==null?void 0:I[L])==null?void 0:T.main}}}),{props:{color:"action"},style:{color:(M=(x=(e.vars??e).palette)==null?void 0:x.action)==null?void 0:M.active}},{props:{color:"disabled"},style:{color:(A=(C=(e.vars??e).palette)==null?void 0:C.action)==null?void 0:A.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),zA=$.forwardRef(function(t,n){const r=lde({props:t,name:"MuiSvgIcon"}),{children:i,className:a,color:c="inherit",component:o="svg",fontSize:f="medium",htmlColor:g,inheritViewBox:_=!1,titleAccess:x,viewBox:M="0 0 24 24",...C}=r,A=$.isValidElement(i)&&i.type==="svg",L={...r,color:c,component:o,fontSize:f,instanceFontSize:t.fontSize,inheritViewBox:_,viewBox:M,hasSvgAsChild:A},I={};_||(I.viewBox=M);const T=ude(L);return ee.jsxs(hde,{as:o,className:xi(T.root,a),focusable:"false",color:g,"aria-hidden":x?void 0:!0,role:x?"img":void 0,ref:n,...I,...C,...A&&i.props,ownerState:L,children:[A?i.props.children:i,x?ee.jsx("title",{children:x}):null]})});zA.muiName="SvgIcon";function qo(e,t){function n(r,i){return ee.jsx(zA,{"data-testid":void 0,ref:i,...r,children:e})}return n.muiName=zA.muiName,$.memo($.forwardRef(n))}const dL=qo(ee.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}));function Qn(e,t){if(e==null)throw new Error(t);return e}function oj(e,t){if(!e)throw new Error(`assertion failed: ${t}`);return e}var wo=(e=>(e[e.Arizona=0]="Arizona",e[e.Arkansas=1]="Arkansas",e[e.Colorado=2]="Colorado",e[e.Idaho=3]="Idaho",e[e.Iowa=4]="Iowa",e[e.Kansas=5]="Kansas",e[e.Missouri=6]="Missouri",e[e.Montana=7]="Montana",e[e.Nebraska=8]="Nebraska",e[e.Nevada=9]="Nevada",e[e.NewMexico=10]="NewMexico",e[e.Oklahoma=11]="Oklahoma",e[e.Oregon=12]="Oregon",e[e.Texas=13]="Texas",e[e.Utah=14]="Utah",e[e.Washington=15]="Washington",e[e.Wyoming=16]="Wyoming",e))(wo||{});const Nf=new Set([9,0,10,12,15,14,3,2,16,7,13,11,5,8,1,6,4]),dde={9:"Nevada",0:"Arizona",10:"New Mexico",12:"Oregon",15:"Washington",14:"Utah",3:"Idaho",2:"Colorado",16:"Wyoming",7:"Montana",13:"Texas",11:"Oklahoma",5:"Kansas",8:"Nebraska",1:"Arkansas",6:"Missouri",4:"Iowa"},sj={0:new Set,1:new Set([9]),2:new Set([0]),3:new Set([10]),4:new Set([12]),5:new Set([15]),6:new Set([15,12]),7:new Set([14]),8:new Set([14,10]),9:new Set([3]),10:new Set([3,12]),11:new Set([3,14]),12:new Set([3,15]),13:new Set([2]),14:new Set([2,10]),15:new Set([2,14]),16:new Set([16]),17:new Set([16,2]),18:new Set([16,3]),19:new Set([16,14]),20:new Set([13]),21:new Set([13,10]),22:new Set([7]),23:new Set([7,3]),24:new Set([7,16]),25:new Set([11]),26:new Set([11,2]),27:new Set([11,10]),28:new Set([11,13]),29:new Set([5]),30:new Set([5,2]),31:new Set([5,11]),32:new Set([8]),33:new Set([8,2]),34:new Set([8,5]),35:new Set([8,16]),36:new Set([1]),37:new Set([1,11]),38:new Set([1,13]),39:new Set([6]),40:new Set([6,1]),41:new Set([6,5]),42:new Set([6,8]),43:new Set([6,11]),44:new Set([4]),45:new Set([4,6]),46:new Set([4,8])},fde={1:0,2:1,3:2,7:13,13:9,31:3,37:4,43:20,44:7,47:5,17:29,27:22,36:25,50:16,18:32,19:36,26:39,21:44};for(const e of Object.values(fde))e!==0&&oj(sj[e].size===1);function K_(e){const t=new Set;for(const[n,r]of Object.entries(sj))[...r].every(i=>e.has(i))&&t.add(Number(n));return t}const pde=new Set([0,1,2,3,4,5,6,7,11]),mde={0:new Set,1:new Set([0]),2:new Set([1]),3:new Set([2]),4:new Set([3]),5:new Set([3,2]),6:new Set([4]),7:new Set([4,0]),8:new Set([4,1]),9:new Set([5]),10:new Set([5,0]),11:new Set([6]),12:new Set([6,2]),16:new Set([7]),17:new Set([7,0]),18:new Set([7,4]),20:new Set([11]),21:new Set([11,0]),22:new Set([11,7])};function gde(e){const t=new Set;for(const[n,r]of Object.entries(mde))[...r].every(i=>e.has(i))&&t.add(Number(n));return t}var aj=(e=>(e[e.Road=0]="Road",e[e.Light=1]="Light",e[e.Dark=2]="Dark",e[e.Green=3]="Green",e[e.NavRed=4]="NavRed",e[e.NavGreen=5]="NavGreen",e[e.NavBlue=6]="NavBlue",e[e.NavYellow=7]="NavYellow",e[e.NavPurple=8]="NavPurple",e))(aj||{});const vde="modulepreload",yde=function(e){return"/"+e},e4={},_de=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),o=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=Promise.allSettled(n.map(f=>{if(f=yde(f),f in e4)return;e4[f]=!0;const g=f.endsWith(".css"),_=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${_}`))return;const x=document.createElement("link");if(x.rel=g?"stylesheet":vde,g||(x.as="script"),x.crossOrigin="",x.href=f,o&&x.setAttribute("nonce",o),document.head.appendChild(x),g)return new Promise((M,C)=>{x.addEventListener("load",M),x.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(c){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=c,window.dispatchEvent(o),!o.defaultPrevented)throw c}return i.then(c=>{for(const o of c||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})},lj=$.createContext(null);function J_(){var r;const e=(r=$.useContext(lj))==null?void 0:r.maps,t=$.useContext(Xf);return $.useMemo(()=>({...e,current:t==null?void 0:t.map}),[e,t])}function xde(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,r=Array.isArray(e)?e[1]:e?e.y:0,i=Array.isArray(t)?t[0]:t?t.x:0,a=Array.isArray(t)?t[1]:t?t.y:0;return n===i&&r===a}function zs(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!zs(e[n],t[n]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const i of n)if(!t.hasOwnProperty(i)||!zs(e[i],t[i]))return!1;return!0}return!1}function t4(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function n4(e,t){const n=t.viewState||t,r={};if("longitude"in n&&"latitude"in n&&(n.longitude!==e.center.lng||n.latitude!==e.center.lat)){const i=e.center.constructor;r.center=new i(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==e.zoom&&(r.zoom=n.zoom),"bearing"in n&&n.bearing!==e.bearing&&(r.bearing=n.bearing),"pitch"in n&&n.pitch!==e.pitch&&(r.pitch=n.pitch),n.padding&&e.padding&&!zs(n.padding,e.padding)&&(r.padding=n.padding),r}const bde=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function r4(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const r of e.layers)t[r.id]=r;const n=e.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const a=t[r.ref];if(a){i=i||Object.assign({},r),delete i.ref;for(const c of bde)c in a&&(i[c]=a[c])}return i||r});return{...e,layers:n}}const i4={version:8,sources:{},layers:[]},o4={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},s4={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},a4={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},wde=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Sde=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Tg{constructor(t,n,r){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=i=>{const a=this.props[a4[i.type]];a?a(i):i.type==="error"&&console.error(i.error)},this._onCameraEvent=i=>{if(this._internalUpdate)return;i.viewState=this._propsedCameraUpdate||t4(this._map.transform);const a=this.props[s4[i.type]];a&&a(i)},this._onCameraUpdate=i=>this._internalUpdate?i:(this._propsedCameraUpdate=t4(i),n4(i,this.props)),this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const a=this.props[o4[i.type]];a&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),a(i),delete i.features)},this._MapClass=t,this.props=n,this._initialize(r)}get map(){return this._map}setProps(t){const n=this.props;this.props=t;const r=this._updateSettings(t,n),i=this._updateSize(t),a=this._updateViewState(t);this._updateStyle(t,n),this._updateStyleComponents(t),this._updateHandlers(t,n),(r||i||a&&!this._map.isMoving())&&this.redraw()}static reuse(t,n){const r=Tg.savedMaps.pop();if(!r)return null;const i=r.map,a=i.getContainer();for(n.className=a.className;a.childNodes.length>0;)n.appendChild(a.childNodes[0]);i._container=n;const c=i._resizeObserver;c&&(c.disconnect(),c.observe(n)),r.setProps({...t,styleDiffing:!1}),i.resize();const{initialViewState:o}=t;return o&&(o.bounds?i.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):r._updateViewState(o)),i.isStyleLoaded()?i.fire("load"):i.once("style.load",()=>i.fire("load")),i._update(),r}_initialize(t){const{props:n}=this,{mapStyle:r=i4}=n,i={...n,...n.initialViewState,container:t,style:r4(r)},a=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[a.longitude||0,a.latitude||0],zoom:a.zoom||0,pitch:a.pitch||0,bearing:a.bearing||0}),n.gl){const o=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=o,n.gl)}const c=new this._MapClass(i);a.padding&&c.setPadding(a.padding),n.cursor&&(c.getCanvas().style.cursor=n.cursor),c.transformCameraUpdate=this._onCameraUpdate,c.on("style.load",()=>{var o;this._styleComponents={light:c.getLight(),sky:c.getSky(),projection:(o=c.getProjection)==null?void 0:o.call(c),terrain:c.getTerrain()},this._updateStyleComponents(this.props)}),c.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const o in o4)c.on(o,this._onPointerEvent);for(const o in s4)c.on(o,this._onCameraEvent);for(const o in a4)c.on(o,this._onEvent);this._map=c}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),Tg.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_updateSize(t){const{viewState:n}=t;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(t){const n=this._map,r=n.transform;if(!n.isMoving()){const a=n4(r,t);if(Object.keys(a).length>0)return this._internalUpdate=!0,n.jumpTo(a),this._internalUpdate=!1,!0}return!1}_updateSettings(t,n){const r=this._map;let i=!1;for(const a of wde)if(a in t&&!zs(t[a],n[a])){i=!0;const c=r[`set${a[0].toUpperCase()}${a.slice(1)}`];c==null||c.call(r,t[a])}return i}_updateStyle(t,n){if(t.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==n.mapStyle){const{mapStyle:r=i4,styleDiffing:i=!0}=t,a={diff:i};"localIdeographFontFamily"in t&&(a.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(r4(r),a)}}_updateStyleComponents({light:t,projection:n,sky:r,terrain:i}){var o,f;const a=this._map,c=this._styleComponents;a.style._loaded&&(t&&!zs(t,c.light)&&(c.light=t,a.setLight(t)),n&&!zs(n,c.projection)&&n!==((o=c.projection)==null?void 0:o.type)&&(c.projection=typeof n=="string"?{type:n}:n,(f=a.setProjection)==null||f.call(a,c.projection)),r&&!zs(r,c.sky)&&(c.sky=r,a.setSky(r)),i!==void 0&&!zs(i,c.terrain)&&(!i||a.getSource(i.source))&&(c.terrain=i,a.setTerrain(i)))}_updateHandlers(t,n){const r=this._map;for(const i of Sde){const a=t[i]??!0,c=n[i]??!0;zs(a,c)||(a?r[i].enable(a):r[i].disable())}}_queryRenderedFeatures(t){const n=this._map,{interactiveLayerIds:r=[]}=this.props;try{return n.queryRenderedFeatures(t,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(t){var i;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const a=t.type,c=((i=this._hoveredFeatures)==null?void 0:i.length)>0,o=this._queryRenderedFeatures(t.point),f=o.length>0;!f&&c&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=o,f&&!c&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=a}else this._hoveredFeatures=null}}Tg.savedMaps=[];const Mde=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Cde(e){if(!e)return null;const t=e.map,n={getMap:()=>t};for(const r of Ede(t))!(r in n)&&!Mde.includes(r)&&(n[r]=t[r].bind(t));return n}function Ede(e){const t=new Set;let n=e;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof e[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&t.add(r);n=Object.getPrototypeOf(n)}return Array.from(t)}const Tde=typeof document<"u"?$.useLayoutEffect:$.useEffect;function Pde(e,t){const{RTLTextPlugin:n,maxParallelImageRequests:r,workerCount:i,workerUrl:a}=t;if(n&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:c,lazy:o=!0}=typeof n=="string"?{pluginUrl:n}:n;e.setRTLTextPlugin(c,f=>{f&&console.error(f)},o)}r!==void 0&&e.setMaxParallelImageRequests(r),i!==void 0&&e.setWorkerCount(i),a!==void 0&&e.setWorkerUrl(a)}const Xf=$.createContext(null);function Ade(e,t){const n=$.useContext(lj),[r,i]=$.useState(null),a=$.useRef(),{current:c}=$.useRef({mapLib:null,map:null});$.useEffect(()=>{const g=e.mapLib;let _=!0,x;return Promise.resolve(g||_de(()=>Promise.resolve().then(()=>Zde),[])).then(M=>{if(!_)return;if(!M)throw new Error("Invalid mapLib");const C="Map"in M?M:M.default;if(!C.Map)throw new Error("Invalid mapLib");Pde(C,e),e.reuseMaps&&(x=Tg.reuse(e,a.current)),x||(x=new Tg(C.Map,e,a.current)),c.map=Cde(x),c.mapLib=C,i(x),n==null||n.onMapMount(c.map,e.id)}).catch(M=>{const{onError:C}=e;C?C({type:"error",target:null,originalEvent:null,error:M}):console.error(M)}),()=>{_=!1,x&&(n==null||n.onMapUnmount(e.id),e.reuseMaps?x.recycle():x.destroy())}},[]),Tde(()=>{r&&r.setProps(e)}),$.useImperativeHandle(t,()=>c.map,[r]);const o=$.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),f={height:"100%"};return $.createElement("div",{id:e.id,ref:a,style:o},r&&$.createElement(Xf.Provider,{value:c},$.createElement("div",{"mapboxgl-children":"",style:f},e.children)))}const s2=$.forwardRef(Ade),Ide=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function bu(e,t){if(!e||!t)return;const n=e.style;for(const r in t){const i=t[r];Number.isFinite(i)&&!Ide.test(r)?n[r]=`${i}px`:n[r]=i}}function cj(e,t){if(e===t)return null;const n=l4(e),r=l4(t),i=[];for(const a of r)n.has(a)||i.push(a);for(const a of n)r.has(a)||i.push(a);return i.length===0?null:i}function l4(e){return new Set(e?e.trim().split(/\s+/):[])}const fL=$.memo($.forwardRef((e,t)=>{const{map:n,mapLib:r}=$.useContext(Xf),i=$.useRef({props:e}),a=$.useMemo(()=>{let T=!1;$.Children.forEach(e.children,U=>{U&&(T=!0)});const z={...e,element:T?document.createElement("div"):void 0},k=new r.Marker(z);return k.setLngLat([e.longitude,e.latitude]),k.getElement().addEventListener("click",U=>{var H,V;(V=(H=i.current.props).onClick)==null||V.call(H,{type:"click",target:k,originalEvent:U})}),k.on("dragstart",U=>{var V,q;const H=U;H.lngLat=a.getLngLat(),(q=(V=i.current.props).onDragStart)==null||q.call(V,H)}),k.on("drag",U=>{var V,q;const H=U;H.lngLat=a.getLngLat(),(q=(V=i.current.props).onDrag)==null||q.call(V,H)}),k.on("dragend",U=>{var V,q;const H=U;H.lngLat=a.getLngLat(),(q=(V=i.current.props).onDragEnd)==null||q.call(V,H)}),k},[]);$.useEffect(()=>(a.addTo(n.getMap()),()=>{a.remove()}),[]);const{longitude:c,latitude:o,offset:f,style:g,draggable:_=!1,popup:x=null,rotation:M=0,rotationAlignment:C="auto",pitchAlignment:A="auto"}=e;$.useEffect(()=>{bu(a.getElement(),g)},[g]),$.useImperativeHandle(t,()=>a,[]);const L=i.current.props;(a.getLngLat().lng!==c||a.getLngLat().lat!==o)&&a.setLngLat([c,o]),f&&!xde(a.getOffset(),f)&&a.setOffset(f),a.isDraggable()!==_&&a.setDraggable(_),a.getRotation()!==M&&a.setRotation(M),a.getRotationAlignment()!==C&&a.setRotationAlignment(C),a.getPitchAlignment()!==A&&a.setPitchAlignment(A),a.getPopup()!==x&&a.setPopup(x);const I=cj(L.className,e.className);if(I)for(const T of I)a.toggleClassName(T);return i.current.props=e,F_.createPortal(e.children,a.getElement())})),Rde=$.memo($.forwardRef((e,t)=>{const{map:n,mapLib:r}=$.useContext(Xf),i=$.useMemo(()=>document.createElement("div"),[]),a=$.useRef({props:e}),c=$.useMemo(()=>{const o={...e},f=new r.Popup(o);return f.setLngLat([e.longitude,e.latitude]),f.once("open",g=>{var _,x;(x=(_=a.current.props).onOpen)==null||x.call(_,g)}),f},[]);if($.useEffect(()=>{const o=f=>{var g,_;(_=(g=a.current.props).onClose)==null||_.call(g,f)};return c.on("close",o),c.setDOMContent(i).addTo(n.getMap()),()=>{c.off("close",o),c.isOpen()&&c.remove()}},[]),$.useEffect(()=>{bu(c.getElement(),e.style)},[e.style]),$.useImperativeHandle(t,()=>c,[]),c.isOpen()){const o=a.current.props;(c.getLngLat().lng!==e.longitude||c.getLngLat().lat!==e.latitude)&&c.setLngLat([e.longitude,e.latitude]),e.offset&&!zs(o.offset,e.offset)&&c.setOffset(e.offset),(o.anchor!==e.anchor||o.maxWidth!==e.maxWidth)&&(c.options.anchor=e.anchor,c.setMaxWidth(e.maxWidth));const f=cj(o.className,e.className);if(f)for(const g of f)c.toggleClassName(g);a.current.props=e}return F_.createPortal(e.children,i)}));function rl(e,t,n,r){const i=$.useContext(Xf),a=$.useMemo(()=>e(i),[]);return $.useEffect(()=>{const c=t,o=typeof t=="function"?t:null,{map:f}=i;return f.hasControl(a)||f.addControl(a,c==null?void 0:c.position),()=>{o&&o(i),f.hasControl(a)&&f.removeControl(a)}},[]),a}function Lde(e){const t=rl(({mapLib:n})=>new n.AttributionControl(e),{position:e.position});return $.useEffect(()=>{bu(t._container,e.style)},[e.style]),null}const uj=$.memo(Lde);function kde(e){const t=rl(({mapLib:n})=>new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return $.useEffect(()=>{bu(t._controlContainer,e.style)},[e.style]),null}const hj=$.memo(kde);function Dde(e,t){const n=$.useRef({props:e}),r=rl(({mapLib:i})=>{const a=new i.GeolocateControl(e),c=a._setupUI;return a._setupUI=()=>{a._container.hasChildNodes()||c()},a.on("geolocate",o=>{var f,g;(g=(f=n.current.props).onGeolocate)==null||g.call(f,o)}),a.on("error",o=>{var f,g;(g=(f=n.current.props).onError)==null||g.call(f,o)}),a.on("outofmaxbounds",o=>{var f,g;(g=(f=n.current.props).onOutOfMaxBounds)==null||g.call(f,o)}),a.on("trackuserlocationstart",o=>{var f,g;(g=(f=n.current.props).onTrackUserLocationStart)==null||g.call(f,o)}),a.on("trackuserlocationend",o=>{var f,g;(g=(f=n.current.props).onTrackUserLocationEnd)==null||g.call(f,o)}),a},{position:e.position});return n.current.props=e,$.useImperativeHandle(t,()=>r,[]),$.useEffect(()=>{bu(r._container,e.style)},[e.style]),null}$.memo($.forwardRef(Dde));function zde(e){const t=rl(({mapLib:n})=>new n.NavigationControl(e),{position:e.position});return $.useEffect(()=>{bu(t._container,e.style)},[e.style]),null}const dj=$.memo(zde);function Ode(e){const t=rl(({mapLib:a})=>new a.ScaleControl(e),{position:e.position}),n=$.useRef(e),r=n.current;n.current=e;const{style:i}=e;return e.maxWidth!==void 0&&e.maxWidth!==r.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==r.unit&&t.setUnit(e.unit),$.useEffect(()=>{bu(t._container,i)},[i]),null}$.memo(Ode);function Fde(e){const t=rl(({mapLib:n})=>new n.TerrainControl(e),{position:e.position});return $.useEffect(()=>{bu(t._container,e.style)},[e.style]),null}$.memo(Fde);function Nde(e){const t=rl(({mapLib:n})=>new n.LogoControl(e),{position:e.position});return $.useEffect(()=>{bu(t._container,e.style)},[e.style]),null}$.memo(Nde);function uS(e,t){if(!e)throw new Error(t)}let Bde=0;function Ude(e,t,n){if(e.style&&e.style._loaded){const r={...n};return delete r.id,delete r.children,e.addSource(t,r),e.getSource(t)}return null}function $de(e,t,n){var c,o,f;uS(t.id===n.id,"source id changed"),uS(t.type===n.type,"source type changed");let r="",i=0;for(const g in t)g!=="children"&&g!=="id"&&!zs(n[g],t[g])&&(r=g,i++);if(!i)return;const a=t.type;if(a==="geojson")e.setData(t.data);else if(a==="image")e.updateImage({url:t.url,coordinates:t.coordinates});else switch(r){case"coordinates":(c=e.setCoordinates)==null||c.call(e,t.coordinates);break;case"url":(o=e.setUrl)==null||o.call(e,t.url);break;case"tiles":(f=e.setTiles)==null||f.call(e,t.tiles);break;default:console.warn(`Unable to update <Source> prop: ${r}`)}}function jh(e){const t=$.useContext(Xf).map.getMap(),n=$.useRef(e),[,r]=$.useState(0),i=$.useMemo(()=>e.id||`jsx-source-${Bde++}`,[]);$.useEffect(()=>{if(t){const c=()=>setTimeout(()=>r(o=>o+1),0);return t.on("styledata",c),c(),()=>{var o;if(t.off("styledata",c),t.style&&t.style._loaded&&t.getSource(i)){const f=(o=t.getStyle())==null?void 0:o.layers;if(f)for(const g of f)g.source===i&&t.removeLayer(g.id);t.removeSource(i)}}}},[t]);let a=t&&t.style&&t.getSource(i);return a?$de(a,e,n.current):a=Ude(t,i,e),n.current=e,a&&$.Children.map(e.children,c=>c&&$.cloneElement(c,{source:i}))||null}function Vde(e,t,n,r){if(uS(n.id===r.id,"layer id changed"),uS(n.type===r.type,"layer type changed"),n.type==="custom"||r.type==="custom")return;const{layout:i={},paint:a={},filter:c,minzoom:o,maxzoom:f,beforeId:g}=n;if(g!==r.beforeId&&e.moveLayer(t,g),i!==r.layout){const _=r.layout||{};for(const x in i)zs(i[x],_[x])||e.setLayoutProperty(t,x,i[x]);for(const x in _)i.hasOwnProperty(x)||e.setLayoutProperty(t,x,void 0)}if(a!==r.paint){const _=r.paint||{};for(const x in a)zs(a[x],_[x])||e.setPaintProperty(t,x,a[x]);for(const x in _)a.hasOwnProperty(x)||e.setPaintProperty(t,x,void 0)}zs(c,r.filter)||e.setFilter(t,c),(o!==r.minzoom||f!==r.maxzoom)&&e.setLayerZoomRange(t,o,f)}function jde(e,t,n){if(e.style&&e.style._loaded&&(!("source"in n)||e.getSource(n.source))){const r={...n,id:t};delete r.beforeId,e.addLayer(r,n.beforeId)}}let Hde=0;function dr(e){const t=$.useContext(Xf).map.getMap(),n=$.useRef(e),[,r]=$.useState(0),i=$.useMemo(()=>e.id||`jsx-layer-${Hde++}`,[]);if($.useEffect(()=>{if(t){const c=()=>r(o=>o+1);return t.on("styledata",c),c(),()=>{t.off("styledata",c),t.style&&t.style._loaded&&t.getLayer(i)&&t.removeLayer(i)}}},[t]),t&&t.style&&t.getLayer(i))try{Vde(t,i,e,n.current)}catch(c){console.warn(c)}else jde(t,i,e);return n.current=e,null}const Gde={"text-color":"hsl(42, 10%, 14%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},Wde={"text-color":"hsl(42, 10%, 24%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},qde={"text-color":"hsl(42, 10%, 86%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},Xde={"text-color":"hsl(42, 10%, 76%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},pL={light:{water:"#b2cdfb",land:"#f8f8f8",stateBorder:"#aaa",countryBorder:"#ccc",primaryTextPaint:Gde,secondaryTextPaint:Wde,hiddenRoad:"#e9e9e8",footprint:"#e9e9e8",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#eeeeffcc",trainLine:"#aaa",trainLabel:"#555c",trainHalo:"#eefc",mapAreaOutline:"#999a"},dark:{water:"#36415d",land:"#1a1a1a",stateBorder:"#555",countryBorder:"#333",primaryTextPaint:qde,secondaryTextPaint:Xde,hiddenRoad:"#404038",footprint:"#30302f88",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#303028cc",trainLine:"#888",trainLabel:"#eeec",trainHalo:"#303028cc",mapAreaOutline:"#777a"}};var fj={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.1/LICENSE.txt
 */(function(e,t){(function(n,r){e.exports=r()})(xP,function(){var n={},r={};function i(c,o,f){if(r[c]=f,c==="index"){var g="var sharedModule = {}; ("+r.shared+")(sharedModule); ("+r.worker+")(sharedModule);",_={};return r.shared(_),r.index(n,_),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([g],{type:"text/javascript"}))),n}}i("shared",["exports"],function(c){function o(d,l,h,p){return new(h||(h=Promise))(function(y,S){function E(B){try{O(p.next(B))}catch(G){S(G)}}function R(B){try{O(p.throw(B))}catch(G){S(G)}}function O(B){var G;B.done?y(B.value):(G=B.value,G instanceof h?G:new h(function(X){X(G)})).then(E,R)}O((p=p.apply(d,l||[])).next())})}function f(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var g,_;function x(){if(_)return g;function d(l,h){this.x=l,this.y=h}return _=1,g=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,h){return this.clone()._rotateAround(l,h)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var h=l.x-this.x,p=l.y-this.y;return h*h+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,h){return Math.atan2(this.x*h-this.y*l,this.x*l+this.y*h)},_matMult:function(l){var h=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=h,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var h=Math.cos(l),p=Math.sin(l),y=p*this.x+h*this.y;return this.x=h*this.x-p*this.y,this.y=y,this},_rotateAround:function(l,h){var p=Math.cos(l),y=Math.sin(l),S=h.y+y*(this.x-h.x)+p*(this.y-h.y);return this.x=h.x+p*(this.x-h.x)-y*(this.y-h.y),this.y=S,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(l){return l instanceof d?l:Array.isArray(l)?new d(l[0],l[1]):l},g}typeof SuppressedError=="function"&&SuppressedError;var M,C,A=f(x()),L=function(){if(C)return M;function d(l,h,p,y){this.cx=3*l,this.bx=3*(p-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(y-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=p,this.p2y=y}return C=1,M=d,d.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,h){if(h===void 0&&(h=1e-6),l<0)return 0;if(l>1)return 1;for(var p=l,y=0;y<8;y++){var S=this.sampleCurveX(p)-l;if(Math.abs(S)<h)return p;var E=this.sampleCurveDerivativeX(p);if(Math.abs(E)<1e-6)break;p-=S/E}var R=0,O=1;for(p=l,y=0;y<20&&(S=this.sampleCurveX(p),!(Math.abs(S-l)<h));y++)l>S?R=p:O=p,p=.5*(O-R)+R;return p},solve:function(l,h){return this.sampleCurveY(this.solveCurveX(l,h))}},M}(),I=f(L);let T,z;function k(){return T==null&&(T=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),T}function U(){if(z==null&&(z=!1,k())){const l=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(l){for(let p=0;p<5*5;p++){const y=4*p;l.fillStyle=`rgb(${y},${y+1},${y+2})`,l.fillRect(p%5,Math.floor(p/5),1,1)}const h=l.getImageData(0,0,5,5).data;for(let p=0;p<5*5*4;p++)if(p%4!=3&&h[p]!==p){z=!0;break}}}return z||!1}var H=1e-6,V=typeof Float32Array<"u"?Float32Array:Array;function q(){var d=new V(9);return V!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d}function J(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}function Y(){var d=new V(3);return V!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d}function N(d){return Math.hypot(d[0],d[1],d[2])}function ne(d,l,h){var p=new V(3);return p[0]=d,p[1]=l,p[2]=h,p}function ye(d,l,h){return d[0]=l[0]+h[0],d[1]=l[1]+h[1],d[2]=l[2]+h[2],d}function ge(d,l,h){return d[0]=l[0]*h,d[1]=l[1]*h,d[2]=l[2]*h,d}function Ne(d,l,h){var p=l[0],y=l[1],S=l[2],E=h[0],R=h[1],O=h[2];return d[0]=y*O-S*R,d[1]=S*E-p*O,d[2]=p*R-y*E,d}Math.hypot||(Math.hypot=function(){for(var d=0,l=arguments.length;l--;)d+=arguments[l]*arguments[l];return Math.sqrt(d)});var Ae,ve=N;function Se(d,l,h){var p=l[0],y=l[1],S=l[2],E=l[3];return d[0]=h[0]*p+h[4]*y+h[8]*S+h[12]*E,d[1]=h[1]*p+h[5]*y+h[9]*S+h[13]*E,d[2]=h[2]*p+h[6]*y+h[10]*S+h[14]*E,d[3]=h[3]*p+h[7]*y+h[11]*S+h[15]*E,d}function Me(){var d=new V(4);return V!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d[3]=1,d}function Ue(d,l,h,p){var y=.5*Math.PI/180;l*=y,h*=y,p*=y;var S=Math.sin(l),E=Math.cos(l),R=Math.sin(h),O=Math.cos(h),B=Math.sin(p),G=Math.cos(p);return d[0]=S*O*G-E*R*B,d[1]=E*R*G+S*O*B,d[2]=E*O*B-S*R*G,d[3]=E*O*G+S*R*B,d}function Qe(){var d=new V(2);return V!=Float32Array&&(d[0]=0,d[1]=0),d}function st(d,l){var h=new V(2);return h[0]=d,h[1]=l,h}Y(),Ae=new V(4),V!=Float32Array&&(Ae[0]=0,Ae[1]=0,Ae[2]=0,Ae[3]=0),Y(),ne(1,0,0),ne(0,1,0),Me(),Me(),q(),Qe();const ct=8192;function Xt(d,l,h){return l*(ct/(d.tileSize*Math.pow(2,h-d.tileID.overscaledZ)))}function je(d,l){return(d%l+l)%l}function lt(d,l,h){return d*(1-h)+l*h}function Ot(d){if(d<=0)return 0;if(d>=1)return 1;const l=d*d,h=l*d;return 4*(d<.5?h:3*(d-l)+h-.75)}function ut(d,l,h,p){const y=new I(d,l,h,p);return S=>y.solve(S)}const ot=ut(.25,.1,.25,1);function Tt(d,l,h){return Math.min(h,Math.max(l,d))}function Ct(d,l,h){const p=h-l,y=((d-l)%p+p)%p+l;return y===l?h:y}function un(d,...l){for(const h of l)for(const p in h)d[p]=h[p];return d}let gn=1;function hn(d,l,h){const p={};for(const y in d)p[y]=l.call(this,d[y],y,d);return p}function We(d,l,h){const p={};for(const y in d)l.call(this,d[y],y,d)&&(p[y]=d[y]);return p}function vn(d){return Array.isArray(d)?d.map(vn):typeof d=="object"&&d?hn(d,vn):d}const Ut={};function tn(d){Ut[d]||(typeof console<"u"&&console.warn(d),Ut[d]=!0)}function Dt(d,l,h){return(h.y-d.y)*(l.x-d.x)>(l.y-d.y)*(h.x-d.x)}function An(d){return typeof WorkerGlobalScope<"u"&&d!==void 0&&d instanceof WorkerGlobalScope}let an=null;function Le(d){return typeof ImageBitmap<"u"&&d instanceof ImageBitmap}const me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function it(d,l,h,p,y){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const S=new VideoFrame(d,{timestamp:0});try{const E=S==null?void 0:S.format;if(!E||!E.startsWith("BGR")&&!E.startsWith("RGB"))throw new Error(`Unrecognized format ${E}`);const R=E.startsWith("BGR"),O=new Uint8ClampedArray(p*y*4);if(yield S.copyTo(O,function(B,G,X,ie,ae){const ce=4*Math.max(-G,0),de=(Math.max(0,X)-X)*ie*4+ce,Ce=4*ie,ke=Math.max(0,G),et=Math.max(0,X);return{rect:{x:ke,y:et,width:Math.min(B.width,G+ie)-ke,height:Math.min(B.height,X+ae)-et},layout:[{offset:de,stride:Ce}]}}(d,l,h,p,y)),R)for(let B=0;B<O.length;B+=4){const G=O[B];O[B]=O[B+2],O[B+2]=G}return O}finally{S.close()}})}let St,It;function wt(d,l,h,p){return d.addEventListener(l,h,p),{unsubscribe:()=>{d.removeEventListener(l,h,p)}}}function Zt(d){return d*Math.PI/180}function Lt(d){return d/Math.PI*180}const kt={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},bn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},zt="AbortError";function _e(){return new Error(zt)}const te={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function re(d){return te.REGISTERED_PROTOCOLS[d.substring(0,d.indexOf("://"))]}const Z="global-dispatcher";class le extends Error{constructor(l,h,p,y){super(`AJAXError: ${h} (${l}): ${p}`),this.status=l,this.statusText=h,this.url=p,this.body=y}}const Te=()=>An(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ve=function(d,l){if(/:\/\//.test(d.url)&&!/^https?:|^file:/.test(d.url)){const p=re(d.url);if(p)return p(d,l);if(An(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,targetMapId:Z},l)}if(!(/^file:/.test(h=d.url)||/^file:/.test(Te())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(p,y){return o(this,void 0,void 0,function*(){const S=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:Te(),signal:y.signal});let E,R;p.type!=="json"||S.headers.has("Accept")||S.headers.set("Accept","application/json");try{E=yield fetch(S)}catch(B){throw new le(0,B.message,p.url,new Blob)}if(!E.ok){const B=yield E.blob();throw new le(E.status,E.statusText,p.url,B)}R=p.type==="arrayBuffer"||p.type==="image"?E.arrayBuffer():p.type==="json"?E.json():E.text();const O=yield R;if(y.signal.aborted)throw _e();return{data:O,cacheControl:E.headers.get("Cache-Control"),expires:E.headers.get("Expires")}})}(d,l);if(An(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,mustQueue:!0,targetMapId:Z},l)}var h;return function(p,y){return new Promise((S,E)=>{var R;const O=new XMLHttpRequest;O.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(O.responseType="arraybuffer");for(const B in p.headers)O.setRequestHeader(B,p.headers[B]);p.type==="json"&&(O.responseType="text",!((R=p.headers)===null||R===void 0)&&R.Accept||O.setRequestHeader("Accept","application/json")),O.withCredentials=p.credentials==="include",O.onerror=()=>{E(new Error(O.statusText))},O.onload=()=>{if(!y.signal.aborted)if((O.status>=200&&O.status<300||O.status===0)&&O.response!==null){let B=O.response;if(p.type==="json")try{B=JSON.parse(O.response)}catch(G){return void E(G)}S({data:B,cacheControl:O.getResponseHeader("Cache-Control"),expires:O.getResponseHeader("Expires")})}else{const B=new Blob([O.response],{type:O.getResponseHeader("Content-Type")});E(new le(O.status,O.statusText,p.url,B))}},y.signal.addEventListener("abort",()=>{O.abort(),E(_e())}),O.send(p.body)})}(d,l)};function fe(d){if(!d||d.indexOf("://")<=0||d.indexOf("data:image/")===0||d.indexOf("blob:")===0)return!0;const l=new URL(d),h=window.location;return l.protocol===h.protocol&&l.host===h.host}function xe(d,l,h){h[d]&&h[d].indexOf(l)!==-1||(h[d]=h[d]||[],h[d].push(l))}function Re(d,l,h){if(h&&h[d]){const p=h[d].indexOf(l);p!==-1&&h[d].splice(p,1)}}class De{constructor(l,h={}){un(this,h),this.type=l}}class ze extends De{constructor(l,h={}){super("error",un({error:l},h))}}class Je{on(l,h){return this._listeners=this._listeners||{},xe(l,h,this._listeners),{unsubscribe:()=>{this.off(l,h)}}}off(l,h){return Re(l,h,this._listeners),Re(l,h,this._oneTimeListeners),this}once(l,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},xe(l,h,this._oneTimeListeners),this):new Promise(p=>this.once(l,p))}fire(l,h){typeof l=="string"&&(l=new De(l,h||{}));const p=l.type;if(this.listens(p)){l.target=this;const y=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const R of y)R.call(this,l);const S=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const R of S)Re(p,R,this._oneTimeListeners),R.call(this,l);const E=this._eventedParent;E&&(un(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(l))}else l instanceof ze&&console.error(l.error);return this}listens(l){return this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l)}setEventedParent(l,h){return this._eventedParent=l,this._eventedParentData=h,this}}var Oe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Et=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ft(d,l){const h={};for(const p in d)p!=="ref"&&(h[p]=d[p]);return Et.forEach(p=>{p in l&&(h[p]=l[p])}),h}function be(d,l){if(Array.isArray(d)){if(!Array.isArray(l)||d.length!==l.length)return!1;for(let h=0;h<d.length;h++)if(!be(d[h],l[h]))return!1;return!0}if(typeof d=="object"&&d!==null&&l!==null){if(typeof l!="object"||Object.keys(d).length!==Object.keys(l).length)return!1;for(const h in d)if(!be(d[h],l[h]))return!1;return!0}return d===l}function qe(d,l){d.push(l)}function tt(d,l,h){qe(h,{command:"addSource",args:[d,l[d]]})}function At(d,l,h){qe(l,{command:"removeSource",args:[d]}),h[d]=!0}function Ht(d,l,h,p){At(d,h,p),tt(d,l,h)}function Yt(d,l,h){let p;for(p in d[h])if(Object.prototype.hasOwnProperty.call(d[h],p)&&p!=="data"&&!be(d[h][p],l[h][p]))return!1;for(p in l[h])if(Object.prototype.hasOwnProperty.call(l[h],p)&&p!=="data"&&!be(d[h][p],l[h][p]))return!1;return!0}function qt(d,l,h,p,y,S){d=d||{},l=l||{};for(const E in d)Object.prototype.hasOwnProperty.call(d,E)&&(be(d[E],l[E])||h.push({command:S,args:[p,E,l[E],y]}));for(const E in l)Object.prototype.hasOwnProperty.call(l,E)&&!Object.prototype.hasOwnProperty.call(d,E)&&(be(d[E],l[E])||h.push({command:S,args:[p,E,l[E],y]}))}function Gt(d){return d.id}function yn(d,l){return d[l.id]=l,d}class gt{constructor(l,h,p,y){this.message=(l?`${l}: `:"")+p,y&&(this.identifier=y),h!=null&&h.__line__&&(this.line=h.__line__)}}function In(d,...l){for(const h of l)for(const p in h)d[p]=h[p];return d}class cn extends Error{constructor(l,h){super(h),this.message=h,this.key=l}}class Nn{constructor(l,h=[]){this.parent=l,this.bindings={};for(const[p,y]of h)this.bindings[p]=y}concat(l){return new Nn(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}const xt={kind:"null"},Ze={kind:"number"},Rt={kind:"string"},Wt={kind:"boolean"},pn={kind:"color"},ur={kind:"projectionDefinition"},Xn={kind:"object"},pe={kind:"value"},nt={kind:"collator"},vt={kind:"formatted"},ft={kind:"padding"},at={kind:"colorArray"},Kt={kind:"numberArray"},fn={kind:"resolvedImage"},Qt={kind:"variableAnchorOffsetCollection"};function ln(d,l){return{kind:"array",itemType:d,N:l}}function Nt(d){if(d.kind==="array"){const l=Nt(d.itemType);return typeof d.N=="number"?`array<${l}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${l}>`}return d.kind}const zn=[xt,Ze,Rt,Wt,pn,ur,vt,Xn,ln(pe),ft,Kt,at,fn,Qt];function _n(d,l){if(l.kind==="error")return null;if(d.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!_n(d.itemType,l.itemType))&&(typeof d.N!="number"||d.N===l.N))return null}else{if(d.kind===l.kind)return null;if(d.kind==="value"){for(const h of zn)if(!_n(h,l))return null}}return`Expected ${Nt(d)} but found ${Nt(l)} instead.`}function Rn(d,l){return l.some(h=>h.kind===d.kind)}function jn(d,l){return l.some(h=>h==="null"?d===null:h==="array"?Array.isArray(d):h==="object"?d&&!Array.isArray(d)&&typeof d=="object":h===typeof d)}function fr(d,l){return d.kind==="array"&&l.kind==="array"?d.itemType.kind===l.itemType.kind&&typeof d.N=="number":d.kind===l.kind}const pr=.96422,Yn=.82521,Hn=4/29,Qr=6/29,Sr=3*Qr*Qr,Xo=Qr*Qr*Qr,Es=Math.PI/180,Io=180/Math.PI;function Fl(d){return(d%=360)<0&&(d+=360),d}function Er([d,l,h,p]){let y,S;const E=go((.2225045*(d=mo(d))+.7168786*(l=mo(l))+.0606169*(h=mo(h)))/1);d===l&&l===h?y=S=E:(y=go((.4360747*d+.3850649*l+.1430804*h)/pr),S=go((.0139322*d+.0971045*l+.7141733*h)/Yn));const R=116*E-16;return[R<0?0:R,500*(y-E),200*(E-S),p]}function mo(d){return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function go(d){return d>Xo?Math.pow(d,1/3):d/Sr+Hn}function $i([d,l,h,p]){let y=(d+16)/116,S=isNaN(l)?y:y+l/500,E=isNaN(h)?y:y-h/200;return y=1*Nl(y),S=pr*Nl(S),E=Yn*Nl(E),[Ri(3.1338561*S-1.6168667*y-.4906146*E),Ri(-.9787684*S+1.9161415*y+.033454*E),Ri(.0719453*S-.2289914*y+1.4052427*E),p]}function Ri(d){return(d=d<=.00304?12.92*d:1.055*Math.pow(d,1/2.4)-.055)<0?0:d>1?1:d}function Nl(d){return d>Qr?d*d*d:Sr*(d-Hn)}const Vi=Object.hasOwn||function(d,l){return Object.prototype.hasOwnProperty.call(d,l)};function er(d,l){return Vi(d,l)?d[l]:void 0}function ol(d){return parseInt(d.padEnd(2,d),16)/255}function sl(d,l){return Tc(l?d/100:d,0,1)}function Tc(d,l,h){return Math.min(Math.max(l,d),h)}function Qg(d){return!d.some(Number.isNaN)}const ev={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Ts(d,l,h){return d+h*(l-d)}function al(d,l,h){return d.map((p,y)=>Ts(p,l[y],h))}class tr{constructor(l,h,p,y=1,S=!0){this.r=l,this.g=h,this.b=p,this.a=y,S||(this.r*=y,this.g*=y,this.b*=y,y||this.overwriteGetter("rgb",[l,h,p,y]))}static parse(l){if(l instanceof tr)return l;if(typeof l!="string")return;const h=function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const y=er(ev,p);if(y){const[E,R,O]=y;return[E/255,R/255,O/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const E=p.length<6?1:2;let R=1;return[ol(p.slice(R,R+=E)),ol(p.slice(R,R+=E)),ol(p.slice(R,R+=E)),ol(p.slice(R,R+E)||"ff")]}if(p.startsWith("rgb")){const E=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(E){const[R,O,B,G,X,ie,ae,ce,de,Ce,ke,et]=E,Ge=[G||" ",ae||" ",Ce].join("");if(Ge==="  "||Ge==="  /"||Ge===",,"||Ge===",,,"){const se=[B,ie,de].join(""),we=se==="%%%"?100:se===""?255:0;if(we){const Xe=[Tc(+O/we,0,1),Tc(+X/we,0,1),Tc(+ce/we,0,1),ke?sl(+ke,et):1];if(Qg(Xe))return Xe}}return}}const S=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[E,R,O,B,G,X,ie,ae,ce]=S,de=[O||" ",G||" ",ie].join("");if(de==="  "||de==="  /"||de===",,"||de===",,,"){const Ce=[+R,Tc(+B,0,100),Tc(+X,0,100),ae?sl(+ae,ce):1];if(Qg(Ce))return function([ke,et,Ge,se]){function we(Xe){const mt=(Xe+ke/30)%12,$t=et*Math.min(Ge,1-Ge);return Ge-$t*Math.max(-1,Math.min(mt-3,9-mt,1))}return ke=Fl(ke),et/=100,Ge/=100,[we(0),we(8),we(4),se]}(Ce)}}}(l);return h?new tr(...h,!1):void 0}get rgb(){const{r:l,g:h,b:p,a:y}=this,S=y||1/0;return this.overwriteGetter("rgb",[l/S,h/S,p/S,y])}get hcl(){return this.overwriteGetter("hcl",function(l){const[h,p,y,S]=Er(l),E=Math.sqrt(p*p+y*y);return[Math.round(1e4*E)?Fl(Math.atan2(y,p)*Io):NaN,E,h,S]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Er(this.rgb))}overwriteGetter(l,h){return Object.defineProperty(this,l,{value:h}),h}toString(){const[l,h,p,y]=this.rgb;return`rgba(${[l,h,p].map(S=>Math.round(255*S)).join(",")},${y})`}static interpolate(l,h,p,y="rgb"){switch(y){case"rgb":{const[S,E,R,O]=al(l.rgb,h.rgb,p);return new tr(S,E,R,O,!1)}case"hcl":{const[S,E,R,O]=l.hcl,[B,G,X,ie]=h.hcl;let ae,ce;if(isNaN(S)||isNaN(B))isNaN(S)?isNaN(B)?ae=NaN:(ae=B,R!==1&&R!==0||(ce=G)):(ae=S,X!==1&&X!==0||(ce=E));else{let Ge=B-S;B>S&&Ge>180?Ge-=360:B<S&&S-B>180&&(Ge+=360),ae=S+p*Ge}const[de,Ce,ke,et]=function([Ge,se,we,Xe]){return Ge=isNaN(Ge)?0:Ge*Es,$i([we,Math.cos(Ge)*se,Math.sin(Ge)*se,Xe])}([ae,ce??Ts(E,G,p),Ts(R,X,p),Ts(O,ie,p)]);return new tr(de,Ce,ke,et,!1)}case"lab":{const[S,E,R,O]=$i(al(l.lab,h.lab,p));return new tr(S,E,R,O,!1)}}}}tr.black=new tr(0,0,0,1),tr.white=new tr(1,1,1,1),tr.transparent=new tr(0,0,0,0),tr.red=new tr(1,0,0,1);class dd{constructor(l,h,p){this.sensitivity=l?h?"variant":"case":h?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,h){return this.collator.compare(l,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Kf=["bottom","center","top"];class tv{constructor(l,h,p,y,S,E){this.text=l,this.image=h,this.scale=p,this.fontStack=y,this.textColor=S,this.verticalAlign=E}}class vo{constructor(l){this.sections=l}static fromString(l){return new vo([new tv(l,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof vo?l:vo.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}}class wi{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof wi)return l;if(typeof l=="number")return new wi([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const h of l)if(typeof h!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]]}return new wi(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,p){return new wi(al(l.values,h.values,p))}}class yo{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof yo)return l;if(typeof l=="number")return new yo([l]);if(Array.isArray(l)){for(const h of l)if(typeof h!="number")return;return new yo(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,p){return new yo(al(l.values,h.values,p))}}class ji{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof ji)return l;if(typeof l=="string"){const p=tr.parse(l);return p?new ji([p]):void 0}if(!Array.isArray(l))return;const h=[];for(const p of l){if(typeof p!="string")return;const y=tr.parse(p);if(!y)return;h.push(y)}return new ji(h)}toString(){return JSON.stringify(this.values)}static interpolate(l,h,p,y="rgb"){const S=[];if(l.values.length!=h.values.length)throw new Error(`colorArray: Arrays have mismatched length (${l.values.length} vs. ${h.values.length}), cannot interpolate.`);for(let E=0;E<l.values.length;E++)S.push(tr.interpolate(l.values[E],h.values[E],p,y));return new ji(S)}}class ei extends Error{constructor(l){super(l),this.name="RuntimeError"}toJSON(){return this.message}}const Jf=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ar{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof ar)return l;if(Array.isArray(l)&&!(l.length<1)&&l.length%2==0){for(let h=0;h<l.length;h+=2){const p=l[h],y=l[h+1];if(typeof p!="string"||!Jf.has(p)||!Array.isArray(y)||y.length!==2||typeof y[0]!="number"||typeof y[1]!="number")return}return new ar(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,p){const y=l.values,S=h.values;if(y.length!==S.length)throw new ei(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${h.toString()}`);const E=[];for(let R=0;R<y.length;R+=2){if(y[R]!==S[R])throw new ei(`Cannot interpolate values containing mismatched anchors. from[${R}]: ${y[R]}, to[${R}]: ${S[R]}`);E.push(y[R]);const[O,B]=y[R+1],[G,X]=S[R+1];E.push([Ts(O,G,p),Ts(B,X,p)])}return new ar(E)}}class Zo{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new Zo({name:l,available:!1}):null}}class Wn{constructor(l,h,p){this.from=l,this.to=h,this.transition=p}static interpolate(l,h,p){return new Wn(l,h,p)}static parse(l){return l instanceof Wn?l:Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number"?new Wn(l[0],l[1],l[2]):typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number"?new Wn(l.from,l.to,l.transition):typeof l=="string"?new Wn(l,l,1):void 0}}function Kn(d,l,h,p){return typeof d=="number"&&d>=0&&d<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof h=="number"&&h>=0&&h<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[d,l,h,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[d,l,h,p]:[d,l,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Pc(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof Wn||d instanceof tr||d instanceof dd||d instanceof vo||d instanceof wi||d instanceof yo||d instanceof ji||d instanceof ar||d instanceof Zo)return!0;if(Array.isArray(d)){for(const l of d)if(!Pc(l))return!1;return!0}if(typeof d=="object"){for(const l in d)if(!Pc(d[l]))return!1;return!0}return!1}function Gn(d){if(d===null)return xt;if(typeof d=="string")return Rt;if(typeof d=="boolean")return Wt;if(typeof d=="number")return Ze;if(d instanceof tr)return pn;if(d instanceof Wn)return ur;if(d instanceof dd)return nt;if(d instanceof vo)return vt;if(d instanceof wi)return ft;if(d instanceof yo)return Kt;if(d instanceof ji)return at;if(d instanceof ar)return Qt;if(d instanceof Zo)return fn;if(Array.isArray(d)){const l=d.length;let h;for(const p of d){const y=Gn(p);if(h){if(h===y)continue;h=pe;break}h=y}return ln(h||pe,l)}return Xn}function Ac(d){const l=typeof d;return d===null?"":l==="string"||l==="number"||l==="boolean"?String(d):d instanceof tr||d instanceof Wn||d instanceof vo||d instanceof wi||d instanceof yo||d instanceof ji||d instanceof ar||d instanceof Zo?d.toString():JSON.stringify(d)}class Ro{constructor(l,h){this.type=l,this.value=h}static parse(l,h){if(l.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!Pc(l[1]))return h.error("invalid value");const p=l[1];let y=Gn(p);const S=h.expectedType;return y.kind!=="array"||y.N!==0||!S||S.kind!=="array"||typeof S.N=="number"&&S.N!==0||(y=S),new Ro(y,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Mu={string:Rt,number:Ze,boolean:Wt,object:Xn};class Yo{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let p,y=1;const S=l[0];if(S==="array"){let R,O;if(l.length>2){const B=l[1];if(typeof B!="string"||!(B in Mu)||B==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);R=Mu[B],y++}else R=pe;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return h.error('The length argument to "array" must be a positive integer literal',2);O=l[2],y++}p=ln(R,O)}else{if(!Mu[S])throw new Error(`Types doesn't contain name = ${S}`);p=Mu[S]}const E=[];for(;y<l.length;y++){const R=h.parse(l[y],y,pe);if(!R)return null;E.push(R)}return new Yo(p,E)}evaluate(l){for(let h=0;h<this.args.length;h++){const p=this.args[h].evaluate(l);if(!_n(this.type,Gn(p)))return p;if(h===this.args.length-1)throw new ei(`Expected value to be of type ${Nt(this.type)}, but found ${Nt(Gn(p))} instead.`)}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const nv={"to-boolean":Wt,"to-color":pn,"to-number":Ze,"to-string":Rt};class Ra{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const p=l[0];if(!nv[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&l.length!==2)return h.error("Expected one argument.");const y=nv[p],S=[];for(let E=1;E<l.length;E++){const R=h.parse(l[E],E,pe);if(!R)return null;S.push(R)}return new Ra(y,S)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let h,p;for(const y of this.args){if(h=y.evaluate(l),p=null,h instanceof tr)return h;if(typeof h=="string"){const S=l.parseColor(h);if(S)return S}else if(Array.isArray(h)&&(p=h.length<3||h.length>4?`Invalid rgba value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Kn(h[0],h[1],h[2],h[3]),!p))return new tr(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new ei(p||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const p of this.args){h=p.evaluate(l);const y=wi.parse(h);if(y)return y}throw new ei(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"numberArray":{let h;for(const p of this.args){h=p.evaluate(l);const y=yo.parse(h);if(y)return y}throw new ei(`Could not parse numberArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"colorArray":{let h;for(const p of this.args){h=p.evaluate(l);const y=ji.parse(h);if(y)return y}throw new ei(`Could not parse colorArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const p of this.args){h=p.evaluate(l);const y=ar.parse(h);if(y)return y}throw new ei(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const p of this.args){if(h=p.evaluate(l),h===null)return 0;const y=Number(h);if(!isNaN(y))return y}throw new ei(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return vo.fromString(Ac(this.args[0].evaluate(l)));case"resolvedImage":return Zo.fromString(Ac(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return Ac(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const wx=["Unknown","Point","LineString","Polygon"];class Sx{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?wx[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let h=this._parseColorCache.get(l);return h||(h=tr.parse(l),this._parseColorCache.set(l,h)),h}}class fd{constructor(l,h,p=[],y,S=new Nn,E=[]){this.registry=l,this.path=p,this.key=p.map(R=>`[${R}]`).join(""),this.scope=S,this.errors=E,this.expectedType=y,this._isConstant=h}parse(l,h,p,y,S={}){return h?this.concat(h,p,y)._parse(l,S):this._parse(l,S)}_parse(l,h){function p(y,S,E){return E==="assert"?new Yo(S,[y]):E==="coerce"?new Ra(S,[y]):y}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=l[0];if(typeof y!="string")return this.error(`Expression name must be a string, but found ${typeof y} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const S=this.registry[y];if(S){let E=S.parse(l,this);if(!E)return null;if(this.expectedType){const R=this.expectedType,O=E.type;if(R.kind!=="string"&&R.kind!=="number"&&R.kind!=="boolean"&&R.kind!=="object"&&R.kind!=="array"||O.kind!=="value"){if(R.kind==="projectionDefinition"&&["string","array"].includes(O.kind)||["color","formatted","resolvedImage"].includes(R.kind)&&["value","string"].includes(O.kind)||["padding","numberArray"].includes(R.kind)&&["value","number","array"].includes(O.kind)||R.kind==="colorArray"&&["value","string","array"].includes(O.kind)||R.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(O.kind))E=p(E,R,h.typeAnnotation||"coerce");else if(this.checkSubtype(R,O))return null}else E=p(E,R,h.typeAnnotation||"assert")}if(!(E instanceof Ro)&&E.type.kind!=="resolvedImage"&&this._isConstant(E)){const R=new Sx;try{E=new Ro(E.type,E.evaluate(R))}catch(O){return this.error(O.message),null}}return E}return this.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,h,p){const y=typeof l=="number"?this.path.concat(l):this.path,S=p?this.scope.concat(p):this.scope;return new fd(this.registry,this._isConstant,y,h||null,S,this.errors)}error(l,...h){const p=`${this.key}${h.map(y=>`[${y}]`).join("")}`;this.errors.push(new cn(p,l))}checkSubtype(l,h){const p=_n(l,h);return p&&this.error(p),p}}class pd{constructor(l,h){this.type=h.type,this.bindings=[].concat(l),this.result=h}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const h of this.bindings)l(h[1]);l(this.result)}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const p=[];for(let S=1;S<l.length-1;S+=2){const E=l[S];if(typeof E!="string")return h.error(`Expected string, but found ${typeof E} instead.`,S);if(/[^a-zA-Z0-9_]/.test(E))return h.error("Variable names must contain only alphanumeric characters or '_'.",S);const R=h.parse(l[S+1],S+1);if(!R)return null;p.push([E,R])}const y=h.parse(l[l.length-1],l.length-1,h.expectedType,p);return y?new pd(p,y):null}outputDefined(){return this.result.outputDefined()}}class Ks{constructor(l,h){this.type=h.type,this.name=l,this.boundExpression=h}static parse(l,h){if(l.length!==2||typeof l[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const p=l[1];return h.scope.has(p)?new Ks(p,h.scope.get(p)):h.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class Hi{constructor(l,h,p){this.type=l,this.index=h,this.input=p}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const p=h.parse(l[1],1,Ze),y=h.parse(l[2],2,ln(h.expectedType||pe));return p&&y?new Hi(y.type.itemType,p,y):null}evaluate(l){const h=this.index.evaluate(l),p=this.input.evaluate(l);if(h<0)throw new ei(`Array index out of bounds: ${h} < 0.`);if(h>=p.length)throw new ei(`Array index out of bounds: ${h} > ${p.length-1}.`);if(h!==Math.floor(h))throw new ei(`Array index must be an integer, but found ${h} instead.`);return p[h]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class Cu{constructor(l,h){this.type=Wt,this.needle=l,this.haystack=h}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const p=h.parse(l[1],1,pe),y=h.parse(l[2],2,pe);return p&&y?Rn(p.type,[Wt,Rt,Ze,xt,pe])?new Cu(p,y):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(p.type)} instead`):null}evaluate(l){const h=this.needle.evaluate(l),p=this.haystack.evaluate(l);if(!p)return!1;if(!jn(h,["boolean","string","number","null"]))throw new ei(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(Gn(h))} instead.`);if(!jn(p,["string","array"]))throw new ei(`Expected second argument to be of type array or string, but found ${Nt(Gn(p))} instead.`);return p.indexOf(h)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class md{constructor(l,h,p){this.type=Ze,this.needle=l,this.haystack=h,this.fromIndex=p}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const p=h.parse(l[1],1,pe),y=h.parse(l[2],2,pe);if(!p||!y)return null;if(!Rn(p.type,[Wt,Rt,Ze,xt,pe]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(p.type)} instead`);if(l.length===4){const S=h.parse(l[3],3,Ze);return S?new md(p,y,S):null}return new md(p,y)}evaluate(l){const h=this.needle.evaluate(l),p=this.haystack.evaluate(l);if(!jn(h,["boolean","string","number","null"]))throw new ei(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(Gn(h))} instead.`);let y;if(this.fromIndex&&(y=this.fromIndex.evaluate(l)),jn(p,["string"])){const S=p.indexOf(h,y);return S===-1?-1:[...p.slice(0,S)].length}if(jn(p,["array"]))return p.indexOf(h,y);throw new ei(`Expected second argument to be of type array or string, but found ${Nt(Gn(p))} instead.`)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class Eu{constructor(l,h,p,y,S,E){this.inputType=l,this.type=h,this.input=p,this.cases=y,this.outputs=S,this.otherwise=E}static parse(l,h){if(l.length<5)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return h.error("Expected an even number of arguments.");let p,y;h.expectedType&&h.expectedType.kind!=="value"&&(y=h.expectedType);const S={},E=[];for(let B=2;B<l.length-1;B+=2){let G=l[B];const X=l[B+1];Array.isArray(G)||(G=[G]);const ie=h.concat(B);if(G.length===0)return ie.error("Expected at least one branch label.");for(const ce of G){if(typeof ce!="number"&&typeof ce!="string")return ie.error("Branch labels must be numbers or strings.");if(typeof ce=="number"&&Math.abs(ce)>Number.MAX_SAFE_INTEGER)return ie.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ce=="number"&&Math.floor(ce)!==ce)return ie.error("Numeric branch labels must be integer values.");if(p){if(ie.checkSubtype(p,Gn(ce)))return null}else p=Gn(ce);if(S[String(ce)]!==void 0)return ie.error("Branch labels must be unique.");S[String(ce)]=E.length}const ae=h.parse(X,B,y);if(!ae)return null;y=y||ae.type,E.push(ae)}const R=h.parse(l[1],1,pe);if(!R)return null;const O=h.parse(l[l.length-1],l.length-1,y);return O?R.type.kind!=="value"&&h.concat(1).checkSubtype(p,R.type)?null:new Eu(p,y,R,S,E,O):null}evaluate(l){const h=this.input.evaluate(l);return(Gn(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}}class Si{constructor(l,h,p){this.type=l,this.branches=h,this.otherwise=p}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return h.error("Expected an odd number of arguments.");let p;h.expectedType&&h.expectedType.kind!=="value"&&(p=h.expectedType);const y=[];for(let E=1;E<l.length-1;E+=2){const R=h.parse(l[E],E,Wt);if(!R)return null;const O=h.parse(l[E+1],E+1,p);if(!O)return null;y.push([R,O]),p=p||O.type}const S=h.parse(l[l.length-1],l.length-1,p);if(!S)return null;if(!p)throw new Error("Can't infer output type");return new Si(p,y,S)}evaluate(l){for(const[h,p]of this.branches)if(h.evaluate(l))return p.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[h,p]of this.branches)l(h),l(p);l(this.otherwise)}outputDefined(){return this.branches.every(([l,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class gd{constructor(l,h,p,y){this.type=l,this.input=h,this.beginIndex=p,this.endIndex=y}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const p=h.parse(l[1],1,pe),y=h.parse(l[2],2,Ze);if(!p||!y)return null;if(!Rn(p.type,[ln(pe),Rt,pe]))return h.error(`Expected first argument to be of type array or string, but found ${Nt(p.type)} instead`);if(l.length===4){const S=h.parse(l[3],3,Ze);return S?new gd(p.type,p,y,S):null}return new gd(p.type,p,y)}evaluate(l){const h=this.input.evaluate(l),p=this.beginIndex.evaluate(l);let y;if(this.endIndex&&(y=this.endIndex.evaluate(l)),jn(h,["string"]))return[...h].slice(p,y).join("");if(jn(h,["array"]))return h.slice(p,y);throw new ei(`Expected first argument to be of type array or string, but found ${Nt(Gn(h))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function Tu(d,l){const h=d.length-1;let p,y,S=0,E=h,R=0;for(;S<=E;)if(R=Math.floor((S+E)/2),p=d[R],y=d[R+1],p<=l){if(R===h||l<y)return R;S=R+1}else{if(!(p>l))throw new ei("Input is not a number.");E=R-1}return 0}class Pu{constructor(l,h,p){this.type=l,this.input=h,this.labels=[],this.outputs=[];for(const[y,S]of p)this.labels.push(y),this.outputs.push(S)}static parse(l,h){if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");const p=h.parse(l[1],1,Ze);if(!p)return null;const y=[];let S=null;h.expectedType&&h.expectedType.kind!=="value"&&(S=h.expectedType);for(let E=1;E<l.length;E+=2){const R=E===1?-1/0:l[E],O=l[E+1],B=E,G=E+1;if(typeof R!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(y.length&&y[y.length-1][0]>=R)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',B);const X=h.parse(O,G,S);if(!X)return null;S=S||X.type,y.push([R,X])}return new Pu(S,p,y)}evaluate(l){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(l);const y=this.input.evaluate(l);if(y<=h[0])return p[0].evaluate(l);const S=h.length;return y>=h[S-1]?p[S-1].evaluate(l):p[Tu(h,y)].evaluate(l)}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function P2(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Bl,vd,rv=function(){if(vd)return Bl;function d(l,h,p,y){this.cx=3*l,this.bx=3*(p-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(y-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=p,this.p2y=y}return vd=1,Bl=d,d.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,h){if(h===void 0&&(h=1e-6),l<0)return 0;if(l>1)return 1;for(var p=l,y=0;y<8;y++){var S=this.sampleCurveX(p)-l;if(Math.abs(S)<h)return p;var E=this.sampleCurveDerivativeX(p);if(Math.abs(E)<1e-6)break;p-=S/E}var R=0,O=1;for(p=l,y=0;y<20&&(S=this.sampleCurveX(p),!(Math.abs(S-l)<h));y++)l>S?R=p:O=p,p=.5*(O-R)+R;return p},solve:function(l,h){return this.sampleCurveY(this.solveCurveX(l,h))}},Bl}(),A2=P2(rv);class Lo{constructor(l,h,p,y,S){this.type=l,this.operator=h,this.interpolation=p,this.input=y,this.labels=[],this.outputs=[];for(const[E,R]of S)this.labels.push(E),this.outputs.push(R)}static interpolationFactor(l,h,p,y){let S=0;if(l.name==="exponential")S=Au(h,l.base,p,y);else if(l.name==="linear")S=Au(h,1,p,y);else if(l.name==="cubic-bezier"){const E=l.controlPoints;S=new A2(E[0],E[1],E[2],E[3]).solve(Au(h,1,p,y))}return S}static parse(l,h){let[p,y,S,...E]=l;if(!Array.isArray(y)||y.length===0)return h.error("Expected an interpolation type expression.",1);if(y[0]==="linear")y={name:"linear"};else if(y[0]==="exponential"){const B=y[1];if(typeof B!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:B}}else{if(y[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const B=y.slice(1);if(B.length!==4||B.some(G=>typeof G!="number"||G<0||G>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:B}}}if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(S=h.parse(S,2,Ze),!S)return null;const R=[];let O=null;p!=="interpolate-hcl"&&p!=="interpolate-lab"||h.expectedType==at?h.expectedType&&h.expectedType.kind!=="value"&&(O=h.expectedType):O=pn;for(let B=0;B<E.length;B+=2){const G=E[B],X=E[B+1],ie=B+3,ae=B+4;if(typeof G!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ie);if(R.length&&R[R.length-1][0]>=G)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ie);const ce=h.parse(X,ae,O);if(!ce)return null;O=O||ce.type,R.push([G,ce])}return fr(O,Ze)||fr(O,ur)||fr(O,pn)||fr(O,ft)||fr(O,Kt)||fr(O,at)||fr(O,Qt)||fr(O,ln(Ze))?new Lo(O,p,y,S,R):h.error(`Type ${Nt(O)} is not interpolatable.`)}evaluate(l){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(l);const y=this.input.evaluate(l);if(y<=h[0])return p[0].evaluate(l);const S=h.length;if(y>=h[S-1])return p[S-1].evaluate(l);const E=Tu(h,y),R=Lo.interpolationFactor(this.interpolation,y,h[E],h[E+1]),O=p[E].evaluate(l),B=p[E+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Ts(O,B,R);case"color":return tr.interpolate(O,B,R);case"padding":return wi.interpolate(O,B,R);case"colorArray":return ji.interpolate(O,B,R);case"numberArray":return yo.interpolate(O,B,R);case"variableAnchorOffsetCollection":return ar.interpolate(O,B,R);case"array":return al(O,B,R);case"projectionDefinition":return Wn.interpolate(O,B,R)}case"interpolate-hcl":switch(this.type.kind){case"color":return tr.interpolate(O,B,R,"hcl");case"colorArray":return ji.interpolate(O,B,R,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return tr.interpolate(O,B,R,"lab");case"colorArray":return ji.interpolate(O,B,R,"lab")}}}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function Au(d,l,h,p){const y=p-h,S=d-h;return y===0?0:l===1?S/y:(Math.pow(l,S)-1)/(Math.pow(l,y)-1)}const hs={color:tr.interpolate,number:Ts,padding:wi.interpolate,numberArray:yo.interpolate,colorArray:ji.interpolate,variableAnchorOffsetCollection:ar.interpolate,array:al};class Ko{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let p=null;const y=h.expectedType;y&&y.kind!=="value"&&(p=y);const S=[];for(const R of l.slice(1)){const O=h.parse(R,1+S.length,p,void 0,{typeAnnotation:"omit"});if(!O)return null;p=p||O.type,S.push(O)}if(!p)throw new Error("No output type");const E=y&&S.some(R=>_n(y,R.type));return new Ko(E?pe:p,S)}evaluate(l){let h,p=null,y=0;for(const S of this.args)if(y++,p=S.evaluate(l),p&&p instanceof Zo&&!p.available&&(h||(h=p.name),p=null,y===this.args.length&&(p=h)),p!==null)break;return p}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}function iv(d,l){return d==="=="||d==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function yd(d,l,h,p){return p.compare(l,h)===0}function Iu(d,l,h){const p=d!=="=="&&d!=="!=";return class pj{constructor(S,E,R){this.type=Wt,this.lhs=S,this.rhs=E,this.collator=R,this.hasUntypedArgument=S.type.kind==="value"||E.type.kind==="value"}static parse(S,E){if(S.length!==3&&S.length!==4)return E.error("Expected two or three arguments.");const R=S[0];let O=E.parse(S[1],1,pe);if(!O)return null;if(!iv(R,O.type))return E.concat(1).error(`"${R}" comparisons are not supported for type '${Nt(O.type)}'.`);let B=E.parse(S[2],2,pe);if(!B)return null;if(!iv(R,B.type))return E.concat(2).error(`"${R}" comparisons are not supported for type '${Nt(B.type)}'.`);if(O.type.kind!==B.type.kind&&O.type.kind!=="value"&&B.type.kind!=="value")return E.error(`Cannot compare types '${Nt(O.type)}' and '${Nt(B.type)}'.`);p&&(O.type.kind==="value"&&B.type.kind!=="value"?O=new Yo(B.type,[O]):O.type.kind!=="value"&&B.type.kind==="value"&&(B=new Yo(O.type,[B])));let G=null;if(S.length===4){if(O.type.kind!=="string"&&B.type.kind!=="string"&&O.type.kind!=="value"&&B.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(G=E.parse(S[3],3,nt),!G)return null}return new pj(O,B,G)}evaluate(S){const E=this.lhs.evaluate(S),R=this.rhs.evaluate(S);if(p&&this.hasUntypedArgument){const O=Gn(E),B=Gn(R);if(O.kind!==B.kind||O.kind!=="string"&&O.kind!=="number")throw new ei(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${O.kind}, ${B.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const O=Gn(E),B=Gn(R);if(O.kind!=="string"||B.kind!=="string")return l(S,E,R)}return this.collator?h(S,E,R,this.collator.evaluate(S)):l(S,E,R)}eachChild(S){S(this.lhs),S(this.rhs),this.collator&&S(this.collator)}outputDefined(){return!0}}}const ov=Iu("==",function(d,l,h){return l===h},yd),I2=Iu("!=",function(d,l,h){return l!==h},function(d,l,h,p){return!yd(0,l,h,p)}),R2=Iu("<",function(d,l,h){return l<h},function(d,l,h,p){return p.compare(l,h)<0}),L2=Iu(">",function(d,l,h){return l>h},function(d,l,h,p){return p.compare(l,h)>0}),k2=Iu("<=",function(d,l,h){return l<=h},function(d,l,h,p){return p.compare(l,h)<=0}),Qf=Iu(">=",function(d,l,h){return l>=h},function(d,l,h,p){return p.compare(l,h)>=0});class ep{constructor(l,h,p){this.type=nt,this.locale=p,this.caseSensitive=l,this.diacriticSensitive=h}static parse(l,h){if(l.length!==2)return h.error("Expected one argument.");const p=l[1];if(typeof p!="object"||Array.isArray(p))return h.error("Collator options argument must be an object.");const y=h.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Wt);if(!y)return null;const S=h.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Wt);if(!S)return null;let E=null;return p.locale&&(E=h.parse(p.locale,1,Rt),!E)?null:new ep(y,S,E)}evaluate(l){return new dd(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class tp{constructor(l,h,p,y,S){this.type=Rt,this.number=l,this.locale=h,this.currency=p,this.minFractionDigits=y,this.maxFractionDigits=S}static parse(l,h){if(l.length!==3)return h.error("Expected two arguments.");const p=h.parse(l[1],1,Ze);if(!p)return null;const y=l[2];if(typeof y!="object"||Array.isArray(y))return h.error("NumberFormat options argument must be an object.");let S=null;if(y.locale&&(S=h.parse(y.locale,1,Rt),!S))return null;let E=null;if(y.currency&&(E=h.parse(y.currency,1,Rt),!E))return null;let R=null;if(y["min-fraction-digits"]&&(R=h.parse(y["min-fraction-digits"],1,Ze),!R))return null;let O=null;return y["max-fraction-digits"]&&(O=h.parse(y["max-fraction-digits"],1,Ze),!O)?null:new tp(p,S,E,R,O)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class _d{constructor(l){this.type=vt,this.sections=l}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const p=l[1];if(!Array.isArray(p)&&typeof p=="object")return h.error("First argument must be an image or text section.");const y=[];let S=!1;for(let E=1;E<=l.length-1;++E){const R=l[E];if(S&&typeof R=="object"&&!Array.isArray(R)){S=!1;let O=null;if(R["font-scale"]&&(O=h.parse(R["font-scale"],1,Ze),!O))return null;let B=null;if(R["text-font"]&&(B=h.parse(R["text-font"],1,ln(Rt)),!B))return null;let G=null;if(R["text-color"]&&(G=h.parse(R["text-color"],1,pn),!G))return null;let X=null;if(R["vertical-align"]){if(typeof R["vertical-align"]=="string"&&!Kf.includes(R["vertical-align"]))return h.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${R["vertical-align"]}' instead.`);if(X=h.parse(R["vertical-align"],1,Rt),!X)return null}const ie=y[y.length-1];ie.scale=O,ie.font=B,ie.textColor=G,ie.verticalAlign=X}else{const O=h.parse(l[E],1,pe);if(!O)return null;const B=O.type.kind;if(B!=="string"&&B!=="value"&&B!=="null"&&B!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");S=!0,y.push({content:O,scale:null,font:null,textColor:null,verticalAlign:null})}}return new _d(y)}evaluate(l){return new vo(this.sections.map(h=>{const p=h.content.evaluate(l);return Gn(p)===fn?new tv("",p,null,null,null,h.verticalAlign?h.verticalAlign.evaluate(l):null):new tv(Ac(p),null,h.scale?h.scale.evaluate(l):null,h.font?h.font.evaluate(l).join(","):null,h.textColor?h.textColor.evaluate(l):null,h.verticalAlign?h.verticalAlign.evaluate(l):null)}))}eachChild(l){for(const h of this.sections)l(h.content),h.scale&&l(h.scale),h.font&&l(h.font),h.textColor&&l(h.textColor),h.verticalAlign&&l(h.verticalAlign)}outputDefined(){return!1}}class sv{constructor(l){this.type=fn,this.input=l}static parse(l,h){if(l.length!==2)return h.error("Expected two arguments.");const p=h.parse(l[1],1,Rt);return p?new sv(p):h.error("No image name provided.")}evaluate(l){const h=this.input.evaluate(l),p=Zo.fromString(h);return p&&l.availableImages&&(p.available=l.availableImages.indexOf(h)>-1),p}eachChild(l){l(this.input)}outputDefined(){return!1}}class np{constructor(l){this.type=Ze,this.input=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const p=h.parse(l[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Nt(p.type)} instead.`):new np(p):null}evaluate(l){const h=this.input.evaluate(l);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new ei(`Expected value to be of type string or array, but found ${Nt(Gn(h))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const La=8192;function D2(d,l){const h=(180+d[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,y=Math.pow(2,l.z);return[Math.round(h*y*La),Math.round(p*y*La)]}function av(d,l){const h=Math.pow(2,l.z);return[(y=(d[0]/La+l.x)/h,360*y-180),(p=(d[1]/La+l.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,y}function xd(d,l){d[0]=Math.min(d[0],l[0]),d[1]=Math.min(d[1],l[1]),d[2]=Math.max(d[2],l[0]),d[3]=Math.max(d[3],l[1])}function bd(d,l){return!(d[0]<=l[0]||d[2]>=l[2]||d[1]<=l[1]||d[3]>=l[3])}function Mx(d,l,h){const p=d[0]-l[0],y=d[1]-l[1],S=d[0]-h[0],E=d[1]-h[1];return p*E-S*y==0&&p*S<=0&&y*E<=0}function wd(d,l,h,p){return(y=[p[0]-h[0],p[1]-h[1]])[0]*(S=[l[0]-d[0],l[1]-d[1]])[1]-y[1]*S[0]!=0&&!(!rp(d,l,h,p)||!rp(h,p,d,l));var y,S}function Cx(d,l,h){for(const p of h)for(let y=0;y<p.length-1;++y)if(wd(d,l,p[y],p[y+1]))return!0;return!1}function Ru(d,l,h=!1){let p=!1;for(const R of l)for(let O=0;O<R.length-1;O++){if(Mx(d,R[O],R[O+1]))return h;(S=R[O])[1]>(y=d)[1]!=(E=R[O+1])[1]>y[1]&&y[0]<(E[0]-S[0])*(y[1]-S[1])/(E[1]-S[1])+S[0]&&(p=!p)}var y,S,E;return p}function z2(d,l){for(const h of l)if(Ru(d,h))return!0;return!1}function Ex(d,l){for(const h of d)if(!Ru(h,l))return!1;for(let h=0;h<d.length-1;++h)if(Cx(d[h],d[h+1],l))return!1;return!0}function O2(d,l){for(const h of l)if(Ex(d,h))return!0;return!1}function rp(d,l,h,p){const y=p[0]-h[0],S=p[1]-h[1],E=(d[0]-h[0])*S-y*(d[1]-h[1]),R=(l[0]-h[0])*S-y*(l[1]-h[1]);return E>0&&R<0||E<0&&R>0}function lv(d,l,h){const p=[];for(let y=0;y<d.length;y++){const S=[];for(let E=0;E<d[y].length;E++){const R=D2(d[y][E],h);xd(l,R),S.push(R)}p.push(S)}return p}function Tx(d,l,h){const p=[];for(let y=0;y<d.length;y++){const S=lv(d[y],l,h);p.push(S)}return p}function Px(d,l,h,p){if(d[0]<h[0]||d[0]>h[2]){const y=.5*p;let S=d[0]-h[0]>y?-p:h[0]-d[0]>y?p:0;S===0&&(S=d[0]-h[2]>y?-p:h[2]-d[0]>y?p:0),d[0]+=S}xd(l,d)}function cv(d,l,h,p){const y=Math.pow(2,p.z)*La,S=[p.x*La,p.y*La],E=[];for(const R of d)for(const O of R){const B=[O.x+S[0],O.y+S[1]];Px(B,l,h,y),E.push(B)}return E}function uv(d,l,h,p){const y=Math.pow(2,p.z)*La,S=[p.x*La,p.y*La],E=[];for(const O of d){const B=[];for(const G of O){const X=[G.x+S[0],G.y+S[1]];xd(l,X),B.push(X)}E.push(B)}if(l[2]-l[0]<=y/2){(R=l)[0]=R[1]=1/0,R[2]=R[3]=-1/0;for(const O of E)for(const B of O)Px(B,l,h,y)}var R;return E}class Ic{constructor(l,h){this.type=Wt,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Pc(l[1])){const p=l[1];if(p.type==="FeatureCollection"){const y=[];for(const S of p.features){const{type:E,coordinates:R}=S.geometry;E==="Polygon"&&y.push(R),E==="MultiPolygon"&&y.push(...R)}if(y.length)return new Ic(p,{type:"MultiPolygon",coordinates:y})}else if(p.type==="Feature"){const y=p.geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Ic(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Ic(p,p)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(h,p){const y=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],E=h.canonicalID();if(p.type==="Polygon"){const R=lv(p.coordinates,S,E),O=cv(h.geometry(),y,S,E);if(!bd(y,S))return!1;for(const B of O)if(!Ru(B,R))return!1}if(p.type==="MultiPolygon"){const R=Tx(p.coordinates,S,E),O=cv(h.geometry(),y,S,E);if(!bd(y,S))return!1;for(const B of O)if(!z2(B,R))return!1}return!0}(l,this.geometries);if(l.geometryType()==="LineString")return function(h,p){const y=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],E=h.canonicalID();if(p.type==="Polygon"){const R=lv(p.coordinates,S,E),O=uv(h.geometry(),y,S,E);if(!bd(y,S))return!1;for(const B of O)if(!Ex(B,R))return!1}if(p.type==="MultiPolygon"){const R=Tx(p.coordinates,S,E),O=uv(h.geometry(),y,S,E);if(!bd(y,S))return!1;for(const B of O)if(!O2(B,R))return!1}return!0}(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ax=class{constructor(d=[],l=(h,p)=>h<p?-1:h>p?1:0){if(this.data=d,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(d){this.data.push(d),this._up(this.length++)}pop(){if(this.length===0)return;const d=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),d}peek(){return this.data[0]}_up(d){const{data:l,compare:h}=this,p=l[d];for(;d>0;){const y=d-1>>1,S=l[y];if(h(p,S)>=0)break;l[d]=S,d=y}l[d]=p}_down(d){const{data:l,compare:h}=this,p=this.length>>1,y=l[d];for(;d<p;){let S=1+(d<<1);const E=S+1;if(E<this.length&&h(l[E],l[S])<0&&(S=E),h(l[S],y)>=0)break;l[d]=l[S],d=S}l[d]=y}};function hv(d,l,h=0,p=d.length-1,y=F2){for(;p>h;){if(p-h>600){const O=p-h+1,B=l-h+1,G=Math.log(O),X=.5*Math.exp(2*G/3),ie=.5*Math.sqrt(G*X*(O-X)/O)*(B-O/2<0?-1:1);hv(d,l,Math.max(h,Math.floor(l-B*X/O+ie)),Math.min(p,Math.floor(l+(O-B)*X/O+ie)),y)}const S=d[l];let E=h,R=p;for(Lu(d,h,l),y(d[p],S)>0&&Lu(d,h,p);E<R;){for(Lu(d,E,R),E++,R--;y(d[E],S)<0;)E++;for(;y(d[R],S)>0;)R--}y(d[h],S)===0?Lu(d,h,R):(R++,Lu(d,R,p)),R<=l&&(h=R+1),l<=R&&(p=R-1)}}function Lu(d,l,h){const p=d[l];d[l]=d[h],d[h]=p}function F2(d,l){return d<l?-1:d>l?1:0}function ip(d,l){if(d.length<=1)return[d];const h=[];let p,y;for(const S of d){const E=Ix(S);E!==0&&(S.area=Math.abs(E),y===void 0&&(y=E<0),y===E<0?(p&&h.push(p),p=[S]):p.push(S))}if(p&&h.push(p),l>1)for(let S=0;S<h.length;S++)h[S].length<=l||(hv(h[S],l,1,h[S].length-1,N2),h[S]=h[S].slice(0,l));return h}function N2(d,l){return l.area-d.area}function Ix(d){let l=0;for(let h,p,y=0,S=d.length,E=S-1;y<S;E=y++)h=d[y],p=d[E],l+=(p.x-h.x)*(h.y+p.y);return l}const Rx=1/298.257223563,Lx=Rx*(2-Rx),kx=Math.PI/180;class dv{constructor(l){const h=6378.137*kx*1e3,p=Math.cos(l*kx),y=1/(1-Lx*(1-p*p)),S=Math.sqrt(y);this.kx=h*S*p,this.ky=h*S*y*(1-Lx)}distance(l,h){const p=this.wrap(l[0]-h[0])*this.kx,y=(l[1]-h[1])*this.ky;return Math.sqrt(p*p+y*y)}pointOnLine(l,h){let p,y,S,E,R=1/0;for(let O=0;O<l.length-1;O++){let B=l[O][0],G=l[O][1],X=this.wrap(l[O+1][0]-B)*this.kx,ie=(l[O+1][1]-G)*this.ky,ae=0;X===0&&ie===0||(ae=(this.wrap(h[0]-B)*this.kx*X+(h[1]-G)*this.ky*ie)/(X*X+ie*ie),ae>1?(B=l[O+1][0],G=l[O+1][1]):ae>0&&(B+=X/this.kx*ae,G+=ie/this.ky*ae)),X=this.wrap(h[0]-B)*this.kx,ie=(h[1]-G)*this.ky;const ce=X*X+ie*ie;ce<R&&(R=ce,p=B,y=G,S=O,E=ae)}return{point:[p,y],index:S,t:Math.max(0,Math.min(1,E))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}function Mr(d,l){return l[0]-d[0]}function op(d){return d[1]-d[0]+1}function ll(d,l){return d[1]>=d[0]&&d[1]<l}function fv(d,l){if(d[0]>d[1])return[null,null];const h=op(d);if(l){if(h===2)return[d,null];const y=Math.floor(h/2);return[[d[0],d[0]+y],[d[0]+y,d[1]]]}if(h===1)return[d,null];const p=Math.floor(h/2)-1;return[[d[0],d[0]+p],[d[0]+p+1,d[1]]]}function pv(d,l){if(!ll(l,d.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let p=l[0];p<=l[1];++p)xd(h,d[p]);return h}function mv(d){const l=[1/0,1/0,-1/0,-1/0];for(const h of d)for(const p of h)xd(l,p);return l}function Dx(d){return d[0]!==-1/0&&d[1]!==-1/0&&d[2]!==1/0&&d[3]!==1/0}function gv(d,l,h){if(!Dx(d)||!Dx(l))return NaN;let p=0,y=0;return d[2]<l[0]&&(p=l[0]-d[2]),d[0]>l[2]&&(p=d[0]-l[2]),d[1]>l[3]&&(y=d[1]-l[3]),d[3]<l[1]&&(y=l[1]-d[3]),h.distance([0,0],[p,y])}function Rc(d,l,h){const p=h.pointOnLine(l,d);return h.distance(d,p.point)}function vv(d,l,h,p,y){const S=Math.min(Rc(d,[h,p],y),Rc(l,[h,p],y)),E=Math.min(Rc(h,[d,l],y),Rc(p,[d,l],y));return Math.min(S,E)}function B2(d,l,h,p,y){if(!ll(l,d.length)||!ll(p,h.length))return 1/0;let S=1/0;for(let E=l[0];E<l[1];++E){const R=d[E],O=d[E+1];for(let B=p[0];B<p[1];++B){const G=h[B],X=h[B+1];if(wd(R,O,G,X))return 0;S=Math.min(S,vv(R,O,G,X,y))}}return S}function U2(d,l,h,p,y){if(!ll(l,d.length)||!ll(p,h.length))return NaN;let S=1/0;for(let E=l[0];E<=l[1];++E)for(let R=p[0];R<=p[1];++R)if(S=Math.min(S,y.distance(d[E],h[R])),S===0)return S;return S}function $2(d,l,h){if(Ru(d,l,!0))return 0;let p=1/0;for(const y of l){const S=y[0],E=y[y.length-1];if(S!==E&&(p=Math.min(p,Rc(d,[E,S],h)),p===0))return p;const R=h.pointOnLine(y,d);if(p=Math.min(p,h.distance(d,R.point)),p===0)return p}return p}function V2(d,l,h,p){if(!ll(l,d.length))return NaN;for(let S=l[0];S<=l[1];++S)if(Ru(d[S],h,!0))return 0;let y=1/0;for(let S=l[0];S<l[1];++S){const E=d[S],R=d[S+1];for(const O of h)for(let B=0,G=O.length,X=G-1;B<G;X=B++){const ie=O[X],ae=O[B];if(wd(E,R,ie,ae))return 0;y=Math.min(y,vv(E,R,ie,ae,p))}}return y}function zx(d,l){for(const h of d)for(const p of h)if(Ru(p,l,!0))return!0;return!1}function j2(d,l,h,p=1/0){const y=mv(d),S=mv(l);if(p!==1/0&&gv(y,S,h)>=p)return p;if(bd(y,S)){if(zx(d,l))return 0}else if(zx(l,d))return 0;let E=1/0;for(const R of d)for(let O=0,B=R.length,G=B-1;O<B;G=O++){const X=R[G],ie=R[O];for(const ae of l)for(let ce=0,de=ae.length,Ce=de-1;ce<de;Ce=ce++){const ke=ae[Ce],et=ae[ce];if(wd(X,ie,ke,et))return 0;E=Math.min(E,vv(X,ie,ke,et,h))}}return E}function Ox(d,l,h,p,y,S){if(!S)return;const E=gv(pv(p,S),y,h);E<l&&d.push([E,S,[0,0]])}function sp(d,l,h,p,y,S,E){if(!S||!E)return;const R=gv(pv(p,S),pv(y,E),h);R<l&&d.push([R,S,E])}function ap(d,l,h,p,y=1/0){let S=Math.min(p.distance(d[0],h[0][0]),y);if(S===0)return S;const E=new Ax([[0,[0,d.length-1],[0,0]]],Mr),R=mv(h);for(;E.length>0;){const O=E.pop();if(O[0]>=S)continue;const B=O[1],G=l?50:100;if(op(B)<=G){if(!ll(B,d.length))return NaN;if(l){const X=V2(d,B,h,p);if(isNaN(X)||X===0)return X;S=Math.min(S,X)}else for(let X=B[0];X<=B[1];++X){const ie=$2(d[X],h,p);if(S=Math.min(S,ie),S===0)return 0}}else{const X=fv(B,l);Ox(E,S,p,d,R,X[0]),Ox(E,S,p,d,R,X[1])}}return S}function lp(d,l,h,p,y,S=1/0){let E=Math.min(S,y.distance(d[0],h[0]));if(E===0)return E;const R=new Ax([[0,[0,d.length-1],[0,h.length-1]]],Mr);for(;R.length>0;){const O=R.pop();if(O[0]>=E)continue;const B=O[1],G=O[2],X=l?50:100,ie=p?50:100;if(op(B)<=X&&op(G)<=ie){if(!ll(B,d.length)&&ll(G,h.length))return NaN;let ae;if(l&&p)ae=B2(d,B,h,G,y),E=Math.min(E,ae);else if(l&&!p){const ce=d.slice(B[0],B[1]+1);for(let de=G[0];de<=G[1];++de)if(ae=Rc(h[de],ce,y),E=Math.min(E,ae),E===0)return E}else if(!l&&p){const ce=h.slice(G[0],G[1]+1);for(let de=B[0];de<=B[1];++de)if(ae=Rc(d[de],ce,y),E=Math.min(E,ae),E===0)return E}else ae=U2(d,B,h,G,y),E=Math.min(E,ae)}else{const ae=fv(B,l),ce=fv(G,p);sp(R,E,y,d,h,ae[0],ce[0]),sp(R,E,y,d,h,ae[0],ce[1]),sp(R,E,y,d,h,ae[1],ce[0]),sp(R,E,y,d,h,ae[1],ce[1])}}return E}function yv(d){return d.type==="MultiPolygon"?d.coordinates.map(l=>({type:"Polygon",coordinates:l})):d.type==="MultiLineString"?d.coordinates.map(l=>({type:"LineString",coordinates:l})):d.type==="MultiPoint"?d.coordinates.map(l=>({type:"Point",coordinates:l})):[d]}class Lc{constructor(l,h){this.type=Ze,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Pc(l[1])){const p=l[1];if(p.type==="FeatureCollection")return new Lc(p,p.features.map(y=>yv(y.geometry)).flat());if(p.type==="Feature")return new Lc(p,yv(p.geometry));if("type"in p&&"coordinates"in p)return new Lc(p,yv(p))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(h,p){const y=h.geometry(),S=y.flat().map(O=>av([O.x,O.y],h.canonical));if(y.length===0)return NaN;const E=new dv(S[0][1]);let R=1/0;for(const O of p){switch(O.type){case"Point":R=Math.min(R,lp(S,!1,[O.coordinates],!1,E,R));break;case"LineString":R=Math.min(R,lp(S,!1,O.coordinates,!0,E,R));break;case"Polygon":R=Math.min(R,ap(S,!1,O.coordinates,E,R))}if(R===0)return R}return R}(l,this.geometries);if(l.geometryType()==="LineString")return function(h,p){const y=h.geometry(),S=y.flat().map(O=>av([O.x,O.y],h.canonical));if(y.length===0)return NaN;const E=new dv(S[0][1]);let R=1/0;for(const O of p){switch(O.type){case"Point":R=Math.min(R,lp(S,!0,[O.coordinates],!1,E,R));break;case"LineString":R=Math.min(R,lp(S,!0,O.coordinates,!0,E,R));break;case"Polygon":R=Math.min(R,ap(S,!0,O.coordinates,E,R))}if(R===0)return R}return R}(l,this.geometries);if(l.geometryType()==="Polygon")return function(h,p){const y=h.geometry();if(y.length===0||y[0].length===0)return NaN;const S=ip(y,0).map(O=>O.map(B=>B.map(G=>av([G.x,G.y],h.canonical)))),E=new dv(S[0][0][0][1]);let R=1/0;for(const O of p)for(const B of S){switch(O.type){case"Point":R=Math.min(R,ap([O.coordinates],!1,B,E,R));break;case"LineString":R=Math.min(R,ap(O.coordinates,!0,B,E,R));break;case"Polygon":R=Math.min(R,j2(B,O.coordinates,E,R))}if(R===0)return R}return R}(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Sd{constructor(l){this.type=pe,this.key=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const p=l[1];return p==null?h.error("Global state property must be defined."):typeof p!="string"?h.error(`Global state property must be string, but found ${typeof l[1]} instead.`):new Sd(p)}evaluate(l){var h;const p=(h=l.globals)===null||h===void 0?void 0:h.globalState;return p&&Object.keys(p).length!==0?er(p,this.key):null}eachChild(){}outputDefined(){return!1}}const ku={"==":ov,"!=":I2,">":L2,"<":R2,">=":Qf,"<=":k2,array:Yo,at:Hi,boolean:Yo,case:Si,coalesce:Ko,collator:ep,format:_d,image:sv,in:Cu,"index-of":md,interpolate:Lo,"interpolate-hcl":Lo,"interpolate-lab":Lo,length:np,let:pd,literal:Ro,match:Eu,number:Yo,"number-format":tp,object:Yo,slice:gd,step:Pu,string:Yo,"to-boolean":Ra,"to-color":Ra,"to-number":Ra,"to-string":Ra,var:Ks,within:Ic,distance:Lc,"global-state":Sd};class Ps{constructor(l,h,p,y){this.name=l,this.type=h,this._evaluate=p,this.args=y}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,h){const p=l[0],y=Ps.definitions[p];if(!y)return h.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const S=Array.isArray(y)?y[0]:y.type,E=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,R=E.filter(([B])=>!Array.isArray(B)||B.length===l.length-1);let O=null;for(const[B,G]of R){O=new fd(h.registry,cp,h.path,null,h.scope);const X=[];let ie=!1;for(let ae=1;ae<l.length;ae++){const ce=l[ae],de=Array.isArray(B)?B[ae-1]:B.type,Ce=O.parse(ce,1+X.length,de);if(!Ce){ie=!0;break}X.push(Ce)}if(!ie)if(Array.isArray(B)&&B.length!==X.length)O.error(`Expected ${B.length} arguments, but found ${X.length} instead.`);else{for(let ae=0;ae<X.length;ae++){const ce=Array.isArray(B)?B[ae]:B.type,de=X[ae];O.concat(ae+1).checkSubtype(ce,de.type)}if(O.errors.length===0)return new Ps(p,S,G,X)}}if(R.length===1)h.errors.push(...O.errors);else{const B=(R.length?R:E).map(([X])=>{return ie=X,Array.isArray(ie)?`(${ie.map(Nt).join(", ")})`:`(${Nt(ie.type)}...)`;var ie}).join(" | "),G=[];for(let X=1;X<l.length;X++){const ie=h.parse(l[X],1+G.length);if(!ie)return null;G.push(Nt(ie.type))}h.error(`Expected arguments of type ${B}, but found (${G.join(", ")}) instead.`)}return null}static register(l,h){Ps.definitions=h;for(const p in h)l[p]=Ps}}function Fx(d,[l,h,p,y]){l=l.evaluate(d),h=h.evaluate(d),p=p.evaluate(d);const S=y?y.evaluate(d):1,E=Kn(l,h,p,S);if(E)throw new ei(E);return new tr(l/255,h/255,p/255,S,!1)}function Nx(d,l){return d in l}function _v(d,l){const h=l[d];return h===void 0?null:h}function kc(d){return{type:d}}function cp(d){if(d instanceof Ks)return cp(d.boundExpression);if(d instanceof Ps&&d.name==="error"||d instanceof ep||d instanceof Ic||d instanceof Lc||d instanceof Sd)return!1;const l=d instanceof Ra||d instanceof Yo;let h=!0;return d.eachChild(p=>{h=l?h&&cp(p):h&&p instanceof Ro}),!!h&&up(d)&&Du(d,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function up(d){if(d instanceof Ps&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Ic||d instanceof Lc)return!1;let l=!0;return d.eachChild(h=>{l&&!up(h)&&(l=!1)}),l}function Md(d){if(d instanceof Ps&&d.name==="feature-state")return!1;let l=!0;return d.eachChild(h=>{l&&!Md(h)&&(l=!1)}),l}function Du(d,l){if(d instanceof Ps&&l.indexOf(d.name)>=0)return!1;let h=!0;return d.eachChild(p=>{h&&!Du(p,l)&&(h=!1)}),h}function Bx(d){return{result:"success",value:d}}function zu(d){return{result:"error",value:d}}function Ou(d){return d["property-type"]==="data-driven"||d["property-type"]==="cross-faded-data-driven"}function xv(d){return!!d.expression&&d.expression.parameters.indexOf("zoom")>-1}function bv(d){return!!d.expression&&d.expression.interpolated}function nr(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}function Dc(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)&&Gn(d)===Xn}function Ux(d){return d}function $x(d,l){const h=d.stops&&typeof d.stops[0][0]=="object",p=h||!(h||d.property!==void 0),y=d.type||(bv(l)?"exponential":"interval"),S=function(G){switch(G.type){case"color":return tr.parse;case"padding":return wi.parse;case"numberArray":return yo.parse;case"colorArray":return ji.parse;default:return null}}(l);if(S&&((d=In({},d)).stops&&(d.stops=d.stops.map(G=>[G[0],S(G[1])])),d.default=S(d.default?d.default:l.default)),d.colorSpace&&(E=d.colorSpace)!=="rgb"&&E!=="hcl"&&E!=="lab")throw new Error(`Unknown color space: "${d.colorSpace}"`);var E;const R=function(G){switch(G){case"exponential":return Vx;case"interval":return G2;case"categorical":return H2;case"identity":return jx;default:throw new Error(`Unknown function type "${G}"`)}}(y);let O,B;if(y==="categorical"){O=Object.create(null);for(const G of d.stops)O[G[0]]=G[1];B=typeof d.stops[0][0]}if(h){const G={},X=[];for(let ce=0;ce<d.stops.length;ce++){const de=d.stops[ce],Ce=de[0].zoom;G[Ce]===void 0&&(G[Ce]={zoom:Ce,type:d.type,property:d.property,default:d.default,stops:[]},X.push(Ce)),G[Ce].stops.push([de[0].value,de[1]])}const ie=[];for(const ce of X)ie.push([G[ce].zoom,$x(G[ce],l)]);const ae={name:"linear"};return{kind:"composite",interpolationType:ae,interpolationFactor:Lo.interpolationFactor.bind(void 0,ae),zoomStops:ie.map(ce=>ce[0]),evaluate:({zoom:ce},de)=>Vx({stops:ie,base:d.base},l,ce).evaluate(ce,de)}}if(p){const G=y==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:G,interpolationFactor:Lo.interpolationFactor.bind(void 0,G),zoomStops:d.stops.map(X=>X[0]),evaluate:({zoom:X})=>R(d,l,X,O,B)}}return{kind:"source",evaluate(G,X){const ie=X&&X.properties?X.properties[d.property]:void 0;return ie===void 0?Cd(d.default,l.default):R(d,l,ie,O,B)}}}function Cd(d,l,h){return d!==void 0?d:l!==void 0?l:h!==void 0?h:void 0}function H2(d,l,h,p,y){return Cd(typeof h===y?p[h]:void 0,d.default,l.default)}function G2(d,l,h){if(nr(h)!=="number")return Cd(d.default,l.default);const p=d.stops.length;if(p===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[p-1][0])return d.stops[p-1][1];const y=Tu(d.stops.map(S=>S[0]),h);return d.stops[y][1]}function Vx(d,l,h){const p=d.base!==void 0?d.base:1;if(nr(h)!=="number")return Cd(d.default,l.default);const y=d.stops.length;if(y===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[y-1][0])return d.stops[y-1][1];const S=Tu(d.stops.map(G=>G[0]),h),E=function(G,X,ie,ae){const ce=ae-ie,de=G-ie;return ce===0?0:X===1?de/ce:(Math.pow(X,de)-1)/(Math.pow(X,ce)-1)}(h,p,d.stops[S][0],d.stops[S+1][0]),R=d.stops[S][1],O=d.stops[S+1][1],B=hs[l.type]||Ux;return typeof R.evaluate=="function"?{evaluate(...G){const X=R.evaluate.apply(void 0,G),ie=O.evaluate.apply(void 0,G);if(X!==void 0&&ie!==void 0)return B(X,ie,E,d.colorSpace)}}:B(R,O,E,d.colorSpace)}function jx(d,l,h){switch(l.type){case"color":h=tr.parse(h);break;case"formatted":h=vo.fromString(h.toString());break;case"resolvedImage":h=Zo.fromString(h.toString());break;case"padding":h=wi.parse(h);break;case"colorArray":h=ji.parse(h);break;case"numberArray":h=yo.parse(h);break;default:nr(h)===l.type||l.type==="enum"&&l.values[h]||(h=void 0)}return Cd(h,d.default,l.default)}Ps.register(ku,{error:[{kind:"error"},[Rt],(d,[l])=>{throw new ei(l.evaluate(d))}],typeof:[Rt,[pe],(d,[l])=>Nt(Gn(l.evaluate(d)))],"to-rgba":[ln(Ze,4),[pn],(d,[l])=>{const[h,p,y,S]=l.evaluate(d).rgb;return[255*h,255*p,255*y,S]}],rgb:[pn,[Ze,Ze,Ze],Fx],rgba:[pn,[Ze,Ze,Ze,Ze],Fx],has:{type:Wt,overloads:[[[Rt],(d,[l])=>Nx(l.evaluate(d),d.properties())],[[Rt,Xn],(d,[l,h])=>Nx(l.evaluate(d),h.evaluate(d))]]},get:{type:pe,overloads:[[[Rt],(d,[l])=>_v(l.evaluate(d),d.properties())],[[Rt,Xn],(d,[l,h])=>_v(l.evaluate(d),h.evaluate(d))]]},"feature-state":[pe,[Rt],(d,[l])=>_v(l.evaluate(d),d.featureState||{})],properties:[Xn,[],d=>d.properties()],"geometry-type":[Rt,[],d=>d.geometryType()],id:[pe,[],d=>d.id()],zoom:[Ze,[],d=>d.globals.zoom],"heatmap-density":[Ze,[],d=>d.globals.heatmapDensity||0],elevation:[Ze,[],d=>d.globals.elevation||0],"line-progress":[Ze,[],d=>d.globals.lineProgress||0],accumulated:[pe,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[Ze,kc(Ze),(d,l)=>{let h=0;for(const p of l)h+=p.evaluate(d);return h}],"*":[Ze,kc(Ze),(d,l)=>{let h=1;for(const p of l)h*=p.evaluate(d);return h}],"-":{type:Ze,overloads:[[[Ze,Ze],(d,[l,h])=>l.evaluate(d)-h.evaluate(d)],[[Ze],(d,[l])=>-l.evaluate(d)]]},"/":[Ze,[Ze,Ze],(d,[l,h])=>l.evaluate(d)/h.evaluate(d)],"%":[Ze,[Ze,Ze],(d,[l,h])=>l.evaluate(d)%h.evaluate(d)],ln2:[Ze,[],()=>Math.LN2],pi:[Ze,[],()=>Math.PI],e:[Ze,[],()=>Math.E],"^":[Ze,[Ze,Ze],(d,[l,h])=>Math.pow(l.evaluate(d),h.evaluate(d))],sqrt:[Ze,[Ze],(d,[l])=>Math.sqrt(l.evaluate(d))],log10:[Ze,[Ze],(d,[l])=>Math.log(l.evaluate(d))/Math.LN10],ln:[Ze,[Ze],(d,[l])=>Math.log(l.evaluate(d))],log2:[Ze,[Ze],(d,[l])=>Math.log(l.evaluate(d))/Math.LN2],sin:[Ze,[Ze],(d,[l])=>Math.sin(l.evaluate(d))],cos:[Ze,[Ze],(d,[l])=>Math.cos(l.evaluate(d))],tan:[Ze,[Ze],(d,[l])=>Math.tan(l.evaluate(d))],asin:[Ze,[Ze],(d,[l])=>Math.asin(l.evaluate(d))],acos:[Ze,[Ze],(d,[l])=>Math.acos(l.evaluate(d))],atan:[Ze,[Ze],(d,[l])=>Math.atan(l.evaluate(d))],min:[Ze,kc(Ze),(d,l)=>Math.min(...l.map(h=>h.evaluate(d)))],max:[Ze,kc(Ze),(d,l)=>Math.max(...l.map(h=>h.evaluate(d)))],abs:[Ze,[Ze],(d,[l])=>Math.abs(l.evaluate(d))],round:[Ze,[Ze],(d,[l])=>{const h=l.evaluate(d);return h<0?-Math.round(-h):Math.round(h)}],floor:[Ze,[Ze],(d,[l])=>Math.floor(l.evaluate(d))],ceil:[Ze,[Ze],(d,[l])=>Math.ceil(l.evaluate(d))],"filter-==":[Wt,[Rt,pe],(d,[l,h])=>d.properties()[l.value]===h.value],"filter-id-==":[Wt,[pe],(d,[l])=>d.id()===l.value],"filter-type-==":[Wt,[Rt],(d,[l])=>d.geometryType()===l.value],"filter-<":[Wt,[Rt,pe],(d,[l,h])=>{const p=d.properties()[l.value],y=h.value;return typeof p==typeof y&&p<y}],"filter-id-<":[Wt,[pe],(d,[l])=>{const h=d.id(),p=l.value;return typeof h==typeof p&&h<p}],"filter->":[Wt,[Rt,pe],(d,[l,h])=>{const p=d.properties()[l.value],y=h.value;return typeof p==typeof y&&p>y}],"filter-id->":[Wt,[pe],(d,[l])=>{const h=d.id(),p=l.value;return typeof h==typeof p&&h>p}],"filter-<=":[Wt,[Rt,pe],(d,[l,h])=>{const p=d.properties()[l.value],y=h.value;return typeof p==typeof y&&p<=y}],"filter-id-<=":[Wt,[pe],(d,[l])=>{const h=d.id(),p=l.value;return typeof h==typeof p&&h<=p}],"filter->=":[Wt,[Rt,pe],(d,[l,h])=>{const p=d.properties()[l.value],y=h.value;return typeof p==typeof y&&p>=y}],"filter-id->=":[Wt,[pe],(d,[l])=>{const h=d.id(),p=l.value;return typeof h==typeof p&&h>=p}],"filter-has":[Wt,[pe],(d,[l])=>l.value in d.properties()],"filter-has-id":[Wt,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[Wt,[ln(Rt)],(d,[l])=>l.value.indexOf(d.geometryType())>=0],"filter-id-in":[Wt,[ln(pe)],(d,[l])=>l.value.indexOf(d.id())>=0],"filter-in-small":[Wt,[Rt,ln(pe)],(d,[l,h])=>h.value.indexOf(d.properties()[l.value])>=0],"filter-in-large":[Wt,[Rt,ln(pe)],(d,[l,h])=>function(p,y,S,E){for(;S<=E;){const R=S+E>>1;if(y[R]===p)return!0;y[R]>p?E=R-1:S=R+1}return!1}(d.properties()[l.value],h.value,0,h.value.length-1)],all:{type:Wt,overloads:[[[Wt,Wt],(d,[l,h])=>l.evaluate(d)&&h.evaluate(d)],[kc(Wt),(d,l)=>{for(const h of l)if(!h.evaluate(d))return!1;return!0}]]},any:{type:Wt,overloads:[[[Wt,Wt],(d,[l,h])=>l.evaluate(d)||h.evaluate(d)],[kc(Wt),(d,l)=>{for(const h of l)if(h.evaluate(d))return!0;return!1}]]},"!":[Wt,[Wt],(d,[l])=>!l.evaluate(d)],"is-supported-script":[Wt,[Rt],(d,[l])=>{const h=d.globals&&d.globals.isSupportedScript;return!h||h(l.evaluate(d))}],upcase:[Rt,[Rt],(d,[l])=>l.evaluate(d).toUpperCase()],downcase:[Rt,[Rt],(d,[l])=>l.evaluate(d).toLowerCase()],concat:[Rt,kc(pe),(d,l)=>l.map(h=>Ac(h.evaluate(d))).join("")],"resolved-locale":[Rt,[nt],(d,[l])=>l.evaluate(d).resolvedLocale()]});class hp{constructor(l,h){this.expression=l,this._warningHistory={},this._evaluator=new Sx,this._defaultValue=h?function(p){if(p.type==="color"&&Dc(p.default))return new tr(0,0,0,0);switch(p.type){case"color":return tr.parse(p.default)||null;case"padding":return wi.parse(p.default)||null;case"numberArray":return yo.parse(p.default)||null;case"colorArray":return ji.parse(p.default)||null;case"variableAnchorOffsetCollection":return ar.parse(p.default)||null;case"projectionDefinition":return Wn.parse(p.default)||null;default:return p.default===void 0?null:p.default}}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(l,h,p,y,S,E){return this._evaluator.globals=l,this._evaluator.feature=h,this._evaluator.featureState=p,this._evaluator.canonical=y,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(l,h,p,y,S,E){this._evaluator.globals=l,this._evaluator.feature=h||null,this._evaluator.featureState=p||null,this._evaluator.canonical=y,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=E||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new ei(`Expected value to be one of ${Object.keys(this._enumValues).map(O=>JSON.stringify(O)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(R.message)),this._defaultValue}}}function dp(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in ku}function fp(d,l){const h=new fd(ku,cp,[],l?function(y){const S={color:pn,string:Rt,number:Ze,enum:Rt,boolean:Wt,formatted:vt,padding:ft,numberArray:Kt,colorArray:at,projectionDefinition:ur,resolvedImage:fn,variableAnchorOffsetCollection:Qt};return y.type==="array"?ln(S[y.value]||pe,y.length):S[y.type]}(l):void 0),p=h.parse(d,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Bx(new hp(p,l)):zu(h.errors)}class Ed{constructor(l,h){this.kind=l,this._styleExpression=h,this.isStateDependent=l!=="constant"&&!Md(h.expression),this.globalStateRefs=Nu(h.expression)}evaluateWithoutErrorHandling(l,h,p,y,S,E){return this._styleExpression.evaluateWithoutErrorHandling(l,h,p,y,S,E)}evaluate(l,h,p,y,S,E){return this._styleExpression.evaluate(l,h,p,y,S,E)}}class pp{constructor(l,h,p,y){this.kind=l,this.zoomStops=p,this._styleExpression=h,this.isStateDependent=l!=="camera"&&!Md(h.expression),this.globalStateRefs=Nu(h.expression),this.interpolationType=y}evaluateWithoutErrorHandling(l,h,p,y,S,E){return this._styleExpression.evaluateWithoutErrorHandling(l,h,p,y,S,E)}evaluate(l,h,p,y,S,E){return this._styleExpression.evaluate(l,h,p,y,S,E)}interpolationFactor(l,h,p){return this.interpolationType?Lo.interpolationFactor(this.interpolationType,l,h,p):0}}function wv(d,l){const h=fp(d,l);if(h.result==="error")return h;const p=h.value.expression,y=up(p);if(!y&&!Ou(l))return zu([new cn("","data expressions not supported")]);const S=Du(p,["zoom"]);if(!S&&!xv(l))return zu([new cn("","zoom expressions not supported")]);const E=Fu(p);return E||S?E instanceof cn?zu([E]):E instanceof Lo&&!bv(l)?zu([new cn("",'"interpolate" expressions cannot be used with this property')]):Bx(E?new pp(y?"camera":"composite",h.value,E.labels,E instanceof Lo?E.interpolation:void 0):new Ed(y?"constant":"source",h.value)):zu([new cn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Td{constructor(l,h){this._parameters=l,this._specification=h,In(this,$x(this._parameters,this._specification))}static deserialize(l){return new Td(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function Fu(d){let l=null;if(d instanceof pd)l=Fu(d.result);else if(d instanceof Ko){for(const h of d.args)if(l=Fu(h),l)break}else(d instanceof Pu||d instanceof Lo)&&d.input instanceof Ps&&d.input.name==="zoom"&&(l=d);return l instanceof cn||d.eachChild(h=>{const p=Fu(h);p instanceof cn?l=p:!l&&p?l=new cn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&p&&l!==p&&(l=new cn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}function Nu(d,l=new Set){return d instanceof Sd&&l.add(d.key),d.eachChild(h=>{Nu(h,l)}),l}function Pd(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const l of d.slice(1))if(!Pd(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}const Sv={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ul(d){if(d==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Pd(d)||(d=mp(d));const l=fp(d,Sv);if(l.result==="error")throw new Error(l.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,p,y)=>l.value.evaluate(h,p,{},y),needGeometry:Hx(d),getGlobalStateRefs:()=>Nu(l.value.expression)}}function W2(d,l){return d<l?-1:d>l?1:0}function Hx(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let l=1;l<d.length;l++)if(Hx(d[l]))return!0;return!1}function mp(d){if(!d)return!0;const l=d[0];return d.length<=1?l!=="any":l==="=="?Mv(d[1],d[2],"=="):l==="!="?Ad(Mv(d[1],d[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Mv(d[1],d[2],l):l==="any"?(h=d.slice(1),["any"].concat(h.map(mp))):l==="all"?["all"].concat(d.slice(1).map(mp)):l==="none"?["all"].concat(d.slice(1).map(mp).map(Ad)):l==="in"?Gx(d[1],d.slice(2)):l==="!in"?Ad(Gx(d[1],d.slice(2))):l==="has"?Wx(d[1]):l!=="!has"||Ad(Wx(d[1]));var h}function Mv(d,l,h){switch(d){case"$type":return[`filter-type-${h}`,l];case"$id":return[`filter-id-${h}`,l];default:return[`filter-${h}`,d,l]}}function Gx(d,l){if(l.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(h=>typeof h!=typeof l[0])?["filter-in-large",d,["literal",l.sort(W2)]]:["filter-in-small",d,["literal",l]]}}function Wx(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function Ad(d){return["!",d]}function gp(d){const l=typeof d;if(l==="number"||l==="boolean"||l==="string"||d==null)return JSON.stringify(d);if(Array.isArray(d)){let y="[";for(const S of d)y+=`${gp(S)},`;return`${y}]`}const h=Object.keys(d).sort();let p="{";for(let y=0;y<h.length;y++)p+=`${JSON.stringify(h[y])}:${gp(d[h[y]])},`;return`${p}}`}function vp(d){let l="";for(const h of Et)l+=`/${gp(d[h])}`;return l}function qx(d){const l=d.value;return l?[new gt(d.key,l,"constants have been deprecated as of v8")]:[]}function ai(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function $l(d){if(Array.isArray(d))return d.map($l);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const l={};for(const h in d)l[h]=$l(d[h]);return l}return ai(d)}function As(d){const l=d.key,h=d.value,p=d.valueSpec||{},y=d.objectElementValidators||{},S=d.style,E=d.styleSpec,R=d.validateSpec;let O=[];const B=nr(h);if(B!=="object")return[new gt(l,h,`object expected, ${B} found`)];for(const G in h){const X=G.split(".")[0],ie=er(p,X)||p["*"];let ae;if(er(y,X))ae=y[X];else if(er(p,X))ae=R;else if(y["*"])ae=y["*"];else{if(!p["*"]){O.push(new gt(l,h[G],`unknown property "${G}"`));continue}ae=R}O=O.concat(ae({key:(l&&`${l}.`)+G,value:h[G],valueSpec:ie,style:S,styleSpec:E,object:h,objectKey:G,validateSpec:R},h))}for(const G in p)y[G]||p[G].required&&p[G].default===void 0&&h[G]===void 0&&O.push(new gt(l,h,`missing required property "${G}"`));return O}function yp(d){const l=d.value,h=d.valueSpec,p=d.style,y=d.styleSpec,S=d.key,E=d.arrayElementValidator||d.validateSpec;if(nr(l)!=="array")return[new gt(S,l,`array expected, ${nr(l)} found`)];if(h.length&&l.length!==h.length)return[new gt(S,l,`array length ${h.length} expected, length ${l.length} found`)];if(h["min-length"]&&l.length<h["min-length"])return[new gt(S,l,`array length at least ${h["min-length"]} expected, length ${l.length} found`)];let R={type:h.value,values:h.values};y.$version<7&&(R.function=h.function),nr(h.value)==="object"&&(R=h.value);let O=[];for(let B=0;B<l.length;B++)O=O.concat(E({array:l,arrayIndex:B,value:l[B],valueSpec:R,validateSpec:d.validateSpec,style:p,styleSpec:y,key:`${S}[${B}]`}));return O}function Id(d){const l=d.key,h=d.value,p=d.valueSpec;let y=nr(h);return y==="number"&&h!=h&&(y="NaN"),y!=="number"?[new gt(l,h,`number expected, ${y} found`)]:"minimum"in p&&h<p.minimum?[new gt(l,h,`${h} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&h>p.maximum?[new gt(l,h,`${h} is greater than the maximum value ${p.maximum}`)]:[]}function Bu(d){const l=d.valueSpec,h=ai(d.value.type);let p,y,S,E={};const R=h!=="categorical"&&d.value.property===void 0,O=!R,B=nr(d.value.stops)==="array"&&nr(d.value.stops[0])==="array"&&nr(d.value.stops[0][0])==="object",G=As({key:d.key,value:d.value,valueSpec:d.styleSpec.function,validateSpec:d.validateSpec,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(ae){if(h==="identity")return[new gt(ae.key,ae.value,'identity function may not have a "stops" property')];let ce=[];const de=ae.value;return ce=ce.concat(yp({key:ae.key,value:de,valueSpec:ae.valueSpec,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:X})),nr(de)==="array"&&de.length===0&&ce.push(new gt(ae.key,de,"array must have at least one stop")),ce},default:function(ae){return ae.validateSpec({key:ae.key,value:ae.value,valueSpec:l,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec})}}});return h==="identity"&&R&&G.push(new gt(d.key,d.value,'missing required property "property"')),h==="identity"||d.value.stops||G.push(new gt(d.key,d.value,'missing required property "stops"')),h==="exponential"&&d.valueSpec.expression&&!bv(d.valueSpec)&&G.push(new gt(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(O&&!Ou(d.valueSpec)?G.push(new gt(d.key,d.value,"property functions not supported")):R&&!xv(d.valueSpec)&&G.push(new gt(d.key,d.value,"zoom functions not supported"))),h!=="categorical"&&!B||d.value.property!==void 0||G.push(new gt(d.key,d.value,'"property" property is required')),G;function X(ae){let ce=[];const de=ae.value,Ce=ae.key;if(nr(de)!=="array")return[new gt(Ce,de,`array expected, ${nr(de)} found`)];if(de.length!==2)return[new gt(Ce,de,`array length 2 expected, length ${de.length} found`)];if(B){if(nr(de[0])!=="object")return[new gt(Ce,de,`object expected, ${nr(de[0])} found`)];if(de[0].zoom===void 0)return[new gt(Ce,de,"object stop key must have zoom")];if(de[0].value===void 0)return[new gt(Ce,de,"object stop key must have value")];if(S&&S>ai(de[0].zoom))return[new gt(Ce,de[0].zoom,"stop zoom values must appear in ascending order")];ai(de[0].zoom)!==S&&(S=ai(de[0].zoom),y=void 0,E={}),ce=ce.concat(As({key:`${Ce}[0]`,value:de[0],valueSpec:{zoom:{}},validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:Id,value:ie}}))}else ce=ce.concat(ie({key:`${Ce}[0]`,value:de[0],validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec},de));return dp($l(de[1]))?ce.concat([new gt(`${Ce}[1]`,de[1],"expressions are not allowed in function stops.")]):ce.concat(ae.validateSpec({key:`${Ce}[1]`,value:de[1],valueSpec:l,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec}))}function ie(ae,ce){const de=nr(ae.value),Ce=ai(ae.value),ke=ae.value!==null?ae.value:ce;if(p){if(de!==p)return[new gt(ae.key,ke,`${de} stop domain type must match previous stop domain type ${p}`)]}else p=de;if(de!=="number"&&de!=="string"&&de!=="boolean")return[new gt(ae.key,ke,"stop domain value must be a number, string, or boolean")];if(de!=="number"&&h!=="categorical"){let et=`number expected, ${de} found`;return Ou(l)&&h===void 0&&(et+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new gt(ae.key,ke,et)]}return h!=="categorical"||de!=="number"||isFinite(Ce)&&Math.floor(Ce)===Ce?h!=="categorical"&&de==="number"&&y!==void 0&&Ce<y?[new gt(ae.key,ke,"stop domain values must appear in ascending order")]:(y=Ce,h==="categorical"&&Ce in E?[new gt(ae.key,ke,"stop domain values must be unique")]:(E[Ce]=!0,[])):[new gt(ae.key,ke,`integer expected, found ${Ce}`)]}}function Uu(d){const l=(d.expressionContext==="property"?wv:fp)($l(d.value),d.valueSpec);if(l.result==="error")return l.value.map(p=>new gt(`${d.key}${p.key}`,d.value,p.message));const h=l.value.expression||l.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!h.outputDefined())return[new gt(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!Md(h))return[new gt(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter"&&!Md(h))return[new gt(d.key,d.value,'"feature-state" data expressions are not supported with filters.')];if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!Du(h,["zoom","feature-state"]))return[new gt(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!up(h))return[new gt(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Cv(d){const l=d.key,h=d.value,p=nr(h);return p!=="string"?[new gt(l,h,`color expected, ${p} found`)]:tr.parse(String(h))?[]:[new gt(l,h,`color expected, "${h}" found`)]}function Rd(d){const l=d.key,h=d.value,p=d.valueSpec,y=[];return Array.isArray(p.values)?p.values.indexOf(ai(h))===-1&&y.push(new gt(l,h,`expected one of [${p.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(p.values).indexOf(ai(h))===-1&&y.push(new gt(l,h,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(h)} found`)),y}function Ev(d){return Pd($l(d.value))?Uu(In({},d,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Xx(d)}function Xx(d){const l=d.value,h=d.key;if(nr(l)!=="array")return[new gt(h,l,`array expected, ${nr(l)} found`)];const p=d.styleSpec;let y,S=[];if(l.length<1)return[new gt(h,l,"filter array must have at least 1 element")];switch(S=S.concat(Rd({key:`${h}[0]`,value:l[0],valueSpec:p.filter_operator,style:d.style,styleSpec:d.styleSpec})),ai(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&ai(l[1])==="$type"&&S.push(new gt(h,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&S.push(new gt(h,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(y=nr(l[1]),y!=="string"&&S.push(new gt(`${h}[1]`,l[1],`string expected, ${y} found`)));for(let E=2;E<l.length;E++)y=nr(l[E]),ai(l[1])==="$type"?S=S.concat(Rd({key:`${h}[${E}]`,value:l[E],valueSpec:p.geometry_type,style:d.style,styleSpec:d.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&S.push(new gt(`${h}[${E}]`,l[E],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let E=1;E<l.length;E++)S=S.concat(Xx({key:`${h}[${E}]`,value:l[E],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":y=nr(l[1]),l.length!==2?S.push(new gt(h,l,`filter array for "${l[0]}" operator must have 2 elements`)):y!=="string"&&S.push(new gt(`${h}[1]`,l[1],`string expected, ${y} found`))}return S}function Zx(d,l){const h=d.key,p=d.validateSpec,y=d.style,S=d.styleSpec,E=d.value,R=d.objectKey,O=S[`${l}_${d.layerType}`];if(!O)return[];const B=R.match(/^(.*)-transition$/);if(l==="paint"&&B&&O[B[1]]&&O[B[1]].transition)return p({key:h,value:E,valueSpec:S.transition,style:y,styleSpec:S});const G=d.valueSpec||O[R];if(!G)return[new gt(h,E,`unknown property "${R}"`)];let X;if(nr(E)==="string"&&Ou(G)&&!G.tokens&&(X=/^{([^}]+)}$/.exec(E)))return[new gt(h,E,`"${R}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(X[1])} }\`.`)];const ie=[];return d.layerType==="symbol"&&(R==="text-field"&&y&&!y.glyphs&&ie.push(new gt(h,E,'use of "text-field" requires a style "glyphs" property')),R==="text-font"&&Dc($l(E))&&ai(E.type)==="identity"&&ie.push(new gt(h,E,'"text-font" does not support identity functions'))),ie.concat(p({key:d.key,value:E,valueSpec:G,style:y,styleSpec:S,expressionContext:"property",propertyType:l,propertyKey:R}))}function $u(d){return Zx(d,"paint")}function Vu(d){return Zx(d,"layout")}function Jo(d){let l=[];const h=d.value,p=d.key,y=d.style,S=d.styleSpec;if(nr(h)!=="object")return[new gt(p,h,`object expected, ${nr(h)} found`)];h.type||h.ref||l.push(new gt(p,h,'either "type" or "ref" is required'));let E=ai(h.type);const R=ai(h.ref);if(h.id){const O=ai(h.id);for(let B=0;B<d.arrayIndex;B++){const G=y.layers[B];ai(G.id)===O&&l.push(new gt(p,h.id,`duplicate layer id "${h.id}", previously used at line ${G.id.__line__}`))}}if("ref"in h){let O;["type","source","source-layer","filter","layout"].forEach(B=>{B in h&&l.push(new gt(p,h[B],`"${B}" is prohibited for ref layers`))}),y.layers.forEach(B=>{ai(B.id)===R&&(O=B)}),O?O.ref?l.push(new gt(p,h.ref,"ref cannot reference another ref layer")):E=ai(O.type):l.push(new gt(p,h.ref,`ref layer "${R}" not found`))}else if(E!=="background")if(h.source){const O=y.sources&&y.sources[h.source],B=O&&ai(O.type);O?B==="vector"&&E==="raster"?l.push(new gt(p,h.source,`layer "${h.id}" requires a raster source`)):B!=="raster-dem"&&E==="hillshade"||B!=="raster-dem"&&E==="color-relief"?l.push(new gt(p,h.source,`layer "${h.id}" requires a raster-dem source`)):B==="raster"&&E!=="raster"?l.push(new gt(p,h.source,`layer "${h.id}" requires a vector source`)):B!=="vector"||h["source-layer"]?B==="raster-dem"&&E!=="hillshade"&&E!=="color-relief"?l.push(new gt(p,h.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):E!=="line"||!h.paint||!h.paint["line-gradient"]||B==="geojson"&&O.lineMetrics||l.push(new gt(p,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new gt(p,h,`layer "${h.id}" must specify a "source-layer"`)):l.push(new gt(p,h.source,`source "${h.source}" not found`))}else l.push(new gt(p,h,'missing required property "source"'));return l=l.concat(As({key:p,value:h,valueSpec:S.layer,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,objectElementValidators:{"*":()=>[],type:()=>d.validateSpec({key:`${p}.type`,value:h.type,valueSpec:S.layer.type,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,object:h,objectKey:"type"}),filter:Ev,layout:O=>As({layer:h,key:O.key,value:O.value,style:O.style,styleSpec:O.styleSpec,validateSpec:O.validateSpec,objectElementValidators:{"*":B=>Vu(In({layerType:E},B))}}),paint:O=>As({layer:h,key:O.key,value:O.value,style:O.style,styleSpec:O.styleSpec,validateSpec:O.validateSpec,objectElementValidators:{"*":B=>$u(In({layerType:E},B))}})}})),l}function Js(d){const l=d.value,h=d.key,p=nr(l);return p!=="string"?[new gt(h,l,`string expected, ${p} found`)]:[]}const Tv={promoteId:function({key:d,value:l}){if(nr(l)==="string")return Js({key:d,value:l});{const h=[];for(const p in l)h.push(...Js({key:`${d}.${p}`,value:l[p]}));return h}}};function Yx(d){const l=d.value,h=d.key,p=d.styleSpec,y=d.style,S=d.validateSpec;if(!l.type)return[new gt(h,l,'"type" is required')];const E=ai(l.type);let R;switch(E){case"vector":case"raster":return R=As({key:h,value:l,valueSpec:p[`source_${E.replace("-","_")}`],style:d.style,styleSpec:p,objectElementValidators:Tv,validateSpec:S}),R;case"raster-dem":return R=function(O){var B;const G=(B=O.sourceName)!==null&&B!==void 0?B:"",X=O.value,ie=O.styleSpec,ae=ie.source_raster_dem,ce=O.style;let de=[];const Ce=nr(X);if(X===void 0)return de;if(Ce!=="object")return de.push(new gt("source_raster_dem",X,`object expected, ${Ce} found`)),de;const ke=ai(X.encoding)==="custom",et=["redFactor","greenFactor","blueFactor","baseShift"],Ge=O.value.encoding?`"${O.value.encoding}"`:"Default";for(const se in X)!ke&&et.includes(se)?de.push(new gt(se,X[se],`In "${G}": "${se}" is only valid when "encoding" is set to "custom". ${Ge} encoding found`)):ae[se]?de=de.concat(O.validateSpec({key:se,value:X[se],valueSpec:ae[se],validateSpec:O.validateSpec,style:ce,styleSpec:ie})):de.push(new gt(se,X[se],`unknown property "${se}"`));return de}({sourceName:h,value:l,style:d.style,styleSpec:p,validateSpec:S}),R;case"geojson":if(R=As({key:h,value:l,valueSpec:p.source_geojson,style:y,styleSpec:p,validateSpec:S,objectElementValidators:Tv}),l.cluster)for(const O in l.clusterProperties){const[B,G]=l.clusterProperties[O],X=typeof B=="string"?[B,["accumulated"],["get",O]]:B;R.push(...Uu({key:`${h}.${O}.map`,value:G,expressionContext:"cluster-map"})),R.push(...Uu({key:`${h}.${O}.reduce`,value:X,expressionContext:"cluster-reduce"}))}return R;case"video":return As({key:h,value:l,valueSpec:p.source_video,style:y,validateSpec:S,styleSpec:p});case"image":return As({key:h,value:l,valueSpec:p.source_image,style:y,validateSpec:S,styleSpec:p});case"canvas":return[new gt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Rd({key:`${h}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Kx(d){const l=d.value,h=d.styleSpec,p=h.light,y=d.style;let S=[];const E=nr(l);if(l===void 0)return S;if(E!=="object")return S=S.concat([new gt("light",l,`object expected, ${E} found`)]),S;for(const R in l){const O=R.match(/^(.*)-transition$/);S=S.concat(O&&p[O[1]]&&p[O[1]].transition?d.validateSpec({key:R,value:l[R],valueSpec:h.transition,validateSpec:d.validateSpec,style:y,styleSpec:h}):p[R]?d.validateSpec({key:R,value:l[R],valueSpec:p[R],validateSpec:d.validateSpec,style:y,styleSpec:h}):[new gt(R,l[R],`unknown property "${R}"`)])}return S}function ju(d){const l=d.value,h=d.styleSpec,p=h.sky,y=d.style,S=nr(l);if(l===void 0)return[];if(S!=="object")return[new gt("sky",l,`object expected, ${S} found`)];let E=[];for(const R in l)E=E.concat(p[R]?d.validateSpec({key:R,value:l[R],valueSpec:p[R],style:y,styleSpec:h}):[new gt(R,l[R],`unknown property "${R}"`)]);return E}function Pv(d){const l=d.value,h=d.styleSpec,p=h.terrain,y=d.style;let S=[];const E=nr(l);if(l===void 0)return S;if(E!=="object")return S=S.concat([new gt("terrain",l,`object expected, ${E} found`)]),S;for(const R in l)S=S.concat(p[R]?d.validateSpec({key:R,value:l[R],valueSpec:p[R],validateSpec:d.validateSpec,style:y,styleSpec:h}):[new gt(R,l[R],`unknown property "${R}"`)]);return S}function _p(d){let l=[];const h=d.value,p=d.key;if(Array.isArray(h)){const y=[],S=[];for(const E in h)h[E].id&&y.includes(h[E].id)&&l.push(new gt(p,h,`all the sprites' ids must be unique, but ${h[E].id} is duplicated`)),y.push(h[E].id),h[E].url&&S.includes(h[E].url)&&l.push(new gt(p,h,`all the sprites' URLs must be unique, but ${h[E].url} is duplicated`)),S.push(h[E].url),l=l.concat(As({key:`${p}[${E}]`,value:h[E],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:d.validateSpec}));return l}return Js({key:p,value:h})}function Jx(d){return l=d.value,l&&l.constructor===Object?[]:[new gt(d.key,d.value,`object expected, ${nr(d.value)} found`)];var l}const xp={"*":()=>[],array:yp,boolean:function(d){const l=d.value,h=d.key,p=nr(l);return p!=="boolean"?[new gt(h,l,`boolean expected, ${p} found`)]:[]},number:Id,color:Cv,constants:qx,enum:Rd,filter:Ev,function:Bu,layer:Jo,object:As,source:Yx,light:Kx,sky:ju,terrain:Pv,projection:function(d){const l=d.value,h=d.styleSpec,p=h.projection,y=d.style,S=nr(l);if(l===void 0)return[];if(S!=="object")return[new gt("projection",l,`object expected, ${S} found`)];let E=[];for(const R in l)E=E.concat(p[R]?d.validateSpec({key:R,value:l[R],valueSpec:p[R],style:y,styleSpec:h}):[new gt(R,l[R],`unknown property "${R}"`)]);return E},projectionDefinition:function(d){const l=d.key;let h=d.value;h=h instanceof String?h.valueOf():h;const p=nr(h);return p!=="array"||function(y){return Array.isArray(y)&&y.length===3&&typeof y[0]=="string"&&typeof y[1]=="string"&&typeof y[2]=="number"}(h)||function(y){return!!["interpolate","step","literal"].includes(y[0])}(h)?["array","string"].includes(p)?[]:[new gt(l,h,`projection expected, invalid type "${p}" found`)]:[new gt(l,h,`projection expected, invalid array ${JSON.stringify(h)} found`)]},string:Js,formatted:function(d){return Js(d).length===0?[]:Uu(d)},resolvedImage:function(d){return Js(d).length===0?[]:Uu(d)},padding:function(d){const l=d.key,h=d.value;if(nr(h)==="array"){if(h.length<1||h.length>4)return[new gt(l,h,`padding requires 1 to 4 values; ${h.length} values found`)];const p={type:"number"};let y=[];for(let S=0;S<h.length;S++)y=y.concat(d.validateSpec({key:`${l}[${S}]`,value:h[S],validateSpec:d.validateSpec,valueSpec:p}));return y}return Id({key:l,value:h,valueSpec:{}})},numberArray:function(d){const l=d.key,h=d.value;if(nr(h)==="array"){const p={type:"number"};if(h.length<1)return[new gt(l,h,"array length at least 1 expected, length 0 found")];let y=[];for(let S=0;S<h.length;S++)y=y.concat(d.validateSpec({key:`${l}[${S}]`,value:h[S],validateSpec:d.validateSpec,valueSpec:p}));return y}return Id({key:l,value:h,valueSpec:{}})},colorArray:function(d){const l=d.key,h=d.value;if(nr(h)==="array"){if(h.length<1)return[new gt(l,h,"array length at least 1 expected, length 0 found")];let p=[];for(let y=0;y<h.length;y++)p=p.concat(Cv({key:`${l}[${y}]`,value:h[y]}));return p}return Cv({key:l,value:h})},variableAnchorOffsetCollection:function(d){const l=d.key,h=d.value,p=nr(h),y=d.styleSpec;if(p!=="array"||h.length<1||h.length%2!=0)return[new gt(l,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let S=[];for(let E=0;E<h.length;E+=2)S=S.concat(Rd({key:`${l}[${E}]`,value:h[E],valueSpec:y.layout_symbol["text-anchor"]})),S=S.concat(yp({key:`${l}[${E+1}]`,value:h[E+1],valueSpec:{length:2,value:"number"},validateSpec:d.validateSpec,style:d.style,styleSpec:y}));return S},sprite:_p,state:Jx};function bp(d){const l=d.value,h=d.valueSpec,p=d.styleSpec;return d.validateSpec=bp,h.expression&&Dc(ai(l))?Bu(d):h.expression&&dp($l(l))?Uu(d):h.type&&xp[h.type]?xp[h.type](d):As(In({},d,{valueSpec:h.type?p[h.type]:h}))}function Hu(d){const l=d.value,h=d.key,p=Js(d);return p.length||(l.indexOf("{fontstack}")===-1&&p.push(new gt(h,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&p.push(new gt(h,l,'"glyphs" url must include a "{range}" token'))),p}function Is(d,l=Oe){let h=[];return h=h.concat(bp({key:"",value:d,valueSpec:l.$root,styleSpec:l,style:d,validateSpec:bp,objectElementValidators:{glyphs:Hu,"*":()=>[]}})),d.constants&&(h=h.concat(qx({key:"constants",value:d.constants}))),Qx(h)}function Qs(d){return function(l){return d({...l,validateSpec:bp})}}function Qx(d){return[].concat(d).sort((l,h)=>l.line-h.line)}function ko(d){return function(...l){return Qx(d.apply(this,l))}}Is.source=ko(Qs(Yx)),Is.sprite=ko(Qs(_p)),Is.glyphs=ko(Qs(Hu)),Is.light=ko(Qs(Kx)),Is.sky=ko(Qs(ju)),Is.terrain=ko(Qs(Pv)),Is.state=ko(Qs(Jx)),Is.layer=ko(Qs(Jo)),Is.filter=ko(Qs(Ev)),Is.paintProperty=ko(Qs($u)),Is.layoutProperty=ko(Qs(Vu));const Gu=Is,q2=Gu.light,wp=Gu.sky,X2=Gu.paintProperty,Av=Gu.layoutProperty;function Ld(d,l){let h=!1;if(l&&l.length)for(const p of l)d.fire(new ze(new Error(p.message))),h=!0;return h}class Wu{constructor(l,h,p){const y=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;const E=new Int32Array(this.arrayBuffer);l=E[0],this.d=(h=E[1])+2*(p=E[2]);for(let O=0;O<this.d*this.d;O++){const B=E[3+O],G=E[3+O+1];y.push(B===G?null:E.subarray(B,G))}const R=E[3+y.length+1];this.keys=E.subarray(E[3+y.length],R),this.bboxes=E.subarray(R),this.insert=this._insertReadonly}else{this.d=h+2*p;for(let E=0;E<this.d*this.d;E++)y.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=l,this.padding=p,this.scale=h/l,this.uid=0;const S=p/h*l;this.min=-S,this.max=l+S}insert(l,h,p,y,S){this._forEachCell(h,p,y,S,this._insertCell,this.uid++,void 0,void 0),this.keys.push(l),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(S)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(l,h,p,y,S,E){this.cells[S].push(E)}query(l,h,p,y,S){const E=this.min,R=this.max;if(l<=E&&h<=E&&R<=p&&R<=y&&!S)return Array.prototype.slice.call(this.keys);{const O=[];return this._forEachCell(l,h,p,y,this._queryCell,O,{},S),O}}_queryCell(l,h,p,y,S,E,R,O){const B=this.cells[S];if(B!==null){const G=this.keys,X=this.bboxes;for(let ie=0;ie<B.length;ie++){const ae=B[ie];if(R[ae]===void 0){const ce=4*ae;(O?O(X[ce+0],X[ce+1],X[ce+2],X[ce+3]):l<=X[ce+2]&&h<=X[ce+3]&&p>=X[ce+0]&&y>=X[ce+1])?(R[ae]=!0,E.push(G[ae])):R[ae]=!1}}}}_forEachCell(l,h,p,y,S,E,R,O){const B=this._convertToCellCoord(l),G=this._convertToCellCoord(h),X=this._convertToCellCoord(p),ie=this._convertToCellCoord(y);for(let ae=B;ae<=X;ae++)for(let ce=G;ce<=ie;ce++){const de=this.d*ce+ae;if((!O||O(this._convertFromCellCoord(ae),this._convertFromCellCoord(ce),this._convertFromCellCoord(ae+1),this._convertFromCellCoord(ce+1)))&&S.call(this,l,h,p,y,de,E,R,O))return}}_convertFromCellCoord(l){return(l-this.padding)/this.scale}_convertToCellCoord(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const l=this.cells,h=3+this.cells.length+1+1;let p=0;for(let E=0;E<this.cells.length;E++)p+=this.cells[E].length;const y=new Int32Array(h+p+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;let S=h;for(let E=0;E<l.length;E++){const R=l[E];y[3+E]=S,y.set(R,S),S+=R.length}return y[3+l.length]=S,y.set(this.keys,S),S+=this.keys.length,y[3+l.length+1]=S,y.set(this.bboxes,S),S+=this.bboxes.length,y.buffer}static serialize(l,h){const p=l.toArrayBuffer();return h&&h.push(p),{buffer:p}}static deserialize(l){return new Wu(l.buffer)}}const ka={};function xn(d,l,h={}){if(ka[d])throw new Error(`${d} is already registered.`);Object.defineProperty(l,"_classRegistryKey",{value:d,writeable:!1}),ka[d]={klass:l,omit:h.omit||[],shallow:h.shallow||[]}}xn("Object",Object),xn("Set",Set),xn("TransferableGridIndex",Wu),xn("Color",tr),xn("Error",Error),xn("AJAXError",le),xn("ResolvedImage",Zo),xn("StylePropertyFunction",Td),xn("StyleExpression",hp,{omit:["_evaluator"]}),xn("ZoomDependentExpression",pp),xn("ZoomConstantExpression",Ed),xn("CompoundExpression",Ps,{omit:["_evaluate"]});for(const d in ku)ku[d]._classRegistryKey||xn(`Expression_${d}`,ku[d]);function Iv(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function kd(d){return d.$name||d.constructor._classRegistryKey}function Rv(d){return!function(l){if(l===null||typeof l!="object")return!1;const h=kd(l);return!(!h||h==="Object")}(d)&&(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||d instanceof Blob||d instanceof Error||Iv(d)||Le(d)||ArrayBuffer.isView(d)||d instanceof ImageData)}function Dd(d,l){if(Rv(d))return(Iv(d)||Le(d))&&l&&l.push(d),ArrayBuffer.isView(d)&&l&&l.push(d.buffer),d instanceof ImageData&&l&&l.push(d.data.buffer),d;if(Array.isArray(d)){const S=[];for(const E of d)S.push(Dd(E,l));return S}if(typeof d!="object")throw new Error("can't serialize object of type "+typeof d);const h=kd(d);if(!h)throw new Error(`can't serialize object of unregistered class ${d.constructor.name}`);if(!ka[h])throw new Error(`${h} is not registered.`);const{klass:p}=ka[h],y=p.serialize?p.serialize(d,l):{};if(p.serialize){if(l&&y===l[l.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const S in d){if(!d.hasOwnProperty(S)||ka[h].omit.indexOf(S)>=0)continue;const E=d[S];y[S]=ka[h].shallow.indexOf(S)>=0?E:Dd(E,l)}d instanceof Error&&(y.message=d.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(y.$name=h),y}function qu(d){if(Rv(d))return d;if(Array.isArray(d))return d.map(qu);if(typeof d!="object")throw new Error("can't deserialize object of type "+typeof d);const l=kd(d)||"Object";if(!ka[l])throw new Error(`can't deserialize unregistered class ${l}`);const{klass:h}=ka[l];if(!h)throw new Error(`can't deserialize unregistered class ${l}`);if(h.deserialize)return h.deserialize(d);const p=Object.create(h.prototype);for(const y of Object.keys(d)){if(y==="$name")continue;const S=d[y];p[y]=ka[l].shallow.indexOf(y)>=0?S:qu(S)}return p}class Lv{constructor(){this.first=!0}update(l,h){const p=Math.floor(l);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=l,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=h),l!==this.lastZoom&&(this.lastZoom=l,this.lastFloorZoom=p,!0))}}const rr={"Latin-1 Supplement":d=>d>=128&&d<=255,"Hangul Jamo":d=>d>=4352&&d<=4607,Khmer:d=>d>=6016&&d<=6143,"General Punctuation":d=>d>=8192&&d<=8303,"Letterlike Symbols":d=>d>=8448&&d<=8527,"Number Forms":d=>d>=8528&&d<=8591,"Miscellaneous Technical":d=>d>=8960&&d<=9215,"Control Pictures":d=>d>=9216&&d<=9279,"Optical Character Recognition":d=>d>=9280&&d<=9311,"Enclosed Alphanumerics":d=>d>=9312&&d<=9471,"Geometric Shapes":d=>d>=9632&&d<=9727,"Miscellaneous Symbols":d=>d>=9728&&d<=9983,"Miscellaneous Symbols and Arrows":d=>d>=11008&&d<=11263,"Ideographic Description Characters":d=>d>=12272&&d<=12287,"CJK Symbols and Punctuation":d=>d>=12288&&d<=12351,Hiragana:d=>d>=12352&&d<=12447,Katakana:d=>d>=12448&&d<=12543,Kanbun:d=>d>=12688&&d<=12703,"CJK Strokes":d=>d>=12736&&d<=12783,"Enclosed CJK Letters and Months":d=>d>=12800&&d<=13055,"CJK Compatibility":d=>d>=13056&&d<=13311,"Yijing Hexagram Symbols":d=>d>=19904&&d<=19967,"CJK Unified Ideographs":d=>d>=19968&&d<=40959,"Hangul Syllables":d=>d>=44032&&d<=55215,"Private Use Area":d=>d>=57344&&d<=63743,"Vertical Forms":d=>d>=65040&&d<=65055,"CJK Compatibility Forms":d=>d>=65072&&d<=65103,"Small Form Variants":d=>d>=65104&&d<=65135,"Halfwidth and Fullwidth Forms":d=>d>=65280&&d<=65519};function kv(d){for(const l of d)if(Mp(l.charCodeAt(0)))return!0;return!1}function e1(d){for(const l of d)if(!Y2(l.charCodeAt(0)))return!1;return!0}function Sp(d){const l=d.map(h=>{try{return new RegExp(`\\p{sc=${h}}`,"u").source}catch{return null}}).filter(h=>h);return new RegExp(l.join("|"),"u")}const Z2=Sp(["Arab","Dupl","Mong","Ougr","Syrc"]);function Y2(d){return!Z2.test(String.fromCodePoint(d))}const Dv=Sp(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Mp(d){return!(d!==746&&d!==747&&(d<4352||!(rr["CJK Compatibility Forms"](d)&&!(d>=65097&&d<=65103)||rr["CJK Compatibility"](d)||rr["CJK Strokes"](d)||!(!rr["CJK Symbols and Punctuation"](d)||d>=12296&&d<=12305||d>=12308&&d<=12319||d===12336)||rr["Enclosed CJK Letters and Months"](d)||rr["Ideographic Description Characters"](d)||rr.Kanbun(d)||rr.Katakana(d)&&d!==12540||!(!rr["Halfwidth and Fullwidth Forms"](d)||d===65288||d===65289||d===65293||d>=65306&&d<=65310||d===65339||d===65341||d===65343||d>=65371&&d<=65503||d===65507||d>=65512&&d<=65519)||!(!rr["Small Form Variants"](d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||rr["Vertical Forms"](d)||rr["Yijing Hexagram Symbols"](d)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(d))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(d))||Dv.test(String.fromCodePoint(d)))))}function zv(d){return!(Mp(d)||function(l){return!!(rr["Latin-1 Supplement"](l)&&(l===167||l===169||l===174||l===177||l===188||l===189||l===190||l===215||l===247)||rr["General Punctuation"](l)&&(l===8214||l===8224||l===8225||l===8240||l===8241||l===8251||l===8252||l===8258||l===8263||l===8264||l===8265||l===8273)||rr["Letterlike Symbols"](l)||rr["Number Forms"](l)||rr["Miscellaneous Technical"](l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||l===9003||l>=9085&&l<=9114||l>=9150&&l<=9165||l===9167||l>=9169&&l<=9179||l>=9186&&l<=9215)||rr["Control Pictures"](l)&&l!==9251||rr["Optical Character Recognition"](l)||rr["Enclosed Alphanumerics"](l)||rr["Geometric Shapes"](l)||rr["Miscellaneous Symbols"](l)&&!(l>=9754&&l<=9759)||rr["Miscellaneous Symbols and Arrows"](l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||rr["CJK Symbols and Punctuation"](l)||rr.Katakana(l)||rr["Private Use Area"](l)||rr["CJK Compatibility Forms"](l)||rr["Small Form Variants"](l)||rr["Halfwidth and Fullwidth Forms"](l)||l===8734||l===8756||l===8757||l>=9984&&l<=10087||l>=10102&&l<=10131||l===65532||l===65533)}(d))}const t1=Sp(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function zd(d){return t1.test(String.fromCodePoint(d))}function K2(d,l){return!(!l&&zd(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||rr.Khmer(d))}function Ov(d){for(const l of d)if(zd(l.charCodeAt(0)))return!0;return!1}const Vl=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(d){this.pluginStatus=d.pluginStatus,this.pluginURL=d.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(d){if(Vl.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=d.applyArabicShaping,this.processBidirectionalText=d.processBidirectionalText,this.processStyledBidirectionalText=d.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(d,l){return o(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(d.pluginStatus!=="loading")return this.setState(d),d;const h=d.pluginURL,p=new Promise(S=>{this.loadScriptResolve=S});l(h);const y=new Promise(S=>setTimeout(()=>S(),this.TIMEOUT));if(yield Promise.race([p,y]),this.isParsed()){const S={pluginStatus:"loaded",pluginURL:h};return this.setState(S),S}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${h}`)})}};class Zr{constructor(l,h){this.zoom=l,h?(this.now=h.now||0,this.fadeDuration=h.fadeDuration||0,this.zoomHistory=h.zoomHistory||new Lv,this.transition=h.transition||{},this.globalState=h.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Lv,this.transition={},this.globalState={})}isSupportedScript(l){return function(h,p){for(const y of h)if(!K2(y.charCodeAt(0),p))return!1;return!0}(l,Vl.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const l=this.zoom,h=l-Math.floor(l),p=this.crossFadingFactor();return l>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*h}}}class Od{constructor(l,h){this.property=l,this.value=h,this.expression=function(p,y){if(Dc(p))return new Td(p,y);if(dp(p)){const S=wv(p,y);if(S.result==="error")throw new Error(S.value.map(E=>`${E.key}: ${E.message}`).join(", "));return S.value}{let S=p;return y.type==="color"&&typeof p=="string"?S=tr.parse(p):y.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?y.type!=="numberArray"||typeof p!="number"&&!Array.isArray(p)?y.type!=="colorArray"||typeof p!="string"&&!Array.isArray(p)?y.type==="variableAnchorOffsetCollection"&&Array.isArray(p)?S=ar.parse(p):y.type==="projectionDefinition"&&typeof p=="string"&&(S=Wn.parse(p)):S=ji.parse(p):S=yo.parse(p):S=wi.parse(p),{globalStateRefs:new Set,kind:"constant",evaluate:()=>S}}}(h===void 0?l.specification.default:h,l.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(l,h,p){return this.property.possiblyEvaluate(this,l,h,p)}}class Cp{constructor(l){this.property=l,this.value=new Od(l,void 0)}transitioned(l,h){return new n1(this.property,this.value,h,un({},l.transition,this.transition),l.now)}untransitioned(){return new n1(this.property,this.value,null,{},0)}}class Fv{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues)}getValue(l){return vn(this._values[l].value.value)}setValue(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new Cp(this._values[l].property)),this._values[l].value=new Od(this._values[l].property,h===null?void 0:vn(h))}getTransition(l){return vn(this._values[l].transition)}setTransition(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new Cp(this._values[l].property)),this._values[l].transition=vn(h)||void 0}serialize(){const l={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(l[h]=p);const y=this.getTransition(h);y!==void 0&&(l[`${h}-transition`]=y)}return l}transitioned(l,h){const p=new r1(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].transitioned(l,h._values[y]);return p}untransitioned(){const l=new r1(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].untransitioned();return l}}class n1{constructor(l,h,p,y,S){this.property=l,this.value=h,this.begin=S+y.delay||0,this.end=this.begin+y.duration||0,l.specification.transition&&(y.delay||y.duration)&&(this.prior=p)}possiblyEvaluate(l,h,p){const y=l.now||0,S=this.value.possiblyEvaluate(l,h,p),E=this.prior;if(E){if(y>this.end)return this.prior=null,S;if(this.value.isDataDriven())return this.prior=null,S;if(y<this.begin)return E.possiblyEvaluate(l,h,p);{const R=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(l,h,p),S,Ot(R))}}return S}}class r1{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,h,p){const y=new Ep(this._properties);for(const S of Object.keys(this._values))y._values[S]=this._values[S].possiblyEvaluate(l,h,p);return y}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class J2{constructor(l){this._properties=l,this._values=Object.create(l.defaultPropertyValues)}hasValue(l){return this._values[l].value!==void 0}getValue(l){return vn(this._values[l].value)}setValue(l,h){this._values[l]=new Od(this._values[l].property,h===null?void 0:vn(h))}serialize(){const l={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(l[h]=p)}return l}possiblyEvaluate(l,h,p){const y=new Ep(this._properties);for(const S of Object.keys(this._values))y._values[S]=this._values[S].possiblyEvaluate(l,h,p);return y}}class Da{constructor(l,h,p){this.property=l,this.value=h,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,h,p,y){return this.property.evaluate(this.value,this.parameters,l,h,p,y)}}class Ep{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class En{constructor(l){this.specification=l}possiblyEvaluate(l,h){if(l.isDataDriven())throw new Error("Value should not be data driven");return l.expression.evaluate(h)}interpolate(l,h,p){const y=hs[this.specification.type];return y?y(l,h,p):l}}class Vn{constructor(l,h){this.specification=l,this.overrides=h}possiblyEvaluate(l,h,p,y){return new Da(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(h,null,{},p,y)}:l.expression,h)}interpolate(l,h,p){if(l.value.kind!=="constant"||h.value.kind!=="constant")return l;if(l.value.value===void 0||h.value.value===void 0)return new Da(this,{kind:"constant",value:void 0},l.parameters);const y=hs[this.specification.type];if(y){const S=y(l.value.value,h.value.value,p);return new Da(this,{kind:"constant",value:S},l.parameters)}return l}evaluate(l,h,p,y,S,E){return l.kind==="constant"?l.value:l.evaluate(h,p,y,S,E)}}class Tp extends Vn{possiblyEvaluate(l,h,p,y){if(l.value===void 0)return new Da(this,{kind:"constant",value:void 0},h);if(l.expression.kind==="constant"){const S=l.expression.evaluate(h,null,{},p,y),E=l.property.specification.type==="resolvedImage"&&typeof S!="string"?S.name:S,R=this._calculate(E,E,E,h);return new Da(this,{kind:"constant",value:R},h)}if(l.expression.kind==="camera"){const S=this._calculate(l.expression.evaluate({zoom:h.zoom-1}),l.expression.evaluate({zoom:h.zoom}),l.expression.evaluate({zoom:h.zoom+1}),h);return new Da(this,{kind:"constant",value:S},h)}return new Da(this,l.expression,h)}evaluate(l,h,p,y,S,E){if(l.kind==="source"){const R=l.evaluate(h,p,y,S,E);return this._calculate(R,R,R,h)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(h.zoom)-1},p,y),l.evaluate({zoom:Math.floor(h.zoom)},p,y),l.evaluate({zoom:Math.floor(h.zoom)+1},p,y),h):l.value}_calculate(l,h,p,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:p,to:h}}interpolate(l){return l}}class Nv{constructor(l){this.specification=l}possiblyEvaluate(l,h,p,y){if(l.value!==void 0){if(l.expression.kind==="constant"){const S=l.expression.evaluate(h,null,{},p,y);return this._calculate(S,S,S,h)}return this._calculate(l.expression.evaluate(new Zr(Math.floor(h.zoom-1),h)),l.expression.evaluate(new Zr(Math.floor(h.zoom),h)),l.expression.evaluate(new Zr(Math.floor(h.zoom+1),h)),h)}}_calculate(l,h,p,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:p,to:h}}interpolate(l){return l}}class Fd{constructor(l){this.specification=l}possiblyEvaluate(l,h,p,y){return!!l.expression.evaluate(h,null,{},p,y)}interpolate(){return!1}}class Do{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in l){const p=l[h];p.specification.overridable&&this.overridableProperties.push(h);const y=this.defaultPropertyValues[h]=new Od(p,void 0),S=this.defaultTransitionablePropertyValues[h]=new Cp(p);this.defaultTransitioningPropertyValues[h]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=y.possiblyEvaluate({})}}}xn("DataDrivenProperty",Vn),xn("DataConstantProperty",En),xn("CrossFadedDataDrivenProperty",Tp),xn("CrossFadedProperty",Nv),xn("ColorRampProperty",Fd);const i1="-transition";class to extends Je{constructor(l,h){if(super(),this.id=l.id,this.type=l.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter,this._featureFilter=Ul(l.filter)),h.layout&&(this._unevaluatedLayout=new J2(h.layout)),h.paint)){this._transitionablePaint=new Fv(h.paint);for(const p in l.paint)this.setPaintProperty(p,l.paint[p],{validate:!1});for(const p in l.layout)this.setLayoutProperty(p,l.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ep(h.paint)}}setFilter(l){this.filter=l,this._featureFilter=Ul(l)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}getLayoutAffectingGlobalStateRefs(){const l=new Set;if(this._unevaluatedLayout)for(const h in this._unevaluatedLayout._values){const p=this._unevaluatedLayout._values[h];for(const y of p.getGlobalStateRefs())l.add(y)}for(const h of this._featureFilter.getGlobalStateRefs())l.add(h);return l}setLayoutProperty(l,h,p={}){h!=null&&this._validate(Av,`layers.${this.id}.layout.${l}`,l,h,p)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,h):this.visibility=h)}getPaintProperty(l){return l.endsWith(i1)?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)}setPaintProperty(l,h,p={}){if(h!=null&&this._validate(X2,`layers.${this.id}.paint.${l}`,l,h,p))return!1;if(l.endsWith(i1))return this._transitionablePaint.setTransition(l.slice(0,-11),h||void 0),!1;{const y=this._transitionablePaint._values[l],S=y.property.specification["property-type"]==="cross-faded-data-driven",E=y.value.isDataDriven(),R=y.value;this._transitionablePaint.setValue(l,h),this._handleSpecialPaintPropertyUpdate(l);const O=this._transitionablePaint._values[l].value;return O.isDataDriven()||E||S||this._handleOverridablePaintPropertyUpdate(l,R,O)}}_handleSpecialPaintPropertyUpdate(l){}_handleOverridablePaintPropertyUpdate(l,h,p){return!1}isHidden(l){return!!(this.minzoom&&l<this.minzoom)||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(l,h){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,h)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),We(l,(h,p)=>!(h===void 0||p==="layout"&&!Object.keys(h).length||p==="paint"&&!Object.keys(h).length))}_validate(l,h,p,y,S={}){return(!S||S.validate!==!1)&&Ld(this,l.call(Gu,{key:h,layerType:this.type,objectKey:p,value:y,styleSpec:Oe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const h=this.paint.get(l);if(h instanceof Da&&Ou(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const o1={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class zc{constructor(l,h){this._structArray=l,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ti{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,h){return l._trim(),h&&(l.isTransferred=!0,h.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const h=Object.create(this.prototype);return h.arrayBuffer=l.arrayBuffer,h.length=l.length,h.capacity=l.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function li(d,l=1){let h=0,p=0;return{members:d.map(y=>{const S=o1[y.type].BYTES_PER_ELEMENT,E=h=s1(h,Math.max(l,S)),R=y.components||1;return p=Math.max(p,S),h+=S*R,{name:y.name,type:y.type,components:R,offset:E}}),size:s1(h,Math.max(p,l)),alignment:l}}function s1(d,l){return Math.ceil(d/l)*l}class jl extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h){const p=this.length;return this.resize(p+1),this.emplace(p,l,h)}emplace(l,h,p){const y=2*l;return this.int16[y+0]=h,this.int16[y+1]=p,l}}jl.prototype.bytesPerElement=4,xn("StructArrayLayout2i4",jl);class Hl extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,l,h,p)}emplace(l,h,p,y){const S=3*l;return this.int16[S+0]=h,this.int16[S+1]=p,this.int16[S+2]=y,l}}Hl.prototype.bytesPerElement=6,xn("StructArrayLayout3i6",Hl);class Bv extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,p,y)}emplace(l,h,p,y,S){const E=4*l;return this.int16[E+0]=h,this.int16[E+1]=p,this.int16[E+2]=y,this.int16[E+3]=S,l}}Bv.prototype.bytesPerElement=8,xn("StructArrayLayout4i8",Bv);class Pp extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,E){const R=this.length;return this.resize(R+1),this.emplace(R,l,h,p,y,S,E)}emplace(l,h,p,y,S,E,R){const O=6*l;return this.int16[O+0]=h,this.int16[O+1]=p,this.int16[O+2]=y,this.int16[O+3]=S,this.int16[O+4]=E,this.int16[O+5]=R,l}}Pp.prototype.bytesPerElement=12,xn("StructArrayLayout2i4i12",Pp);class Oc extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,E){const R=this.length;return this.resize(R+1),this.emplace(R,l,h,p,y,S,E)}emplace(l,h,p,y,S,E,R){const O=4*l,B=8*l;return this.int16[O+0]=h,this.int16[O+1]=p,this.uint8[B+4]=y,this.uint8[B+5]=S,this.uint8[B+6]=E,this.uint8[B+7]=R,l}}Oc.prototype.bytesPerElement=8,xn("StructArrayLayout2i4ub8",Oc);class Nd extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h){const p=this.length;return this.resize(p+1),this.emplace(p,l,h)}emplace(l,h,p){const y=2*l;return this.float32[y+0]=h,this.float32[y+1]=p,l}}Nd.prototype.bytesPerElement=8,xn("StructArrayLayout2f8",Nd);class Uv extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,E,R,O,B,G){const X=this.length;return this.resize(X+1),this.emplace(X,l,h,p,y,S,E,R,O,B,G)}emplace(l,h,p,y,S,E,R,O,B,G,X){const ie=10*l;return this.uint16[ie+0]=h,this.uint16[ie+1]=p,this.uint16[ie+2]=y,this.uint16[ie+3]=S,this.uint16[ie+4]=E,this.uint16[ie+5]=R,this.uint16[ie+6]=O,this.uint16[ie+7]=B,this.uint16[ie+8]=G,this.uint16[ie+9]=X,l}}Uv.prototype.bytesPerElement=20,xn("StructArrayLayout10ui20",Uv);class Ap extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,E,R,O,B,G,X,ie){const ae=this.length;return this.resize(ae+1),this.emplace(ae,l,h,p,y,S,E,R,O,B,G,X,ie)}emplace(l,h,p,y,S,E,R,O,B,G,X,ie,ae){const ce=12*l;return this.int16[ce+0]=h,this.int16[ce+1]=p,this.int16[ce+2]=y,this.int16[ce+3]=S,this.uint16[ce+4]=E,this.uint16[ce+5]=R,this.uint16[ce+6]=O,this.uint16[ce+7]=B,this.int16[ce+8]=G,this.int16[ce+9]=X,this.int16[ce+10]=ie,this.int16[ce+11]=ae,l}}Ap.prototype.bytesPerElement=24,xn("StructArrayLayout4i4ui4i24",Ap);class $v extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,l,h,p)}emplace(l,h,p,y){const S=3*l;return this.float32[S+0]=h,this.float32[S+1]=p,this.float32[S+2]=y,l}}$v.prototype.bytesPerElement=12,xn("StructArrayLayout3f12",$v);class b extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint32[1*l+0]=h,l}}b.prototype.bytesPerElement=4,xn("StructArrayLayout1ul4",b);class s extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,E,R,O,B){const G=this.length;return this.resize(G+1),this.emplace(G,l,h,p,y,S,E,R,O,B)}emplace(l,h,p,y,S,E,R,O,B,G){const X=10*l,ie=5*l;return this.int16[X+0]=h,this.int16[X+1]=p,this.int16[X+2]=y,this.int16[X+3]=S,this.int16[X+4]=E,this.int16[X+5]=R,this.uint32[ie+3]=O,this.uint16[X+8]=B,this.uint16[X+9]=G,l}}s.prototype.bytesPerElement=20,xn("StructArrayLayout6i1ul2ui20",s);class u extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,E){const R=this.length;return this.resize(R+1),this.emplace(R,l,h,p,y,S,E)}emplace(l,h,p,y,S,E,R){const O=6*l;return this.int16[O+0]=h,this.int16[O+1]=p,this.int16[O+2]=y,this.int16[O+3]=S,this.int16[O+4]=E,this.int16[O+5]=R,l}}u.prototype.bytesPerElement=12,xn("StructArrayLayout2i2i2i12",u);class m extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S){const E=this.length;return this.resize(E+1),this.emplace(E,l,h,p,y,S)}emplace(l,h,p,y,S,E){const R=4*l,O=8*l;return this.float32[R+0]=h,this.float32[R+1]=p,this.float32[R+2]=y,this.int16[O+6]=S,this.int16[O+7]=E,l}}m.prototype.bytesPerElement=16,xn("StructArrayLayout2f1f2i16",m);class v extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,E){const R=this.length;return this.resize(R+1),this.emplace(R,l,h,p,y,S,E)}emplace(l,h,p,y,S,E,R){const O=16*l,B=4*l,G=8*l;return this.uint8[O+0]=h,this.uint8[O+1]=p,this.float32[B+1]=y,this.float32[B+2]=S,this.int16[G+6]=E,this.int16[G+7]=R,l}}v.prototype.bytesPerElement=16,xn("StructArrayLayout2ub2f2i16",v);class w extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,l,h,p)}emplace(l,h,p,y){const S=3*l;return this.uint16[S+0]=h,this.uint16[S+1]=p,this.uint16[S+2]=y,l}}w.prototype.bytesPerElement=6,xn("StructArrayLayout3ui6",w);class P extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,E,R,O,B,G,X,ie,ae,ce,de,Ce,ke){const et=this.length;return this.resize(et+1),this.emplace(et,l,h,p,y,S,E,R,O,B,G,X,ie,ae,ce,de,Ce,ke)}emplace(l,h,p,y,S,E,R,O,B,G,X,ie,ae,ce,de,Ce,ke,et){const Ge=24*l,se=12*l,we=48*l;return this.int16[Ge+0]=h,this.int16[Ge+1]=p,this.uint16[Ge+2]=y,this.uint16[Ge+3]=S,this.uint32[se+2]=E,this.uint32[se+3]=R,this.uint32[se+4]=O,this.uint16[Ge+10]=B,this.uint16[Ge+11]=G,this.uint16[Ge+12]=X,this.float32[se+7]=ie,this.float32[se+8]=ae,this.uint8[we+36]=ce,this.uint8[we+37]=de,this.uint8[we+38]=Ce,this.uint32[se+10]=ke,this.int16[Ge+22]=et,l}}P.prototype.bytesPerElement=48,xn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",P);class D extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,E,R,O,B,G,X,ie,ae,ce,de,Ce,ke,et,Ge,se,we,Xe,mt,$t,bt,Mt,Jt,jt){const en=this.length;return this.resize(en+1),this.emplace(en,l,h,p,y,S,E,R,O,B,G,X,ie,ae,ce,de,Ce,ke,et,Ge,se,we,Xe,mt,$t,bt,Mt,Jt,jt)}emplace(l,h,p,y,S,E,R,O,B,G,X,ie,ae,ce,de,Ce,ke,et,Ge,se,we,Xe,mt,$t,bt,Mt,Jt,jt,en){const Pt=32*l,Cn=16*l;return this.int16[Pt+0]=h,this.int16[Pt+1]=p,this.int16[Pt+2]=y,this.int16[Pt+3]=S,this.int16[Pt+4]=E,this.int16[Pt+5]=R,this.int16[Pt+6]=O,this.int16[Pt+7]=B,this.uint16[Pt+8]=G,this.uint16[Pt+9]=X,this.uint16[Pt+10]=ie,this.uint16[Pt+11]=ae,this.uint16[Pt+12]=ce,this.uint16[Pt+13]=de,this.uint16[Pt+14]=Ce,this.uint16[Pt+15]=ke,this.uint16[Pt+16]=et,this.uint16[Pt+17]=Ge,this.uint16[Pt+18]=se,this.uint16[Pt+19]=we,this.uint16[Pt+20]=Xe,this.uint16[Pt+21]=mt,this.uint16[Pt+22]=$t,this.uint32[Cn+12]=bt,this.float32[Cn+13]=Mt,this.float32[Cn+14]=Jt,this.uint16[Pt+30]=jt,this.uint16[Pt+31]=en,l}}D.prototype.bytesPerElement=64,xn("StructArrayLayout8i15ui1ul2f2ui64",D);class F extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.float32[1*l+0]=h,l}}F.prototype.bytesPerElement=4,xn("StructArrayLayout1f4",F);class j extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,l,h,p)}emplace(l,h,p,y){const S=3*l;return this.uint16[6*l+0]=h,this.float32[S+1]=p,this.float32[S+2]=y,l}}j.prototype.bytesPerElement=12,xn("StructArrayLayout1ui2f12",j);class W extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,l,h,p)}emplace(l,h,p,y){const S=4*l;return this.uint32[2*l+0]=h,this.uint16[S+2]=p,this.uint16[S+3]=y,l}}W.prototype.bytesPerElement=8,xn("StructArrayLayout1ul2ui8",W);class Q extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h){const p=this.length;return this.resize(p+1),this.emplace(p,l,h)}emplace(l,h,p){const y=2*l;return this.uint16[y+0]=h,this.uint16[y+1]=p,l}}Q.prototype.bytesPerElement=4,xn("StructArrayLayout2ui4",Q);class K extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint16[1*l+0]=h,l}}K.prototype.bytesPerElement=2,xn("StructArrayLayout1ui2",K);class oe extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,p,y){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,p,y)}emplace(l,h,p,y,S){const E=4*l;return this.float32[E+0]=h,this.float32[E+1]=p,this.float32[E+2]=y,this.float32[E+3]=S,l}}oe.prototype.bytesPerElement=16,xn("StructArrayLayout4f16",oe);class he extends zc{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new A(this.anchorPointX,this.anchorPointY)}}he.prototype.size=20;class Pe extends s{get(l){return new he(this,l)}}xn("CollisionBoxArray",Pe);class Ee extends zc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(l){this._structArray.uint8[this._pos1+37]=l}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(l){this._structArray.uint8[this._pos1+38]=l}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(l){this._structArray.uint32[this._pos4+10]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ee.prototype.size=48;class Ie extends P{get(l){return new Ee(this,l)}}xn("PlacedSymbolArray",Ie);class Fe extends zc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(l){this._structArray.uint32[this._pos4+12]=l}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Fe.prototype.size=64;class He extends D{get(l){return new Fe(this,l)}}xn("SymbolInstanceArray",He);class Be extends F{getoffsetX(l){return this.float32[1*l+0]}}xn("GlyphOffsetArray",Be);class Ye extends Hl{getx(l){return this.int16[3*l+0]}gety(l){return this.int16[3*l+1]}gettileUnitDistanceFromAnchor(l){return this.int16[3*l+2]}}xn("SymbolLineVertexArray",Ye);class Ke extends zc{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ke.prototype.size=12;class $e extends j{get(l){return new Ke(this,l)}}xn("TextAnchorOffsetArray",$e);class rt extends zc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}rt.prototype.size=8;class yt extends W{get(l){return new rt(this,l)}}xn("FeatureIndexArray",yt);class ht extends jl{}class pt extends jl{}class _t extends jl{}class sn extends Pp{}class rn extends Oc{}class Vt extends Nd{}class Mn extends Uv{}class Jn extends Ap{}class Cr extends $v{}class ni extends b{}class Ar extends u{}class ri extends v{}class zr extends w{}class Ir extends Q{}const Or=li([{name:"a_pos",components:2,type:"Int16"}],4),{members:no}=Or;class hr{constructor(l=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=l}prepareSegment(l,h,p,y){const S=this.segments[this.segments.length-1];return l>hr.MAX_VERTEX_ARRAY_LENGTH&&tn(`Max vertices per segment is ${hr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${hr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!S||S.vertexLength+l>hr.MAX_VERTEX_ARRAY_LENGTH||S.sortKey!==y?this.createNewSegment(h,p,y):S}createNewSegment(l,h,p){const y={vertexOffset:l.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0,vaos:{}};return p!==void 0&&(y.sortKey=p),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(y),y}getOrCreateLatestSegment(l,h,p){return this.prepareSegment(0,l,h,p)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const l of this.segments)for(const h in l.vaos)l.vaos[h].destroy()}static simpleSegment(l,h,p,y){return new hr([{vertexOffset:l,primitiveOffset:h,vertexLength:p,primitiveLength:y,vaos:{},sortKey:0}])}}function Gi(d,l){return 256*(d=Tt(Math.floor(d),0,255))+Tt(Math.floor(l),0,255)}hr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,xn("SegmentVector",hr);const ro=li([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Gl,Wl,ql,za={exports:{}},Bd={exports:{}},Ud={exports:{}},Xu=function(){if(ql)return za.exports;ql=1;var d=(Gl||(Gl=1,Bd.exports=function(h,p){var y,S,E,R,O,B,G,X;for(S=h.length-(y=3&h.length),E=p,O=3432918353,B=461845907,X=0;X<S;)G=255&h.charCodeAt(X)|(255&h.charCodeAt(++X))<<8|(255&h.charCodeAt(++X))<<16|(255&h.charCodeAt(++X))<<24,++X,E=27492+(65535&(R=5*(65535&(E=(E^=G=(65535&(G=(G=(65535&G)*O+(((G>>>16)*O&65535)<<16)&4294967295)<<15|G>>>17))*B+(((G>>>16)*B&65535)<<16)&4294967295)<<13|E>>>19))+((5*(E>>>16)&65535)<<16)&4294967295))+((58964+(R>>>16)&65535)<<16);switch(G=0,y){case 3:G^=(255&h.charCodeAt(X+2))<<16;case 2:G^=(255&h.charCodeAt(X+1))<<8;case 1:E^=G=(65535&(G=(G=(65535&(G^=255&h.charCodeAt(X)))*O+(((G>>>16)*O&65535)<<16)&4294967295)<<15|G>>>17))*B+(((G>>>16)*B&65535)<<16)&4294967295}return E^=h.length,E=2246822507*(65535&(E^=E>>>16))+((2246822507*(E>>>16)&65535)<<16)&4294967295,E=3266489909*(65535&(E^=E>>>13))+((3266489909*(E>>>16)&65535)<<16)&4294967295,(E^=E>>>16)>>>0}),Bd.exports),l=(Wl||(Wl=1,Ud.exports=function(h,p){for(var y,S=h.length,E=p^S,R=0;S>=4;)y=1540483477*(65535&(y=255&h.charCodeAt(R)|(255&h.charCodeAt(++R))<<8|(255&h.charCodeAt(++R))<<16|(255&h.charCodeAt(++R))<<24))+((1540483477*(y>>>16)&65535)<<16),E=1540483477*(65535&E)+((1540483477*(E>>>16)&65535)<<16)^(y=1540483477*(65535&(y^=y>>>24))+((1540483477*(y>>>16)&65535)<<16)),S-=4,++R;switch(S){case 3:E^=(255&h.charCodeAt(R+2))<<16;case 2:E^=(255&h.charCodeAt(R+1))<<8;case 1:E=1540483477*(65535&(E^=255&h.charCodeAt(R)))+((1540483477*(E>>>16)&65535)<<16)}return E=1540483477*(65535&(E^=E>>>13))+((1540483477*(E>>>16)&65535)<<16),(E^=E>>>15)>>>0}),Ud.exports);return za.exports=d,za.exports.murmur3=d,za.exports.murmur2=l,za.exports}(),Qo=f(Xu);class ea{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,h,p,y){this.ids.push(Xl(l)),this.positions.push(h,p,y)}getPositions(l){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=Xl(l);let p=0,y=this.ids.length-1;for(;p<y;){const E=p+y>>1;this.ids[E]>=h?y=E:p=E+1}const S=[];for(;this.ids[p]===h;)S.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return S}static serialize(l,h){const p=new Float64Array(l.ids),y=new Uint32Array(l.positions);return Fc(p,y,0,p.length-1),h&&h.push(p.buffer,y.buffer),{ids:p,positions:y}}static deserialize(l){const h=new ea;return h.ids=l.ids,h.positions=l.positions,h.indexed=!0,h}}function Xl(d){const l=+d;return!isNaN(l)&&l<=Number.MAX_SAFE_INTEGER?l:Qo(String(d))}function Fc(d,l,h,p){for(;h<p;){const y=d[h+p>>1];let S=h-1,E=p+1;for(;;){do S++;while(d[S]<y);do E--;while(d[E]>y);if(S>=E)break;di(d,S,E),di(l,3*S,3*E),di(l,3*S+1,3*E+1),di(l,3*S+2,3*E+2)}E-h<p-E?(Fc(d,l,h,E),h=E+1):(Fc(d,l,E+1,p),p=E)}}function di(d,l,h){const p=d[l];d[l]=d[h],d[h]=p}xn("FeaturePositionMap",ea);class Gr{constructor(l,h){this.gl=l.gl,this.location=h}}class zo extends Gr{constructor(l,h){super(l,h),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class Li extends Gr{constructor(l,h){super(l,h),this.current=[0,0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))}}class a1 extends Gr{constructor(l,h){super(l,h),this.current=tr.transparent}set(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))}}const Q2=new Float32Array(16);function Vv(d){return[Gi(255*d.r,255*d.g),Gi(255*d.b,255*d.a)]}class $d{constructor(l,h,p){this.value=l,this.uniformNames=h.map(y=>`u_${y}`),this.type=p}setUniform(l,h,p){l.set(p.constantOr(this.value))}getBinding(l,h,p){return this.type==="color"?new a1(l,h):new zo(l,h)}}class Zu{constructor(l,h){this.uniformNames=h.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(l,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=l.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=l.tlbr}setUniform(l,h,p,y){const S=y==="u_pattern_to"?this.patternTo:y==="u_pattern_from"?this.patternFrom:y==="u_pixel_ratio_to"?this.pixelRatioTo:y==="u_pixel_ratio_from"?this.pixelRatioFrom:null;S&&l.set(S)}getBinding(l,h,p){return p.substr(0,9)==="u_pattern"?new Li(l,h):new zo(l,h)}}class cl{constructor(l,h,p,y){this.expression=l,this.type=p,this.maxValue=0,this.paintVertexAttributes=h.map(S=>({name:`a_${S}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(l,h,p,y,S){const E=this.paintVertexArray.length,R=this.expression.evaluate(new Zr(0),h,{},y,[],S);this.paintVertexArray.resize(l),this._setPaintValue(E,l,R)}updatePaintArray(l,h,p,y){const S=this.expression.evaluate({zoom:0},p,y);this._setPaintValue(l,h,S)}_setPaintValue(l,h,p){if(this.type==="color"){const y=Vv(p);for(let S=l;S<h;S++)this.paintVertexArray.emplace(S,y[0],y[1])}else{for(let y=l;y<h;y++)this.paintVertexArray.emplace(y,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class io{constructor(l,h,p,y,S,E){this.expression=l,this.uniformNames=h.map(R=>`u_${R}_t`),this.type=p,this.useIntegerZoom=y,this.zoom=S,this.maxValue=0,this.paintVertexAttributes=h.map(R=>({name:`a_${R}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(l,h,p,y,S){const E=this.expression.evaluate(new Zr(this.zoom),h,{},y,[],S),R=this.expression.evaluate(new Zr(this.zoom+1),h,{},y,[],S),O=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(O,l,E,R)}updatePaintArray(l,h,p,y){const S=this.expression.evaluate({zoom:this.zoom},p,y),E=this.expression.evaluate({zoom:this.zoom+1},p,y);this._setPaintValue(l,h,S,E)}_setPaintValue(l,h,p,y){if(this.type==="color"){const S=Vv(p),E=Vv(y);for(let R=l;R<h;R++)this.paintVertexArray.emplace(R,S[0],S[1],E[0],E[1])}else{for(let S=l;S<h;S++)this.paintVertexArray.emplace(S,p,y);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(y))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,h){const p=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,y=Tt(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);l.set(y)}getBinding(l,h,p){return new zo(l,h)}}class ul{constructor(l,h,p,y,S,E){this.expression=l,this.type=h,this.useIntegerZoom=p,this.zoom=y,this.layerId=E,this.zoomInPaintVertexArray=new S,this.zoomOutPaintVertexArray=new S}populatePaintArray(l,h,p){const y=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(l),this.zoomOutPaintVertexArray.resize(l),this._setPaintValues(y,l,h.patterns&&h.patterns[this.layerId],p)}updatePaintArray(l,h,p,y,S){this._setPaintValues(l,h,p.patterns&&p.patterns[this.layerId],S)}_setPaintValues(l,h,p,y){if(!y||!p)return;const{min:S,mid:E,max:R}=p,O=y[S],B=y[E],G=y[R];if(O&&B&&G)for(let X=l;X<h;X++)this.zoomInPaintVertexArray.emplace(X,B.tl[0],B.tl[1],B.br[0],B.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],B.pixelRatio,O.pixelRatio),this.zoomOutPaintVertexArray.emplace(X,B.tl[0],B.tl[1],B.br[0],B.br[1],G.tl[0],G.tl[1],G.br[0],G.br[1],B.pixelRatio,G.pixelRatio)}upload(l){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=l.createVertexBuffer(this.zoomInPaintVertexArray,ro.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=l.createVertexBuffer(this.zoomOutPaintVertexArray,ro.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class jv{constructor(l,h,p){this.binders={},this._buffers=[];const y=[];for(const S in l.paint._values){if(!p(S))continue;const E=l.paint.get(S);if(!(E instanceof Da&&Ou(E.property.specification)))continue;const R=Hv(S,l.type),O=E.value,B=E.property.specification.type,G=E.property.useIntegerZoom,X=E.property.specification["property-type"],ie=X==="cross-faded"||X==="cross-faded-data-driven";if(O.kind==="constant")this.binders[S]=ie?new Zu(O.value,R):new $d(O.value,R,B),y.push(`/u_${S}`);else if(O.kind==="source"||ie){const ae=Gv(S,B,"source");this.binders[S]=ie?new ul(O,B,G,h,ae,l.id):new cl(O,R,B,ae),y.push(`/a_${S}`)}else{const ae=Gv(S,B,"composite");this.binders[S]=new io(O,R,B,G,h,ae),y.push(`/z_${S}`)}}this.cacheKey=y.sort().join("")}getMaxValue(l){const h=this.binders[l];return h instanceof cl||h instanceof io?h.maxValue:0}populatePaintArrays(l,h,p,y,S){for(const E in this.binders){const R=this.binders[E];(R instanceof cl||R instanceof io||R instanceof ul)&&R.populatePaintArray(l,h,p,y,S)}}setConstantPatternPositions(l,h){for(const p in this.binders){const y=this.binders[p];y instanceof Zu&&y.setConstantPatternPositions(l,h)}}updatePaintArrays(l,h,p,y,S){let E=!1;for(const R in l){const O=h.getPositions(R);for(const B of O){const G=p.feature(B.index);for(const X in this.binders){const ie=this.binders[X];if((ie instanceof cl||ie instanceof io||ie instanceof ul)&&ie.expression.isStateDependent===!0){const ae=y.paint.get(X);ie.expression=ae.value,ie.updatePaintArray(B.start,B.end,G,l[R],S),E=!0}}}}return E}defines(){const l=[];for(const h in this.binders){const p=this.binders[h];(p instanceof $d||p instanceof Zu)&&l.push(...p.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return l}getBinderAttributes(){const l=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof cl||p instanceof io)for(let y=0;y<p.paintVertexAttributes.length;y++)l.push(p.paintVertexAttributes[y].name);else if(p instanceof ul)for(let y=0;y<ro.members.length;y++)l.push(ro.members[y].name)}return l}getBinderUniforms(){const l=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof $d||p instanceof Zu||p instanceof io)for(const y of p.uniformNames)l.push(y)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l,h){const p=[];for(const y in this.binders){const S=this.binders[y];if(S instanceof $d||S instanceof Zu||S instanceof io){for(const E of S.uniformNames)if(h[E]){const R=S.getBinding(l,h[E],E);p.push({name:E,property:y,binding:R})}}}return p}setUniforms(l,h,p,y){for(const{name:S,property:E,binding:R}of h)this.binders[E].setUniform(R,y,p.get(E),S)}updatePaintBuffers(l){this._buffers=[];for(const h in this.binders){const p=this.binders[h];if(l&&p instanceof ul){const y=l.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;y&&this._buffers.push(y)}else(p instanceof cl||p instanceof io)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(l){for(const h in this.binders){const p=this.binders[h];(p instanceof cl||p instanceof io||p instanceof ul)&&p.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const h=this.binders[l];(h instanceof cl||h instanceof io||h instanceof ul)&&h.destroy()}}}class Zl{constructor(l,h,p=()=>!0){this.programConfigurations={};for(const y of l)this.programConfigurations[y.id]=new jv(y,h,p);this.needsUpload=!1,this._featureMap=new ea,this._bufferOffset=0}populatePaintArrays(l,h,p,y,S,E){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(l,h,y,S,E);h.id!==void 0&&this._featureMap.add(h.id,p,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,h,p,y){for(const S of p)this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(l,this._featureMap,h,S,y)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}function Hv(d,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[d]||[d.replace(`${l}-`,"").replace(/-/g,"_")]}function Gv(d,l,h){const p={color:{source:Nd,composite:oe},number:{source:F,composite:Nd}},y=function(S){return{"line-pattern":{source:Mn,composite:Mn},"fill-pattern":{source:Mn,composite:Mn},"fill-extrusion-pattern":{source:Mn,composite:Mn}}[S]}(d);return y&&y[h]||p[l][h]}xn("ConstantBinder",$d),xn("CrossFadedConstantBinder",Zu),xn("SourceExpressionBinder",cl),xn("CrossFadedCompositeBinder",ul),xn("CompositeExpressionBinder",io),xn("ProgramConfiguration",jv,{omit:["_buffers"]}),xn("ProgramConfigurationSet",Zl);const Vd=Math.pow(2,14)-1,vk=-Vd-1;function jd(d){const l=ct/d.extent,h=d.loadGeometry();for(let p=0;p<h.length;p++){const y=h[p];for(let S=0;S<y.length;S++){const E=y[S],R=Math.round(E.x*l),O=Math.round(E.y*l);E.x=Tt(R,vk,Vd),E.y=Tt(O,vk,Vd),(R<E.x||R>E.x+1||O<E.y||O>E.y+1)&&tn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Hd(d,l){return{type:d.type,id:d.id,properties:d.properties,geometry:l?jd(d):[]}}const yk=-32768;function XW(d,l,h,p,y){d.emplaceBack(yk+8*l+p,yk+8*h+y)}class eC{constructor(l){this.zoom=l.zoom,this.globalState=l.globalState,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.layoutVertexArray=new pt,this.indexArray=new zr,this.segments=new hr,this.programConfigurations=new Zl(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,p){const y=this.layers[0],S=[];let E=null,R=!1,O=y.type==="heatmap";if(y.type==="circle"){const G=y;E=G.layout.get("circle-sort-key"),R=!E.isConstant(),O=O||G.paint.get("circle-pitch-alignment")==="map"}const B=O?h.subdivisionGranularity.circle:1;for(const{feature:G,id:X,index:ie,sourceLayerIndex:ae}of l){const ce=this.layers[0]._featureFilter.needGeometry,de=Hd(G,ce);if(!this.layers[0]._featureFilter.filter(new Zr(this.zoom,{globalState:this.globalState}),de,p))continue;const Ce=R?E.evaluate(de,{},p):void 0,ke={id:X,properties:G.properties,type:G.type,sourceLayerIndex:ae,index:ie,geometry:ce?de.geometry:jd(G),patterns:{},sortKey:Ce};S.push(ke)}R&&S.sort((G,X)=>G.sortKey-X.sortKey);for(const G of S){const{geometry:X,index:ie,sourceLayerIndex:ae}=G,ce=l[ie].feature;this.addFeature(G,X,ie,p,B),h.featureIndex.insert(ce,X,ie,ae,this.index)}}update(l,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,no),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,h,p,y,S=1){let E;switch(S){case 1:E=[0,7];break;case 3:E=[0,2,5,7];break;case 5:E=[0,1,3,4,6,7];break;case 7:E=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${S}; valid values are 1, 3, 5, 7.`)}const R=E.length;for(const O of h)for(const B of O){const G=B.x,X=B.y;if(G<0||G>=ct||X<0||X>=ct)continue;const ie=this.segments.prepareSegment(R*R,this.layoutVertexArray,this.indexArray,l.sortKey),ae=ie.vertexLength;for(let ce=0;ce<R;ce++)for(let de=0;de<R;de++)XW(this.layoutVertexArray,G,X,E[de],E[ce]);for(let ce=0;ce<R-1;ce++)for(let de=0;de<R-1;de++){const Ce=ae+ce*R+de,ke=ae+(ce+1)*R+de;this.indexArray.emplaceBack(Ce,ke+1,Ce+1),this.indexArray.emplaceBack(Ce,ke,ke+1)}ie.vertexLength+=R*R,ie.primitiveLength+=(R-1)*(R-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,{},y)}}function _k(d,l){for(let h=0;h<d.length;h++)if(Ip(l,d[h]))return!0;for(let h=0;h<l.length;h++)if(Ip(d,l[h]))return!0;return!!tC(d,l)}function ZW(d,l,h){return!!Ip(d,l)||!!nC(l,d,h)}function xk(d,l){if(d.length===1)return wk(l,d[0]);for(let h=0;h<l.length;h++){const p=l[h];for(let y=0;y<p.length;y++)if(Ip(d,p[y]))return!0}for(let h=0;h<d.length;h++)if(wk(l,d[h]))return!0;for(let h=0;h<l.length;h++)if(tC(d,l[h]))return!0;return!1}function YW(d,l,h){if(d.length>1){if(tC(d,l))return!0;for(let p=0;p<l.length;p++)if(nC(l[p],d,h))return!0}for(let p=0;p<d.length;p++)if(nC(d[p],l,h))return!0;return!1}function tC(d,l){if(d.length===0||l.length===0)return!1;for(let h=0;h<d.length-1;h++){const p=d[h],y=d[h+1];for(let S=0;S<l.length-1;S++)if(KW(p,y,l[S],l[S+1]))return!0}return!1}function KW(d,l,h,p){return Dt(d,h,p)!==Dt(l,h,p)&&Dt(d,l,h)!==Dt(d,l,p)}function nC(d,l,h){const p=h*h;if(l.length===1)return d.distSqr(l[0])<p;for(let y=1;y<l.length;y++)if(bk(d,l[y-1],l[y])<p)return!0;return!1}function bk(d,l,h){const p=l.distSqr(h);if(p===0)return d.distSqr(l);const y=((d.x-l.x)*(h.x-l.x)+(d.y-l.y)*(h.y-l.y))/p;return d.distSqr(y<0?l:y>1?h:h.sub(l)._mult(y)._add(l))}function wk(d,l){let h,p,y,S=!1;for(let E=0;E<d.length;E++){h=d[E];for(let R=0,O=h.length-1;R<h.length;O=R++)p=h[R],y=h[O],p.y>l.y!=y.y>l.y&&l.x<(y.x-p.x)*(l.y-p.y)/(y.y-p.y)+p.x&&(S=!S)}return S}function Ip(d,l){let h=!1;for(let p=0,y=d.length-1;p<d.length;y=p++){const S=d[p],E=d[y];S.y>l.y!=E.y>l.y&&l.x<(E.x-S.x)*(l.y-S.y)/(E.y-S.y)+S.x&&(h=!h)}return h}function JW(d,l,h){const p=h[0],y=h[2];if(d.x<p.x&&l.x<p.x||d.x>y.x&&l.x>y.x||d.y<p.y&&l.y<p.y||d.y>y.y&&l.y>y.y)return!1;const S=Dt(d,l,h[0]);return S!==Dt(d,l,h[1])||S!==Dt(d,l,h[2])||S!==Dt(d,l,h[3])}function Wv(d,l,h){const p=l.paint.get(d).value;return p.kind==="constant"?p.value:h.programConfigurations.get(l.id).getMaxValue(d)}function l1(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function c1(d,l,h,p,y){if(!l[0]&&!l[1])return d;const S=A.convert(l)._mult(y);h==="viewport"&&S._rotate(-p);const E=[];for(let R=0;R<d.length;R++)E.push(d[R].sub(S));return E}let Sk,Mk;xn("CircleBucket",eC,{omit:["layers"]});var QW={get paint(){return Mk=Mk||new Do({"circle-radius":new Vn(Oe.paint_circle["circle-radius"]),"circle-color":new Vn(Oe.paint_circle["circle-color"]),"circle-blur":new Vn(Oe.paint_circle["circle-blur"]),"circle-opacity":new Vn(Oe.paint_circle["circle-opacity"]),"circle-translate":new En(Oe.paint_circle["circle-translate"]),"circle-translate-anchor":new En(Oe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new En(Oe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new En(Oe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Vn(Oe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Vn(Oe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Vn(Oe.paint_circle["circle-stroke-opacity"])})},get layout(){return Sk=Sk||new Do({"circle-sort-key":new Vn(Oe.layout_circle["circle-sort-key"])})}};class eq extends to{constructor(l){super(l,QW)}createBucket(l){return new eC(l)}queryRadius(l){const h=l;return Wv("circle-radius",this,h)+Wv("circle-stroke-width",this,h)+l1(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:p,geometry:y,transform:S,pixelsToTileUnits:E,unwrappedTileID:R,getElevation:O}){const B=c1(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-S.bearingInRadians,E),G=this.paint.get("circle-radius").evaluate(h,p)+this.paint.get("circle-stroke-width").evaluate(h,p),X=this.paint.get("circle-pitch-alignment")==="map",ie=X?B:function(ce,de,Ce,ke){return ce.map(et=>Ck(et,de,Ce,ke))}(B,S,R,O),ae=X?G*E:G;for(const ce of y)for(const de of ce){const Ce=X?de:Ck(de,S,R,O);let ke=ae;const et=S.projectTileCoordinates(de.x,de.y,R,O).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ke*=et/S.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ke*=S.cameraToCenterDistance/et),ZW(ie,Ce,ke))return!0}return!1}}function Ck(d,l,h,p){const y=l.projectTileCoordinates(d.x,d.y,h,p).point;return new A((.5*y.x+.5)*l.width,(.5*-y.y+.5)*l.height)}class Ek extends eC{}let Tk;xn("HeatmapBucket",Ek,{omit:["layers"]});var tq={get paint(){return Tk=Tk||new Do({"heatmap-radius":new Vn(Oe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Vn(Oe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new En(Oe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Fd(Oe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new En(Oe.paint_heatmap["heatmap-opacity"])})}};function rC(d,{width:l,height:h},p,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==l*h*p)throw new RangeError(`mismatched image size. expected: ${y.length} but got: ${l*h*p}`)}else y=new Uint8Array(l*h*p);return d.width=l,d.height=h,d.data=y,d}function Pk(d,{width:l,height:h},p){if(l===d.width&&h===d.height)return;const y=rC({},{width:l,height:h},p);iC(d,y,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,l),height:Math.min(d.height,h)},p),d.width=l,d.height=h,d.data=y.data}function iC(d,l,h,p,y,S){if(y.width===0||y.height===0)return l;if(y.width>d.width||y.height>d.height||h.x>d.width-y.width||h.y>d.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>l.width||y.height>l.height||p.x>l.width-y.width||p.y>l.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const E=d.data,R=l.data;if(E===R)throw new Error("srcData equals dstData, so image is already copied");for(let O=0;O<y.height;O++){const B=((h.y+O)*d.width+h.x)*S,G=((p.y+O)*l.width+p.x)*S;for(let X=0;X<y.width*S;X++)R[G+X]=E[B+X]}return l}class qv{constructor(l,h){rC(this,l,1,h)}resize(l){Pk(this,l,1)}clone(){return new qv({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,p,y,S){iC(l,h,p,y,S,1)}}class ds{constructor(l,h){rC(this,l,4,h)}resize(l){Pk(this,l,4)}replace(l,h){h?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new ds({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,p,y,S){iC(l,h,p,y,S,4)}setPixel(l,h,p){const y=4*(l*this.width+h);this.data[y+0]=Math.round(255*p.r/p.a),this.data[y+1]=Math.round(255*p.g/p.a),this.data[y+2]=Math.round(255*p.b/p.a),this.data[y+3]=Math.round(255*p.a)}}function Ak(d){const l={},h=d.resolution||256,p=d.clips?d.clips.length:1,y=d.image||new ds({width:h,height:p});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const S=(E,R,O)=>{l[d.evaluationKey]=O;const B=d.expression.evaluate(l);y.setPixel(E/4/h,R/4,B)};if(d.clips)for(let E=0,R=0;E<p;++E,R+=4*h)for(let O=0,B=0;O<h;O++,B+=4){const G=O/(h-1),{start:X,end:ie}=d.clips[E];S(R,B,X*(1-G)+ie*G)}else for(let E=0,R=0;E<h;E++,R+=4)S(0,R,E/(h-1));return y}xn("AlphaImage",qv),xn("RGBAImage",ds);const oC="big-fb";class nq extends to{createBucket(l){return new Ek(l)}constructor(l){super(l,tq),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ak({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(oC)&&this.heatmapFbos.delete(oC)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Ik;var rq={get paint(){return Ik=Ik||new Do({"hillshade-illumination-direction":new En(Oe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new En(Oe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new En(Oe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new En(Oe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new En(Oe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new En(Oe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new En(Oe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new En(Oe.paint_hillshade["hillshade-method"])})}};class iq extends to{constructor(l){super(l,rq),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let l=this.paint.get("hillshade-illumination-direction").values,h=this.paint.get("hillshade-illumination-altitude").values,p=this.paint.get("hillshade-highlight-color").values,y=this.paint.get("hillshade-shadow-color").values;const S=Math.max(l.length,h.length,p.length,y.length);l=l.concat(Array(S-l.length).fill(l.at(-1))),h=h.concat(Array(S-h.length).fill(h.at(-1))),p=p.concat(Array(S-p.length).fill(p.at(-1))),y=y.concat(Array(S-y.length).fill(y.at(-1)));const E=h.map(Zt);return{directionRadians:l.map(Zt),altitudeRadians:E,shadowColor:y,highlightColor:p}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Rk;var oq={get paint(){return Rk=Rk||new Do({"color-relief-opacity":new En(Oe["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Fd(Oe["paint_color-relief"]["color-relief-color"])})}};class sC{constructor(l,h,p,y){this.context=l,this.format=p,this.texture=l.gl.createTexture(),this.update(h,y)}update(l,h,p){const{width:y,height:S}=l,E=!(this.size&&this.size[0]===y&&this.size[1]===S||p),{context:R}=this,{gl:O}=R;if(this.useMipmap=!!(h&&h.useMipmap),O.bindTexture(O.TEXTURE_2D,this.texture),R.pixelStoreUnpackFlipY.set(!1),R.pixelStoreUnpack.set(1),R.pixelStoreUnpackPremultiplyAlpha.set(this.format===O.RGBA&&(!h||h.premultiply!==!1)),E)this.size=[y,S],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||Le(l)?O.texImage2D(O.TEXTURE_2D,0,this.format,this.format,O.UNSIGNED_BYTE,l):O.texImage2D(O.TEXTURE_2D,0,this.format,y,S,0,this.format,O.UNSIGNED_BYTE,l.data);else{const{x:B,y:G}=p||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||Le(l)?O.texSubImage2D(O.TEXTURE_2D,0,B,G,O.RGBA,O.UNSIGNED_BYTE,l):O.texSubImage2D(O.TEXTURE_2D,0,B,G,y,S,O.RGBA,O.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&O.generateMipmap(O.TEXTURE_2D),R.pixelStoreUnpackFlipY.setDefault(),R.pixelStoreUnpack.setDefault(),R.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(l,h,p){const{context:y}=this,{gl:S}=y;S.bindTexture(S.TEXTURE_2D,this.texture),p!==S.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=S.LINEAR),l!==this.filter&&(S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,l),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,p||l),this.filter=l),h!==this.wrap&&(S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,h),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}class Lk{constructor(l,h,p,y=1,S=1,E=1,R=0){if(this.uid=l,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void tn(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const O=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=y,this.greenFactor=S,this.blueFactor=E,this.baseShift=R;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let B=0;B<O;B++)this.data[this._idx(-1,B)]=this.data[this._idx(0,B)],this.data[this._idx(O,B)]=this.data[this._idx(O-1,B)],this.data[this._idx(B,-1)]=this.data[this._idx(B,0)],this.data[this._idx(B,O)]=this.data[this._idx(B,O-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(O,-1)]=this.data[this._idx(O-1,0)],this.data[this._idx(-1,O)]=this.data[this._idx(0,O-1)],this.data[this._idx(O,O)]=this.data[this._idx(O-1,O-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let B=0;B<O;B++)for(let G=0;G<O;G++){const X=this.get(B,G);X>this.max&&(this.max=X),X<this.min&&(this.min=X)}}get(l,h){const p=new Uint8Array(this.data.buffer),y=4*this._idx(l,h);return this.unpack(p[y],p[y+1],p[y+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(l,h){if(l<-1||l>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(l+1)}unpack(l,h,p){return l*this.redFactor+h*this.greenFactor+p*this.blueFactor-this.baseShift}pack(l){return kk(l,this.getUnpackVector())}getPixels(){return new ds({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(l,h,p){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let y=h*this.dim,S=h*this.dim+this.dim,E=p*this.dim,R=p*this.dim+this.dim;switch(h){case-1:y=S-1;break;case 1:S=y+1}switch(p){case-1:E=R-1;break;case 1:R=E+1}const O=-h*this.dim,B=-p*this.dim;for(let G=E;G<R;G++)for(let X=y;X<S;X++)this.data[this._idx(X,G)]=l.data[this._idx(X+O,G+B)]}}function kk(d,l){const h=l[0],p=l[1],y=l[2],S=l[3],E=Math.min(h,p,y),R=Math.round((d+S)/E);return{r:Math.floor(R*E/h)%256,g:Math.floor(R*E/p)%256,b:Math.floor(R*E/y)%256}}xn("DEMData",Lk);class sq extends to{constructor(l){super(l,oq)}_createColorRamp(l){const h={elevationStops:[],colorStops:[]},p=this._transitionablePaint._values["color-relief-color"].value.expression;if(p instanceof Ed&&p._styleExpression.expression instanceof Lo){this.colorRampExpression=p;const E=p._styleExpression.expression;h.elevationStops=E.labels,h.colorStops=[];for(const R of h.elevationStops)h.colorStops.push(E.evaluate({globals:{elevation:R}}))}if(h.elevationStops.length<1&&(h.elevationStops=[0],h.colorStops=[tr.transparent]),h.elevationStops.length<2&&(h.elevationStops.push(h.elevationStops[0]+1),h.colorStops.push(h.colorStops[0])),h.elevationStops.length<=l)return h;const y={elevationStops:[],colorStops:[]},S=(h.elevationStops.length-1)/(l-1);for(let E=0;E<h.elevationStops.length-.5;E+=S)y.elevationStops.push(h.elevationStops[Math.round(E)]),y.colorStops.push(h.colorStops[Math.round(E)]);return tn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),y}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(l,h,p){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const y=this._createColorRamp(h),S=new ds({width:y.colorStops.length,height:1}),E=new ds({width:y.colorStops.length,height:1});for(let R=0;R<y.elevationStops.length;R++){const O=kk(y.elevationStops[R],p);E.setPixel(0,R,new tr(O.r/255,O.g/255,O.b/255,1)),S.setPixel(0,R,y.colorStops[R])}return this.colorRampTextures={elevationTexture:new sC(l,E,l.gl.RGBA),colorTexture:new sC(l,S,l.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const aq=li([{name:"a_pos",components:2,type:"Int16"}],4),{members:lq}=aq;function aC(d,l,h){const p=h.patternDependencies;let y=!1;for(const S of l){const E=S.paint.get(`${d}-pattern`);E.isConstant()||(y=!0);const R=E.constantOr(null);R&&(y=!0,p[R.to]=!0,p[R.from]=!0)}return y}function lC(d,l,h,p,y){const S=y.patternDependencies;for(const E of l){const R=E.paint.get(`${d}-pattern`).value;if(R.kind!=="constant"){let O=R.evaluate({zoom:p-1},h,{},y.availableImages),B=R.evaluate({zoom:p},h,{},y.availableImages),G=R.evaluate({zoom:p+1},h,{},y.availableImages);O=O&&O.name?O.name:O,B=B&&B.name?B.name:B,G=G&&G.name?G.name:G,S[O]=!0,S[B]=!0,S[G]=!0,h.patterns[E.id]={min:O,mid:B,max:G}}}return h}function Dk(d,l,h,p,y){let S;if(y===function(E,R,O,B){let G=0;for(let X=R,ie=O-B;X<O;X+=B)G+=(E[ie]-E[X])*(E[X+1]+E[ie+1]),ie=X;return G}(d,l,h,p)>0)for(let E=l;E<h;E+=p)S=Nk(E/p|0,d[E],d[E+1],S);else for(let E=h-p;E>=l;E-=p)S=Nk(E/p|0,d[E],d[E+1],S);return S&&Rp(S,S.next)&&(Kv(S),S=S.next),S}function Gd(d,l){if(!d)return d;l||(l=d);let h,p=d;do if(h=!1,p.steiner||!Rp(p,p.next)&&gi(p.prev,p,p.next)!==0)p=p.next;else{if(Kv(p),p=l=p.prev,p===p.next)break;h=!0}while(h||p!==l);return l}function Xv(d,l,h,p,y,S,E){if(!d)return;!E&&S&&function(O,B,G,X){let ie=O;do ie.z===0&&(ie.z=cC(ie.x,ie.y,B,G,X)),ie.prevZ=ie.prev,ie.nextZ=ie.next,ie=ie.next;while(ie!==O);ie.prevZ.nextZ=null,ie.prevZ=null,function(ae){let ce,de=1;do{let Ce,ke=ae;ae=null;let et=null;for(ce=0;ke;){ce++;let Ge=ke,se=0;for(let Xe=0;Xe<de&&(se++,Ge=Ge.nextZ,Ge);Xe++);let we=de;for(;se>0||we>0&&Ge;)se!==0&&(we===0||!Ge||ke.z<=Ge.z)?(Ce=ke,ke=ke.nextZ,se--):(Ce=Ge,Ge=Ge.nextZ,we--),et?et.nextZ=Ce:ae=Ce,Ce.prevZ=et,et=Ce;ke=Ge}et.nextZ=null,de*=2}while(ce>1)}(ie)}(d,p,y,S);let R=d;for(;d.prev!==d.next;){const O=d.prev,B=d.next;if(S?uq(d,p,y,S):cq(d))l.push(O.i,d.i,B.i),Kv(d),d=B.next,R=B.next;else if((d=B)===R){E?E===1?Xv(d=hq(Gd(d),l),l,h,p,y,S,2):E===2&&dq(d,l,h,p,y,S):Xv(Gd(d),l,h,p,y,S,1);break}}}function cq(d){const l=d.prev,h=d,p=d.next;if(gi(l,h,p)>=0)return!1;const y=l.x,S=h.x,E=p.x,R=l.y,O=h.y,B=p.y,G=Math.min(y,S,E),X=Math.min(R,O,B),ie=Math.max(y,S,E),ae=Math.max(R,O,B);let ce=p.next;for(;ce!==l;){if(ce.x>=G&&ce.x<=ie&&ce.y>=X&&ce.y<=ae&&Zv(y,R,S,O,E,B,ce.x,ce.y)&&gi(ce.prev,ce,ce.next)>=0)return!1;ce=ce.next}return!0}function uq(d,l,h,p){const y=d.prev,S=d,E=d.next;if(gi(y,S,E)>=0)return!1;const R=y.x,O=S.x,B=E.x,G=y.y,X=S.y,ie=E.y,ae=Math.min(R,O,B),ce=Math.min(G,X,ie),de=Math.max(R,O,B),Ce=Math.max(G,X,ie),ke=cC(ae,ce,l,h,p),et=cC(de,Ce,l,h,p);let Ge=d.prevZ,se=d.nextZ;for(;Ge&&Ge.z>=ke&&se&&se.z<=et;){if(Ge.x>=ae&&Ge.x<=de&&Ge.y>=ce&&Ge.y<=Ce&&Ge!==y&&Ge!==E&&Zv(R,G,O,X,B,ie,Ge.x,Ge.y)&&gi(Ge.prev,Ge,Ge.next)>=0||(Ge=Ge.prevZ,se.x>=ae&&se.x<=de&&se.y>=ce&&se.y<=Ce&&se!==y&&se!==E&&Zv(R,G,O,X,B,ie,se.x,se.y)&&gi(se.prev,se,se.next)>=0))return!1;se=se.nextZ}for(;Ge&&Ge.z>=ke;){if(Ge.x>=ae&&Ge.x<=de&&Ge.y>=ce&&Ge.y<=Ce&&Ge!==y&&Ge!==E&&Zv(R,G,O,X,B,ie,Ge.x,Ge.y)&&gi(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.prevZ}for(;se&&se.z<=et;){if(se.x>=ae&&se.x<=de&&se.y>=ce&&se.y<=Ce&&se!==y&&se!==E&&Zv(R,G,O,X,B,ie,se.x,se.y)&&gi(se.prev,se,se.next)>=0)return!1;se=se.nextZ}return!0}function hq(d,l){let h=d;do{const p=h.prev,y=h.next.next;!Rp(p,y)&&Ok(p,h,h.next,y)&&Yv(p,y)&&Yv(y,p)&&(l.push(p.i,h.i,y.i),Kv(h),Kv(h.next),h=d=y),h=h.next}while(h!==d);return Gd(h)}function dq(d,l,h,p,y,S){let E=d;do{let R=E.next.next;for(;R!==E.prev;){if(E.i!==R.i&&vq(E,R)){let O=Fk(E,R);return E=Gd(E,E.next),O=Gd(O,O.next),Xv(E,l,h,p,y,S,0),void Xv(O,l,h,p,y,S,0)}R=R.next}E=E.next}while(E!==d)}function fq(d,l){let h=d.x-l.x;return h===0&&(h=d.y-l.y,h===0)&&(h=(d.next.y-d.y)/(d.next.x-d.x)-(l.next.y-l.y)/(l.next.x-l.x)),h}function pq(d,l){const h=function(y,S){let E=S;const R=y.x,O=y.y;let B,G=-1/0;if(Rp(y,E))return E;do{if(Rp(y,E.next))return E.next;if(O<=E.y&&O>=E.next.y&&E.next.y!==E.y){const de=E.x+(O-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(de<=R&&de>G&&(G=de,B=E.x<E.next.x?E:E.next,de===R))return B}E=E.next}while(E!==S);if(!B)return null;const X=B,ie=B.x,ae=B.y;let ce=1/0;E=B;do{if(R>=E.x&&E.x>=ie&&R!==E.x&&zk(O<ae?R:G,O,ie,ae,O<ae?G:R,O,E.x,E.y)){const de=Math.abs(O-E.y)/(R-E.x);Yv(E,y)&&(de<ce||de===ce&&(E.x>B.x||E.x===B.x&&mq(B,E)))&&(B=E,ce=de)}E=E.next}while(E!==X);return B}(d,l);if(!h)return l;const p=Fk(h,d);return Gd(p,p.next),Gd(h,h.next)}function mq(d,l){return gi(d.prev,d,l.prev)<0&&gi(l.next,d,d.next)<0}function cC(d,l,h,p,y){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-h)*y|0)|d<<8))|d<<4))|d<<2))|d<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-p)*y|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function gq(d){let l=d,h=d;do(l.x<h.x||l.x===h.x&&l.y<h.y)&&(h=l),l=l.next;while(l!==d);return h}function zk(d,l,h,p,y,S,E,R){return(y-E)*(l-R)>=(d-E)*(S-R)&&(d-E)*(p-R)>=(h-E)*(l-R)&&(h-E)*(S-R)>=(y-E)*(p-R)}function Zv(d,l,h,p,y,S,E,R){return!(d===E&&l===R)&&zk(d,l,h,p,y,S,E,R)}function vq(d,l){return d.next.i!==l.i&&d.prev.i!==l.i&&!function(h,p){let y=h;do{if(y.i!==h.i&&y.next.i!==h.i&&y.i!==p.i&&y.next.i!==p.i&&Ok(y,y.next,h,p))return!0;y=y.next}while(y!==h);return!1}(d,l)&&(Yv(d,l)&&Yv(l,d)&&function(h,p){let y=h,S=!1;const E=(h.x+p.x)/2,R=(h.y+p.y)/2;do y.y>R!=y.next.y>R&&y.next.y!==y.y&&E<(y.next.x-y.x)*(R-y.y)/(y.next.y-y.y)+y.x&&(S=!S),y=y.next;while(y!==h);return S}(d,l)&&(gi(d.prev,d,l.prev)||gi(d,l.prev,l))||Rp(d,l)&&gi(d.prev,d,d.next)>0&&gi(l.prev,l,l.next)>0)}function gi(d,l,h){return(l.y-d.y)*(h.x-l.x)-(l.x-d.x)*(h.y-l.y)}function Rp(d,l){return d.x===l.x&&d.y===l.y}function Ok(d,l,h,p){const y=h1(gi(d,l,h)),S=h1(gi(d,l,p)),E=h1(gi(h,p,d)),R=h1(gi(h,p,l));return y!==S&&E!==R||!(y!==0||!u1(d,h,l))||!(S!==0||!u1(d,p,l))||!(E!==0||!u1(h,d,p))||!(R!==0||!u1(h,l,p))}function u1(d,l,h){return l.x<=Math.max(d.x,h.x)&&l.x>=Math.min(d.x,h.x)&&l.y<=Math.max(d.y,h.y)&&l.y>=Math.min(d.y,h.y)}function h1(d){return d>0?1:d<0?-1:0}function Yv(d,l){return gi(d.prev,d,d.next)<0?gi(d,l,d.next)>=0&&gi(d,d.prev,l)>=0:gi(d,l,d.prev)<0||gi(d,d.next,l)<0}function Fk(d,l){const h=uC(d.i,d.x,d.y),p=uC(l.i,l.x,l.y),y=d.next,S=l.prev;return d.next=l,l.prev=d,h.next=y,y.prev=h,p.next=h,h.prev=p,S.next=p,p.prev=S,p}function Nk(d,l,h,p){const y=uC(d,l,h);return p?(y.next=p.next,y.prev=p,p.next.prev=y,p.next=y):(y.prev=y,y.next=y),y}function Kv(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function uC(d,l,h){return{i:d,x:l,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Lp{constructor(l,h){if(h>l)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=l,this._minGranularity=h}getGranularityForZoomLevel(l){return Math.max(Math.floor(this._baseZoomGranularity/(1<<l)),this._minGranularity,1)}}class d1{constructor(l){this.fill=l.fill,this.line=l.line,this.tile=l.tile,this.stencil=l.stencil,this.circle=l.circle}}d1.noSubdivision=new d1({fill:new Lp(0,0),line:new Lp(0,0),tile:new Lp(0,0),stencil:new Lp(0,0),circle:1}),xn("SubdivisionGranularityExpression",Lp),xn("SubdivisionGranularitySetting",d1);const kp=-32768,Jv=32767;class yq{constructor(l,h){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=l,this._granularityCellSize=ct/l,this._canonical=h}_getKey(l,h){return(l+=32768)<<16|h+32768}_vertexToIndex(l,h){if(l<-32768||h<-32768||l>32767||h>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const p=0|Math.round(l),y=0|Math.round(h),S=this._getKey(p,y);if(this._vertexDictionary.has(S))return this._vertexDictionary.get(S);const E=this._vertexBuffer.length/2;return this._vertexDictionary.set(S,E),this._vertexBuffer.push(p,y),E}_subdivideTrianglesScanline(l){if(this._granularity<2)return function(y,S){const E=[];for(let R=0;R<S.length;R+=3){const O=S[R],B=S[R+1],G=S[R+2],X=y[2*O],ie=y[2*O+1];(y[2*B]-X)*(y[2*G+1]-ie)-(y[2*B+1]-ie)*(y[2*G]-X)>0?(E.push(O),E.push(G),E.push(B)):(E.push(O),E.push(B),E.push(G))}return E}(this._vertexBuffer,l);const h=[],p=l.length;for(let y=0;y<p;y+=3){const S=[l[y+0],l[y+1],l[y+2]],E=[this._vertexBuffer[2*l[y+0]+0],this._vertexBuffer[2*l[y+0]+1],this._vertexBuffer[2*l[y+1]+0],this._vertexBuffer[2*l[y+1]+1],this._vertexBuffer[2*l[y+2]+0],this._vertexBuffer[2*l[y+2]+1]];let R=1/0,O=1/0,B=-1/0,G=-1/0;for(let de=0;de<3;de++){const Ce=E[2*de],ke=E[2*de+1];R=Math.min(R,Ce),B=Math.max(B,Ce),O=Math.min(O,ke),G=Math.max(G,ke)}if(R===B||O===G)continue;const X=Math.floor(R/this._granularityCellSize),ie=Math.ceil(B/this._granularityCellSize),ae=Math.floor(O/this._granularityCellSize),ce=Math.ceil(G/this._granularityCellSize);if(X!==ie||ae!==ce)for(let de=ae;de<ce;de++){const Ce=this._scanlineGenerateVertexRingForCellRow(de,E,S);_q(this._vertexBuffer,Ce,h)}else h.push(...S)}return h}_scanlineGenerateVertexRingForCellRow(l,h,p){const y=l*this._granularityCellSize,S=y+this._granularityCellSize,E=[];for(let R=0;R<3;R++){const O=h[2*R],B=h[2*R+1],G=h[2*(R+1)%6],X=h[(2*(R+1)+1)%6],ie=h[2*(R+2)%6],ae=h[(2*(R+2)+1)%6],ce=G-O,de=X-B,Ce=ce===0,ke=de===0,et=(y-B)/de,Ge=(S-B)/de,se=Math.min(et,Ge),we=Math.max(et,Ge);if(!ke&&(se>=1||we<=0)||ke&&(B<y||B>S)){X>=y&&X<=S&&E.push(p[(R+1)%3]);continue}!ke&&se>0&&E.push(this._vertexToIndex(O+ce*se,B+de*se));const Xe=O+ce*Math.max(se,0),mt=O+ce*Math.min(we,1);Ce||this._generateIntraEdgeVertices(E,O,B,G,X,Xe,mt),!ke&&we<1&&E.push(this._vertexToIndex(O+ce*we,B+de*we)),(ke||X>=y&&X<=S)&&E.push(p[(R+1)%3]),!ke&&(X<=y||X>=S)&&this._generateInterEdgeVertices(E,O,B,G,X,ie,ae,mt,y,S)}return E}_generateIntraEdgeVertices(l,h,p,y,S,E,R){const O=y-h,B=S-p,G=B===0,X=G?Math.min(h,y):Math.min(E,R),ie=G?Math.max(h,y):Math.max(E,R),ae=Math.floor(X/this._granularityCellSize)+1,ce=Math.ceil(ie/this._granularityCellSize)-1;if(G?h<y:E<R)for(let de=ae;de<=ce;de++){const Ce=de*this._granularityCellSize;l.push(this._vertexToIndex(Ce,p+B*(Ce-h)/O))}else for(let de=ce;de>=ae;de--){const Ce=de*this._granularityCellSize;l.push(this._vertexToIndex(Ce,p+B*(Ce-h)/O))}}_generateInterEdgeVertices(l,h,p,y,S,E,R,O,B,G){const X=S-p,ie=E-y,ae=R-S,ce=(B-S)/ae,de=(G-S)/ae,Ce=Math.min(ce,de),ke=Math.max(ce,de),et=y+ie*Ce;let Ge=Math.floor(Math.min(et,O)/this._granularityCellSize)+1,se=Math.ceil(Math.max(et,O)/this._granularityCellSize)-1,we=O<et;const Xe=ae===0;if(Xe&&(R===B||R===G))return;if(Xe||Ce>=1||ke<=0){const $t=p-R,bt=E+(h-E)*Math.min((B-R)/$t,(G-R)/$t);Ge=Math.floor(Math.min(bt,O)/this._granularityCellSize)+1,se=Math.ceil(Math.max(bt,O)/this._granularityCellSize)-1,we=O<bt}const mt=X>0?G:B;if(we)for(let $t=Ge;$t<=se;$t++)l.push(this._vertexToIndex($t*this._granularityCellSize,mt));else for(let $t=se;$t>=Ge;$t--)l.push(this._vertexToIndex($t*this._granularityCellSize,mt))}_generateOutline(l){const h=[];for(const p of l){const y=Wd(p,this._granularity,!0),S=this._pointArrayToIndices(y),E=[];for(let R=1;R<S.length;R++)E.push(S[R-1]),E.push(S[R]);h.push(E)}return h}_handlePoles(l){let h=!1,p=!1;this._canonical&&(this._canonical.y===0&&(h=!0),this._canonical.y===(1<<this._canonical.z)-1&&(p=!0)),(h||p)&&this._fillPoles(l,h,p)}_ensureNoPoleVertices(){const l=this._vertexBuffer;for(let h=0;h<l.length;h+=2){const p=l[h+1];p===kp&&(l[h+1]=-32767),p===Jv&&(l[h+1]=32766)}}_generatePoleQuad(l,h,p,y,S,E){y>S!=(E===kp)?(l.push(h),l.push(p),l.push(this._vertexToIndex(y,E)),l.push(p),l.push(this._vertexToIndex(S,E)),l.push(this._vertexToIndex(y,E))):(l.push(p),l.push(h),l.push(this._vertexToIndex(y,E)),l.push(this._vertexToIndex(S,E)),l.push(p),l.push(this._vertexToIndex(y,E)))}_fillPoles(l,h,p){const y=this._vertexBuffer,S=ct,E=l.length;for(let R=2;R<E;R+=3){const O=l[R-2],B=l[R-1],G=l[R],X=y[2*O],ie=y[2*O+1],ae=y[2*B],ce=y[2*B+1],de=y[2*G],Ce=y[2*G+1];h&&(ie===0&&ce===0&&this._generatePoleQuad(l,O,B,X,ae,kp),ce===0&&Ce===0&&this._generatePoleQuad(l,B,G,ae,de,kp),Ce===0&&ie===0&&this._generatePoleQuad(l,G,O,de,X,kp)),p&&(ie===S&&ce===S&&this._generatePoleQuad(l,O,B,X,ae,Jv),ce===S&&Ce===S&&this._generatePoleQuad(l,B,G,ae,de,Jv),Ce===S&&ie===S&&this._generatePoleQuad(l,G,O,de,X,Jv))}}_initializeVertices(l){for(let h=0;h<l.length;h+=2)this._vertexToIndex(l[h],l[h+1])}subdividePolygonInternal(l,h){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:p,holeIndices:y}=function(R){const O=[],B=[];for(const G of R)if(G.length!==0){G!==R[0]&&O.push(B.length/2);for(let X=0;X<G.length;X++)B.push(G[X].x),B.push(G[X].y)}return{flattened:B,holeIndices:O}}(l);let S;this._initializeVertices(p);try{const R=function(B,G,X=2){const ie=G&&G.length,ae=ie?G[0]*X:B.length;let ce=Dk(B,0,ae,X,!0);const de=[];if(!ce||ce.next===ce.prev)return de;let Ce,ke,et;if(ie&&(ce=function(Ge,se,we,Xe){const mt=[];for(let $t=0,bt=se.length;$t<bt;$t++){const Mt=Dk(Ge,se[$t]*Xe,$t<bt-1?se[$t+1]*Xe:Ge.length,Xe,!1);Mt===Mt.next&&(Mt.steiner=!0),mt.push(gq(Mt))}mt.sort(fq);for(let $t=0;$t<mt.length;$t++)we=pq(mt[$t],we);return we}(B,G,ce,X)),B.length>80*X){Ce=1/0,ke=1/0;let Ge=-1/0,se=-1/0;for(let we=X;we<ae;we+=X){const Xe=B[we],mt=B[we+1];Xe<Ce&&(Ce=Xe),mt<ke&&(ke=mt),Xe>Ge&&(Ge=Xe),mt>se&&(se=mt)}et=Math.max(Ge-Ce,se-ke),et=et!==0?32767/et:0}return Xv(ce,de,X,Ce,ke,et,0),de}(p,y),O=this._convertIndices(p,R);S=this._subdivideTrianglesScanline(O)}catch(R){console.error(R)}let E=[];return h&&(E=this._generateOutline(l)),this._ensureNoPoleVertices(),this._handlePoles(S),{verticesFlattened:this._vertexBuffer,indicesTriangles:S,indicesLineList:E}}_convertIndices(l,h){const p=[];for(let y=0;y<h.length;y++)p.push(this._vertexToIndex(l[2*h[y]],l[2*h[y]+1]));return p}_pointArrayToIndices(l){const h=[];for(let p=0;p<l.length;p++){const y=l[p];h.push(this._vertexToIndex(y.x,y.y))}return h}}function Bk(d,l,h,p=!0){return new yq(h,l).subdividePolygonInternal(d,p)}function Wd(d,l,h=!1){if(!d||d.length<1)return[];if(d.length<2)return[];const p=d[0],y=d[d.length-1],S=h&&(p.x!==y.x||p.y!==y.y);if(l<2)return S?[...d,d[0]]:[...d];const E=Math.floor(ct/l),R=[];R.push(new A(d[0].x,d[0].y));const O=d.length,B=S?O:O-1;for(let G=0;G<B;G++){const X=d[G],ie=G<O-1?d[G+1]:d[0],ae=X.x,ce=X.y,de=ie.x,Ce=ie.y,ke=ae!==de,et=ce!==Ce;if(!ke&&!et)continue;const Ge=de-ae,se=Ce-ce,we=Math.abs(Ge),Xe=Math.abs(se);let mt=ae,$t=ce;for(;;){const Mt=Ge>0?(Math.floor(mt/E)+1)*E:(Math.ceil(mt/E)-1)*E,Jt=se>0?(Math.floor($t/E)+1)*E:(Math.ceil($t/E)-1)*E,jt=Math.abs(mt-Mt),en=Math.abs($t-Jt),Pt=Math.abs(mt-de),Cn=Math.abs($t-Ce),$n=ke?jt/we:Number.POSITIVE_INFINITY,Bn=et?en/Xe:Number.POSITIVE_INFINITY;if((Pt<=jt||!ke)&&(Cn<=en||!et))break;if($n<Bn&&ke||!et){mt=Mt,$t+=se*$n;const kn=new A(mt,Math.round($t));R[R.length-1].x===kn.x&&R[R.length-1].y===kn.y||R.push(kn)}else{mt+=Ge*Bn,$t=Jt;const kn=new A(Math.round(mt),$t);R[R.length-1].x===kn.x&&R[R.length-1].y===kn.y||R.push(kn)}}const bt=new A(de,Ce);R[R.length-1].x===bt.x&&R[R.length-1].y===bt.y||R.push(bt)}return R}function _q(d,l,h){if(l.length===0)throw new Error("Subdivision vertex ring is empty.");let p=0,y=d[2*l[0]];for(let O=1;O<l.length;O++){const B=d[2*l[O]];B<y&&(y=B,p=O)}const S=l.length;let E=p,R=(E+1)%S;for(;;){const O=E-1>=0?E-1:S-1,B=(R+1)%S,G=d[2*l[O]],X=d[2*l[B]],ie=d[2*l[E]],ae=d[2*l[E]+1],ce=d[2*l[R]+1];let de=!1;if(G<X)de=!0;else if(G>X)de=!1;else{const Ce=ce-ae,ke=-(d[2*l[R]]-ie),et=ae<ce?1:-1;((G-ie)*Ce+(d[2*l[O]+1]-ae)*ke)*et>((X-ie)*Ce+(d[2*l[B]+1]-ae)*ke)*et&&(de=!0)}if(de){const Ce=l[O],ke=l[E],et=l[R];Ce!==ke&&Ce!==et&&ke!==et&&h.push(et,ke,Ce),E--,E<0&&(E=S-1)}else{const Ce=l[B],ke=l[E],et=l[R];Ce!==ke&&Ce!==et&&ke!==et&&h.push(et,ke,Ce),R++,R>=S&&(R=0)}if(O===B)break}}function Uk(d,l,h,p,y,S,E,R,O){const B=y.length/2,G=E&&R&&O;if(B<hr.MAX_VERTEX_ARRAY_LENGTH){const X=l.prepareSegment(B,h,p),ie=X.vertexLength;for(let de=0;de<S.length;de+=3)p.emplaceBack(ie+S[de],ie+S[de+1],ie+S[de+2]);let ae,ce;X.vertexLength+=B,X.primitiveLength+=S.length/3,G&&(ce=E.prepareSegment(B,h,R),ae=ce.vertexLength,ce.vertexLength+=B);for(let de=0;de<y.length;de+=2)d(y[de],y[de+1]);if(G)for(let de=0;de<O.length;de++){const Ce=O[de];for(let ke=1;ke<Ce.length;ke+=2)R.emplaceBack(ae+Ce[ke-1],ae+Ce[ke]);ce.primitiveLength+=Ce.length/2}}else(function(X,ie,ae,ce,de,Ce){const ke=[];for(let Xe=0;Xe<ce.length/2;Xe++)ke.push(-1);const et={count:0};let Ge=0,se=X.getOrCreateLatestSegment(ie,ae),we=se.vertexLength;for(let Xe=2;Xe<de.length;Xe+=3){const mt=de[Xe-2],$t=de[Xe-1],bt=de[Xe];let Mt=ke[mt]<Ge,Jt=ke[$t]<Ge,jt=ke[bt]<Ge;se.vertexLength+((Mt?1:0)+(Jt?1:0)+(jt?1:0))>hr.MAX_VERTEX_ARRAY_LENGTH&&(se=X.createNewSegment(ie,ae),Ge=et.count,Mt=!0,Jt=!0,jt=!0,we=0);const en=Qv(ke,ce,Ce,et,mt,Mt,se),Pt=Qv(ke,ce,Ce,et,$t,Jt,se),Cn=Qv(ke,ce,Ce,et,bt,jt,se);ae.emplaceBack(we+en-Ge,we+Pt-Ge,we+Cn-Ge),se.primitiveLength++}})(l,h,p,y,S,d),G&&function(X,ie,ae,ce,de,Ce){const ke=[];for(let Xe=0;Xe<ce.length/2;Xe++)ke.push(-1);const et={count:0};let Ge=0,se=X.getOrCreateLatestSegment(ie,ae),we=se.vertexLength;for(let Xe=0;Xe<de.length;Xe++){const mt=de[Xe];for(let $t=1;$t<de[Xe].length;$t+=2){const bt=mt[$t-1],Mt=mt[$t];let Jt=ke[bt]<Ge,jt=ke[Mt]<Ge;se.vertexLength+((Jt?1:0)+(jt?1:0))>hr.MAX_VERTEX_ARRAY_LENGTH&&(se=X.createNewSegment(ie,ae),Ge=et.count,Jt=!0,jt=!0,we=0);const en=Qv(ke,ce,Ce,et,bt,Jt,se),Pt=Qv(ke,ce,Ce,et,Mt,jt,se);ae.emplaceBack(we+en-Ge,we+Pt-Ge),se.primitiveLength++}}}(E,h,R,y,O,d),l.forceNewSegmentOnNextPrepare(),E==null||E.forceNewSegmentOnNextPrepare()}function Qv(d,l,h,p,y,S,E){if(S){const R=p.count;return h(l[2*y],l[2*y+1]),d[y]=p.count,p.count++,E.vertexLength++,R}return d[y]}class hC{constructor(l){this.zoom=l.zoom,this.globalState=l.globalState,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _t,this.indexArray=new zr,this.indexArray2=new Ir,this.programConfigurations=new Zl(l.layers,l.zoom),this.segments=new hr,this.segments2=new hr,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,p){this.hasPattern=aC("fill",this.layers,h);const y=this.layers[0].layout.get("fill-sort-key"),S=!y.isConstant(),E=[];for(const{feature:R,id:O,index:B,sourceLayerIndex:G}of l){const X=this.layers[0]._featureFilter.needGeometry,ie=Hd(R,X);if(!this.layers[0]._featureFilter.filter(new Zr(this.zoom,{globalState:this.globalState}),ie,p))continue;const ae=S?y.evaluate(ie,{},p,h.availableImages):void 0,ce={id:O,properties:R.properties,type:R.type,sourceLayerIndex:G,index:B,geometry:X?ie.geometry:jd(R),patterns:{},sortKey:ae};E.push(ce)}S&&E.sort((R,O)=>R.sortKey-O.sortKey);for(const R of E){const{geometry:O,index:B,sourceLayerIndex:G}=R;if(this.hasPattern){const X=lC("fill",this.layers,R,this.zoom,h);this.patternFeatures.push(X)}else this.addFeature(R,O,B,p,{},h.subdivisionGranularity);h.featureIndex.insert(l[B].feature,O,B,G,this.index)}}update(l,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,p)}addFeatures(l,h,p){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,h,p,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,lq),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,h,p,y,S,E){for(const R of ip(h,500)){const O=Bk(R,y,E.fill.getGranularityForZoomLevel(y.z)),B=this.layoutVertexArray;Uk((G,X)=>{B.emplaceBack(G,X)},this.segments,this.layoutVertexArray,this.indexArray,O.verticesFlattened,O.indicesTriangles,this.segments2,this.indexArray2,O.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,S,y)}}let $k,Vk;xn("FillBucket",hC,{omit:["layers","patternFeatures"]});var xq={get paint(){return Vk=Vk||new Do({"fill-antialias":new En(Oe.paint_fill["fill-antialias"]),"fill-opacity":new Vn(Oe.paint_fill["fill-opacity"]),"fill-color":new Vn(Oe.paint_fill["fill-color"]),"fill-outline-color":new Vn(Oe.paint_fill["fill-outline-color"]),"fill-translate":new En(Oe.paint_fill["fill-translate"]),"fill-translate-anchor":new En(Oe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Tp(Oe.paint_fill["fill-pattern"])})},get layout(){return $k=$k||new Do({"fill-sort-key":new Vn(Oe.layout_fill["fill-sort-key"])})}};class bq extends to{constructor(l){super(l,xq)}recalculate(l,h){super.recalculate(l,h);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new hC(l)}queryRadius(){return l1(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:l,geometry:h,transform:p,pixelsToTileUnits:y}){return xk(c1(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-p.bearingInRadians,y),h)}isTileClipped(){return!0}}const wq=li([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Sq=li([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Mq}=wq;var dC,jk,fC,Hk,pC,Gk,Wk,f1={};function qk(){if(jk)return dC;jk=1;var d=x();function l(y,S,E,R,O){this.properties={},this.extent=E,this.type=0,this._pbf=y,this._geometry=-1,this._keys=R,this._values=O,y.readFields(h,this,S)}function h(y,S,E){y==1?S.id=E.readVarint():y==2?function(R,O){for(var B=R.readVarint()+R.pos;R.pos<B;){var G=O._keys[R.readVarint()],X=O._values[R.readVarint()];O.properties[G]=X}}(E,S):y==3?S.type=E.readVarint():y==4&&(S._geometry=E.pos)}function p(y){for(var S,E,R=0,O=0,B=y.length,G=B-1;O<B;G=O++)R+=((E=y[G]).x-(S=y[O]).x)*(S.y+E.y);return R}return dC=l,l.types=["Unknown","Point","LineString","Polygon"],l.prototype.loadGeometry=function(){var y=this._pbf;y.pos=this._geometry;for(var S,E=y.readVarint()+y.pos,R=1,O=0,B=0,G=0,X=[];y.pos<E;){if(O<=0){var ie=y.readVarint();R=7&ie,O=ie>>3}if(O--,R===1||R===2)B+=y.readSVarint(),G+=y.readSVarint(),R===1&&(S&&X.push(S),S=[]),S.push(new d(B,G));else{if(R!==7)throw new Error("unknown command "+R);S&&S.push(S[0].clone())}}return S&&X.push(S),X},l.prototype.bbox=function(){var y=this._pbf;y.pos=this._geometry;for(var S=y.readVarint()+y.pos,E=1,R=0,O=0,B=0,G=1/0,X=-1/0,ie=1/0,ae=-1/0;y.pos<S;){if(R<=0){var ce=y.readVarint();E=7&ce,R=ce>>3}if(R--,E===1||E===2)(O+=y.readSVarint())<G&&(G=O),O>X&&(X=O),(B+=y.readSVarint())<ie&&(ie=B),B>ae&&(ae=B);else if(E!==7)throw new Error("unknown command "+E)}return[G,ie,X,ae]},l.prototype.toGeoJSON=function(y,S,E){var R,O,B=this.extent*Math.pow(2,E),G=this.extent*y,X=this.extent*S,ie=this.loadGeometry(),ae=l.types[this.type];function ce(ke){for(var et=0;et<ke.length;et++){var Ge=ke[et];ke[et]=[360*(Ge.x+G)/B-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ge.y+X)/B)*Math.PI/180))-90]}}switch(this.type){case 1:var de=[];for(R=0;R<ie.length;R++)de[R]=ie[R][0];ce(ie=de);break;case 2:for(R=0;R<ie.length;R++)ce(ie[R]);break;case 3:for(ie=function(ke){var et=ke.length;if(et<=1)return[ke];for(var Ge,se,we=[],Xe=0;Xe<et;Xe++){var mt=p(ke[Xe]);mt!==0&&(se===void 0&&(se=mt<0),se===mt<0?(Ge&&we.push(Ge),Ge=[ke[Xe]]):Ge.push(ke[Xe]))}return Ge&&we.push(Ge),we}(ie),R=0;R<ie.length;R++)for(O=0;O<ie[R].length;O++)ce(ie[R][O])}ie.length===1?ie=ie[0]:ae="Multi"+ae;var Ce={type:"Feature",geometry:{type:ae,coordinates:ie},properties:this.properties};return"id"in this&&(Ce.id=this.id),Ce},dC}function Xk(){if(Hk)return fC;Hk=1;var d=qk();function l(p,y){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=p,this._keys=[],this._values=[],this._features=[],p.readFields(h,this,y),this.length=this._features.length}function h(p,y,S){p===15?y.version=S.readVarint():p===1?y.name=S.readString():p===5?y.extent=S.readVarint():p===2?y._features.push(S.pos):p===3?y._keys.push(S.readString()):p===4&&y._values.push(function(E){for(var R=null,O=E.readVarint()+E.pos;E.pos<O;){var B=E.readVarint()>>3;R=B===1?E.readString():B===2?E.readFloat():B===3?E.readDouble():B===4?E.readVarint64():B===5?E.readVarint():B===6?E.readSVarint():B===7?E.readBoolean():null}return R}(S))}return fC=l,l.prototype.feature=function(p){if(p<0||p>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[p];var y=this._pbf.readVarint()+this._pbf.pos;return new d(this._pbf,y,this.extent,this._keys,this._values)},fC}function Zk(){return Wk||(Wk=1,f1.VectorTile=function(){if(Gk)return pC;Gk=1;var d=Xk();function l(h,p,y){if(h===3){var S=new d(y,y.readVarint()+y.pos);S.length&&(p[S.name]=S)}}return pC=function(h,p){this.layers=h.readFields(l,{},p)},pC}(),f1.VectorTileFeature=qk(),f1.VectorTileLayer=Xk()),f1}var e0=f(Zk());const Cq=e0.VectorTileFeature.types,mC=Math.pow(2,13);function t0(d,l,h,p,y,S,E,R){d.emplaceBack(l,h,2*Math.floor(p*mC)+E,y*mC*2,S*mC*2,Math.round(R))}class gC{constructor(l){this.zoom=l.zoom,this.globalState=l.globalState,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.layoutVertexArray=new sn,this.centroidVertexArray=new ht,this.indexArray=new zr,this.programConfigurations=new Zl(l.layers,l.zoom),this.segments=new hr,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,p){this.features=[],this.hasPattern=aC("fill-extrusion",this.layers,h);for(const{feature:y,id:S,index:E,sourceLayerIndex:R}of l){const O=this.layers[0]._featureFilter.needGeometry,B=Hd(y,O);if(!this.layers[0]._featureFilter.filter(new Zr(this.zoom,{globalState:this.globalState}),B,p))continue;const G={id:S,sourceLayerIndex:R,index:E,geometry:O?B.geometry:jd(y),properties:y.properties,type:y.type,patterns:{}};this.hasPattern?this.features.push(lC("fill-extrusion",this.layers,G,this.zoom,h)):this.addFeature(G,G.geometry,E,p,{},h.subdivisionGranularity),h.featureIndex.insert(y,G.geometry,E,R,this.index,!0)}}addFeatures(l,h,p){for(const y of this.features){const{geometry:S}=y;this.addFeature(y,S,y.index,h,p,l.subdivisionGranularity)}}update(l,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Mq),this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,Sq.members,!0),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(l,h,p,y,S,E){for(const R of ip(h,500)){const O={x:0,y:0,sampleCount:0},B=this.layoutVertexArray.length;this.processPolygon(O,y,l,R,E);const G=this.layoutVertexArray.length-B,X=Math.floor(O.x/O.sampleCount),ie=Math.floor(O.y/O.sampleCount);for(let ae=0;ae<G;ae++)this.centroidVertexArray.emplaceBack(X,ie)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,S,y)}processPolygon(l,h,p,y,S){if(y.length<1||Yk(y[0]))return;for(const X of y)X.length!==0&&Eq(l,X);const E={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},R=S.fill.getGranularityForZoomLevel(h.z),O=Cq[p.type]==="Polygon";for(const X of y){if(X.length===0||Yk(X))continue;const ie=Wd(X,R,O);this._generateSideFaces(ie,E)}if(!O)return;const B=Bk(y,h,R,!1),G=this.layoutVertexArray;Uk((X,ie)=>{t0(G,X,ie,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,B.verticesFlattened,B.indicesTriangles)}_generateSideFaces(l,h){let p=0;for(let y=1;y<l.length;y++){const S=l[y],E=l[y-1];if(Tq(S,E))continue;h.segment.vertexLength+4>hr.MAX_VERTEX_ARRAY_LENGTH&&(h.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const R=S.sub(E)._perp()._unit(),O=E.dist(S);p+O>32768&&(p=0),t0(this.layoutVertexArray,S.x,S.y,R.x,R.y,0,0,p),t0(this.layoutVertexArray,S.x,S.y,R.x,R.y,0,1,p),p+=O,t0(this.layoutVertexArray,E.x,E.y,R.x,R.y,0,0,p),t0(this.layoutVertexArray,E.x,E.y,R.x,R.y,0,1,p);const B=h.segment.vertexLength;this.indexArray.emplaceBack(B,B+2,B+1),this.indexArray.emplaceBack(B+1,B+2,B+3),h.segment.vertexLength+=4,h.segment.primitiveLength+=2}}}function Eq(d,l){for(let h=0;h<l.length;h++){const p=l[h];h===l.length-1&&l[0].x===p.x&&l[0].y===p.y||(d.x+=p.x,d.y+=p.y,d.sampleCount++)}}function Tq(d,l){return d.x===l.x&&(d.x<0||d.x>ct)||d.y===l.y&&(d.y<0||d.y>ct)}function Yk(d){return d.every(l=>l.x<0)||d.every(l=>l.x>ct)||d.every(l=>l.y<0)||d.every(l=>l.y>ct)}let Kk;xn("FillExtrusionBucket",gC,{omit:["layers","features"]});var Pq={get paint(){return Kk=Kk||new Do({"fill-extrusion-opacity":new En(Oe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Vn(Oe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new En(Oe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new En(Oe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Tp(Oe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Vn(Oe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Vn(Oe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new En(Oe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Aq extends to{constructor(l){super(l,Pq)}createBucket(l){return new gC(l)}queryRadius(){return l1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:p,geometry:y,transform:S,pixelsToTileUnits:E,pixelPosMatrix:R}){const O=c1(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-S.bearingInRadians,E),B=this.paint.get("fill-extrusion-height").evaluate(h,p),G=this.paint.get("fill-extrusion-base").evaluate(h,p),X=function(ae,ce){const de=[];for(const Ce of ae){const ke=[Ce.x,Ce.y,0,1];Se(ke,ke,ce),de.push(new A(ke[0]/ke[3],ke[1]/ke[3]))}return de}(O,R),ie=function(ae,ce,de,Ce){const ke=[],et=[],Ge=Ce[8]*ce,se=Ce[9]*ce,we=Ce[10]*ce,Xe=Ce[11]*ce,mt=Ce[8]*de,$t=Ce[9]*de,bt=Ce[10]*de,Mt=Ce[11]*de;for(const Jt of ae){const jt=[],en=[];for(const Pt of Jt){const Cn=Pt.x,$n=Pt.y,Bn=Ce[0]*Cn+Ce[4]*$n+Ce[12],kn=Ce[1]*Cn+Ce[5]*$n+Ce[13],or=Ce[2]*Cn+Ce[6]*$n+Ce[14],ci=Ce[3]*Cn+Ce[7]*$n+Ce[15],ki=or+we,xo=ci+Xe,na=Bn+mt,fs=kn+$t,oo=or+bt,ii=ci+Mt,qi=new A((Bn+Ge)/xo,(kn+se)/xo);qi.z=ki/xo,jt.push(qi);const so=new A(na/ii,fs/ii);so.z=oo/ii,en.push(so)}ke.push(jt),et.push(en)}return[ke,et]}(y,G,B,R);return function(ae,ce,de){let Ce=1/0;xk(de,ce)&&(Ce=Jk(de,ce[0]));for(let ke=0;ke<ce.length;ke++){const et=ce[ke],Ge=ae[ke];for(let se=0;se<et.length-1;se++){const we=et[se],Xe=[we,et[se+1],Ge[se+1],Ge[se],we];_k(de,Xe)&&(Ce=Math.min(Ce,Jk(de,Xe)))}}return Ce!==1/0&&Ce}(ie[0],ie[1],X)}}function n0(d,l){return d.x*l.x+d.y*l.y}function Jk(d,l){if(d.length===1){let h=0;const p=l[h++];let y;for(;!y||p.equals(y);)if(y=l[h++],!y)return 1/0;for(;h<l.length;h++){const S=l[h],E=d[0],R=y.sub(p),O=S.sub(p),B=E.sub(p),G=n0(R,R),X=n0(R,O),ie=n0(O,O),ae=n0(B,R),ce=n0(B,O),de=G*ie-X*X,Ce=(ie*ae-X*ce)/de,ke=(G*ce-X*ae)/de,et=p.z*(1-Ce-ke)+y.z*Ce+S.z*ke;if(isFinite(et))return et}return 1/0}{let h=1/0;for(const p of l)h=Math.min(h,p.z);return h}}const Iq=li([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Rq}=Iq,Lq=li([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:kq}=Lq,Dq=e0.VectorTileFeature.types,zq=Math.cos(Math.PI/180*37.5),Qk=Math.pow(2,14)/.5;class vC{constructor(l){this.zoom=l.zoom,this.globalState=l.globalState,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new rn,this.layoutVertexArray2=new Vt,this.indexArray=new zr,this.programConfigurations=new Zl(l.layers,l.zoom),this.segments=new hr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,p){this.hasPattern=aC("line",this.layers,h);const y=this.layers[0].layout.get("line-sort-key"),S=!y.isConstant(),E=[];for(const{feature:R,id:O,index:B,sourceLayerIndex:G}of l){const X=this.layers[0]._featureFilter.needGeometry,ie=Hd(R,X);if(!this.layers[0]._featureFilter.filter(new Zr(this.zoom,{globalState:this.globalState}),ie,p))continue;const ae=S?y.evaluate(ie,{},p):void 0,ce={id:O,properties:R.properties,type:R.type,sourceLayerIndex:G,index:B,geometry:X?ie.geometry:jd(R),patterns:{},sortKey:ae};E.push(ce)}S&&E.sort((R,O)=>R.sortKey-O.sortKey);for(const R of E){const{geometry:O,index:B,sourceLayerIndex:G}=R;if(this.hasPattern){const X=lC("line",this.layers,R,this.zoom,h);this.patternFeatures.push(X)}else this.addFeature(R,O,B,p,{},h.subdivisionGranularity);h.featureIndex.insert(l[B].feature,O,B,G,this.index)}}update(l,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,p)}addFeatures(l,h,p){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,h,p,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,kq)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Rq),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,h,p,y,S,E){const R=this.layers[0].layout,O=R.get("line-join").evaluate(l,{}),B=R.get("line-cap"),G=R.get("line-miter-limit"),X=R.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const ie of h)this.addLine(ie,l,O,B,G,X,y,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,S,y)}addLine(l,h,p,y,S,E,R,O){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,l=Wd(l,R?O.line.getGranularityForZoomLevel(R.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ge=0;Ge<l.length-1;Ge++)this.totalDistance+=l[Ge].dist(l[Ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const B=Dq[h.type]==="Polygon";let G=l.length;for(;G>=2&&l[G-1].equals(l[G-2]);)G--;let X=0;for(;X<G-1&&l[X].equals(l[X+1]);)X++;if(G<(B?3:2))return;p==="bevel"&&(S=1.05);const ie=this.overscaling<=16?122880/(512*this.overscaling):0,ae=this.segments.prepareSegment(10*G,this.layoutVertexArray,this.indexArray);let ce,de,Ce,ke,et;this.e1=this.e2=-1,B&&(ce=l[G-2],et=l[X].sub(ce)._unit()._perp());for(let Ge=X;Ge<G;Ge++){if(Ce=Ge===G-1?B?l[X+1]:void 0:l[Ge+1],Ce&&l[Ge].equals(Ce))continue;et&&(ke=et),ce&&(de=ce),ce=l[Ge],et=Ce?Ce.sub(ce)._unit()._perp():ke,ke=ke||et;let se=ke.add(et);se.x===0&&se.y===0||se._unit();const we=ke.x*et.x+ke.y*et.y,Xe=se.x*et.x+se.y*et.y,mt=Xe!==0?1/Xe:1/0,$t=2*Math.sqrt(2-2*Xe),bt=Xe<zq&&de&&Ce,Mt=ke.x*et.y-ke.y*et.x>0;if(bt&&Ge>X){const en=ce.dist(de);if(en>2*ie){const Pt=ce.sub(ce.sub(de)._mult(ie/en)._round());this.updateDistance(de,Pt),this.addCurrentVertex(Pt,ke,0,0,ae),de=Pt}}const Jt=de&&Ce;let jt=Jt?p:B?"butt":y;if(Jt&&jt==="round"&&(mt<E?jt="miter":mt<=2&&(jt="fakeround")),jt==="miter"&&mt>S&&(jt="bevel"),jt==="bevel"&&(mt>2&&(jt="flipbevel"),mt<S&&(jt="miter")),de&&this.updateDistance(de,ce),jt==="miter")se._mult(mt),this.addCurrentVertex(ce,se,0,0,ae);else if(jt==="flipbevel"){if(mt>100)se=et.mult(-1);else{const en=mt*ke.add(et).mag()/ke.sub(et).mag();se._perp()._mult(en*(Mt?-1:1))}this.addCurrentVertex(ce,se,0,0,ae),this.addCurrentVertex(ce,se.mult(-1),0,0,ae)}else if(jt==="bevel"||jt==="fakeround"){const en=-Math.sqrt(mt*mt-1),Pt=Mt?en:0,Cn=Mt?0:en;if(de&&this.addCurrentVertex(ce,ke,Pt,Cn,ae),jt==="fakeround"){const $n=Math.round(180*$t/Math.PI/20);for(let Bn=1;Bn<$n;Bn++){let kn=Bn/$n;if(kn!==.5){const ci=kn-.5;kn+=kn*ci*(kn-1)*((1.0904+we*(we*(3.55645-1.43519*we)-3.2452))*ci*ci+(.848013+we*(.215638*we-1.06021)))}const or=et.sub(ke)._mult(kn)._add(ke)._unit()._mult(Mt?-1:1);this.addHalfVertex(ce,or.x,or.y,!1,Mt,0,ae)}}Ce&&this.addCurrentVertex(ce,et,-Pt,-Cn,ae)}else if(jt==="butt")this.addCurrentVertex(ce,se,0,0,ae);else if(jt==="square"){const en=de?1:-1;this.addCurrentVertex(ce,se,en,en,ae)}else jt==="round"&&(de&&(this.addCurrentVertex(ce,ke,0,0,ae),this.addCurrentVertex(ce,ke,1,1,ae,!0)),Ce&&(this.addCurrentVertex(ce,et,-1,-1,ae,!0),this.addCurrentVertex(ce,et,0,0,ae)));if(bt&&Ge<G-1){const en=ce.dist(Ce);if(en>2*ie){const Pt=ce.add(Ce.sub(ce)._mult(ie/en)._round());this.updateDistance(ce,Pt),this.addCurrentVertex(Pt,et,0,0,ae),ce=Pt}}}}addCurrentVertex(l,h,p,y,S,E=!1){const R=h.y*y-h.x,O=-h.y-h.x*y;this.addHalfVertex(l,h.x+h.y*p,h.y-h.x*p,E,!1,p,S),this.addHalfVertex(l,R,O,E,!0,-y,S),this.distance>Qk/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(l,h,p,y,S,E))}addHalfVertex({x:l,y:h},p,y,S,E,R,O){const B=.5*(this.lineClips?this.scaledDistance*(Qk-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((l<<1)+(S?1:0),(h<<1)+(E?1:0),Math.round(63*p)+128,Math.round(63*y)+128,1+(R===0?0:R<0?-1:1)|(63&B)<<2,B>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const G=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,G,this.e2),O.primitiveLength++),E?this.e2=G:this.e1=G}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(l,h){this.distance+=l.dist(h),this.updateScaledDistance()}}let eD,tD;xn("LineBucket",vC,{omit:["layers","patternFeatures"]});var nD={get paint(){return tD=tD||new Do({"line-opacity":new Vn(Oe.paint_line["line-opacity"]),"line-color":new Vn(Oe.paint_line["line-color"]),"line-translate":new En(Oe.paint_line["line-translate"]),"line-translate-anchor":new En(Oe.paint_line["line-translate-anchor"]),"line-width":new Vn(Oe.paint_line["line-width"]),"line-gap-width":new Vn(Oe.paint_line["line-gap-width"]),"line-offset":new Vn(Oe.paint_line["line-offset"]),"line-blur":new Vn(Oe.paint_line["line-blur"]),"line-dasharray":new Nv(Oe.paint_line["line-dasharray"]),"line-pattern":new Tp(Oe.paint_line["line-pattern"]),"line-gradient":new Fd(Oe.paint_line["line-gradient"])})},get layout(){return eD=eD||new Do({"line-cap":new En(Oe.layout_line["line-cap"]),"line-join":new Vn(Oe.layout_line["line-join"]),"line-miter-limit":new En(Oe.layout_line["line-miter-limit"]),"line-round-limit":new En(Oe.layout_line["line-round-limit"]),"line-sort-key":new Vn(Oe.layout_line["line-sort-key"])})}};class Oq extends Vn{possiblyEvaluate(l,h){return h=new Zr(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(l,h)}evaluate(l,h,p,y){return h=un({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(l,h,p,y)}}let p1;class Fq extends to{constructor(l){super(l,nD),this.gradientVersion=0,p1||(p1=new Oq(nD.paint.properties["line-width"].specification),p1.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(p){return p._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof Pu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,h){super.recalculate(l,h),this.paint._values["line-floorwidth"]=p1.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new vC(l)}queryRadius(l){const h=l,p=rD(Wv("line-width",this,h),Wv("line-gap-width",this,h)),y=Wv("line-offset",this,h);return p/2+Math.abs(y)+l1(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:p,geometry:y,transform:S,pixelsToTileUnits:E}){const R=c1(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-S.bearingInRadians,E),O=E/2*rD(this.paint.get("line-width").evaluate(h,p),this.paint.get("line-gap-width").evaluate(h,p)),B=this.paint.get("line-offset").evaluate(h,p);return B&&(y=function(G,X){const ie=[];for(let ae=0;ae<G.length;ae++){const ce=G[ae],de=[];for(let Ce=0;Ce<ce.length;Ce++){const ke=ce[Ce-1],et=ce[Ce],Ge=ce[Ce+1],se=Ce===0?new A(0,0):et.sub(ke)._unit()._perp(),we=Ce===ce.length-1?new A(0,0):Ge.sub(et)._unit()._perp(),Xe=se._add(we)._unit(),mt=Xe.x*we.x+Xe.y*we.y;mt!==0&&Xe._mult(1/mt),de.push(Xe._mult(X)._add(et))}ie.push(de)}return ie}(y,B*E)),function(G,X,ie){for(let ae=0;ae<X.length;ae++){const ce=X[ae];if(G.length>=3){for(let de=0;de<ce.length;de++)if(Ip(G,ce[de]))return!0}if(YW(G,ce,ie))return!0}return!1}(R,y,O)}isTileClipped(){return!0}}function rD(d,l){return l>0?l+2*d:d}const Nq=li([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Bq=li([{name:"a_projected_pos",components:3,type:"Float32"}],4);li([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Uq=li([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);li([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const iD=li([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$q=li([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Vq(d,l,h){return d.sections.forEach(p=>{p.text=function(y,S,E){const R=S.layout.get("text-transform").evaluate(E,{});return R==="uppercase"?y=y.toLocaleUpperCase():R==="lowercase"&&(y=y.toLocaleLowerCase()),Vl.applyArabicShaping&&(y=Vl.applyArabicShaping(y)),y}(p.text,l,h)}),d}li([{name:"triangle",components:3,type:"Uint16"}]),li([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),li([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),li([{type:"Float32",name:"offsetX"}]),li([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),li([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const r0={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var oD,yC,sD,Wi=24,_C={};function jq(){return oD||(oD=1,_C.read=function(d,l,h,p,y){var S,E,R=8*y-p-1,O=(1<<R)-1,B=O>>1,G=-7,X=h?y-1:0,ie=h?-1:1,ae=d[l+X];for(X+=ie,S=ae&(1<<-G)-1,ae>>=-G,G+=R;G>0;S=256*S+d[l+X],X+=ie,G-=8);for(E=S&(1<<-G)-1,S>>=-G,G+=p;G>0;E=256*E+d[l+X],X+=ie,G-=8);if(S===0)S=1-B;else{if(S===O)return E?NaN:1/0*(ae?-1:1);E+=Math.pow(2,p),S-=B}return(ae?-1:1)*E*Math.pow(2,S-p)},_C.write=function(d,l,h,p,y,S){var E,R,O,B=8*S-y-1,G=(1<<B)-1,X=G>>1,ie=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,ae=p?0:S-1,ce=p?1:-1,de=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(R=isNaN(l)?1:0,E=G):(E=Math.floor(Math.log(l)/Math.LN2),l*(O=Math.pow(2,-E))<1&&(E--,O*=2),(l+=E+X>=1?ie/O:ie*Math.pow(2,1-X))*O>=2&&(E++,O/=2),E+X>=G?(R=0,E=G):E+X>=1?(R=(l*O-1)*Math.pow(2,y),E+=X):(R=l*Math.pow(2,X-1)*Math.pow(2,y),E=0));y>=8;d[h+ae]=255&R,ae+=ce,R/=256,y-=8);for(E=E<<y|R,B+=y;B>0;d[h+ae]=255&E,ae+=ce,E/=256,B-=8);d[h+ae-ce]|=128*de}),_C}function aD(){if(sD)return yC;sD=1,yC=l;var d=jq();function l(se){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(se)?se:new Uint8Array(se||0),this.pos=0,this.type=0,this.length=this.buf.length}l.Varint=0,l.Fixed64=1,l.Bytes=2,l.Fixed32=5;var h=4294967296,p=1/h,y=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function S(se){return se.type===l.Bytes?se.readVarint()+se.pos:se.pos+1}function E(se,we,Xe){return Xe?4294967296*we+(se>>>0):4294967296*(we>>>0)+(se>>>0)}function R(se,we,Xe){var mt=we<=16383?1:we<=2097151?2:we<=268435455?3:Math.floor(Math.log(we)/(7*Math.LN2));Xe.realloc(mt);for(var $t=Xe.pos-1;$t>=se;$t--)Xe.buf[$t+mt]=Xe.buf[$t]}function O(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeVarint(se[Xe])}function B(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeSVarint(se[Xe])}function G(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeFloat(se[Xe])}function X(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeDouble(se[Xe])}function ie(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeBoolean(se[Xe])}function ae(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeFixed32(se[Xe])}function ce(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeSFixed32(se[Xe])}function de(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeFixed64(se[Xe])}function Ce(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeSFixed64(se[Xe])}function ke(se,we){return(se[we]|se[we+1]<<8|se[we+2]<<16)+16777216*se[we+3]}function et(se,we,Xe){se[Xe]=we,se[Xe+1]=we>>>8,se[Xe+2]=we>>>16,se[Xe+3]=we>>>24}function Ge(se,we){return(se[we]|se[we+1]<<8|se[we+2]<<16)+(se[we+3]<<24)}return l.prototype={destroy:function(){this.buf=null},readFields:function(se,we,Xe){for(Xe=Xe||this.length;this.pos<Xe;){var mt=this.readVarint(),$t=mt>>3,bt=this.pos;this.type=7&mt,se($t,we,this),this.pos===bt&&this.skip(mt)}return we},readMessage:function(se,we){return this.readFields(se,we,this.readVarint()+this.pos)},readFixed32:function(){var se=ke(this.buf,this.pos);return this.pos+=4,se},readSFixed32:function(){var se=Ge(this.buf,this.pos);return this.pos+=4,se},readFixed64:function(){var se=ke(this.buf,this.pos)+ke(this.buf,this.pos+4)*h;return this.pos+=8,se},readSFixed64:function(){var se=ke(this.buf,this.pos)+Ge(this.buf,this.pos+4)*h;return this.pos+=8,se},readFloat:function(){var se=d.read(this.buf,this.pos,!0,23,4);return this.pos+=4,se},readDouble:function(){var se=d.read(this.buf,this.pos,!0,52,8);return this.pos+=8,se},readVarint:function(se){var we,Xe,mt=this.buf;return we=127&(Xe=mt[this.pos++]),Xe<128?we:(we|=(127&(Xe=mt[this.pos++]))<<7,Xe<128?we:(we|=(127&(Xe=mt[this.pos++]))<<14,Xe<128?we:(we|=(127&(Xe=mt[this.pos++]))<<21,Xe<128?we:function($t,bt,Mt){var Jt,jt,en=Mt.buf;if(Jt=(112&(jt=en[Mt.pos++]))>>4,jt<128||(Jt|=(127&(jt=en[Mt.pos++]))<<3,jt<128)||(Jt|=(127&(jt=en[Mt.pos++]))<<10,jt<128)||(Jt|=(127&(jt=en[Mt.pos++]))<<17,jt<128)||(Jt|=(127&(jt=en[Mt.pos++]))<<24,jt<128)||(Jt|=(1&(jt=en[Mt.pos++]))<<31,jt<128))return E($t,Jt,bt);throw new Error("Expected varint not more than 10 bytes")}(we|=(15&(Xe=mt[this.pos]))<<28,se,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var se=this.readVarint();return se%2==1?(se+1)/-2:se/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var se=this.readVarint()+this.pos,we=this.pos;return this.pos=se,se-we>=12&&y?function(Xe,mt,$t){return y.decode(Xe.subarray(mt,$t))}(this.buf,we,se):function(Xe,mt,$t){for(var bt="",Mt=mt;Mt<$t;){var Jt,jt,en,Pt=Xe[Mt],Cn=null,$n=Pt>239?4:Pt>223?3:Pt>191?2:1;if(Mt+$n>$t)break;$n===1?Pt<128&&(Cn=Pt):$n===2?(192&(Jt=Xe[Mt+1]))==128&&(Cn=(31&Pt)<<6|63&Jt)<=127&&(Cn=null):$n===3?(jt=Xe[Mt+2],(192&(Jt=Xe[Mt+1]))==128&&(192&jt)==128&&((Cn=(15&Pt)<<12|(63&Jt)<<6|63&jt)<=2047||Cn>=55296&&Cn<=57343)&&(Cn=null)):$n===4&&(jt=Xe[Mt+2],en=Xe[Mt+3],(192&(Jt=Xe[Mt+1]))==128&&(192&jt)==128&&(192&en)==128&&((Cn=(15&Pt)<<18|(63&Jt)<<12|(63&jt)<<6|63&en)<=65535||Cn>=1114112)&&(Cn=null)),Cn===null?(Cn=65533,$n=1):Cn>65535&&(Cn-=65536,bt+=String.fromCharCode(Cn>>>10&1023|55296),Cn=56320|1023&Cn),bt+=String.fromCharCode(Cn),Mt+=$n}return bt}(this.buf,we,se)},readBytes:function(){var se=this.readVarint()+this.pos,we=this.buf.subarray(this.pos,se);return this.pos=se,we},readPackedVarint:function(se,we){if(this.type!==l.Bytes)return se.push(this.readVarint(we));var Xe=S(this);for(se=se||[];this.pos<Xe;)se.push(this.readVarint(we));return se},readPackedSVarint:function(se){if(this.type!==l.Bytes)return se.push(this.readSVarint());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readSVarint());return se},readPackedBoolean:function(se){if(this.type!==l.Bytes)return se.push(this.readBoolean());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readBoolean());return se},readPackedFloat:function(se){if(this.type!==l.Bytes)return se.push(this.readFloat());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readFloat());return se},readPackedDouble:function(se){if(this.type!==l.Bytes)return se.push(this.readDouble());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readDouble());return se},readPackedFixed32:function(se){if(this.type!==l.Bytes)return se.push(this.readFixed32());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readFixed32());return se},readPackedSFixed32:function(se){if(this.type!==l.Bytes)return se.push(this.readSFixed32());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readSFixed32());return se},readPackedFixed64:function(se){if(this.type!==l.Bytes)return se.push(this.readFixed64());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readFixed64());return se},readPackedSFixed64:function(se){if(this.type!==l.Bytes)return se.push(this.readSFixed64());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readSFixed64());return se},skip:function(se){var we=7&se;if(we===l.Varint)for(;this.buf[this.pos++]>127;);else if(we===l.Bytes)this.pos=this.readVarint()+this.pos;else if(we===l.Fixed32)this.pos+=4;else{if(we!==l.Fixed64)throw new Error("Unimplemented type: "+we);this.pos+=8}},writeTag:function(se,we){this.writeVarint(se<<3|we)},realloc:function(se){for(var we=this.length||16;we<this.pos+se;)we*=2;if(we!==this.length){var Xe=new Uint8Array(we);Xe.set(this.buf),this.buf=Xe,this.length=we}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(se){this.realloc(4),et(this.buf,se,this.pos),this.pos+=4},writeSFixed32:function(se){this.realloc(4),et(this.buf,se,this.pos),this.pos+=4},writeFixed64:function(se){this.realloc(8),et(this.buf,-1&se,this.pos),et(this.buf,Math.floor(se*p),this.pos+4),this.pos+=8},writeSFixed64:function(se){this.realloc(8),et(this.buf,-1&se,this.pos),et(this.buf,Math.floor(se*p),this.pos+4),this.pos+=8},writeVarint:function(se){(se=+se||0)>268435455||se<0?function(we,Xe){var mt,$t;if(we>=0?(mt=we%4294967296|0,$t=we/4294967296|0):($t=~(-we/4294967296),4294967295^(mt=~(-we%4294967296))?mt=mt+1|0:(mt=0,$t=$t+1|0)),we>=18446744073709552e3||we<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Xe.realloc(10),function(bt,Mt,Jt){Jt.buf[Jt.pos++]=127&bt|128,bt>>>=7,Jt.buf[Jt.pos++]=127&bt|128,bt>>>=7,Jt.buf[Jt.pos++]=127&bt|128,bt>>>=7,Jt.buf[Jt.pos++]=127&bt|128,Jt.buf[Jt.pos]=127&(bt>>>=7)}(mt,0,Xe),function(bt,Mt){var Jt=(7&bt)<<4;Mt.buf[Mt.pos++]|=Jt|((bt>>>=3)?128:0),bt&&(Mt.buf[Mt.pos++]=127&bt|((bt>>>=7)?128:0),bt&&(Mt.buf[Mt.pos++]=127&bt|((bt>>>=7)?128:0),bt&&(Mt.buf[Mt.pos++]=127&bt|((bt>>>=7)?128:0),bt&&(Mt.buf[Mt.pos++]=127&bt|((bt>>>=7)?128:0),bt&&(Mt.buf[Mt.pos++]=127&bt)))))}($t,Xe)}(se,this):(this.realloc(4),this.buf[this.pos++]=127&se|(se>127?128:0),se<=127||(this.buf[this.pos++]=127&(se>>>=7)|(se>127?128:0),se<=127||(this.buf[this.pos++]=127&(se>>>=7)|(se>127?128:0),se<=127||(this.buf[this.pos++]=se>>>7&127))))},writeSVarint:function(se){this.writeVarint(se<0?2*-se-1:2*se)},writeBoolean:function(se){this.writeVarint(!!se)},writeString:function(se){se=String(se),this.realloc(4*se.length),this.pos++;var we=this.pos;this.pos=function(mt,$t,bt){for(var Mt,Jt,jt=0;jt<$t.length;jt++){if((Mt=$t.charCodeAt(jt))>55295&&Mt<57344){if(!Jt){Mt>56319||jt+1===$t.length?(mt[bt++]=239,mt[bt++]=191,mt[bt++]=189):Jt=Mt;continue}if(Mt<56320){mt[bt++]=239,mt[bt++]=191,mt[bt++]=189,Jt=Mt;continue}Mt=Jt-55296<<10|Mt-56320|65536,Jt=null}else Jt&&(mt[bt++]=239,mt[bt++]=191,mt[bt++]=189,Jt=null);Mt<128?mt[bt++]=Mt:(Mt<2048?mt[bt++]=Mt>>6|192:(Mt<65536?mt[bt++]=Mt>>12|224:(mt[bt++]=Mt>>18|240,mt[bt++]=Mt>>12&63|128),mt[bt++]=Mt>>6&63|128),mt[bt++]=63&Mt|128)}return bt}(this.buf,se,this.pos);var Xe=this.pos-we;Xe>=128&&R(we,Xe,this),this.pos=we-1,this.writeVarint(Xe),this.pos+=Xe},writeFloat:function(se){this.realloc(4),d.write(this.buf,se,this.pos,!0,23,4),this.pos+=4},writeDouble:function(se){this.realloc(8),d.write(this.buf,se,this.pos,!0,52,8),this.pos+=8},writeBytes:function(se){var we=se.length;this.writeVarint(we),this.realloc(we);for(var Xe=0;Xe<we;Xe++)this.buf[this.pos++]=se[Xe]},writeRawMessage:function(se,we){this.pos++;var Xe=this.pos;se(we,this);var mt=this.pos-Xe;mt>=128&&R(Xe,mt,this),this.pos=Xe-1,this.writeVarint(mt),this.pos+=mt},writeMessage:function(se,we,Xe){this.writeTag(se,l.Bytes),this.writeRawMessage(we,Xe)},writePackedVarint:function(se,we){we.length&&this.writeMessage(se,O,we)},writePackedSVarint:function(se,we){we.length&&this.writeMessage(se,B,we)},writePackedBoolean:function(se,we){we.length&&this.writeMessage(se,ie,we)},writePackedFloat:function(se,we){we.length&&this.writeMessage(se,G,we)},writePackedDouble:function(se,we){we.length&&this.writeMessage(se,X,we)},writePackedFixed32:function(se,we){we.length&&this.writeMessage(se,ae,we)},writePackedSFixed32:function(se,we){we.length&&this.writeMessage(se,ce,we)},writePackedFixed64:function(se,we){we.length&&this.writeMessage(se,de,we)},writePackedSFixed64:function(se,we){we.length&&this.writeMessage(se,Ce,we)},writeBytesField:function(se,we){this.writeTag(se,l.Bytes),this.writeBytes(we)},writeFixed32Field:function(se,we){this.writeTag(se,l.Fixed32),this.writeFixed32(we)},writeSFixed32Field:function(se,we){this.writeTag(se,l.Fixed32),this.writeSFixed32(we)},writeFixed64Field:function(se,we){this.writeTag(se,l.Fixed64),this.writeFixed64(we)},writeSFixed64Field:function(se,we){this.writeTag(se,l.Fixed64),this.writeSFixed64(we)},writeVarintField:function(se,we){this.writeTag(se,l.Varint),this.writeVarint(we)},writeSVarintField:function(se,we){this.writeTag(se,l.Varint),this.writeSVarint(we)},writeStringField:function(se,we){this.writeTag(se,l.Bytes),this.writeString(we)},writeFloatField:function(se,we){this.writeTag(se,l.Fixed32),this.writeFloat(we)},writeDoubleField:function(se,we){this.writeTag(se,l.Fixed64),this.writeDouble(we)},writeBooleanField:function(se,we){this.writeVarintField(se,!!we)}},yC}var Yu,xC=f(aD());function Hq(d,l,h){d===1&&h.readMessage(Gq,l)}function Gq(d,l,h){if(d===3){const{id:p,bitmap:y,width:S,height:E,left:R,top:O,advance:B}=h.readMessage(Wq,{});l.push({id:p,bitmap:new qv({width:S+6,height:E+6},y),metrics:{width:S,height:E,left:R,top:O,advance:B}})}}function Wq(d,l,h){d===1?l.id=h.readVarint():d===2?l.bitmap=h.readBytes():d===3?l.width=h.readVarint():d===4?l.height=h.readVarint():d===5?l.left=h.readSVarint():d===6?l.top=h.readSVarint():d===7&&(l.advance=h.readVarint())}function lD(d){let l=0,h=0;for(const E of d)l+=E.w*E.h,h=Math.max(h,E.w);d.sort((E,R)=>R.h-E.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),h),h:1/0}];let y=0,S=0;for(const E of d)for(let R=p.length-1;R>=0;R--){const O=p[R];if(!(E.w>O.w||E.h>O.h)){if(E.x=O.x,E.y=O.y,S=Math.max(S,E.y+E.h),y=Math.max(y,E.x+E.w),E.w===O.w&&E.h===O.h){const B=p.pop();R<p.length&&(p[R]=B)}else E.h===O.h?(O.x+=E.w,O.w-=E.w):E.w===O.w?(O.y+=E.h,O.h-=E.h):(p.push({x:O.x+E.w,y:O.y,w:O.w-E.w,h:E.h}),O.y+=E.h,O.h-=E.h);break}}return{w:y,h:S,fill:l/(y*S)||0}}class bC{constructor(l,{pixelRatio:h,version:p,stretchX:y,stretchY:S,content:E,textFitWidth:R,textFitHeight:O}){this.paddedRect=l,this.pixelRatio=h,this.stretchX=y,this.stretchY=S,this.content=E,this.version=p,this.textFitWidth=R,this.textFitHeight=O}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class cD{constructor(l,h){const p={},y={};this.haveRenderCallbacks=[];const S=[];this.addImages(l,p,S),this.addImages(h,y,S);const{w:E,h:R}=lD(S),O=new ds({width:E||1,height:R||1});for(const B in l){const G=l[B],X=p[B].paddedRect;ds.copy(G.data,O,{x:0,y:0},{x:X.x+1,y:X.y+1},G.data)}for(const B in h){const G=h[B],X=y[B].paddedRect,ie=X.x+1,ae=X.y+1,ce=G.data.width,de=G.data.height;ds.copy(G.data,O,{x:0,y:0},{x:ie,y:ae},G.data),ds.copy(G.data,O,{x:0,y:de-1},{x:ie,y:ae-1},{width:ce,height:1}),ds.copy(G.data,O,{x:0,y:0},{x:ie,y:ae+de},{width:ce,height:1}),ds.copy(G.data,O,{x:ce-1,y:0},{x:ie-1,y:ae},{width:1,height:de}),ds.copy(G.data,O,{x:0,y:0},{x:ie+ce,y:ae},{width:1,height:de})}this.image=O,this.iconPositions=p,this.patternPositions=y}addImages(l,h,p){for(const y in l){const S=l[y],E={x:0,y:0,w:S.data.width+2,h:S.data.height+2};p.push(E),h[y]=new bC(E,S),S.hasRenderCallback&&this.haveRenderCallbacks.push(y)}}patchUpdatedImages(l,h){l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in l.updatedImages)this.patchUpdatedImage(this.iconPositions[p],l.getImage(p),h),this.patchUpdatedImage(this.patternPositions[p],l.getImage(p),h)}patchUpdatedImage(l,h,p){if(!l||!h||l.version===h.version)return;l.version=h.version;const[y,S]=l.tl;p.update(h.data,void 0,{x:y,y:S})}}xn("ImagePosition",bC),xn("ImageAtlas",cD),c.an=void 0,(Yu=c.an||(c.an={}))[Yu.none=0]="none",Yu[Yu.horizontal=1]="horizontal",Yu[Yu.vertical=2]="vertical",Yu[Yu.horizontalOnly=3]="horizontalOnly";class i0{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(l,h,p){const y=new i0;return y.scale=l||1,y.fontStack=h,y.verticalAlign=p||"bottom",y}static forImage(l,h){const p=new i0;return p.imageName=l,p.verticalAlign=h||"bottom",p}}class Dp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(l,h){const p=new Dp;for(let y=0;y<l.sections.length;y++){const S=l.sections[y];S.image?p.addImageSection(S):p.addTextSection(S,h)}return p}length(){return this.text.length}getSection(l){return this.sections[this.sectionIndex[l]]}getSectionIndex(l){return this.sectionIndex[l]}getCharCode(l){return this.text.charCodeAt(l)}verticalizePunctuation(){this.text=function(l){let h="";for(let p=0;p<l.length;p++){const y=l.charCodeAt(p+1)||null,S=l.charCodeAt(p-1)||null;h+=y&&zv(y)&&!r0[l[p+1]]||S&&zv(S)&&!r0[l[p-1]]||!r0[l[p]]?l[p]:r0[l[p]]}return h}(this.text)}trim(){let l=0;for(let p=0;p<this.text.length&&g1[this.text.charCodeAt(p)];p++)l++;let h=this.text.length;for(let p=this.text.length-1;p>=0&&p>=l&&g1[this.text.charCodeAt(p)];p--)h--;this.text=this.text.substring(l,h),this.sectionIndex=this.sectionIndex.slice(l,h)}substring(l,h){const p=new Dp;return p.text=this.text.substring(l,h),p.sectionIndex=this.sectionIndex.slice(l,h),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((l,h)=>Math.max(l,this.sections[h].scale),0)}getMaxImageSize(l){let h=0,p=0;for(let y=0;y<this.length();y++){const S=this.getSection(y);if(S.imageName){const E=l[S.imageName];if(!E)continue;const R=E.displaySize;h=Math.max(h,R[0]),p=Math.max(p,R[1])}}return{maxImageWidth:h,maxImageHeight:p}}addTextSection(l,h){this.text+=l.text,this.sections.push(i0.forText(l.scale,l.fontStack||h,l.verticalAlign));const p=this.sections.length-1;for(let y=0;y<l.text.length;++y)this.sectionIndex.push(p)}addImageSection(l){const h=l.image?l.image.name:"";if(h.length===0)return void tn("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(i0.forImage(h,l.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):tn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function m1(d,l,h,p,y,S,E,R,O,B,G,X,ie,ae,ce){const de=Dp.fromFeature(d,y);let Ce;X===c.an.vertical&&de.verticalizePunctuation();const{processBidirectionalText:ke,processStyledBidirectionalText:et}=Vl;if(ke&&de.sections.length===1){Ce=[];const we=ke(de.toString(),wC(de,B,S,l,p,ae));for(const Xe of we){const mt=new Dp;mt.text=Xe,mt.sections=de.sections;for(let $t=0;$t<Xe.length;$t++)mt.sectionIndex.push(0);Ce.push(mt)}}else if(et){Ce=[];const we=et(de.text,de.sectionIndex,wC(de,B,S,l,p,ae));for(const Xe of we){const mt=new Dp;mt.text=Xe[0],mt.sectionIndex=Xe[1],mt.sections=de.sections,Ce.push(mt)}}else Ce=function(we,Xe){const mt=[],$t=we.text;let bt=0;for(const Mt of Xe)mt.push(we.substring(bt,Mt)),bt=Mt;return bt<$t.length&&mt.push(we.substring(bt,$t.length)),mt}(de,wC(de,B,S,l,p,ae));const Ge=[],se={positionedLines:Ge,text:de.toString(),top:G[1],bottom:G[1],left:G[0],right:G[0],writingMode:X,iconsInText:!1,verticalizable:!1};return function(we,Xe,mt,$t,bt,Mt,Jt,jt,en,Pt,Cn,$n){let Bn=0,kn=0,or=0,ci=0;const ki=jt==="right"?1:jt==="left"?0:.5,xo=Wi/$n;let na=0;for(const ii of bt){ii.trim();const qi=ii.getMaxScale(),so={positionedGlyphs:[],lineOffset:0};we.positionedLines[na]=so;const ao=so.positionedGlyphs;let es=0;if(!ii.length()){kn+=Mt,++na;continue}const ra=Yq($t,ii,xo);for(let ps=0;ps<ii.length();ps++){const Di=ii.getSection(ps),Zi=ii.getSectionIndex(ps),Yi=ii.getCharCode(ps),Mi=Kq(en,Cn,Yi);let Wr;if(Di.imageName){if(we.iconsInText=!0,Di.scale=Di.scale*xo,Wr=Qq(Di,Mi,qi,ra,$t),!Wr)continue;es=Math.max(es,Wr.imageOffset)}else if(Wr=Jq(Di,Yi,Mi,ra,Xe,mt),!Wr)continue;const{rect:hl,metrics:Np,baselineOffset:dl}=Wr;ao.push({glyph:Yi,imageName:Di.imageName,x:Bn,y:kn+dl+-17,vertical:Mi,scale:Di.scale,fontStack:Di.fontStack,sectionIndex:Zi,metrics:Np,rect:hl}),Mi?(we.verticalizable=!0,Bn+=(Di.imageName?Np.advance:Wi)*Di.scale+Pt):Bn+=Np.advance*Di.scale+Pt}ao.length!==0&&(or=Math.max(Bn-Pt,or),eX(ao,0,ao.length-1,ki)),Bn=0,so.lineOffset=Math.max(es,(qi-1)*Wi);const Xi=Mt*qi+es;kn+=Xi,ci=Math.max(Xi,ci),++na}const{horizontalAlign:fs,verticalAlign:oo}=SC(Jt);(function(ii,qi,so,ao,es,ra,Xi,ps,Di){const Zi=(qi-so)*es;let Yi=0;Yi=ra!==Xi?-ps*ao- -17:-ao*Di*Xi+.5*Xi;for(const Mi of ii)for(const Wr of Mi.positionedGlyphs)Wr.x+=Zi,Wr.y+=Yi})(we.positionedLines,ki,fs,oo,or,ci,Mt,kn,bt.length),we.top+=-oo*kn,we.bottom=we.top+kn,we.left+=-fs*or,we.right=we.left+or}(se,l,h,p,Ce,E,R,O,X,B,ie,ce),!function(we){for(const Xe of we)if(Xe.positionedGlyphs.length!==0)return!1;return!0}(Ge)&&se}const g1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},qq={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Xq={40:!0};function uD(d,l,h,p,y,S){if(l.imageName){const E=p[l.imageName];return E?E.displaySize[0]*l.scale*Wi/S+y:0}{const E=h[l.fontStack],R=E&&E[d];return R?R.metrics.advance*l.scale+y:0}}function hD(d,l,h,p){const y=Math.pow(d-l,2);return p?d<l?y/2:2*y:y+Math.abs(h)*h}function Zq(d,l,h){let p=0;return d===10&&(p-=1e4),h&&(p+=150),d!==40&&d!==65288||(p+=50),l!==41&&l!==65289||(p+=50),p}function dD(d,l,h,p,y,S){let E=null,R=hD(l,h,y,S);for(const O of p){const B=hD(l-O.x,h,y,S)+O.badness;B<=R&&(E=O,R=B)}return{index:d,x:l,priorBreak:E,badness:R}}function fD(d){return d?fD(d.priorBreak).concat(d.index):[]}function wC(d,l,h,p,y,S){if(!d)return[];const E=[],R=function(X,ie,ae,ce,de,Ce){let ke=0;for(let et=0;et<X.length();et++){const Ge=X.getSection(et);ke+=uD(X.getCharCode(et),Ge,ce,de,ie,Ce)}return ke/Math.max(1,Math.ceil(ke/ae))}(d,l,h,p,y,S),O=d.text.indexOf("")>=0;let B=0;for(let X=0;X<d.length();X++){const ie=d.getSection(X),ae=d.getCharCode(X);if(g1[ae]||(B+=uD(ae,ie,p,y,l,S)),X<d.length()-1){const ce=!((G=ae)<11904)&&(!!rr["CJK Compatibility Forms"](G)||!!rr["CJK Compatibility"](G)||!!rr["CJK Strokes"](G)||!!rr["CJK Symbols and Punctuation"](G)||!!rr["Enclosed CJK Letters and Months"](G)||!!rr["Halfwidth and Fullwidth Forms"](G)||!!rr["Ideographic Description Characters"](G)||!!rr["Vertical Forms"](G)||Dv.test(String.fromCodePoint(G)));(qq[ae]||ce||ie.imageName||X!==d.length()-2&&Xq[d.getCharCode(X+1)])&&E.push(dD(X+1,B,R,E,Zq(ae,d.getCharCode(X+1),ce&&O),!1))}}var G;return fD(dD(d.length(),B,R,E,0,!0))}function SC(d){let l=.5,h=.5;switch(d){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:l,verticalAlign:h}}function Yq(d,l,h){const p=l.getMaxScale()*Wi,{maxImageWidth:y,maxImageHeight:S}=l.getMaxImageSize(d),E=Math.max(p,S*h);return{verticalLineContentWidth:Math.max(p,y*h),horizontalLineContentHeight:E}}function pD(d){switch(d){case"top":return 0;case"center":return .5;default:return 1}}function Kq(d,l,h){return!(d===c.an.horizontal||!l&&!Mp(h)||l&&(g1[h]||(p=h,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(p)))));var p}function Jq(d,l,h,p,y,S){const E=S[d.fontStack],R=function(B,G,X,ie){if(B&&B.rect)return B;const ae=G[X.fontStack],ce=ae&&ae[ie];return ce?{rect:null,metrics:ce.metrics}:null}(E&&E[l],y,d,l);if(R===null)return null;let O;if(h)O=p.verticalLineContentWidth-d.scale*Wi;else{const B=pD(d.verticalAlign);O=(p.horizontalLineContentHeight-d.scale*Wi)*B}return{rect:R.rect,metrics:R.metrics,baselineOffset:O}}function Qq(d,l,h,p,y){const S=y[d.imageName];if(!S)return null;const E=S.paddedRect,R=S.displaySize,O={width:R[0],height:R[1],left:1,top:-3,advance:l?R[1]:R[0]};let B;if(l)B=p.verticalLineContentWidth-R[1]*d.scale;else{const G=pD(d.verticalAlign);B=(p.horizontalLineContentHeight-R[1]*d.scale)*G}return{rect:E,metrics:O,baselineOffset:B,imageOffset:(l?R[0]:R[1])*d.scale-Wi*h}}function eX(d,l,h,p){if(p===0)return;const y=d[h],S=(d[h].x+y.metrics.advance*y.scale)*p;for(let E=l;E<=h;E++)d[E].x-=S}function tX(d,l,h){const{horizontalAlign:p,verticalAlign:y}=SC(h),S=l[0]-d.displaySize[0]*p,E=l[1]-d.displaySize[1]*y;return{image:d,top:E,bottom:E+d.displaySize[1],left:S,right:S+d.displaySize[0]}}function mD(d){var l,h;let p=d.left,y=d.top,S=d.right-p,E=d.bottom-y;const R=(l=d.image.textFitWidth)!==null&&l!==void 0?l:"stretchOrShrink",O=(h=d.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",B=(d.image.content[2]-d.image.content[0])/(d.image.content[3]-d.image.content[1]);if(O==="proportional"){if(R==="stretchOnly"&&S/E<B||R==="proportional"){const G=Math.ceil(E*B);p*=G/S,S=G}}else if(R==="proportional"&&O==="stretchOnly"&&B!==0&&S/E>B){const G=Math.ceil(S/B);y*=G/E,E=G}return{x1:p,y1:y,x2:p+S,y2:y+E}}function gD(d,l,h,p,y,S){const E=d.image;let R;if(E.content){const Ce=E.content,ke=E.pixelRatio||1;R=[Ce[0]/ke,Ce[1]/ke,E.displaySize[0]-Ce[2]/ke,E.displaySize[1]-Ce[3]/ke]}const O=l.left*S,B=l.right*S;let G,X,ie,ae;h==="width"||h==="both"?(ae=y[0]+O-p[3],X=y[0]+B+p[1]):(ae=y[0]+(O+B-E.displaySize[0])/2,X=ae+E.displaySize[0]);const ce=l.top*S,de=l.bottom*S;return h==="height"||h==="both"?(G=y[1]+ce-p[0],ie=y[1]+de+p[2]):(G=y[1]+(ce+de-E.displaySize[1])/2,ie=G+E.displaySize[1]),{image:E,top:G,right:X,bottom:ie,left:ae,collisionPadding:R}}const Nc=128,Ku=32640;function vD(d,l){const{expression:h}=l;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Zr(d+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:y}=h;let S=0;for(;S<p.length&&p[S]<=d;)S++;S=Math.max(0,S-1);let E=S;for(;E<p.length&&p[E]<d+1;)E++;E=Math.min(p.length-1,E);const R=p[S],O=p[E];return h.kind==="composite"?{kind:"composite",minZoom:R,maxZoom:O,interpolationType:y}:{kind:"camera",minZoom:R,maxZoom:O,minSize:h.evaluate(new Zr(R)),maxSize:h.evaluate(new Zr(O)),interpolationType:y}}}function MC(d,l,h){let p="never";const y=d.get(l);return y?p=y:d.get(h)&&(p="always"),p}const nX=e0.VectorTileFeature.types,rX=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function v1(d,l,h,p,y,S,E,R,O,B,G,X,ie){const ae=R?Math.min(Ku,Math.round(R[0])):0,ce=R?Math.min(Ku,Math.round(R[1])):0;d.emplaceBack(l,h,Math.round(32*p),Math.round(32*y),S,E,(ae<<1)+(O?1:0),ce,16*B,16*G,256*X,256*ie)}function CC(d,l,h){d.emplaceBack(l.x,l.y,h),d.emplaceBack(l.x,l.y,h),d.emplaceBack(l.x,l.y,h),d.emplaceBack(l.x,l.y,h)}function iX(d){for(const l of d.sections)if(Ov(l.text))return!0;return!1}class EC{constructor(l){this.layoutVertexArray=new Jn,this.indexArray=new zr,this.programConfigurations=l,this.segments=new hr,this.dynamicLayoutVertexArray=new Cr,this.opacityVertexArray=new ni,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ie}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,h,p,y){this.isEmpty()||(p&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Nq.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,Bq.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,rX,!0),this.opacityVertexBuffer.itemSize=1),(p||y)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}xn("SymbolBuffers",EC);class TC{constructor(l,h,p){this.layoutVertexArray=new l,this.layoutAttributes=h,this.indexArray=new p,this.segments=new hr,this.collisionVertexArray=new ri}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,Uq.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}xn("CollisionBuffers",TC);class zp{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.globalState=l.globalState,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(E=>E.id),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=vD(this.zoom,h["text-size"]),this.iconSizeData=vD(this.zoom,h["icon-size"]);const p=this.layers[0].layout,y=p.get("symbol-sort-key"),S=p.get("symbol-z-order");this.canOverlap=MC(p,"text-overlap","text-allow-overlap")!=="never"||MC(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=S!=="viewport-y"&&!y.isConstant(),this.sortFeaturesByY=(S==="viewport-y"||S==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(E=>c.an[E])),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=l.sourceID}createArrays(){this.text=new EC(new Zl(this.layers,this.zoom,l=>/^text/.test(l))),this.icon=new EC(new Zl(this.layers,this.zoom,l=>/^icon/.test(l))),this.glyphOffsetArray=new Be,this.lineVertexArray=new Ye,this.symbolInstances=new He,this.textAnchorOffsets=new $e}calculateGlyphDependencies(l,h,p,y,S){for(let E=0;E<l.length;E++)if(h[l.charCodeAt(E)]=!0,(p||y)&&S){const R=r0[l.charAt(E)];R&&(h[R.charCodeAt(0)]=!0)}}populate(l,h,p){const y=this.layers[0],S=y.layout,E=S.get("text-font"),R=S.get("text-field"),O=S.get("icon-image"),B=(R.value.kind!=="constant"||R.value.value instanceof vo&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),G=O.value.kind!=="constant"||!!O.value.value||Object.keys(O.parameters).length>0,X=S.get("symbol-sort-key");if(this.features=[],!B&&!G)return;const ie=h.iconDependencies,ae=h.glyphDependencies,ce=h.availableImages,de=new Zr(this.zoom,{globalState:this.globalState});for(const{feature:Ce,id:ke,index:et,sourceLayerIndex:Ge}of l){const se=y._featureFilter.needGeometry,we=Hd(Ce,se);if(!y._featureFilter.filter(de,we,p))continue;let Xe,mt;if(se||(we.geometry=jd(Ce)),B){const bt=y.getValueAndResolveTokens("text-field",we,p,ce),Mt=vo.factory(bt),Jt=this.hasRTLText=this.hasRTLText||iX(Mt);(!Jt||Vl.getRTLTextPluginStatus()==="unavailable"||Jt&&Vl.isParsed())&&(Xe=Vq(Mt,y,we))}if(G){const bt=y.getValueAndResolveTokens("icon-image",we,p,ce);mt=bt instanceof Zo?bt:Zo.fromString(bt)}if(!Xe&&!mt)continue;const $t=this.sortFeaturesByKey?X.evaluate(we,{},p):void 0;if(this.features.push({id:ke,text:Xe,icon:mt,index:et,sourceLayerIndex:Ge,geometry:we.geometry,properties:Ce.properties,type:nX[Ce.type],sortKey:$t}),mt&&(ie[mt.name]=!0),Xe){const bt=E.evaluate(we,{},p).join(","),Mt=S.get("text-rotation-alignment")!=="viewport"&&S.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(c.an.vertical)>=0;for(const Jt of Xe.sections)if(Jt.image)ie[Jt.image.name]=!0;else{const jt=kv(Xe.toString()),en=Jt.fontStack||bt,Pt=ae[en]=ae[en]||{};this.calculateGlyphDependencies(Jt.text,Pt,Mt,this.allowVerticalPlacement,jt)}}}S.get("symbol-placement")==="line"&&(this.features=function(Ce){const ke={},et={},Ge=[];let se=0;function we(bt){Ge.push(Ce[bt]),se++}function Xe(bt,Mt,Jt){const jt=et[bt];return delete et[bt],et[Mt]=jt,Ge[jt].geometry[0].pop(),Ge[jt].geometry[0]=Ge[jt].geometry[0].concat(Jt[0]),jt}function mt(bt,Mt,Jt){const jt=ke[Mt];return delete ke[Mt],ke[bt]=jt,Ge[jt].geometry[0].shift(),Ge[jt].geometry[0]=Jt[0].concat(Ge[jt].geometry[0]),jt}function $t(bt,Mt,Jt){const jt=Jt?Mt[0][Mt[0].length-1]:Mt[0][0];return`${bt}:${jt.x}:${jt.y}`}for(let bt=0;bt<Ce.length;bt++){const Mt=Ce[bt],Jt=Mt.geometry,jt=Mt.text?Mt.text.toString():null;if(!jt){we(bt);continue}const en=$t(jt,Jt),Pt=$t(jt,Jt,!0);if(en in et&&Pt in ke&&et[en]!==ke[Pt]){const Cn=mt(en,Pt,Jt),$n=Xe(en,Pt,Ge[Cn].geometry);delete ke[en],delete et[Pt],et[$t(jt,Ge[$n].geometry,!0)]=$n,Ge[Cn].geometry=null}else en in et?Xe(en,Pt,Jt):Pt in ke?mt(en,Pt,Jt):(we(bt),ke[en]=se-1,et[Pt]=se-1)}return Ge.filter(bt=>bt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ce,ke)=>Ce.sortKey-ke.sortKey)}update(l,h,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,h,this.layers,p),this.icon.programConfigurations.updatePaintArrays(l,h,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,h){const p=this.lineVertexArray.length;if(l.segment!==void 0){let y=l.dist(h[l.segment+1]),S=l.dist(h[l.segment]);const E={};for(let R=l.segment+1;R<h.length;R++)E[R]={x:h[R].x,y:h[R].y,tileUnitDistanceFromAnchor:y},R<h.length-1&&(y+=h[R+1].dist(h[R]));for(let R=l.segment||0;R>=0;R--)E[R]={x:h[R].x,y:h[R].y,tileUnitDistanceFromAnchor:S},R>0&&(S+=h[R-1].dist(h[R]));for(let R=0;R<h.length;R++){const O=E[R];this.lineVertexArray.emplaceBack(O.x,O.y,O.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(l,h,p,y,S,E,R,O,B,G,X,ie){const ae=l.indexArray,ce=l.layoutVertexArray,de=l.segments.prepareSegment(4*h.length,ce,ae,this.canOverlap?E.sortKey:void 0),Ce=this.glyphOffsetArray.length,ke=de.vertexLength,et=this.allowVerticalPlacement&&R===c.an.vertical?Math.PI/2:0,Ge=E.text&&E.text.sections;for(let se=0;se<h.length;se++){const{tl:we,tr:Xe,bl:mt,br:$t,tex:bt,pixelOffsetTL:Mt,pixelOffsetBR:Jt,minFontScaleX:jt,minFontScaleY:en,glyphOffset:Pt,isSDF:Cn,sectionIndex:$n}=h[se],Bn=de.vertexLength,kn=Pt[1];v1(ce,O.x,O.y,we.x,kn+we.y,bt.x,bt.y,p,Cn,Mt.x,Mt.y,jt,en),v1(ce,O.x,O.y,Xe.x,kn+Xe.y,bt.x+bt.w,bt.y,p,Cn,Jt.x,Mt.y,jt,en),v1(ce,O.x,O.y,mt.x,kn+mt.y,bt.x,bt.y+bt.h,p,Cn,Mt.x,Jt.y,jt,en),v1(ce,O.x,O.y,$t.x,kn+$t.y,bt.x+bt.w,bt.y+bt.h,p,Cn,Jt.x,Jt.y,jt,en),CC(l.dynamicLayoutVertexArray,O,et),ae.emplaceBack(Bn,Bn+2,Bn+1),ae.emplaceBack(Bn+1,Bn+2,Bn+3),de.vertexLength+=4,de.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Pt[0]),se!==h.length-1&&$n===h[se+1].sectionIndex||l.programConfigurations.populatePaintArrays(ce.length,E,E.index,{},ie,Ge&&Ge[$n])}l.placedSymbolArray.emplaceBack(O.x,O.y,Ce,this.glyphOffsetArray.length-Ce,ke,B,G,O.segment,p?p[0]:0,p?p[1]:0,y[0],y[1],R,0,!1,0,X)}_addCollisionDebugVertex(l,h,p,y,S,E){return h.emplaceBack(0,0),l.emplaceBack(p.x,p.y,y,S,Math.round(E.x),Math.round(E.y))}addCollisionDebugVertices(l,h,p,y,S,E,R){const O=S.segments.prepareSegment(4,S.layoutVertexArray,S.indexArray),B=O.vertexLength,G=S.layoutVertexArray,X=S.collisionVertexArray,ie=R.anchorX,ae=R.anchorY;this._addCollisionDebugVertex(G,X,E,ie,ae,new A(l,h)),this._addCollisionDebugVertex(G,X,E,ie,ae,new A(p,h)),this._addCollisionDebugVertex(G,X,E,ie,ae,new A(p,y)),this._addCollisionDebugVertex(G,X,E,ie,ae,new A(l,y)),O.vertexLength+=4;const ce=S.indexArray;ce.emplaceBack(B,B+1),ce.emplaceBack(B+1,B+2),ce.emplaceBack(B+2,B+3),ce.emplaceBack(B+3,B),O.primitiveLength+=4}addDebugCollisionBoxes(l,h,p,y){for(let S=l;S<h;S++){const E=this.collisionBoxArray.get(S);this.addCollisionDebugVertices(E.x1,E.y1,E.x2,E.y2,y?this.textCollisionBox:this.iconCollisionBox,E.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new TC(Ar,iD.members,Ir),this.iconCollisionBox=new TC(Ar,iD.members,Ir);for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(l,h,p,y,S,E,R,O,B){const G={};for(let X=h;X<p;X++){const ie=l.get(X);G.textBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},G.textFeatureIndex=ie.featureIndex;break}for(let X=y;X<S;X++){const ie=l.get(X);G.verticalTextBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},G.verticalTextFeatureIndex=ie.featureIndex;break}for(let X=E;X<R;X++){const ie=l.get(X);G.iconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},G.iconFeatureIndex=ie.featureIndex;break}for(let X=O;X<B;X++){const ie=l.get(X);G.verticalIconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},G.verticalIconFeatureIndex=ie.featureIndex;break}return G}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,h){const p=l.placedSymbolArray.get(h),y=p.vertexStartIndex+4*p.numGlyphs;for(let S=p.vertexStartIndex;S<y;S+=4)l.indexArray.emplaceBack(S,S+2,S+1),l.indexArray.emplaceBack(S+1,S+2,S+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(l),p=Math.cos(l),y=[],S=[],E=[];for(let R=0;R<this.symbolInstances.length;++R){E.push(R);const O=this.symbolInstances.get(R);y.push(0|Math.round(h*O.anchorX+p*O.anchorY)),S.push(O.featureIndex)}return E.sort((R,O)=>y[R]-y[O]||S[O]-S[R]),E}addToSortKeyRanges(l,h){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===h?p.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const p=this.symbolInstances.get(h);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((y,S,E)=>{y>=0&&E.indexOf(y)===S&&this.addIndicesForPlacedSymbol(this.text,y)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let yD,_D;xn("SymbolBucket",zp,{omit:["layers","collisionBoxArray","features","compareText"]}),zp.MAX_GLYPHS=65535,zp.addDynamicAttributes=CC;var PC={get paint(){return _D=_D||new Do({"icon-opacity":new Vn(Oe.paint_symbol["icon-opacity"]),"icon-color":new Vn(Oe.paint_symbol["icon-color"]),"icon-halo-color":new Vn(Oe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Vn(Oe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Vn(Oe.paint_symbol["icon-halo-blur"]),"icon-translate":new En(Oe.paint_symbol["icon-translate"]),"icon-translate-anchor":new En(Oe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Vn(Oe.paint_symbol["text-opacity"]),"text-color":new Vn(Oe.paint_symbol["text-color"],{runtimeType:pn,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new Vn(Oe.paint_symbol["text-halo-color"]),"text-halo-width":new Vn(Oe.paint_symbol["text-halo-width"]),"text-halo-blur":new Vn(Oe.paint_symbol["text-halo-blur"]),"text-translate":new En(Oe.paint_symbol["text-translate"]),"text-translate-anchor":new En(Oe.paint_symbol["text-translate-anchor"])})},get layout(){return yD=yD||new Do({"symbol-placement":new En(Oe.layout_symbol["symbol-placement"]),"symbol-spacing":new En(Oe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new En(Oe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Vn(Oe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new En(Oe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new En(Oe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new En(Oe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new En(Oe.layout_symbol["icon-ignore-placement"]),"icon-optional":new En(Oe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new En(Oe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Vn(Oe.layout_symbol["icon-size"]),"icon-text-fit":new En(Oe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new En(Oe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Vn(Oe.layout_symbol["icon-image"]),"icon-rotate":new Vn(Oe.layout_symbol["icon-rotate"]),"icon-padding":new Vn(Oe.layout_symbol["icon-padding"]),"icon-keep-upright":new En(Oe.layout_symbol["icon-keep-upright"]),"icon-offset":new Vn(Oe.layout_symbol["icon-offset"]),"icon-anchor":new Vn(Oe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new En(Oe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new En(Oe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new En(Oe.layout_symbol["text-rotation-alignment"]),"text-field":new Vn(Oe.layout_symbol["text-field"]),"text-font":new Vn(Oe.layout_symbol["text-font"]),"text-size":new Vn(Oe.layout_symbol["text-size"]),"text-max-width":new Vn(Oe.layout_symbol["text-max-width"]),"text-line-height":new En(Oe.layout_symbol["text-line-height"]),"text-letter-spacing":new Vn(Oe.layout_symbol["text-letter-spacing"]),"text-justify":new Vn(Oe.layout_symbol["text-justify"]),"text-radial-offset":new Vn(Oe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new En(Oe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Vn(Oe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Vn(Oe.layout_symbol["text-anchor"]),"text-max-angle":new En(Oe.layout_symbol["text-max-angle"]),"text-writing-mode":new En(Oe.layout_symbol["text-writing-mode"]),"text-rotate":new Vn(Oe.layout_symbol["text-rotate"]),"text-padding":new En(Oe.layout_symbol["text-padding"]),"text-keep-upright":new En(Oe.layout_symbol["text-keep-upright"]),"text-transform":new Vn(Oe.layout_symbol["text-transform"]),"text-offset":new Vn(Oe.layout_symbol["text-offset"]),"text-allow-overlap":new En(Oe.layout_symbol["text-allow-overlap"]),"text-overlap":new En(Oe.layout_symbol["text-overlap"]),"text-ignore-placement":new En(Oe.layout_symbol["text-ignore-placement"]),"text-optional":new En(Oe.layout_symbol["text-optional"])})}};class xD{constructor(l){if(l.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=l.property.overrides?l.property.overrides.runtimeType:xt,this.defaultValue=l}evaluate(l){if(l.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(l.formattedSection))return h.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}xn("FormatSectionOverride",xD,{omit:["defaultValue"]});class y1 extends to{constructor(l){super(l,PC)}recalculate(l,h){if(super.recalculate(l,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const y=[];for(const S of p)y.indexOf(S)<0&&y.push(S);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(l,h,p,y){const S=this.layout.get(l).evaluate(h,{},p,y),E=this._unevaluatedLayout._values[l];return E.isDataDriven()||dp(E.value)||!S?S:function(R,O){return O.replace(/{([^{}]+)}/g,(B,G)=>R&&G in R?String(R[G]):"")}(h.properties,S)}createBucket(l){return new zp(l)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const l of PC.paint.overridableProperties){if(!y1.hasPaintOverride(this.layout,l))continue;const h=this.paint.get(l),p=new xD(h),y=new hp(p,h.property.specification);let S=null;S=h.value.kind==="constant"||h.value.kind==="source"?new Ed("source",y):new pp("composite",y,h.value.zoomStops),this.paint._values[l]=new Da(h.property,S,h.parameters)}}_handleOverridablePaintPropertyUpdate(l,h,p){return!(!this.layout||h.isDataDriven()||p.isDataDriven())&&y1.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,h){const p=l.get("text-field"),y=PC.paint.properties[h];let S=!1;const E=R=>{for(const O of R)if(y.overrides&&y.overrides.hasOverride(O))return void(S=!0)};if(p.value.kind==="constant"&&p.value.value instanceof vo)E(p.value.value.sections);else if(p.value.kind==="source"){const R=B=>{S||(B instanceof Ro&&Gn(B.value)===vt?E(B.value.sections):B instanceof _d?E(B.sections):B.eachChild(R))},O=p.value;O._styleExpression&&R(O._styleExpression.expression)}return S}}let bD;var oX={get paint(){return bD=bD||new Do({"background-color":new En(Oe.paint_background["background-color"]),"background-pattern":new Nv(Oe.paint_background["background-pattern"]),"background-opacity":new En(Oe.paint_background["background-opacity"])})}};class sX extends to{constructor(l){super(l,oX)}}let wD;var aX={get paint(){return wD=wD||new Do({"raster-opacity":new En(Oe.paint_raster["raster-opacity"]),"raster-hue-rotate":new En(Oe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new En(Oe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new En(Oe.paint_raster["raster-brightness-max"]),"raster-saturation":new En(Oe.paint_raster["raster-saturation"]),"raster-contrast":new En(Oe.paint_raster["raster-contrast"]),"raster-resampling":new En(Oe.paint_raster["raster-resampling"]),"raster-fade-duration":new En(Oe.paint_raster["raster-fade-duration"])})}};class lX extends to{constructor(l){super(l,aX)}}class cX extends to{constructor(l){super(l,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class uX{constructor(l){this._methodToThrottle=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const hX={once:!0},AC=63710088e-1;class Ju{constructor(l,h){if(isNaN(l)||isNaN(h))throw new Error(`Invalid LngLat object: (${l}, ${h})`);if(this.lng=+l,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ju(Ct(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const h=Math.PI/180,p=this.lat*h,y=l.lat*h,S=Math.sin(p)*Math.sin(y)+Math.cos(p)*Math.cos(y)*Math.cos((l.lng-this.lng)*h);return AC*Math.acos(Math.min(S,1))}static convert(l){if(l instanceof Ju)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new Ju(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new Ju(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const SD=2*Math.PI*AC;function MD(d){return SD*Math.cos(d*Math.PI/180)}function CD(d){return(180+d)/360}function ED(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function TD(d,l){return d/MD(l)}function IC(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function PD(d,l){return d*MD(IC(l))}class o0{constructor(l,h,p=0){this.x=+l,this.y=+h,this.z=+p}static fromLngLat(l,h=0){const p=Ju.convert(l);return new o0(CD(p.lng),ED(p.lat),TD(h,p.lat))}toLngLat(){return new Ju(360*this.x-180,IC(this.y))}toAltitude(){return PD(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/SD*(l=IC(this.y),1/Math.cos(l*Math.PI/180));var l}}function AD(d,l,h){var p=2*Math.PI*6378137/256/Math.pow(2,h);return[d*p-2*Math.PI*6378137/2,l*p-2*Math.PI*6378137/2]}class RC{constructor(l,h,p){if(!function(y,S,E){return!(y<0||y>25||E<0||E>=Math.pow(2,y)||S<0||S>=Math.pow(2,y))}(l,h,p))throw new Error(`x=${h}, y=${p}, z=${l} outside of bounds. 0<=x<${Math.pow(2,l)}, 0<=y<${Math.pow(2,l)} 0<=z<=25 `);this.z=l,this.x=h,this.y=p,this.key=Op(0,l,l,h,p)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,h,p){const y=(E=this.y,R=this.z,O=AD(256*(S=this.x),256*(E=Math.pow(2,R)-E-1),R),B=AD(256*(S+1),256*(E+1),R),O[0]+","+O[1]+","+B[0]+","+B[1]);var S,E,R,O,B;const G=function(X,ie,ae){let ce,de="";for(let Ce=X;Ce>0;Ce--)ce=1<<Ce-1,de+=(ie&ce?1:0)+(ae&ce?2:0);return de}(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,G).replace(/{bbox-epsg-3857}/g,y)}isChildOf(l){const h=this.z-l.z;return h>0&&l.x===this.x>>h&&l.y===this.y>>h}getTilePoint(l){const h=Math.pow(2,this.z);return new A((l.x*h-this.x)*ct,(l.y*h-this.y)*ct)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ID{constructor(l,h){this.wrap=l,this.canonical=h,this.key=Op(l,h.z,h.z,h.x,h.y)}}class ta{constructor(l,h,p,y,S){if(this.terrainRttPosMatrix32f=null,l<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${l}; z = ${p}`);this.overscaledZ=l,this.wrap=h,this.canonical=new RC(p,+y,+S),this.key=Op(h,l,p,y,S)}clone(){return new ta(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-l;return l>this.canonical.z?new ta(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ta(l,this.wrap,l,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(l,h){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-l;return l>this.canonical.z?Op(this.wrap*+h,l,this.canonical.z,this.canonical.x,this.canonical.y):Op(this.wrap*+h,l,l,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(l){if(l.wrap!==this.wrap)return!1;const h=this.canonical.z-l.canonical.z;return l.overscaledZ===0||l.overscaledZ<this.overscaledZ&&l.canonical.x===this.canonical.x>>h&&l.canonical.y===this.canonical.y>>h}children(l){if(this.overscaledZ>=l)return[new ta(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,p=2*this.canonical.x,y=2*this.canonical.y;return[new ta(h,this.wrap,h,p,y),new ta(h,this.wrap,h,p+1,y),new ta(h,this.wrap,h,p,y+1),new ta(h,this.wrap,h,p+1,y+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new ta(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new ta(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ID(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(l){return this.canonical.getTilePoint(new o0(l.x-this.wrap,l.y))}}function Op(d,l,h,p,y){(d*=2)<0&&(d=-1*d-1);const S=1<<h;return(S*S*d+S*y+p).toString(36)+h.toString(36)+l.toString(36)}xn("CanonicalTileID",RC),xn("OverscaledTileID",ta,{omit:["terrainRttPosMatrix32f"]});class qd{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(l){return this.minX=Math.min(this.minX,l.x),this.minY=Math.min(this.minY,l.y),this.maxX=Math.max(this.maxX,l.x),this.maxY=Math.max(this.maxY,l.y),this}expandBy(l){return this.minX-=l,this.minY-=l,this.maxX+=l,this.maxY+=l,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(l){return this.expandBy(-l)}map(l){const h=new qd;return h.extend(l(new A(this.minX,this.minY))),h.extend(l(new A(this.maxX,this.minY))),h.extend(l(new A(this.minX,this.maxY))),h.extend(l(new A(this.maxX,this.maxY))),h}static fromPoints(l){const h=new qd;for(const p of l)h.extend(p);return h}contains(l){return l.x>=this.minX&&l.x<=this.maxX&&l.y>=this.minY&&l.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(l){return!this.empty()&&!l.empty()&&l.minX>=this.minX&&l.maxX<=this.maxX&&l.minY>=this.minY&&l.maxY<=this.maxY}intersects(l){return!this.empty()&&!l.empty()&&l.minX<=this.maxX&&l.maxX>=this.minX&&l.minY<=this.maxY&&l.maxY>=this.minY}}class RD{constructor(l){this._stringToNumber={},this._numberToString=[];for(let h=0;h<l.length;h++){const p=l[h];this._stringToNumber[p]=h,this._numberToString[h]=p}}encode(l){return this._stringToNumber[l]}decode(l){if(l>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${l} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[l]}}class LD{constructor(l,h,p,y,S){this.type="Feature",this._vectorTileFeature=l,l._z=h,l._x=p,l._y=y,this.properties=l.properties,this.id=S}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(l[h]=this[h]);return l}}class kD{constructor(l,h){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new Wu(ct,16,0),this.grid3D=new Wu(ct,16,0),this.featureIndexArray=new yt,this.promoteId=h}insert(l,h,p,y,S,E){const R=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,y,S);const O=E?this.grid3D:this.grid;for(let B=0;B<h.length;B++){const G=h[B],X=[1/0,1/0,-1/0,-1/0];for(let ie=0;ie<G.length;ie++){const ae=G[ie];X[0]=Math.min(X[0],ae.x),X[1]=Math.min(X[1],ae.y),X[2]=Math.max(X[2],ae.x),X[3]=Math.max(X[3],ae.y)}X[0]<ct&&X[1]<ct&&X[2]>=0&&X[3]>=0&&O.insert(R,X[0],X[1],X[2],X[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new e0.VectorTile(new xC(this.rawTileData)).layers,this.sourceLayerCoder=new RD(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(l,h,p,y){this.loadVTLayers();const S=l.params,E=ct/l.tileSize/l.scale,R=Ul(S.filter),O=l.queryGeometry,B=l.queryPadding*E,G=qd.fromPoints(O),X=this.grid.query(G.minX-B,G.minY-B,G.maxX+B,G.maxY+B),ie=qd.fromPoints(l.cameraQueryGeometry).expandBy(B),ae=this.grid3D.query(ie.minX,ie.minY,ie.maxX,ie.maxY,(Ce,ke,et,Ge)=>function(se,we,Xe,mt,$t){for(const Mt of se)if(we<=Mt.x&&Xe<=Mt.y&&mt>=Mt.x&&$t>=Mt.y)return!0;const bt=[new A(we,Xe),new A(we,$t),new A(mt,$t),new A(mt,Xe)];if(se.length>2){for(const Mt of bt)if(Ip(se,Mt))return!0}for(let Mt=0;Mt<se.length-1;Mt++)if(JW(se[Mt],se[Mt+1],bt))return!0;return!1}(l.cameraQueryGeometry,Ce-B,ke-B,et+B,Ge+B));for(const Ce of ae)X.push(Ce);X.sort(dX);const ce={};let de;for(let Ce=0;Ce<X.length;Ce++){const ke=X[Ce];if(ke===de)continue;de=ke;const et=this.featureIndexArray.get(ke);let Ge=null;this.loadMatchingFeature(ce,et.bucketIndex,et.sourceLayerIndex,et.featureIndex,R,S.layers,S.availableImages,h,p,y,(se,we,Xe)=>(Ge||(Ge=jd(se)),we.queryIntersectsFeature({queryGeometry:O,feature:se,featureState:Xe,geometry:Ge,zoom:this.z,transform:l.transform,pixelsToTileUnits:E,pixelPosMatrix:l.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:l.getElevation})))}return ce}loadMatchingFeature(l,h,p,y,S,E,R,O,B,G,X){const ie=this.bucketLayerIDs[h];if(E&&!ie.some(Ce=>E.has(Ce)))return;const ae=this.sourceLayerCoder.decode(p),ce=this.vtLayers[ae].feature(y);if(S.needGeometry){const Ce=Hd(ce,!0);if(!S.filter(new Zr(this.tileID.overscaledZ),Ce,this.tileID.canonical))return}else if(!S.filter(new Zr(this.tileID.overscaledZ),ce))return;const de=this.getId(ce,ae);for(let Ce=0;Ce<ie.length;Ce++){const ke=ie[Ce];if(E&&!E.has(ke))continue;const et=O[ke];if(!et)continue;let Ge={};de&&G&&(Ge=G.getState(et.sourceLayer||"_geojsonTileLayer",de));const se=un({},B[ke]);se.paint=DD(se.paint,et.paint,ce,Ge,R),se.layout=DD(se.layout,et.layout,ce,Ge,R);const we=!X||X(ce,et,Ge);if(!we)continue;const Xe=new LD(ce,this.z,this.x,this.y,de);Xe.layer=se;let mt=l[ke];mt===void 0&&(mt=l[ke]=[]),mt.push({featureIndex:y,feature:Xe,intersectionZ:we})}}lookupSymbolFeatures(l,h,p,y,S,E,R,O){const B={};this.loadVTLayers();const G=Ul(S);for(const X of l)this.loadMatchingFeature(B,p,y,X,G,E,R,O,h);return B}hasLayer(l){for(const h of this.bucketLayerIDs)for(const p of h)if(l===p)return!0;return!1}getId(l,h){var p;let y=l.id;return this.promoteId&&(y=l.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof y=="boolean"&&(y=Number(y)),y===void 0&&(!((p=l.properties)===null||p===void 0)&&p.cluster)&&this.promoteId&&(y=Number(l.properties.cluster_id))),y}}function DD(d,l,h,p,y){return hn(d,(S,E)=>{const R=l instanceof Ep?l.get(E):null;return R&&R.evaluate?R.evaluate(h,p,y):R})}function dX(d,l){return l-d}function zD(d,l,h,p,y){const S=[];for(let E=0;E<d.length;E++){const R=d[E];let O;for(let B=0;B<R.length-1;B++){let G=R[B],X=R[B+1];G.x<l&&X.x<l||(G.x<l?G=new A(l,G.y+(l-G.x)/(X.x-G.x)*(X.y-G.y))._round():X.x<l&&(X=new A(l,G.y+(l-G.x)/(X.x-G.x)*(X.y-G.y))._round()),G.y<h&&X.y<h||(G.y<h?G=new A(G.x+(h-G.y)/(X.y-G.y)*(X.x-G.x),h)._round():X.y<h&&(X=new A(G.x+(h-G.y)/(X.y-G.y)*(X.x-G.x),h)._round()),G.x>=p&&X.x>=p||(G.x>=p?G=new A(p,G.y+(p-G.x)/(X.x-G.x)*(X.y-G.y))._round():X.x>=p&&(X=new A(p,G.y+(p-G.x)/(X.x-G.x)*(X.y-G.y))._round()),G.y>=y&&X.y>=y||(G.y>=y?G=new A(G.x+(y-G.y)/(X.y-G.y)*(X.x-G.x),y)._round():X.y>=y&&(X=new A(G.x+(y-G.y)/(X.y-G.y)*(X.x-G.x),y)._round()),O&&G.equals(O[O.length-1])||(O=[G],S.push(O)),O.push(X)))))}}return S}xn("FeatureIndex",kD,{omit:["rawTileData","sourceLayerCoder"]});class Qu extends A{constructor(l,h,p,y){super(l,h),this.angle=p,y!==void 0&&(this.segment=y)}clone(){return new Qu(this.x,this.y,this.angle,this.segment)}}function OD(d,l,h,p,y){if(l.segment===void 0||h===0)return!0;let S=l,E=l.segment+1,R=0;for(;R>-h/2;){if(E--,E<0)return!1;R-=d[E].dist(S),S=d[E]}R+=d[E].dist(d[E+1]),E++;const O=[];let B=0;for(;R<h/2;){const G=d[E],X=d[E+1];if(!X)return!1;let ie=d[E-1].angleTo(G)-G.angleTo(X);for(ie=Math.abs((ie+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:R,angleDelta:ie}),B+=ie;R-O[0].distance>p;)B-=O.shift().angleDelta;if(B>y)return!1;E++,R+=G.dist(X)}return!0}function FD(d){let l=0;for(let h=0;h<d.length-1;h++)l+=d[h].dist(d[h+1]);return l}function ND(d,l,h){return d?.6*l*h:0}function BD(d,l){return Math.max(d?d.right-d.left:0,l?l.right-l.left:0)}function fX(d,l,h,p,y,S){const E=ND(h,y,S),R=BD(h,p)*S;let O=0;const B=FD(d)/2;for(let G=0;G<d.length-1;G++){const X=d[G],ie=d[G+1],ae=X.dist(ie);if(O+ae>B){const ce=(B-O)/ae,de=hs.number(X.x,ie.x,ce),Ce=hs.number(X.y,ie.y,ce),ke=new Qu(de,Ce,ie.angleTo(X),G);return ke._round(),!E||OD(d,ke,R,E,l)?ke:void 0}O+=ae}}function pX(d,l,h,p,y,S,E,R,O){const B=ND(p,S,E),G=BD(p,y),X=G*E,ie=d[0].x===0||d[0].x===O||d[0].y===0||d[0].y===O;return l-X<l/4&&(l=X+l/4),UD(d,ie?l/2*R%l:(G/2+2*S)*E*R%l,l,B,h,X,ie,!1,O)}function UD(d,l,h,p,y,S,E,R,O){const B=S/2,G=FD(d);let X=0,ie=l-h,ae=[];for(let ce=0;ce<d.length-1;ce++){const de=d[ce],Ce=d[ce+1],ke=de.dist(Ce),et=Ce.angleTo(de);for(;ie+h<X+ke;){ie+=h;const Ge=(ie-X)/ke,se=hs.number(de.x,Ce.x,Ge),we=hs.number(de.y,Ce.y,Ge);if(se>=0&&se<O&&we>=0&&we<O&&ie-B>=0&&ie+B<=G){const Xe=new Qu(se,we,et,ce);Xe._round(),p&&!OD(d,Xe,S,p,y)||ae.push(Xe)}}X+=ke}return R||ae.length||E||(ae=UD(d,X/2,h,p,y,S,E,!0,O)),ae}function $D(d,l,h,p){const y=[],S=d.image,E=S.pixelRatio,R=S.paddedRect.w-2,O=S.paddedRect.h-2;let B={x1:d.left,y1:d.top,x2:d.right,y2:d.bottom};const G=S.stretchX||[[0,R]],X=S.stretchY||[[0,O]],ie=(Pt,Cn)=>Pt+Cn[1]-Cn[0],ae=G.reduce(ie,0),ce=X.reduce(ie,0),de=R-ae,Ce=O-ce;let ke=0,et=ae,Ge=0,se=ce,we=0,Xe=de,mt=0,$t=Ce;if(S.content&&p){const Pt=S.content,Cn=Pt[2]-Pt[0],$n=Pt[3]-Pt[1];(S.textFitWidth||S.textFitHeight)&&(B=mD(d)),ke=_1(G,0,Pt[0]),Ge=_1(X,0,Pt[1]),et=_1(G,Pt[0],Pt[2]),se=_1(X,Pt[1],Pt[3]),we=Pt[0]-ke,mt=Pt[1]-Ge,Xe=Cn-et,$t=$n-se}const bt=B.x1,Mt=B.y1,Jt=B.x2-bt,jt=B.y2-Mt,en=(Pt,Cn,$n,Bn)=>{const kn=x1(Pt.stretch-ke,et,Jt,bt),or=b1(Pt.fixed-we,Xe,Pt.stretch,ae),ci=x1(Cn.stretch-Ge,se,jt,Mt),ki=b1(Cn.fixed-mt,$t,Cn.stretch,ce),xo=x1($n.stretch-ke,et,Jt,bt),na=b1($n.fixed-we,Xe,$n.stretch,ae),fs=x1(Bn.stretch-Ge,se,jt,Mt),oo=b1(Bn.fixed-mt,$t,Bn.stretch,ce),ii=new A(kn,ci),qi=new A(xo,ci),so=new A(xo,fs),ao=new A(kn,fs),es=new A(or/E,ki/E),ra=new A(na/E,oo/E),Xi=l*Math.PI/180;if(Xi){const Zi=Math.sin(Xi),Yi=Math.cos(Xi),Mi=[Yi,-Zi,Zi,Yi];ii._matMult(Mi),qi._matMult(Mi),ao._matMult(Mi),so._matMult(Mi)}const ps=Pt.stretch+Pt.fixed,Di=Cn.stretch+Cn.fixed;return{tl:ii,tr:qi,bl:ao,br:so,tex:{x:S.paddedRect.x+1+ps,y:S.paddedRect.y+1+Di,w:$n.stretch+$n.fixed-ps,h:Bn.stretch+Bn.fixed-Di},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:es,pixelOffsetBR:ra,minFontScaleX:Xe/E/Jt,minFontScaleY:$t/E/jt,isSDF:h}};if(p&&(S.stretchX||S.stretchY)){const Pt=VD(G,de,ae),Cn=VD(X,Ce,ce);for(let $n=0;$n<Pt.length-1;$n++){const Bn=Pt[$n],kn=Pt[$n+1];for(let or=0;or<Cn.length-1;or++)y.push(en(Bn,Cn[or],kn,Cn[or+1]))}}else y.push(en({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:R+1},{fixed:0,stretch:O+1}));return y}function _1(d,l,h){let p=0;for(const y of d)p+=Math.max(l,Math.min(h,y[1]))-Math.max(l,Math.min(h,y[0]));return p}function VD(d,l,h){const p=[{fixed:-1,stretch:0}];for(const[y,S]of d){const E=p[p.length-1];p.push({fixed:y-E.stretch,stretch:E.stretch}),p.push({fixed:y-E.stretch,stretch:E.stretch+(S-y)})}return p.push({fixed:l+1,stretch:h}),p}function x1(d,l,h,p){return d/l*h+p}function b1(d,l,h,p){return d-l*h/p}xn("Anchor",Qu);class w1{constructor(l,h,p,y,S,E,R,O,B,G){var X;if(this.boxStartIndex=l.length,B){let ie=E.top,ae=E.bottom;const ce=E.collisionPadding;ce&&(ie-=ce[1],ae+=ce[3]);let de=ae-ie;de>0&&(de=Math.max(10,de),this.circleDiameter=de)}else{const ie=!((X=E.image)===null||X===void 0)&&X.content&&(E.image.textFitWidth||E.image.textFitHeight)?mD(E):{x1:E.left,y1:E.top,x2:E.right,y2:E.bottom};ie.y1=ie.y1*R-O[0],ie.y2=ie.y2*R+O[2],ie.x1=ie.x1*R-O[3],ie.x2=ie.x2*R+O[1];const ae=E.collisionPadding;if(ae&&(ie.x1-=ae[0]*R,ie.y1-=ae[1]*R,ie.x2+=ae[2]*R,ie.y2+=ae[3]*R),G){const ce=new A(ie.x1,ie.y1),de=new A(ie.x2,ie.y1),Ce=new A(ie.x1,ie.y2),ke=new A(ie.x2,ie.y2),et=G*Math.PI/180;ce._rotate(et),de._rotate(et),Ce._rotate(et),ke._rotate(et),ie.x1=Math.min(ce.x,de.x,Ce.x,ke.x),ie.x2=Math.max(ce.x,de.x,Ce.x,ke.x),ie.y1=Math.min(ce.y,de.y,Ce.y,ke.y),ie.y2=Math.max(ce.y,de.y,Ce.y,ke.y)}l.emplaceBack(h.x,h.y,ie.x1,ie.y1,ie.x2,ie.y2,p,y,S)}this.boxEndIndex=l.length}}class mX{constructor(l=[],h=(p,y)=>p<y?-1:p>y?1:0){if(this.data=l,this.length=this.data.length,this.compare=h,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:h,compare:p}=this,y=h[l];for(;l>0;){const S=l-1>>1,E=h[S];if(p(y,E)>=0)break;h[l]=E,l=S}h[l]=y}_down(l){const{data:h,compare:p}=this,y=this.length>>1,S=h[l];for(;l<y;){let E=1+(l<<1);const R=E+1;if(R<this.length&&p(h[R],h[E])<0&&(E=R),p(h[E],S)>=0)break;h[l]=h[E],l=E}h[l]=S}}function gX(d,l=1,h=!1){const p=qd.fromPoints(d[0]),y=Math.min(p.width(),p.height());let S=y/2;const E=new mX([],vX),{minX:R,minY:O,maxX:B,maxY:G}=p;if(y===0)return new A(R,O);for(let ae=R;ae<B;ae+=y)for(let ce=O;ce<G;ce+=y)E.push(new Fp(ae+S,ce+S,S,d));let X=function(ae){let ce=0,de=0,Ce=0;const ke=ae[0];for(let et=0,Ge=ke.length,se=Ge-1;et<Ge;se=et++){const we=ke[et],Xe=ke[se],mt=we.x*Xe.y-Xe.x*we.y;de+=(we.x+Xe.x)*mt,Ce+=(we.y+Xe.y)*mt,ce+=3*mt}return new Fp(de/ce,Ce/ce,0,ae)}(d),ie=E.length;for(;E.length;){const ae=E.pop();(ae.d>X.d||!X.d)&&(X=ae,h&&console.log("found best %d after %d probes",Math.round(1e4*ae.d)/1e4,ie)),ae.max-X.d<=l||(S=ae.h/2,E.push(new Fp(ae.p.x-S,ae.p.y-S,S,d)),E.push(new Fp(ae.p.x+S,ae.p.y-S,S,d)),E.push(new Fp(ae.p.x-S,ae.p.y+S,S,d)),E.push(new Fp(ae.p.x+S,ae.p.y+S,S,d)),ie+=4)}return h&&(console.log(`num probes: ${ie}`),console.log(`best distance: ${X.d}`)),X.p}function vX(d,l){return l.max-d.max}function Fp(d,l,h,p){this.p=new A(d,l),this.h=h,this.d=function(y,S){let E=!1,R=1/0;for(let O=0;O<S.length;O++){const B=S[O];for(let G=0,X=B.length,ie=X-1;G<X;ie=G++){const ae=B[G],ce=B[ie];ae.y>y.y!=ce.y>y.y&&y.x<(ce.x-ae.x)*(y.y-ae.y)/(ce.y-ae.y)+ae.x&&(E=!E),R=Math.min(R,bk(y,ae,ce))}}return(E?1:-1)*Math.sqrt(R)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}var _o;c.aD=void 0,(_o=c.aD||(c.aD={}))[_o.center=1]="center",_o[_o.left=2]="left",_o[_o.right=3]="right",_o[_o.top=4]="top",_o[_o.bottom=5]="bottom",_o[_o["top-left"]=6]="top-left",_o[_o["top-right"]=7]="top-right",_o[_o["bottom-left"]=8]="bottom-left",_o[_o["bottom-right"]=9]="bottom-right";const LC=Number.POSITIVE_INFINITY;function jD(d,l){return l[1]!==LC?function(h,p,y){let S=0,E=0;switch(p=Math.abs(p),y=Math.abs(y),h){case"top-right":case"top-left":case"top":E=y-7;break;case"bottom-right":case"bottom-left":case"bottom":E=7-y}switch(h){case"top-right":case"bottom-right":case"right":S=-p;break;case"top-left":case"bottom-left":case"left":S=p}return[S,E]}(d,l[0],l[1]):function(h,p){let y=0,S=0;p<0&&(p=0);const E=p/Math.SQRT2;switch(h){case"top-right":case"top-left":S=E-7;break;case"bottom-right":case"bottom-left":S=7-E;break;case"bottom":S=7-p;break;case"top":S=p-7}switch(h){case"top-right":case"bottom-right":y=-E;break;case"top-left":case"bottom-left":y=E;break;case"left":y=p;break;case"right":y=-p}return[y,S]}(d,l[0])}function HD(d,l,h){var p;const y=d.layout,S=(p=y.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(l,{},h);if(S){const R=S.values,O=[];for(let B=0;B<R.length;B+=2){const G=O[B]=R[B],X=R[B+1].map(ie=>ie*Wi);G.startsWith("top")?X[1]-=7:G.startsWith("bottom")&&(X[1]+=7),O[B+1]=X}return new ar(O)}const E=y.get("text-variable-anchor");if(E){let R;R=d._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[y.get("text-radial-offset").evaluate(l,{},h)*Wi,LC]:y.get("text-offset").evaluate(l,{},h).map(B=>B*Wi);const O=[];for(const B of E)O.push(B,jD(B,R));return new ar(O)}return null}function kC(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function yX(d,l,h,p,y,S,E,R,O,B,G,X){let ie=S.textMaxSize.evaluate(l,{});ie===void 0&&(ie=E);const ae=d.layers[0].layout,ce=ae.get("icon-offset").evaluate(l,{},G),de=WD(h.horizontal),Ce=E/24,ke=d.tilePixelRatio*Ce,et=d.tilePixelRatio*ie/24,Ge=d.tilePixelRatio*R,se=d.tilePixelRatio*ae.get("symbol-spacing"),we=ae.get("text-padding")*d.tilePixelRatio,Xe=function($n,Bn,kn,or=1){const ci=$n.get("icon-padding").evaluate(Bn,{},kn),ki=ci&&ci.values;return[ki[0]*or,ki[1]*or,ki[2]*or,ki[3]*or]}(ae,l,G,d.tilePixelRatio),mt=ae.get("text-max-angle")/180*Math.PI,$t=ae.get("text-rotation-alignment")!=="viewport"&&ae.get("symbol-placement")!=="point",bt=ae.get("icon-rotation-alignment")==="map"&&ae.get("symbol-placement")!=="point",Mt=ae.get("symbol-placement"),Jt=se/2,jt=ae.get("icon-text-fit");let en;p&&jt!=="none"&&(d.allowVerticalPlacement&&h.vertical&&(en=gD(p,h.vertical,jt,ae.get("icon-text-fit-padding"),ce,Ce)),de&&(p=gD(p,de,jt,ae.get("icon-text-fit-padding"),ce,Ce)));const Pt=G?X.line.getGranularityForZoomLevel(G.z):1,Cn=($n,Bn)=>{Bn.x<0||Bn.x>=ct||Bn.y<0||Bn.y>=ct||function(kn,or,ci,ki,xo,na,fs,oo,ii,qi,so,ao,es,ra,Xi,ps,Di,Zi,Yi,Mi,Wr,hl,Np,dl,bX){const Bp=kn.addToLineVertexArray(or,ci);let Xd,Up,$p,Vp,YD=0,KD=0,JD=0,QD=0,$C=-1,VC=-1;const Bc={};let ez=Qo("");if(kn.allowVerticalPlacement&&ki.vertical){const Oo=oo.layout.get("text-rotate").evaluate(Wr,{},dl)+90;$p=new w1(ii,or,qi,so,ao,ki.vertical,es,ra,Xi,Oo),fs&&(Vp=new w1(ii,or,qi,so,ao,fs,Di,Zi,Xi,Oo))}if(xo){const Oo=oo.layout.get("icon-rotate").evaluate(Wr,{}),ia=oo.layout.get("icon-text-fit")!=="none",Zd=$D(xo,Oo,Np,ia),pl=fs?$D(fs,Oo,Np,ia):void 0;Up=new w1(ii,or,qi,so,ao,xo,Di,Zi,!1,Oo),YD=4*Zd.length;const Yd=kn.iconSizeData;let Yl=null;Yd.kind==="source"?(Yl=[Nc*oo.layout.get("icon-size").evaluate(Wr,{})],Yl[0]>Ku&&tn(`${kn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Yd.kind==="composite"&&(Yl=[Nc*hl.compositeIconSizes[0].evaluate(Wr,{},dl),Nc*hl.compositeIconSizes[1].evaluate(Wr,{},dl)],(Yl[0]>Ku||Yl[1]>Ku)&&tn(`${kn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),kn.addSymbols(kn.icon,Zd,Yl,Mi,Yi,Wr,c.an.none,or,Bp.lineStartIndex,Bp.lineLength,-1,dl),$C=kn.icon.placedSymbolArray.length-1,pl&&(KD=4*pl.length,kn.addSymbols(kn.icon,pl,Yl,Mi,Yi,Wr,c.an.vertical,or,Bp.lineStartIndex,Bp.lineLength,-1,dl),VC=kn.icon.placedSymbolArray.length-1)}const tz=Object.keys(ki.horizontal);for(const Oo of tz){const ia=ki.horizontal[Oo];if(!Xd){ez=Qo(ia.text);const pl=oo.layout.get("text-rotate").evaluate(Wr,{},dl);Xd=new w1(ii,or,qi,so,ao,ia,es,ra,Xi,pl)}const Zd=ia.positionedLines.length===1;if(JD+=GD(kn,or,ia,na,oo,Xi,Wr,ps,Bp,ki.vertical?c.an.horizontal:c.an.horizontalOnly,Zd?tz:[Oo],Bc,$C,hl,dl),Zd)break}ki.vertical&&(QD+=GD(kn,or,ki.vertical,na,oo,Xi,Wr,ps,Bp,c.an.vertical,["vertical"],Bc,VC,hl,dl));const wX=Xd?Xd.boxStartIndex:kn.collisionBoxArray.length,SX=Xd?Xd.boxEndIndex:kn.collisionBoxArray.length,MX=$p?$p.boxStartIndex:kn.collisionBoxArray.length,CX=$p?$p.boxEndIndex:kn.collisionBoxArray.length,EX=Up?Up.boxStartIndex:kn.collisionBoxArray.length,TX=Up?Up.boxEndIndex:kn.collisionBoxArray.length,PX=Vp?Vp.boxStartIndex:kn.collisionBoxArray.length,AX=Vp?Vp.boxEndIndex:kn.collisionBoxArray.length;let fl=-1;const M1=(Oo,ia)=>Oo&&Oo.circleDiameter?Math.max(Oo.circleDiameter,ia):ia;fl=M1(Xd,fl),fl=M1($p,fl),fl=M1(Up,fl),fl=M1(Vp,fl);const nz=fl>-1?1:0;nz&&(fl*=bX/Wi),kn.glyphOffsetArray.length>=zp.MAX_GLYPHS&&tn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Wr.sortKey!==void 0&&kn.addToSortKeyRanges(kn.symbolInstances.length,Wr.sortKey);const IX=HD(oo,Wr,dl),[RX,LX]=function(Oo,ia){const Zd=Oo.length,pl=ia==null?void 0:ia.values;if((pl==null?void 0:pl.length)>0)for(let Yd=0;Yd<pl.length;Yd+=2){const Yl=pl[Yd+1];Oo.emplaceBack(c.aD[pl[Yd]],Yl[0],Yl[1])}return[Zd,Oo.length]}(kn.textAnchorOffsets,IX);kn.symbolInstances.emplaceBack(or.x,or.y,Bc.right>=0?Bc.right:-1,Bc.center>=0?Bc.center:-1,Bc.left>=0?Bc.left:-1,Bc.vertical||-1,$C,VC,ez,wX,SX,MX,CX,EX,TX,PX,AX,qi,JD,QD,YD,KD,nz,0,es,fl,RX,LX)}(d,Bn,$n,h,p,y,en,d.layers[0],d.collisionBoxArray,l.index,l.sourceLayerIndex,d.index,ke,[we,we,we,we],$t,O,Ge,Xe,bt,ce,l,S,B,G,E)};if(Mt==="line")for(const $n of zD(l.geometry,0,0,ct,ct)){const Bn=Wd($n,Pt),kn=pX(Bn,se,mt,h.vertical||de,p,24,et,d.overscaling,ct);for(const or of kn)de&&_X(d,de.text,Jt,or)||Cn(Bn,or)}else if(Mt==="line-center"){for(const $n of l.geometry)if($n.length>1){const Bn=Wd($n,Pt),kn=fX(Bn,mt,h.vertical||de,p,24,et);kn&&Cn(Bn,kn)}}else if(l.type==="Polygon")for(const $n of ip(l.geometry,0)){const Bn=gX($n,16);Cn(Wd($n[0],Pt,!0),new Qu(Bn.x,Bn.y,0))}else if(l.type==="LineString")for(const $n of l.geometry){const Bn=Wd($n,Pt);Cn(Bn,new Qu(Bn[0].x,Bn[0].y,0))}else if(l.type==="Point")for(const $n of l.geometry)for(const Bn of $n)Cn([Bn],new Qu(Bn.x,Bn.y,0))}function GD(d,l,h,p,y,S,E,R,O,B,G,X,ie,ae,ce){const de=function(et,Ge,se,we,Xe,mt,$t,bt){const Mt=we.layout.get("text-rotate").evaluate(mt,{})*Math.PI/180,Jt=[];for(const jt of Ge.positionedLines)for(const en of jt.positionedGlyphs){if(!en.rect)continue;const Pt=en.rect||{};let Cn=4,$n=!0,Bn=1,kn=0;const or=(Xe||bt)&&en.vertical,ci=en.metrics.advance*en.scale/2;if(bt&&Ge.verticalizable&&(kn=jt.lineOffset/2-(en.imageName?-(Wi-en.metrics.width*en.scale)/2:(en.scale-1)*Wi)),en.imageName){const Zi=$t[en.imageName];$n=Zi.sdf,Bn=Zi.pixelRatio,Cn=1/Bn}const ki=Xe?[en.x+ci,en.y]:[0,0];let xo=Xe?[0,0]:[en.x+ci+se[0],en.y+se[1]-kn],na=[0,0];or&&(na=xo,xo=[0,0]);const fs=en.metrics.isDoubleResolution?2:1,oo=(en.metrics.left-Cn)*en.scale-ci+xo[0],ii=(-en.metrics.top-Cn)*en.scale+xo[1],qi=oo+Pt.w/fs*en.scale/Bn,so=ii+Pt.h/fs*en.scale/Bn,ao=new A(oo,ii),es=new A(qi,ii),ra=new A(oo,so),Xi=new A(qi,so);if(or){const Zi=new A(-ci,ci- -17),Yi=-Math.PI/2,Mi=12-ci,Wr=new A(22-Mi,-(en.imageName?Mi:0)),hl=new A(...na);ao._rotateAround(Yi,Zi)._add(Wr)._add(hl),es._rotateAround(Yi,Zi)._add(Wr)._add(hl),ra._rotateAround(Yi,Zi)._add(Wr)._add(hl),Xi._rotateAround(Yi,Zi)._add(Wr)._add(hl)}if(Mt){const Zi=Math.sin(Mt),Yi=Math.cos(Mt),Mi=[Yi,-Zi,Zi,Yi];ao._matMult(Mi),es._matMult(Mi),ra._matMult(Mi),Xi._matMult(Mi)}const ps=new A(0,0),Di=new A(0,0);Jt.push({tl:ao,tr:es,bl:ra,br:Xi,tex:Pt,writingMode:Ge.writingMode,glyphOffset:ki,sectionIndex:en.sectionIndex,isSDF:$n,pixelOffsetTL:ps,pixelOffsetBR:Di,minFontScaleX:0,minFontScaleY:0})}return Jt}(0,h,R,y,S,E,p,d.allowVerticalPlacement),Ce=d.textSizeData;let ke=null;Ce.kind==="source"?(ke=[Nc*y.layout.get("text-size").evaluate(E,{})],ke[0]>Ku&&tn(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Ce.kind==="composite"&&(ke=[Nc*ae.compositeTextSizes[0].evaluate(E,{},ce),Nc*ae.compositeTextSizes[1].evaluate(E,{},ce)],(ke[0]>Ku||ke[1]>Ku)&&tn(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),d.addSymbols(d.text,de,ke,R,S,E,B,l,O.lineStartIndex,O.lineLength,ie,ce);for(const et of G)X[et]=d.text.placedSymbolArray.length-1;return 4*de.length}function WD(d){for(const l in d)return d[l];return null}function _X(d,l,h,p){const y=d.compareText;if(l in y){const S=y[l];for(let E=S.length-1;E>=0;E--)if(p.dist(S[E])<h)return!0}else y[l]=[];return y[l].push(p),!1}const qD=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class DC{static from(l){if(!(l instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,p]=new Uint8Array(l,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const y=p>>4;if(y!==1)throw new Error(`Got v${y} data when expected v1.`);const S=qD[15&p];if(!S)throw new Error("Unrecognized array type.");const[E]=new Uint16Array(l,2,1),[R]=new Uint32Array(l,4,1);return new DC(R,E,S,l)}constructor(l,h=64,p=Float64Array,y){if(isNaN(l)||l<0)throw new Error(`Unpexpected numItems value: ${l}.`);this.numItems=+l,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=p,this.IndexArrayType=l<65536?Uint16Array:Uint32Array;const S=qD.indexOf(this.ArrayType),E=2*l*this.ArrayType.BYTES_PER_ELEMENT,R=l*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-R%8)%8;if(S<0)throw new Error(`Unexpected typed array class: ${p}.`);y&&y instanceof ArrayBuffer?(this.data=y,this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+R+O,2*l),this._pos=2*l,this._finished=!0):(this.data=new ArrayBuffer(8+E+R+O),this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+R+O,2*l),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+S]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=l)}add(l,h){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=l,this.coords[this._pos++]=h,p}finish(){const l=this._pos>>1;if(l!==this.numItems)throw new Error(`Added ${l} items when expected ${this.numItems}.`);return zC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(l,h,p,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:S,coords:E,nodeSize:R}=this,O=[0,S.length-1,0],B=[];for(;O.length;){const G=O.pop()||0,X=O.pop()||0,ie=O.pop()||0;if(X-ie<=R){for(let Ce=ie;Ce<=X;Ce++){const ke=E[2*Ce],et=E[2*Ce+1];ke>=l&&ke<=p&&et>=h&&et<=y&&B.push(S[Ce])}continue}const ae=ie+X>>1,ce=E[2*ae],de=E[2*ae+1];ce>=l&&ce<=p&&de>=h&&de<=y&&B.push(S[ae]),(G===0?l<=ce:h<=de)&&(O.push(ie),O.push(ae-1),O.push(1-G)),(G===0?p>=ce:y>=de)&&(O.push(ae+1),O.push(X),O.push(1-G))}return B}within(l,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:S,nodeSize:E}=this,R=[0,y.length-1,0],O=[],B=p*p;for(;R.length;){const G=R.pop()||0,X=R.pop()||0,ie=R.pop()||0;if(X-ie<=E){for(let Ce=ie;Ce<=X;Ce++)ZD(S[2*Ce],S[2*Ce+1],l,h)<=B&&O.push(y[Ce]);continue}const ae=ie+X>>1,ce=S[2*ae],de=S[2*ae+1];ZD(ce,de,l,h)<=B&&O.push(y[ae]),(G===0?l-p<=ce:h-p<=de)&&(R.push(ie),R.push(ae-1),R.push(1-G)),(G===0?l+p>=ce:h+p>=de)&&(R.push(ae+1),R.push(X),R.push(1-G))}return O}}function zC(d,l,h,p,y,S){if(y-p<=h)return;const E=p+y>>1;XD(d,l,E,p,y,S),zC(d,l,h,p,E-1,1-S),zC(d,l,h,E+1,y,1-S)}function XD(d,l,h,p,y,S){for(;y>p;){if(y-p>600){const B=y-p+1,G=h-p+1,X=Math.log(B),ie=.5*Math.exp(2*X/3),ae=.5*Math.sqrt(X*ie*(B-ie)/B)*(G-B/2<0?-1:1);XD(d,l,h,Math.max(p,Math.floor(h-G*ie/B+ae)),Math.min(y,Math.floor(h+(B-G)*ie/B+ae)),S)}const E=l[2*h+S];let R=p,O=y;for(s0(d,l,p,h),l[2*y+S]>E&&s0(d,l,p,y);R<O;){for(s0(d,l,R,O),R++,O--;l[2*R+S]<E;)R++;for(;l[2*O+S]>E;)O--}l[2*p+S]===E?s0(d,l,p,O):(O++,s0(d,l,O,y)),O<=h&&(p=O+1),h<=O&&(y=O-1)}}function s0(d,l,h,p){OC(d,h,p),OC(l,2*h,2*p),OC(l,2*h+1,2*p+1)}function OC(d,l,h){const p=d[l];d[l]=d[h],d[h]=p}function ZD(d,l,h,p){const y=d-h,S=l-p;return y*y+S*S}var FC;c.cw=void 0,(FC=c.cw||(c.cw={})).create="create",FC.load="load",FC.fullLoad="fullLoad";let S1=null,a0=[];const NC=1e3/60,BC="loadTime",UC="fullLoadTime",xX={mark(d){performance.mark(d)},frame(d){const l=d;S1!=null&&a0.push(l-S1),S1=l},clearMetrics(){S1=null,a0=[],performance.clearMeasures(BC),performance.clearMeasures(UC);for(const d in c.cw)performance.clearMarks(c.cw[d])},getPerformanceMetrics(){performance.measure(BC,c.cw.create,c.cw.load),performance.measure(UC,c.cw.create,c.cw.fullLoad);const d=performance.getEntriesByName(BC)[0].duration,l=performance.getEntriesByName(UC)[0].duration,h=a0.length,p=1/(a0.reduce((S,E)=>S+E,0)/h/1e3),y=a0.filter(S=>S>NC).reduce((S,E)=>S+(E-NC)/NC,0);return{loadTime:d,fullLoadTime:l,fps:p,percentDroppedFrames:y/(h+y)*100,totalFrames:h}}};c.$=ct,c.A=V,c.B=function([d,l,h]){return l+=90,l*=Math.PI/180,h*=Math.PI/180,{x:d*Math.cos(l)*Math.sin(h),y:d*Math.sin(l)*Math.sin(h),z:d*Math.cos(h)}},c.C=hs,c.D=En,c.E=Je,c.F=Zr,c.G=wp,c.H=function(d){if(an==null){const l=d.navigator?d.navigator.userAgent:null;an=!!d.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return an},c.I=bC,c.J=class{constructor(d,l){this.target=d,this.mapId=l,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new uX(()=>this.process()),this.subscription=wt(this.target,"message",h=>this.receive(h),!1),this.globalScope=An(self)?d:window}registerMessageHandler(d,l){this.messageHandlers[d]=l}sendAsync(d,l){return new Promise((h,p)=>{const y=Math.round(1e18*Math.random()).toString(36).substring(0,10),S=l?wt(l.signal,"abort",()=>{S==null||S.unsubscribe(),delete this.resolveRejects[y];const O={id:y,type:"<cancel>",origin:location.origin,targetMapId:d.targetMapId,sourceMapId:this.mapId};this.target.postMessage(O)},hX):null;this.resolveRejects[y]={resolve:O=>{S==null||S.unsubscribe(),h(O)},reject:O=>{S==null||S.unsubscribe(),p(O)}};const E=[],R=Object.assign(Object.assign({},d),{id:y,sourceMapId:this.mapId,origin:location.origin,data:Dd(d.data,E)});this.target.postMessage(R,{transfer:E})})}receive(d){const l=d.data,h=l.id;if(!(l.origin!=="file://"&&location.origin!=="file://"&&l.origin!=="resource://android"&&location.origin!=="resource://android"&&l.origin!==location.origin||l.targetMapId&&this.mapId!==l.targetMapId)){if(l.type==="<cancel>"){delete this.tasks[h];const p=this.abortControllers[h];return delete this.abortControllers[h],void(p&&p.abort())}if(An(self)||l.mustQueue)return this.tasks[h]=l,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,l)}}process(){if(this.taskQueue.length===0)return;const d=this.taskQueue.shift(),l=this.tasks[d];delete this.tasks[d],this.taskQueue.length>0&&this.invoker.trigger(),l&&this.processTask(d,l)}processTask(d,l){return o(this,void 0,void 0,function*(){if(l.type==="<response>"){const y=this.resolveRejects[d];return delete this.resolveRejects[d],y?void(l.error?y.reject(qu(l.error)):y.resolve(qu(l.data))):void 0}if(!this.messageHandlers[l.type])return void this.completeTask(d,new Error(`Could not find a registered handler for ${l.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=qu(l.data),p=new AbortController;this.abortControllers[d]=p;try{const y=yield this.messageHandlers[l.type](l.sourceMapId,h,p);this.completeTask(d,null,y)}catch(y){this.completeTask(d,y)}})}completeTask(d,l,h){const p=[];delete this.abortControllers[d];const y={id:d,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:l?Dd(l):null,data:Dd(h,p)};this.target.postMessage(y,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},c.K=Z,c.L=function(){var d=new V(16);return V!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0),d[0]=1,d[5]=1,d[10]=1,d[15]=1,d},c.M=function(d,l,h){var p,y,S,E,R,O,B,G,X,ie,ae,ce,de=h[0],Ce=h[1],ke=h[2];return l===d?(d[12]=l[0]*de+l[4]*Ce+l[8]*ke+l[12],d[13]=l[1]*de+l[5]*Ce+l[9]*ke+l[13],d[14]=l[2]*de+l[6]*Ce+l[10]*ke+l[14],d[15]=l[3]*de+l[7]*Ce+l[11]*ke+l[15]):(y=l[1],S=l[2],E=l[3],R=l[4],O=l[5],B=l[6],G=l[7],X=l[8],ie=l[9],ae=l[10],ce=l[11],d[0]=p=l[0],d[1]=y,d[2]=S,d[3]=E,d[4]=R,d[5]=O,d[6]=B,d[7]=G,d[8]=X,d[9]=ie,d[10]=ae,d[11]=ce,d[12]=p*de+R*Ce+X*ke+l[12],d[13]=y*de+O*Ce+ie*ke+l[13],d[14]=S*de+B*Ce+ae*ke+l[14],d[15]=E*de+G*Ce+ce*ke+l[15]),d},c.N=function(d,l,h){var p=h[0],y=h[1],S=h[2];return d[0]=l[0]*p,d[1]=l[1]*p,d[2]=l[2]*p,d[3]=l[3]*p,d[4]=l[4]*y,d[5]=l[5]*y,d[6]=l[6]*y,d[7]=l[7]*y,d[8]=l[8]*S,d[9]=l[9]*S,d[10]=l[10]*S,d[11]=l[11]*S,d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15],d},c.O=function(d,l,h){var p=l[0],y=l[1],S=l[2],E=l[3],R=l[4],O=l[5],B=l[6],G=l[7],X=l[8],ie=l[9],ae=l[10],ce=l[11],de=l[12],Ce=l[13],ke=l[14],et=l[15],Ge=h[0],se=h[1],we=h[2],Xe=h[3];return d[0]=Ge*p+se*R+we*X+Xe*de,d[1]=Ge*y+se*O+we*ie+Xe*Ce,d[2]=Ge*S+se*B+we*ae+Xe*ke,d[3]=Ge*E+se*G+we*ce+Xe*et,d[4]=(Ge=h[4])*p+(se=h[5])*R+(we=h[6])*X+(Xe=h[7])*de,d[5]=Ge*y+se*O+we*ie+Xe*Ce,d[6]=Ge*S+se*B+we*ae+Xe*ke,d[7]=Ge*E+se*G+we*ce+Xe*et,d[8]=(Ge=h[8])*p+(se=h[9])*R+(we=h[10])*X+(Xe=h[11])*de,d[9]=Ge*y+se*O+we*ie+Xe*Ce,d[10]=Ge*S+se*B+we*ae+Xe*ke,d[11]=Ge*E+se*G+we*ce+Xe*et,d[12]=(Ge=h[12])*p+(se=h[13])*R+(we=h[14])*X+(Xe=h[15])*de,d[13]=Ge*y+se*O+we*ie+Xe*Ce,d[14]=Ge*S+se*B+we*ae+Xe*ke,d[15]=Ge*E+se*G+we*ce+Xe*et,d},c.P=A,c.Q=function(d,l){const h={};for(let p=0;p<l.length;p++){const y=l[p];y in d&&(h[y]=d[y])}return h},c.R=ds,c.S=Ju,c.T=sC,c.U=ED,c.V=CD,c.W=k,c.X=U,c.Y=it,c.Z=ta,c._=o,c.a=te,c.a$=function(d,l,h){return d[0]=l[0]*h,d[1]=l[1]*h,d[2]=l[2]*h,d[3]=l[3]*h,d},c.a0=o0,c.a1=qd,c.a2=25,c.a3=RC,c.a4=d=>{const l=window.document.createElement("video");return l.muted=!0,new Promise(h=>{l.onloadstart=()=>{h(l)};for(const p of d){const y=window.document.createElement("source");fe(p)||(l.crossOrigin="Anonymous"),y.src=p,l.appendChild(y)}})},c.a5=gt,c.a6=function(){return gn++},c.a7=Pe,c.a8=zp,c.a9=Ul,c.aA=Wi,c.aB=Xt,c.aC=function(d,l,h,p,y=!1){if(!h[0]&&!h[1])return[0,0];const S=y?p==="map"?-d.bearingInRadians:0:p==="viewport"?d.bearingInRadians:0;if(S){const E=Math.sin(S),R=Math.cos(S);h=[h[0]*R-h[1]*E,h[0]*E+h[1]*R]}return[y?h[0]:Xt(l,h[0],d.zoom),y?h[1]:Xt(l,h[1],d.zoom)]},c.aE=MC,c.aF=kC,c.aG=SC,c.aH=DC,c.aI=li,c.aJ=d1,c.aK=ht,c.aL=hr,c.aM=zr,c.aN=Ct,c.aO=Lt,c.aP=PD,c.aQ=ge,c.aR=ye,c.aS=function(d){var l=new V(3);return l[0]=d[0],l[1]=d[1],l[2]=d[2],l},c.aT=function(d,l,h){return d[0]=l[0]-h[0],d[1]=l[1]-h[1],d[2]=l[2]-h[2],d},c.aU=function(d,l){var h=l[0],p=l[1],y=l[2],S=h*h+p*p+y*y;return S>0&&(S=1/Math.sqrt(S)),d[0]=l[0]*S,d[1]=l[1]*S,d[2]=l[2]*S,d},c.aV=Ne,c.aW=function(d,l){return d[0]*l[0]+d[1]*l[1]+d[2]*l[2]},c.aX=function(d,l,h){return d[0]=l[0]*h[0],d[1]=l[1]*h[1],d[2]=l[2]*h[2],d[3]=l[3]*h[3],d},c.aY=N,c.aZ=function(d,l,h){const p=l[0]*h[0]+l[1]*h[1]+l[2]*h[2];return p===0?null:(-(d[0]*h[0]+d[1]*h[1]+d[2]*h[2])-h[3])/p},c.a_=ve,c.aa=Hd,c.ab=LD,c.ac=function(d){const l={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,p,y,S)=>{const E=y||S;return l[p]=!E||E.toLowerCase(),""}),l["max-age"]){const h=parseInt(l["max-age"],10);isNaN(h)?delete l["max-age"]:l["max-age"]=h}return l},c.ad=Zt,c.ae=function(d){return Math.pow(2,d)},c.af=J,c.ag=Tt,c.ah=85.051129,c.ai=TD,c.aj=function(d){return Math.log(d)/Math.LN2},c.ak=function(d){var l=d[0],h=d[1];return l*l+h*h},c.al=function(d,l){const h=[];for(const p in d)p in l||h.push(p);return h},c.am=function(d,l){let h=0,p=0;if(d.kind==="constant")p=d.layoutSize;else if(d.kind!=="source"){const{interpolationType:y,minZoom:S,maxZoom:E}=d,R=y?Tt(Lo.interpolationFactor(y,l,S,E),0,1):0;d.kind==="camera"?p=hs.number(d.minSize,d.maxSize,R):h=R}return{uSizeT:h,uSize:p}},c.ao=function(d,{uSize:l,uSizeT:h},{lowerSize:p,upperSize:y}){return d.kind==="source"?p/Nc:d.kind==="composite"?hs.number(p/Nc,y/Nc,h):l},c.ap=function(d,l){var h=l[0],p=l[1],y=l[2],S=l[3],E=l[4],R=l[5],O=l[6],B=l[7],G=l[8],X=l[9],ie=l[10],ae=l[11],ce=l[12],de=l[13],Ce=l[14],ke=l[15],et=h*R-p*E,Ge=h*O-y*E,se=h*B-S*E,we=p*O-y*R,Xe=p*B-S*R,mt=y*B-S*O,$t=G*de-X*ce,bt=G*Ce-ie*ce,Mt=G*ke-ae*ce,Jt=X*Ce-ie*de,jt=X*ke-ae*de,en=ie*ke-ae*Ce,Pt=et*en-Ge*jt+se*Jt+we*Mt-Xe*bt+mt*$t;return Pt?(d[0]=(R*en-O*jt+B*Jt)*(Pt=1/Pt),d[1]=(y*jt-p*en-S*Jt)*Pt,d[2]=(de*mt-Ce*Xe+ke*we)*Pt,d[3]=(ie*Xe-X*mt-ae*we)*Pt,d[4]=(O*Mt-E*en-B*bt)*Pt,d[5]=(h*en-y*Mt+S*bt)*Pt,d[6]=(Ce*se-ce*mt-ke*Ge)*Pt,d[7]=(G*mt-ie*se+ae*Ge)*Pt,d[8]=(E*jt-R*Mt+B*$t)*Pt,d[9]=(p*Mt-h*jt-S*$t)*Pt,d[10]=(ce*Xe-de*se+ke*et)*Pt,d[11]=(X*se-G*Xe-ae*et)*Pt,d[12]=(R*bt-E*Jt-O*$t)*Pt,d[13]=(h*Jt-p*bt+y*$t)*Pt,d[14]=(de*Ge-ce*we-Ce*et)*Pt,d[15]=(G*we-X*Ge+ie*et)*Pt,d):null},c.aq=Qe,c.ar=function(d){return Math.hypot(d[0],d[1])},c.as=function(d){return d[0]=0,d[1]=0,d},c.at=function(d,l,h){return d[0]=l[0]*h,d[1]=l[1]*h,d},c.au=CC,c.av=Se,c.aw=function(d,l,h,p){const y=l.y-d.y,S=l.x-d.x,E=p.y-h.y,R=p.x-h.x,O=E*S-R*y;if(O===0)return null;const B=(R*(d.y-h.y)-E*(d.x-h.x))/O;return new A(d.x+B*S,d.y+B*y)},c.ax=zD,c.ay=_k,c.az=function(d){let l=1/0,h=1/0,p=-1/0,y=-1/0;for(const S of d)l=Math.min(l,S.x),h=Math.min(h,S.y),p=Math.max(p,S.x),y=Math.max(y,S.y);return[l,h,p,y]},c.b=Le,c.b$=$q,c.b0=function(d,l){return d[0]*l[0]+d[1]*l[1]+d[2]*l[2]+d[3]},c.b1=ID,c.b2=Op,c.b3=function(d,l,h,p,y){var S,E=1/Math.tan(l/2);return d[0]=E/h,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=E,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=-1,d[12]=0,d[13]=0,d[15]=0,y!=null&&y!==1/0?(d[10]=(y+p)*(S=1/(p-y)),d[14]=2*y*p*S):(d[10]=-1,d[14]=-2*p),d},c.b4=function(d){var l=new V(16);return l[0]=d[0],l[1]=d[1],l[2]=d[2],l[3]=d[3],l[4]=d[4],l[5]=d[5],l[6]=d[6],l[7]=d[7],l[8]=d[8],l[9]=d[9],l[10]=d[10],l[11]=d[11],l[12]=d[12],l[13]=d[13],l[14]=d[14],l[15]=d[15],l},c.b5=function(d,l,h){var p=Math.sin(h),y=Math.cos(h),S=l[0],E=l[1],R=l[2],O=l[3],B=l[4],G=l[5],X=l[6],ie=l[7];return l!==d&&(d[8]=l[8],d[9]=l[9],d[10]=l[10],d[11]=l[11],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15]),d[0]=S*y+B*p,d[1]=E*y+G*p,d[2]=R*y+X*p,d[3]=O*y+ie*p,d[4]=B*y-S*p,d[5]=G*y-E*p,d[6]=X*y-R*p,d[7]=ie*y-O*p,d},c.b6=function(d,l,h){var p=Math.sin(h),y=Math.cos(h),S=l[4],E=l[5],R=l[6],O=l[7],B=l[8],G=l[9],X=l[10],ie=l[11];return l!==d&&(d[0]=l[0],d[1]=l[1],d[2]=l[2],d[3]=l[3],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15]),d[4]=S*y+B*p,d[5]=E*y+G*p,d[6]=R*y+X*p,d[7]=O*y+ie*p,d[8]=B*y-S*p,d[9]=G*y-E*p,d[10]=X*y-R*p,d[11]=ie*y-O*p,d},c.b7=function(){const d=new Float32Array(16);return J(d),d},c.b8=function(){const d=new Float64Array(16);return J(d),d},c.b9=function(){return new Float64Array(16)},c.bA=function(d){return d[0]=0,d[1]=0,d[2]=0,d},c.bB=function(d,l,h,p){const y=Math.sqrt(d*d+l*l),S=Math.sqrt(h*h+p*p);d/=y,l/=y,h/=S,p/=S;const E=Math.acos(d*h+l*p);return-l*h+d*p>0?E:-E},c.bC=function(d,l){const h=je(d,2*Math.PI),p=je(l,2*Math.PI);return Math.min(Math.abs(h-p),Math.abs(h-p+2*Math.PI),Math.abs(h-p-2*Math.PI))},c.bD=function(){const d={},l=Oe.$version;for(const h in Oe.$root){const p=Oe.$root[h];if(p.required){let y=null;y=h==="version"?l:p.type==="array"?[]:{},y!=null&&(d[h]=y)}}return d},c.bE=Lv,c.bF=Te,c.bG=function d(l,h){if(Array.isArray(l)){if(!Array.isArray(h)||l.length!==h.length)return!1;for(let p=0;p<l.length;p++)if(!d(l[p],h[p]))return!1;return!0}if(typeof l=="object"&&l!==null&&h!==null){if(typeof h!="object"||Object.keys(l).length!==Object.keys(h).length)return!1;for(const p in l)if(!d(l[p],h[p]))return!1;return!0}return l===h},c.bH=function(d){d=d.slice();const l=Object.create(null);for(let h=0;h<d.length;h++)l[d[h].id]=d[h];for(let h=0;h<d.length;h++)"ref"in d[h]&&(d[h]=Ft(d[h],l[d[h].ref]));return d},c.bI=function(d){if(d.type==="custom")return new cX(d);switch(d.type){case"background":return new sX(d);case"circle":return new eq(d);case"color-relief":return new sq(d);case"fill":return new bq(d);case"fill-extrusion":return new Aq(d);case"heatmap":return new nq(d);case"hillshade":return new iq(d);case"line":return new Fq(d);case"raster":return new lX(d);case"symbol":return new y1(d)}},c.bJ=vn,c.bK=function(d,l){if(!d)return[{command:"setStyle",args:[l]}];let h=[];try{if(!be(d.version,l.version))return[{command:"setStyle",args:[l]}];be(d.center,l.center)||h.push({command:"setCenter",args:[l.center]}),be(d.state,l.state)||h.push({command:"setGlobalState",args:[l.state]}),be(d.centerAltitude,l.centerAltitude)||h.push({command:"setCenterAltitude",args:[l.centerAltitude]}),be(d.zoom,l.zoom)||h.push({command:"setZoom",args:[l.zoom]}),be(d.bearing,l.bearing)||h.push({command:"setBearing",args:[l.bearing]}),be(d.pitch,l.pitch)||h.push({command:"setPitch",args:[l.pitch]}),be(d.roll,l.roll)||h.push({command:"setRoll",args:[l.roll]}),be(d.sprite,l.sprite)||h.push({command:"setSprite",args:[l.sprite]}),be(d.glyphs,l.glyphs)||h.push({command:"setGlyphs",args:[l.glyphs]}),be(d.transition,l.transition)||h.push({command:"setTransition",args:[l.transition]}),be(d.light,l.light)||h.push({command:"setLight",args:[l.light]}),be(d.terrain,l.terrain)||h.push({command:"setTerrain",args:[l.terrain]}),be(d.sky,l.sky)||h.push({command:"setSky",args:[l.sky]}),be(d.projection,l.projection)||h.push({command:"setProjection",args:[l.projection]});const p={},y=[];(function(E,R,O,B){let G;for(G in R=R||{},E=E||{})Object.prototype.hasOwnProperty.call(E,G)&&(Object.prototype.hasOwnProperty.call(R,G)||At(G,O,B));for(G in R)Object.prototype.hasOwnProperty.call(R,G)&&(Object.prototype.hasOwnProperty.call(E,G)?be(E[G],R[G])||(E[G].type==="geojson"&&R[G].type==="geojson"&&Yt(E,R,G)?qe(O,{command:"setGeoJSONSourceData",args:[G,R[G].data]}):Ht(G,R,O,B)):tt(G,R,O))})(d.sources,l.sources,y,p);const S=[];d.layers&&d.layers.forEach(E=>{"source"in E&&p[E.source]?h.push({command:"removeLayer",args:[E.id]}):S.push(E)}),h=h.concat(y),function(E,R,O){R=R||[];const B=(E=E||[]).map(Gt),G=R.map(Gt),X=E.reduce(yn,{}),ie=R.reduce(yn,{}),ae=B.slice(),ce=Object.create(null);let de,Ce,ke,et,Ge;for(let se=0,we=0;se<B.length;se++)de=B[se],Object.prototype.hasOwnProperty.call(ie,de)?we++:(qe(O,{command:"removeLayer",args:[de]}),ae.splice(ae.indexOf(de,we),1));for(let se=0,we=0;se<G.length;se++)de=G[G.length-1-se],ae[ae.length-1-se]!==de&&(Object.prototype.hasOwnProperty.call(X,de)?(qe(O,{command:"removeLayer",args:[de]}),ae.splice(ae.lastIndexOf(de,ae.length-we),1)):we++,et=ae[ae.length-se],qe(O,{command:"addLayer",args:[ie[de],et]}),ae.splice(ae.length-se,0,de),ce[de]=!0);for(let se=0;se<G.length;se++)if(de=G[se],Ce=X[de],ke=ie[de],!ce[de]&&!be(Ce,ke))if(be(Ce.source,ke.source)&&be(Ce["source-layer"],ke["source-layer"])&&be(Ce.type,ke.type)){for(Ge in qt(Ce.layout,ke.layout,O,de,null,"setLayoutProperty"),qt(Ce.paint,ke.paint,O,de,null,"setPaintProperty"),be(Ce.filter,ke.filter)||qe(O,{command:"setFilter",args:[de,ke.filter]}),be(Ce.minzoom,ke.minzoom)&&be(Ce.maxzoom,ke.maxzoom)||qe(O,{command:"setLayerZoomRange",args:[de,ke.minzoom,ke.maxzoom]}),Ce)Object.prototype.hasOwnProperty.call(Ce,Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?qt(Ce[Ge],ke[Ge],O,de,Ge.slice(6),"setPaintProperty"):be(Ce[Ge],ke[Ge])||qe(O,{command:"setLayerProperty",args:[de,Ge,ke[Ge]]}));for(Ge in ke)Object.prototype.hasOwnProperty.call(ke,Ge)&&!Object.prototype.hasOwnProperty.call(Ce,Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?qt(Ce[Ge],ke[Ge],O,de,Ge.slice(6),"setPaintProperty"):be(Ce[Ge],ke[Ge])||qe(O,{command:"setLayerProperty",args:[de,Ge,ke[Ge]]}))}else qe(O,{command:"removeLayer",args:[de]}),et=ae[ae.lastIndexOf(de)+1],qe(O,{command:"addLayer",args:[ke,et]})}(S,l.layers,h)}catch(p){console.warn("Unable to compute style diff:",p),h=[{command:"setStyle",args:[l]}]}return h},c.bL=function(d){const l=[],h=d.id;return h===void 0&&l.push({message:`layers.${h}: missing required property "id"`}),d.render===void 0&&l.push({message:`layers.${h}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&l.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),l},c.bM=hn,c.bN=We,c.bO=class extends Gr{constructor(d,l){super(d,l),this.current=0}set(d){this.current!==d&&(this.current=d,this.gl.uniform1i(this.location,d))}},c.bP=a1,c.bQ=class extends Gr{constructor(d,l){super(d,l),this.current=Q2}set(d){if(d[12]!==this.current[12]||d[0]!==this.current[0])return this.current=d,void this.gl.uniformMatrix4fv(this.location,!1,d);for(let l=1;l<16;l++)if(d[l]!==this.current[l]){this.current=d,this.gl.uniformMatrix4fv(this.location,!1,d);break}}},c.bR=Li,c.bS=class extends Gr{constructor(d,l){super(d,l),this.current=[0,0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]||(this.current=d,this.gl.uniform3f(this.location,d[0],d[1],d[2]))}},c.bT=class extends Gr{constructor(d,l){super(d,l),this.current=[0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]||(this.current=d,this.gl.uniform2f(this.location,d[0],d[1]))}},c.bU=q,c.bV=function(d,l){var h=Math.sin(l),p=Math.cos(l);return d[0]=p,d[1]=h,d[2]=0,d[3]=-h,d[4]=p,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},c.bW=function(d,l,h){var p=l[0],y=l[1],S=l[2];return d[0]=p*h[0]+y*h[3]+S*h[6],d[1]=p*h[1]+y*h[4]+S*h[7],d[2]=p*h[2]+y*h[5]+S*h[8],d},c.bX=function(d,l,h,p,y,S,E){var R=1/(l-h),O=1/(p-y),B=1/(S-E);return d[0]=-2*R,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*O,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*B,d[11]=0,d[12]=(l+h)*R,d[13]=(y+p)*O,d[14]=(E+S)*B,d[15]=1,d},c.bY=class extends Gr{constructor(d,l){super(d,l),this.current=new Array}set(d){if(d!=this.current){this.current=d;const l=new Float32Array(4*d.length);for(let h=0;h<d.length;h++)l[4*h]=d[h].r,l[4*h+1]=d[h].g,l[4*h+2]=d[h].b,l[4*h+3]=d[h].a;this.gl.uniform4fv(this.location,l)}}},c.bZ=class extends Gr{constructor(d,l){super(d,l),this.current=new Array}set(d){if(d!=this.current){this.current=d;const l=new Float32Array(d);this.gl.uniform1fv(this.location,l)}}},c.b_=class extends m{},c.ba=function(d,l,h){const p=new Float64Array(4);return Ue(p,d,l-90,h),p},c.bb=function(d,l,h,p){var y,S,E,R,O,B=l[0],G=l[1],X=l[2],ie=l[3],ae=h[0],ce=h[1],de=h[2],Ce=h[3];return(S=B*ae+G*ce+X*de+ie*Ce)<0&&(S=-S,ae=-ae,ce=-ce,de=-de,Ce=-Ce),1-S>H?(y=Math.acos(S),E=Math.sin(y),R=Math.sin((1-p)*y)/E,O=Math.sin(p*y)/E):(R=1-p,O=p),d[0]=R*B+O*ae,d[1]=R*G+O*ce,d[2]=R*X+O*de,d[3]=R*ie+O*Ce,d},c.bc=function(d){const l=new Float64Array(9);var h,p,y,S,E,R,O,B,G,X,ie,ae,ce,de,Ce,ke,et,Ge;X=(y=(p=d)[0])*(O=y+y),ie=(S=p[1])*O,ce=(E=p[2])*O,de=E*(B=S+S),ke=(R=p[3])*O,et=R*B,Ge=R*(G=E+E),(h=l)[0]=1-(ae=S*B)-(Ce=E*G),h[3]=ie-Ge,h[6]=ce+et,h[1]=ie+Ge,h[4]=1-X-Ce,h[7]=de-ke,h[2]=ce-et,h[5]=de+ke,h[8]=1-X-ae;const se=Lt(-Math.asin(Tt(l[2],-1,1)));let we,Xe;return Math.hypot(l[5],l[8])<.001?(we=0,Xe=-Lt(Math.atan2(l[3],l[4]))):(we=Lt(l[5]===0&&l[8]===0?0:Math.atan2(l[5],l[8])),Xe=Lt(l[1]===0&&l[0]===0?0:Math.atan2(l[1],l[0]))),{roll:we,pitch:se+90,bearing:Xe}},c.bd=function(d,l){return d.roll==l.roll&&d.pitch==l.pitch&&d.bearing==l.bearing},c.be=tr,c.bf=zo,c.bg=kp,c.bh=Jv,c.bi=Lp,c.bj=lt,c.bk=Ot,c.bl=Wn,c.bm=function(d,l,h,p,y){return lt(p,y,Tt((d-l)/(h-l),0,1))},c.bn=je,c.bo=function(){return new Float64Array(3)},c.bp=function(d,l,h,p){return d[0]=l[0]+h[0]*p,d[1]=l[1]+h[1]*p,d[2]=l[2]+h[2]*p,d},c.bq=Ue,c.br=function(d,l,h){var p=h[0],y=h[1],S=h[2],E=l[0],R=l[1],O=l[2],B=y*O-S*R,G=S*E-p*O,X=p*R-y*E,ie=y*X-S*G,ae=S*B-p*X,ce=p*G-y*B,de=2*h[3];return G*=de,X*=de,ae*=2,ce*=2,d[0]=E+(B*=de)+(ie*=2),d[1]=R+G+ae,d[2]=O+X+ce,d},c.bs=function(d,l,h){const p=(y=[d[0],d[1],d[2],l[0],l[1],l[2],h[0],h[1],h[2]])[0]*((G=y[8])*(E=y[4])-(R=y[5])*(B=y[7]))+y[1]*(-G*(S=y[3])+R*(O=y[6]))+y[2]*(B*S-E*O);var y,S,E,R,O,B,G;if(p===0)return null;const X=Ne([],[l[0],l[1],l[2]],[h[0],h[1],h[2]]),ie=Ne([],[h[0],h[1],h[2]],[d[0],d[1],d[2]]),ae=Ne([],[d[0],d[1],d[2]],[l[0],l[1],l[2]]),ce=ge([],X,-d[3]);return ye(ce,ce,ge([],ie,-l[3])),ye(ce,ce,ge([],ae,-h[3])),ge(ce,ce,1/p),ce},c.bt=AC,c.bu=function(){return new Float64Array(4)},c.bv=function(d,l,h,p){var y=[],S=[];return y[0]=l[0]-h[0],y[1]=l[1]-h[1],y[2]=l[2]-h[2],S[0]=y[0]*Math.cos(p)-y[1]*Math.sin(p),S[1]=y[0]*Math.sin(p)+y[1]*Math.cos(p),S[2]=y[2],d[0]=S[0]+h[0],d[1]=S[1]+h[1],d[2]=S[2]+h[2],d},c.bw=function(d,l,h,p){var y=[],S=[];return y[0]=l[0]-h[0],y[1]=l[1]-h[1],y[2]=l[2]-h[2],S[0]=y[0],S[1]=y[1]*Math.cos(p)-y[2]*Math.sin(p),S[2]=y[1]*Math.sin(p)+y[2]*Math.cos(p),d[0]=S[0]+h[0],d[1]=S[1]+h[1],d[2]=S[2]+h[2],d},c.bx=function(d,l,h,p){var y=[],S=[];return y[0]=l[0]-h[0],y[1]=l[1]-h[1],y[2]=l[2]-h[2],S[0]=y[2]*Math.sin(p)+y[0]*Math.cos(p),S[1]=y[1],S[2]=y[2]*Math.cos(p)-y[0]*Math.sin(p),d[0]=S[0]+h[0],d[1]=S[1]+h[1],d[2]=S[2]+h[2],d},c.by=function(d,l,h){var p=Math.sin(h),y=Math.cos(h),S=l[0],E=l[1],R=l[2],O=l[3],B=l[8],G=l[9],X=l[10],ie=l[11];return l!==d&&(d[4]=l[4],d[5]=l[5],d[6]=l[6],d[7]=l[7],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15]),d[0]=S*y-B*p,d[1]=E*y-G*p,d[2]=R*y-X*p,d[3]=O*y-ie*p,d[8]=S*p+B*y,d[9]=E*p+G*y,d[10]=R*p+X*y,d[11]=O*p+ie*y,d},c.bz=function(d,l){const h=je(d,360),p=je(l,360),y=p-h,S=p>h?y-360:y+360;return Math.abs(y)<Math.abs(S)?y:S},c.c=_e,c.c0=class extends w{},c.c1=oC,c.c2=function(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))},c.c3=Ak,c.c4=function(d,l,h){var p=l[0],y=l[1],S=l[2],E=h[3]*p+h[7]*y+h[11]*S+h[15];return d[0]=(h[0]*p+h[4]*y+h[8]*S+h[12])/(E=E||1),d[1]=(h[1]*p+h[5]*y+h[9]*S+h[13])/E,d[2]=(h[2]*p+h[6]*y+h[10]*S+h[14])/E,d},c.c5=class extends Bv{},c.c6=class extends K{},c.c7=function(d,l){return d[0]===l[0]&&d[1]===l[1]&&d[2]===l[2]&&d[3]===l[3]&&d[4]===l[4]&&d[5]===l[5]&&d[6]===l[6]&&d[7]===l[7]&&d[8]===l[8]&&d[9]===l[9]&&d[10]===l[10]&&d[11]===l[11]&&d[12]===l[12]&&d[13]===l[13]&&d[14]===l[14]&&d[15]===l[15]},c.c8=function(d,l){var h=d[0],p=d[1],y=d[2],S=d[3],E=d[4],R=d[5],O=d[6],B=d[7],G=d[8],X=d[9],ie=d[10],ae=d[11],ce=d[12],de=d[13],Ce=d[14],ke=d[15],et=l[0],Ge=l[1],se=l[2],we=l[3],Xe=l[4],mt=l[5],$t=l[6],bt=l[7],Mt=l[8],Jt=l[9],jt=l[10],en=l[11],Pt=l[12],Cn=l[13],$n=l[14],Bn=l[15];return Math.abs(h-et)<=H*Math.max(1,Math.abs(h),Math.abs(et))&&Math.abs(p-Ge)<=H*Math.max(1,Math.abs(p),Math.abs(Ge))&&Math.abs(y-se)<=H*Math.max(1,Math.abs(y),Math.abs(se))&&Math.abs(S-we)<=H*Math.max(1,Math.abs(S),Math.abs(we))&&Math.abs(E-Xe)<=H*Math.max(1,Math.abs(E),Math.abs(Xe))&&Math.abs(R-mt)<=H*Math.max(1,Math.abs(R),Math.abs(mt))&&Math.abs(O-$t)<=H*Math.max(1,Math.abs(O),Math.abs($t))&&Math.abs(B-bt)<=H*Math.max(1,Math.abs(B),Math.abs(bt))&&Math.abs(G-Mt)<=H*Math.max(1,Math.abs(G),Math.abs(Mt))&&Math.abs(X-Jt)<=H*Math.max(1,Math.abs(X),Math.abs(Jt))&&Math.abs(ie-jt)<=H*Math.max(1,Math.abs(ie),Math.abs(jt))&&Math.abs(ae-en)<=H*Math.max(1,Math.abs(ae),Math.abs(en))&&Math.abs(ce-Pt)<=H*Math.max(1,Math.abs(ce),Math.abs(Pt))&&Math.abs(de-Cn)<=H*Math.max(1,Math.abs(de),Math.abs(Cn))&&Math.abs(Ce-$n)<=H*Math.max(1,Math.abs(Ce),Math.abs($n))&&Math.abs(ke-Bn)<=H*Math.max(1,Math.abs(ke),Math.abs(Bn))},c.c9=function(d,l){return d[0]=l[0],d[1]=l[1],d[2]=l[2],d[3]=l[3],d[4]=l[4],d[5]=l[5],d[6]=l[6],d[7]=l[7],d[8]=l[8],d[9]=l[9],d[10]=l[10],d[11]=l[11],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15],d},c.cA=function(d){delete te.REGISTERED_PROTOCOLS[d]},c.cB=function(d,l){const h={};for(let y=0;y<d.length;y++){const S=l&&l[d[y].id]||vp(d[y]);l&&(l[d[y].id]=S);let E=h[S];E||(E=h[S]=[]),E.push(d[y])}const p=[];for(const y in h)p.push(h[y]);return p},c.cC=xn,c.cD=RD,c.cE=kD,c.cF=cD,c.cG=function(d){d.bucket.createArrays(),d.bucket.tilePixelRatio=ct/(512*d.bucket.overscaling),d.bucket.compareText={},d.bucket.iconsNeedLinear=!1;const l=d.bucket.layers[0],h=l.layout,p=l._unevaluatedLayout._values,y={layoutIconSize:p["icon-size"].possiblyEvaluate(new Zr(d.bucket.zoom+1),d.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new Zr(d.bucket.zoom+1),d.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new Zr(18))};if(d.bucket.textSizeData.kind==="composite"){const{minZoom:B,maxZoom:G}=d.bucket.textSizeData;y.compositeTextSizes=[p["text-size"].possiblyEvaluate(new Zr(B),d.canonical),p["text-size"].possiblyEvaluate(new Zr(G),d.canonical)]}if(d.bucket.iconSizeData.kind==="composite"){const{minZoom:B,maxZoom:G}=d.bucket.iconSizeData;y.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new Zr(B),d.canonical),p["icon-size"].possiblyEvaluate(new Zr(G),d.canonical)]}const S=h.get("text-line-height")*Wi,E=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",R=h.get("text-keep-upright"),O=h.get("text-size");for(const B of d.bucket.features){const G=h.get("text-font").evaluate(B,{},d.canonical).join(","),X=O.evaluate(B,{},d.canonical),ie=y.layoutTextSize.evaluate(B,{},d.canonical),ae=y.layoutIconSize.evaluate(B,{},d.canonical),ce={horizontal:{},vertical:void 0},de=B.text;let Ce,ke=[0,0];if(de){const se=de.toString(),we=h.get("text-letter-spacing").evaluate(B,{},d.canonical)*Wi,Xe=e1(se)?we:0,mt=h.get("text-anchor").evaluate(B,{},d.canonical),$t=HD(l,B,d.canonical);if(!$t){const jt=h.get("text-radial-offset").evaluate(B,{},d.canonical);ke=jt?jD(mt,[jt*Wi,LC]):h.get("text-offset").evaluate(B,{},d.canonical).map(en=>en*Wi)}let bt=E?"center":h.get("text-justify").evaluate(B,{},d.canonical);const Mt=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(B,{},d.canonical)*Wi:1/0,Jt=()=>{d.bucket.allowVerticalPlacement&&kv(se)&&(ce.vertical=m1(de,d.glyphMap,d.glyphPositions,d.imagePositions,G,Mt,S,mt,"left",Xe,ke,c.an.vertical,!0,ie,X))};if(!E&&$t){const jt=new Set;if(bt==="auto")for(let Pt=0;Pt<$t.values.length;Pt+=2)jt.add(kC($t.values[Pt]));else jt.add(bt);let en=!1;for(const Pt of jt)if(!ce.horizontal[Pt])if(en)ce.horizontal[Pt]=ce.horizontal[0];else{const Cn=m1(de,d.glyphMap,d.glyphPositions,d.imagePositions,G,Mt,S,"center",Pt,Xe,ke,c.an.horizontal,!1,ie,X);Cn&&(ce.horizontal[Pt]=Cn,en=Cn.positionedLines.length===1)}Jt()}else{bt==="auto"&&(bt=kC(mt));const jt=m1(de,d.glyphMap,d.glyphPositions,d.imagePositions,G,Mt,S,mt,bt,Xe,ke,c.an.horizontal,!1,ie,X);jt&&(ce.horizontal[bt]=jt),Jt(),kv(se)&&E&&R&&(ce.vertical=m1(de,d.glyphMap,d.glyphPositions,d.imagePositions,G,Mt,S,mt,bt,Xe,ke,c.an.vertical,!1,ie,X))}}let et=!1;if(B.icon&&B.icon.name){const se=d.imageMap[B.icon.name];se&&(Ce=tX(d.imagePositions[B.icon.name],h.get("icon-offset").evaluate(B,{},d.canonical),h.get("icon-anchor").evaluate(B,{},d.canonical)),et=!!se.sdf,d.bucket.sdfIcons===void 0?d.bucket.sdfIcons=et:d.bucket.sdfIcons!==et&&tn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(se.pixelRatio!==d.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(d.bucket.iconsNeedLinear=!0))}const Ge=WD(ce.horizontal)||ce.vertical;d.bucket.iconsInText=!!Ge&&Ge.iconsInText,(Ge||Ce)&&yX(d.bucket,B,ce,Ce,d.imageMap,y,ie,ae,ke,et,d.canonical,d.subdivisionGranularity)}d.showCollisionBoxes&&d.bucket.generateCollisionDebugBuffers()},c.cH=vC,c.cI=hC,c.cJ=gC,c.cK=e0,c.cL=xC,c.cM=class{constructor(d){this._marks={start:[d.url,"start"].join("#"),end:[d.url,"end"].join("#"),measure:d.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let d=performance.getEntriesByName(this._marks.measure);return d.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),d=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),d}},c.cN=function(d,l,h,p,y){return o(this,void 0,void 0,function*(){if(U())try{return yield it(d,l,h,p,y)}catch{}return function(S,E,R,O,B){const G=S.width,X=S.height;St&&It||(St=new OffscreenCanvas(G,X),It=St.getContext("2d",{willReadFrequently:!0})),St.width=G,St.height=X,It.drawImage(S,0,0,G,X);const ie=It.getImageData(E,R,O,B);return It.clearRect(0,0,G,X),ie.data}(d,l,h,p,y)})},c.cO=Lk,c.cP=f,c.cQ=x,c.cR=Zk,c.cS=aD,c.cT=fp,c.cU=Vl,c.ca=d=>d.type==="symbol",c.cb=d=>d.type==="circle",c.cc=d=>d.type==="heatmap",c.cd=d=>d.type==="line",c.ce=d=>d.type==="fill",c.cf=d=>d.type==="fill-extrusion",c.cg=d=>d.type==="hillshade",c.ch=d=>d.type==="color-relief",c.ci=d=>d.type==="raster",c.cj=d=>d.type==="background",c.ck=d=>d.type==="custom",c.cl=ut,c.cm=function(d,l,h){const p=st(l.x-h.x,l.y-h.y),y=st(d.x-h.x,d.y-h.y);var S,E;return Lt(Math.atan2(p[0]*y[1]-p[1]*y[0],(S=p)[0]*(E=y)[0]+S[1]*E[1]))},c.cn=ot,c.co=function(d,l){return bn[l]&&(d instanceof MouseEvent||d instanceof WheelEvent)},c.cp=function(d,l){return kt[l]&&"touches"in d},c.cq=function(d){return kt[d]||bn[d]},c.cr=function(d,l,h){var p=l[0],y=l[1];return d[0]=h[0]*p+h[4]*y+h[12],d[1]=h[1]*p+h[5]*y+h[13],d},c.cs=function(d,l){const{x:h,y:p}=o0.fromLngLat(l);return!(d<0||d>25||p<0||p>=1||h<0||h>=1)},c.ct=function(d,l){return d[0]=l[0],d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=l[1],d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=l[2],d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d},c.cu=class extends Hl{},c.cv=xX,c.cx=function(d){return d.message===zt},c.cy=le,c.cz=function(d,l){te.REGISTERED_PROTOCOLS[d]=l},c.d=fe,c.e=un,c.f=d=>o(void 0,void 0,void 0,function*(){if(d.byteLength===0)return createImageBitmap(new ImageData(1,1));const l=new Blob([new Uint8Array(d)],{type:"image/png"});try{return createImageBitmap(l)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),c.g=re,c.h=d=>new Promise((l,h)=>{const p=new Image;p.onload=()=>{l(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=me})},p.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const y=new Blob([new Uint8Array(d)],{type:"image/png"});p.src=d.byteLength?URL.createObjectURL(y):me}),c.i=An,c.j=(d,l)=>Ve(un(d,{type:"json"}),l),c.k=ze,c.l=De,c.m=Ve,c.n=(d,l)=>Ve(un(d,{type:"arrayBuffer"}),l),c.o=function(d){return new xC(d).readFields(Hq,[])},c.p=lD,c.q=qv,c.r=Do,c.s=wt,c.t=Fv,c.u=rr,c.v=Oe,c.w=tn,c.x=q2,c.y=Ld,c.z=Gu}),i("worker",["./shared"],function(c){class o{constructor(te){this.keyCache={},te&&this.replace(te)}replace(te){this._layerConfigs={},this._layers={},this.update(te,[])}update(te,re){for(const le of te){this._layerConfigs[le.id]=le;const Te=this._layers[le.id]=c.bI(le);Te._featureFilter=c.a9(Te.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(const le of re)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};const Z=c.cB(Object.values(this._layerConfigs),this.keyCache);for(const le of Z){const Te=le.map(ze=>this._layers[ze.id]),Ve=Te[0];if(Ve.visibility==="none")continue;const fe=Ve.source||"";let xe=this.familiesBySource[fe];xe||(xe=this.familiesBySource[fe]={});const Re=Ve.sourceLayer||"_geojsonTileLayer";let De=xe[Re];De||(De=xe[Re]=[]),De.push(Te)}}}class f{constructor(te){const re={},Z=[];for(const fe in te){const xe=te[fe],Re=re[fe]={};for(const De in xe){const ze=xe[+De];if(!ze||ze.bitmap.width===0||ze.bitmap.height===0)continue;const Je={x:0,y:0,w:ze.bitmap.width+2,h:ze.bitmap.height+2};Z.push(Je),Re[De]={rect:Je,metrics:ze.metrics}}}const{w:le,h:Te}=c.p(Z),Ve=new c.q({width:le||1,height:Te||1});for(const fe in te){const xe=te[fe];for(const Re in xe){const De=xe[+Re];if(!De||De.bitmap.width===0||De.bitmap.height===0)continue;const ze=re[fe][Re].rect;c.q.copy(De.bitmap,Ve,{x:0,y:0},{x:ze.x+1,y:ze.y+1},De.bitmap)}}this.image=Ve,this.positions=re}}c.cC("GlyphAtlas",f);class g{constructor(te){this.tileID=new c.Z(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.uid=te.uid,this.zoom=te.zoom,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.collectResourceTiming,this.returnDependencies=!!te.returnDependencies,this.promoteId=te.promoteId,this.inFlightDependencies=[],this.globalState=te.globalState}parse(te,re,Z,le,Te){return c._(this,void 0,void 0,function*(){this.status="parsing",this.data=te,this.collisionBoxArray=new c.a7;const Ve=new c.cD(Object.keys(te.layers).sort()),fe=new c.cE(this.tileID,this.promoteId);fe.bucketLayerIDs=[];const xe={},Re={featureIndex:fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Z,subdivisionGranularity:Te},De=re.familiesBySource[this.source];for(const qt in De){const Gt=te.layers[qt];if(!Gt)continue;Gt.version===1&&c.w(`Vector tile source "${this.source}" layer "${qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const yn=Ve.encode(qt),gt=[];for(let In=0;In<Gt.length;In++){const cn=Gt.feature(In),Nn=fe.getId(cn,qt);gt.push({feature:cn,id:Nn,index:In,sourceLayerIndex:yn})}for(const In of De[qt]){const cn=In[0];cn.source!==this.source&&c.w(`layer.source = ${cn.source} does not equal this.source = ${this.source}`),cn.minzoom&&this.zoom<Math.floor(cn.minzoom)||cn.maxzoom&&this.zoom>=cn.maxzoom||cn.visibility!=="none"&&(_(In,this.zoom,Z),(xe[cn.id]=cn.createBucket({index:fe.bucketLayerIDs.length,layers:In,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:yn,sourceID:this.source,globalState:this.globalState})).populate(gt,Re,this.tileID.canonical),fe.bucketLayerIDs.push(In.map(Nn=>Nn.id)))}}const ze=c.bM(Re.glyphDependencies,qt=>Object.keys(qt).map(Number));this.inFlightDependencies.forEach(qt=>qt==null?void 0:qt.abort()),this.inFlightDependencies=[];let Je=Promise.resolve({});if(Object.keys(ze).length){const qt=new AbortController;this.inFlightDependencies.push(qt),Je=le.sendAsync({type:"GG",data:{stacks:ze,source:this.source,tileID:this.tileID,type:"glyphs"}},qt)}const Oe=Object.keys(Re.iconDependencies);let Et=Promise.resolve({});if(Oe.length){const qt=new AbortController;this.inFlightDependencies.push(qt),Et=le.sendAsync({type:"GI",data:{icons:Oe,source:this.source,tileID:this.tileID,type:"icons"}},qt)}const Ft=Object.keys(Re.patternDependencies);let be=Promise.resolve({});if(Ft.length){const qt=new AbortController;this.inFlightDependencies.push(qt),be=le.sendAsync({type:"GI",data:{icons:Ft,source:this.source,tileID:this.tileID,type:"patterns"}},qt)}const[qe,tt,At]=yield Promise.all([Je,Et,be]),Ht=new f(qe),Yt=new c.cF(tt,At);for(const qt in xe){const Gt=xe[qt];Gt instanceof c.a8?(_(Gt.layers,this.zoom,Z),c.cG({bucket:Gt,glyphMap:qe,glyphPositions:Ht.positions,imageMap:tt,imagePositions:Yt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Re.subdivisionGranularity})):Gt.hasPattern&&(Gt instanceof c.cH||Gt instanceof c.cI||Gt instanceof c.cJ)&&(_(Gt.layers,this.zoom,Z),Gt.addFeatures(Re,this.tileID.canonical,Yt.patternPositions))}return this.status="done",{buckets:Object.values(xe).filter(qt=>!qt.isEmpty()),featureIndex:fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ht.image,imageAtlas:Yt,glyphMap:this.returnDependencies?qe:null,iconMap:this.returnDependencies?tt:null,glyphPositions:this.returnDependencies?Ht.positions:null}})}}function _(_e,te,re){const Z=new c.F(te);for(const le of _e)le.recalculate(Z,re)}class x{constructor(te,re,Z){this.actor=te,this.layerIndex=re,this.availableImages=Z,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(te,re){return c._(this,void 0,void 0,function*(){const Z=yield c.n(te.request,re);try{return{vectorTile:new c.cK.VectorTile(new c.cL(Z.data)),rawData:Z.data,cacheControl:Z.cacheControl,expires:Z.expires}}catch(le){const Te=new Uint8Array(Z.data);let Ve=`Unable to parse the tile at ${te.request.url}, `;throw Ve+=Te[0]===31&&Te[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${le.message}`,new Error(Ve)}})}loadTile(te){return c._(this,void 0,void 0,function*(){const re=te.uid,Z=!!(te&&te.request&&te.request.collectResourceTiming)&&new c.cM(te.request),le=new g(te);this.loading[re]=le;const Te=new AbortController;le.abort=Te;try{const Ve=yield this.loadVectorTile(te,Te);if(delete this.loading[re],!Ve)return null;const fe=Ve.rawData,xe={};Ve.expires&&(xe.expires=Ve.expires),Ve.cacheControl&&(xe.cacheControl=Ve.cacheControl);const Re={};if(Z){const ze=Z.finish();ze&&(Re.resourceTiming=JSON.parse(JSON.stringify(ze)))}le.vectorTile=Ve.vectorTile;const De=le.parse(Ve.vectorTile,this.layerIndex,this.availableImages,this.actor,te.subdivisionGranularity);this.loaded[re]=le,this.fetching[re]={rawTileData:fe,cacheControl:xe,resourceTiming:Re};try{const ze=yield De;return c.e({rawTileData:fe.slice(0)},ze,xe,Re)}finally{delete this.fetching[re]}}catch(Ve){throw delete this.loading[re],le.status="done",this.loaded[re]=le,Ve}})}reloadTile(te){return c._(this,void 0,void 0,function*(){const re=te.uid;if(!this.loaded||!this.loaded[re])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Z=this.loaded[re];if(Z.showCollisionBoxes=te.showCollisionBoxes,Z.globalState=te.globalState,Z.status==="parsing"){const le=yield Z.parse(Z.vectorTile,this.layerIndex,this.availableImages,this.actor,te.subdivisionGranularity);let Te;if(this.fetching[re]){const{rawTileData:Ve,cacheControl:fe,resourceTiming:xe}=this.fetching[re];delete this.fetching[re],Te=c.e({rawTileData:Ve.slice(0)},le,fe,xe)}else Te=le;return Te}if(Z.status==="done"&&Z.vectorTile)return Z.parse(Z.vectorTile,this.layerIndex,this.availableImages,this.actor,te.subdivisionGranularity)})}abortTile(te){return c._(this,void 0,void 0,function*(){const re=this.loading,Z=te.uid;re&&re[Z]&&re[Z].abort&&(re[Z].abort.abort(),delete re[Z])})}removeTile(te){return c._(this,void 0,void 0,function*(){this.loaded&&this.loaded[te.uid]&&delete this.loaded[te.uid]})}}class M{constructor(){this.loaded={}}loadTile(te){return c._(this,void 0,void 0,function*(){const{uid:re,encoding:Z,rawImageData:le,redFactor:Te,greenFactor:Ve,blueFactor:fe,baseShift:xe}=te,Re=le.width+2,De=le.height+2,ze=c.b(le)?new c.R({width:Re,height:De},yield c.cN(le,-1,-1,Re,De)):le,Je=new c.cO(re,ze,Z,Te,Ve,fe,xe);return this.loaded=this.loaded||{},this.loaded[re]=Je,Je})}removeTile(te){const re=this.loaded,Z=te.uid;re&&re[Z]&&delete re[Z]}}var C,A,L=function(){if(A)return C;function _e(re,Z){if(re.length!==0){te(re[0],Z);for(var le=1;le<re.length;le++)te(re[le],!Z)}}function te(re,Z){for(var le=0,Te=0,Ve=0,fe=re.length,xe=fe-1;Ve<fe;xe=Ve++){var Re=(re[Ve][0]-re[xe][0])*(re[xe][1]+re[Ve][1]),De=le+Re;Te+=Math.abs(le)>=Math.abs(Re)?le-De+Re:Re-De+le,le=De}le+Te>=0!=!!Z&&re.reverse()}return A=1,C=function re(Z,le){var Te,Ve=Z&&Z.type;if(Ve==="FeatureCollection")for(Te=0;Te<Z.features.length;Te++)re(Z.features[Te],le);else if(Ve==="GeometryCollection")for(Te=0;Te<Z.geometries.length;Te++)re(Z.geometries[Te],le);else if(Ve==="Feature")re(Z.geometry,le);else if(Ve==="Polygon")_e(Z.coordinates,le);else if(Ve==="MultiPolygon")for(Te=0;Te<Z.coordinates.length;Te++)_e(Z.coordinates[Te],le);return Z}}(),I=c.cP(L);const T=c.cK.VectorTileFeature.prototype.toGeoJSON;class z{constructor(te){this._feature=te,this.extent=c.$,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))}loadGeometry(){if(this._feature.type===1){const te=[];for(const re of this._feature.geometry)te.push([new c.P(re[0],re[1])]);return te}{const te=[];for(const re of this._feature.geometry){const Z=[];for(const le of re)Z.push(new c.P(le[0],le[1]));te.push(Z)}return te}}toGeoJSON(te,re,Z){return T.call(this,te,re,Z)}}class k{constructor(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.$,this.length=te.length,this._features=te}feature(te){return new z(this._features[te])}}var U,H,V,q={exports:{}},J=function(){if(V)return q.exports;V=1;var _e=c.cS(),te=function(){if(H)return U;H=1;var De=c.cQ(),ze=c.cR().VectorTileFeature;function Je(Et,Ft){this.options=Ft||{},this.features=Et,this.length=Et.length}function Oe(Et,Ft){this.id=typeof Et.id=="number"?Et.id:void 0,this.type=Et.type,this.rawGeometry=Et.type===1?[Et.geometry]:Et.geometry,this.properties=Et.tags,this.extent=Ft||4096}return U=Je,Je.prototype.feature=function(Et){return new Oe(this.features[Et],this.options.extent)},Oe.prototype.loadGeometry=function(){var Et=this.rawGeometry;this.geometry=[];for(var Ft=0;Ft<Et.length;Ft++){for(var be=Et[Ft],qe=[],tt=0;tt<be.length;tt++)qe.push(new De(be[tt][0],be[tt][1]));this.geometry.push(qe)}return this.geometry},Oe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Et=this.geometry,Ft=1/0,be=-1/0,qe=1/0,tt=-1/0,At=0;At<Et.length;At++)for(var Ht=Et[At],Yt=0;Yt<Ht.length;Yt++){var qt=Ht[Yt];Ft=Math.min(Ft,qt.x),be=Math.max(be,qt.x),qe=Math.min(qe,qt.y),tt=Math.max(tt,qt.y)}return[Ft,qe,be,tt]},Oe.prototype.toGeoJSON=ze.prototype.toGeoJSON,U}();function re(De){var ze=new _e;return function(Je,Oe){for(var Et in Je.layers)Oe.writeMessage(3,Z,Je.layers[Et])}(De,ze),ze.finish()}function Z(De,ze){var Je;ze.writeVarintField(15,De.version||1),ze.writeStringField(1,De.name||""),ze.writeVarintField(5,De.extent||4096);var Oe={keys:[],values:[],keycache:{},valuecache:{}};for(Je=0;Je<De.length;Je++)Oe.feature=De.feature(Je),ze.writeMessage(2,le,Oe);var Et=Oe.keys;for(Je=0;Je<Et.length;Je++)ze.writeStringField(3,Et[Je]);var Ft=Oe.values;for(Je=0;Je<Ft.length;Je++)ze.writeMessage(4,Re,Ft[Je])}function le(De,ze){var Je=De.feature;Je.id!==void 0&&ze.writeVarintField(1,Je.id),ze.writeMessage(2,Te,De),ze.writeVarintField(3,Je.type),ze.writeMessage(4,xe,Je)}function Te(De,ze){var Je=De.feature,Oe=De.keys,Et=De.values,Ft=De.keycache,be=De.valuecache;for(var qe in Je.properties){var tt=Je.properties[qe],At=Ft[qe];if(tt!==null){At===void 0&&(Oe.push(qe),Ft[qe]=At=Oe.length-1),ze.writeVarint(At);var Ht=typeof tt;Ht!=="string"&&Ht!=="boolean"&&Ht!=="number"&&(tt=JSON.stringify(tt));var Yt=Ht+":"+tt,qt=be[Yt];qt===void 0&&(Et.push(tt),be[Yt]=qt=Et.length-1),ze.writeVarint(qt)}}}function Ve(De,ze){return(ze<<3)+(7&De)}function fe(De){return De<<1^De>>31}function xe(De,ze){for(var Je=De.loadGeometry(),Oe=De.type,Et=0,Ft=0,be=Je.length,qe=0;qe<be;qe++){var tt=Je[qe],At=1;Oe===1&&(At=tt.length),ze.writeVarint(Ve(1,At));for(var Ht=Oe===3?tt.length-1:tt.length,Yt=0;Yt<Ht;Yt++){Yt===1&&Oe!==1&&ze.writeVarint(Ve(2,Ht-1));var qt=tt[Yt].x-Et,Gt=tt[Yt].y-Ft;ze.writeVarint(fe(qt)),ze.writeVarint(fe(Gt)),Et+=qt,Ft+=Gt}Oe===3&&ze.writeVarint(Ve(7,1))}}function Re(De,ze){var Je=typeof De;Je==="string"?ze.writeStringField(1,De):Je==="boolean"?ze.writeBooleanField(7,De):Je==="number"&&(De%1!=0?ze.writeDoubleField(3,De):De<0?ze.writeSVarintField(6,De):ze.writeVarintField(5,De))}return q.exports=re,q.exports.fromVectorTileJs=re,q.exports.fromGeojsonVt=function(De,ze){ze=ze||{};var Je={};for(var Oe in De)Je[Oe]=new te(De[Oe].features,ze),Je[Oe].name=Oe,Je[Oe].version=ze.version,Je[Oe].extent=ze.extent;return re({layers:Je})},q.exports.GeoJSONWrapper=te,q.exports}(),Y=c.cP(J);const N={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:_e=>_e},ne=Math.fround||(ye=new Float32Array(1),_e=>(ye[0]=+_e,ye[0]));var ye;class ge{constructor(te){this.options=Object.assign(Object.create(N),te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(te){const{log:re,minZoom:Z,maxZoom:le}=this.options;re&&console.time("total time");const Te=`prepare ${te.length} points`;re&&console.time(Te),this.points=te;const Ve=[];for(let xe=0;xe<te.length;xe++){const Re=te[xe];if(!Re.geometry)continue;const[De,ze]=Re.geometry.coordinates,Je=ne(ve(De)),Oe=ne(Se(ze));Ve.push(Je,Oe,1/0,xe,-1,1),this.options.reduce&&Ve.push(0)}let fe=this.trees[le+1]=this._createTree(Ve);re&&console.timeEnd(Te);for(let xe=le;xe>=Z;xe--){const Re=+Date.now();fe=this.trees[xe]=this._createTree(this._cluster(fe,xe)),re&&console.log("z%d: %d clusters in %dms",xe,fe.numItems,+Date.now()-Re)}return re&&console.timeEnd("total time"),this}getClusters(te,re){let Z=((te[0]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,te[1]));let Te=te[2]===180?180:((te[2]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)Z=-180,Te=180;else if(Z>Te){const ze=this.getClusters([Z,le,180,Ve],re),Je=this.getClusters([-180,le,Te,Ve],re);return ze.concat(Je)}const fe=this.trees[this._limitZoom(re)],xe=fe.range(ve(Z),Se(Ve),ve(Te),Se(le)),Re=fe.data,De=[];for(const ze of xe){const Je=this.stride*ze;De.push(Re[Je+5]>1?Ne(Re,Je,this.clusterProps):this.points[Re[Je+3]])}return De}getChildren(te){const re=this._getOriginId(te),Z=this._getOriginZoom(te),le="No cluster with the specified id.",Te=this.trees[Z];if(!Te)throw new Error(le);const Ve=Te.data;if(re*this.stride>=Ve.length)throw new Error(le);const fe=this.options.radius/(this.options.extent*Math.pow(2,Z-1)),xe=Te.within(Ve[re*this.stride],Ve[re*this.stride+1],fe),Re=[];for(const De of xe){const ze=De*this.stride;Ve[ze+4]===te&&Re.push(Ve[ze+5]>1?Ne(Ve,ze,this.clusterProps):this.points[Ve[ze+3]])}if(Re.length===0)throw new Error(le);return Re}getLeaves(te,re,Z){const le=[];return this._appendLeaves(le,te,re=re||10,Z=Z||0,0),le}getTile(te,re,Z){const le=this.trees[this._limitZoom(te)],Te=Math.pow(2,te),{extent:Ve,radius:fe}=this.options,xe=fe/Ve,Re=(Z-xe)/Te,De=(Z+1+xe)/Te,ze={features:[]};return this._addTileFeatures(le.range((re-xe)/Te,Re,(re+1+xe)/Te,De),le.data,re,Z,Te,ze),re===0&&this._addTileFeatures(le.range(1-xe/Te,Re,1,De),le.data,Te,Z,Te,ze),re===Te-1&&this._addTileFeatures(le.range(0,Re,xe/Te,De),le.data,-1,Z,Te,ze),ze.features.length?ze:null}getClusterExpansionZoom(te){let re=this._getOriginZoom(te)-1;for(;re<=this.options.maxZoom;){const Z=this.getChildren(te);if(re++,Z.length!==1)break;te=Z[0].properties.cluster_id}return re}_appendLeaves(te,re,Z,le,Te){const Ve=this.getChildren(re);for(const fe of Ve){const xe=fe.properties;if(xe&&xe.cluster?Te+xe.point_count<=le?Te+=xe.point_count:Te=this._appendLeaves(te,xe.cluster_id,Z,le,Te):Te<le?Te++:te.push(fe),te.length===Z)break}return Te}_createTree(te){const re=new c.aH(te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Z=0;Z<te.length;Z+=this.stride)re.add(te[Z],te[Z+1]);return re.finish(),re.data=te,re}_addTileFeatures(te,re,Z,le,Te,Ve){for(const fe of te){const xe=fe*this.stride,Re=re[xe+5]>1;let De,ze,Je;if(Re)De=Ae(re,xe,this.clusterProps),ze=re[xe],Je=re[xe+1];else{const Ft=this.points[re[xe+3]];De=Ft.properties;const[be,qe]=Ft.geometry.coordinates;ze=ve(be),Je=Se(qe)}const Oe={type:1,geometry:[[Math.round(this.options.extent*(ze*Te-Z)),Math.round(this.options.extent*(Je*Te-le))]],tags:De};let Et;Et=Re||this.options.generateId?re[xe+3]:this.points[re[xe+3]].id,Et!==void 0&&(Oe.id=Et),Ve.features.push(Oe)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,re){const{radius:Z,extent:le,reduce:Te,minPoints:Ve}=this.options,fe=Z/(le*Math.pow(2,re)),xe=te.data,Re=[],De=this.stride;for(let ze=0;ze<xe.length;ze+=De){if(xe[ze+2]<=re)continue;xe[ze+2]=re;const Je=xe[ze],Oe=xe[ze+1],Et=te.within(xe[ze],xe[ze+1],fe),Ft=xe[ze+5];let be=Ft;for(const qe of Et){const tt=qe*De;xe[tt+2]>re&&(be+=xe[tt+5])}if(be>Ft&&be>=Ve){let qe,tt=Je*Ft,At=Oe*Ft,Ht=-1;const Yt=(ze/De<<5)+(re+1)+this.points.length;for(const qt of Et){const Gt=qt*De;if(xe[Gt+2]<=re)continue;xe[Gt+2]=re;const yn=xe[Gt+5];tt+=xe[Gt]*yn,At+=xe[Gt+1]*yn,xe[Gt+4]=Yt,Te&&(qe||(qe=this._map(xe,ze,!0),Ht=this.clusterProps.length,this.clusterProps.push(qe)),Te(qe,this._map(xe,Gt)))}xe[ze+4]=Yt,Re.push(tt/be,At/be,1/0,Yt,-1,be),Te&&Re.push(Ht)}else{for(let qe=0;qe<De;qe++)Re.push(xe[ze+qe]);if(be>1)for(const qe of Et){const tt=qe*De;if(!(xe[tt+2]<=re)){xe[tt+2]=re;for(let At=0;At<De;At++)Re.push(xe[tt+At])}}}}return Re}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,re,Z){if(te[re+5]>1){const Ve=this.clusterProps[te[re+6]];return Z?Object.assign({},Ve):Ve}const le=this.points[te[re+3]].properties,Te=this.options.map(le);return Z&&Te===le?Object.assign({},Te):Te}}function Ne(_e,te,re){return{type:"Feature",id:_e[te+3],properties:Ae(_e,te,re),geometry:{type:"Point",coordinates:[(Z=_e[te],360*(Z-.5)),Me(_e[te+1])]}};var Z}function Ae(_e,te,re){const Z=_e[te+5],le=Z>=1e4?`${Math.round(Z/1e3)}k`:Z>=1e3?Math.round(Z/100)/10+"k":Z,Te=_e[te+6],Ve=Te===-1?{}:Object.assign({},re[Te]);return Object.assign(Ve,{cluster:!0,cluster_id:_e[te+3],point_count:Z,point_count_abbreviated:le})}function ve(_e){return _e/360+.5}function Se(_e){const te=Math.sin(_e*Math.PI/180),re=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return re<0?0:re>1?1:re}function Me(_e){const te=(180-360*_e)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}function Ue(_e,te,re,Z){let le=Z;const Te=te+(re-te>>1);let Ve,fe=re-te;const xe=_e[te],Re=_e[te+1],De=_e[re],ze=_e[re+1];for(let Je=te+3;Je<re;Je+=3){const Oe=Qe(_e[Je],_e[Je+1],xe,Re,De,ze);if(Oe>le)Ve=Je,le=Oe;else if(Oe===le){const Et=Math.abs(Je-Te);Et<fe&&(Ve=Je,fe=Et)}}le>Z&&(Ve-te>3&&Ue(_e,te,Ve,Z),_e[Ve+2]=le,re-Ve>3&&Ue(_e,Ve,re,Z))}function Qe(_e,te,re,Z,le,Te){let Ve=le-re,fe=Te-Z;if(Ve!==0||fe!==0){const xe=((_e-re)*Ve+(te-Z)*fe)/(Ve*Ve+fe*fe);xe>1?(re=le,Z=Te):xe>0&&(re+=Ve*xe,Z+=fe*xe)}return Ve=_e-re,fe=te-Z,Ve*Ve+fe*fe}function st(_e,te,re,Z){const le={id:_e??null,type:te,geometry:re,tags:Z,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(te==="Point"||te==="MultiPoint"||te==="LineString")ct(le,re);else if(te==="Polygon")ct(le,re[0]);else if(te==="MultiLineString")for(const Te of re)ct(le,Te);else if(te==="MultiPolygon")for(const Te of re)ct(le,Te[0]);return le}function ct(_e,te){for(let re=0;re<te.length;re+=3)_e.minX=Math.min(_e.minX,te[re]),_e.minY=Math.min(_e.minY,te[re+1]),_e.maxX=Math.max(_e.maxX,te[re]),_e.maxY=Math.max(_e.maxY,te[re+1])}function Xt(_e,te,re,Z){if(!te.geometry)return;const le=te.geometry.coordinates;if(le&&le.length===0)return;const Te=te.geometry.type,Ve=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2);let fe=[],xe=te.id;if(re.promoteId?xe=te.properties[re.promoteId]:re.generateId&&(xe=Z||0),Te==="Point")je(le,fe);else if(Te==="MultiPoint")for(const Re of le)je(Re,fe);else if(Te==="LineString")lt(le,fe,Ve,!1);else if(Te==="MultiLineString"){if(re.lineMetrics){for(const Re of le)fe=[],lt(Re,fe,Ve,!1),_e.push(st(xe,"LineString",fe,te.properties));return}Ot(le,fe,Ve,!1)}else if(Te==="Polygon")Ot(le,fe,Ve,!0);else{if(Te!=="MultiPolygon"){if(Te==="GeometryCollection"){for(const Re of te.geometry.geometries)Xt(_e,{id:xe,geometry:Re,properties:te.properties},re,Z);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Re of le){const De=[];Ot(Re,De,Ve,!0),fe.push(De)}}_e.push(st(xe,Te,fe,te.properties))}function je(_e,te){te.push(ut(_e[0]),ot(_e[1]),0)}function lt(_e,te,re,Z){let le,Te,Ve=0;for(let xe=0;xe<_e.length;xe++){const Re=ut(_e[xe][0]),De=ot(_e[xe][1]);te.push(Re,De,0),xe>0&&(Ve+=Z?(le*De-Re*Te)/2:Math.sqrt(Math.pow(Re-le,2)+Math.pow(De-Te,2))),le=Re,Te=De}const fe=te.length-3;te[2]=1,Ue(te,0,fe,re),te[fe+2]=1,te.size=Math.abs(Ve),te.start=0,te.end=te.size}function Ot(_e,te,re,Z){for(let le=0;le<_e.length;le++){const Te=[];lt(_e[le],Te,re,Z),te.push(Te)}}function ut(_e){return _e/360+.5}function ot(_e){const te=Math.sin(_e*Math.PI/180),re=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return re<0?0:re>1?1:re}function Tt(_e,te,re,Z,le,Te,Ve,fe){if(Z/=te,Te>=(re/=te)&&Ve<Z)return _e;if(Ve<re||Te>=Z)return null;const xe=[];for(const Re of _e){const De=Re.geometry;let ze=Re.type;const Je=le===0?Re.minX:Re.minY,Oe=le===0?Re.maxX:Re.maxY;if(Je>=re&&Oe<Z){xe.push(Re);continue}if(Oe<re||Je>=Z)continue;let Et=[];if(ze==="Point"||ze==="MultiPoint")Ct(De,Et,re,Z,le);else if(ze==="LineString")un(De,Et,re,Z,le,!1,fe.lineMetrics);else if(ze==="MultiLineString")hn(De,Et,re,Z,le,!1);else if(ze==="Polygon")hn(De,Et,re,Z,le,!0);else if(ze==="MultiPolygon")for(const Ft of De){const be=[];hn(Ft,be,re,Z,le,!0),be.length&&Et.push(be)}if(Et.length){if(fe.lineMetrics&&ze==="LineString"){for(const Ft of Et)xe.push(st(Re.id,ze,Ft,Re.tags));continue}ze!=="LineString"&&ze!=="MultiLineString"||(Et.length===1?(ze="LineString",Et=Et[0]):ze="MultiLineString"),ze!=="Point"&&ze!=="MultiPoint"||(ze=Et.length===3?"Point":"MultiPoint"),xe.push(st(Re.id,ze,Et,Re.tags))}}return xe.length?xe:null}function Ct(_e,te,re,Z,le){for(let Te=0;Te<_e.length;Te+=3){const Ve=_e[Te+le];Ve>=re&&Ve<=Z&&We(te,_e[Te],_e[Te+1],_e[Te+2])}}function un(_e,te,re,Z,le,Te,Ve){let fe=gn(_e);const xe=le===0?vn:Ut;let Re,De,ze=_e.start;for(let be=0;be<_e.length-3;be+=3){const qe=_e[be],tt=_e[be+1],At=_e[be+2],Ht=_e[be+3],Yt=_e[be+4],qt=le===0?qe:tt,Gt=le===0?Ht:Yt;let yn=!1;Ve&&(Re=Math.sqrt(Math.pow(qe-Ht,2)+Math.pow(tt-Yt,2))),qt<re?Gt>re&&(De=xe(fe,qe,tt,Ht,Yt,re),Ve&&(fe.start=ze+Re*De)):qt>Z?Gt<Z&&(De=xe(fe,qe,tt,Ht,Yt,Z),Ve&&(fe.start=ze+Re*De)):We(fe,qe,tt,At),Gt<re&&qt>=re&&(De=xe(fe,qe,tt,Ht,Yt,re),yn=!0),Gt>Z&&qt<=Z&&(De=xe(fe,qe,tt,Ht,Yt,Z),yn=!0),!Te&&yn&&(Ve&&(fe.end=ze+Re*De),te.push(fe),fe=gn(_e)),Ve&&(ze+=Re)}let Je=_e.length-3;const Oe=_e[Je],Et=_e[Je+1],Ft=le===0?Oe:Et;Ft>=re&&Ft<=Z&&We(fe,Oe,Et,_e[Je+2]),Je=fe.length-3,Te&&Je>=3&&(fe[Je]!==fe[0]||fe[Je+1]!==fe[1])&&We(fe,fe[0],fe[1],fe[2]),fe.length&&te.push(fe)}function gn(_e){const te=[];return te.size=_e.size,te.start=_e.start,te.end=_e.end,te}function hn(_e,te,re,Z,le,Te){for(const Ve of _e)un(Ve,te,re,Z,le,Te,!1)}function We(_e,te,re,Z){_e.push(te,re,Z)}function vn(_e,te,re,Z,le,Te){const Ve=(Te-te)/(Z-te);return We(_e,Te,re+(le-re)*Ve,1),Ve}function Ut(_e,te,re,Z,le,Te){const Ve=(Te-re)/(le-re);return We(_e,te+(Z-te)*Ve,Te,1),Ve}function tn(_e,te){const re=[];for(let Z=0;Z<_e.length;Z++){const le=_e[Z],Te=le.type;let Ve;if(Te==="Point"||Te==="MultiPoint"||Te==="LineString")Ve=Dt(le.geometry,te);else if(Te==="MultiLineString"||Te==="Polygon"){Ve=[];for(const fe of le.geometry)Ve.push(Dt(fe,te))}else if(Te==="MultiPolygon"){Ve=[];for(const fe of le.geometry){const xe=[];for(const Re of fe)xe.push(Dt(Re,te));Ve.push(xe)}}re.push(st(le.id,Te,Ve,le.tags))}return re}function Dt(_e,te){const re=[];re.size=_e.size,_e.start!==void 0&&(re.start=_e.start,re.end=_e.end);for(let Z=0;Z<_e.length;Z+=3)re.push(_e[Z]+te,_e[Z+1],_e[Z+2]);return re}function An(_e,te){if(_e.transformed)return _e;const re=1<<_e.z,Z=_e.x,le=_e.y;for(const Te of _e.features){const Ve=Te.geometry,fe=Te.type;if(Te.geometry=[],fe===1)for(let xe=0;xe<Ve.length;xe+=2)Te.geometry.push(an(Ve[xe],Ve[xe+1],te,re,Z,le));else for(let xe=0;xe<Ve.length;xe++){const Re=[];for(let De=0;De<Ve[xe].length;De+=2)Re.push(an(Ve[xe][De],Ve[xe][De+1],te,re,Z,le));Te.geometry.push(Re)}}return _e.transformed=!0,_e}function an(_e,te,re,Z,le,Te){return[Math.round(re*(_e*Z-le)),Math.round(re*(te*Z-Te))]}function Le(_e,te,re,Z,le){const Te=te===le.maxZoom?0:le.tolerance/((1<<te)*le.extent),Ve={features:[],numPoints:0,numSimplified:0,numFeatures:_e.length,source:null,x:re,y:Z,z:te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const fe of _e)me(Ve,fe,Te,le);return Ve}function me(_e,te,re,Z){const le=te.geometry,Te=te.type,Ve=[];if(_e.minX=Math.min(_e.minX,te.minX),_e.minY=Math.min(_e.minY,te.minY),_e.maxX=Math.max(_e.maxX,te.maxX),_e.maxY=Math.max(_e.maxY,te.maxY),Te==="Point"||Te==="MultiPoint")for(let fe=0;fe<le.length;fe+=3)Ve.push(le[fe],le[fe+1]),_e.numPoints++,_e.numSimplified++;else if(Te==="LineString")it(Ve,le,_e,re,!1,!1);else if(Te==="MultiLineString"||Te==="Polygon")for(let fe=0;fe<le.length;fe++)it(Ve,le[fe],_e,re,Te==="Polygon",fe===0);else if(Te==="MultiPolygon")for(let fe=0;fe<le.length;fe++){const xe=le[fe];for(let Re=0;Re<xe.length;Re++)it(Ve,xe[Re],_e,re,!0,Re===0)}if(Ve.length){let fe=te.tags||null;if(Te==="LineString"&&Z.lineMetrics){fe={};for(const Re in te.tags)fe[Re]=te.tags[Re];fe.mapbox_clip_start=le.start/le.size,fe.mapbox_clip_end=le.end/le.size}const xe={geometry:Ve,type:Te==="Polygon"||Te==="MultiPolygon"?3:Te==="LineString"||Te==="MultiLineString"?2:1,tags:fe};te.id!==null&&(xe.id=te.id),_e.features.push(xe)}}function it(_e,te,re,Z,le,Te){const Ve=Z*Z;if(Z>0&&te.size<(le?Ve:Z))return void(re.numPoints+=te.length/3);const fe=[];for(let xe=0;xe<te.length;xe+=3)(Z===0||te[xe+2]>Ve)&&(re.numSimplified++,fe.push(te[xe],te[xe+1])),re.numPoints++;le&&function(xe,Re){let De=0;for(let ze=0,Je=xe.length,Oe=Je-2;ze<Je;Oe=ze,ze+=2)De+=(xe[ze]-xe[Oe])*(xe[ze+1]+xe[Oe+1]);if(De>0===Re)for(let ze=0,Je=xe.length;ze<Je/2;ze+=2){const Oe=xe[ze],Et=xe[ze+1];xe[ze]=xe[Je-2-ze],xe[ze+1]=xe[Je-1-ze],xe[Je-2-ze]=Oe,xe[Je-1-ze]=Et}}(fe,Te),_e.push(fe)}const St={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class It{constructor(te,re){const Z=(re=this.options=function(Te,Ve){for(const fe in Ve)Te[fe]=Ve[fe];return Te}(Object.create(St),re)).debug;if(Z&&console.time("preprocess data"),re.maxZoom<0||re.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(re.promoteId&&re.generateId)throw new Error("promoteId and generateId cannot be used together.");let le=function(Te,Ve){const fe=[];if(Te.type==="FeatureCollection")for(let xe=0;xe<Te.features.length;xe++)Xt(fe,Te.features[xe],Ve,xe);else Xt(fe,Te.type==="Feature"?Te:{geometry:Te},Ve);return fe}(te,re);this.tiles={},this.tileCoords=[],Z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",re.indexMaxZoom,re.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),le=function(Te,Ve){const fe=Ve.buffer/Ve.extent;let xe=Te;const Re=Tt(Te,1,-1-fe,fe,0,-1,2,Ve),De=Tt(Te,1,1-fe,2+fe,0,-1,2,Ve);return(Re||De)&&(xe=Tt(Te,1,-fe,1+fe,0,-1,2,Ve)||[],Re&&(xe=tn(Re,1).concat(xe)),De&&(xe=xe.concat(tn(De,-1)))),xe}(le,re),le.length&&this.splitTile(le,0,0,0),Z&&(le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(te,re,Z,le,Te,Ve,fe){const xe=[te,re,Z,le],Re=this.options,De=Re.debug;for(;xe.length;){le=xe.pop(),Z=xe.pop(),re=xe.pop(),te=xe.pop();const ze=1<<re,Je=wt(re,Z,le);let Oe=this.tiles[Je];if(!Oe&&(De>1&&console.time("creation"),Oe=this.tiles[Je]=Le(te,re,Z,le,Re),this.tileCoords.push({z:re,x:Z,y:le}),De)){De>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",re,Z,le,Oe.numFeatures,Oe.numPoints,Oe.numSimplified),console.timeEnd("creation"));const yn=`z${re}`;this.stats[yn]=(this.stats[yn]||0)+1,this.total++}if(Oe.source=te,Te==null){if(re===Re.indexMaxZoom||Oe.numPoints<=Re.indexMaxPoints)continue}else{if(re===Re.maxZoom||re===Te)continue;if(Te!=null){const yn=Te-re;if(Z!==Ve>>yn||le!==fe>>yn)continue}}if(Oe.source=null,te.length===0)continue;De>1&&console.time("clipping");const Et=.5*Re.buffer/Re.extent,Ft=.5-Et,be=.5+Et,qe=1+Et;let tt=null,At=null,Ht=null,Yt=null,qt=Tt(te,ze,Z-Et,Z+be,0,Oe.minX,Oe.maxX,Re),Gt=Tt(te,ze,Z+Ft,Z+qe,0,Oe.minX,Oe.maxX,Re);te=null,qt&&(tt=Tt(qt,ze,le-Et,le+be,1,Oe.minY,Oe.maxY,Re),At=Tt(qt,ze,le+Ft,le+qe,1,Oe.minY,Oe.maxY,Re),qt=null),Gt&&(Ht=Tt(Gt,ze,le-Et,le+be,1,Oe.minY,Oe.maxY,Re),Yt=Tt(Gt,ze,le+Ft,le+qe,1,Oe.minY,Oe.maxY,Re),Gt=null),De>1&&console.timeEnd("clipping"),xe.push(tt||[],re+1,2*Z,2*le),xe.push(At||[],re+1,2*Z,2*le+1),xe.push(Ht||[],re+1,2*Z+1,2*le),xe.push(Yt||[],re+1,2*Z+1,2*le+1)}}getTile(te,re,Z){te=+te,re=+re,Z=+Z;const le=this.options,{extent:Te,debug:Ve}=le;if(te<0||te>24)return null;const fe=1<<te,xe=wt(te,re=re+fe&fe-1,Z);if(this.tiles[xe])return An(this.tiles[xe],Te);Ve>1&&console.log("drilling down to z%d-%d-%d",te,re,Z);let Re,De=te,ze=re,Je=Z;for(;!Re&&De>0;)De--,ze>>=1,Je>>=1,Re=this.tiles[wt(De,ze,Je)];return Re&&Re.source?(Ve>1&&(console.log("found parent tile z%d-%d-%d",De,ze,Je),console.time("drilling down")),this.splitTile(Re.source,De,ze,Je,te,re,Z),Ve>1&&console.timeEnd("drilling down"),this.tiles[xe]?An(this.tiles[xe],Te):null):null}}function wt(_e,te,re){return 32*((1<<_e)*re+te)+_e}function Zt(_e,te){return te?_e.properties[te]:_e.id}function Lt(_e,te){if(_e==null)return!0;if(_e.type==="Feature")return Zt(_e,te)!=null;if(_e.type==="FeatureCollection"){const re=new Set;for(const Z of _e.features){const le=Zt(Z,te);if(le==null||re.has(le))return!1;re.add(le)}return!0}return!1}function kt(_e,te){const re=new Map;if(_e!=null)if(_e.type==="Feature")re.set(Zt(_e,te),_e);else for(const Z of _e.features)re.set(Zt(Z,te),Z);return re}class bn extends x{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(te,re){return c._(this,void 0,void 0,function*(){const Z=te.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const le=this._geoJSONIndex.getTile(Z.z,Z.x,Z.y);if(!le)return null;const Te=new k(le.features);let Ve=Y(Te);return Ve.byteOffset===0&&Ve.byteLength===Ve.buffer.byteLength||(Ve=new Uint8Array(Ve)),{vectorTile:Te,rawData:Ve.buffer}})}loadData(te){return c._(this,void 0,void 0,function*(){var re;(re=this._pendingRequest)===null||re===void 0||re.abort();const Z=!!(te&&te.request&&te.request.collectResourceTiming)&&new c.cM(te.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(te,this._pendingRequest),this._geoJSONIndex=te.cluster?new ge(function({superclusterOptions:Ve,clusterProperties:fe}){if(!fe||!Ve)return Ve;const xe={},Re={},De={accumulated:null,zoom:0},ze={properties:null},Je=Object.keys(fe);for(const Oe of Je){const[Et,Ft]=fe[Oe],be=c.cT(Ft),qe=c.cT(typeof Et=="string"?[Et,["accumulated"],["get",Oe]]:Et);xe[Oe]=be.value,Re[Oe]=qe.value}return Ve.map=Oe=>{ze.properties=Oe;const Et={};for(const Ft of Je)Et[Ft]=xe[Ft].evaluate(De,ze);return Et},Ve.reduce=(Oe,Et)=>{ze.properties=Et;for(const Ft of Je)De.accumulated=Oe[Ft],Oe[Ft]=Re[Ft].evaluate(De,ze)},Ve}(te)).load((yield this._pendingData).features):(le=yield this._pendingData,new It(le,te.geojsonVtOptions)),this.loaded={};const Te={};if(Z){const Ve=Z.finish();Ve&&(Te.resourceTiming={},Te.resourceTiming[te.source]=JSON.parse(JSON.stringify(Ve)))}return Te}catch(Te){if(delete this._pendingRequest,c.cx(Te))return{abandoned:!0};throw Te}var le})}getData(){return c._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(te){const re=this.loaded;return re&&re[te.uid]?super.reloadTile(te):this.loadTile(te)}loadAndProcessGeoJSON(te,re){return c._(this,void 0,void 0,function*(){let Z=yield this.loadGeoJSON(te,re);if(delete this._pendingRequest,typeof Z!="object")throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`);if(I(Z,!0),te.filter){const le=c.cT(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(le.result==="error")throw new Error(le.value.map(Ve=>`${Ve.key}: ${Ve.message}`).join(", "));Z={type:"FeatureCollection",features:Z.features.filter(Ve=>le.value.evaluate({zoom:0},Ve))}}return Z})}loadGeoJSON(te,re){return c._(this,void 0,void 0,function*(){const{promoteId:Z}=te;if(te.request){const le=yield c.j(te.request,re);return this._dataUpdateable=Lt(le.data,Z)?kt(le.data,Z):void 0,le.data}if(typeof te.data=="string")try{const le=JSON.parse(te.data);return this._dataUpdateable=Lt(le,Z)?kt(le,Z):void 0,le}catch{throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`)}if(!te.dataDiff)throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${te.source}`);return function(le,Te,Ve){var fe,xe,Re,De;if(Te.removeAll&&le.clear(),Te.remove)for(const ze of Te.remove)le.delete(ze);if(Te.add)for(const ze of Te.add){const Je=Zt(ze,Ve);Je!=null&&le.set(Je,ze)}if(Te.update)for(const ze of Te.update){let Je=le.get(ze.id);if(Je==null)continue;const Oe=!ze.removeAllProperties&&(((fe=ze.removeProperties)===null||fe===void 0?void 0:fe.length)>0||((xe=ze.addOrUpdateProperties)===null||xe===void 0?void 0:xe.length)>0);if((ze.newGeometry||ze.removeAllProperties||Oe)&&(Je=Object.assign({},Je),le.set(ze.id,Je),Oe&&(Je.properties=Object.assign({},Je.properties))),ze.newGeometry&&(Je.geometry=ze.newGeometry),ze.removeAllProperties)Je.properties={};else if(((Re=ze.removeProperties)===null||Re===void 0?void 0:Re.length)>0)for(const Et of ze.removeProperties)Object.prototype.hasOwnProperty.call(Je.properties,Et)&&delete Je.properties[Et];if(((De=ze.addOrUpdateProperties)===null||De===void 0?void 0:De.length)>0)for(const{key:Et,value:Ft}of ze.addOrUpdateProperties)Je.properties[Et]=Ft}}(this._dataUpdateable,te.dataDiff,Z),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(te){return c._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(te){return this._geoJSONIndex.getClusterExpansionZoom(te.clusterId)}getClusterChildren(te){return this._geoJSONIndex.getChildren(te.clusterId)}getClusterLeaves(te){return this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset)}}class zt{constructor(te){this.self=te,this.actor=new c.J(te),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(re,Z)=>{if(this.externalWorkerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.externalWorkerSourceTypes[re]=Z},this.self.addProtocol=c.cz,this.self.removeProtocol=c.cA,this.self.registerRTLTextPlugin=re=>{c.cU.setMethods(re)},this.actor.registerMessageHandler("LDT",(re,Z)=>this._getDEMWorkerSource(re,Z.source).loadTile(Z)),this.actor.registerMessageHandler("RDT",(re,Z)=>c._(this,void 0,void 0,function*(){this._getDEMWorkerSource(re,Z.source).removeTile(Z)})),this.actor.registerMessageHandler("GCEZ",(re,Z)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(re,Z.type,Z.source).getClusterExpansionZoom(Z)})),this.actor.registerMessageHandler("GCC",(re,Z)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(re,Z.type,Z.source).getClusterChildren(Z)})),this.actor.registerMessageHandler("GCL",(re,Z)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(re,Z.type,Z.source).getClusterLeaves(Z)})),this.actor.registerMessageHandler("LD",(re,Z)=>this._getWorkerSource(re,Z.type,Z.source).loadData(Z)),this.actor.registerMessageHandler("GD",(re,Z)=>this._getWorkerSource(re,Z.type,Z.source).getData()),this.actor.registerMessageHandler("LT",(re,Z)=>this._getWorkerSource(re,Z.type,Z.source).loadTile(Z)),this.actor.registerMessageHandler("RT",(re,Z)=>this._getWorkerSource(re,Z.type,Z.source).reloadTile(Z)),this.actor.registerMessageHandler("AT",(re,Z)=>this._getWorkerSource(re,Z.type,Z.source).abortTile(Z)),this.actor.registerMessageHandler("RMT",(re,Z)=>this._getWorkerSource(re,Z.type,Z.source).removeTile(Z)),this.actor.registerMessageHandler("RS",(re,Z)=>c._(this,void 0,void 0,function*(){if(!this.workerSources[re]||!this.workerSources[re][Z.type]||!this.workerSources[re][Z.type][Z.source])return;const le=this.workerSources[re][Z.type][Z.source];delete this.workerSources[re][Z.type][Z.source],le.removeSource!==void 0&&le.removeSource(Z)})),this.actor.registerMessageHandler("RM",re=>c._(this,void 0,void 0,function*(){delete this.layerIndexes[re],delete this.availableImages[re],delete this.workerSources[re],delete this.demWorkerSources[re]})),this.actor.registerMessageHandler("SR",(re,Z)=>c._(this,void 0,void 0,function*(){this.referrer=Z})),this.actor.registerMessageHandler("SRPS",(re,Z)=>this._syncRTLPluginState(re,Z)),this.actor.registerMessageHandler("IS",(re,Z)=>c._(this,void 0,void 0,function*(){this.self.importScripts(Z)})),this.actor.registerMessageHandler("SI",(re,Z)=>this._setImages(re,Z)),this.actor.registerMessageHandler("UL",(re,Z)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(re).update(Z.layers,Z.removedIds)})),this.actor.registerMessageHandler("SL",(re,Z)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(re).replace(Z)}))}_setImages(te,re){return c._(this,void 0,void 0,function*(){this.availableImages[te]=re;for(const Z in this.workerSources[te]){const le=this.workerSources[te][Z];for(const Te in le)le[Te].availableImages=re}})}_syncRTLPluginState(te,re){return c._(this,void 0,void 0,function*(){return yield c.cU.syncState(re,this.self.importScripts)})}_getAvailableImages(te){let re=this.availableImages[te];return re||(re=[]),re}_getLayerIndex(te){let re=this.layerIndexes[te];return re||(re=this.layerIndexes[te]=new o),re}_getWorkerSource(te,re,Z){if(this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][re]||(this.workerSources[te][re]={}),!this.workerSources[te][re][Z]){const le={sendAsync:(Te,Ve)=>(Te.targetMapId=te,this.actor.sendAsync(Te,Ve))};switch(re){case"vector":this.workerSources[te][re][Z]=new x(le,this._getLayerIndex(te),this._getAvailableImages(te));break;case"geojson":this.workerSources[te][re][Z]=new bn(le,this._getLayerIndex(te),this._getAvailableImages(te));break;default:this.workerSources[te][re][Z]=new this.externalWorkerSourceTypes[re](le,this._getLayerIndex(te),this._getAvailableImages(te))}}return this.workerSources[te][re][Z]}_getDEMWorkerSource(te,re){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][re]||(this.demWorkerSources[te][re]=new M),this.demWorkerSources[te][re]}}return c.i(self)&&(self.worker=new zt(self)),zt}),i("index",["exports","./shared"],function(c,o){var f="5.6.1";function g(){var b=new o.A(4);return o.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let _,x;const M={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,s,u){const m=requestAnimationFrame(w=>{v(),s(w)}),{unsubscribe:v}=o.s(b.signal,"abort",()=>{v(),cancelAnimationFrame(m),u(o.c())},!1)},frameAsync(b){return new Promise((s,u)=>{this.frame(b,s,u)})},getImageData(b,s=0){return this.getImageCanvasContext(b).getImageData(-s,-s,b.width+2*s,b.height+2*s)},getImageCanvasContext(b){const s=window.document.createElement("canvas"),u=s.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return s.width=b.width,s.height=b.height,u.drawImage(b,0,0,b.width,b.height),u},resolveURL:b=>(_||(_=document.createElement("a")),_.href=b,_.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(x==null&&(x=matchMedia("(prefers-reduced-motion: reduce)")),x.matches)}};class C{static testProp(s){if(!C.docStyle)return s[0];for(let u=0;u<s.length;u++)if(s[u]in C.docStyle)return s[u];return s[0]}static create(s,u,m){const v=window.document.createElement(s);return u!==void 0&&(v.className=u),m&&m.appendChild(v),v}static createNS(s,u){return window.document.createElementNS(s,u)}static disableDrag(){C.docStyle&&C.selectProp&&(C.userSelect=C.docStyle[C.selectProp],C.docStyle[C.selectProp]="none")}static enableDrag(){C.docStyle&&C.selectProp&&(C.docStyle[C.selectProp]=C.userSelect)}static setTransform(s,u){s.style[C.transformProp]=u}static addEventListener(s,u,m,v={}){s.addEventListener(u,m,"passive"in v?v:v.capture)}static removeEventListener(s,u,m,v={}){s.removeEventListener(u,m,"passive"in v?v:v.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",C.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",C.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",C.suppressClickInternal,!0)},0)}static getScale(s){const u=s.getBoundingClientRect();return{x:u.width/s.offsetWidth||1,y:u.height/s.offsetHeight||1,boundingClientRect:u}}static getPoint(s,u,m){const v=u.boundingClientRect;return new o.P((m.clientX-v.left)/u.x-s.clientLeft,(m.clientY-v.top)/u.y-s.clientTop)}static mousePos(s,u){const m=C.getScale(s);return C.getPoint(s,m,u)}static touchPos(s,u){const m=[],v=C.getScale(s);for(let w=0;w<u.length;w++)m.push(C.getPoint(s,v,u[w]));return m}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}static sanitize(s){const u=new DOMParser().parseFromString(s,"text/html").body||document.createElement("body"),m=u.querySelectorAll("script");for(const v of m)v.remove();return C.clean(u),u.innerHTML}static isPossiblyDangerous(s,u){const m=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(s)||!m.includes("javascript:")&&!m.includes("data:"))||!!s.startsWith("on")||void 0}static clean(s){const u=s.children;for(const m of u)C.removeAttributes(m),C.clean(m)}static removeAttributes(s){for(const{name:u,value:m}of s.attributes)C.isPossiblyDangerous(u,m)&&s.removeAttribute(u)}}C.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,C.selectProp=C.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),C.transformProp=C.testProp(["transform","WebkitTransform"]);const A={supported:!1,testSupport:function(b){!T&&I&&(z?k(b):L=b)}};let L,I,T=!1,z=!1;function k(b){const s=b.createTexture();b.bindTexture(b.TEXTURE_2D,s);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,I),b.isContextLost())return;A.supported=!0}catch{}b.deleteTexture(s),T=!0}var U;typeof document<"u"&&(I=document.createElement("img"),I.onload=()=>{L&&k(L),L=null,z=!0},I.onerror=()=>{T=!0,L=null},I.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let s,u,m,v;b.resetRequestQueue=()=>{s=[],u=0,m=0,v={}},b.addThrottleControl=F=>{const j=m++;return v[j]=F,j},b.removeThrottleControl=F=>{delete v[F],P()},b.getImage=(F,j,W=!0)=>new Promise((Q,K)=>{A.supported&&(F.headers||(F.headers={}),F.headers.accept="image/webp,*/*"),o.e(F,{type:"image"}),s.push({abortController:j,requestParameters:F,supportImageRefresh:W,state:"queued",onError:oe=>{K(oe)},onSuccess:oe=>{Q(oe)}}),P()});const w=F=>o._(this,void 0,void 0,function*(){F.state="running";const{requestParameters:j,supportImageRefresh:W,onError:Q,onSuccess:K,abortController:oe}=F,he=W===!1&&!o.i(self)&&!o.g(j.url)&&(!j.headers||Object.keys(j.headers).reduce((Ie,Fe)=>Ie&&Fe==="accept",!0));u++;const Pe=he?D(j,oe):o.m(j,oe);try{const Ie=yield Pe;delete F.abortController,F.state="completed",Ie.data instanceof HTMLImageElement||o.b(Ie.data)?K(Ie):Ie.data&&K({data:yield(Ee=Ie.data,typeof createImageBitmap=="function"?o.f(Ee):o.h(Ee)),cacheControl:Ie.cacheControl,expires:Ie.expires})}catch(Ie){delete F.abortController,Q(Ie)}finally{u--,P()}var Ee}),P=()=>{const F=(()=>{for(const j of Object.keys(v))if(v[j]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let j=u;j<F&&s.length>0;j++){const W=s.shift();W.abortController.signal.aborted?j--:w(W)}},D=(F,j)=>new Promise((W,Q)=>{const K=new Image,oe=F.url,he=F.credentials;he&&he==="include"?K.crossOrigin="use-credentials":(he&&he==="same-origin"||!o.d(oe))&&(K.crossOrigin="anonymous"),j.signal.addEventListener("abort",()=>{K.src="",Q(o.c())}),K.fetchPriority="high",K.onload=()=>{K.onerror=K.onload=null,W({data:K})},K.onerror=()=>{K.onerror=K.onload=null,j.signal.aborted||Q(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},K.src=oe})}(U||(U={})),U.resetRequestQueue();class H{constructor(s){this._transformRequestFn=s}transformRequest(s,u){return this._transformRequestFn&&this._transformRequestFn(s,u)||{url:s}}setTransformRequest(s){this._transformRequestFn=s}}function V(b){const s=[];if(typeof b=="string")s.push({id:"default",url:b});else if(b&&b.length>0){const u=[];for(const{id:m,url:v}of b){const w=`${m}${v}`;u.indexOf(w)===-1&&(u.push(w),s.push({id:m,url:v}))}}return s}function q(b,s,u){try{const m=new URL(b);return m.pathname+=`${s}${u}`,m.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function J(b){const{userImage:s}=b;return!!(s&&s.render&&s.render())&&(b.data.replace(new Uint8Array(s.data.buffer)),!0)}class Y extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:u,promiseResolve:m}of this.requestors)m(this._getImagesForIds(u));this.requestors=[]}}getImage(s){const u=this.images[s];if(u&&!u.data&&u.spriteData){const m=u.spriteData;u.data=new o.R({width:m.width,height:m.height},m.context.getImageData(m.x,m.y,m.width,m.height).data),u.spriteData=null}return u}addImage(s,u){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,u)&&(this.images[s]=u)}_validate(s,u){let m=!0;const v=u.data||u.spriteData;return this._validateStretch(u.stretchX,v&&v.width)||(this.fire(new o.k(new Error(`Image "${s}" has invalid "stretchX" value`))),m=!1),this._validateStretch(u.stretchY,v&&v.height)||(this.fire(new o.k(new Error(`Image "${s}" has invalid "stretchY" value`))),m=!1),this._validateContent(u.content,u)||(this.fire(new o.k(new Error(`Image "${s}" has invalid "content" value`))),m=!1),m}_validateStretch(s,u){if(!s)return!0;let m=0;for(const v of s){if(v[0]<m||v[1]<v[0]||u<v[1])return!1;m=v[1]}return!0}_validateContent(s,u){if(!s)return!0;if(s.length!==4)return!1;const m=u.spriteData,v=m&&m.width||u.data.width,w=m&&m.height||u.data.height;return!(s[0]<0||v<s[0]||s[1]<0||w<s[1]||s[2]<0||v<s[2]||s[3]<0||w<s[3]||s[2]<s[0]||s[3]<s[1])}updateImage(s,u,m=!0){const v=this.getImage(s);if(m&&(v.data.width!==u.data.width||v.data.height!==u.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=v.version+1,this.images[s]=u,this.updatedImages[s]=!0}removeImage(s){const u=this.images[s];delete this.images[s],delete this.patterns[s],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s){return new Promise((u,m)=>{let v=!0;if(!this.isLoaded())for(const w of s)this.images[w]||(v=!1);this.isLoaded()||v?u(this._getImagesForIds(s)):this.requestors.push({ids:s,promiseResolve:u})})}_getImagesForIds(s){const u={};for(const m of s){let v=this.getImage(m);v||(this.fire(new o.l("styleimagemissing",{id:m})),v=this.getImage(m)),v?u[m]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:o.w(`Image "${m}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:s,height:u}=this.atlasImage;return{width:s,height:u}}getPattern(s){const u=this.patterns[s],m=this.getImage(s);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{const v={w:m.data.width+2,h:m.data.height+2,x:0,y:0},w=new o.I(v,m);this.patterns[s]={bin:v,position:w}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const u=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(s,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const w in this.patterns)s.push(this.patterns[w].bin);const{w:u,h:m}=o.p(s),v=this.atlasImage;v.resize({width:u||1,height:m||1});for(const w in this.patterns){const{bin:P}=this.patterns[w],D=P.x+1,F=P.y+1,j=this.getImage(w).data,W=j.width,Q=j.height;o.R.copy(j,v,{x:0,y:0},{x:D,y:F},{width:W,height:Q}),o.R.copy(j,v,{x:0,y:Q-1},{x:D,y:F-1},{width:W,height:1}),o.R.copy(j,v,{x:0,y:0},{x:D,y:F+Q},{width:W,height:1}),o.R.copy(j,v,{x:W-1,y:0},{x:D-1,y:F},{width:1,height:Q}),o.R.copy(j,v,{x:0,y:0},{x:D+W,y:F},{width:1,height:Q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const u of s){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const m=this.getImage(u);m||o.w(`Image with ID: "${u}" was not found`),J(m)&&this.updateImage(u,m)}}}const N=1e20;function ne(b,s,u,m,v,w,P,D,F){for(let j=s;j<s+m;j++)ye(b,u*w+j,w,v,P,D,F);for(let j=u;j<u+v;j++)ye(b,j*w+s,1,m,P,D,F)}function ye(b,s,u,m,v,w,P){w[0]=0,P[0]=-N,P[1]=N,v[0]=b[s];for(let D=1,F=0,j=0;D<m;D++){v[D]=b[s+D*u];const W=D*D;do{const Q=w[F];j=(v[D]-v[Q]+W-Q*Q)/(D-Q)/2}while(j<=P[F]&&--F>-1);F++,w[F]=D,P[F]=j,P[F+1]=N}for(let D=0,F=0;D<m;D++){for(;P[F+1]<D;)F++;const j=w[F],W=D-j;b[s+D*u]=v[j]+W*W}}class ge{constructor(s,u){this.requestManager=s,this.localIdeographFontFamily=u,this.entries={}}setURL(s){this.url=s}getGlyphs(s){return o._(this,void 0,void 0,function*(){const u=[];for(const w in s)for(const P of s[w])u.push(this._getAndCacheGlyphsPromise(w,P));const m=yield Promise.all(u),v={};for(const{stack:w,id:P,glyph:D}of m)v[w]||(v[w]={}),v[w][P]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics};return v})}_getAndCacheGlyphsPromise(s,u){return o._(this,void 0,void 0,function*(){let m=this.entries[s];m||(m=this.entries[s]={glyphs:{},requests:{},ranges:{}});let v=m.glyphs[u];if(v!==void 0)return{stack:s,id:u,glyph:v};if(v=this._tinySDF(m,s,u),v)return m.glyphs[u]=v,{stack:s,id:u,glyph:v};const w=Math.floor(u/256);if(256*w>65535)throw new Error("glyphs > 65535 not supported");if(m.ranges[w])return{stack:s,id:u,glyph:v};if(!this.url)throw new Error("glyphsUrl is not set");if(!m.requests[w]){const D=ge.loadGlyphRange(s,w,this.url,this.requestManager);m.requests[w]=D}const P=yield m.requests[w];for(const D in P)this._doesCharSupportLocalGlyph(+D)||(m.glyphs[+D]=P[+D]);return m.ranges[w]=!0,{stack:s,id:u,glyph:P[u]||null}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(s))||o.u["CJK Unified Ideographs"](s)||o.u["Hangul Syllables"](s)||o.u.Hiragana(s)||o.u.Katakana(s)||o.u["CJK Symbols and Punctuation"](s)||o.u["Halfwidth and Fullwidth Forms"](s))}_tinySDF(s,u,m){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(m))return;let w=s.tinySDF;if(!w){let D="400";/bold/i.test(u)?D="900":/medium/i.test(u)?D="500":/light/i.test(u)&&(D="200"),w=s.tinySDF=new ge.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:v,fontWeight:D})}const P=w.draw(String.fromCharCode(m));return{id:m,bitmap:new o.q({width:P.width||60,height:P.height||60},P.data),metrics:{width:P.glyphWidth/2||24,height:P.glyphHeight/2||24,left:P.glyphLeft/2+.5||0,top:P.glyphTop/2-27.5||-8,advance:P.glyphAdvance/2||24,isDoubleResolution:!0}}}}ge.loadGlyphRange=function(b,s,u,m){return o._(this,void 0,void 0,function*(){const v=256*s,w=v+255,P=m.transformRequest(u.replace("{fontstack}",b).replace("{range}",`${v}-${w}`),"Glyphs"),D=yield o.n(P,new AbortController);if(!D||!D.data)throw new Error(`Could not load glyph range. range: ${s}, ${v}-${w}`);const F={};for(const j of o.o(D.data))F[j.id]=j;return F})},ge.TinySDF=class{constructor({fontSize:b=24,buffer:s=3,radius:u=8,cutoff:m=.25,fontFamily:v="sans-serif",fontWeight:w="normal",fontStyle:P="normal"}={}){this.buffer=s,this.cutoff=m,this.radius=u;const D=this.size=b+4*s,F=this._createCanvas(D),j=this.ctx=F.getContext("2d",{willReadFrequently:!0});j.font=`${P} ${w} ${b}px ${v}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(D*D),this.gridInner=new Float64Array(D*D),this.f=new Float64Array(D),this.z=new Float64Array(D+1),this.v=new Uint16Array(D)}_createCanvas(b){const s=document.createElement("canvas");return s.width=s.height=b,s}draw(b){const{width:s,actualBoundingBoxAscent:u,actualBoundingBoxDescent:m,actualBoundingBoxLeft:v,actualBoundingBoxRight:w}=this.ctx.measureText(b),P=Math.ceil(u),D=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-v))),F=Math.min(this.size-this.buffer,P+Math.ceil(m)),j=D+2*this.buffer,W=F+2*this.buffer,Q=Math.max(j*W,0),K=new Uint8ClampedArray(Q),oe={data:K,width:j,height:W,glyphWidth:D,glyphHeight:F,glyphTop:P,glyphLeft:0,glyphAdvance:s};if(D===0||F===0)return oe;const{ctx:he,buffer:Pe,gridInner:Ee,gridOuter:Ie}=this;he.clearRect(Pe,Pe,D,F),he.fillText(b,Pe,Pe+P);const Fe=he.getImageData(Pe,Pe,D,F);Ie.fill(N,0,Q),Ee.fill(0,0,Q);for(let He=0;He<F;He++)for(let Be=0;Be<D;Be++){const Ye=Fe.data[4*(He*D+Be)+3]/255;if(Ye===0)continue;const Ke=(He+Pe)*j+Be+Pe;if(Ye===1)Ie[Ke]=0,Ee[Ke]=N;else{const $e=.5-Ye;Ie[Ke]=$e>0?$e*$e:0,Ee[Ke]=$e<0?$e*$e:0}}ne(Ie,0,0,j,W,j,this.f,this.v,this.z),ne(Ee,Pe,Pe,D,F,j,this.f,this.v,this.z);for(let He=0;He<Q;He++){const Be=Math.sqrt(Ie[He])-Math.sqrt(Ee[He]);K[He]=Math.round(255-255*(Be/this.radius+this.cutoff))}return oe}};class Ne{constructor(){this.specification=o.v.light.position}possiblyEvaluate(s,u){return o.B(s.expression.evaluate(u))}interpolate(s,u,m){return{x:o.C.number(s.x,u.x,m),y:o.C.number(s.y,u.y,m),z:o.C.number(s.z,u.z,m)}}}let Ae;class ve extends o.E{constructor(s){super(),Ae=Ae||new o.r({anchor:new o.D(o.v.light.anchor),position:new Ne,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.t(Ae),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,u={}){if(!this._validate(o.x,s,u))for(const m in s){const v=s[m];m.endsWith("-transition")?this._transitionable.setTransition(m.slice(0,-11),v):this._transitionable.setValue(m,v)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,m){return(!m||m.validate!==!1)&&o.y(this,s.call(o.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}const Se=new o.r({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class Me extends o.E{constructor(s){super(),this._transitionable=new o.t(Se),this.setSky(s),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0))}setSky(s,u={}){if(!this._validate(o.G,s,u)){s||(s={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const m in s){const v=s[m];m.endsWith("-transition")?this._transitionable.setTransition(m.slice(0,-11),v):this._transitionable.setValue(m,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,m={}){return(m==null?void 0:m.validate)!==!1&&o.y(this,s.call(o.z,o.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(s){return s<60?0:s<70?(s-60)/10:1}}class Ue{constructor(s,u){this.width=s,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,u){const m=s.join(",")+String(u);return this.dashEntry[m]||(this.dashEntry[m]=this.addDash(s,u)),this.dashEntry[m]}getDashRanges(s,u,m){const v=[];let w=s.length%2==1?-s[s.length-1]*m:0,P=s[0]*m,D=!0;v.push({left:w,right:P,isDash:D,zeroLength:s[0]===0});let F=s[0];for(let j=1;j<s.length;j++){D=!D;const W=s[j];w=F*m,F+=W,P=F*m,v.push({left:w,right:P,isDash:D,zeroLength:W===0})}return v}addRoundDash(s,u,m){const v=u/2;for(let w=-m;w<=m;w++){const P=this.width*(this.nextRow+m+w);let D=0,F=s[D];for(let j=0;j<this.width;j++){j/F.right>1&&(F=s[++D]);const W=Math.abs(j-F.left),Q=Math.abs(j-F.right),K=Math.min(W,Q);let oe;const he=w/m*(v+1);if(F.isDash){const Pe=v-Math.abs(he);oe=Math.sqrt(K*K+Pe*Pe)}else oe=v-Math.sqrt(K*K+he*he);this.data[P+j]=Math.max(0,Math.min(255,oe+128))}}}addRegularDash(s){for(let D=s.length-1;D>=0;--D){const F=s[D],j=s[D+1];F.zeroLength?s.splice(D,1):j&&j.isDash===F.isDash&&(j.left=F.left,s.splice(D,1))}const u=s[0],m=s[s.length-1];u.isDash===m.isDash&&(u.left=m.left-this.width,m.right=u.right+this.width);const v=this.width*this.nextRow;let w=0,P=s[w];for(let D=0;D<this.width;D++){D/P.right>1&&(P=s[++w]);const F=Math.abs(D-P.left),j=Math.abs(D-P.right),W=Math.min(F,j);this.data[v+D]=Math.max(0,Math.min(255,(P.isDash?W:-W)+128))}}addDash(s,u){const m=u?7:0,v=2*m+1;if(this.nextRow+v>this.height)return o.w("LineAtlas out of space"),null;let w=0;for(let D=0;D<s.length;D++)w+=s[D];if(w!==0){const D=this.width/w,F=this.getDashRanges(s,this.width,D);u?this.addRoundDash(F,D,m):this.addRegularDash(F)}const P={y:(this.nextRow+m+.5)/this.height,height:2*m/this.height,width:w};return this.nextRow+=v,this.dirty=!0,P}bind(s){const u=s.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const Qe="maplibre_preloaded_worker_pool";class st{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<st.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Qe]}numActive(){return Object.keys(this.active).length}}const ct=Math.floor(M.hardwareConcurrency/2);let Xt,je;function lt(){return Xt||(Xt=new st),Xt}st.workerCount=o.H(globalThis)?Math.max(Math.min(ct,3),1):1;class Ot{constructor(s,u){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=u;const m=this.workerPool.acquire(u);for(let v=0;v<m.length;v++){const w=new o.J(m[v],u);w.name=`Worker ${v}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,u){const m=[];for(const v of this.actors)m.push(v.sendAsync({type:s,data:u}));return Promise.all(m)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(s=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],s&&this.workerPool.release(this.id)}registerMessageHandler(s,u){for(const m of this.actors)m.registerMessageHandler(s,u)}}function ut(){return je||(je=new Ot(lt(),o.K),je.registerMessageHandler("GR",(b,s,u)=>o.m(s,u))),je}function ot(b,s){const u=o.L();return o.M(u,u,[1,1,0]),o.N(u,u,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?o.O(u,u,b.calculatePosMatrix(s.toUnwrapped())):u}function Tt(b,s,u,m,v,w,P){var D;const F=function(K,oe,he){if(K)for(const Pe of K){const Ee=oe[Pe];if(Ee&&Ee.source===he&&Ee.type==="fill-extrusion")return!0}else for(const Pe in oe){const Ee=oe[Pe];if(Ee.source===he&&Ee.type==="fill-extrusion")return!0}return!1}((D=v==null?void 0:v.layers)!==null&&D!==void 0?D:null,s,b.id),j=w.maxPitchScaleFactor(),W=b.tilesIn(m,j,F);W.sort(Ct);const Q=[];for(const K of W)Q.push({wrappedTileID:K.tileID.wrapped().key,queryResults:K.tile.queryRenderedFeatures(s,u,b._state,K.queryGeometry,K.cameraQueryGeometry,K.scale,v,w,j,ot(b.transform,K.tileID),P?(oe,he)=>P(K.tileID,oe,he):void 0)});return function(K,oe){for(const he in K)for(const Pe of K[he])un(Pe,oe);return K}(function(K){const oe={},he={};for(const Pe of K){const Ee=Pe.queryResults,Ie=Pe.wrappedTileID,Fe=he[Ie]=he[Ie]||{};for(const He in Ee){const Be=Ee[He],Ye=Fe[He]=Fe[He]||{},Ke=oe[He]=oe[He]||[];for(const $e of Be)Ye[$e.featureIndex]||(Ye[$e.featureIndex]=!0,Ke.push($e))}}return oe}(Q),b)}function Ct(b,s){const u=b.tileID,m=s.tileID;return u.overscaledZ-m.overscaledZ||u.canonical.y-m.canonical.y||u.wrap-m.wrap||u.canonical.x-m.canonical.x}function un(b,s){const u=b.feature,m=s.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=m}function gn(b,s,u){return o._(this,void 0,void 0,function*(){let m=b;if(b.url?m=(yield o.j(s.transformRequest(b.url,"Source"),u)).data:yield M.frameAsync(u),!m)return null;const v=o.Q(o.e(m,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in m&&m.vector_layers&&(v.vectorLayerIds=m.vector_layers.map(w=>w.id)),v})}class hn{constructor(s,u){s&&(u?this.setSouthWest(s).setNorthEast(u):Array.isArray(s)&&(s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1])))}setNorthEast(s){return this._ne=s instanceof o.S?new o.S(s.lng,s.lat):o.S.convert(s),this}setSouthWest(s){return this._sw=s instanceof o.S?new o.S(s.lng,s.lat):o.S.convert(s),this}extend(s){const u=this._sw,m=this._ne;let v,w;if(s instanceof o.S)v=s,w=s;else{if(!(s instanceof hn))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(hn.convert(s)):this.extend(o.S.convert(s)):s&&("lng"in s||"lon"in s)&&"lat"in s?this.extend(o.S.convert(s)):this;if(v=s._sw,w=s._ne,!v||!w)return this}return u||m?(u.lng=Math.min(v.lng,u.lng),u.lat=Math.min(v.lat,u.lat),m.lng=Math.max(w.lng,m.lng),m.lat=Math.max(w.lat,m.lat)):(this._sw=new o.S(v.lng,v.lat),this._ne=new o.S(w.lng,w.lat)),this}getCenter(){return new o.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.S(this.getWest(),this.getNorth())}getSouthEast(){return new o.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:u,lat:m}=o.S.convert(s);let v=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&v}static convert(s){return s instanceof hn?s:s&&new hn(s)}static fromLngLat(s,u=0){const m=360*u/40075017,v=m/Math.cos(Math.PI/180*s.lat);return new hn(new o.S(s.lng-v,s.lat-m),new o.S(s.lng+v,s.lat+m))}adjustAntiMeridian(){const s=new o.S(this._sw.lng,this._sw.lat),u=new o.S(this._ne.lng,this._ne.lat);return new hn(s,s.lng>u.lng?new o.S(u.lng+360,u.lat):u)}}class We{constructor(s,u,m){this.bounds=hn.convert(this.validateBounds(s)),this.minzoom=u||0,this.maxzoom=m||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const u=Math.pow(2,s.z),m=Math.floor(o.V(this.bounds.getWest())*u),v=Math.floor(o.U(this.bounds.getNorth())*u),w=Math.ceil(o.V(this.bounds.getEast())*u),P=Math.ceil(o.U(this.bounds.getSouth())*u);return s.x>=m&&s.x<w&&s.y>=v&&s.y<P}}class vn extends o.E{constructor(s,u,m,v){if(super(),this.id=s,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.Q(u,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield gn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),s&&(o.e(this,s),s.bounds&&(this.tileBounds=new We(s.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new o.k(s))}})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.abort(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(s){return o._(this,void 0,void 0,function*(){const u=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m={request:this.map._requestManager.transformRequest(u,"Tile"),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};m.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(s.actor&&s.state!=="expired"){if(s.state==="loading")return new Promise((w,P)=>{s.reloadPromise={resolve:w,reject:P}})}else s.actor=this.dispatcher.getActor(),v="LT";s.abortController=new AbortController;try{const w=yield s.actor.sendAsync({type:v,data:m},s.abortController);if(delete s.abortController,s.aborted)return;this._afterTileLoadWorkerResponse(s,w)}catch(w){if(delete s.abortController,s.aborted)return;if(w&&w.status!==404)throw w;this._afterTileLoadWorkerResponse(s,null)}})}_afterTileLoadWorkerResponse(s,u){if(u&&u.resourceTiming&&(s.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&s.setExpiryData(u),s.loadVectorData(u,this.map.painter),s.reloadPromise){const m=s.reloadPromise;s.reloadPromise=null,this.loadTile(s).then(m.resolve).catch(m.reject)}}abortTile(s){return o._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.actor&&(yield s.actor.sendAsync({type:"AT",data:{uid:s.uid,type:this.type,source:this.id}}))})}unloadTile(s){return o._(this,void 0,void 0,function*(){s.unloadVectorData(),s.actor&&(yield s.actor.sendAsync({type:"RMT",data:{uid:s.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ut extends o.E{constructor(s,u,m,v){super(),this.id=s,this.dispatcher=m,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},u),o.e(this,o.Q(u,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,function*(s=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield gn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(o.e(this,u),u.bounds&&(this.tileBounds=new We(u.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:s})))}catch(u){this._tileJSONRequest=null,this.fire(new o.k(u))}})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(s){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),s(),this.load(!0)}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}serialize(){return o.e({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s){return o._(this,void 0,void 0,function*(){const u=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.abortController=new AbortController;try{const m=yield U.getImage(this.map._requestManager.transformRequest(u,"Tile"),s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(m&&m.data){this.map._refreshExpiredTiles&&(m.cacheControl||m.expires)&&s.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const v=this.map.painter.context,w=v.gl,P=m.data;s.texture=this.map.painter.getTileTexture(P.width),s.texture?s.texture.update(P,{useMipmap:!0}):(s.texture=new o.T(v,P,w.RGBA,{useMipmap:!0}),s.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST)),s.state="loaded"}}catch(m){if(delete s.abortController,s.aborted)s.state="unloaded";else if(m)throw s.state="errored",m}})}abortTile(s){return o._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController)})}unloadTile(s){return o._(this,void 0,void 0,function*(){s.texture&&this.map.painter.saveTileTexture(s.texture)})}hasTransition(){return!1}}class tn extends Ut{constructor(s,u,m,v){super(s,u,m,v),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(s){return o._(this,void 0,void 0,function*(){const u=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m=this.map._requestManager.transformRequest(u,"Tile");s.neighboringTiles=this._getNeighboringTiles(s.tileID),s.abortController=new AbortController;try{const v=yield U.getImage(m,s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(v&&v.data){const w=v.data;this.map._refreshExpiredTiles&&(v.cacheControl||v.expires)&&s.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const P=o.b(w)&&o.W()?w:yield this.readImageNow(w),D={type:this.type,uid:s.uid,source:this.id,rawImageData:P,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!s.actor||s.state==="expired"){s.actor=this.dispatcher.getActor();const F=yield s.actor.sendAsync({type:"LDT",data:D});s.dem=F,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded"}}}catch(v){if(delete s.abortController,s.aborted)s.state="unloaded";else if(v)throw s.state="errored",v}})}readImageNow(s){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.X()){const u=s.width+2,m=s.height+2;try{return new o.R({width:u,height:m},yield o.Y(s,-1,-1,u,m))}catch{}}return M.getImageData(s,1)})}_getNeighboringTiles(s){const u=s.canonical,m=Math.pow(2,u.z),v=(u.x-1+m)%m,w=u.x===0?s.wrap-1:s.wrap,P=(u.x+1+m)%m,D=u.x+1===m?s.wrap+1:s.wrap,F={};return F[new o.Z(s.overscaledZ,w,u.z,v,u.y).key]={backfilled:!1},F[new o.Z(s.overscaledZ,D,u.z,P,u.y).key]={backfilled:!1},u.y>0&&(F[new o.Z(s.overscaledZ,w,u.z,v,u.y-1).key]={backfilled:!1},F[new o.Z(s.overscaledZ,s.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},F[new o.Z(s.overscaledZ,D,u.z,P,u.y-1).key]={backfilled:!1}),u.y+1<m&&(F[new o.Z(s.overscaledZ,w,u.z,v,u.y+1).key]={backfilled:!1},F[new o.Z(s.overscaledZ,s.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},F[new o.Z(s.overscaledZ,D,u.z,P,u.y+1).key]={backfilled:!1}),F}unloadTile(s){return o._(this,void 0,void 0,function*(){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&(yield s.actor.sendAsync({type:"RDT",data:{type:this.type,uid:s.uid,source:this.id}}))})}}class Dt extends o.E{constructor(s,u,m,v){super(),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=m.getActor(),this.setEventedParent(v),this._data=u.data,this._options=o.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:o.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:o.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(s){return s*(o.$/this.tileSize)}_getClusterMaxZoom(s){const u=s?Math.round(s):this.maxzoom-1;return Number.isInteger(s)||s===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${s}" rounded to "${u}"`),u}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData(),this}updateData(s){return this._updateWorkerData(s),this}getData(){return o._(this,void 0,void 0,function*(){const s=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:s})})}getCoordinatesFromGeometry(s){return s.type==="GeometryCollection"?s.geometries.map(u=>u.coordinates).flat(1/0):s.coordinates.flat(1/0)}getBounds(){return o._(this,void 0,void 0,function*(){const s=new hn,u=yield this.getData();let m;switch(u.type){case"FeatureCollection":m=u.features.map(v=>this.getCoordinatesFromGeometry(v.geometry)).flat(1/0);break;case"Feature":m=this.getCoordinatesFromGeometry(u.geometry);break;default:m=this.getCoordinatesFromGeometry(u)}if(m.length==0)return s;for(let v=0;v<m.length-1;v+=2)s.extend([m[v],m[v+1]]);return s})}setClusterOptions(s){return this.workerOptions.cluster=s.cluster,s&&(s.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(s.clusterRadius)),s.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(s.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(s){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:s,source:this.id}})}getClusterChildren(s){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:s,source:this.id}})}getClusterLeaves(s,u,m){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:s,limit:u,offset:m}})}_updateWorkerData(s){return o._(this,void 0,void 0,function*(){const u=o.e({type:this.type},this.workerOptions);s?u.dataDiff=s:typeof this._data=="string"?(u.request=this.map._requestManager.transformRequest(M.resolveURL(this._data),"Source"),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.l("dataloading",{dataType:"source"}));try{const m=yield this.actor.sendAsync({type:"LD",data:u});if(this._pendingLoads--,this._removed||m.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));let v=null;m.resourceTiming&&m.resourceTiming[this.id]&&(v=m.resourceTiming[this.id].slice(0));const w={dataType:"source"};this._collectResourceTiming&&v&&v.length>0&&o.e(w,{resourceTiming:v}),this.fire(new o.l("data",Object.assign(Object.assign({},w),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},w),{sourceDataType:"content"})))}catch(m){if(this._pendingLoads--,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(m))}})}loaded(){return this._pendingLoads===0}loadTile(s){return o._(this,void 0,void 0,function*(){const u=s.actor?"RT":"LT";s.actor=this.actor;const m={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};s.abortController=new AbortController;const v=yield this.actor.sendAsync({type:u,data:m},s.abortController);delete s.abortController,s.unloadVectorData(),s.aborted||s.loadVectorData(v,this.map.painter,u==="RT")})}abortTile(s){return o._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.aborted=!0})}unloadTile(s){return o._(this,void 0,void 0,function*(){s.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:s.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class An extends o.E{constructor(s,u,m,v){super(),this.flippedWindingOrder=!1,this.id=s,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=u}load(s){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield U.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,s&&(this.coordinates=s),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new o.k(u))}})}loaded(){return this._loaded}updateImage(s){return s.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=s.url,this.load(s.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(s){this.coordinates=s;const u=s.map(o.a0.fromLngLat);var m;return this.tileID=function(v){const w=o.a1.fromPoints(v),P=w.width(),D=w.height(),F=Math.max(P,D),j=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),W=Math.pow(2,j);return new o.a3(j,Math.floor((w.minX+w.maxX)/2*W),Math.floor((w.minY+w.maxY)/2*W))}(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map(v=>this.tileID.getTilePoint(v)._round()),this.flippedWindingOrder=((m=this.tileCoords)[1].x-m[0].x)*(m[2].y-m[0].y)-(m[1].y-m[0].y)*(m[2].x-m[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const s=this.map.painter.context,u=s.gl;this.texture||(this.texture=new o.T(s,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let m=!1;for(const v in this.tiles){const w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,m=!0)}m&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(s){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={}):s.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(s){const{minX:u,minY:m,maxX:v,maxY:w}=o.a1.fromPoints(s),P={};for(let D=0;D<=o.a2;D++){const F=Math.pow(2,D),j=Math.floor(u*F),W=Math.floor(m*F),Q=Math.floor(v*F),K=Math.floor(w*F);P[D]={minTileX:j,minTileY:W,maxTileX:Q,maxTileY:K}}return P}}class an extends An{constructor(s,u,m,v){super(s,u,m,v),this.roundZoom=!0,this.type="video",this.options=u}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const s=this.options;this.urls=[];for(const u of s.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield o.a4(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new o.k(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){const u=this.video.seekable;s<u.start(0)||s>u.end(0)?this.fire(new o.k(new o.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const s=this.map.painter.context,u=s.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(s,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let m=!1;for(const v in this.tiles){const w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,m=!0)}m&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Le extends An{constructor(s,u,m,v){super(s,u,m,v),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(P=>typeof P!="number"))||this.fire(new o.k(new o.a5(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.a5(`sources.${s}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new o.k(new o.a5(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.a5(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.a5(`sources.${s}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let s=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,s=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,s=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,m=u.gl;this.texture?(s||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(u,this.canvas,m.RGBA,{premultiply:!0});let v=!1;for(const w in this.tiles){const P=this.tiles[w];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,v=!0)}v&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}const me={},it=b=>{switch(b){case"geojson":return Dt;case"image":return An;case"raster":return Ut;case"raster-dem":return tn;case"vector":return vn;case"video":return an;case"canvas":return Le}return me[b]},St="RTLPluginLoaded";class It extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ut()}_syncState(s){return this.status=s,this.dispatcher.broadcast("SRPS",{pluginStatus:s,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(s){return o._(this,arguments,void 0,function*(u,m=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=M.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!m)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(St))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let wt=null;function Zt(){return wt||(wt=new It),wt}class Lt{constructor(s,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=s,this.uid=o.a6(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){const u=s+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(s,u,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(v,w){const P={};if(!w)return P;for(const D of v){const F=D.layerIds.map(j=>w.getLayer(j)).filter(Boolean);if(F.length!==0){D.layers=F,D.stateDependentLayerIds&&(D.stateDependentLayers=D.stateDependentLayerIds.map(j=>F.filter(W=>W.id===j)[0]));for(const j of F)P[j.id]=D}}return P}(s.buckets,u==null?void 0:u.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const w=this.buckets[v];if(w instanceof o.a8){if(this.hasSymbolBuckets=!0,!m)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const w=this.buckets[v];if(w instanceof o.a8&&w.hasRTLText){this.hasRTLText=!0,Zt().lazyLoad();break}}this.queryPadding=0;for(const v in this.buckets){const w=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(v).queryRadius(w))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new o.a7}unloadVectorData(){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(const m in this.buckets){const v=this.buckets[m];v.uploadPending()&&v.upload(s)}const u=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(s,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(s,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,u,m,v,w,P,D,F,j,W,Q){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:w,scale:P,tileSize:this.tileSize,pixelPosMatrix:W,transform:F,params:D,queryPadding:this.queryPadding*j,getElevation:Q},s,u,m):{}}querySourceFeatures(s,u){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const v=m.loadVTLayers(),w=u&&u.sourceLayer?u.sourceLayer:"",P=v._geojsonTileLayer||v[w];if(!P)return;const D=o.a9(u&&u.filter),{z:F,x:j,y:W}=this.tileID.canonical,Q={z:F,x:j,y:W};for(let K=0;K<P.length;K++){const oe=P.feature(K);if(D.needGeometry){const Ee=o.aa(oe,!0);if(!D.filter(new o.F(this.tileID.overscaledZ),Ee,this.tileID.canonical))continue}else if(!D.filter(new o.F(this.tileID.overscaledZ),oe))continue;const he=m.getId(oe,w),Pe=new o.ab(oe,F,j,W,he);Pe.tile=Q,s.push(Pe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const u=this.expirationTime;if(s.cacheControl){const m=o.ac(s.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const m=Date.now();let v=!1;if(this.expirationTime>m)v=!1;else if(u)if(this.expirationTime<u)v=!0;else{const w=this.expirationTime-u;w?this.expirationTime=m+Math.max(w,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0)return;const m=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!u.style.hasLayer(v))continue;const w=this.buckets[v],P=w.layers[0].sourceLayer||"_geojsonTileLayer",D=m[P],F=s[P];if(!D||!F||Object.keys(F).length===0)continue;w.update(F,D,this.imageAtlas&&this.imageAtlas.patternPositions||{});const j=u&&u.style&&u.style.getLayer(v);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<M.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=M.now()+s}setDependencies(s,u){const m={};for(const v of u)m[v]=!0;this.dependencies[s]=m}hasDependency(s,u){for(const m of s){const v=this.dependencies[m];if(v){for(const w of u)if(v[w])return!0}}return!1}}class kt{constructor(s,u){this.max=s,this.onRemove=u,this.reset()}reset(){for(const s in this.data)for(const u of this.data[s])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(s,u,m){const v=s.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const w={value:u,timeout:void 0};if(m!==void 0&&(w.timeout=setTimeout(()=>{this.remove(s,w)},m)),this.data[v].push(w),this.order.push(v),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const u=this.data[s].shift();return u.timeout&&clearTimeout(u.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),u.value}getByKey(s){const u=this.data[s];return u?u[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,u){if(!this.has(s))return this;const m=s.wrapped().key,v=u===void 0?0:this.data[m].indexOf(u),w=this.data[m][v];return this.data[m].splice(v,1),w.timeout&&clearTimeout(w.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(w.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(s){const u=[];for(const m in this.data)for(const v of this.data[m])s(v.value)||u.push(v);for(const m of u)this.remove(m.value.tileID,m)}}class bn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,u,m){const v=String(u);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][v]=this.stateChanges[s][v]||{},o.e(this.stateChanges[s][v],m),this.deletedStates[s]===null){this.deletedStates[s]={};for(const w in this.state[s])w!==v&&(this.deletedStates[s][w]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][v]===null){this.deletedStates[s][v]={};for(const w in this.state[s][v])m[w]||(this.deletedStates[s][v][w]=null)}else for(const w in m)this.deletedStates[s]&&this.deletedStates[s][v]&&this.deletedStates[s][v][w]===null&&delete this.deletedStates[s][v][w]}removeFeatureState(s,u,m){if(this.deletedStates[s]===null)return;const v=String(u);if(this.deletedStates[s]=this.deletedStates[s]||{},m&&u!==void 0)this.deletedStates[s][v]!==null&&(this.deletedStates[s][v]=this.deletedStates[s][v]||{},this.deletedStates[s][v][m]=null);else if(u!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][v])for(m in this.deletedStates[s][v]={},this.stateChanges[s][v])this.deletedStates[s][v][m]=null;else this.deletedStates[s][v]=null;else this.deletedStates[s]=null}getState(s,u){const m=String(u),v=o.e({},(this.state[s]||{})[m],(this.stateChanges[s]||{})[m]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const w=this.deletedStates[s][u];if(w===null)return{};for(const P in w)delete v[P]}return v}initializeTileState(s,u){s.setFeatureState(this.state,u)}coalesceChanges(s,u){const m={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const w={};for(const P in this.stateChanges[v])this.state[v][P]||(this.state[v][P]={}),o.e(this.state[v][P],this.stateChanges[v][P]),w[P]=this.state[v][P];m[v]=w}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const w={};if(this.deletedStates[v]===null)for(const P in this.state[v])w[P]={},this.state[v][P]={};else for(const P in this.deletedStates[v]){if(this.deletedStates[v][P]===null)this.state[v][P]={};else for(const D of Object.keys(this.deletedStates[v][P]))delete this.state[v][P][D];w[P]=this.state[v][P]}m[v]=m[v]||{},o.e(m[v],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const v in s)s[v].setFeatureState(m,u)}}const zt=89.25;function _e(b,s){const u=o.ag(s.lat,-o.ah,o.ah);return new o.P(o.V(s.lng)*b,o.U(u)*b)}function te(b,s){return new o.a0(s.x/b,s.y/b).toLngLat()}function re(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(o.ad(90-b.pitch)),Math.tan(o.ad(zt-b.pitch)))}function Z(b,s){const u=b.canonical,m=s/o.ae(u.z),v=u.x+Math.pow(2,u.z)*b.wrap,w=o.af(new Float64Array(16));return o.M(w,w,[v*m,u.y*m,0]),o.N(w,w,[m/o.$,m/o.$,1]),w}function le(b,s,u,m,v){const w=o.a0.fromLngLat(b,s),P=v*o.ai(1,b.lat),D=P*Math.cos(o.ad(u)),F=Math.sqrt(P*P-D*D),j=F*Math.sin(o.ad(-m)),W=F*Math.cos(o.ad(-m));return new o.a0(w.x+j,w.y+W,w.z+D)}function Te(b,s,u){const m=s.intersectsFrustum(b);if(!u||m===0)return m;const v=s.intersectsPlane(u);return v===0?0:m===2&&v===2?2:1}function Ve(b,s,u){let m=0;const v=(u-s)/10;for(let w=0;w<10;w++)m+=v*Math.pow(Math.cos(s+(w+.5)/10*(u-s)),b);return m}function fe(b,s){return function(u,m,v,w,P){const D=2*((b-1)/o.aj(Math.cos(o.ad(zt-P))/Math.cos(o.ad(zt)))-1),F=Math.acos(v/w),j=2*Ve(D-1,0,o.ad(P/2)),W=Math.min(o.ad(zt),F+o.ad(P/2)),Q=Ve(D-1,Math.min(W,F-o.ad(P/2)),W),K=Math.atan(m/v),oe=Math.hypot(m,v);let he=u;return he+=o.aj(w/oe/Math.max(.5,Math.cos(o.ad(P/2)))),he+=D*o.aj(Math.cos(K))/2,he-=o.aj(Math.max(1,Q/j/s))/2,he}}const xe=fe(9.314,3);function Re(b,s){const u=(s.roundZoom?Math.round:Math.floor)(b.zoom+o.aj(b.tileSize/s.tileSize));return Math.max(0,u)}function De(b,s){const u=b.getCameraFrustum(),m=b.getClippingPlane(),v=b.screenPointToMercatorCoordinate(b.getCameraPoint()),w=o.a0.fromLngLat(b.center,b.elevation);v.z=w.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const P=b.getCoveringTilesDetailsProvider(),D=P.allowVariableZoom(b,s),F=Re(b,s),j=s.minzoom||0,W=s.maxzoom!==void 0?s.maxzoom:b.maxZoom,Q=Math.min(Math.max(0,F),W),K=Math.pow(2,Q),oe=[K*v.x,K*v.y,0],he=[K*w.x,K*w.y,0],Pe=Math.hypot(w.x-v.x,w.y-v.y),Ee=Math.abs(w.z-v.z),Ie=Math.hypot(Pe,Ee),Fe=Ye=>({zoom:0,x:0,y:0,wrap:Ye,fullyVisible:!1}),He=[],Be=[];if(b.renderWorldCopies&&P.allowWorldCopies())for(let Ye=1;Ye<=3;Ye++)He.push(Fe(-Ye)),He.push(Fe(Ye));for(He.push(Fe(0));He.length>0;){const Ye=He.pop(),Ke=Ye.x,$e=Ye.y;let rt=Ye.fullyVisible;const yt={x:Ke,y:$e,z:Ye.zoom},ht=P.getTileBoundingVolume(yt,Ye.wrap,b.elevation,s);if(!rt){const rn=Te(u,ht,m);if(rn===0)continue;rt=rn===2}const pt=P.distanceToTile2d(v.x,v.y,yt,ht);let _t=F;D&&(_t=(s.calculateTileZoom||xe)(b.zoom+o.aj(b.tileSize/s.tileSize),pt,Ee,Ie,b.fov)),_t=(s.roundZoom?Math.round:Math.floor)(_t),_t=Math.max(0,_t);const sn=Math.min(_t,W);if(Ye.wrap=P.getWrap(w,yt,Ye.wrap),Ye.zoom>=sn){if(Ye.zoom<j)continue;const rn=Q-Ye.zoom,Vt=oe[0]-.5-(Ke<<rn),Mn=oe[1]-.5-($e<<rn),Jn=s.reparseOverscaled?Math.max(Ye.zoom,_t):Ye.zoom;Be.push({tileID:new o.Z(Ye.zoom===W?Jn:Ye.zoom,Ye.wrap,Ye.zoom,Ke,$e),distanceSq:o.ak([he[0]-.5-Ke,he[1]-.5-$e]),tileDistanceToCamera:Math.sqrt(Vt*Vt+Mn*Mn)})}else for(let rn=0;rn<4;rn++)He.push({zoom:Ye.zoom+1,x:(Ke<<1)+rn%2,y:($e<<1)+(rn>>1),wrap:Ye.wrap,fullyVisible:rt})}return Be.sort((Ye,Ke)=>Ye.distanceSq-Ke.distanceSq).map(Ye=>Ye.tileID)}const ze=o.a1.fromPoints([new o.P(0,0),new o.P(o.$,o.$)]);class Je extends o.E{constructor(s,u,m){super(),this.id=s,this.dispatcher=m,this.on("data",v=>this._dataHandler(v)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((v,w,P,D)=>{const F=new(it(w.type))(v,w,P,D);if(F.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${F.id}`);return F})(s,u,m,this),this._tiles={},this._cache=new kt(0,v=>this._unloadTile(v)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new bn,this._didEmitContent=!1,this._updated=!1}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._maxTileCacheZoomLevels=s?s._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const s in this._tiles){const u=this._tiles[s];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,u,m){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(s),this._tileLoaded(s,u,m)}catch(v){s.state="errored",v.status!==404?this._source.fire(new o.k(v,{tile:s})):this.update(this.transform,this.terrain)}})}_unloadTile(s){this._source.unloadTile&&this._source.unloadTile(s)}_abortTile(s){this._source.abortTile&&this._source.abortTile(s),this._source.fire(new o.l("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const m=this._tiles[u];m.upload(s),m.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Oe).map(s=>s.key)}getRenderableIds(s){const u=[];for(const m in this._tiles)this._isIdRenderable(m,s)&&u.push(this._tiles[m]);return s?u.sort((m,v)=>{const w=m.tileID,P=v.tileID,D=new o.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians),F=new o.P(P.canonical.x,P.canonical.y)._rotate(-this.transform.bearingInRadians);return w.overscaledZ-P.overscaledZ||F.y-D.y||F.x-D.x}).map(m=>m.tileID.key):u.map(m=>m.tileID).sort(Oe).map(m=>m.key)}hasRenderableParent(s){const u=this.findLoadedParent(s,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(s,u){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(u||!this._tiles[s].holdingForFade())}reload(s){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)s?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(s,u){return o._(this,void 0,void 0,function*(){const m=this._tiles[s];m&&(m.state!=="loading"&&(m.state=u),yield this._loadTile(m,s,u))})}_tileLoaded(s,u,m){s.timeAdded=M.now(),m==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(u,s),this.getSource().type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){const u=this.getRenderableIds();for(let v=0;v<u.length;v++){const w=u[v];if(s.neighboringTiles&&s.neighboringTiles[w]){const P=this.getTileByID(w);m(s,P),m(P,s)}}function m(v,w){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let P=w.tileID.canonical.x-v.tileID.canonical.x;const D=w.tileID.canonical.y-v.tileID.canonical.y,F=Math.pow(2,v.tileID.canonical.z),j=w.tileID.key;P===0&&D===0||Math.abs(D)>1||(Math.abs(P)>1&&(Math.abs(P+F)===1?P+=F:Math.abs(P-F)===1&&(P-=F)),w.dem&&v.dem&&(v.dem.backfillBorder(w.dem,P,D),v.neighboringTiles&&v.neighboringTiles[j]&&(v.neighboringTiles[j].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,u,m,v){for(const w in this._tiles){let P=this._tiles[w];if(v[w]||!P.hasData()||P.tileID.overscaledZ<=u||P.tileID.overscaledZ>m)continue;let D=P.tileID;for(;P&&P.tileID.overscaledZ>u+1;){const j=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[j.key],P&&P.hasData()&&(D=j)}let F=D;for(;F.overscaledZ>u;)if(F=F.scaledTo(F.overscaledZ-1),s[F.key]||s[F.canonical.key]){v[D.key]=D;break}}}findLoadedParent(s,u){if(s.key in this._loadedParentTiles){const m=this._loadedParentTiles[s.key];return m&&m.tileID.overscaledZ>=u?m:null}for(let m=s.overscaledZ-1;m>=u;m--){const v=s.scaledTo(m),w=this._getLoadedTile(v);if(w)return w}}findLoadedSibling(s){return this._getLoadedTile(s)}_getLoadedTile(s){const u=this._tiles[s.key];return u&&u.hasData()?u:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){const u=Math.ceil(s.width/this._source.tileSize)+1,m=Math.ceil(s.height/this._source.tileSize)+1,v=Math.floor(u*m*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(w)}handleWrapJump(s){const u=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,u){const m={};for(const v in this._tiles){const w=this._tiles[v];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+u),m[w.tileID.key]=w}this._tiles=m;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}_updateCoveredAndRetainedTiles(s,u,m,v,w,P){const D={},F={},j=Object.keys(s),W=M.now();for(const Q of j){const K=s[Q],oe=this._tiles[Q];if(!oe||oe.fadeEndTime!==0&&oe.fadeEndTime<=W)continue;const he=this.findLoadedParent(K,u),Pe=this.findLoadedSibling(K),Ee=he||Pe||null;Ee&&(this._addTile(Ee.tileID),D[Ee.tileID.key]=Ee.tileID),F[Q]=K}this._retainLoadedChildren(F,v,m,s);for(const Q in D)s[Q]||(this._coveredTiles[Q]=!0,s[Q]=D[Q]);if(P){const Q={},K={};for(const oe of w)this._tiles[oe.key].hasData()?Q[oe.key]=oe:K[oe.key]=oe;for(const oe in K){const he=K[oe].children(this._source.maxzoom);this._tiles[he[0].key]&&this._tiles[he[1].key]&&this._tiles[he[2].key]&&this._tiles[he[3].key]&&(Q[he[0].key]=s[he[0].key]=he[0],Q[he[1].key]=s[he[1].key]=he[1],Q[he[2].key]=s[he[2].key]=he[2],Q[he[3].key]=s[he[3].key]=he[3],delete K[oe])}for(const oe in K){const he=K[oe],Pe=this.findLoadedParent(he,this._source.minzoom),Ee=this.findLoadedSibling(he),Ie=Pe||Ee||null;if(Ie){Q[Ie.tileID.key]=s[Ie.tileID.key]=Ie.tileID;for(const Fe in Q)Q[Fe].isChildOf(Ie.tileID)&&delete Q[Fe]}}for(const oe in this._tiles)Q[oe]||(this._coveredTiles[oe]=!0)}}update(s,u){if(!this._sourceLoaded||this._paused)return;let m;this.transform=s,this.terrain=u,this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(W=>new o.Z(W.canonical.z,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y)):(m=De(s,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(m=m.filter(W=>this._source.hasTile(W)))):m=[];const v=Re(s,this._source),w=Math.max(v-Je.maxOverzooming,this._source.minzoom),P=Math.max(v+Je.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const W={};for(const Q of m)if(Q.canonical.z>this._source.minzoom){const K=Q.scaledTo(Q.canonical.z-1);W[K.key]=K;const oe=Q.scaledTo(Math.max(this._source.minzoom,Math.min(Q.canonical.z,5)));W[oe.key]=oe}m=m.concat(Object.values(W))}const D=m.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,D&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const F=this._updateRetainedTiles(m,v);Et(this._source.type)&&this._updateCoveredAndRetainedTiles(F,w,P,v,m,u);for(const W in F)this._tiles[W].clearFadeHold();const j=o.al(this._tiles,F);for(const W of j){const Q=this._tiles[W];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(W)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,u){var m;const v={},w={},P=Math.max(u-Je.maxOverzooming,this._source.minzoom),D=Math.max(u+Je.maxUnderzooming,this._source.minzoom),F={};for(const j of s){const W=this._addTile(j);v[j.key]=j,W.hasData()||u<this._source.maxzoom&&(F[j.key]=j)}this._retainLoadedChildren(F,u,D,v);for(const j of s){let W=this._tiles[j.key];if(W.hasData())continue;if(u+1>this._source.maxzoom){const K=j.children(this._source.maxzoom)[0],oe=this.getTile(K);if(oe&&oe.hasData()){v[K.key]=K;continue}}else{const K=j.children(this._source.maxzoom);if(v[K[0].key]&&v[K[1].key]&&v[K[2].key]&&v[K[3].key])continue}let Q=W.wasRequested();for(let K=j.overscaledZ-1;K>=P;--K){const oe=j.scaledTo(K);if(w[oe.key])break;if(w[oe.key]=!0,W=this.getTile(oe),!W&&Q&&(W=this._addTile(oe)),W){const he=W.hasData();if((he||!(!((m=this.map)===null||m===void 0)&&m.cancelPendingTileRequestsWhileZooming)||Q)&&(v[oe.key]=oe),Q=W.wasRequested(),he)break}}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const u=[];let m,v=this._tiles[s].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){m=this._loadedParentTiles[v.key];break}u.push(v.key);const w=v.scaledTo(v.overscaledZ-1);if(m=this._getLoadedTile(w),m)break;v=w}for(const w of u)this._loadedParentTiles[w]=m}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const s in this._tiles){const u=this._tiles[s].tileID,m=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=m}}_addTile(s){let u=this._tiles[s.key];if(u)return u;u=this._cache.getAndRemove(s),u&&(this._setTileReloadTimer(s.key,u),u.tileID=s,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,u)));const m=u;return u||(u=new Lt(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(u,s.key,u.state)),u.uses++,this._tiles[s.key]=u,m||this._source.fire(new o.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(s,u){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const m=u.getExpiryTimeout();m&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},m))}refreshTiles(s){for(const u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&s.some(m=>m.equals(this._tiles[u].tileID.canonical))&&this._reloadTile(u,"expired")}_removeTile(s){const u=this._tiles[s];u&&(u.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(s){const u=s.sourceDataType;s.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&s.dataType==="source"&&u==="content"&&(this.reload(s.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,u,m){const v=[],w=this.transform;if(!w)return v;const P=w.getCoveringTilesDetailsProvider().allowWorldCopies(),D=m?w.getCameraQueryGeometry(s):s,F=oe=>w.screenPointToMercatorCoordinate(oe,this.terrain),j=this.transformBbox(s,F,!P),W=this.transformBbox(D,F,!P),Q=this.getIds(),K=o.a1.fromPoints(W);for(let oe=0;oe<Q.length;oe++){const he=this._tiles[Q[oe]];if(he.holdingForFade())continue;const Pe=P?[he.tileID]:[he.tileID.unwrapTo(-1),he.tileID.unwrapTo(0)],Ee=Math.pow(2,w.zoom-he.tileID.overscaledZ),Ie=u*he.queryPadding*o.$/he.tileSize/Ee;for(const Fe of Pe){const He=K.map(Be=>Fe.getTilePoint(new o.a0(Be.x,Be.y)));if(He.expandBy(Ie),He.intersects(ze)){const Be=j.map(Ke=>Fe.getTilePoint(Ke)),Ye=W.map(Ke=>Fe.getTilePoint(Ke));v.push({tile:he,tileID:P?Fe:Fe.unwrapTo(0),queryGeometry:Be,cameraQueryGeometry:Ye,scale:Ee})}}}return v}transformBbox(s,u,m){let v=s.map(u);if(m){const w=o.a1.fromPoints(s);w.shrinkBy(.001*Math.min(w.width(),w.height()));const P=w.map(u);o.a1.fromPoints(v).covers(P)||(v=v.map(D=>D.x>.5?new o.a0(D.x-1,D.y,D.z):D))}return v}getVisibleCoordinates(s){const u=this.getRenderableIds(s).map(m=>this._tiles[m].tileID);return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(Et(this._source.type)){const s=M.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=s)return!0}return!1}setFeatureState(s,u,m){this._state.updateState(s=s||"_geojsonTileLayer",u,m)}removeFeatureState(s,u,m){this._state.removeFeatureState(s=s||"_geojsonTileLayer",u,m)}getFeatureState(s,u){return this._state.getState(s=s||"_geojsonTileLayer",u)}setDependencies(s,u,m){const v=this._tiles[s];v&&v.setDependencies(u,m)}reloadTilesForDependencies(s,u){for(const m in this._tiles)this._tiles[m].hasDependency(s,u)&&this._reloadTile(m,"reloading");this._cache.filter(m=>!m.hasDependency(s,u))}}function Oe(b,s){const u=Math.abs(2*b.wrap)-+(b.wrap<0),m=Math.abs(2*s.wrap)-+(s.wrap<0);return b.overscaledZ-s.overscaledZ||m-u||s.canonical.y-b.canonical.y||s.canonical.x-b.canonical.x}function Et(b){return b==="raster"||b==="image"||b==="video"}Je.maxOverzooming=10,Je.maxUnderzooming=3;class Ft{constructor(s,u){this.reset(s,u)}reset(s,u){this.points=s||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=o.ag(s,0,1);let u=1,m=this._distances[u];const v=s*this.paddedLength+this.padding;for(;m<v&&u<this._distances.length;)m=this._distances[++u];const w=u-1,P=this._distances[w],D=m-P,F=D>0?(v-P)/D:0;return this.points[w].mult(1-F).add(this.points[u].mult(F))}}function be(b,s){let u=!0;return b==="always"||b!=="never"&&s!=="never"||(u=!1),u}class qe{constructor(s,u,m){const v=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(s/m),this.yCellCount=Math.ceil(u/m);for(let P=0;P<this.xCellCount*this.yCellCount;P++)v.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=u,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,u,m,v,w){this._forEachCell(u,m,v,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(v),this.bboxes.push(w)}insertCircle(s,u,m,v){this._forEachCell(u-v,m-v,u+v,m+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(u),this.circles.push(m),this.circles.push(v)}_insertBoxCell(s,u,m,v,w,P){this.boxCells[w].push(P)}_insertCircleCell(s,u,m,v,w,P){this.circleCells[w].push(P)}_query(s,u,m,v,w,P,D){if(m<0||s>this.width||v<0||u>this.height)return[];const F=[];if(s<=0&&u<=0&&this.width<=m&&this.height<=v){if(w)return[{key:null,x1:s,y1:u,x2:m,y2:v}];for(let j=0;j<this.boxKeys.length;j++)F.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(let j=0;j<this.circleKeys.length;j++){const W=this.circles[3*j],Q=this.circles[3*j+1],K=this.circles[3*j+2];F.push({key:this.circleKeys[j],x1:W-K,y1:Q-K,x2:W+K,y2:Q+K})}}else this._forEachCell(s,u,m,v,this._queryCell,F,{hitTest:w,overlapMode:P,seenUids:{box:{},circle:{}}},D);return F}query(s,u,m,v){return this._query(s,u,m,v,!1,null)}hitTest(s,u,m,v,w,P){return this._query(s,u,m,v,!0,w,P).length>0}hitTestCircle(s,u,m,v,w){const P=s-m,D=s+m,F=u-m,j=u+m;if(D<0||P>this.width||j<0||F>this.height)return!1;const W=[];return this._forEachCell(P,F,D,j,this._queryCellCircle,W,{hitTest:!0,overlapMode:v,circle:{x:s,y:u,radius:m},seenUids:{box:{},circle:{}}},w),W.length>0}_queryCell(s,u,m,v,w,P,D,F){const{seenUids:j,hitTest:W,overlapMode:Q}=D,K=this.boxCells[w];if(K!==null){const he=this.bboxes;for(const Pe of K)if(!j.box[Pe]){j.box[Pe]=!0;const Ee=4*Pe,Ie=this.boxKeys[Pe];if(s<=he[Ee+2]&&u<=he[Ee+3]&&m>=he[Ee+0]&&v>=he[Ee+1]&&(!F||F(Ie))&&(!W||!be(Q,Ie.overlapMode))&&(P.push({key:Ie,x1:he[Ee],y1:he[Ee+1],x2:he[Ee+2],y2:he[Ee+3]}),W))return!0}}const oe=this.circleCells[w];if(oe!==null){const he=this.circles;for(const Pe of oe)if(!j.circle[Pe]){j.circle[Pe]=!0;const Ee=3*Pe,Ie=this.circleKeys[Pe];if(this._circleAndRectCollide(he[Ee],he[Ee+1],he[Ee+2],s,u,m,v)&&(!F||F(Ie))&&(!W||!be(Q,Ie.overlapMode))){const Fe=he[Ee],He=he[Ee+1],Be=he[Ee+2];if(P.push({key:Ie,x1:Fe-Be,y1:He-Be,x2:Fe+Be,y2:He+Be}),W)return!0}}}return!1}_queryCellCircle(s,u,m,v,w,P,D,F){const{circle:j,seenUids:W,overlapMode:Q}=D,K=this.boxCells[w];if(K!==null){const he=this.bboxes;for(const Pe of K)if(!W.box[Pe]){W.box[Pe]=!0;const Ee=4*Pe,Ie=this.boxKeys[Pe];if(this._circleAndRectCollide(j.x,j.y,j.radius,he[Ee+0],he[Ee+1],he[Ee+2],he[Ee+3])&&(!F||F(Ie))&&!be(Q,Ie.overlapMode))return P.push(!0),!0}}const oe=this.circleCells[w];if(oe!==null){const he=this.circles;for(const Pe of oe)if(!W.circle[Pe]){W.circle[Pe]=!0;const Ee=3*Pe,Ie=this.circleKeys[Pe];if(this._circlesCollide(he[Ee],he[Ee+1],he[Ee+2],j.x,j.y,j.radius)&&(!F||F(Ie))&&!be(Q,Ie.overlapMode))return P.push(!0),!0}}}_forEachCell(s,u,m,v,w,P,D,F){const j=this._convertToXCellCoord(s),W=this._convertToYCellCoord(u),Q=this._convertToXCellCoord(m),K=this._convertToYCellCoord(v);for(let oe=j;oe<=Q;oe++)for(let he=W;he<=K;he++)if(w.call(this,s,u,m,v,this.xCellCount*he+oe,P,D,F))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,u,m,v,w,P){const D=v-s,F=w-u,j=m+P;return j*j>D*D+F*F}_circleAndRectCollide(s,u,m,v,w,P,D){const F=(P-v)/2,j=Math.abs(s-(v+F));if(j>F+m)return!1;const W=(D-w)/2,Q=Math.abs(u-(w+W));if(Q>W+m)return!1;if(j<=F||Q<=W)return!0;const K=j-F,oe=Q-W;return K*K+oe*oe<=m*m}}function tt(b,s,u){const m=o.L();if(!b){const{vecSouth:Q,vecEast:K}=Ht(s),oe=g();oe[0]=K[0],oe[1]=K[1],oe[2]=Q[0],oe[3]=Q[1],v=oe,(W=(P=(w=oe)[0])*(j=w[3])-(F=w[2])*(D=w[1]))&&(v[0]=j*(W=1/W),v[1]=-D*W,v[2]=-F*W,v[3]=P*W),m[0]=oe[0],m[1]=oe[1],m[4]=oe[2],m[5]=oe[3]}var v,w,P,D,F,j,W;return o.N(m,m,[1/u,1/u,1]),m}function At(b,s,u,m){if(b){const v=o.L();if(!s){const{vecSouth:w,vecEast:P}=Ht(u);v[0]=P[0],v[1]=P[1],v[4]=w[0],v[5]=w[1]}return o.N(v,v,[m,m,1]),v}return u.pixelsToClipSpaceMatrix}function Ht(b){const s=Math.cos(b.rollInRadians),u=Math.sin(b.rollInRadians),m=Math.cos(b.pitchInRadians),v=Math.cos(b.bearingInRadians),w=Math.sin(b.bearingInRadians),P=o.aq();P[0]=-v*m*u-w*s,P[1]=-w*m*u+v*s;const D=o.ar(P);D<1e-9?o.as(P):o.at(P,P,1/D);const F=o.aq();F[0]=v*m*s-w*u,F[1]=w*m*s+v*u;const j=o.ar(F);return j<1e-9?o.as(F):o.at(F,F,1/j),{vecEast:F,vecSouth:P}}function Yt(b,s,u,m){let v;m?(v=[b,s,m(b,s),1],o.av(v,v,u)):(v=[b,s,0,1],vt(v,v,u));const w=v[3];return{point:new o.P(v[0]/w,v[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}function qt(b,s){return .5+b/s*.5}function Gt(b,s){return b.x>=-s[0]&&b.x<=s[0]&&b.y>=-s[1]&&b.y<=s[1]}function yn(b,s,u,m,v,w,P,D,F,j,W,Q,K){const oe=u?b.textSizeData:b.iconSizeData,he=o.am(oe,s.transform.zoom),Pe=[256/s.width*2+1,256/s.height*2+1],Ee=u?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;Ee.clear();const Ie=b.lineVertexArray,Fe=u?b.text.placedSymbolArray:b.icon.placedSymbolArray,He=s.transform.width/s.transform.height;let Be=!1;for(let Ye=0;Ye<Fe.length;Ye++){const Ke=Fe.get(Ye);if(Ke.hidden||Ke.writingMode===o.an.vertical&&!Be){nt(Ke.numGlyphs,Ee);continue}Be=!1;const $e=new o.P(Ke.anchorX,Ke.anchorY),rt={getElevation:K,pitchedLabelPlaneMatrix:m,lineVertexArray:Ie,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:s.transform,tileAnchorPoint:$e,unwrappedTileID:F,width:j,height:W,translation:Q},yt=Wt(Ke.anchorX,Ke.anchorY,rt);if(!Gt(yt.point,Pe)){nt(Ke.numGlyphs,Ee);continue}const ht=qt(s.transform.cameraToCenterDistance,yt.signedDistanceFromCamera),pt=o.ao(oe,he,Ke),_t=w?pt*s.transform.getPitchedTextCorrection(Ke.anchorX,Ke.anchorY,F)/ht:pt*ht,sn=cn({projectionContext:rt,pitchedLabelPlaneMatrixInverse:v,symbol:Ke,fontSize:_t,flip:!1,keepUpright:P,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:Ee,aspectRatio:He,rotateToLine:D});Be=sn.useVertical,(sn.notEnoughRoom||Be||sn.needsFlipping&&cn({projectionContext:rt,pitchedLabelPlaneMatrixInverse:v,symbol:Ke,fontSize:_t,flip:!0,keepUpright:P,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:Ee,aspectRatio:He,rotateToLine:D}).notEnoughRoom)&&nt(Ke.numGlyphs,Ee)}u?b.text.dynamicLayoutVertexBuffer.updateData(Ee):b.icon.dynamicLayoutVertexBuffer.updateData(Ee)}function gt(b,s,u,m,v,w,P,D){const F=w.glyphStartIndex+w.numGlyphs,j=w.lineStartIndex,W=w.lineStartIndex+w.lineLength,Q=s.getoffsetX(w.glyphStartIndex),K=s.getoffsetX(F-1),oe=Xn(b*Q,u,m,v,w.segment,j,W,D,P);if(!oe)return null;const he=Xn(b*K,u,m,v,w.segment,j,W,D,P);return he?D.projectionCache.anyProjectionOccluded?null:{first:oe,last:he}:null}function In(b,s,u,m){return b===o.an.horizontal&&Math.abs(u.y-s.y)>Math.abs(u.x-s.x)*m?{useVertical:!0}:(b===o.an.vertical?s.y<u.y:s.x>u.x)?{needsFlipping:!0}:null}function cn(b){const{projectionContext:s,pitchedLabelPlaneMatrixInverse:u,symbol:m,fontSize:v,flip:w,keepUpright:P,glyphOffsetArray:D,dynamicLayoutVertexArray:F,aspectRatio:j,rotateToLine:W}=b,Q=v/24,K=m.lineOffsetX*Q,oe=m.lineOffsetY*Q;let he;if(m.numGlyphs>1){const Pe=m.glyphStartIndex+m.numGlyphs,Ee=m.lineStartIndex,Ie=m.lineStartIndex+m.lineLength,Fe=gt(Q,D,K,oe,w,m,W,s);if(!Fe)return{notEnoughRoom:!0};const He=Rt(Fe.first.point.x,Fe.first.point.y,s,u),Be=Rt(Fe.last.point.x,Fe.last.point.y,s,u);if(P&&!w){const Ye=In(m.writingMode,He,Be,j);if(Ye)return Ye}he=[Fe.first];for(let Ye=m.glyphStartIndex+1;Ye<Pe-1;Ye++){const Ke=Xn(Q*D.getoffsetX(Ye),K,oe,w,m.segment,Ee,Ie,s,W);if(!Ke)return{notEnoughRoom:!0};he.push(Ke)}he.push(Fe.last)}else{if(P&&!w){const Ee=Ze(s.tileAnchorPoint.x,s.tileAnchorPoint.y,s).point,Ie=m.lineStartIndex+m.segment+1,Fe=new o.P(s.lineVertexArray.getx(Ie),s.lineVertexArray.gety(Ie)),He=Ze(Fe.x,Fe.y,s),Be=He.signedDistanceFromCamera>0?He.point:Nn(s.tileAnchorPoint,Fe,Ee,1,s),Ye=Rt(Ee.x,Ee.y,s,u),Ke=Rt(Be.x,Be.y,s,u),$e=In(m.writingMode,Ye,Ke,j);if($e)return $e}const Pe=Xn(Q*D.getoffsetX(m.glyphStartIndex),K,oe,w,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,s,W);if(!Pe||s.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};he=[Pe]}for(const Pe of he)o.au(F,Pe.point,Pe.angle);return{}}function Nn(b,s,u,m,v){const w=b.add(b.sub(s)._unit()),P=Ze(w.x,w.y,v).point,D=u.sub(P);return u.add(D._mult(m/D.mag()))}function xt(b,s,u){const m=s.projectionCache;if(m.projections[b])return m.projections[b];const v=new o.P(s.lineVertexArray.getx(b),s.lineVertexArray.gety(b)),w=Ze(v.x,v.y,s);if(w.signedDistanceFromCamera>0)return m.projections[b]=w.point,m.anyProjectionOccluded=m.anyProjectionOccluded||w.isOccluded,w.point;const P=b-u.direction;return Nn(u.distanceFromAnchor===0?s.tileAnchorPoint:new o.P(s.lineVertexArray.getx(P),s.lineVertexArray.gety(P)),v,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,s)}function Ze(b,s,u){const m=b+u.translation[0],v=s+u.translation[1];let w;return u.pitchWithMap?(w=Yt(m,v,u.pitchedLabelPlaneMatrix,u.getElevation),w.isOccluded=!1):(w=u.transform.projectTileCoordinates(m,v,u.unwrappedTileID,u.getElevation),w.point.x=(.5*w.point.x+.5)*u.width,w.point.y=(.5*-w.point.y+.5)*u.height),w}function Rt(b,s,u,m){if(u.pitchWithMap){const v=[b,s,0,1];return o.av(v,v,m),u.transform.projectTileCoordinates(v[0]/v[3],v[1]/v[3],u.unwrappedTileID,u.getElevation).point}return{x:b/u.width*2-1,y:1-s/u.height*2}}function Wt(b,s,u){return u.transform.projectTileCoordinates(b,s,u.unwrappedTileID,u.getElevation)}function pn(b,s,u){return b._unit()._perp()._mult(s*u)}function ur(b,s,u,m,v,w,P,D,F){if(D.projectionCache.offsets[b])return D.projectionCache.offsets[b];const j=u.add(s);if(b+F.direction<m||b+F.direction>=v)return D.projectionCache.offsets[b]=j,j;const W=xt(b+F.direction,D,F),Q=pn(W.sub(u),P,F.direction),K=u.add(Q),oe=W.add(Q);return D.projectionCache.offsets[b]=o.aw(w,j,K,oe)||j,D.projectionCache.offsets[b]}function Xn(b,s,u,m,v,w,P,D,F){const j=m?b-s:b+s;let W=j>0?1:-1,Q=0;m&&(W*=-1,Q=Math.PI),W<0&&(Q+=Math.PI);let K,oe=W>0?w+v:w+v+1;D.projectionCache.cachedAnchorPoint?K=D.projectionCache.cachedAnchorPoint:(K=Ze(D.tileAnchorPoint.x,D.tileAnchorPoint.y,D).point,D.projectionCache.cachedAnchorPoint=K);let he,Pe,Ee=K,Ie=K,Fe=0,He=0;const Be=Math.abs(j),Ye=[];let Ke;for(;Fe+He<=Be;){if(oe+=W,oe<w||oe>=P)return null;Fe+=He,Ie=Ee,Pe=he;const yt={absOffsetX:Be,direction:W,distanceFromAnchor:Fe,previousVertex:Ie};if(Ee=xt(oe,D,yt),u===0)Ye.push(Ie),Ke=Ee.sub(Ie);else{let ht;const pt=Ee.sub(Ie);ht=pt.mag()===0?pn(xt(oe+W,D,yt).sub(Ee),u,W):pn(pt,u,W),Pe||(Pe=Ie.add(ht)),he=ur(oe,ht,Ee,w,P,Pe,u,D,yt),Ye.push(Pe),Ke=he.sub(Pe)}He=Ke.mag()}const $e=Ke._mult((Be-Fe)/He)._add(Pe||Ie),rt=Q+Math.atan2(Ee.y-Ie.y,Ee.x-Ie.x);return Ye.push($e),{point:$e,angle:F?rt:0,path:Ye}}const pe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function nt(b,s){for(let u=0;u<b;u++){const m=s.length;s.resize(m+4),s.float32.set(pe,3*m)}}function vt(b,s,u){const m=s[0],v=s[1];return b[0]=u[0]*m+u[4]*v+u[12],b[1]=u[1]*m+u[5]*v+u[13],b[3]=u[3]*m+u[7]*v+u[15],b}const ft=100;class at{constructor(s,u=new qe(s.width+200,s.height+200,25),m=new qe(s.width+200,s.height+200,25)){this.transform=s,this.grid=u,this.ignoredGrid=m,this.pitchFactor=Math.cos(s.pitch*Math.PI/180)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+ft,this.screenBottomBoundary=s.height+ft,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,u,m,v,w,P,D,F,j,W,Q,K){const oe=this.projectAndGetPerspectiveRatio(s.anchorPointX+F[0],s.anchorPointY+F[1],w,W,K),he=m*oe.perspectiveRatio;let Pe;if(P||D)Pe=this._projectCollisionBox(s,he,v,w,P,D,F,oe,W,Q,K);else{const Ke=oe.x+(Q?Q.x*he:0),$e=oe.y+(Q?Q.y*he:0);Pe={allPointsOccluded:!1,box:[Ke+s.x1*he,$e+s.y1*he,Ke+s.x2*he,$e+s.y2*he]}}const[Ee,Ie,Fe,He]=Pe.box,Be=P?Pe.allPointsOccluded:oe.isOccluded;let Ye=Be;return Ye||(Ye=oe.perspectiveRatio<this.perspectiveRatioCutoff),Ye||(Ye=!this.isInsideGrid(Ee,Ie,Fe,He)),Ye||u!=="always"&&this.grid.hitTest(Ee,Ie,Fe,He,u,j)?{box:[Ee,Ie,Fe,He],placeable:!1,offscreen:!1,occluded:Be}:{box:[Ee,Ie,Fe,He],placeable:!0,offscreen:this.isOffscreen(Ee,Ie,Fe,He),occluded:Be}}placeCollisionCircles(s,u,m,v,w,P,D,F,j,W,Q,K,oe,he){const Pe=[],Ee=new o.P(u.anchorX,u.anchorY),Ie=this.getPerspectiveRatio(Ee.x,Ee.y,P,he),Fe=(j?w*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,P)/Ie:w*Ie)/o.aA,He={getElevation:he,pitchedLabelPlaneMatrix:D,lineVertexArray:m,pitchWithMap:j,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Ee,unwrappedTileID:P,width:this.transform.width,height:this.transform.height,translation:oe},Be=gt(Fe,v,u.lineOffsetX*Fe,u.lineOffsetY*Fe,!1,u,!1,He);let Ye=!1,Ke=!1,$e=!0;if(Be){const rt=.5*Q*Ie+K,yt=new o.P(-100,-100),ht=new o.P(this.screenRightBoundary,this.screenBottomBoundary),pt=new Ft,_t=Be.first,sn=Be.last;let rn=[];for(let Jn=_t.path.length-1;Jn>=1;Jn--)rn.push(_t.path[Jn]);for(let Jn=1;Jn<sn.path.length;Jn++)rn.push(sn.path[Jn]);const Vt=2.5*rt;if(j){const Jn=this.projectPathToScreenSpace(rn,He);rn=Jn.some(Cr=>Cr.signedDistanceFromCamera<=0)?[]:Jn.map(Cr=>Cr.point)}let Mn=[];if(rn.length>0){const Jn=rn[0].clone(),Cr=rn[0].clone();for(let ni=1;ni<rn.length;ni++)Jn.x=Math.min(Jn.x,rn[ni].x),Jn.y=Math.min(Jn.y,rn[ni].y),Cr.x=Math.max(Cr.x,rn[ni].x),Cr.y=Math.max(Cr.y,rn[ni].y);Mn=Jn.x>=yt.x&&Cr.x<=ht.x&&Jn.y>=yt.y&&Cr.y<=ht.y?[rn]:Cr.x<yt.x||Jn.x>ht.x||Cr.y<yt.y||Jn.y>ht.y?[]:o.ax([rn],yt.x,yt.y,ht.x,ht.y)}for(const Jn of Mn){pt.reset(Jn,.25*rt);let Cr=0;Cr=pt.length<=.5*rt?1:Math.ceil(pt.paddedLength/Vt)+1;for(let ni=0;ni<Cr;ni++){const Ar=ni/Math.max(Cr-1,1),ri=pt.lerp(Ar),zr=ri.x+ft,Ir=ri.y+ft;Pe.push(zr,Ir,rt,0);const Or=zr-rt,no=Ir-rt,hr=zr+rt,Gi=Ir+rt;if($e=$e&&this.isOffscreen(Or,no,hr,Gi),Ke=Ke||this.isInsideGrid(Or,no,hr,Gi),s!=="always"&&this.grid.hitTestCircle(zr,Ir,rt,s,W)&&(Ye=!0,!F))return{circles:[],offscreen:!1,collisionDetected:Ye}}}}return{circles:!F&&Ye||!Ke||Ie<this.perspectiveRatioCutoff?[]:Pe,offscreen:$e,collisionDetected:Ye}}projectPathToScreenSpace(s,u){const m=function(v,w){const P=o.L();return o.ap(P,w.pitchedLabelPlaneMatrix),v.map(D=>{const F=Yt(D.x,D.y,P,w.getElevation),j=w.transform.projectTileCoordinates(F.point.x,F.point.y,w.unwrappedTileID,w.getElevation);return j.point.x=(.5*j.point.x+.5)*w.width,j.point.y=(.5*-j.point.y+.5)*w.height,j})}(s,u);return function(v){let w=0,P=0,D=0,F=0;for(let j=0;j<v.length;j++)v[j].isOccluded?(D=j+1,F=0):(F++,F>P&&(P=F,w=D));return v.slice(w,w+P)}(m)}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],m=new o.a1;for(const Q of s){const K=new o.P(Q.x+ft,Q.y+ft);m.extend(K),u.push(K)}const{minX:v,minY:w,maxX:P,maxY:D}=m,F=this.grid.query(v,w,P,D).concat(this.ignoredGrid.query(v,w,P,D)),j={},W={};for(const Q of F){const K=Q.key;if(j[K.bucketInstanceId]===void 0&&(j[K.bucketInstanceId]={}),j[K.bucketInstanceId][K.featureIndex])continue;const oe=[new o.P(Q.x1,Q.y1),new o.P(Q.x2,Q.y1),new o.P(Q.x2,Q.y2),new o.P(Q.x1,Q.y2)];o.ay(u,oe)&&(j[K.bucketInstanceId][K.featureIndex]=!0,W[K.bucketInstanceId]===void 0&&(W[K.bucketInstanceId]=[]),W[K.bucketInstanceId].push(K.featureIndex))}return W}insertCollisionBox(s,u,m,v,w,P){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:w,collisionGroupID:P,overlapMode:u},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,u,m,v,w,P){const D=m?this.ignoredGrid:this.grid,F={bucketInstanceId:v,featureIndex:w,collisionGroupID:P,overlapMode:u};for(let j=0;j<s.length;j+=4)D.insertCircle(F,s[j],s[j+1],s[j+2])}projectAndGetPerspectiveRatio(s,u,m,v,w){if(w){let P;v?(P=[s,u,v(s,u),1],o.av(P,P,w)):(P=[s,u,0,1],vt(P,P,w));const D=P[3];return{x:(P[0]/D+1)/2*this.transform.width+ft,y:(-P[1]/D+1)/2*this.transform.height+ft,perspectiveRatio:.5+this.transform.cameraToCenterDistance/D*.5,isOccluded:!1,signedDistanceFromCamera:D}}{const P=this.transform.projectTileCoordinates(s,u,m,v);return{x:(P.point.x+1)/2*this.transform.width+ft,y:(1-P.point.y)/2*this.transform.height+ft,perspectiveRatio:.5+this.transform.cameraToCenterDistance/P.signedDistanceFromCamera*.5,isOccluded:P.isOccluded,signedDistanceFromCamera:P.signedDistanceFromCamera}}}getPerspectiveRatio(s,u,m,v){const w=this.transform.projectTileCoordinates(s,u,m,v);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(s,u,m,v){return m<ft||s>=this.screenRightBoundary||v<ft||u>this.screenBottomBoundary}isInsideGrid(s,u,m,v){return m>=0&&s<this.gridRightBoundary&&v>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const s=o.af([]);return o.M(s,s,[-100,-100,0]),s}_projectCollisionBox(s,u,m,v,w,P,D,F,j,W,Q){let K=1,oe=0,he=0,Pe=1;const Ee=s.anchorPointX+D[0],Ie=s.anchorPointY+D[1];if(P&&!w){const rn=this.projectAndGetPerspectiveRatio(Ee+1,Ie,v,j,Q),Vt=rn.x-F.x,Mn=Math.atan((rn.y-F.y)/Vt)+(Vt<0?Math.PI:0),Jn=Math.sin(Mn),Cr=Math.cos(Mn);K=Cr,oe=Jn,he=-Jn,Pe=Cr}else if(!P&&w){const rn=Ht(this.transform);K=rn.vecEast[0],oe=rn.vecEast[1],he=rn.vecSouth[0],Pe=rn.vecSouth[1]}let Fe=F.x,He=F.y,Be=u;w&&(Fe=Ee,He=Ie,Be=Math.pow(2,-(this.transform.zoom-m.overscaledZ)),Be*=this.transform.getPitchedTextCorrection(Ee,Ie,v),W||(Be*=o.ag(.5+F.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),W&&(Fe+=K*W.x*Be+he*W.y*Be,He+=oe*W.x*Be+Pe*W.y*Be);const Ye=s.x1*Be,Ke=s.x2*Be,$e=(Ye+Ke)/2,rt=s.y1*Be,yt=s.y2*Be,ht=(rt+yt)/2,pt=[{offsetX:Ye,offsetY:rt},{offsetX:$e,offsetY:rt},{offsetX:Ke,offsetY:rt},{offsetX:Ke,offsetY:ht},{offsetX:Ke,offsetY:yt},{offsetX:$e,offsetY:yt},{offsetX:Ye,offsetY:yt},{offsetX:Ye,offsetY:ht}];let _t=[];for(const{offsetX:rn,offsetY:Vt}of pt)_t.push(new o.P(Fe+K*rn+he*Vt,He+oe*rn+Pe*Vt));let sn=!1;if(w){const rn=_t.map(Vt=>this.projectAndGetPerspectiveRatio(Vt.x,Vt.y,v,j,Q));sn=rn.some(Vt=>!Vt.isOccluded),_t=rn.map(Vt=>new o.P(Vt.x,Vt.y))}else sn=!0;return{box:o.az(_t),allPointsOccluded:!sn}}}class Kt{constructor(s,u,m,v){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?u:-u))):v&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class fn{constructor(s,u,m,v,w){this.text=new Kt(s?s.text:null,u,m,w),this.icon=new Kt(s?s.icon:null,u,v,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Qt{constructor(s,u,m){this.text=s,this.icon=u,this.skipFade=m}}class ln{constructor(s,u,m,v,w){this.bucketInstanceId=s,this.featureIndex=u,this.sourceLayerIndex=m,this.bucketIndex=v,this.tileID=w}}class Nt{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const u=++this.maxGroupID;this.collisionGroups[s]={ID:u,predicate:m=>m.collisionGroupID===u}}return this.collisionGroups[s]}}function zn(b,s,u,m,v){const{horizontalAlign:w,verticalAlign:P}=o.aG(b);return new o.P(-(w-.5)*s+m[0]*v,-(P-.5)*u+m[1]*v)}class _n{constructor(s,u,m,v,w){this.transform=s.clone(),this.terrain=u,this.collisionIndex=new at(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new Nt(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(s){const u=this.terrain;return u?(m,v)=>u.getElevation(s,m,v):null}getBucketParts(s,u,m,v){const w=m.getBucket(u),P=m.latestFeatureIndex;if(!w||!P||u.id!==w.layerIds[0])return;const D=m.collisionBoxArray,F=w.layers[0].layout,j=w.layers[0].paint,W=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),Q=m.tileSize/o.$,K=m.tileID.toUnwrapped(),oe=F.get("text-rotation-alignment")==="map",he=o.aB(m,1,this.transform.zoom),Pe=o.aC(this.collisionIndex.transform,m,j.get("text-translate"),j.get("text-translate-anchor")),Ee=o.aC(this.collisionIndex.transform,m,j.get("icon-translate"),j.get("icon-translate-anchor")),Ie=tt(oe,this.transform,he);this.retainedQueryData[w.bucketInstanceId]=new ln(w.bucketInstanceId,P,w.sourceLayerIndex,w.index,m.tileID);const Fe={bucket:w,layout:F,translationText:Pe,translationIcon:Ee,unwrappedTileID:K,pitchedLabelPlaneMatrix:Ie,scale:W,textPixelRatio:Q,holdingForFade:m.holdingForFade(),collisionBoxArray:D,partiallyEvaluatedTextSize:o.am(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(v)for(const He of w.sortKeyRanges){const{sortKey:Be,symbolInstanceStart:Ye,symbolInstanceEnd:Ke}=He;s.push({sortKey:Be,symbolInstanceStart:Ye,symbolInstanceEnd:Ke,parameters:Fe})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Fe})}attemptAnchorPlacement(s,u,m,v,w,P,D,F,j,W,Q,K,oe,he,Pe,Ee,Ie,Fe,He,Be){const Ye=o.aD[s.textAnchor],Ke=[s.textOffset0,s.textOffset1],$e=zn(Ye,m,v,Ke,w),rt=this.collisionIndex.placeCollisionBox(u,K,F,j,W,D,P,Ee,Q.predicate,He,$e,Be);if((!Fe||this.collisionIndex.placeCollisionBox(Fe,K,F,j,W,D,P,Ie,Q.predicate,He,$e,Be).placeable)&&rt.placeable){let yt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[oe.crossTileID]&&this.prevPlacement.placements[oe.crossTileID]&&this.prevPlacement.placements[oe.crossTileID].text&&(yt=this.prevPlacement.variableOffsets[oe.crossTileID].anchor),oe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[oe.crossTileID]={textOffset:Ke,width:m,height:v,anchor:Ye,textBoxScale:w,prevAnchor:yt},this.markUsedJustification(he,Ye,oe,Pe),he.allowVerticalPlacement&&(this.markUsedOrientation(he,Pe,oe),this.placedOrientations[oe.crossTileID]=Pe),{shift:$e,placedGlyphBoxes:rt}}}placeLayerBucketPart(s,u,m){const{bucket:v,layout:w,translationText:P,translationIcon:D,unwrappedTileID:F,pitchedLabelPlaneMatrix:j,textPixelRatio:W,holdingForFade:Q,collisionBoxArray:K,partiallyEvaluatedTextSize:oe,collisionGroup:he}=s.parameters,Pe=w.get("text-optional"),Ee=w.get("icon-optional"),Ie=o.aE(w,"text-overlap","text-allow-overlap"),Fe=Ie==="always",He=o.aE(w,"icon-overlap","icon-allow-overlap"),Be=He==="always",Ye=w.get("text-rotation-alignment")==="map",Ke=w.get("text-pitch-alignment")==="map",$e=w.get("icon-text-fit")!=="none",rt=w.get("symbol-z-order")==="viewport-y",yt=Fe&&(Be||!v.hasIconData()||Ee),ht=Be&&(Fe||!v.hasTextData()||Pe);!v.collisionArrays&&K&&v.deserializeCollisionBoxes(K);const pt=this.retainedQueryData[v.bucketInstanceId].tileID,_t=this._getTerrainElevationFunc(pt),sn=this.transform.getFastPathSimpleProjectionMatrix(pt),rn=(Vt,Mn,Jn)=>{var Cr,ni;if(u[Vt.crossTileID])return;if(Q)return void(this.placements[Vt.crossTileID]=new Qt(!1,!1,!1));let Ar=!1,ri=!1,zr=!0,Ir=null,Or={box:null,placeable:!1,offscreen:null,occluded:!1},no={placeable:!1},hr=null,Gi=null,ro=null,Gl=0,Wl=0,ql=0;Mn.textFeatureIndex?Gl=Mn.textFeatureIndex:Vt.useRuntimeCollisionCircles&&(Gl=Vt.featureIndex),Mn.verticalTextFeatureIndex&&(Wl=Mn.verticalTextFeatureIndex);const za=Mn.textBox;if(za){const Qo=di=>{let Gr=o.an.horizontal;if(v.allowVerticalPlacement&&!di&&this.prevPlacement){const zo=this.prevPlacement.placedOrientations[Vt.crossTileID];zo&&(this.placedOrientations[Vt.crossTileID]=zo,Gr=zo,this.markUsedOrientation(v,Gr,Vt))}return Gr},ea=(di,Gr)=>{if(v.allowVerticalPlacement&&Vt.numVerticalGlyphVertices>0&&Mn.verticalTextBox){for(const zo of v.writingModes)if(zo===o.an.vertical?(Or=Gr(),no=Or):Or=di(),Or&&Or.placeable)break}else Or=di()},Xl=Vt.textAnchorOffsetStartIndex,Fc=Vt.textAnchorOffsetEndIndex;if(Fc===Xl){const di=(Gr,zo)=>{const Li=this.collisionIndex.placeCollisionBox(Gr,Ie,W,pt,F,Ke,Ye,P,he.predicate,_t,void 0,sn);return Li&&Li.placeable&&(this.markUsedOrientation(v,zo,Vt),this.placedOrientations[Vt.crossTileID]=zo),Li};ea(()=>di(za,o.an.horizontal),()=>{const Gr=Mn.verticalTextBox;return v.allowVerticalPlacement&&Vt.numVerticalGlyphVertices>0&&Gr?di(Gr,o.an.vertical):{box:null,offscreen:null}}),Qo(Or&&Or.placeable)}else{let di=o.aD[(ni=(Cr=this.prevPlacement)===null||Cr===void 0?void 0:Cr.variableOffsets[Vt.crossTileID])===null||ni===void 0?void 0:ni.anchor];const Gr=(Li,a1,Q2)=>{const Vv=Li.x2-Li.x1,$d=Li.y2-Li.y1,Zu=Vt.textBoxScale,cl=$e&&He==="never"?a1:null;let io=null,ul=Ie==="never"?1:2,jv="never";di&&ul++;for(let Zl=0;Zl<ul;Zl++){for(let Hv=Xl;Hv<Fc;Hv++){const Gv=v.textAnchorOffsets.get(Hv);if(di&&Gv.textAnchor!==di)continue;const Vd=this.attemptAnchorPlacement(Gv,Li,Vv,$d,Zu,Ye,Ke,W,pt,F,he,jv,Vt,v,Q2,P,D,cl,_t);if(Vd&&(io=Vd.placedGlyphBoxes,io&&io.placeable))return Ar=!0,Ir=Vd.shift,io}di?di=null:jv=Ie}return m&&!io&&(io={box:this.collisionIndex.placeCollisionBox(za,"always",W,pt,F,Ke,Ye,P,he.predicate,_t,void 0,sn).box,offscreen:!1,placeable:!1,occluded:!1}),io};ea(()=>Gr(za,Mn.iconBox,o.an.horizontal),()=>{const Li=Mn.verticalTextBox;return v.allowVerticalPlacement&&(!Or||!Or.placeable)&&Vt.numVerticalGlyphVertices>0&&Li?Gr(Li,Mn.verticalIconBox,o.an.vertical):{box:null,occluded:!0,offscreen:null}}),Or&&(Ar=Or.placeable,zr=Or.offscreen);const zo=Qo(Or&&Or.placeable);if(!Ar&&this.prevPlacement){const Li=this.prevPlacement.variableOffsets[Vt.crossTileID];Li&&(this.variableOffsets[Vt.crossTileID]=Li,this.markUsedJustification(v,Li.anchor,Vt,zo))}}}if(hr=Or,Ar=hr&&hr.placeable,zr=hr&&hr.offscreen,Vt.useRuntimeCollisionCircles){const Qo=v.text.placedSymbolArray.get(Vt.centerJustifiedTextSymbolIndex),ea=o.ao(v.textSizeData,oe,Qo),Xl=w.get("text-padding");Gi=this.collisionIndex.placeCollisionCircles(Ie,Qo,v.lineVertexArray,v.glyphOffsetArray,ea,F,j,m,Ke,he.predicate,Vt.collisionCircleDiameter,Xl,P,_t),Gi.circles.length&&Gi.collisionDetected&&!m&&o.w("Collisions detected, but collision boxes are not shown"),Ar=Fe||Gi.circles.length>0&&!Gi.collisionDetected,zr=zr&&Gi.offscreen}if(Mn.iconFeatureIndex&&(ql=Mn.iconFeatureIndex),Mn.iconBox){const Qo=ea=>this.collisionIndex.placeCollisionBox(ea,He,W,pt,F,Ke,Ye,D,he.predicate,_t,$e&&Ir?Ir:void 0,sn);no&&no.placeable&&Mn.verticalIconBox?(ro=Qo(Mn.verticalIconBox),ri=ro.placeable):(ro=Qo(Mn.iconBox),ri=ro.placeable),zr=zr&&ro.offscreen}const Bd=Pe||Vt.numHorizontalGlyphVertices===0&&Vt.numVerticalGlyphVertices===0,Ud=Ee||Vt.numIconVertices===0;Bd||Ud?Ud?Bd||(ri=ri&&Ar):Ar=ri&&Ar:ri=Ar=ri&&Ar;const Xu=ri&&ro.placeable;if(Ar&&hr.placeable&&this.collisionIndex.insertCollisionBox(hr.box,Ie,w.get("text-ignore-placement"),v.bucketInstanceId,no&&no.placeable&&Wl?Wl:Gl,he.ID),Xu&&this.collisionIndex.insertCollisionBox(ro.box,He,w.get("icon-ignore-placement"),v.bucketInstanceId,ql,he.ID),Gi&&Ar&&this.collisionIndex.insertCollisionCircles(Gi.circles,Ie,w.get("text-ignore-placement"),v.bucketInstanceId,Gl,he.ID),m&&this.storeCollisionData(v.bucketInstanceId,Jn,Mn,hr,ro,Gi),Vt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Vt.crossTileID]=new Qt((Ar||yt)&&!(hr!=null&&hr.occluded),(ri||ht)&&!(ro!=null&&ro.occluded),zr||v.justReloaded),u[Vt.crossTileID]=!0};if(rt){if(s.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Vt=v.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Mn=Vt.length-1;Mn>=0;--Mn){const Jn=Vt[Mn];rn(v.symbolInstances.get(Jn),v.collisionArrays[Jn],Jn)}}else for(let Vt=s.symbolInstanceStart;Vt<s.symbolInstanceEnd;Vt++)rn(v.symbolInstances.get(Vt),v.collisionArrays[Vt],Vt);v.justReloaded=!1}storeCollisionData(s,u,m,v,w,P){if(m.textBox||m.iconBox){let D,F;this.collisionBoxArrays.has(s)?D=this.collisionBoxArrays.get(s):(D=new Map,this.collisionBoxArrays.set(s,D)),D.has(u)?F=D.get(u):(F={text:null,icon:null},D.set(u,F)),m.textBox&&(F.text=v.box),m.iconBox&&(F.icon=w.box)}if(P){let D=this.collisionCircleArrays[s];D===void 0&&(D=this.collisionCircleArrays[s]=[]);for(let F=0;F<P.circles.length;F+=4)D.push(P.circles[F+0]-ft),D.push(P.circles[F+1]-ft),D.push(P.circles[F+2]),D.push(P.collisionDetected?1:0)}}markUsedJustification(s,u,m,v){let w;w=v===o.an.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[o.aF(u)];const P=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const D of P)D>=0&&(s.text.placedSymbolArray.get(D).crossTileID=w>=0&&D!==w?0:m.crossTileID)}markUsedOrientation(s,u,m){const v=u===o.an.horizontal||u===o.an.horizontalOnly?u:0,w=u===o.an.vertical?u:0,P=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const D of P)s.text.placedSymbolArray.get(D).placedOrientation=v;m.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let m=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const v=u?u.symbolFadeChange(s):1,w=u?u.opacities:{},P=u?u.variableOffsets:{},D=u?u.placedOrientations:{};for(const F in this.placements){const j=this.placements[F],W=w[F];W?(this.opacities[F]=new fn(W,v,j.text,j.icon),m=m||j.text!==W.text.placed||j.icon!==W.icon.placed):(this.opacities[F]=new fn(null,v,j.text,j.icon,j.skipFade),m=m||j.text||j.icon)}for(const F in w){const j=w[F];if(!this.opacities[F]){const W=new fn(j,v,!1,!1);W.isHidden()||(this.opacities[F]=W,m=m||j.text.placed||j.icon.placed)}}for(const F in P)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=P[F]);for(const F in D)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=D[F]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");m?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:s)}updateLayerOpacities(s,u){const m={};for(const v of u){const w=v.getBucket(s);w&&v.latestFeatureIndex&&s.id===w.layerIds[0]&&this.updateBucketOpacities(w,v.tileID,m,v.collisionBoxArray)}}updateBucketOpacities(s,u,m,v){s.hasTextData()&&(s.text.opacityVertexArray.clear(),s.text.hasVisibleVertices=!1),s.hasIconData()&&(s.icon.opacityVertexArray.clear(),s.icon.hasVisibleVertices=!1),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const w=s.layers[0],P=w.layout,D=new fn(null,0,!1,!1,!0),F=P.get("text-allow-overlap"),j=P.get("icon-allow-overlap"),W=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Q=P.get("text-rotation-alignment")==="map",K=P.get("text-pitch-alignment")==="map",oe=P.get("icon-text-fit")!=="none",he=new fn(null,0,F&&(j||!s.hasIconData()||P.get("icon-optional")),j&&(F||!s.hasTextData()||P.get("text-optional")),!0);!s.collisionArrays&&v&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(v);const Pe=(Ie,Fe,He)=>{for(let Be=0;Be<Fe/4;Be++)Ie.opacityVertexArray.emplaceBack(He);Ie.hasVisibleVertices=Ie.hasVisibleVertices||He!==Es},Ee=this.collisionBoxArrays.get(s.bucketInstanceId);for(let Ie=0;Ie<s.symbolInstances.length;Ie++){const Fe=s.symbolInstances.get(Ie),{numHorizontalGlyphVertices:He,numVerticalGlyphVertices:Be,crossTileID:Ye}=Fe;let Ke=this.opacities[Ye];m[Ye]?Ke=D:Ke||(Ke=he,this.opacities[Ye]=Ke),m[Ye]=!0;const $e=Fe.numIconVertices>0,rt=this.placedOrientations[Fe.crossTileID],yt=rt===o.an.vertical,ht=rt===o.an.horizontal||rt===o.an.horizontalOnly;if(He>0||Be>0){const _t=Xo(Ke.text);Pe(s.text,He,yt?Es:_t),Pe(s.text,Be,ht?Es:_t);const sn=Ke.text.isHidden();[Fe.rightJustifiedTextSymbolIndex,Fe.centerJustifiedTextSymbolIndex,Fe.leftJustifiedTextSymbolIndex].forEach(Mn=>{Mn>=0&&(s.text.placedSymbolArray.get(Mn).hidden=sn||yt?1:0)}),Fe.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Fe.verticalPlacedTextSymbolIndex).hidden=sn||ht?1:0);const rn=this.variableOffsets[Fe.crossTileID];rn&&this.markUsedJustification(s,rn.anchor,Fe,rt);const Vt=this.placedOrientations[Fe.crossTileID];Vt&&(this.markUsedJustification(s,"left",Fe,Vt),this.markUsedOrientation(s,Vt,Fe))}if($e){const _t=Xo(Ke.icon),sn=!(oe&&Fe.verticalPlacedIconSymbolIndex&&yt);Fe.placedIconSymbolIndex>=0&&(Pe(s.icon,Fe.numIconVertices,sn?_t:Es),s.icon.placedSymbolArray.get(Fe.placedIconSymbolIndex).hidden=Ke.icon.isHidden()),Fe.verticalPlacedIconSymbolIndex>=0&&(Pe(s.icon,Fe.numVerticalIconVertices,sn?Es:_t),s.icon.placedSymbolArray.get(Fe.verticalPlacedIconSymbolIndex).hidden=Ke.icon.isHidden())}const pt=Ee&&Ee.has(Ie)?Ee.get(Ie):{text:null,icon:null};if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const _t=s.collisionArrays[Ie];if(_t){let sn=new o.P(0,0);if(_t.textBox||_t.verticalTextBox){let rn=!0;if(W){const Vt=this.variableOffsets[Ye];Vt?(sn=zn(Vt.anchor,Vt.width,Vt.height,Vt.textOffset,Vt.textBoxScale),Q&&sn._rotate(K?-this.transform.bearingInRadians:this.transform.bearingInRadians)):rn=!1}if(_t.textBox||_t.verticalTextBox){let Vt;_t.textBox&&(Vt=yt),_t.verticalTextBox&&(Vt=ht),Rn(s.textCollisionBox.collisionVertexArray,Ke.text.placed,!rn||Vt,pt.text,sn.x,sn.y)}}if(_t.iconBox||_t.verticalIconBox){const rn=!!(!ht&&_t.verticalIconBox);let Vt;_t.iconBox&&(Vt=rn),_t.verticalIconBox&&(Vt=!rn),Rn(s.iconCollisionBox.collisionVertexArray,Ke.icon.placed,Vt,pt.icon,oe?sn.x:0,oe?sn.y:0)}}}}if(s.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);s.bucketInstanceId in this.collisionCircleArrays&&(s.collisionCircleArray=this.collisionCircleArrays[s.bucketInstanceId],delete this.collisionCircleArrays[s.bucketInstanceId])}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,u){const m=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*m>s}setStale(){this.stale=!0}}function Rn(b,s,u,m,v,w){m&&m.length!==0||(m=[0,0,0,0]);const P=m[0]-ft,D=m[1]-ft,F=m[2]-ft,j=m[3]-ft;b.emplaceBack(s?1:0,u?1:0,v||0,w||0,P,D),b.emplaceBack(s?1:0,u?1:0,v||0,w||0,F,D),b.emplaceBack(s?1:0,u?1:0,v||0,w||0,F,j),b.emplaceBack(s?1:0,u?1:0,v||0,w||0,P,j)}const jn=Math.pow(2,25),fr=Math.pow(2,24),pr=Math.pow(2,17),Yn=Math.pow(2,16),Hn=Math.pow(2,9),Qr=Math.pow(2,8),Sr=Math.pow(2,1);function Xo(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const s=b.placed?1:0,u=Math.floor(127*b.opacity);return u*jn+s*fr+u*pr+s*Yn+u*Hn+s*Qr+u*Sr+s}const Es=0;class Io{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,u,m,v,w){const P=this._bucketParts;for(;this._currentTileIndex<s.length;)if(u.getBucketParts(P,v,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((D,F)=>D.sortKey-F.sortKey));this._currentPartIndex<P.length;)if(u.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,m),this._currentPartIndex++,w())return!0;return!1}}class Fl{constructor(s,u,m,v,w,P,D,F){this.placement=new _n(s,u,P,D,F),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(s,u,m){const v=M.now(),w=()=>!this._forceFullPlacement&&M.now()-v>2;for(;this._currentPlacementIndex>=0;){const P=u[s[this._currentPlacementIndex]],D=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=D)&&(!P.maxzoom||P.maxzoom>D)){if(this._inProgressLayer||(this._inProgressLayer=new Io(P)),this._inProgressLayer.continuePlacement(m[P.source],this.placement,this._showCollisionBoxes,P,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Er=512/o.$/2;class mo{constructor(s,u,m){this.tileID=s,this.bucketInstanceId=m,this._symbolsByKey={};const v=new Map;for(let w=0;w<u.length;w++){const P=u.get(w),D=P.key,F=v.get(D);F?F.push(P):v.set(D,[P])}for(const[w,P]of v){const D={positions:P.map(F=>({x:Math.floor(F.anchorX*Er),y:Math.floor(F.anchorY*Er)})),crossTileIDs:P.map(F=>F.crossTileID)};if(D.positions.length>128){const F=new o.aH(D.positions.length,16,Uint16Array);for(const{x:j,y:W}of D.positions)F.add(j,W);F.finish(),delete D.positions,D.index=F}this._symbolsByKey[w]=D}}getScaledCoordinates(s,u){const{x:m,y:v,z:w}=this.tileID.canonical,{x:P,y:D,z:F}=u.canonical,j=Er/Math.pow(2,F-w),W=(D*o.$+s.anchorY)*j,Q=v*o.$*Er;return{x:Math.floor((P*o.$+s.anchorX)*j-m*o.$*Er),y:Math.floor(W-Q)}}findMatches(s,u,m){const v=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let w=0;w<s.length;w++){const P=s.get(w);if(P.crossTileID)continue;const D=this._symbolsByKey[P.key];if(!D)continue;const F=this.getScaledCoordinates(P,u);if(D.index){const j=D.index.range(F.x-v,F.y-v,F.x+v,F.y+v).sort();for(const W of j){const Q=D.crossTileIDs[W];if(!m[Q]){m[Q]=!0,P.crossTileID=Q;break}}}else if(D.positions)for(let j=0;j<D.positions.length;j++){const W=D.positions[j],Q=D.crossTileIDs[j];if(Math.abs(W.x-F.x)<=v&&Math.abs(W.y-F.y)<=v&&!m[Q]){m[Q]=!0,P.crossTileID=Q;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:s})=>s)}}class go{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $i{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const u=Math.round((s-this.lng)/360);if(u!==0)for(const m in this.indexes){const v=this.indexes[m],w={};for(const P in v){const D=v[P];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+u),w[D.tileID.key]=D}this.indexes[m]=w}this.lng=s}addBucket(s,u,m){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let w=0;w<u.symbolInstances.length;w++)u.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const v=this.usedCrossTileIDs[s.overscaledZ];for(const w in this.indexes){const P=this.indexes[w];if(Number(w)>s.overscaledZ)for(const D in P){const F=P[D];F.tileID.isChildOf(s)&&F.findMatches(u.symbolInstances,s,v)}else{const D=P[s.scaledTo(Number(w)).key];D&&D.findMatches(u.symbolInstances,s,v)}}for(let w=0;w<u.symbolInstances.length;w++){const P=u.symbolInstances.get(w);P.crossTileID||(P.crossTileID=m.generate(),v[P.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new mo(s,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(s,u){for(const m of u.getCrossTileIDsLists())for(const v of m)delete this.usedCrossTileIDs[s][v]}removeStaleBuckets(s){let u=!1;for(const m in this.indexes){const v=this.indexes[m];for(const w in v)s[v[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,v[w]),delete v[w],u=!0)}return u}}class Ri{constructor(){this.layerIndexes={},this.crossTileIDs=new go,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,u,m){let v=this.layerIndexes[s.id];v===void 0&&(v=this.layerIndexes[s.id]=new $i);let w=!1;const P={};v.handleWrapJump(m);for(const D of u){const F=D.getBucket(s);F&&s.id===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(D.tileID,F,this.crossTileIDs)&&(w=!0),P[F.bucketInstanceId]=!0)}return v.removeStaleBuckets(P)&&(w=!0),w}pruneUnusedLayers(s){const u={};s.forEach(m=>{u[m]=!0});for(const m in this.layerIndexes)u[m]||delete this.layerIndexes[m]}}var Nl="void main() {fragColor=vec4(1.0);}";const Vi={prelude:er(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:er("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:er("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:er(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:er(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:er(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:er(Nl,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:er(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:er(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:er("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:er("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:er("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:er(Nl,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:er(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:er(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:er(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:er(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:er(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:er(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:er(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:er(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:er(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:er(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:er(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:er(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:er(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:er("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:er("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:er("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:er("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:er(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:er("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function er(b,s){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=s.match(/in ([\w]+) ([\w]+)/g),v=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=w?w.concat(v):v,D={};return{fragmentSource:b=b.replace(u,(F,j,W,Q,K)=>(D[K]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${K}
in ${W} ${Q} ${K};
#else
uniform ${W} ${Q} u_${K};
#endif
`:`
#ifdef HAS_UNIFORM_u_${K}
    ${W} ${Q} ${K} = u_${K};
#endif
`)),vertexSource:s=s.replace(u,(F,j,W,Q,K)=>{const oe=Q==="float"?"vec2":"vec4",he=K.match(/color/)?"color":oe;return D[K]?j==="define"?`
#ifndef HAS_UNIFORM_u_${K}
uniform lowp float u_${K}_t;
in ${W} ${oe} a_${K};
out ${W} ${Q} ${K};
#else
uniform ${W} ${Q} u_${K};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${K}
    ${K} = a_${K};
#else
    ${W} ${Q} ${K} = u_${K};
#endif
`:`
#ifndef HAS_UNIFORM_u_${K}
    ${K} = unpack_mix_${he}(a_${K}, u_${K}_t);
#else
    ${W} ${Q} ${K} = u_${K};
#endif
`:j==="define"?`
#ifndef HAS_UNIFORM_u_${K}
uniform lowp float u_${K}_t;
in ${W} ${oe} a_${K};
#else
uniform ${W} ${Q} u_${K};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${K}
    ${W} ${Q} ${K} = a_${K};
#else
    ${W} ${Q} ${K} = u_${K};
#endif
`:`
#ifndef HAS_UNIFORM_u_${K}
    ${W} ${Q} ${K} = unpack_mix_${he}(a_${K}, u_${K}_t);
#else
    ${W} ${Q} ${K} = u_${K};
#endif
`}),staticAttributes:m,staticUniforms:P}}class ol{constructor(s,u,m){this.vertexBuffer=s,this.indexBuffer=u,this.segments=m}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var sl=o.aI([{name:"a_pos",type:"Int16",components:2}]);const Tc="#define PROJECTION_MERCATOR",Qg="mercator";class ev{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Qg}get shaderDefine(){return Tc}get shaderPreludeCode(){return Vi.projectionMercator}get vertexShaderPreludeCode(){return Vi.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(s){}getMeshFromTileID(s,u,m,v,w){if(this._cachedMesh)return this._cachedMesh;const P=new o.aK;P.emplaceBack(0,0),P.emplaceBack(o.$,0),P.emplaceBack(0,o.$),P.emplaceBack(o.$,o.$);const D=s.createVertexBuffer(P,sl.members),F=o.aL.simpleSegment(0,0,4,2),j=new o.aM;j.emplaceBack(1,0,2),j.emplaceBack(1,2,3);const W=s.createIndexBuffer(j);return this._cachedMesh=new ol(D,W,F),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(s){}}class Ts{constructor(s=0,u=0,m=0,v=0){if(isNaN(s)||s<0||isNaN(u)||u<0||isNaN(m)||m<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=u,this.left=m,this.right=v}interpolate(s,u,m){return u.top!=null&&s.top!=null&&(this.top=o.C.number(s.top,u.top,m)),u.bottom!=null&&s.bottom!=null&&(this.bottom=o.C.number(s.bottom,u.bottom,m)),u.left!=null&&s.left!=null&&(this.left=o.C.number(s.left,u.left,m)),u.right!=null&&s.right!=null&&(this.right=o.C.number(s.right,u.right,m)),this}getCenter(s,u){const m=o.ag((this.left+s-this.right)/2,0,s),v=o.ag((this.top+u-this.bottom)/2,0,u);return new o.P(m,v)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new Ts(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function al(b,s){if(!b.renderWorldCopies||b.lngRange)return;const u=s.lng-b.center.lng;s.lng+=u>180?-360:u<-180?360:0}function tr(b){return Math.max(0,Math.floor(b))}class dd{constructor(s,u,m,v,w,P){this._callbacks=s,this._tileSize=512,this._renderWorldCopies=P===void 0||!!P,this._minZoom=u||0,this._maxZoom=m||22,this._minPitch=v??0,this._maxPitch=w??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=tr(this._zoom),this._scale=o.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Ts,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(s,u,m){this._latRange=s.latRange,this._lngRange=s.lngRange,this._width=s.width,this._height=s.height,this._center=s.center,this._elevation=s.elevation,this._minElevationForCurrentTile=s.minElevationForCurrentTile,this._zoom=s.zoom,this._tileZoom=tr(this._zoom),this._scale=o.ae(this._zoom),this._bearingInRadians=s.bearingInRadians,this._fovInRadians=s.fovInRadians,this._pitchInRadians=s.pitchInRadians,this._rollInRadians=s.rollInRadians,this._unmodified=s.unmodified,this._edgeInsets=new Ts(s.padding.top,s.padding.bottom,s.padding.left,s.padding.right),this._minZoom=s.minZoom,this._maxZoom=s.maxZoom,this._minPitch=s.minPitch,this._maxPitch=s.maxPitch,this._renderWorldCopies=s.renderWorldCopies,this._cameraToCenterDistance=s.cameraToCenterDistance,this._nearZ=s.nearZ,this._farZ=s.farZ,this._autoCalculateNearFarZ=!m&&s.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(s){this._minElevationForCurrentTile=s}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(s){this._minZoom!==s&&(this._minZoom=s,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(s){this._minPitch!==s&&(this._minPitch=s,this.setPitch(Math.max(this.pitch,s)))}get maxPitch(){return this._maxPitch}setMaxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.setPitch(Math.min(this.pitch,s)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(s){const u=o.aN(s,-180,180)*Math.PI/180;var m,v,w,P,D,F,j,W,Q;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=g(),m=this._rotationMatrix,w=-this._bearingInRadians,P=(v=this._rotationMatrix)[0],D=v[1],F=v[2],j=v[3],W=Math.sin(w),Q=Math.cos(w),m[0]=P*Q+F*W,m[1]=D*Q+j*W,m[2]=P*-W+F*Q,m[3]=D*-W+j*Q)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(s){const u=o.ag(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(s){const u=s/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aO(this._fovInRadians)}setFov(s){s=o.ag(s,.1,150),this.fov!==s&&(this._unmodified=!1,this._fovInRadians=o.ad(s),this._calcMatrices())}get zoom(){return this._zoom}setZoom(s){const u=this.getConstrained(this._center,s).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=o.ae(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(s,u){this._autoCalculateNearFarZ=!1,this._nearZ=s,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,u,m){this._unmodified=!1,this._edgeInsets.interpolate(s,u,m),this._constrain(),this._calcMatrices()}resize(s,u,m=!0){this._width=s,this._height=u,m&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new hn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(s){s?(this._lngRange=[s.getWest(),s.getEast()],this._latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-o.ah,o.ah])}getConstrained(s,u){return this._callbacks.getConstrained(s,u)}getCameraQueryGeometry(s,u){if(u.length===1)return[u[0],s];{const{minX:m,minY:v,maxX:w,maxY:P}=o.a1.fromPoints(u).extend(s);return[new o.P(m,v),new o.P(w,v),new o.P(w,P),new o.P(m,P),new o.P(m,v)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const s=this._unmodified,{center:u,zoom:m}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(m),this._unmodified=s,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let s=o.af(new Float64Array(16));o.N(s,s,[this._width/2,-this._height/2,1]),o.M(s,s,[1,-1,0]),this._clipSpaceToPixelsMatrix=s,s=o.af(new Float64Array(16)),o.N(s,s,[1,-1,1]),o.M(s,s,[-1,-1,0]),o.N(s,s,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=s,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(s,u,m,v){const w=m!==void 0?m:this.bearing,P=v=v!==void 0?v:this.pitch,D=o.a0.fromLngLat(s,u),F=-Math.cos(o.ad(P)),j=Math.sin(o.ad(P)),W=j*Math.sin(o.ad(w)),Q=-j*Math.cos(o.ad(w));let K=this.elevation;const oe=u-K;let he;F*oe>=0||Math.abs(F)<.1?(he=1e4,K=u+he*F):he=-oe/F;let Pe,Ee,Ie=o.aP(1,D.y),Fe=0;do{if(Fe+=1,Fe>10)break;Ee=he/Ie,Pe=new o.a0(D.x+W*Ee,D.y+Q*Ee),Ie=1/Pe.meterInMercatorCoordinateUnits()}while(Math.abs(he-Ee*Ie)>1e-12);return{center:Pe.toLngLat(),elevation:K,zoom:o.aj(this.height/2/Math.tan(this.fovInRadians/2)/Ee/this.tileSize)}}recalculateZoomAndCenter(s){if(this.elevation-s==0)return;const u=o.ai(1,this.center.lat)*this.worldSize,m=this.cameraToCenterDistance/u,v=o.a0.fromLngLat(this.center,this.elevation),w=le(this.center,this.elevation,this.pitch,this.bearing,m);this._elevation=s;const P=this.calculateCenterFromCameraLngLatAlt(w.toLngLat(),o.aP(w.z,v.y),this.bearing,this.pitch);this._elevation=P.elevation,this._center=P.center,this.setZoom(P.zoom)}getCameraPoint(){const s=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(s*Math.sin(this.rollInRadians),s*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const s=o.ai(1,this.center.lat)*this.worldSize;return le(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/s).toLngLat()}getMercatorTileCoordinates(s){if(!s)return[0,0,1,1];const u=s.canonical.z>=0?1<<s.canonical.z:Math.pow(2,s.canonical.z);return[s.canonical.x/u,s.canonical.y/u,1/u/o.$,1/u/o.$]}}class Kf{constructor(s,u){this.min=s,this.max=u,this.center=o.aQ([],o.aR([],this.min,this.max),.5)}quadrant(s){const u=[s%2==0,s<2],m=o.aS(this.min),v=o.aS(this.max);for(let w=0;w<u.length;w++)m[w]=u[w]?this.min[w]:this.center[w],v[w]=u[w]?this.center[w]:this.max[w];return v[2]=this.max[2],new Kf(m,v)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersectsFrustum(s){let u=!0;for(let m=0;m<s.planes.length;m++){const v=this.intersectsPlane(s.planes[m]);if(v===0)return 0;v===1&&(u=!1)}return u?2:s.aabb.min[0]>this.max[0]||s.aabb.min[1]>this.max[1]||s.aabb.min[2]>this.max[2]||s.aabb.max[0]<this.min[0]||s.aabb.max[1]<this.min[1]||s.aabb.max[2]<this.min[2]?0:1}intersectsPlane(s){let u=s[3],m=s[3];for(let v=0;v<3;v++)s[v]>0?(u+=s[v]*this.min[v],m+=s[v]*this.max[v]):(m+=s[v]*this.min[v],u+=s[v]*this.max[v]);return u>=0?2:m<0?0:1}}class tv{distanceToTile2d(s,u,m,v){const w=v.distanceX([s,u]),P=v.distanceY([s,u]);return Math.hypot(w,P)}getWrap(s,u,m){return m}getTileBoundingVolume(s,u,m,v){var w,P;let D=m,F=m;if(v!=null&&v.terrain){const W=new o.Z(s.z,u,s.z,s.x,s.y),Q=v.terrain.getMinMaxElevation(W);D=(w=Q.minElevation)!==null&&w!==void 0?w:m,F=(P=Q.maxElevation)!==null&&P!==void 0?P:m}const j=1<<s.z;return new Kf([u+s.x/j,s.y/j,D],[u+(s.x+1)/j,(s.y+1)/j,F])}allowVariableZoom(s,u){const m=s.fov*(Math.abs(Math.cos(s.rollInRadians))*s.height+Math.abs(Math.sin(s.rollInRadians))*s.width)/s.height,v=o.ag(78.5-m/2,0,60);return!!u.terrain||s.pitch>v}allowWorldCopies(){return!0}prepareNextFrame(){}}class vo{constructor(s,u,m){this.points=s,this.planes=u,this.aabb=m}static fromInvProjectionMatrix(s,u=1,m=0,v,w){const P=w?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],D=Math.pow(2,m),F=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(K=>function(oe,he,Pe,Ee){const Ie=o.av([],oe,he),Fe=1/Ie[3]/Pe*Ee;return o.aX(Ie,Ie,[Fe,Fe,1/Ie[3],Fe])}(K,s,u,D));v&&function(K,oe,he,Pe){const Ee=Pe?4:0,Ie=Pe?0:4;let Fe=0;const He=[],Be=[];for(let $e=0;$e<4;$e++){const rt=o.aT([],K[$e+Ie],K[$e+Ee]),yt=o.aY(rt);o.aQ(rt,rt,1/yt),He.push(yt),Be.push(rt)}for(let $e=0;$e<4;$e++){const rt=o.aZ(K[$e+Ee],Be[$e],he);Fe=rt!==null&&rt>=0?Math.max(Fe,rt):Math.max(Fe,He[$e])}const Ye=function($e,rt){const yt=o.aT([],$e[rt[0]],$e[rt[1]]),ht=o.aT([],$e[rt[2]],$e[rt[1]]),pt=[0,0,0,0];return o.aU(pt,o.aV([],yt,ht)),pt[3]=-o.aW(pt,$e[rt[0]]),pt}(K,oe),Ke=function($e,rt){const yt=o.a_($e),ht=o.a$([],$e,1/yt),pt=o.aT([],rt,o.aQ([],ht,o.aW(rt,ht))),_t=o.a_(pt);if(_t>0){const sn=Math.sqrt(1-ht[3]*ht[3]),rn=o.aQ([],ht,-ht[3]),Vt=o.aR([],rn,o.aQ([],pt,sn/_t));return o.b0(rt,Vt)}return null}(he,Ye);if(Ke!==null){const $e=Ke/o.aW(Be[0],Ye);Fe=Math.min(Fe,$e)}for(let $e=0;$e<4;$e++){const rt=Math.min(Fe,He[$e]);K[$e+Ie]=[K[$e+Ee][0]+Be[$e][0]*rt,K[$e+Ee][1]+Be[$e][1]*rt,K[$e+Ee][2]+Be[$e][2]*rt,1]}}(F,P[0],v,w);const j=P.map(K=>{const oe=o.aT([],F[K[0]],F[K[1]]),he=o.aT([],F[K[2]],F[K[1]]),Pe=o.aU([],o.aV([],oe,he)),Ee=-o.aW(Pe,F[K[1]]);return Pe.concat(Ee)}),W=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Q=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const K of F)for(let oe=0;oe<3;oe++)W[oe]=Math.min(W[oe],K[oe]),Q[oe]=Math.max(Q[oe],K[oe]);return new vo(F,j,new Kf(W,Q))}}class wi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(s){this._helper.setMinZoom(s)}setMaxZoom(s){this._helper.setMaxZoom(s)}setMinPitch(s){this._helper.setMinPitch(s)}setMaxPitch(s){this._helper.setMaxPitch(s)}setRenderWorldCopies(s){this._helper.setRenderWorldCopies(s)}setBearing(s){this._helper.setBearing(s)}setPitch(s){this._helper.setPitch(s)}setRoll(s){this._helper.setRoll(s)}setFov(s){this._helper.setFov(s)}setZoom(s){this._helper.setZoom(s)}setCenter(s){this._helper.setCenter(s)}setElevation(s){this._helper.setElevation(s)}setMinElevationForCurrentTile(s){this._helper.setMinElevationForCurrentTile(s)}setPadding(s){this._helper.setPadding(s)}interpolatePadding(s,u,m){return this._helper.interpolatePadding(s,u,m)}isPaddingEqual(s){return this._helper.isPaddingEqual(s)}resize(s,u,m=!0){this._helper.resize(s,u,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(s){this._helper.setMaxBounds(s)}overrideNearFarZ(s,u){this._helper.overrideNearFarZ(s,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(s){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),s)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(s,u){}constructor(s,u,m,v,w){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new dd({calcMatrices:()=>{this._calcMatrices()},getConstrained:(P,D)=>this.getConstrained(P,D)},s,u,m,v,w),this._coveringTilesDetailsProvider=new tv}clone(){const s=new wi;return s.apply(this),s}apply(s,u,m){this._helper.apply(s,u,m)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(s){const u=[new o.b1(0,s)];if(this._helper._renderWorldCopies){const m=this.screenPointToMercatorCoordinate(new o.P(0,0)),v=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),w=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),P=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),D=Math.floor(Math.min(m.x,v.x,w.x,P.x)),F=Math.floor(Math.max(m.x,v.x,w.x,P.x)),j=1;for(let W=D-j;W<=F+j;W++)W!==0&&u.push(new o.b1(W,s))}return u}getCameraFrustum(){return vo.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(s){const u=this.screenPointToLocation(this.centerPoint,s),m=s?s.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(m)}setLocationAtPoint(s,u){const m=o.ai(this.elevation,this.center.lat),v=this.screenPointToMercatorCoordinateAtZ(u,m),w=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,m),P=o.a0.fromLngLat(s),D=new o.a0(P.x-(v.x-w.x),P.y-(v.y-w.y));this.setCenter(D==null?void 0:D.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(s,u){return u?this.coordinatePoint(o.a0.fromLngLat(s),u.getElevationForLngLatZoom(s,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(o.a0.fromLngLat(s))}screenPointToLocation(s,u){var m;return(m=this.screenPointToMercatorCoordinate(s,u))===null||m===void 0?void 0:m.toLngLat()}screenPointToMercatorCoordinate(s,u){if(u){const m=u.pointCoordinate(s);if(m!=null)return m}return this.screenPointToMercatorCoordinateAtZ(s)}screenPointToMercatorCoordinateAtZ(s,u){const m=u||0,v=[s.x,s.y,0,1],w=[s.x,s.y,1,1];o.av(v,v,this._pixelMatrixInverse),o.av(w,w,this._pixelMatrixInverse);const P=v[3],D=w[3],F=v[1]/P,j=w[1]/D,W=v[2]/P,Q=w[2]/D,K=W===Q?0:(m-W)/(Q-W);return new o.a0(o.C.number(v[0]/P,w[0]/D,K)/this.worldSize,o.C.number(F,j,K)/this.worldSize,m)}coordinatePoint(s,u=0,m=this._pixelMatrix){const v=[s.x*this.worldSize,s.y*this.worldSize,u,1];return o.av(v,v,m),new o.P(v[0]/v[3],v[1]/v[3])}getBounds(){const s=Math.max(0,this._helper._height/2-re(this));return new hn().extend(this.screenPointToLocation(new o.P(0,s))).extend(this.screenPointToLocation(new o.P(this._helper._width,s))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(s,u){return u?u.pointCoordinate(s)!=null:s.y>this.height/2-re(this)}calculatePosMatrix(s,u=!1,m){var v;const w=(v=s.key)!==null&&v!==void 0?v:o.b2(s.wrap,s.canonical.z,s.canonical.z,s.canonical.x,s.canonical.y),P=u?this._alignedPosMatrixCache:this._posMatrixCache;if(P.has(w)){const j=P.get(w);return m?j.f32:j.f64}const D=Z(s,this.worldSize);o.O(D,u?this._alignedProjMatrix:this._viewProjMatrix,D);const F={f64:D,f32:new Float32Array(D)};return P.set(w,F),m?F.f32:F.f64}calculateFogMatrix(s){const u=s.key,m=this._fogMatrixCacheF32;if(m.has(u))return m.get(u);const v=Z(s,this.worldSize);return o.O(v,this._fogMatrix,v),m.set(u,new Float32Array(v)),m.get(u)}getConstrained(s,u){u=o.ag(+u,this.minZoom,this.maxZoom);const m={center:new o.S(s.lng,s.lat),zoom:u};let v=this._helper._lngRange;if(!this._helper._renderWorldCopies&&v===null){const He=179.9999999999;v=[-He,He]}const w=this.tileSize*o.ae(m.zoom);let P=0,D=w,F=0,j=w,W=0,Q=0;const{x:K,y:oe}=this.size;if(this._helper._latRange){const He=this._helper._latRange;P=o.U(He[1])*w,D=o.U(He[0])*w,D-P<oe&&(W=oe/(D-P))}v&&(F=o.aN(o.V(v[0])*w,0,w),j=o.aN(o.V(v[1])*w,0,w),j<F&&(j+=w),j-F<K&&(Q=K/(j-F)));const{x:he,y:Pe}=_e(w,s);let Ee,Ie;const Fe=Math.max(Q||0,W||0);if(Fe){const He=new o.P(Q?(j+F)/2:he,W?(D+P)/2:Pe);return m.center=te(w,He).wrap(),m.zoom+=o.aj(Fe),m}if(this._helper._latRange){const He=oe/2;Pe-He<P&&(Ie=P+He),Pe+He>D&&(Ie=D-He)}if(v){const He=(F+j)/2;let Be=he;this._helper._renderWorldCopies&&(Be=o.aN(he,He-w/2,He+w/2));const Ye=K/2;Be-Ye<F&&(Ee=F+Ye),Be+Ye>j&&(Ee=j-Ye)}if(Ee!==void 0||Ie!==void 0){const He=new o.P(Ee??he,Ie??Pe);m.center=te(w,He).wrap()}return m}calculateCenterFromCameraLngLatAlt(s,u,m,v){return this._helper.calculateCenterFromCameraLngLatAlt(s,u,m,v)}_calculateNearFarZIfNeeded(s,u,m){if(!this._helper.autoCalculateNearFarZ)return;const v=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),w=s-v*this._helper._pixelPerMeter/Math.cos(u),P=v<0?w:s,D=Math.PI/2+this.pitchInRadians,F=o.ad(this.fov)*(Math.abs(Math.cos(o.ad(this.roll)))*this.height+Math.abs(Math.sin(o.ad(this.roll)))*this.width)/this.height*(.5+m.y/this.height),j=Math.sin(F)*P/Math.sin(o.ag(Math.PI-D-F,.01,Math.PI-.01)),W=re(this),Q=Math.atan(W/this._helper.cameraToCenterDistance),K=o.ad(.75),oe=Q>K?2*Q*(.5+m.y/(2*W)):K,he=Math.sin(oe)*P/Math.sin(o.ag(Math.PI-D-oe,.01,Math.PI-.01)),Pe=Math.min(j,he);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*Pe+P),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const s=this.centerOffset,u=_e(this.worldSize,this.center),m=u.x,v=u.y;this._helper._pixelPerMeter=o.ai(1,this.center.lat)*this.worldSize;const w=o.ad(Math.min(this.pitch,zt)),P=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(w));let D;this._calculateNearFarZIfNeeded(P,w,s),D=new Float64Array(16),o.b3(D,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.ap(this._invProjMatrix,D),D[8]=2*-s.x/this._helper._width,D[9]=2*s.y/this._helper._height,this._projectionMatrix=o.b4(D),o.N(D,D,[1,-1,1]),o.M(D,D,[0,0,-this._helper.cameraToCenterDistance]),o.b5(D,D,-this.rollInRadians),o.b6(D,D,this.pitchInRadians),o.b5(D,D,-this.bearingInRadians),o.M(D,D,[-m,-v,0]),this._mercatorMatrix=o.N([],D,[this.worldSize,this.worldSize,this.worldSize]),o.N(D,D,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,D),o.M(D,D,[0,0,-this.elevation]),this._viewProjMatrix=D,this._invViewProjMatrix=o.ap([],D);const F=[0,0,-1,1];o.av(F,F,this._invViewProjMatrix),this._cameraPosition=[F[0]/F[3],F[1]/F[3],F[2]/F[3]],this._fogMatrix=new Float64Array(16),o.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,P,this._helper._farZ),this._fogMatrix[8]=2*-s.x/this.width,this._fogMatrix[9]=2*s.y/this.height,o.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.M(this._fogMatrix,this._fogMatrix,[-m,-v,0]),o.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,D);const j=this._helper._width%2/2,W=this._helper._height%2/2,Q=Math.cos(this.bearingInRadians),K=Math.sin(-this.bearingInRadians),oe=m-Math.round(m)+Q*j+K*W,he=v-Math.round(v)+Q*W+K*j,Pe=new Float64Array(D);if(o.M(Pe,Pe,[oe>.5?oe-1:oe,he>.5?he-1:he,0]),this._alignedProjMatrix=Pe,D=o.ap(new Float64Array(16),this._pixelMatrix),!D)throw new Error("failed to invert matrix");this._pixelMatrixInverse=D,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const s=this.screenPointToMercatorCoordinate(new o.P(0,0)),u=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.av(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const s=o.ai(1,this.center.lat)*this.worldSize;return le(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/s).toLngLat()}lngLatToCameraDepth(s,u){const m=o.a0.fromLngLat(s),v=[m.x*this.worldSize,m.y*this.worldSize,u,1];return o.av(v,v,this._viewProjMatrix),v[2]/v[3]}getProjectionData(s){const{overscaledTileID:u,aligned:m,applyTerrainMatrix:v}=s,w=this._helper.getMercatorTileCoordinates(u),P=u?this.calculatePosMatrix(u,m,!0):null;let D;return D=u&&u.terrainRttPosMatrix32f&&v?u.terrainRttPosMatrix32f:P||o.b7(),{mainMatrix:D,tileMercatorCoords:w,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:D}}isLocationOccluded(s){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(s,u,m){return 1}transformLightDirection(s){return o.aS(s)}getRayDirectionFromPixel(s){throw new Error("Not implemented.")}projectTileCoordinates(s,u,m,v){const w=this.calculatePosMatrix(m);let P;v?(P=[s,u,v(s,u),1],o.av(P,P,w)):(P=[s,u,0,1],vt(P,P,w));const D=P[3];return{point:new o.P(P[0]/D,P[1]/D),signedDistanceFromCamera:D,isOccluded:!1}}populateCache(s){for(const u of s)this.calculatePosMatrix(u)}getMatrixForModel(s,u){const m=o.a0.fromLngLat(s,u),v=m.meterInMercatorCoordinateUnits(),w=o.b8();return o.M(w,w,[m.x,m.y,m.z]),o.b5(w,w,Math.PI),o.b6(w,w,Math.PI/2),o.N(w,w,[-v,v,v]),w}getProjectionDataForCustomLayer(s=!0){const u=new o.Z(0,0,0,0,0),m=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:s}),v=Z(u,this.worldSize);o.O(v,this._viewProjMatrix,v),m.tileMercatorCoords=[0,0,1,1];const w=[o.$,o.$,this.worldSize/this._helper.pixelsPerMeter],P=o.b9();return o.N(P,v,w),m.fallbackMatrix=P,m.mainMatrix=P,m}getFastPathSimpleProjectionMatrix(s){return this.calculatePosMatrix(s)}}function yo(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ji(b){if(b.useSlerp)if(b.k<1){const s=o.ba(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),u=o.ba(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),m=new Float64Array(4);o.bb(m,s,u,b.k);const v=o.bc(m);b.tr.setRoll(v.roll),b.tr.setPitch(v.pitch),b.tr.setBearing(v.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(o.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(o.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(o.C.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function ei(b,s,u,m,v){const w=v.padding,P=_e(v.worldSize,u.getNorthWest()),D=_e(v.worldSize,u.getNorthEast()),F=_e(v.worldSize,u.getSouthEast()),j=_e(v.worldSize,u.getSouthWest()),W=o.ad(-m),Q=P.rotate(W),K=D.rotate(W),oe=F.rotate(W),he=j.rotate(W),Pe=new o.P(Math.max(Q.x,K.x,he.x,oe.x),Math.max(Q.y,K.y,he.y,oe.y)),Ee=new o.P(Math.min(Q.x,K.x,he.x,oe.x),Math.min(Q.y,K.y,he.y,oe.y)),Ie=Pe.sub(Ee),Fe=(v.width-(w.left+w.right+s.left+s.right))/Ie.x,He=(v.height-(w.top+w.bottom+s.top+s.bottom))/Ie.y;if(He<0||Fe<0)return void yo();const Be=Math.min(o.aj(v.scale*Math.min(Fe,He)),b.maxZoom),Ye=o.P.convert(b.offset),Ke=new o.P((s.left-s.right)/2,(s.top-s.bottom)/2).rotate(o.ad(m)),$e=Ye.add(Ke).mult(v.scale/o.ae(Be));return{center:te(v.worldSize,P.add(F).div(2).sub($e)),zoom:Be,bearing:m}}class Jf{get useGlobeControls(){return!1}handlePanInertia(s,u){return{easingOffset:s,easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(s,u){s.bearingDelta&&u.setBearing(u.bearing+s.bearingDelta),s.pitchDelta&&u.setPitch(u.pitch+s.pitchDelta),s.rollDelta&&u.setRoll(u.roll+s.rollDelta),s.zoomDelta&&u.setZoom(u.zoom+s.zoomDelta)}handleMapControlsPan(s,u,m){s.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(m,s.around)}cameraForBoxAndBearing(s,u,m,v,w){return ei(s,u,m,v,w)}handleJumpToCenterZoom(s,u){s.zoom!==(u.zoom!==void 0?+u.zoom:s.zoom)&&s.setZoom(+u.zoom),u.center!==void 0&&s.setCenter(o.S.convert(u.center))}handleEaseTo(s,u){const m=s.zoom,v=s.padding,w={roll:s.roll,pitch:s.pitch,bearing:s.bearing},P={roll:u.roll===void 0?s.roll:u.roll,pitch:u.pitch===void 0?s.pitch:u.pitch,bearing:u.bearing===void 0?s.bearing:u.bearing},D=u.zoom!==void 0,F=!s.isPaddingEqual(u.padding);let j=!1;const W=D?+u.zoom:s.zoom;let Q=s.centerPoint.add(u.offsetAsPoint);const K=s.screenPointToLocation(Q),{center:oe,zoom:he}=s.getConstrained(o.S.convert(u.center||K),W??m);al(s,oe);const Pe=_e(s.worldSize,K),Ee=_e(s.worldSize,oe).sub(Pe),Ie=o.ae(he-m);return j=he!==m,{easeFunc:Fe=>{if(j&&s.setZoom(o.C.number(m,he,Fe)),o.bd(w,P)||ji({startEulerAngles:w,endEulerAngles:P,tr:s,k:Fe,useSlerp:w.roll!=P.roll}),F&&(s.interpolatePadding(v,u.padding,Fe),Q=s.centerPoint.add(u.offsetAsPoint)),u.around)s.setLocationAtPoint(u.around,u.aroundPoint);else{const He=o.ae(s.zoom-m),Be=he>m?Math.min(2,Ie):Math.max(.5,Ie),Ye=Math.pow(Be,1-Fe),Ke=te(s.worldSize,Pe.add(Ee.mult(Fe*Ye)).mult(He));s.setLocationAtPoint(s.renderWorldCopies?Ke.wrap():Ke,Q)}},isZooming:j,elevationCenter:oe}}handleFlyTo(s,u){const m=u.zoom!==void 0,v=s.zoom,w=s.getConstrained(o.S.convert(u.center||u.locationAtOffset),m?+u.zoom:v),P=w.center,D=w.zoom;al(s,P);const F=_e(s.worldSize,u.locationAtOffset),j=_e(s.worldSize,P).sub(F),W=j.mag(),Q=o.ae(D-v);let K;if(u.minZoom!==void 0){const oe=Math.min(+u.minZoom,v,D),he=s.getConstrained(P,oe).zoom;K=o.ae(he-v)}return{easeFunc:(oe,he,Pe,Ee)=>{s.setZoom(oe===1?D:v+o.aj(he));const Ie=oe===1?P:te(s.worldSize,F.add(j.mult(Pe)).mult(he));s.setLocationAtPoint(s.renderWorldCopies?Ie.wrap():Ie,Ee)},scaleOfZoom:Q,targetCenter:P,scaleOfMinZoom:K,pixelPathLength:W}}}class ar{constructor(s,u,m){this.blendFunction=s,this.blendColor=u,this.mask=m}}ar.Replace=[1,0],ar.disabled=new ar(ar.Replace,o.be.transparent,[!1,!1,!1,!1]),ar.unblended=new ar(ar.Replace,o.be.transparent,[!0,!0,!0,!0]),ar.alphaBlended=new ar([1,771],o.be.transparent,[!0,!0,!0,!0]);const Zo=2305;class Wn{constructor(s,u,m){this.enable=s,this.mode=u,this.frontFace=m}}Wn.disabled=new Wn(!1,1029,Zo),Wn.backCCW=new Wn(!0,1029,Zo),Wn.frontCCW=new Wn(!0,1028,Zo);class Kn{constructor(s,u,m){this.func=s,this.mask=u,this.range=m}}Kn.ReadOnly=!1,Kn.ReadWrite=!0,Kn.disabled=new Kn(519,Kn.ReadOnly,[0,1]);const Pc=7680;class Gn{constructor(s,u,m,v,w,P){this.test=s,this.ref=u,this.mask=m,this.fail=v,this.depthFail=w,this.pass=P}}Gn.disabled=new Gn({func:519,mask:0},0,0,Pc,Pc,Pc);const Ac=new WeakMap;function Ro(b){var s;if(Ac.has(b))return Ac.get(b);{const u=(s=b.getParameter(b.VERSION))===null||s===void 0?void 0:s.startsWith("WebGL 2.0");return Ac.set(b,u),u}}class Mu{get awaitingQuery(){return!!this._readbackQueue}constructor(s){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=s;const u=s.context,m=u.gl;this._texFormat=m.RGBA,this._texType=m.UNSIGNED_BYTE;const v=new o.aK;v.emplaceBack(-1,-1),v.emplaceBack(2,-1),v.emplaceBack(-1,2);const w=new o.aM;w.emplaceBack(0,1,2),this._fullscreenTriangle=new ol(u.createVertexBuffer(v,sl.members),u.createIndexBuffer(w),o.aL.simpleSegment(0,0,v.length,w.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(m.TEXTURE1);const P=m.createTexture();m.bindTexture(m.TEXTURE_2D,P),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST),m.texImage2D(m.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(P),Ro(m)&&(this._pbo=m.createBuffer(),m.bindBuffer(m.PIXEL_PACK_BUFFER,this._pbo),m.bufferData(m.PIXEL_PACK_BUFFER,4,m.STREAM_READ),m.bindBuffer(m.PIXEL_PACK_BUFFER,null))}destroy(){const s=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),s.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(s,u){const m=this._updateCount;return this._readbackQueue?m>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():m>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(s,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const s=this._cachedRenderContext.context,u=s.gl;s.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),s.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(s,u){const m=this._cachedRenderContext.context,v=m.gl;if(this._bindFramebuffer(),m.viewport.set([0,0,this._texWidth,this._texHeight]),m.clear({color:o.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(m,v.TRIANGLES,Kn.disabled,Gn.disabled,ar.unblended,Wn.disabled,((w,P)=>({u_input:w,u_output_expected:P}))(s,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Ro(v)){v.bindBuffer(v.PIXEL_PACK_BUFFER,this._pbo),v.readBuffer(v.COLOR_ATTACHMENT0),v.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),v.bindBuffer(v.PIXEL_PACK_BUFFER,null);const w=v.fenceSync(v.SYNC_GPU_COMMANDS_COMPLETE,0);v.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:w}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const s=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Ro(s)){const u=s.clientWaitSync(this._readbackQueue.sync,0,0);if(u===s.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===s.TIMEOUT_EXPIRED)return;s.bindBuffer(s.PIXEL_PACK_BUFFER,this._pbo),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),s.bindBuffer(s.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),s.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Mu._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(s){let u=0;return u+=s[0]/256,u+=s[1]/65536,u+=s[2]/16777216,s[3]<127&&(u=-u),u/128}}const Yo=o.$/128;function nv(b,s){const u=b.granularity!==void 0?Math.max(b.granularity,1):1,m=u+(b.generateBorders?2:0),v=u+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),w=m+1,P=v+1,D=b.generateBorders?-1:0,F=b.generateBorders||b.extendToNorthPole?-1:0,j=u+(b.generateBorders?1:0),W=u+(b.generateBorders||b.extendToSouthPole?1:0),Q=w*P,K=m*v*6,oe=w*P>65536;if(oe&&s==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const he=oe||s==="32bit",Pe=new Int16Array(2*Q);let Ee=0;for(let He=F;He<=W;He++)for(let Be=D;Be<=j;Be++){let Ye=Be/u*o.$;Be===-1&&(Ye=-Yo),Be===u+1&&(Ye=o.$+Yo);let Ke=He/u*o.$;He===-1&&(Ke=b.extendToNorthPole?o.bg:-Yo),He===u+1&&(Ke=b.extendToSouthPole?o.bh:o.$+Yo),Pe[Ee++]=Ye,Pe[Ee++]=Ke}const Ie=he?new Uint32Array(K):new Uint16Array(K);let Fe=0;for(let He=0;He<v;He++)for(let Be=0;Be<m;Be++){const Ye=Be+1+He*w,Ke=Be+(He+1)*w,$e=Be+1+(He+1)*w;Ie[Fe++]=Be+He*w,Ie[Fe++]=Ke,Ie[Fe++]=Ye,Ie[Fe++]=Ye,Ie[Fe++]=Ke,Ie[Fe++]=$e}return{vertices:Pe.buffer.slice(0),indices:Ie.buffer.slice(0),uses32bitIndices:he}}const Ra=new o.aJ({fill:new o.bi(128,2),line:new o.bi(512,0),tile:new o.bi(128,32),stencil:new o.bi(128,1),circle:3});class wx{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Vi.projectionGlobe}get vertexShaderPreludeCode(){return Vi.projectionMercator.vertexSource}get subdivisionGranularity(){return Ra}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(s){this._errorMeasurement||(this._errorMeasurement=new Mu(s));const u=o.U(this._errorQueryLatitudeDegrees),m=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,v=this._errorMeasurement.updateErrorLoop(u,m),w=M.now();v!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=v,this._errorMeasurementLastChangeTime=w);const P=Math.min(Math.max((w-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bk(P))}_getMeshKey(s){return`${s.granularity.toString(36)}_${s.generateBorders?"b":""}${s.extendToNorthPole?"n":""}${s.extendToSouthPole?"s":""}`}getMeshFromTileID(s,u,m,v,w){const P=(w==="stencil"?Ra.stencil:Ra.tile).getGranularityForZoomLevel(u.z);return this._getMesh(s,{granularity:P,generateBorders:m,extendToNorthPole:u.y===0&&v,extendToSouthPole:u.y===(1<<u.z)-1&&v})}_getMesh(s,u){const m=this._getMeshKey(u);if(m in this._tileMeshCache)return this._tileMeshCache[m];const v=function(w,P){const D=nv(P,"16bit"),F=o.aK.deserialize({arrayBuffer:D.vertices,length:D.vertices.byteLength/2/2}),j=o.aM.deserialize({arrayBuffer:D.indices,length:D.indices.byteLength/2/3});return new ol(w.createVertexBuffer(F,sl.members),w.createIndexBuffer(j),o.aL.simpleSegment(0,0,F.length,j.length))}(s,u);return this._tileMeshCache[m]=v,v}recalculate(s){}hasTransition(){const s=M.now();let u=!1;return u=u||(s-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(s){this._errorQueryLatitudeDegrees=s}}const Sx=new o.r({type:new o.D(o.v.projection.type)});class fd extends o.E{constructor(s){super(),this._transitionable=new o.t(Sx),this.setProjection(s),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0)),this._mercatorProjection=new ev,this._verticalPerspectiveProjection=new wx}get transitionState(){const s=this.properties.get("type");if(typeof s=="string"&&s==="mercator")return 0;if(typeof s=="string"&&s==="vertical-perspective")return 1;if(s instanceof o.bl){if(s.from==="vertical-perspective"&&s.to==="mercator")return 1-s.transition;if(s.from==="mercator"&&s.to==="vertical-perspective")return s.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(s){this._mercatorProjection.updateGPUdependent(s),this._verticalPerspectiveProjection.updateGPUdependent(s)}getMeshFromTileID(s,u,m,v,w){return this.currentProjection.getMeshFromTileID(s,u,m,v,w)}setProjection(s){this._transitionable.setValue("type",(s==null?void 0:s.type)||"mercator")}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}setErrorQueryLatitudeDegrees(s){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(s),this._mercatorProjection.setErrorQueryLatitudeDegrees(s)}}function pd(b){const s=Cu(b.worldSize,b.center.lat);return 2*Math.PI*s}function Ks(b,s,u,m,v){const w=1/(1<<v),P=s/o.$*w+m*w,D=o.bn((b/o.$*w+u*w)*Math.PI*2+Math.PI,2*Math.PI),F=2*Math.atan(Math.exp(Math.PI-P*Math.PI*2))-.5*Math.PI,j=Math.cos(F),W=new Float64Array(3);return W[0]=Math.sin(D)*j,W[1]=Math.sin(F),W[2]=Math.cos(D)*j,W}function Hi(b){return function(s,u){const m=Math.cos(u),v=new Float64Array(3);return v[0]=Math.sin(s)*m,v[1]=Math.sin(u),v[2]=Math.cos(s)*m,v}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function Cu(b,s){return b/(2*Math.PI)/Math.cos(s*Math.PI/180)}function md(b){const s=Math.asin(b[1])/Math.PI*180,u=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(u>1e-6){const m=b[0]/u,v=Math.acos(b[2]/u),w=(m>0?v:-v)/Math.PI*180;return new o.S(o.aN(w,-180,180),s)}return new o.S(0,s)}function Eu(b){return Math.cos(b*Math.PI/180)}function Si(b,s){const u=Eu(b),m=Eu(s);return o.aj(m/u)}function gd(b,s){const u=b.rotate(s.bearingInRadians),m=s.zoom+Si(s.center.lat,0),v=o.bj(1/Eu(s.center.lat),1/Eu(Math.min(Math.abs(s.center.lat),60)),o.bm(m,7,3,0,1)),w=360/pd({worldSize:s.worldSize,center:{lat:s.center.lat}});return new o.S(s.center.lng-u.x*w*v,o.ag(s.center.lat+u.y*w,-o.ah,o.ah))}function Tu(b){const s=.5*b,u=Math.sin(s),m=Math.cos(s);return Math.log(u+m)-Math.log(m-u)}function Pu(b,s,u,m){const v=b.lat+u*m;if(Math.abs(u)>1){const w=(Math.sign(b.lat+u)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,P=Math.abs(b.lat+u)*Math.PI/180,D=Tu(w+m*(P-w)),F=Tu(w),j=Tu(P);return new o.S(b.lng+s*((D-F)/(j-F)),v)}return new o.S(b.lng+s*m,v)}class P2{constructor(s){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=s}swapBuffers(){if(!this._hadAnyChanges)return;const s=this._cachePrevious;this._cachePrevious=this._cache,this._cache=s,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(s,u,m,v){const w=`${s.z}_${s.x}_${s.y}_${v!=null&&v.terrain?"t":""}`,P=this._cache.get(w);if(P)return P;const D=this._cachePrevious.get(w);if(D)return this._cache.set(w,D),D;const F=this._boundingVolumeFactory(s,u,m,v);return this._cache.set(w,F),this._hadAnyChanges=!0,F}}class Bl{constructor(s,u,m,v){this.min=m,this.max=v,this.points=s,this.planes=u}static fromAabb(s,u){const m=[];for(let v=0;v<8;v++)m.push([1&~v?s[0]:u[0],(v>>1&1)==1?u[1]:s[1],(v>>2&1)==1?u[2]:s[2]]);return new Bl(m,[[-1,0,0,u[0]],[1,0,0,-s[0]],[0,-1,0,u[1]],[0,1,0,-s[1]],[0,0,-1,u[2]],[0,0,1,-s[2]]],s,u)}static fromCenterSizeAngles(s,u,m){const v=o.bq([],m[0],m[1],m[2]),w=o.br([],[u[0],0,0],v),P=o.br([],[0,u[1],0],v),D=o.br([],[0,0,u[2]],v),F=[...s],j=[...s];for(let Q=0;Q<8;Q++)for(let K=0;K<3;K++){const oe=s[K]+w[K]*(1&~Q?-1:1)+P[K]*((Q>>1&1)==1?1:-1)+D[K]*((Q>>2&1)==1?1:-1);F[K]=Math.min(F[K],oe),j[K]=Math.max(j[K],oe)}const W=[];for(let Q=0;Q<8;Q++){const K=[...s];o.aR(K,K,o.aQ([],w,1&~Q?-1:1)),o.aR(K,K,o.aQ([],P,(Q>>1&1)==1?1:-1)),o.aR(K,K,o.aQ([],D,(Q>>2&1)==1?1:-1)),W.push(K)}return new Bl(W,[[...w,-o.aW(w,W[0])],[...P,-o.aW(P,W[0])],[...D,-o.aW(D,W[0])],[-w[0],-w[1],-w[2],-o.aW(w,W[7])],[-P[0],-P[1],-P[2],-o.aW(P,W[7])],[-D[0],-D[1],-D[2],-o.aW(D,W[7])]],F,j)}intersectsFrustum(s){let u=!0;const m=this.points.length,v=this.planes.length,w=s.planes.length,P=s.points.length;for(let D=0;D<w;D++){const F=s.planes[D];let j=0;for(let W=0;W<m;W++){const Q=this.points[W];F[0]*Q[0]+F[1]*Q[1]+F[2]*Q[2]+F[3]>=0&&j++}if(j===0)return 0;j<m&&(u=!1)}if(u)return 2;for(let D=0;D<v;D++){const F=this.planes[D];let j=0;for(let W=0;W<P;W++){const Q=s.points[W];F[0]*Q[0]+F[1]*Q[1]+F[2]*Q[2]+F[3]>=0&&j++}if(j===0)return 0}return 1}intersectsPlane(s){const u=this.points.length;let m=0;for(let v=0;v<u;v++){const w=this.points[v];s[0]*w[0]+s[1]*w[1]+s[2]*w[2]+s[3]>=0&&m++}return m===u?2:m===0?0:1}}function vd(b,s,u){const m=b-s;return m<0?-m:Math.max(0,m-u)}function rv(b,s,u,m,v){const w=b-u;let P;return P=w<0?Math.min(-w,1+w-v):w>1?Math.min(Math.max(w-v,0),1-w):0,Math.max(P,vd(s,m,v))}class A2{constructor(){this._boundingVolumeCache=new P2(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(s,u,m,v){const w=1<<m.z,P=1/w,D=m.x/w,F=m.y/w;let j=2;return j=Math.min(j,rv(s,u,D,F,P)),j=Math.min(j,rv(s,u,D+.5,-F-P,P)),j=Math.min(j,rv(s,u,D+.5,2-F-P,P)),j}getWrap(s,u,m){const v=1<<u.z,w=1/v,P=u.x/v,D=vd(s.x,P,w),F=vd(s.x,P-1,w),j=vd(s.x,P+1,w),W=Math.min(D,F,j);return W===j?1:W===F?-1:0}allowVariableZoom(s,u){return Re(s,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(s,u,m,v){return this._boundingVolumeCache.getTileBoundingVolume(s,u,m,v)}_computeTileBoundingVolume(s,u,m,v){var w,P;let D=m,F=m;if(v!=null&&v.terrain){const j=new o.Z(s.z,u,s.z,s.x,s.y),W=v.terrain.getMinMaxElevation(j);D=(w=W.minElevation)!==null&&w!==void 0?w:m,F=(P=W.maxElevation)!==null&&P!==void 0?P:m}if(D/=o.bt,F/=o.bt,D+=1,F+=1,s.z<=0)return Bl.fromAabb([-F,-F,-F],[F,F,F]);if(s.z===1)return Bl.fromAabb([s.x===0?-F:0,s.y===0?0:-F,-F],[s.x===0?0:F,s.y===0?F:0,F]);{const j=[Ks(0,0,s.x,s.y,s.z),Ks(o.$,0,s.x,s.y,s.z),Ks(o.$,o.$,s.x,s.y,s.z),Ks(0,o.$,s.x,s.y,s.z)],W=[];for(const pt of j)W.push(o.aQ([],pt,F));if(F!==D)for(const pt of j)W.push(o.aQ([],pt,D));s.y===0&&W.push([0,1,0]),s.y===(1<<s.z)-1&&W.push([0,-1,0]);const Q=[1,1,1],K=[-1,-1,-1];for(const pt of W)for(let _t=0;_t<3;_t++)Q[_t]=Math.min(Q[_t],pt[_t]),K[_t]=Math.max(K[_t],pt[_t]);const oe=Ks(o.$/2,o.$/2,s.x,s.y,s.z),he=o.aV([],[0,1,0],oe);o.aU(he,he);const Pe=o.aV([],oe,he);o.aU(Pe,Pe);const Ee=o.aV([],j[2],j[1]);o.aU(Ee,Ee);const Ie=o.aV([],j[0],j[3]);o.aU(Ie,Ie),W.push(o.aQ([],oe,F)),s.y>=(1<<s.z)/2&&W.push(o.aQ([],Ks(o.$/2,0,s.x,s.y,s.z),F)),s.y<(1<<s.z)/2&&W.push(o.aQ([],Ks(o.$/2,o.$,s.x,s.y,s.z),F));const Fe=Lo(oe,W),He=Lo(Pe,W),Be=[-oe[0],-oe[1],-oe[2],Fe.max],Ye=[oe[0],oe[1],oe[2],-Fe.min],Ke=[-Pe[0],-Pe[1],-Pe[2],He.max],$e=[Pe[0],Pe[1],Pe[2],-He.min],rt=[...Ee,0],yt=[...Ie,0],ht=[];return s.y===0?ht.push(o.bs(yt,rt,Be),o.bs(yt,rt,Ye)):ht.push(o.bs(Ke,rt,Be),o.bs(Ke,rt,Ye),o.bs(Ke,yt,Be),o.bs(Ke,yt,Ye)),s.y===(1<<s.z)-1?ht.push(o.bs(yt,rt,Be),o.bs(yt,rt,Ye)):ht.push(o.bs($e,rt,Be),o.bs($e,rt,Ye),o.bs($e,yt,Be),o.bs($e,yt,Ye)),new Bl(ht,[Be,Ye,Ke,$e,rt,yt],Q,K)}}}function Lo(b,s){let u=1/0,m=-1/0;for(const v of s){const w=o.aW(b,v);u=Math.min(u,w),m=Math.max(m,w)}return{min:u,max:m}}class Au{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(s){this._helper.setMinZoom(s)}setMaxZoom(s){this._helper.setMaxZoom(s)}setMinPitch(s){this._helper.setMinPitch(s)}setMaxPitch(s){this._helper.setMaxPitch(s)}setRenderWorldCopies(s){this._helper.setRenderWorldCopies(s)}setBearing(s){this._helper.setBearing(s)}setPitch(s){this._helper.setPitch(s)}setRoll(s){this._helper.setRoll(s)}setFov(s){this._helper.setFov(s)}setZoom(s){this._helper.setZoom(s)}setCenter(s){this._helper.setCenter(s)}setElevation(s){this._helper.setElevation(s)}setMinElevationForCurrentTile(s){this._helper.setMinElevationForCurrentTile(s)}setPadding(s){this._helper.setPadding(s)}interpolatePadding(s,u,m){return this._helper.interpolatePadding(s,u,m)}isPaddingEqual(s){return this._helper.isPaddingEqual(s)}resize(s,u){this._helper.resize(s,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(s){this._helper.setMaxBounds(s)}overrideNearFarZ(s,u){this._helper.overrideNearFarZ(s,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(s){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),s)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(s){}constructor(){this._cachedClippingPlane=o.bu(),this._projectionMatrix=o.b8(),this._globeViewProjMatrix32f=o.b7(),this._globeViewProjMatrixNoCorrection=o.b8(),this._globeViewProjMatrixNoCorrectionInverted=o.b8(),this._globeProjMatrixInverted=o.b8(),this._cameraPosition=o.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new dd({calcMatrices:()=>{this._calcMatrices()},getConstrained:(s,u)=>this.getConstrained(s,u)}),this._coveringTilesDetailsProvider=new A2}clone(){const s=new Au;return s.apply(this),s}apply(s,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(s)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const s=o.bo();return s[0]=this._cameraPosition[0],s[1]=this._cameraPosition[1],s[2]=this._cameraPosition[2],s}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(s){const{overscaledTileID:u,applyGlobeMatrix:m}=s,v=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:v,clippingPlane:this._cachedClippingPlane,projectionTransition:m?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(s){const u=this.pitchInRadians,m=this.cameraToCenterDistance/s,v=Math.sin(u)*m,w=Math.cos(u)*m+1,P=1/Math.sqrt(v*v+w*w)*1;let D=-v,F=w;const j=Math.sqrt(D*D+F*F);D/=j,F/=j;const W=[0,D,F];o.bv(W,W,[0,0,0],-this.bearingInRadians),o.bw(W,W,[0,0,0],-1*this.center.lat*Math.PI/180),o.bx(W,W,[0,0,0],this.center.lng*Math.PI/180);const Q=1/o.aY(W);return o.aQ(W,W,Q),[...W,-P*Q]}isLocationOccluded(s){return!this.isSurfacePointVisible(Hi(s))}transformLightDirection(s){const u=this._helper._center.lng*Math.PI/180,m=this._helper._center.lat*Math.PI/180,v=Math.cos(m),w=[Math.sin(u)*v,Math.sin(m),Math.cos(u)*v],P=[w[2],0,-w[0]],D=[0,0,0];o.aV(D,P,w),o.aU(P,P),o.aU(D,D);const F=[0,0,0];return o.aU(F,[P[0]*s[0]+D[0]*s[1]+w[0]*s[2],P[1]*s[0]+D[1]*s[1]+w[1]*s[2],P[2]*s[0]+D[2]*s[1]+w[2]*s[2]]),F}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(s,u,m){const v=function(D,F,j){const W=1/(1<<j.z);return new o.a0(D/o.$*W+j.x*W,F/o.$*W+j.y*W)}(s,u,m.canonical),w=(P=v.y,[o.bn(v.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-P*Math.PI*2))-.5*Math.PI]);var P;return this.getCircleRadiusCorrection()/Math.cos(w[1])}projectTileCoordinates(s,u,m,v){const w=m.canonical,P=Ks(s,u,w.x,w.y,w.z),D=1+(v?v(s,u):0)/o.bt,F=[P[0]*D,P[1]*D,P[2]*D,1];o.av(F,F,this._globeViewProjMatrixNoCorrection);const j=this._cachedClippingPlane,W=j[0]*P[0]+j[1]*P[1]+j[2]*P[2]+j[3]<0;return{point:new o.P(F[0]/F[3],F[1]/F[3]),signedDistanceFromCamera:F[3],isOccluded:W}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const s=Cu(this.worldSize,this.center.lat),u=o.b9(),m=o.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*s),o.b3(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const v=this.centerOffset;u[8]=2*-v.x/this._helper._width,u[9]=2*v.y/this._helper._height,this._projectionMatrix=o.b4(u),this._globeProjMatrixInverted=o.b9(),o.ap(this._globeProjMatrixInverted,u),o.M(u,u,[0,0,-this.cameraToCenterDistance]),o.b5(u,u,this.rollInRadians),o.b6(u,u,-this.pitchInRadians),o.b5(u,u,this.bearingInRadians),o.M(u,u,[0,0,-s]);const w=o.bo();w[0]=s,w[1]=s,w[2]=s,o.b6(m,u,this.center.lat*Math.PI/180),o.by(m,m,-this.center.lng*Math.PI/180),o.N(m,m,w),this._globeViewProjMatrixNoCorrection=m,o.b6(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.by(u,u,-this.center.lng*Math.PI/180),o.N(u,u,w),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=o.b9(),o.ap(this._globeViewProjMatrixNoCorrectionInverted,m);const P=o.bo();this._cameraPosition=o.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/s,o.bv(this._cameraPosition,this._cameraPosition,P,-this.rollInRadians),o.bw(this._cameraPosition,this._cameraPosition,P,this.pitchInRadians),o.bv(this._cameraPosition,this._cameraPosition,P,-this.bearingInRadians),o.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bw(this._cameraPosition,this._cameraPosition,P,-this.center.lat*Math.PI/180),o.bx(this._cameraPosition,this._cameraPosition,P,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(s);const D=o.b4(this._globeViewProjMatrixNoCorrectionInverted);o.N(D,D,[1,1,-1]),this._cachedFrustum=vo.fromInvProjectionMatrix(D,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(s){o.w("calculateFogMatrix is not supported on globe projection.");const u=o.b9();return o.af(u),u}getVisibleUnwrappedCoordinates(s){return[new o.b1(0,s)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(s){s&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(s,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const m=Hi(s);o.aQ(m,m,1+u/o.bt);const v=o.bu();return o.av(v,[m[0],m[1],m[2],1],this._globeViewProjMatrixNoCorrection),v[2]/v[3]}populateCache(s){}getBounds(){const s=.5*this.width,u=.5*this.height,m=[new o.P(0,0),new o.P(s,0),new o.P(this.width,0),new o.P(this.width,u),new o.P(this.width,this.height),new o.P(s,this.height),new o.P(0,this.height),new o.P(0,u)],v=[];for(const Q of m)v.push(this.unprojectScreenPoint(Q));let w=0,P=0,D=0,F=0;const j=this.center;for(const Q of v){const K=o.bz(j.lng,Q.lng),oe=o.bz(j.lat,Q.lat);K<P&&(P=K),K>w&&(w=K),oe<F&&(F=oe),oe>D&&(D=oe)}const W=[j.lng+P,j.lat+F,j.lng+w,j.lat+D];return this.isSurfacePointOnScreen([0,1,0])&&(W[3]=90,W[0]=-180,W[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(W[1]=-90,W[0]=-180,W[2]=180),new hn(W)}getConstrained(s,u){const m=o.ag(s.lat,-o.ah,o.ah),v=o.ag(+u,this.minZoom+Si(0,m),this.maxZoom);return{center:new o.S(s.lng,m),zoom:v}}calculateCenterFromCameraLngLatAlt(s,u,m,v){return this._helper.calculateCenterFromCameraLngLatAlt(s,u,m,v)}setLocationAtPoint(s,u){const m=Hi(this.unprojectScreenPoint(u)),v=Hi(s),w=o.bo();o.bA(w);const P=o.bo();o.bx(P,m,w,-this.center.lng*Math.PI/180),o.bw(P,P,w,this.center.lat*Math.PI/180);const D=v[0]*v[0]+v[2]*v[2],F=P[0]*P[0];if(D<F)return;const j=Math.sqrt(D-F),W=-j,Q=o.bB(v[0],v[2],P[0],j),K=o.bB(v[0],v[2],P[0],W),oe=o.bo();o.bx(oe,v,w,-Q);const he=o.bB(oe[1],oe[2],P[1],P[2]),Pe=o.bo();o.bx(Pe,v,w,-K);const Ee=o.bB(Pe[1],Pe[2],P[1],P[2]),Ie=.5*Math.PI,Fe=he>=-Ie&&he<=Ie,He=Ee>=-Ie&&Ee<=Ie;let Be,Ye;if(Fe&&He){const yt=this.center.lng*Math.PI/180,ht=this.center.lat*Math.PI/180;o.bC(Q,yt)+o.bC(he,ht)<o.bC(K,yt)+o.bC(Ee,ht)?(Be=Q,Ye=he):(Be=K,Ye=Ee)}else if(Fe)Be=Q,Ye=he;else{if(!He)return;Be=K,Ye=Ee}const Ke=Be/Math.PI*180,$e=Ye/Math.PI*180,rt=this.center.lat;this.setCenter(new o.S(Ke,o.ag($e,-90,90))),this.setZoom(this.zoom+Si(rt,this.center.lat))}locationToScreenPoint(s,u){const m=Hi(s);if(u){const v=u.getElevationForLngLatZoom(s,this._helper._tileZoom);o.aQ(m,m,1+v/o.bt)}return this._projectSurfacePointToScreen(m)}_projectSurfacePointToScreen(s){const u=o.bu();return o.av(u,[...s,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new o.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(s,u){if(u){const m=u.pointCoordinate(s);if(m)return m}return o.a0.fromLngLat(this.unprojectScreenPoint(s))}screenPointToLocation(s,u){var m;return(m=this.screenPointToMercatorCoordinate(s,u))===null||m===void 0?void 0:m.toLngLat()}isPointOnMapSurface(s,u){const m=this._cameraPosition,v=this.getRayDirectionFromPixel(s);return!!this.rayPlanetIntersection(m,v)}getRayDirectionFromPixel(s){const u=o.bu();u[0]=s.x/this.width*2-1,u[1]=-1*(s.y/this.height*2-1),u[2]=1,u[3]=1,o.av(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const m=o.bo();m[0]=u[0]-this._cameraPosition[0],m[1]=u[1]-this._cameraPosition[1],m[2]=u[2]-this._cameraPosition[2];const v=o.bo();return o.aU(v,m),v}isSurfacePointVisible(s){const u=this._cachedClippingPlane;return u[0]*s[0]+u[1]*s[1]+u[2]*s[2]+u[3]>=0}isSurfacePointOnScreen(s){if(!this.isSurfacePointVisible(s))return!1;const u=o.bu();return o.av(u,[...s,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(s,u){const m=o.aW(s,u),v=o.bo(),w=o.bo();o.aQ(w,u,m),o.aT(v,s,w);const P=1-o.aW(v,v);if(P<0)return null;const D=o.aW(s,s)-1,F=-m+(m<0?1:-1)*Math.sqrt(P),j=D/F,W=F;return{tMin:Math.min(j,W),tMax:Math.max(j,W)}}unprojectScreenPoint(s){const u=this._cameraPosition,m=this.getRayDirectionFromPixel(s),v=this.rayPlanetIntersection(u,m);if(v){const W=o.bo();o.aR(W,u,[m[0]*v.tMin,m[1]*v.tMin,m[2]*v.tMin]);const Q=o.bo();return o.aU(Q,W),md(Q)}const w=this._cachedClippingPlane,P=w[0]*m[0]+w[1]*m[1]+w[2]*m[2],D=-o.b0(w,u)/P,F=o.bo();if(D>0)o.aR(F,u,[m[0]*D,m[1]*D,m[2]*D]);else{const W=o.bo();o.aR(W,u,[2*m[0],2*m[1],2*m[2]]);const Q=o.b0(this._cachedClippingPlane,W);o.aT(F,W,[this._cachedClippingPlane[0]*Q,this._cachedClippingPlane[1]*Q,this._cachedClippingPlane[2]*Q])}const j=function(W){const Q=o.bo();return Q[0]=W[0]*-W[3],Q[1]=W[1]*-W[3],Q[2]=W[2]*-W[3],{center:Q,radius:Math.sqrt(1-W[3]*W[3])}}(w);return md(function(W,Q,K){const oe=o.bo();o.aT(oe,K,W);const he=o.bo();return o.bp(he,W,oe,Q/o.a_(oe)),he}(j.center,j.radius,F))}getMatrixForModel(s,u){const m=o.S.convert(s),v=1/o.bt,w=o.b8();return o.by(w,w,m.lng/180*Math.PI),o.b6(w,w,-m.lat/180*Math.PI),o.M(w,w,[0,0,1+u/o.bt]),o.b6(w,w,.5*Math.PI),o.N(w,w,[v,v,v]),w}getProjectionDataForCustomLayer(s=!0){const u=this.getProjectionData({overscaledTileID:new o.Z(0,0,0,0,0),applyGlobeMatrix:s});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(s){}}class hs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(s){this._helper.setMinZoom(s)}setMaxZoom(s){this._helper.setMaxZoom(s)}setMinPitch(s){this._helper.setMinPitch(s)}setMaxPitch(s){this._helper.setMaxPitch(s)}setRenderWorldCopies(s){this._helper.setRenderWorldCopies(s)}setBearing(s){this._helper.setBearing(s)}setPitch(s){this._helper.setPitch(s)}setRoll(s){this._helper.setRoll(s)}setFov(s){this._helper.setFov(s)}setZoom(s){this._helper.setZoom(s)}setCenter(s){this._helper.setCenter(s)}setElevation(s){this._helper.setElevation(s)}setMinElevationForCurrentTile(s){this._helper.setMinElevationForCurrentTile(s)}setPadding(s){this._helper.setPadding(s)}interpolatePadding(s,u,m){return this._helper.interpolatePadding(s,u,m)}isPaddingEqual(s){return this._helper.isPaddingEqual(s)}resize(s,u,m=!0){this._helper.resize(s,u,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(s){this._helper.setMaxBounds(s)}overrideNearFarZ(s,u){this._helper.overrideNearFarZ(s,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(s){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),s)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(s,u){this._globeness=s,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new dd({calcMatrices:()=>{this._calcMatrices()},getConstrained:(s,u)=>this.getConstrained(s,u)}),this._globeness=1,this._mercatorTransform=new wi,this._verticalPerspectiveTransform=new Au}clone(){const s=new hs;return s._globeness=this._globeness,s._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,s.apply(this),s}apply(s){this._helper.apply(s),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(s){const u=this._mercatorTransform.getProjectionData(s),m=this._verticalPerspectiveTransform.getProjectionData(s);return{mainMatrix:this.isGlobeRendering?m.mainMatrix:u.mainMatrix,clippingPlane:m.clippingPlane,tileMercatorCoords:m.tileMercatorCoords,projectionTransition:s.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(s){return this.currentTransform.isLocationOccluded(s)}transformLightDirection(s){return this.currentTransform.transformLightDirection(s)}getPixelScale(){return o.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(s,u,m){const v=this._mercatorTransform.getPitchedTextCorrection(s,u,m),w=this._verticalPerspectiveTransform.getPitchedTextCorrection(s,u,m);return o.bj(v,w,this._globeness)}projectTileCoordinates(s,u,m,v){return this.currentTransform.projectTileCoordinates(s,u,m,v)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(s){return this.currentTransform.calculateFogMatrix(s)}getVisibleUnwrappedCoordinates(s){return this.currentTransform.getVisibleUnwrappedCoordinates(s)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(s){this._mercatorTransform.recalculateZoomAndCenter(s),this._verticalPerspectiveTransform.recalculateZoomAndCenter(s)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(s,u){return this.currentTransform.lngLatToCameraDepth(s,u)}populateCache(s){this._mercatorTransform.populateCache(s),this._verticalPerspectiveTransform.populateCache(s)}getBounds(){return this.currentTransform.getBounds()}getConstrained(s,u){return this.currentTransform.getConstrained(s,u)}calculateCenterFromCameraLngLatAlt(s,u,m,v){return this._helper.calculateCenterFromCameraLngLatAlt(s,u,m,v)}setLocationAtPoint(s,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(s,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(s,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(s,u){return this.currentTransform.locationToScreenPoint(s,u)}screenPointToMercatorCoordinate(s,u){return this.currentTransform.screenPointToMercatorCoordinate(s,u)}screenPointToLocation(s,u){return this.currentTransform.screenPointToLocation(s,u)}isPointOnMapSurface(s,u){return this.currentTransform.isPointOnMapSurface(s,u)}getRayDirectionFromPixel(s){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(s)}getMatrixForModel(s,u){return this.currentTransform.getMatrixForModel(s,u)}getProjectionDataForCustomLayer(s=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(s);if(!this.isGlobeRendering)return u;const m=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(s);return m.fallbackMatrix=u.mainMatrix,m}getFastPathSimpleProjectionMatrix(s){return this.currentTransform.getFastPathSimpleProjectionMatrix(s)}}class Ko{get useGlobeControls(){return!0}handlePanInertia(s,u){const m=gd(s,u);return Math.abs(m.lng-u.center.lng)>180&&(m.lng=u.center.lng+179.5*Math.sign(m.lng-u.center.lng)),{easingCenter:m,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(s,u){const m=s.around,v=u.screenPointToLocation(m);s.bearingDelta&&u.setBearing(u.bearing+s.bearingDelta),s.pitchDelta&&u.setPitch(u.pitch+s.pitchDelta),s.rollDelta&&u.setRoll(u.roll+s.rollDelta);const w=u.zoom;s.zoomDelta&&u.setZoom(u.zoom+s.zoomDelta);const P=u.zoom-w;if(P===0)return;const D=o.bz(u.center.lng,v.lng),F=D/(Math.abs(D/180)+1),j=o.bz(u.center.lat,v.lat),W=u.getRayDirectionFromPixel(m),Q=u.cameraPosition,K=-1*o.aW(Q,W),oe=o.bo();o.aR(oe,Q,[W[0]*K,W[1]*K,W[2]*K]);const he=o.aY(oe)-1,Pe=Math.exp(.5*-Math.max(he-.3,0)),Ee=Cu(u.worldSize,u.center.lat)/Math.min(u.width,u.height),Ie=o.bm(Ee,.9,.5,1,.25),Fe=(1-o.ae(-P))*Math.min(Pe,Ie),He=u.center.lat,Be=u.zoom,Ye=new o.S(u.center.lng+F*Fe,o.ag(u.center.lat+j*Fe,-o.ah,o.ah));u.setLocationAtPoint(v,m);const Ke=u.center,$e=o.bm(Math.abs(D),45,85,0,1),rt=o.bm(Ee,.75,.35,0,1),yt=Math.pow(Math.max($e,rt),.25),ht=o.bz(Ke.lng,Ye.lng),pt=o.bz(Ke.lat,Ye.lat);u.setCenter(new o.S(Ke.lng+ht*yt,Ke.lat+pt*yt).wrap()),u.setZoom(Be+Si(He,u.center.lat))}handleMapControlsPan(s,u,m){if(!s.panDelta)return;const v=u.center.lat,w=u.zoom;u.setCenter(gd(s.panDelta,u).wrap()),u.setZoom(w+Si(v,u.center.lat))}cameraForBoxAndBearing(s,u,m,v,w){const P=ei(s,u,m,v,w),D=u.left/w.width*2-1,F=(w.width-u.right)/w.width*2-1,j=u.top/w.height*-2+1,W=(w.height-u.bottom)/w.height*-2+1,Q=o.bz(m.getWest(),m.getEast())<0,K=Q?m.getEast():m.getWest(),oe=Q?m.getWest():m.getEast(),he=Math.max(m.getNorth(),m.getSouth()),Pe=Math.min(m.getNorth(),m.getSouth()),Ee=K+.5*o.bz(K,oe),Ie=he+.5*o.bz(he,Pe),Fe=w.clone();Fe.setCenter(P.center),Fe.setBearing(P.bearing),Fe.setPitch(0),Fe.setRoll(0),Fe.setZoom(P.zoom);const He=Fe.modelViewProjectionMatrix,Be=[Hi(m.getNorthWest()),Hi(m.getNorthEast()),Hi(m.getSouthWest()),Hi(m.getSouthEast()),Hi(new o.S(oe,Ie)),Hi(new o.S(K,Ie)),Hi(new o.S(Ee,he)),Hi(new o.S(Ee,Pe))],Ye=Hi(P.center);let Ke=Number.POSITIVE_INFINITY;for(const $e of Be)D<0&&(Ke=Ko.getLesserNonNegativeNonNull(Ke,Ko.solveVectorScale($e,Ye,He,"x",D))),F>0&&(Ke=Ko.getLesserNonNegativeNonNull(Ke,Ko.solveVectorScale($e,Ye,He,"x",F))),j>0&&(Ke=Ko.getLesserNonNegativeNonNull(Ke,Ko.solveVectorScale($e,Ye,He,"y",j))),W<0&&(Ke=Ko.getLesserNonNegativeNonNull(Ke,Ko.solveVectorScale($e,Ye,He,"y",W)));if(Number.isFinite(Ke)&&Ke!==0)return P.zoom=Fe.zoom+o.aj(Ke),P;yo()}handleJumpToCenterZoom(s,u){const m=s.center.lat,v=s.getConstrained(u.center?o.S.convert(u.center):s.center,s.zoom).center;s.setCenter(v.wrap());const w=u.zoom!==void 0?+u.zoom:s.zoom+Si(m,v.lat);s.zoom!==w&&s.setZoom(w)}handleEaseTo(s,u){const m=s.zoom,v=s.center,w=s.padding,P={roll:s.roll,pitch:s.pitch,bearing:s.bearing},D={roll:u.roll===void 0?s.roll:u.roll,pitch:u.pitch===void 0?s.pitch:u.pitch,bearing:u.bearing===void 0?s.bearing:u.bearing},F=u.zoom!==void 0,j=!s.isPaddingEqual(u.padding);let W=!1;const Q=u.center?o.S.convert(u.center):v,K=s.getConstrained(Q,m).center;al(s,K);const oe=s.clone();oe.setCenter(K),oe.setZoom(F?+u.zoom:m+Si(v.lat,Q.lat)),oe.setBearing(u.bearing);const he=new o.P(o.ag(s.centerPoint.x+u.offsetAsPoint.x,0,s.width),o.ag(s.centerPoint.y+u.offsetAsPoint.y,0,s.height));oe.setLocationAtPoint(K,he);const Pe=(u.offset&&u.offsetAsPoint.mag())>0?oe.center:K,Ee=F?+u.zoom:m+Si(v.lat,Pe.lat),Ie=m+Si(v.lat,0),Fe=Ee+Si(Pe.lat,0),He=o.bz(v.lng,Pe.lng),Be=o.bz(v.lat,Pe.lat),Ye=o.ae(Fe-Ie);return W=Ee!==m,{easeFunc:Ke=>{if(o.bd(P,D)||ji({startEulerAngles:P,endEulerAngles:D,tr:s,k:Ke,useSlerp:P.roll!=D.roll}),j&&s.interpolatePadding(w,u.padding,Ke),u.around)o.w("Easing around a point is not supported under globe projection."),s.setLocationAtPoint(u.around,u.aroundPoint);else{const $e=Fe>Ie?Math.min(2,Ye):Math.max(.5,Ye),rt=Math.pow($e,1-Ke),yt=Pu(v,He,Be,Ke*rt);s.setCenter(yt.wrap())}if(W){const $e=o.C.number(Ie,Fe,Ke)+Si(0,s.center.lat);s.setZoom($e)}},isZooming:W,elevationCenter:Pe}}handleFlyTo(s,u){const m=u.zoom!==void 0,v=s.center,w=s.zoom,P=s.padding,D=!s.isPaddingEqual(u.padding),F=s.getConstrained(o.S.convert(u.center||u.locationAtOffset),w).center,j=m?+u.zoom:s.zoom+Si(s.center.lat,F.lat),W=s.clone();W.setCenter(F),W.setZoom(j),W.setBearing(u.bearing);const Q=new o.P(o.ag(s.centerPoint.x+u.offsetAsPoint.x,0,s.width),o.ag(s.centerPoint.y+u.offsetAsPoint.y,0,s.height));W.setLocationAtPoint(F,Q);const K=W.center;al(s,K);const oe=function(Be,Ye,Ke){const $e=Hi(Ye),rt=Hi(Ke),yt=o.aW($e,rt),ht=Math.acos(yt),pt=pd(Be);return ht/(2*Math.PI)*pt}(s,v,K),he=w+Si(v.lat,0),Pe=j+Si(K.lat,0),Ee=o.ae(Pe-he);let Ie;if(typeof u.minZoom=="number"){const Be=+u.minZoom+Si(K.lat,0),Ye=Math.min(Be,he,Pe)+Si(0,K.lat),Ke=s.getConstrained(K,Ye).zoom+Si(K.lat,0);Ie=o.ae(Ke-he)}const Fe=o.bz(v.lng,K.lng),He=o.bz(v.lat,K.lat);return{easeFunc:(Be,Ye,Ke,$e)=>{const rt=Pu(v,Fe,He,Ke);D&&s.interpolatePadding(P,u.padding,Be);const yt=Be===1?K:rt;s.setCenter(yt.wrap());const ht=he+o.aj(Ye);s.setZoom(Be===1?j:ht+Si(0,yt.lat))},scaleOfZoom:Ee,targetCenter:K,scaleOfMinZoom:Ie,pixelPathLength:oe}}static solveVectorScale(s,u,m,v,w){const P=v==="x"?[m[0],m[4],m[8],m[12]]:[m[1],m[5],m[9],m[13]],D=[m[3],m[7],m[11],m[15]],F=s[0]*P[0]+s[1]*P[1]+s[2]*P[2],j=s[0]*D[0]+s[1]*D[1]+s[2]*D[2],W=u[0]*P[0]+u[1]*P[1]+u[2]*P[2],Q=u[0]*D[0]+u[1]*D[1]+u[2]*D[2];return W+w*j===F+w*Q||D[3]*(F-W)+P[3]*(Q-j)+F*Q==W*j?null:(W+P[3]-w*Q-w*D[3])/(W-F-w*Q+w*j)}static getLesserNonNegativeNonNull(s,u){return u!==null&&u>=0&&u<s?u:s}}class iv{constructor(s){this._globe=s,this._mercatorCameraHelper=new Jf,this._verticalPerspectiveCameraHelper=new Ko}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(s,u){return this.currentHelper.handlePanInertia(s,u)}handleMapControlsRollPitchBearingZoom(s,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(s,u)}handleMapControlsPan(s,u,m){this.currentHelper.handleMapControlsPan(s,u,m)}cameraForBoxAndBearing(s,u,m,v,w){return this.currentHelper.cameraForBoxAndBearing(s,u,m,v,w)}handleJumpToCenterZoom(s,u){this.currentHelper.handleJumpToCenterZoom(s,u)}handleEaseTo(s,u){return this.currentHelper.handleEaseTo(s,u)}handleFlyTo(s,u){return this.currentHelper.handleFlyTo(s,u)}}const yd=(b,s)=>o.y(b,s&&s.filter(u=>u.identifier!=="source.canvas")),Iu=o.bD();class ov extends o.E{constructor(s,u={}){super(),this._rtlPluginLoaded=()=>{for(const m in this.sourceCaches){const v=this.sourceCaches[m].getSource().type;v!=="vector"&&v!=="geojson"||this.sourceCaches[m].reload()}},this.map=s,this.dispatcher=new Ot(lt(),s._getMapId()),this.dispatcher.registerMessageHandler("GG",(m,v)=>this.getGlyphs(m,v)),this.dispatcher.registerMessageHandler("GI",(m,v)=>this.getImages(m,v)),this.imageManager=new Y,this.imageManager.setEventedParent(this),this.glyphManager=new ge(s._requestManager,u.localIdeographFontFamily),this.lineAtlas=new Ue(256,512),this.crossTileSymbolIndex=new Ri,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",o.bF()),Zt().on(St,this._rtlPluginLoaded),this.on("data",m=>{if(m.dataType!=="source"||m.sourceDataType!=="metadata")return;const v=this.sourceCaches[m.sourceId];if(!v)return;const w=v.getSource();if(w&&w.vectorLayerIds)for(const P in this._layers){const D=this._layers[P];D.source===w.id&&this._validateLayer(D)}})}setGlobalStateProperty(s,u){var m,v,w;this._checkLoaded();const P=u===null?(w=(v=(m=this.stylesheet.state)===null||m===void 0?void 0:m[s])===null||v===void 0?void 0:v.default)!==null&&w!==void 0?w:null:u;if(o.bG(P,this._globalState[s]))return this;this._globalState[s]=P;const D=this._findGlobalStateAffectedSources([s]);for(const F in this.sourceCaches)D.has(F)&&(this._reloadSource(F),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(s){this._checkLoaded();const u=[];for(const v in s)!o.bG(this._globalState[v],s[v].default)&&(u.push(v),this._globalState[v]=s[v].default);const m=this._findGlobalStateAffectedSources(u);for(const v in this.sourceCaches)m.has(v)&&(this._reloadSource(v),this._changed=!0)}_findGlobalStateAffectedSources(s){if(s.length===0)return new Set;const u=new Set;for(const m in this._layers){const v=this._layers[m],w=v.getLayoutAffectingGlobalStateRefs();for(const P of s)w.has(P)&&u.add(v.source)}return u}loadURL(s,u={},m){this.fire(new o.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const v=this.map._requestManager.transformRequest(s,"Style");this._loadStyleRequest=new AbortController;const w=this._loadStyleRequest;o.j(v,this._loadStyleRequest).then(P=>{this._loadStyleRequest=null,this._load(P.data,u,m)}).catch(P=>{this._loadStyleRequest=null,P&&!w.signal.aborted&&this.fire(new o.k(P))})}loadJSON(s,u={},m){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,M.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(s,u,m)}).catch(()=>{})}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(Iu,{validate:!1})}_load(s,u,m){var v,w,P;const D=u.transformStyle?u.transformStyle(m,s):s;if(!u.validate||!yd(this,o.z(D))){this._loaded=!0,this.stylesheet=D;for(const F in D.sources)this.addSource(F,D.sources[F],{validate:!1});D.sprite?this._loadSprite(D.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(D.glyphs),this._createLayers(),this.light=new ve(this.stylesheet.light),this._setProjectionInternal(((v=this.stylesheet.projection)===null||v===void 0?void 0:v.type)||"mercator"),this.sky=new Me(this.stylesheet.sky),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.setGlobalState((P=this.stylesheet.state)!==null&&P!==void 0?P:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){const s=o.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",s),this._order=s.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of s){const m=o.bI(u);m.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=m}}_loadSprite(s,u=!1,m=void 0){let v;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(w,P,D,F){return o._(this,void 0,void 0,function*(){const j=V(w),W=D>1?"@2x":"",Q={},K={};for(const{id:oe,url:he}of j){const Pe=P.transformRequest(q(he,W,".json"),"SpriteJSON");Q[oe]=o.j(Pe,F);const Ee=P.transformRequest(q(he,W,".png"),"SpriteImage");K[oe]=U.getImage(Ee,F)}return yield Promise.all([...Object.values(Q),...Object.values(K)]),function(oe,he){return o._(this,void 0,void 0,function*(){const Pe={};for(const Ee in oe){Pe[Ee]={};const Ie=M.getImageCanvasContext((yield he[Ee]).data),Fe=(yield oe[Ee]).data;for(const He in Fe){const{width:Be,height:Ye,x:Ke,y:$e,sdf:rt,pixelRatio:yt,stretchX:ht,stretchY:pt,content:_t,textFitWidth:sn,textFitHeight:rn}=Fe[He];Pe[Ee][He]={data:null,pixelRatio:yt,sdf:rt,stretchX:ht,stretchY:pt,content:_t,textFitWidth:sn,textFitHeight:rn,spriteData:{width:Be,height:Ye,x:Ke,y:$e,context:Ie}}}}return Pe})}(Q,K)})}(s,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(w=>{if(this._spriteRequest=null,w)for(const P in w){this._spritesImagesIds[P]=[];const D=this._spritesImagesIds[P]?this._spritesImagesIds[P].filter(F=>!(F in w)):[];for(const F of D)this.imageManager.removeImage(F),this._changedImages[F]=!0;for(const F in w[P]){const j=P==="default"?F:`${P}:${F}`;this._spritesImagesIds[P].push(j),j in this.imageManager.images?this.imageManager.updateImage(j,w[P][F],!1):this.imageManager.addImage(j,w[P][F]),u&&(this._changedImages[j]=!0)}}}).catch(w=>{this._spriteRequest=null,v=w,this.fire(new o.k(v))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),m&&m(v)})}_unloadSprite(){for(const s of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(s),this._changedImages[s]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(s){const u=this.sourceCaches[s.source];if(!u)return;const m=s.sourceLayer;if(!m)return;const v=u.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(m)===-1)&&this.fire(new o.k(new Error(`Source layer "${m}" does not exist on source "${v.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(s,u=!1){const m=this._serializedAllLayers();if(!s||s.length===0)return Object.values(u?o.bJ(m):m);const v=[];for(const w of s)if(m[w]){const P=u?o.bJ(m[w]):m[w];v.push(P)}return v}_serializedAllLayers(){let s=this._serializedLayers;if(s)return s;s=this._serializedLayers={};const u=Object.keys(this._layers);for(const m of u){const v=this._layers[m];v.type!=="custom"&&(s[m]=v.serialize())}return s}hasTransitions(){var s,u,m;if(!((s=this.light)===null||s===void 0)&&s.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((m=this.projection)===null||m===void 0)&&m.hasTransition())return!0;for(const v in this.sourceCaches)if(this.sourceCaches[v].hasTransition())return!0;for(const v in this._layers)if(this._layers[v].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;const u=this._changed;if(u){const v=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(v.length||w.length)&&this._updateWorkerLayers(v,w);for(const P in this._updatedSources){const D=this._updatedSources[P];if(D==="reload")this._reloadSource(P);else{if(D!=="clear")throw new Error(`Invalid action ${D}`);this._clearSource(P)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(s);this.light.updateTransitions(s),this.sky.updateTransitions(s),this._resetUpdates()}const m={};for(const v in this.sourceCaches){const w=this.sourceCaches[v];m[v]=w.used,w.used=!1}for(const v of this._order){const w=this._layers[v];w.recalculate(s,this._availableImages),!w.isHidden(s.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const v in m){const w=this.sourceCaches[v];!!m[v]!=!!w.used&&w.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(s),this.sky.recalculate(s),this.projection.recalculate(s),this.z=s.zoom,u&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(s,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(s,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(s,u={}){var m;this._checkLoaded();const v=this.serialize();if(s=u.transformStyle?u.transformStyle(v,s):s,((m=u.validate)===null||m===void 0||m)&&yd(this,o.z(s)))return!1;(s=o.bJ(s)).layers=o.bH(s.layers);const w=o.bK(v,s),P=this._getOperationsToPerform(w);if(P.unimplemented.length>0)throw new Error(`Unimplemented: ${P.unimplemented.join(", ")}.`);if(P.operations.length===0)return!1;for(const D of P.operations)D();return this.stylesheet=s,this._serializedLayers=null,!0}_getOperationsToPerform(s){const u=[],m=[];for(const v of s)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,v.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,v.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,v.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,v.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,v.args));break;case"addSource":u.push(()=>this.addSource.apply(this,v.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,v.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,v.args));break;case"setLight":u.push(()=>this.setLight.apply(this,v.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,v.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,v.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,v.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,v.args));break;case"setSky":u.push(()=>this.setSky.apply(this,v.args));break;case"setProjection":this.setProjection.apply(this,v.args);break;case"setGlobalState":u.push(()=>this.setGlobalState.apply(this,v.args));break;case"setTransition":u.push(()=>{});break;default:m.push(v.command)}return{operations:u,unimplemented:m}}addImage(s,u){if(this.getImage(s))return this.fire(new o.k(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,u),this._afterImageUpdated(s)}updateImage(s,u){this.imageManager.updateImage(s,u)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new o.k(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,u,m={}){if(this._checkLoaded(),this.sourceCaches[s]!==void 0)throw new Error(`Source "${s}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(o.z.source,`sources.${s}`,u,null,m))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const v=this.sourceCaches[s]=new Je(s,u,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:s})),v.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error("There is no source with this ID");for(const m in this._layers)if(this._layers[m].source===s)return this.fire(new o.k(new Error(`Source "${s}" cannot be removed while layer "${m}" is using it.`)));const u=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],u.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,u){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error(`There is no source with this ID=${s}`);const m=this.sourceCaches[s].getSource();if(m.type!=="geojson")throw new Error(`geojsonSource.type is ${m.type}, which is !== 'geojson`);m.setData(u),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,u,m={}){this._checkLoaded();const v=s.id;if(this.getLayer(v))return void this.fire(new o.k(new Error(`Layer "${v}" already exists on this map.`)));let w;if(s.type==="custom"){if(yd(this,o.bL(s)))return;w=o.bI(s)}else{if("source"in s&&typeof s.source=="object"&&(this.addSource(v,s.source),s=o.bJ(s),s=o.e(s,{source:v})),this._validate(o.z.layer,`layers.${v}`,s,{arrayIndex:-1},m))return;w=o.bI(s),this._validateLayer(w),w.setEventedParent(this,{layer:{id:v}})}const P=u?this._order.indexOf(u):this._order.length;if(u&&P===-1)this.fire(new o.k(new Error(`Cannot add layer "${v}" before non-existing layer "${u}".`)));else{if(this._order.splice(P,0,v),this._layerOrderChanged=!0,this._layers[v]=w,this._removedLayers[v]&&w.source&&w.type!=="custom"){const D=this._removedLayers[v];delete this._removedLayers[v],D.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(s,u){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new o.k(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===u)return;const m=this._order.indexOf(s);this._order.splice(m,1);const v=u?this._order.indexOf(u):this._order.length;u&&v===-1?this.fire(new o.k(new Error(`Cannot move layer "${s}" before non-existing layer "${u}".`))):(this._order.splice(v,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();const u=this._layers[s];if(!u)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${s}".`)));u.setEventedParent(null);const m=this._order.indexOf(s);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=u,delete this._layers[s],this._serializedLayers&&delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],u.onRemove&&u.onRemove(this.map)}getLayer(s){return this._layers[s]}getLayersOrder(){return[...this._order]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,u,m){this._checkLoaded();const v=this.getLayer(s);v?v.minzoom===u&&v.maxzoom===m||(u!=null&&(v.minzoom=u),m!=null&&(v.maxzoom=m),this._updateLayer(v)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,u,m={}){this._checkLoaded();const v=this.getLayer(s);if(v){if(!o.bG(v.filter,u))return u==null?(v.setFilter(void 0),void this._updateLayer(v)):void(this._validate(o.z.filter,`layers.${v.id}.filter`,u,null,m)||(v.setFilter(o.bJ(u)),this._updateLayer(v)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return o.bJ(this.getLayer(s).filter)}setLayoutProperty(s,u,m,v={}){this._checkLoaded();const w=this.getLayer(s);w?o.bG(w.getLayoutProperty(u),m)||(w.setLayoutProperty(u,m,v),this._updateLayer(w)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,u){const m=this.getLayer(s);if(m)return m.getLayoutProperty(u);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,u,m,v={}){this._checkLoaded();const w=this.getLayer(s);w?o.bG(w.getPaintProperty(u),m)||(w.setPaintProperty(u,m,v)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[s]=!0,this._serializedLayers=null):this.fire(new o.k(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,u){return this.getLayer(s).getPaintProperty(u)}setFeatureState(s,u){this._checkLoaded();const m=s.source,v=s.sourceLayer,w=this.sourceCaches[m];if(w===void 0)return void this.fire(new o.k(new Error(`The source '${m}' does not exist in the map's style.`)));const P=w.getSource().type;P==="geojson"&&v?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||v?(s.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),w.setFeatureState(v,s.id,u)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,u){this._checkLoaded();const m=s.source,v=this.sourceCaches[m];if(v===void 0)return void this.fire(new o.k(new Error(`The source '${m}' does not exist in the map's style.`)));const w=v.getSource().type,P=w==="vector"?s.sourceLayer:void 0;w!=="vector"||P?u&&typeof s.id!="string"&&typeof s.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(P,s.id,u):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();const u=s.source,m=s.sourceLayer,v=this.sourceCaches[u];if(v!==void 0)return v.getSource().type!=="vector"||m?(s.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),v.getFeatureState(m,s.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const s=o.bM(this.sourceCaches,w=>w.serialize()),u=this._serializeByIds(this._order,!0),m=this.map.getTerrain()||void 0,v=this.stylesheet;return o.bN({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,projection:v.projection,sources:s,layers:u,terrain:m},w=>w!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&this.sourceCaches[s.source].getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(s){const u=P=>this._layers[P].type==="fill-extrusion",m={},v=[];for(let P=this._order.length-1;P>=0;P--){const D=this._order[P];if(u(D)){m[D]=P;for(const F of s){const j=F[D];if(j)for(const W of j)v.push(W)}}}v.sort((P,D)=>D.intersectionZ-P.intersectionZ);const w=[];for(let P=this._order.length-1;P>=0;P--){const D=this._order[P];if(u(D))for(let F=v.length-1;F>=0;F--){const j=v[F].feature;if(m[j.layer.id]<P)break;w.push(j),v.pop()}else for(const F of s){const j=F[D];if(j)for(const W of j)w.push(W.feature)}}return w}queryRenderedFeatures(s,u,m){u&&u.filter&&this._validate(o.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const v={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const j of u.layers){const W=this._layers[j];if(!W)return this.fire(new o.k(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];v[W.source]=!0}}const w=[];u.availableImages=this._availableImages;const P=this._serializedAllLayers(),D=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,F=Object.assign(Object.assign({},u),{layers:D});for(const j in this.sourceCaches)u.layers&&!v[j]||w.push(Tt(this.sourceCaches[j],this._layers,P,s,F,m,this.map.terrain?(W,Q,K)=>this.map.terrain.getElevation(W,Q,K):void 0));return this.placement&&w.push(function(j,W,Q,K,oe,he,Pe){const Ee={},Ie=he.queryRenderedSymbols(K),Fe=[];for(const He of Object.keys(Ie).map(Number))Fe.push(Pe[He]);Fe.sort(Ct);for(const He of Fe){const Be=He.featureIndex.lookupSymbolFeatures(Ie[He.bucketInstanceId],W,He.bucketIndex,He.sourceLayerIndex,oe.filter,oe.layers,oe.availableImages,j);for(const Ye in Be){const Ke=Ee[Ye]=Ee[Ye]||[],$e=Be[Ye];$e.sort((rt,yt)=>{const ht=He.featureSortOrder;if(ht){const pt=ht.indexOf(rt.featureIndex);return ht.indexOf(yt.featureIndex)-pt}return yt.featureIndex-rt.featureIndex});for(const rt of $e)Ke.push(rt)}}return function(He,Be,Ye){for(const Ke in He)for(const $e of He[Ke])un($e,Ye[Be[Ke].source]);return He}(Ee,j,Q)}(this._layers,P,this.sourceCaches,s,F,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(s,u){u&&u.filter&&this._validate(o.z.filter,"querySourceFeatures.filter",u.filter,null,u);const m=this.sourceCaches[s];return m?function(v,w){const P=v.getRenderableIds().map(j=>v.getTileByID(j)),D=[],F={};for(let j=0;j<P.length;j++){const W=P[j],Q=W.tileID.canonical.key;F[Q]||(F[Q]=!0,W.querySourceFeatures(D,w))}return D}(m,u):[]}getLight(){return this.light.getLight()}setLight(s,u={}){this._checkLoaded();const m=this.light.getLight();let v=!1;for(const P in s)if(!o.bG(s[P],m[P])){v=!0;break}if(!v)return;const w={now:M.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,u),this.light.updateTransitions(w)}getProjection(){var s;return(s=this.stylesheet)===null||s===void 0?void 0:s.projection}setProjection(s){if(this._checkLoaded(),this.projection){if(this.projection.name===s.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=s,this._setProjectionInternal(s.type)}getSky(){var s;return(s=this.stylesheet)===null||s===void 0?void 0:s.sky}setSky(s,u={}){this._checkLoaded();const m=this.getSky();let v=!1;if(!s&&!m)return;if(s&&!m)v=!0;else if(!s&&m)v=!0;else for(const P in s)if(!o.bG(s[P],m[P])){v=!0;break}if(!v)return;const w={now:M.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=s,this.sky.setSky(s,u),this.sky.updateTransitions(w)}_setProjectionInternal(s){const u=function(m){if(Array.isArray(m)){const v=new fd({type:m});return{projection:v,transform:new hs,cameraHelper:new iv(v)}}switch(m){case"mercator":return{projection:new ev,transform:new wi,cameraHelper:new Jf};case"globe":{const v=new fd({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:v,transform:new hs,cameraHelper:new iv(v)}}case"vertical-perspective":return{projection:new wx,transform:new Au,cameraHelper:new Ko};default:return o.w(`Unknown projection name: ${m}. Falling back to mercator projection.`),{projection:new ev,transform:new wi,cameraHelper:new Jf}}}(s);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const m in this.sourceCaches)this.sourceCaches[m].reload()}_validate(s,u,m,v,w={}){return(!w||w.validate!==!1)&&yd(this,s.call(o.z,o.e({key:u,style:this.serialize(),value:m,styleSpec:o.v},v)))}_remove(s=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Zt().off(St,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const m=this.sourceCaches[u];m.setEventedParent(null),m.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),s&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(s)}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(const u in this.sourceCaches)this.sourceCaches[u].update(s,this.map.terrain)}_generateCollisionBoxes(){for(const s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,u,m,v,w=!1){let P=!1,D=!1;const F={};for(const j of this._order){const W=this._layers[j];if(W.type!=="symbol")continue;if(!F[W.source]){const K=this.sourceCaches[W.source];F[W.source]=K.getRenderableIds(!0).map(oe=>K.getTileByID(oe)).sort((oe,he)=>he.tileID.overscaledZ-oe.tileID.overscaledZ||(oe.tileID.isLessThan(he.tileID)?-1:1))}const Q=this.crossTileSymbolIndex.addLayer(W,F[W.source],s.center.lng);P=P||Q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(M.now(),s.zoom))&&(this.pauseablePlacement=new Fl(s,this.map.terrain,this._order,w,u,m,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(M.now()),D=!0),P&&this.pauseablePlacement.placement.setStale()),D||P)for(const j of this._order){const W=this._layers[j];W.type==="symbol"&&this.placement.updateLayerOpacities(W,F[W.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(M.now())}_releaseSymbolFadeTiles(){for(const s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,u){return o._(this,void 0,void 0,function*(){const m=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const v=this.sourceCaches[u.source];return v&&v.setDependencies(u.tileID.key,u.type,u.icons),m})}getGlyphs(s,u){return o._(this,void 0,void 0,function*(){const m=yield this.glyphManager.getGlyphs(u.stacks),v=this.sourceCaches[u.source];return v&&v.setDependencies(u.tileID.key,u.type,[""]),m})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(s,u={}){this._checkLoaded(),s&&this._validate(o.z.glyphs,"glyphs",s,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=s,this.glyphManager.entries={},this.glyphManager.setURL(s))}addSprite(s,u,m={},v){this._checkLoaded();const w=[{id:s,url:u}],P=[...V(this.stylesheet.sprite),...w];this._validate(o.z.sprite,"sprite",P,null,m)||(this.stylesheet.sprite=P,this._loadSprite(w,!0,v))}removeSprite(s){this._checkLoaded();const u=V(this.stylesheet.sprite);if(u.find(m=>m.id===s)){if(this._spritesImagesIds[s])for(const m of this._spritesImagesIds[s])this.imageManager.removeImage(m),this._changedImages[m]=!0;u.splice(u.findIndex(m=>m.id===s),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[s],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${s}" doesn't exists on this map.`)))}getSprite(){return V(this.stylesheet.sprite)}setSprite(s,u={},m){this._checkLoaded(),s&&this._validate(o.z.sprite,"sprite",s,null,u)||(this.stylesheet.sprite=s,s?this._loadSprite(s,!0,m):(this._unloadSprite(),m&&m(null)))}}var I2=o.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class R2{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,u,m,v,w,P,D,F,j){this.context=s;let W=this.boundPaintVertexBuffers.length!==v.length;for(let Q=0;!W&&Q<v.length;Q++)this.boundPaintVertexBuffers[Q]!==v[Q]&&(W=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==m||W||this.boundIndexBuffer!==w||this.boundVertexOffset!==P||this.boundDynamicVertexBuffer!==D||this.boundDynamicVertexBuffer2!==F||this.boundDynamicVertexBuffer3!==j?this.freshBind(u,m,v,w,P,D,F,j):(s.bindVertexArray.set(this.vao),D&&D.bind(),w&&w.dynamicDraw&&w.bind(),F&&F.bind(),j&&j.bind())}freshBind(s,u,m,v,w,P,D,F){const j=s.numAttributes,W=this.context,Q=W.gl;this.vao&&this.destroy(),this.vao=W.createVertexArray(),W.bindVertexArray.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=v,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=D,this.boundDynamicVertexBuffer3=F,u.enableAttributes(Q,s);for(const K of m)K.enableAttributes(Q,s);P&&P.enableAttributes(Q,s),D&&D.enableAttributes(Q,s),F&&F.enableAttributes(Q,s),u.bind(),u.setVertexAttribPointers(Q,s,w);for(const K of m)K.bind(),K.setVertexAttribPointers(Q,s,w);P&&(P.bind(),P.setVertexAttribPointers(Q,s,w)),v&&v.bind(),D&&(D.bind(),D.setVertexAttribPointers(Q,s,w)),F&&(F.bind(),F.setVertexAttribPointers(Q,s,w)),W.currentNumAttributes=j}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const L2=(b,s,u,m,v)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:s,u_fog_color:u?u.properties.get("fog-color"):o.be.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:v?0:u?u.calculateFogBlendOpacity(m):0,u_horizon_color:u?u.properties.get("horizon-color"):o.be.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:v?1:0}),k2={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Qf(b){const s=[];for(let u=0;u<b.length;u++){if(b[u]===null)continue;const m=b[u].split(" ");s.push(m.pop())}return s}class ep{constructor(s,u,m,v,w,P,D,F,j=[]){const W=s.gl;this.program=W.createProgram();const Q=Qf(u.staticAttributes),K=m?m.getBinderAttributes():[],oe=Q.concat(K),he=Vi.prelude.staticUniforms?Qf(Vi.prelude.staticUniforms):[],Pe=D.staticUniforms?Qf(D.staticUniforms):[],Ee=u.staticUniforms?Qf(u.staticUniforms):[],Ie=m?m.getBinderUniforms():[],Fe=he.concat(Pe).concat(Ee).concat(Ie),He=[];for(const ht of Fe)He.indexOf(ht)<0&&He.push(ht);const Be=m?m.defines():[];Ro(W)&&Be.unshift("#version 300 es"),w&&Be.push("#define OVERDRAW_INSPECTOR;"),P&&Be.push("#define TERRAIN3D;"),F&&Be.push(F),j&&Be.push(...j);let Ye=Be.concat(Vi.prelude.fragmentSource,D.fragmentSource,u.fragmentSource).join(`
`),Ke=Be.concat(Vi.prelude.vertexSource,D.vertexSource,u.vertexSource).join(`
`);Ro(W)||(Ye=function(ht){return ht.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Ye),Ke=function(ht){return ht.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Ke));const $e=W.createShader(W.FRAGMENT_SHADER);if(W.isContextLost())return void(this.failedToCreate=!0);if(W.shaderSource($e,Ye),W.compileShader($e),!W.getShaderParameter($e,W.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${W.getShaderInfoLog($e)}`);W.attachShader(this.program,$e);const rt=W.createShader(W.VERTEX_SHADER);if(W.isContextLost())return void(this.failedToCreate=!0);if(W.shaderSource(rt,Ke),W.compileShader(rt),!W.getShaderParameter(rt,W.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${W.getShaderInfoLog(rt)}`);W.attachShader(this.program,rt),this.attributes={};const yt={};this.numAttributes=oe.length;for(let ht=0;ht<this.numAttributes;ht++)oe[ht]&&(W.bindAttribLocation(this.program,ht,oe[ht]),this.attributes[oe[ht]]=ht);if(W.linkProgram(this.program),!W.getProgramParameter(this.program,W.LINK_STATUS))throw new Error(`Program failed to link: ${W.getProgramInfoLog(this.program)}`);W.deleteShader(rt),W.deleteShader($e);for(let ht=0;ht<He.length;ht++){const pt=He[ht];if(pt&&!yt[pt]){const _t=W.getUniformLocation(this.program,pt);_t&&(yt[pt]=_t)}}this.fixedUniforms=v(s,yt),this.terrainUniforms=((ht,pt)=>({u_depth:new o.bO(ht,pt.u_depth),u_terrain:new o.bO(ht,pt.u_terrain),u_terrain_dim:new o.bf(ht,pt.u_terrain_dim),u_terrain_matrix:new o.bQ(ht,pt.u_terrain_matrix),u_terrain_unpack:new o.bR(ht,pt.u_terrain_unpack),u_terrain_exaggeration:new o.bf(ht,pt.u_terrain_exaggeration)}))(s,yt),this.projectionUniforms=((ht,pt)=>({u_projection_matrix:new o.bQ(ht,pt.u_projection_matrix),u_projection_tile_mercator_coords:new o.bR(ht,pt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.bR(ht,pt.u_projection_clipping_plane),u_projection_transition:new o.bf(ht,pt.u_projection_transition),u_projection_fallback_matrix:new o.bQ(ht,pt.u_projection_fallback_matrix)}))(s,yt),this.binderUniforms=m?m.getUniforms(s,yt):[]}draw(s,u,m,v,w,P,D,F,j,W,Q,K,oe,he,Pe,Ee,Ie,Fe,He){const Be=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(m),s.setStencilMode(v),s.setColorMode(w),s.setCullFace(P),F){s.activeTexture.set(Be.TEXTURE2),Be.bindTexture(Be.TEXTURE_2D,F.depthTexture),s.activeTexture.set(Be.TEXTURE3),Be.bindTexture(Be.TEXTURE_2D,F.texture);for(const Ke in this.terrainUniforms)this.terrainUniforms[Ke].set(F[Ke])}if(j)for(const Ke in j)this.projectionUniforms[k2[Ke]].set(j[Ke]);if(D)for(const Ke in this.fixedUniforms)this.fixedUniforms[Ke].set(D[Ke]);Ee&&Ee.setUniforms(s,this.binderUniforms,he,{zoom:Pe});let Ye=0;switch(u){case Be.LINES:Ye=2;break;case Be.TRIANGLES:Ye=3;break;case Be.LINE_STRIP:Ye=1}for(const Ke of oe.get()){const $e=Ke.vaos||(Ke.vaos={});($e[W]||($e[W]=new R2)).bind(s,this,Q,Ee?Ee.getPaintVertexBuffers():[],K,Ke.vertexOffset,Ie,Fe,He),Be.drawElements(u,Ke.primitiveLength*Ye,Be.UNSIGNED_SHORT,Ke.primitiveOffset*Ye*2)}}}function tp(b,s,u){const m=1/o.aB(u,1,s.transform.tileZoom),v=Math.pow(2,u.tileID.overscaledZ),w=u.tileSize*Math.pow(2,s.transform.tileZoom)/v,P=w*(u.tileID.canonical.x+u.tileID.wrap*v),D=w*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[m,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[P>>16,D>>16],u_pixel_coord_lower:[65535&P,65535&D]}}const _d=(b,s,u,m)=>{const v=b.style.light,w=v.properties.get("position"),P=[w.x,w.y,w.z],D=o.bU();v.properties.get("anchor")==="viewport"&&o.bV(D,b.transform.bearingInRadians),o.bW(P,P,D);const F=b.transform.transformLightDirection(P),j=v.properties.get("color");return{u_lightpos:P,u_lightpos_globe:F,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[j.r,j.g,j.b],u_vertical_gradient:+s,u_opacity:u,u_fill_translate:m}},sv=(b,s,u,m,v,w,P)=>o.e(_d(b,s,u,m),tp(w,b,P),{u_height_factor:-Math.pow(2,v.overscaledZ)/P.tileSize/8}),np=(b,s,u,m)=>o.e(tp(s,b,u),{u_fill_translate:m}),La=(b,s)=>({u_world:b,u_fill_translate:s}),D2=(b,s,u,m,v)=>o.e(np(b,s,u,v),{u_world:m}),av=(b,s,u,m,v)=>{const w=b.transform;let P,D,F=0;if(u.paint.get("circle-pitch-alignment")==="map"){const j=o.aB(s,1,w.zoom);P=!0,D=[j,j],F=j/(o.$*Math.pow(2,s.tileID.overscaledZ))*2*Math.PI*v}else P=!1,D=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+P,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:D,u_globe_extrude_scale:F,u_translate:m}},xd=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),bd=b=>({u_viewport_size:[b.width,b.height]}),Mx=(b,s=1)=>({u_color:b,u_overlay:0,u_overlay_scale:s}),wd=(b,s,u,m)=>{const v=o.aB(b,1,s)/(o.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*m;return{u_extrude_scale:o.aB(b,1,s),u_intensity:u,u_globe_extrude_scale:v}},Cx=(b,s,u,m)=>{const v=o.L();o.bX(v,0,b.width,b.height,0,0,1);const w=b.context.gl;return{u_matrix:v,u_world:[w.drawingBufferWidth,w.drawingBufferHeight],u_image:u,u_color_ramp:m,u_opacity:s.paint.get("heatmap-opacity")}},Ru=(b,s,u)=>{const m=u.paint.get("hillshade-accent-color");let v;switch(u.paint.get("hillshade-method")){case"basic":v=4;break;case"combined":v=1;break;case"igor":v=2;break;case"multidirectional":v=3;break;default:v=0}const w=u.getIlluminationProperties();for(let P=0;P<w.directionRadians.length;P++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(w.directionRadians[P]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:Ex(0,s.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:w.altitudeRadians,u_azimuths:w.directionRadians,u_accent:m,u_method:v,u_highlights:w.highlightColor,u_shadows:w.shadowColor}},z2=(b,s)=>{const u=s.stride,m=o.L();return o.bX(m,0,o.$,-o.$,0,0,1),o.M(m,m,[0,-o.$,0]),{u_matrix:m,u_image:1,u_dimension:[u,u],u_zoom:b.overscaledZ,u_unpack:s.getUnpackVector()}};function Ex(b,s){const u=Math.pow(2,s.canonical.z),m=s.canonical.y;return[new o.a0(0,m/u).toLngLat().lat,new o.a0(0,(m+1)/u).toLngLat().lat]}const O2=(b,s,u=0)=>({u_image:0,u_unpack:s.getUnpackVector(),u_dimension:[s.stride,s.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:b.paint.get("color-relief-opacity")}),rp=(b,s,u,m)=>{const v=b.transform;return{u_translation:uv(b,s,u),u_ratio:m/o.aB(s,1,v.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},lv=(b,s,u,m,v)=>o.e(rp(b,s,u,m),{u_image:0,u_image_height:v}),Tx=(b,s,u,m,v)=>{const w=b.transform,P=cv(s,w);return{u_translation:uv(b,s,u),u_texsize:s.imageAtlasTexture.size,u_ratio:m/o.aB(s,1,w.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[P,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},Px=(b,s,u,m,v,w)=>{const P=b.lineAtlas,D=cv(s,b.transform),F=u.layout.get("line-cap")==="round",j=P.getDash(v.from,F),W=P.getDash(v.to,F),Q=j.width*w.fromScale,K=W.width*w.toScale;return o.e(rp(b,s,u,m),{u_patternscale_a:[D/Q,-j.height/2],u_patternscale_b:[D/K,-W.height/2],u_sdfgamma:P.width/(256*Math.min(Q,K)*b.pixelRatio)/2,u_image:0,u_tex_y_a:j.y,u_tex_y_b:W.y,u_mix:w.t})};function cv(b,s){return 1/o.aB(b,1,s.tileZoom)}function uv(b,s,u){return o.aC(b.transform,s,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Ic=(b,s,u,m,v)=>{return{u_tl_parent:b,u_scale_parent:s,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(P=m.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(w=m.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Ax(m.paint.get("raster-hue-rotate")),u_coords_top:[v[0].x,v[0].y,v[1].x,v[1].y],u_coords_bottom:[v[3].x,v[3].y,v[2].x,v[2].y]};var w,P};function Ax(b){b*=Math.PI/180;const s=Math.sin(b),u=Math.cos(b);return[(2*u+1)/3,(-Math.sqrt(3)*s-u+1)/3,(Math.sqrt(3)*s-u+1)/3]}const hv=(b,s,u,m,v,w,P,D,F,j,W,Q,K)=>{const oe=P.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:oe.cameraToCenterDistance,u_pitch:oe.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:oe.width/oe.height,u_fade_change:P.options.fadeDuration?P.symbolFadeChange:1,u_label_plane_matrix:D,u_coord_matrix:F,u_is_text:+W,u_pitch_with_map:+m,u_is_along_line:v,u_is_variable_anchor:w,u_texsize:Q,u_texture:0,u_translation:j,u_pitched_scale:K}},Lu=(b,s,u,m,v,w,P,D,F,j,W,Q,K,oe)=>{const he=P.transform;return o.e(hv(b,s,u,m,v,w,P,D,F,j,W,Q,oe),{u_gamma_scale:m?Math.cos(he.pitch*Math.PI/180)*he.cameraToCenterDistance:1,u_device_pixel_ratio:P.pixelRatio,u_is_halo:1})},F2=(b,s,u,m,v,w,P,D,F,j,W,Q,K)=>o.e(Lu(b,s,u,m,v,w,P,D,F,j,!0,W,0,K),{u_texsize_icon:Q,u_texture_icon:1}),ip=(b,s)=>({u_opacity:b,u_color:s}),N2=(b,s,u,m,v)=>o.e(function(w,P,D,F){const j=D.imageManager.getPattern(w.from.toString()),W=D.imageManager.getPattern(w.to.toString()),{width:Q,height:K}=D.imageManager.getPixelSize(),oe=Math.pow(2,F.tileID.overscaledZ),he=F.tileSize*Math.pow(2,D.transform.tileZoom)/oe,Pe=he*(F.tileID.canonical.x+F.tileID.wrap*oe),Ee=he*F.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:W.tl,u_pattern_br_b:W.br,u_texsize:[Q,K],u_mix:P.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:W.displaySize,u_scale_a:P.fromScale,u_scale_b:P.toScale,u_tile_units_to_pixels:1/o.aB(F,1,D.transform.tileZoom),u_pixel_coord_upper:[Pe>>16,Ee>>16],u_pixel_coord_lower:[65535&Pe,65535&Ee]}}(u,v,s,m),{u_opacity:b}),Ix=(b,s)=>{},Rx={fillExtrusion:(b,s)=>({u_lightpos:new o.bS(b,s.u_lightpos),u_lightpos_globe:new o.bS(b,s.u_lightpos_globe),u_lightintensity:new o.bf(b,s.u_lightintensity),u_lightcolor:new o.bS(b,s.u_lightcolor),u_vertical_gradient:new o.bf(b,s.u_vertical_gradient),u_opacity:new o.bf(b,s.u_opacity),u_fill_translate:new o.bT(b,s.u_fill_translate)}),fillExtrusionPattern:(b,s)=>({u_lightpos:new o.bS(b,s.u_lightpos),u_lightpos_globe:new o.bS(b,s.u_lightpos_globe),u_lightintensity:new o.bf(b,s.u_lightintensity),u_lightcolor:new o.bS(b,s.u_lightcolor),u_vertical_gradient:new o.bf(b,s.u_vertical_gradient),u_height_factor:new o.bf(b,s.u_height_factor),u_opacity:new o.bf(b,s.u_opacity),u_fill_translate:new o.bT(b,s.u_fill_translate),u_image:new o.bO(b,s.u_image),u_texsize:new o.bT(b,s.u_texsize),u_pixel_coord_upper:new o.bT(b,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.bT(b,s.u_pixel_coord_lower),u_scale:new o.bS(b,s.u_scale),u_fade:new o.bf(b,s.u_fade)}),fill:(b,s)=>({u_fill_translate:new o.bT(b,s.u_fill_translate)}),fillPattern:(b,s)=>({u_image:new o.bO(b,s.u_image),u_texsize:new o.bT(b,s.u_texsize),u_pixel_coord_upper:new o.bT(b,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.bT(b,s.u_pixel_coord_lower),u_scale:new o.bS(b,s.u_scale),u_fade:new o.bf(b,s.u_fade),u_fill_translate:new o.bT(b,s.u_fill_translate)}),fillOutline:(b,s)=>({u_world:new o.bT(b,s.u_world),u_fill_translate:new o.bT(b,s.u_fill_translate)}),fillOutlinePattern:(b,s)=>({u_world:new o.bT(b,s.u_world),u_image:new o.bO(b,s.u_image),u_texsize:new o.bT(b,s.u_texsize),u_pixel_coord_upper:new o.bT(b,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.bT(b,s.u_pixel_coord_lower),u_scale:new o.bS(b,s.u_scale),u_fade:new o.bf(b,s.u_fade),u_fill_translate:new o.bT(b,s.u_fill_translate)}),circle:(b,s)=>({u_camera_to_center_distance:new o.bf(b,s.u_camera_to_center_distance),u_scale_with_map:new o.bO(b,s.u_scale_with_map),u_pitch_with_map:new o.bO(b,s.u_pitch_with_map),u_extrude_scale:new o.bT(b,s.u_extrude_scale),u_device_pixel_ratio:new o.bf(b,s.u_device_pixel_ratio),u_globe_extrude_scale:new o.bf(b,s.u_globe_extrude_scale),u_translate:new o.bT(b,s.u_translate)}),collisionBox:(b,s)=>({u_pixel_extrude_scale:new o.bT(b,s.u_pixel_extrude_scale)}),collisionCircle:(b,s)=>({u_viewport_size:new o.bT(b,s.u_viewport_size)}),debug:(b,s)=>({u_color:new o.bP(b,s.u_color),u_overlay:new o.bO(b,s.u_overlay),u_overlay_scale:new o.bf(b,s.u_overlay_scale)}),depth:Ix,clippingMask:Ix,heatmap:(b,s)=>({u_extrude_scale:new o.bf(b,s.u_extrude_scale),u_intensity:new o.bf(b,s.u_intensity),u_globe_extrude_scale:new o.bf(b,s.u_globe_extrude_scale)}),heatmapTexture:(b,s)=>({u_matrix:new o.bQ(b,s.u_matrix),u_world:new o.bT(b,s.u_world),u_image:new o.bO(b,s.u_image),u_color_ramp:new o.bO(b,s.u_color_ramp),u_opacity:new o.bf(b,s.u_opacity)}),hillshade:(b,s)=>({u_image:new o.bO(b,s.u_image),u_latrange:new o.bT(b,s.u_latrange),u_exaggeration:new o.bf(b,s.u_exaggeration),u_altitudes:new o.bZ(b,s.u_altitudes),u_azimuths:new o.bZ(b,s.u_azimuths),u_accent:new o.bP(b,s.u_accent),u_method:new o.bO(b,s.u_method),u_shadows:new o.bY(b,s.u_shadows),u_highlights:new o.bY(b,s.u_highlights)}),hillshadePrepare:(b,s)=>({u_matrix:new o.bQ(b,s.u_matrix),u_image:new o.bO(b,s.u_image),u_dimension:new o.bT(b,s.u_dimension),u_zoom:new o.bf(b,s.u_zoom),u_unpack:new o.bR(b,s.u_unpack)}),colorRelief:(b,s)=>({u_image:new o.bO(b,s.u_image),u_unpack:new o.bR(b,s.u_unpack),u_dimension:new o.bT(b,s.u_dimension),u_elevation_stops:new o.bO(b,s.u_elevation_stops),u_color_stops:new o.bO(b,s.u_color_stops),u_color_ramp_size:new o.bO(b,s.u_color_ramp_size),u_opacity:new o.bf(b,s.u_opacity)}),line:(b,s)=>({u_translation:new o.bT(b,s.u_translation),u_ratio:new o.bf(b,s.u_ratio),u_device_pixel_ratio:new o.bf(b,s.u_device_pixel_ratio),u_units_to_pixels:new o.bT(b,s.u_units_to_pixels)}),lineGradient:(b,s)=>({u_translation:new o.bT(b,s.u_translation),u_ratio:new o.bf(b,s.u_ratio),u_device_pixel_ratio:new o.bf(b,s.u_device_pixel_ratio),u_units_to_pixels:new o.bT(b,s.u_units_to_pixels),u_image:new o.bO(b,s.u_image),u_image_height:new o.bf(b,s.u_image_height)}),linePattern:(b,s)=>({u_translation:new o.bT(b,s.u_translation),u_texsize:new o.bT(b,s.u_texsize),u_ratio:new o.bf(b,s.u_ratio),u_device_pixel_ratio:new o.bf(b,s.u_device_pixel_ratio),u_image:new o.bO(b,s.u_image),u_units_to_pixels:new o.bT(b,s.u_units_to_pixels),u_scale:new o.bS(b,s.u_scale),u_fade:new o.bf(b,s.u_fade)}),lineSDF:(b,s)=>({u_translation:new o.bT(b,s.u_translation),u_ratio:new o.bf(b,s.u_ratio),u_device_pixel_ratio:new o.bf(b,s.u_device_pixel_ratio),u_units_to_pixels:new o.bT(b,s.u_units_to_pixels),u_patternscale_a:new o.bT(b,s.u_patternscale_a),u_patternscale_b:new o.bT(b,s.u_patternscale_b),u_sdfgamma:new o.bf(b,s.u_sdfgamma),u_image:new o.bO(b,s.u_image),u_tex_y_a:new o.bf(b,s.u_tex_y_a),u_tex_y_b:new o.bf(b,s.u_tex_y_b),u_mix:new o.bf(b,s.u_mix)}),raster:(b,s)=>({u_tl_parent:new o.bT(b,s.u_tl_parent),u_scale_parent:new o.bf(b,s.u_scale_parent),u_buffer_scale:new o.bf(b,s.u_buffer_scale),u_fade_t:new o.bf(b,s.u_fade_t),u_opacity:new o.bf(b,s.u_opacity),u_image0:new o.bO(b,s.u_image0),u_image1:new o.bO(b,s.u_image1),u_brightness_low:new o.bf(b,s.u_brightness_low),u_brightness_high:new o.bf(b,s.u_brightness_high),u_saturation_factor:new o.bf(b,s.u_saturation_factor),u_contrast_factor:new o.bf(b,s.u_contrast_factor),u_spin_weights:new o.bS(b,s.u_spin_weights),u_coords_top:new o.bR(b,s.u_coords_top),u_coords_bottom:new o.bR(b,s.u_coords_bottom)}),symbolIcon:(b,s)=>({u_is_size_zoom_constant:new o.bO(b,s.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bO(b,s.u_is_size_feature_constant),u_size_t:new o.bf(b,s.u_size_t),u_size:new o.bf(b,s.u_size),u_camera_to_center_distance:new o.bf(b,s.u_camera_to_center_distance),u_pitch:new o.bf(b,s.u_pitch),u_rotate_symbol:new o.bO(b,s.u_rotate_symbol),u_aspect_ratio:new o.bf(b,s.u_aspect_ratio),u_fade_change:new o.bf(b,s.u_fade_change),u_label_plane_matrix:new o.bQ(b,s.u_label_plane_matrix),u_coord_matrix:new o.bQ(b,s.u_coord_matrix),u_is_text:new o.bO(b,s.u_is_text),u_pitch_with_map:new o.bO(b,s.u_pitch_with_map),u_is_along_line:new o.bO(b,s.u_is_along_line),u_is_variable_anchor:new o.bO(b,s.u_is_variable_anchor),u_texsize:new o.bT(b,s.u_texsize),u_texture:new o.bO(b,s.u_texture),u_translation:new o.bT(b,s.u_translation),u_pitched_scale:new o.bf(b,s.u_pitched_scale)}),symbolSDF:(b,s)=>({u_is_size_zoom_constant:new o.bO(b,s.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bO(b,s.u_is_size_feature_constant),u_size_t:new o.bf(b,s.u_size_t),u_size:new o.bf(b,s.u_size),u_camera_to_center_distance:new o.bf(b,s.u_camera_to_center_distance),u_pitch:new o.bf(b,s.u_pitch),u_rotate_symbol:new o.bO(b,s.u_rotate_symbol),u_aspect_ratio:new o.bf(b,s.u_aspect_ratio),u_fade_change:new o.bf(b,s.u_fade_change),u_label_plane_matrix:new o.bQ(b,s.u_label_plane_matrix),u_coord_matrix:new o.bQ(b,s.u_coord_matrix),u_is_text:new o.bO(b,s.u_is_text),u_pitch_with_map:new o.bO(b,s.u_pitch_with_map),u_is_along_line:new o.bO(b,s.u_is_along_line),u_is_variable_anchor:new o.bO(b,s.u_is_variable_anchor),u_texsize:new o.bT(b,s.u_texsize),u_texture:new o.bO(b,s.u_texture),u_gamma_scale:new o.bf(b,s.u_gamma_scale),u_device_pixel_ratio:new o.bf(b,s.u_device_pixel_ratio),u_is_halo:new o.bO(b,s.u_is_halo),u_translation:new o.bT(b,s.u_translation),u_pitched_scale:new o.bf(b,s.u_pitched_scale)}),symbolTextAndIcon:(b,s)=>({u_is_size_zoom_constant:new o.bO(b,s.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bO(b,s.u_is_size_feature_constant),u_size_t:new o.bf(b,s.u_size_t),u_size:new o.bf(b,s.u_size),u_camera_to_center_distance:new o.bf(b,s.u_camera_to_center_distance),u_pitch:new o.bf(b,s.u_pitch),u_rotate_symbol:new o.bO(b,s.u_rotate_symbol),u_aspect_ratio:new o.bf(b,s.u_aspect_ratio),u_fade_change:new o.bf(b,s.u_fade_change),u_label_plane_matrix:new o.bQ(b,s.u_label_plane_matrix),u_coord_matrix:new o.bQ(b,s.u_coord_matrix),u_is_text:new o.bO(b,s.u_is_text),u_pitch_with_map:new o.bO(b,s.u_pitch_with_map),u_is_along_line:new o.bO(b,s.u_is_along_line),u_is_variable_anchor:new o.bO(b,s.u_is_variable_anchor),u_texsize:new o.bT(b,s.u_texsize),u_texsize_icon:new o.bT(b,s.u_texsize_icon),u_texture:new o.bO(b,s.u_texture),u_texture_icon:new o.bO(b,s.u_texture_icon),u_gamma_scale:new o.bf(b,s.u_gamma_scale),u_device_pixel_ratio:new o.bf(b,s.u_device_pixel_ratio),u_is_halo:new o.bO(b,s.u_is_halo),u_translation:new o.bT(b,s.u_translation),u_pitched_scale:new o.bf(b,s.u_pitched_scale)}),background:(b,s)=>({u_opacity:new o.bf(b,s.u_opacity),u_color:new o.bP(b,s.u_color)}),backgroundPattern:(b,s)=>({u_opacity:new o.bf(b,s.u_opacity),u_image:new o.bO(b,s.u_image),u_pattern_tl_a:new o.bT(b,s.u_pattern_tl_a),u_pattern_br_a:new o.bT(b,s.u_pattern_br_a),u_pattern_tl_b:new o.bT(b,s.u_pattern_tl_b),u_pattern_br_b:new o.bT(b,s.u_pattern_br_b),u_texsize:new o.bT(b,s.u_texsize),u_mix:new o.bf(b,s.u_mix),u_pattern_size_a:new o.bT(b,s.u_pattern_size_a),u_pattern_size_b:new o.bT(b,s.u_pattern_size_b),u_scale_a:new o.bf(b,s.u_scale_a),u_scale_b:new o.bf(b,s.u_scale_b),u_pixel_coord_upper:new o.bT(b,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.bT(b,s.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bf(b,s.u_tile_units_to_pixels)}),terrain:(b,s)=>({u_texture:new o.bO(b,s.u_texture),u_ele_delta:new o.bf(b,s.u_ele_delta),u_fog_matrix:new o.bQ(b,s.u_fog_matrix),u_fog_color:new o.bP(b,s.u_fog_color),u_fog_ground_blend:new o.bf(b,s.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bf(b,s.u_fog_ground_blend_opacity),u_horizon_color:new o.bP(b,s.u_horizon_color),u_horizon_fog_blend:new o.bf(b,s.u_horizon_fog_blend),u_is_globe_mode:new o.bf(b,s.u_is_globe_mode)}),terrainDepth:(b,s)=>({u_ele_delta:new o.bf(b,s.u_ele_delta)}),terrainCoords:(b,s)=>({u_texture:new o.bO(b,s.u_texture),u_terrain_coords_id:new o.bf(b,s.u_terrain_coords_id),u_ele_delta:new o.bf(b,s.u_ele_delta)}),projectionErrorMeasurement:(b,s)=>({u_input:new o.bf(b,s.u_input),u_output_expected:new o.bf(b,s.u_output_expected)}),atmosphere:(b,s)=>({u_sun_pos:new o.bS(b,s.u_sun_pos),u_atmosphere_blend:new o.bf(b,s.u_atmosphere_blend),u_globe_position:new o.bS(b,s.u_globe_position),u_globe_radius:new o.bf(b,s.u_globe_radius),u_inv_proj_matrix:new o.bQ(b,s.u_inv_proj_matrix)}),sky:(b,s)=>({u_sky_color:new o.bP(b,s.u_sky_color),u_horizon_color:new o.bP(b,s.u_horizon_color),u_horizon:new o.bT(b,s.u_horizon),u_horizon_normal:new o.bT(b,s.u_horizon_normal),u_sky_horizon_blend:new o.bf(b,s.u_sky_horizon_blend),u_sky_blend:new o.bf(b,s.u_sky_blend)})};class Lx{constructor(s,u,m){this.context=s;const v=s.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const kx={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class dv{constructor(s,u,m,v){this.length=u.length,this.attributes=m,this.itemSize=u.bytesPerElement,this.dynamicDraw=v,this.context=s;const w=s.gl;this.buffer=w.createBuffer(),s.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,u){for(let m=0;m<this.attributes.length;m++){const v=u.attributes[this.attributes[m].name];v!==void 0&&s.enableVertexAttribArray(v)}}setVertexAttribPointers(s,u,m){for(let v=0;v<this.attributes.length;v++){const w=this.attributes[v],P=u.attributes[w.name];P!==void 0&&s.vertexAttribPointer(P,w.components,s[kx[w.type]],!1,this.itemSize,w.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Mr{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class op extends Mr{getDefault(){return o.be.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class ll extends Mr{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class fv extends Mr{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class pv extends Mr{getDefault(){return[!0,!0,!0,!0]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class mv extends Mr{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Dx extends Mr{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class gv extends Mr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const u=this.current;(s.func!==u.func||s.ref!==u.ref||s.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Rc extends Mr{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class vv extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=s,this.dirty=!1}}class B2 extends Mr{getDefault(){return[0,1]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class U2 extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=s,this.dirty=!1}}class $2 extends Mr{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class V2 extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.BLEND):u.disable(u.BLEND),this.current=s,this.dirty=!1}}class zx extends Mr{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class j2 extends Mr{getDefault(){return o.be.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Ox extends Mr{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class sp extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=s,this.dirty=!1}}class ap extends Mr{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class lp extends Mr{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class yv extends Mr{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class Lc extends Mr{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class Sd extends Mr{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class ku extends Mr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Ps extends Mr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Fx extends Mr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class Nx extends Mr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class _v extends Mr{getDefault(){return null}set(s){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class kc extends Mr{getDefault(){return null}set(s){var u;if(s===this.current&&!this.dirty)return;const m=this.gl;Ro(m)?m.bindVertexArray(s):(u=m.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(s),this.current=s,this.dirty=!1}}class cp extends Mr{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class up extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Md extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Du extends Mr{constructor(s,u){super(s),this.context=s,this.parent=u}getDefault(){return null}}class Bx extends Du{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class zu extends Du{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Ou extends Du{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}const xv="Framebuffer is not complete";class bv{constructor(s,u,m,v,w){this.context=s,this.width=u,this.height=m;const P=s.gl,D=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new Bx(s,D),v)this.depthAttachment=w?new Ou(s,D):new zu(s,D);else if(w)throw new Error("Stencil cannot be set without depth");if(P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error(xv)}destroy(){const s=this.context.gl,u=this.colorAttachment.get();if(u&&s.deleteTexture(u),this.depthAttachment){const m=this.depthAttachment.get();m&&s.deleteRenderbuffer(m)}s.deleteFramebuffer(this.framebuffer)}}class nr{constructor(s){var u,m;if(this.gl=s,this.clearColor=new op(this),this.clearDepth=new ll(this),this.clearStencil=new fv(this),this.colorMask=new pv(this),this.depthMask=new mv(this),this.stencilMask=new Dx(this),this.stencilFunc=new gv(this),this.stencilOp=new Rc(this),this.stencilTest=new vv(this),this.depthRange=new B2(this),this.depthTest=new U2(this),this.depthFunc=new $2(this),this.blend=new V2(this),this.blendFunc=new zx(this),this.blendColor=new j2(this),this.blendEquation=new Ox(this),this.cullFace=new sp(this),this.cullFaceSide=new ap(this),this.frontFace=new lp(this),this.program=new yv(this),this.activeTexture=new Lc(this),this.viewport=new Sd(this),this.bindFramebuffer=new ku(this),this.bindRenderbuffer=new Ps(this),this.bindTexture=new Fx(this),this.bindVertexBuffer=new Nx(this),this.bindElementBuffer=new _v(this),this.bindVertexArray=new kc(this),this.pixelStoreUnpack=new cp(this),this.pixelStoreUnpackPremultiplyAlpha=new up(this),this.pixelStoreUnpackFlipY=new Md(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),Ro(s)){this.HALF_FLOAT=s.HALF_FLOAT;const v=s.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=s.RGBA16F)!==null&&u!==void 0?u:v==null?void 0:v.RGBA16F_EXT,this.RGB16F=(m=s.RGB16F)!==null&&m!==void 0?m:v==null?void 0:v.RGB16F_EXT,s.getExtension("EXT_color_buffer_float")}else{s.getExtension("EXT_color_buffer_half_float"),s.getExtension("OES_texture_half_float_linear");const v=s.getExtension("OES_texture_half_float");this.HALF_FLOAT=v==null?void 0:v.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,u){return new Lx(this,s,u)}createVertexBuffer(s,u,m){return new dv(this,s,u,m)}createRenderbuffer(s,u,m){const v=this.gl,w=v.createRenderbuffer();return this.bindRenderbuffer.set(w),v.renderbufferStorage(v.RENDERBUFFER,s,u,m),this.bindRenderbuffer.set(null),w}createFramebuffer(s,u,m,v){return new bv(this,s,u,m,v)}clear({color:s,depth:u,stencil:m}){const v=this.gl;let w=0;s&&(w|=v.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(w|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),m!==void 0&&(w|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),v.clear(w)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){o.bG(s.blendFunction,ar.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}createVertexArray(){var s;return Ro(this.gl)?this.gl.createVertexArray():(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.createVertexArrayOES()}deleteVertexArray(s){var u;return Ro(this.gl)?this.gl.deleteVertexArray(s):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(s)}unbindVAO(){this.bindVertexArray.set(null)}}let Dc;function Ux(b,s,u,m,v){const w=b.context,P=b.transform,D=w.gl,F=b.useProgram("collisionBox"),j=[];let W=0,Q=0;for(let Ie=0;Ie<m.length;Ie++){const Fe=m[Ie],He=s.getTile(Fe).getBucket(u);if(!He)continue;const Be=v?He.textCollisionBox:He.iconCollisionBox,Ye=He.collisionCircleArray;Ye.length>0&&(j.push({circleArray:Ye,circleOffset:Q,coord:Fe}),W+=Ye.length/4,Q=W),Be&&F.draw(w,D.LINES,Kn.disabled,Gn.disabled,b.colorModeForRenderPass(),Wn.disabled,xd(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(Fe),P.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,null,b.transform.zoom,null,null,Be.collisionVertexBuffer)}if(!v||!j.length)return;const K=b.useProgram("collisionCircle"),oe=new o.b_;oe.resize(4*W),oe._trim();let he=0;for(const Ie of j)for(let Fe=0;Fe<Ie.circleArray.length/4;Fe++){const He=4*Fe,Be=Ie.circleArray[He+0],Ye=Ie.circleArray[He+1],Ke=Ie.circleArray[He+2],$e=Ie.circleArray[He+3];oe.emplace(he++,Be,Ye,Ke,$e,0),oe.emplace(he++,Be,Ye,Ke,$e,1),oe.emplace(he++,Be,Ye,Ke,$e,2),oe.emplace(he++,Be,Ye,Ke,$e,3)}(!Dc||Dc.length<2*W)&&(Dc=function(Ie){const Fe=2*Ie,He=new o.c0;He.resize(Fe),He._trim();for(let Be=0;Be<Fe;Be++){const Ye=6*Be;He.uint16[Ye+0]=4*Be+0,He.uint16[Ye+1]=4*Be+1,He.uint16[Ye+2]=4*Be+2,He.uint16[Ye+3]=4*Be+2,He.uint16[Ye+4]=4*Be+3,He.uint16[Ye+5]=4*Be+0}return He}(W));const Pe=w.createIndexBuffer(Dc,!0),Ee=w.createVertexBuffer(oe,o.b$.members,!0);for(const Ie of j){const Fe=bd(b.transform);K.draw(w,D.TRIANGLES,Kn.disabled,Gn.disabled,b.colorModeForRenderPass(),Wn.disabled,Fe,b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ie.coord),null,u.id,Ee,Pe,o.aL.simpleSegment(0,2*Ie.circleOffset,Ie.circleArray.length,Ie.circleArray.length/2),null,b.transform.zoom,null,null,null)}Ee.destroy(),Pe.destroy()}const $x=o.af(new Float32Array(16));function Cd(b,s,u,m,v,w){const{horizontalAlign:P,verticalAlign:D}=o.aG(b);return new o.P((-(P-.5)*s/v+m[0])*w,(-(D-.5)*u/v+m[1])*w)}function H2(b,s,u,m,v,w){const P=s.tileAnchorPoint.add(new o.P(s.translation[0],s.translation[1]));if(s.pitchWithMap){let D=m.mult(w);u||(D=D.rotate(-v));const F=P.add(D);return Yt(F.x,F.y,s.pitchedLabelPlaneMatrix,s.getElevation).point}if(u){const D=Ze(s.tileAnchorPoint.x+1,s.tileAnchorPoint.y,s).point.sub(b),F=Math.atan(D.y/D.x)+(D.x<0?Math.PI:0);return b.add(m.rotate(F))}return b.add(m)}function G2(b,s,u,m,v,w,P,D,F,j,W,Q){const K=b.text.placedSymbolArray,oe=b.text.dynamicLayoutVertexArray,he=b.icon.dynamicLayoutVertexArray,Pe={};oe.clear();for(let Ee=0;Ee<K.length;Ee++){const Ie=K.get(Ee),Fe=Ie.hidden||!Ie.crossTileID||b.allowVerticalPlacement&&!Ie.placedOrientation?null:m[Ie.crossTileID];if(Fe){const He=new o.P(Ie.anchorX,Ie.anchorY),Be={getElevation:Q,width:v.width,height:v.height,pitchedLabelPlaneMatrix:w,pitchWithMap:u,transform:v,tileAnchorPoint:He,translation:j,unwrappedTileID:W},Ye=u?Wt(He.x,He.y,Be):Ze(He.x,He.y,Be),Ke=qt(v.cameraToCenterDistance,Ye.signedDistanceFromCamera);let $e=o.ao(b.textSizeData,D,Ie)*Ke/o.aA;u&&($e*=b.tilePixelRatio/P);const{width:rt,height:yt,anchor:ht,textOffset:pt,textBoxScale:_t}=Fe,sn=Cd(ht,rt,yt,pt,_t,$e),rn=v.getPitchedTextCorrection(He.x+j[0],He.y+j[1],W),Vt=H2(Ye.point,Be,s,sn,-v.bearingInRadians,rn),Mn=b.allowVerticalPlacement&&Ie.placedOrientation===o.an.vertical?Math.PI/2:0;for(let Jn=0;Jn<Ie.numGlyphs;Jn++)o.au(oe,Vt,Mn);F&&Ie.associatedIconIndex>=0&&(Pe[Ie.associatedIconIndex]={shiftedAnchor:Vt,angle:Mn})}else nt(Ie.numGlyphs,oe)}if(F){he.clear();const Ee=b.icon.placedSymbolArray;for(let Ie=0;Ie<Ee.length;Ie++){const Fe=Ee.get(Ie);if(Fe.hidden)nt(Fe.numGlyphs,he);else{const He=Pe[Ie];if(He)for(let Be=0;Be<Fe.numGlyphs;Be++)o.au(he,He.shiftedAnchor,He.angle);else nt(Fe.numGlyphs,he)}}b.icon.dynamicLayoutVertexBuffer.updateData(he)}b.text.dynamicLayoutVertexBuffer.updateData(oe)}function Vx(b,s,u){return u.iconsInText&&s?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function jx(b,s,u,m,v,w,P,D,F,j,W,Q,K){const oe=b.context,he=oe.gl,Pe=b.transform,Ee=D==="map",Ie=F==="map",Fe=D!=="viewport"&&u.layout.get("symbol-placement")!=="point",He=Ee&&!Ie&&!Fe,Be=!u.layout.get("symbol-sort-key").isConstant();let Ye=!1;const Ke=b.getDepthModeForSublayer(0,Kn.ReadOnly),$e=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),rt=[],yt=Pe.getCircleRadiusCorrection();for(const ht of m){const pt=s.getTile(ht),_t=pt.getBucket(u);if(!_t)continue;const sn=v?_t.text:_t.icon;if(!sn||!sn.segments.get().length||!sn.hasVisibleVertices)continue;const rn=sn.programConfigurations.get(u.id),Vt=v||_t.sdfIcons,Mn=v?_t.textSizeData:_t.iconSizeData,Jn=Ie||Pe.pitch!==0,Cr=b.useProgram(Vx(Vt,v,_t),rn),ni=o.am(Mn,Pe.zoom),Ar=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ht);let ri,zr,Ir,Or,no=[0,0],hr=null;if(v)zr=pt.glyphAtlasTexture,Ir=he.LINEAR,ri=pt.glyphAtlasTexture.size,_t.iconsInText&&(no=pt.imageAtlasTexture.size,hr=pt.imageAtlasTexture,Or=Jn||b.options.rotating||b.options.zooming||Mn.kind==="composite"||Mn.kind==="camera"?he.LINEAR:he.NEAREST);else{const di=u.layout.get("icon-size").constantOr(0)!==1||_t.iconsNeedLinear;zr=pt.imageAtlasTexture,Ir=Vt||b.options.rotating||b.options.zooming||di||Jn?he.LINEAR:he.NEAREST,ri=pt.imageAtlasTexture.size}const Gi=o.aB(pt,1,b.transform.zoom),ro=tt(Ee,b.transform,Gi),Gl=o.L();o.ap(Gl,ro);const Wl=At(Ie,Ee,b.transform,Gi),ql=o.aC(Pe,pt,w,P),za=Pe.getProjectionData({overscaledTileID:ht,applyGlobeMatrix:!K,applyTerrainMatrix:!0}),Bd=$e&&_t.hasTextData(),Ud=u.layout.get("icon-text-fit")!=="none"&&Bd&&_t.hasIconData();if(Fe){const di=b.style.map.terrain?(zo,Li)=>b.style.map.terrain.getElevation(ht,zo,Li):null,Gr=u.layout.get("text-rotation-alignment")==="map";yn(_t,b,v,ro,Gl,Ie,j,Gr,ht.toUnwrapped(),Pe.width,Pe.height,ql,di)}const Xu=v&&$e||Ud,Qo=Fe||Xu?$x:Ie?ro:b.transform.clipSpaceToPixelsMatrix,ea=Vt&&u.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Xl;Xl=Vt?_t.iconsInText?F2(Mn.kind,ni,He,Ie,Fe,Xu,b,Qo,Wl,ql,ri,no,yt):Lu(Mn.kind,ni,He,Ie,Fe,Xu,b,Qo,Wl,ql,v,ri,0,yt):hv(Mn.kind,ni,He,Ie,Fe,Xu,b,Qo,Wl,ql,v,ri,yt);const Fc={program:Cr,buffers:sn,uniformValues:Xl,projectionData:za,atlasTexture:zr,atlasTextureIcon:hr,atlasInterpolation:Ir,atlasInterpolationIcon:Or,isSDF:Vt,hasHalo:ea};if(Be&&_t.canOverlap){Ye=!0;const di=sn.segments.get();for(const Gr of di)rt.push({segments:new o.aL([Gr]),sortKey:Gr.sortKey,state:Fc,terrainData:Ar})}else rt.push({segments:sn.segments,sortKey:0,state:Fc,terrainData:Ar})}Ye&&rt.sort((ht,pt)=>ht.sortKey-pt.sortKey);for(const ht of rt){const pt=ht.state;if(oe.activeTexture.set(he.TEXTURE0),pt.atlasTexture.bind(pt.atlasInterpolation,he.CLAMP_TO_EDGE),pt.atlasTextureIcon&&(oe.activeTexture.set(he.TEXTURE1),pt.atlasTextureIcon&&pt.atlasTextureIcon.bind(pt.atlasInterpolationIcon,he.CLAMP_TO_EDGE)),pt.isSDF){const _t=pt.uniformValues;pt.hasHalo&&(_t.u_is_halo=1,hp(pt.buffers,ht.segments,u,b,pt.program,Ke,W,Q,_t,pt.projectionData,ht.terrainData)),_t.u_is_halo=0}hp(pt.buffers,ht.segments,u,b,pt.program,Ke,W,Q,pt.uniformValues,pt.projectionData,ht.terrainData)}}function hp(b,s,u,m,v,w,P,D,F,j,W){const Q=m.context;v.draw(Q,Q.gl.TRIANGLES,w,P,D,Wn.backCCW,F,W,j,u.id,b.layoutVertexBuffer,b.indexBuffer,s,u.paint,m.transform.zoom,b.programConfigurations.get(u.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function dp(b,s,u,m,v){const w=b.context,P=w.gl,D=Gn.disabled,F=new ar([P.ONE,P.ONE],o.be.transparent,[!0,!0,!0,!0]),j=s.getBucket(u);if(!j)return;const W=m.key;let Q=u.heatmapFbos.get(W);Q||(Q=Ed(w,s.tileSize,s.tileSize),u.heatmapFbos.set(W,Q)),w.bindFramebuffer.set(Q.framebuffer),w.viewport.set([0,0,s.tileSize,s.tileSize]),w.clear({color:o.be.transparent});const K=j.programConfigurations.get(u.id),oe=b.useProgram("heatmap",K,!v),he=b.transform.getProjectionData({overscaledTileID:s.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Pe=b.style.map.terrain.getTerrainData(m);oe.draw(w,P.TRIANGLES,Kn.disabled,D,F,Wn.disabled,wd(s,b.transform.zoom,u.paint.get("heatmap-intensity"),1),Pe,he,u.id,j.layoutVertexBuffer,j.indexBuffer,j.segments,u.paint,b.transform.zoom,K)}function fp(b,s,u,m,v){const w=b.context,P=w.gl,D=b.transform;w.setColorMode(b.colorModeForRenderPass());const F=pp(w,s),j=u.key,W=s.heatmapFbos.get(j);if(!W)return;w.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,W.colorAttachment.get()),w.activeTexture.set(P.TEXTURE1),F.bind(P.LINEAR,P.CLAMP_TO_EDGE);const Q=D.getProjectionData({overscaledTileID:u,applyTerrainMatrix:v,applyGlobeMatrix:!m});b.useProgram("heatmapTexture").draw(w,P.TRIANGLES,Kn.disabled,Gn.disabled,b.colorModeForRenderPass(),Wn.disabled,Cx(b,s,0,1),null,Q,s.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,s.paint,D.zoom),W.destroy(),s.heatmapFbos.delete(j)}function Ed(b,s,u){var m,v;const w=b.gl,P=w.createTexture();w.bindTexture(w.TEXTURE_2D,P),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.LINEAR);const D=(m=b.HALF_FLOAT)!==null&&m!==void 0?m:w.UNSIGNED_BYTE,F=(v=b.RGBA16F)!==null&&v!==void 0?v:w.RGBA;w.texImage2D(w.TEXTURE_2D,0,F,s,u,0,w.RGBA,D,null);const j=b.createFramebuffer(s,u,!1,!1);return j.colorAttachment.set(P),j}function pp(b,s){return s.colorRampTexture||(s.colorRampTexture=new o.T(b,s.colorRamp,b.gl.RGBA)),s.colorRampTexture}function wv(b,s,u,m,v){if(!u||!m||!m.imageAtlas)return;const w=m.imageAtlas.patternPositions;let P=w[u.to.toString()],D=w[u.from.toString()];if(!P&&D&&(P=D),!D&&P&&(D=P),!P||!D){const F=v.getPaintProperty(s);P=w[F],D=w[F]}P&&D&&b.setConstantPatternPositions(P,D)}function Td(b,s,u,m,v,w,P,D){const F=b.context.gl,j="fill-pattern",W=u.paint.get(j),Q=W&&W.constantOr(1),K=u.getCrossfadeParameters();let oe,he,Pe,Ee,Ie;const Fe=b.transform,He=u.paint.get("fill-translate"),Be=u.paint.get("fill-translate-anchor");P?(he=Q&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",oe=F.LINES):(he=Q?"fillPattern":"fill",oe=F.TRIANGLES);const Ye=W.constantOr(null);for(const Ke of m){const $e=s.getTile(Ke);if(Q&&!$e.patternsLoaded())continue;const rt=$e.getBucket(u);if(!rt)continue;const yt=rt.programConfigurations.get(u.id),ht=b.useProgram(he,yt),pt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ke);Q&&(b.context.activeTexture.set(F.TEXTURE0),$e.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),yt.updatePaintBuffers(K)),wv(yt,j,Ye,$e,u);const _t=Fe.getProjectionData({overscaledTileID:Ke,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),sn=o.aC(Fe,$e,He,Be);if(P){Ee=rt.indexBuffer2,Ie=rt.segments2;const Vt=[F.drawingBufferWidth,F.drawingBufferHeight];Pe=he==="fillOutlinePattern"&&Q?D2(b,K,$e,Vt,sn):La(Vt,sn)}else Ee=rt.indexBuffer,Ie=rt.segments,Pe=Q?np(b,K,$e,sn):{u_fill_translate:sn};const rn=b.stencilModeForClipping(Ke);ht.draw(b.context,oe,v,rn,w,Wn.backCCW,Pe,pt,_t,u.id,rt.layoutVertexBuffer,Ee,Ie,u.paint,b.transform.zoom,yt)}}function Fu(b,s,u,m,v,w,P,D){const F=b.context,j=F.gl,W="fill-extrusion-pattern",Q=u.paint.get(W),K=Q.constantOr(1),oe=u.getCrossfadeParameters(),he=u.paint.get("fill-extrusion-opacity"),Pe=Q.constantOr(null),Ee=b.transform;for(const Ie of m){const Fe=s.getTile(Ie),He=Fe.getBucket(u);if(!He)continue;const Be=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ie),Ye=He.programConfigurations.get(u.id),Ke=b.useProgram(K?"fillExtrusionPattern":"fillExtrusion",Ye);K&&(b.context.activeTexture.set(j.TEXTURE0),Fe.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),Ye.updatePaintBuffers(oe));const $e=Ee.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!D,applyTerrainMatrix:!0});wv(Ye,W,Pe,Fe,u);const rt=o.aC(Ee,Fe,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),yt=u.paint.get("fill-extrusion-vertical-gradient"),ht=K?sv(b,yt,he,rt,Ie,oe,Fe):_d(b,yt,he,rt);Ke.draw(F,F.gl.TRIANGLES,v,w,P,Wn.backCCW,ht,Be,$e,u.id,He.layoutVertexBuffer,He.indexBuffer,He.segments,u.paint,b.transform.zoom,Ye,b.style.map.terrain&&He.centroidVertexBuffer)}}function Nu(b,s,u,m,v,w,P,D,F){var j;const W=b.style.projection,Q=b.context,K=b.transform,oe=Q.gl,he=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],Pe=b.useProgram("hillshade",null,!1,he),Ee=!b.options.moving;for(const Ie of m){const Fe=s.getTile(Ie),He=Fe.fbo;if(!He)continue;const Be=W.getMeshFromTileID(Q,Ie.canonical,D,!0,"raster"),Ye=(j=b.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(Ie);Q.activeTexture.set(oe.TEXTURE0),oe.bindTexture(oe.TEXTURE_2D,He.colorAttachment.get());const Ke=K.getProjectionData({overscaledTileID:Ie,aligned:Ee,applyGlobeMatrix:!F,applyTerrainMatrix:!0});Pe.draw(Q,oe.TRIANGLES,w,v[Ie.overscaledZ],P,Wn.backCCW,Ru(b,Fe,u),Ye,Ke,u.id,Be.vertexBuffer,Be.indexBuffer,Be.segments)}}function Pd(b,s,u,m,v,w,P,D,F){var j;const W=b.style.projection,Q=b.context,K=b.transform,oe=Q.gl,he=b.useProgram("colorRelief"),Pe=!b.options.moving;let Ee=!0,Ie=0;for(const Fe of m){const He=s.getTile(Fe),Be=He.dem;if(Ee){const ht=oe.getParameter(oe.MAX_TEXTURE_SIZE),{elevationTexture:pt,colorTexture:_t}=u.getColorRampTextures(Q,ht,Be.getUnpackVector());Q.activeTexture.set(oe.TEXTURE1),pt.bind(oe.NEAREST,oe.CLAMP_TO_EDGE),Q.activeTexture.set(oe.TEXTURE4),_t.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),Ee=!1,Ie=pt.size[0]}if(!Be||!Be.data)continue;const Ye=Be.stride,Ke=Be.getPixels();if(Q.activeTexture.set(oe.TEXTURE0),Q.pixelStoreUnpackPremultiplyAlpha.set(!1),He.demTexture=He.demTexture||b.getTileTexture(Ye),He.demTexture){const ht=He.demTexture;ht.update(Ke,{premultiply:!1}),ht.bind(oe.LINEAR,oe.CLAMP_TO_EDGE)}else He.demTexture=new o.T(Q,Ke,oe.RGBA,{premultiply:!1}),He.demTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const $e=W.getMeshFromTileID(Q,Fe.canonical,D,!0,"raster"),rt=(j=b.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(Fe),yt=K.getProjectionData({overscaledTileID:Fe,aligned:Pe,applyGlobeMatrix:!F,applyTerrainMatrix:!0});he.draw(Q,oe.TRIANGLES,w,v[Fe.overscaledZ],P,Wn.backCCW,O2(u,He.dem,Ie),rt,yt,u.id,$e.vertexBuffer,$e.indexBuffer,$e.segments)}}const Sv=[new o.P(0,0),new o.P(o.$,0),new o.P(o.$,o.$),new o.P(0,o.$)];function Ul(b,s,u,m,v,w,P,D,F=!1,j=!1){const W=m[m.length-1].overscaledZ,Q=b.context,K=Q.gl,oe=b.useProgram("raster"),he=b.transform,Pe=b.style.projection,Ee=b.colorModeForRenderPass(),Ie=!b.options.moving;for(const Fe of m){const He=b.getDepthModeForSublayer(Fe.overscaledZ-W,u.paint.get("raster-opacity")===1?Kn.ReadWrite:Kn.ReadOnly,K.LESS),Be=s.getTile(Fe);Be.registerFadeDuration(u.paint.get("raster-fade-duration"));const Ye=s.findLoadedParent(Fe,0),Ke=s.findLoadedSibling(Fe),$e=W2(Be,Ye||Ke||null,s,u,b.transform,b.style.map.terrain);let rt,yt;const ht=u.paint.get("raster-resampling")==="nearest"?K.NEAREST:K.LINEAR;Q.activeTexture.set(K.TEXTURE0),Be.texture.bind(ht,K.CLAMP_TO_EDGE,K.LINEAR_MIPMAP_NEAREST),Q.activeTexture.set(K.TEXTURE1),Ye?(Ye.texture.bind(ht,K.CLAMP_TO_EDGE,K.LINEAR_MIPMAP_NEAREST),rt=Math.pow(2,Ye.tileID.overscaledZ-Be.tileID.overscaledZ),yt=[Be.tileID.canonical.x*rt%1,Be.tileID.canonical.y*rt%1]):Be.texture.bind(ht,K.CLAMP_TO_EDGE,K.LINEAR_MIPMAP_NEAREST),Be.texture.useMipmap&&Q.extTextureFilterAnisotropic&&b.transform.pitch>20&&K.texParameterf(K.TEXTURE_2D,Q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Q.extTextureFilterAnisotropicMax);const pt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Fe),_t=he.getProjectionData({overscaledTileID:Fe,aligned:Ie,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),sn=Ic(yt||[0,0],rt||1,$e,u,D),rn=Pe.getMeshFromTileID(Q,Fe.canonical,w,P,"raster");oe.draw(Q,K.TRIANGLES,He,v?v[Fe.overscaledZ]:Gn.disabled,Ee,F?Wn.frontCCW:Wn.backCCW,sn,pt,_t,u.id,rn.vertexBuffer,rn.indexBuffer,rn.segments)}}function W2(b,s,u,m,v,w){const P=m.paint.get("raster-fade-duration");if(!w&&P>0){const D=M.now(),F=(D-b.timeAdded)/P,j=s?(D-s.timeAdded)/P:-1,W=u.getSource(),Q=Re(v,{tileSize:W.tileSize,roundZoom:W.roundZoom}),K=!s||Math.abs(s.tileID.overscaledZ-Q)>Math.abs(b.tileID.overscaledZ-Q),oe=K&&b.refreshedUponExpiration?1:o.ag(K?F:1-j,0,1);return b.refreshedUponExpiration&&F>=1&&(b.refreshedUponExpiration=!1),s?{opacity:1,mix:1-oe}:{opacity:oe,mix:0}}return{opacity:1,mix:0}}const Hx=new o.be(1,0,0,1),mp=new o.be(0,1,0,1),Mv=new o.be(0,0,1,1),Gx=new o.be(1,0,1,1),Wx=new o.be(0,1,1,1);function Ad(b,s,u,m){vp(b,0,s+u/2,b.transform.width,u,m)}function gp(b,s,u,m){vp(b,s-u/2,0,u,b.transform.height,m)}function vp(b,s,u,m,v,w){const P=b.context,D=P.gl;D.enable(D.SCISSOR_TEST),D.scissor(s*b.pixelRatio,u*b.pixelRatio,m*b.pixelRatio,v*b.pixelRatio),P.clear({color:w}),D.disable(D.SCISSOR_TEST)}function qx(b,s,u){const m=b.context,v=m.gl,w=b.useProgram("debug"),P=Kn.disabled,D=Gn.disabled,F=b.colorModeForRenderPass(),j="$debug",W=b.style.map.terrain&&b.style.map.terrain.getTerrainData(u);m.activeTexture.set(v.TEXTURE0);const Q=s.getTileByID(u.key).latestRawTileData,K=Math.floor((Q&&Q.byteLength||0)/1024),oe=s.getTile(u).tileSize,he=512/Math.min(oe,512)*(u.overscaledZ/b.transform.zoom)*.5;let Pe=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Pe+=` => ${u.overscaledZ}`),function(Ie,Fe){Ie.initDebugOverlayCanvas();const He=Ie.debugOverlayCanvas,Be=Ie.context.gl,Ye=Ie.debugOverlayCanvas.getContext("2d");Ye.clearRect(0,0,He.width,He.height),Ye.shadowColor="white",Ye.shadowBlur=2,Ye.lineWidth=1.5,Ye.strokeStyle="white",Ye.textBaseline="top",Ye.font="bold 36px Open Sans, sans-serif",Ye.fillText(Fe,5,5),Ye.strokeText(Fe,5,5),Ie.debugOverlayTexture.update(He),Ie.debugOverlayTexture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE)}(b,`${Pe} ${K}kB`);const Ee=b.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(m,v.TRIANGLES,P,D,ar.alphaBlended,Wn.disabled,Mx(o.be.transparent,he),null,Ee,j,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),w.draw(m,v.LINE_STRIP,P,D,F,Wn.disabled,Mx(o.be.red),W,Ee,j,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function ai(b,s,u,m){const{isRenderingGlobe:v}=m,w=b.context,P=w.gl,D=b.transform,F=b.colorModeForRenderPass(),j=b.getDepthModeFor3D(),W=b.useProgram("terrain");w.bindFramebuffer.set(null),w.viewport.set([0,0,b.width,b.height]);for(const Q of u){const K=s.getTerrainMesh(Q.tileID),oe=b.renderToTexture.getTexture(Q),he=s.getTerrainData(Q.tileID);w.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,oe.texture);const Pe=s.getMeshFrameDelta(D.zoom),Ee=D.calculateFogMatrix(Q.tileID.toUnwrapped()),Ie=L2(Pe,Ee,b.style.sky,D.pitch,v),Fe=D.getProjectionData({overscaledTileID:Q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});W.draw(w,P.TRIANGLES,j,Gn.disabled,F,Wn.backCCW,Ie,he,Fe,"terrain",K.vertexBuffer,K.indexBuffer,K.segments)}}function $l(b,s){if(!s.mesh){const u=new o.aK;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const m=new o.aM;m.emplaceBack(0,1,2),m.emplaceBack(0,2,3),s.mesh=new ol(b.createVertexBuffer(u,sl.members),b.createIndexBuffer(m),o.aL.simpleSegment(0,0,u.length,m.length))}return s.mesh}class As{constructor(s,u){this.context=new nr(s),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Je.maxUnderzooming+Je.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ri}resize(s,u,m){if(this.width=Math.floor(s*m),this.height=Math.floor(u*m),this.pixelRatio=m,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const s=this.context,u=new o.aK;u.emplaceBack(0,0),u.emplaceBack(o.$,0),u.emplaceBack(0,o.$),u.emplaceBack(o.$,o.$),this.tileExtentBuffer=s.createVertexBuffer(u,sl.members),this.tileExtentSegments=o.aL.simpleSegment(0,0,4,2);const m=new o.aK;m.emplaceBack(0,0),m.emplaceBack(o.$,0),m.emplaceBack(0,o.$),m.emplaceBack(o.$,o.$),this.debugBuffer=s.createVertexBuffer(m,sl.members),this.debugSegments=o.aL.simpleSegment(0,0,4,5);const v=new o.c5;v.emplaceBack(0,0,0,0),v.emplaceBack(o.$,0,o.$,0),v.emplaceBack(0,o.$,0,o.$),v.emplaceBack(o.$,o.$,o.$,o.$),this.rasterBoundsBuffer=s.createVertexBuffer(v,I2.members),this.rasterBoundsSegments=o.aL.simpleSegment(0,0,4,2);const w=new o.aK;w.emplaceBack(0,0),w.emplaceBack(o.$,0),w.emplaceBack(0,o.$),w.emplaceBack(o.$,o.$),this.rasterBoundsBufferPosOnly=s.createVertexBuffer(w,sl.members),this.rasterBoundsSegmentsPosOnly=o.aL.simpleSegment(0,0,4,5);const P=new o.aK;P.emplaceBack(0,0),P.emplaceBack(1,0),P.emplaceBack(0,1),P.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(P,sl.members),this.viewportSegments=o.aL.simpleSegment(0,0,4,2);const D=new o.c6;D.emplaceBack(0),D.emplaceBack(1),D.emplaceBack(3),D.emplaceBack(2),D.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(D);const F=new o.aM;F.emplaceBack(1,0,2),F.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(F);const j=this.context.gl;this.stencilClearMode=new Gn({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO),this.tileExtentMesh=new ol(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const s=this.context,u=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const m=o.L();o.bX(m,0,this.width,this.height,0,0,1),o.N(m,m,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const v={mainMatrix:m,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:m};this.useProgram("clippingMask",null,!0).draw(s,u.TRIANGLES,Kn.disabled,this.stencilClearMode,ar.disabled,Wn.disabled,null,null,v,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,u,m){if(this.currentStencilSource===s.source||!s.isTileClipped()||!u||!u.length)return;this.currentStencilSource=s.source,this.nextStencilID+u.length>256&&this.clearStencil();const v=this.context;v.setColorMode(ar.disabled),v.setDepthMode(Kn.disabled);const w={};for(const P of u)w[P.key]=this.nextStencilID++;this._renderTileMasks(w,u,m,!0),this._renderTileMasks(w,u,m,!1),this._tileClippingMaskIDs=w}_renderTileMasks(s,u,m,v){const w=this.context,P=w.gl,D=this.style.projection,F=this.transform,j=this.useProgram("clippingMask");for(const W of u){const Q=s[W.key],K=this.style.map.terrain&&this.style.map.terrain.getTerrainData(W),oe=D.getMeshFromTileID(this.context,W.canonical,v,!0,"stencil"),he=F.getProjectionData({overscaledTileID:W,applyGlobeMatrix:!m,applyTerrainMatrix:!0});j.draw(w,P.TRIANGLES,Kn.disabled,new Gn({func:P.ALWAYS,mask:0},Q,255,P.KEEP,P.KEEP,P.REPLACE),ar.disabled,m?Wn.disabled:Wn.backCCW,null,K,he,"$clipping",oe.vertexBuffer,oe.indexBuffer,oe.segments)}}_renderTilesDepthBuffer(){const s=this.context,u=s.gl,m=this.style.projection,v=this.transform,w=this.useProgram("depth"),P=this.getDepthModeFor3D(),D=De(v,{tileSize:v.tileSize});for(const F of D){const j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),W=m.getMeshFromTileID(this.context,F.canonical,!0,!0,"raster"),Q=v.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(s,u.TRIANGLES,P,Gn.disabled,ar.disabled,Wn.backCCW,null,j,Q,"$clipping",W.vertexBuffer,W.indexBuffer,W.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,u=this.context.gl;return new Gn({func:u.NOTEQUAL,mask:255},s,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(s){const u=this.context.gl;return new Gn({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(s){const u=this.context.gl,m=s.sort((P,D)=>D.overscaledZ-P.overscaledZ),v=m[m.length-1].overscaledZ,w=m[0].overscaledZ-v+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const P={};for(let D=0;D<w;D++)P[D+v]=new Gn({func:u.GEQUAL,mask:255},D+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=w,[P,m]}return[{[v]:Gn.disabled},m]}stencilConfigForOverlapTwoPass(s){const u=this.context.gl,m=s.sort((P,D)=>D.overscaledZ-P.overscaledZ),v=m[m.length-1].overscaledZ,w=m[0].overscaledZ-v+1;if(this.clearStencil(),w>1){const P={},D={};for(let F=0;F<w;F++)P[F+v]=new Gn({func:u.GREATER,mask:255},w+1+F,255,u.KEEP,u.KEEP,u.REPLACE),D[F+v]=new Gn({func:u.GREATER,mask:255},1+F,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*w+1,[P,D,m]}return this.nextStencilID=3,[{[v]:new Gn({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[v]:new Gn({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},m]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new ar([s.CONSTANT_COLOR,s.ONE],new o.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ar.unblended:ar.alphaBlended}getDepthModeForSublayer(s,u,m){if(!this.opaquePassEnabledForLayer())return Kn.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new Kn(m||this.context.gl.LEQUAL,u,[v,v])}getDepthModeFor3D(){return new Kn(this.context.gl.LEQUAL,Kn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,u){var m,v;this.style=s,this.options=u,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(M.now()),this.imageManager.beginFrame();const w=this.style._order,P=this.style.sourceCaches,D={},F={},j={},W={isRenderingToTexture:!1,isRenderingGlobe:((m=s.projection)===null||m===void 0?void 0:m.transitionState)>0};for(const K in P){const oe=P[K];oe.used&&oe.prepare(this.context),D[K]=oe.getVisibleCoordinates(!1),F[K]=D[K].slice().reverse(),j[K]=oe.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let K=0;K<w.length;K++)if(this.style._layers[w[K]].is3D()){this.opaquePassCutoff=K;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const K of w){const oe=this.style._layers[K];if(!oe.hasOffscreenPass()||oe.isHidden(this.transform.zoom))continue;const he=F[oe.source];(oe.type==="custom"||he.length)&&this.renderLayer(this,P[oe.source],oe,he,W)}if((v=this.style.projection)===null||v===void 0||v.updateGPUdependent({context:this.context,useProgram:K=>this.useProgram(K)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?o.be.black:o.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(K,oe){const he=K.context,Pe=he.gl,Ee=((Ke,$e,rt)=>{const yt=Math.cos($e.rollInRadians),ht=Math.sin($e.rollInRadians),pt=re($e),_t=$e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ke.properties.get("sky-color"),u_horizon_color:Ke.properties.get("horizon-color"),u_horizon:[($e.width/2-pt*ht)*rt,($e.height/2+pt*yt)*rt],u_horizon_normal:[-ht,yt],u_sky_horizon_blend:Ke.properties.get("sky-horizon-blend")*$e.height/2*rt,u_sky_blend:_t}})(oe,K.style.map.transform,K.pixelRatio),Ie=new Kn(Pe.LEQUAL,Kn.ReadWrite,[0,1]),Fe=Gn.disabled,He=K.colorModeForRenderPass(),Be=K.useProgram("sky"),Ye=$l(he,oe);Be.draw(he,Pe.TRIANGLES,Ie,Fe,He,Wn.disabled,Ee,null,void 0,"sky",Ye.vertexBuffer,Ye.indexBuffer,Ye.segments)}(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const K=this.style._layers[w[this.currentLayer]],oe=P[K.source],he=D[K.source];this._renderTileClippingMasks(K,he,!1),this.renderLayer(this,oe,K,he,W)}this.renderPass="translucent";let Q=!1;for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const K=this.style._layers[w[this.currentLayer]],oe=P[K.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(K,W))continue;this.opaquePassEnabledForLayer()||Q||(Q=!0,W.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const he=(K.type==="symbol"?j:F)[K.source];this._renderTileClippingMasks(K,D[K.source],!!this.renderToTexture),this.renderLayer(this,oe,K,he,W)}if(W.isRenderingGlobe&&function(K,oe,he){const Pe=K.context,Ee=Pe.gl,Ie=K.useProgram("atmosphere"),Fe=new Kn(Ee.LEQUAL,Kn.ReadOnly,[0,1]),He=K.transform,Be=function(_t,sn){const rn=_t.properties.get("position"),Vt=[-rn.x,-rn.y,-rn.z],Mn=o.af(new Float64Array(16));return _t.properties.get("anchor")==="map"&&(o.b5(Mn,Mn,sn.rollInRadians),o.b6(Mn,Mn,-sn.pitchInRadians),o.b5(Mn,Mn,sn.bearingInRadians),o.b6(Mn,Mn,sn.center.lat*Math.PI/180),o.by(Mn,Mn,-sn.center.lng*Math.PI/180)),o.c4(Vt,Vt,Mn),Vt}(he,K.transform),Ye=He.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ke=oe.properties.get("atmosphere-blend")*Ye.projectionTransition;if(Ke===0)return;const $e=Cu(He.worldSize,He.center.lat),rt=He.inverseProjectionMatrix,yt=new Float64Array(4);yt[3]=1,o.av(yt,yt,He.modelViewProjectionMatrix),yt[0]/=yt[3],yt[1]/=yt[3],yt[2]/=yt[3],yt[3]=1,o.av(yt,yt,rt),yt[0]/=yt[3],yt[1]/=yt[3],yt[2]/=yt[3],yt[3]=1;const ht=((_t,sn,rn,Vt,Mn)=>({u_sun_pos:_t,u_atmosphere_blend:sn,u_globe_position:rn,u_globe_radius:Vt,u_inv_proj_matrix:Mn}))(Be,Ke,[yt[0],yt[1],yt[2]],$e,rt),pt=$l(Pe,oe);Ie.draw(Pe,Ee.TRIANGLES,Fe,Gn.disabled,ar.alphaBlended,Wn.disabled,ht,null,null,"atmosphere",pt.vertexBuffer,pt.indexBuffer,pt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const K=function(oe,he){let Pe=null;const Ee=Object.values(oe._layers).flatMap(Be=>Be.source&&!Be.isHidden(he)?[oe.sourceCaches[Be.source]]:[]),Ie=Ee.filter(Be=>Be.getSource().type==="vector"),Fe=Ee.filter(Be=>Be.getSource().type!=="vector"),He=Be=>{(!Pe||Pe.getSource().maxzoom<Be.getSource().maxzoom)&&(Pe=Be)};return Ie.forEach(Be=>He(Be)),Pe||Fe.forEach(Be=>He(Be)),Pe}(this.style,this.transform.zoom);K&&function(oe,he,Pe){for(let Ee=0;Ee<Pe.length;Ee++)qx(oe,he,Pe[Ee])}(this,K,K.getVisibleCoordinates())}this.options.showPadding&&function(K){const oe=K.transform.padding;Ad(K,K.transform.height-(oe.top||0),3,Hx),Ad(K,oe.bottom||0,3,mp),gp(K,oe.left||0,3,Mv),gp(K,K.transform.width-(oe.right||0),3,Gx);const he=K.transform.centerPoint;(function(Pe,Ee,Ie,Fe){vp(Pe,Ee-1,Ie-10,2,20,Fe),vp(Pe,Ee-10,Ie-1,20,2,Fe)})(K,he.x,K.transform.height-he.y,Wx)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(s){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,m=this.transform.modelViewProjectionMatrix;let v=this.terrainFacilitator.dirty;v||(v=s?!o.c7(u,m):!o.c8(u,m)),v||(v=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),v&&(o.c9(u,m),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(w,P){const D=w.context,F=D.gl,j=w.transform,W=ar.unblended,Q=new Kn(F.LEQUAL,Kn.ReadWrite,[0,1]),K=P.sourceCache.getRenderableTiles(),oe=w.useProgram("terrainDepth");D.bindFramebuffer.set(P.getFramebuffer("depth").framebuffer),D.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),D.clear({color:o.be.transparent,depth:1});for(const he of K){const Pe=P.getTerrainMesh(he.tileID),Ee=P.getTerrainData(he.tileID),Ie=j.getProjectionData({overscaledTileID:he.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Fe={u_ele_delta:P.getMeshFrameDelta(j.zoom)};oe.draw(D,F.TRIANGLES,Q,Gn.disabled,W,Wn.backCCW,Fe,Ee,Ie,"terrain",Pe.vertexBuffer,Pe.indexBuffer,Pe.segments)}D.bindFramebuffer.set(null),D.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain),function(w,P){const D=w.context,F=D.gl,j=w.transform,W=ar.unblended,Q=new Kn(F.LEQUAL,Kn.ReadWrite,[0,1]),K=P.getCoordsTexture(),oe=P.sourceCache.getRenderableTiles(),he=w.useProgram("terrainCoords");D.bindFramebuffer.set(P.getFramebuffer("coords").framebuffer),D.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),D.clear({color:o.be.transparent,depth:1}),P.coordsIndex=[];for(const Pe of oe){const Ee=P.getTerrainMesh(Pe.tileID),Ie=P.getTerrainData(Pe.tileID);D.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,K.texture);const Fe={u_terrain_coords_id:(255-P.coordsIndex.length)/255,u_texture:0,u_ele_delta:P.getMeshFrameDelta(j.zoom)},He=j.getProjectionData({overscaledTileID:Pe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});he.draw(D,F.TRIANGLES,Q,Gn.disabled,W,Wn.backCCW,Fe,Ie,He,"terrain",Ee.vertexBuffer,Ee.indexBuffer,Ee.segments),P.coordsIndex.push(Pe.tileID.key)}D.bindFramebuffer.set(null),D.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain))}renderLayer(s,u,m,v,w){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="custom"||(v||[]).length)&&(this.id=m.id,o.ca(m)?function(P,D,F,j,W,Q){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:K}=Q,oe=Gn.disabled,he=P.colorModeForRenderPass();(F._unevaluatedLayout.hasValue("text-variable-anchor")||F._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Pe,Ee,Ie,Fe,He,Be,Ye,Ke,$e){const rt=Ee.transform,yt=Ee.style.map.terrain,ht=He==="map",pt=Be==="map";for(const _t of Pe){const sn=Fe.getTile(_t),rn=sn.getBucket(Ie);if(!rn||!rn.text||!rn.text.segments.get().length)continue;const Vt=o.am(rn.textSizeData,rt.zoom),Mn=o.aB(sn,1,Ee.transform.zoom),Jn=tt(ht,Ee.transform,Mn),Cr=Ie.layout.get("icon-text-fit")!=="none"&&rn.hasIconData();if(Vt){const ni=Math.pow(2,rt.zoom-sn.tileID.overscaledZ),Ar=yt?(ri,zr)=>yt.getElevation(_t,ri,zr):null;G2(rn,ht,pt,$e,rt,Jn,ni,Vt,Cr,o.aC(rt,sn,Ye,Ke),_t.toUnwrapped(),Ar)}}}(j,P,F,D,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),W),F.paint.get("icon-opacity").constantOr(1)!==0&&jx(P,D,F,j,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),oe,he,K),F.paint.get("text-opacity").constantOr(1)!==0&&jx(P,D,F,j,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),oe,he,K),D.map.showCollisionBoxes&&(Ux(P,D,F,j,!0),Ux(P,D,F,j,!1))}(s,u,m,v,this.style.placement.variableOffsets,w):o.cb(m)?function(P,D,F,j,W){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:Q}=W,K=F.paint.get("circle-opacity"),oe=F.paint.get("circle-stroke-width"),he=F.paint.get("circle-stroke-opacity"),Pe=!F.layout.get("circle-sort-key").isConstant();if(K.constantOr(1)===0&&(oe.constantOr(1)===0||he.constantOr(1)===0))return;const Ee=P.context,Ie=Ee.gl,Fe=P.transform,He=P.getDepthModeForSublayer(0,Kn.ReadOnly),Be=Gn.disabled,Ye=P.colorModeForRenderPass(),Ke=[],$e=Fe.getCircleRadiusCorrection();for(let rt=0;rt<j.length;rt++){const yt=j[rt],ht=D.getTile(yt),pt=ht.getBucket(F);if(!pt)continue;const _t=F.paint.get("circle-translate"),sn=F.paint.get("circle-translate-anchor"),rn=o.aC(Fe,ht,_t,sn),Vt=pt.programConfigurations.get(F.id),Mn=P.useProgram("circle",Vt),Jn=pt.layoutVertexBuffer,Cr=pt.indexBuffer,ni=P.style.map.terrain&&P.style.map.terrain.getTerrainData(yt),Ar={programConfiguration:Vt,program:Mn,layoutVertexBuffer:Jn,indexBuffer:Cr,uniformValues:av(P,ht,F,rn,$e),terrainData:ni,projectionData:Fe.getProjectionData({overscaledTileID:yt,applyGlobeMatrix:!Q,applyTerrainMatrix:!0})};if(Pe){const ri=pt.segments.get();for(const zr of ri)Ke.push({segments:new o.aL([zr]),sortKey:zr.sortKey,state:Ar})}else Ke.push({segments:pt.segments,sortKey:0,state:Ar})}Pe&&Ke.sort((rt,yt)=>rt.sortKey-yt.sortKey);for(const rt of Ke){const{programConfiguration:yt,program:ht,layoutVertexBuffer:pt,indexBuffer:_t,uniformValues:sn,terrainData:rn,projectionData:Vt}=rt.state;ht.draw(Ee,Ie.TRIANGLES,He,Be,Ye,Wn.backCCW,sn,rn,Vt,F.id,pt,_t,rt.segments,F.paint,P.transform.zoom,yt)}}(s,u,m,v,w):o.cc(m)?function(P,D,F,j,W){if(F.paint.get("heatmap-opacity")===0)return;const Q=P.context,{isRenderingToTexture:K,isRenderingGlobe:oe}=W;if(P.style.map.terrain){for(const he of j){const Pe=D.getTile(he);D.hasRenderableParent(he)||(P.renderPass==="offscreen"?dp(P,Pe,F,he,oe):P.renderPass==="translucent"&&fp(P,F,he,K,oe))}Q.viewport.set([0,0,P.width,P.height])}else P.renderPass==="offscreen"?function(he,Pe,Ee,Ie){const Fe=he.context,He=Fe.gl,Be=he.transform,Ye=Gn.disabled,Ke=new ar([He.ONE,He.ONE],o.be.transparent,[!0,!0,!0,!0]);(function($e,rt,yt){const ht=$e.gl;$e.activeTexture.set(ht.TEXTURE1),$e.viewport.set([0,0,rt.width/4,rt.height/4]);let pt=yt.heatmapFbos.get(o.c1);pt?(ht.bindTexture(ht.TEXTURE_2D,pt.colorAttachment.get()),$e.bindFramebuffer.set(pt.framebuffer)):(pt=Ed($e,rt.width/4,rt.height/4),yt.heatmapFbos.set(o.c1,pt))})(Fe,he,Ee),Fe.clear({color:o.be.transparent});for(let $e=0;$e<Ie.length;$e++){const rt=Ie[$e];if(Pe.hasRenderableParent(rt))continue;const yt=Pe.getTile(rt),ht=yt.getBucket(Ee);if(!ht)continue;const pt=ht.programConfigurations.get(Ee.id),_t=he.useProgram("heatmap",pt),sn=Be.getProjectionData({overscaledTileID:rt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),rn=Be.getCircleRadiusCorrection();_t.draw(Fe,He.TRIANGLES,Kn.disabled,Ye,Ke,Wn.backCCW,wd(yt,Be.zoom,Ee.paint.get("heatmap-intensity"),rn),null,sn,Ee.id,ht.layoutVertexBuffer,ht.indexBuffer,ht.segments,Ee.paint,Be.zoom,pt)}Fe.viewport.set([0,0,he.width,he.height])}(P,D,F,j):P.renderPass==="translucent"&&function(he,Pe){const Ee=he.context,Ie=Ee.gl;Ee.setColorMode(he.colorModeForRenderPass());const Fe=Pe.heatmapFbos.get(o.c1);Fe&&(Ee.activeTexture.set(Ie.TEXTURE0),Ie.bindTexture(Ie.TEXTURE_2D,Fe.colorAttachment.get()),Ee.activeTexture.set(Ie.TEXTURE1),pp(Ee,Pe).bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),he.useProgram("heatmapTexture").draw(Ee,Ie.TRIANGLES,Kn.disabled,Gn.disabled,he.colorModeForRenderPass(),Wn.disabled,Cx(he,Pe,0,1),null,null,Pe.id,he.viewportBuffer,he.quadTriangleIndexBuffer,he.viewportSegments,Pe.paint,he.transform.zoom))}(P,F)}(s,u,m,v,w):o.cd(m)?function(P,D,F,j,W){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:Q}=W,K=F.paint.get("line-opacity"),oe=F.paint.get("line-width");if(K.constantOr(1)===0||oe.constantOr(1)===0)return;const he=P.getDepthModeForSublayer(0,Kn.ReadOnly),Pe=P.colorModeForRenderPass(),Ee=F.paint.get("line-dasharray"),Ie=F.paint.get("line-pattern"),Fe=Ie.constantOr(1),He=F.paint.get("line-gradient"),Be=F.getCrossfadeParameters(),Ye=Fe?"linePattern":Ee?"lineSDF":He?"lineGradient":"line",Ke=P.context,$e=Ke.gl,rt=P.transform;let yt=!0;for(const ht of j){const pt=D.getTile(ht);if(Fe&&!pt.patternsLoaded())continue;const _t=pt.getBucket(F);if(!_t)continue;const sn=_t.programConfigurations.get(F.id),rn=P.context.program.get(),Vt=P.useProgram(Ye,sn),Mn=yt||Vt.program!==rn,Jn=P.style.map.terrain&&P.style.map.terrain.getTerrainData(ht),Cr=Ie.constantOr(null);if(Cr&&pt.imageAtlas){const Ir=pt.imageAtlas,Or=Ir.patternPositions[Cr.to.toString()],no=Ir.patternPositions[Cr.from.toString()];Or&&no&&sn.setConstantPatternPositions(Or,no)}const ni=rt.getProjectionData({overscaledTileID:ht,applyGlobeMatrix:!Q,applyTerrainMatrix:!0}),Ar=rt.getPixelScale(),ri=Fe?Tx(P,pt,F,Ar,Be):Ee?Px(P,pt,F,Ar,Ee,Be):He?lv(P,pt,F,Ar,_t.lineClipsArray.length):rp(P,pt,F,Ar);if(Fe)Ke.activeTexture.set($e.TEXTURE0),pt.imageAtlasTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE),sn.updatePaintBuffers(Be);else if(Ee&&(Mn||P.lineAtlas.dirty))Ke.activeTexture.set($e.TEXTURE0),P.lineAtlas.bind(Ke);else if(He){const Ir=_t.gradients[F.id];let Or=Ir.texture;if(F.gradientVersion!==Ir.version){let no=256;if(F.stepInterpolant){const hr=D.getSource().maxzoom,Gi=ht.canonical.z===hr?Math.ceil(1<<P.transform.maxZoom-ht.canonical.z):1;no=o.ag(o.c2(_t.maxLineLength/o.$*1024*Gi),256,Ke.maxTextureSize)}Ir.gradient=o.c3({expression:F.gradientExpression(),evaluationKey:"lineProgress",resolution:no,image:Ir.gradient||void 0,clips:_t.lineClipsArray}),Ir.texture?Ir.texture.update(Ir.gradient):Ir.texture=new o.T(Ke,Ir.gradient,$e.RGBA),Ir.version=F.gradientVersion,Or=Ir.texture}Ke.activeTexture.set($e.TEXTURE0),Or.bind(F.stepInterpolant?$e.NEAREST:$e.LINEAR,$e.CLAMP_TO_EDGE)}const zr=P.stencilModeForClipping(ht);Vt.draw(Ke,$e.TRIANGLES,he,zr,Pe,Wn.disabled,ri,Jn,ni,F.id,_t.layoutVertexBuffer,_t.indexBuffer,_t.segments,F.paint,P.transform.zoom,sn,_t.layoutVertexBuffer2),yt=!1}}(s,u,m,v,w):o.ce(m)?function(P,D,F,j,W){const Q=F.paint.get("fill-color"),K=F.paint.get("fill-opacity");if(K.constantOr(1)===0)return;const{isRenderingToTexture:oe}=W,he=P.colorModeForRenderPass(),Pe=F.paint.get("fill-pattern"),Ee=P.opaquePassEnabledForLayer()&&!Pe.constantOr(1)&&Q.constantOr(o.be.transparent).a===1&&K.constantOr(0)===1?"opaque":"translucent";if(P.renderPass===Ee){const Ie=P.getDepthModeForSublayer(1,P.renderPass==="opaque"?Kn.ReadWrite:Kn.ReadOnly);Td(P,D,F,j,Ie,he,!1,oe)}if(P.renderPass==="translucent"&&F.paint.get("fill-antialias")){const Ie=P.getDepthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Kn.ReadOnly);Td(P,D,F,j,Ie,he,!0,oe)}}(s,u,m,v,w):o.cf(m)?function(P,D,F,j,W){const Q=F.paint.get("fill-extrusion-opacity");if(Q===0)return;const{isRenderingToTexture:K}=W;if(P.renderPass==="translucent"){const oe=new Kn(P.context.gl.LEQUAL,Kn.ReadWrite,P.depthRangeFor3D);if(Q!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))Fu(P,D,F,j,oe,Gn.disabled,ar.disabled,K),Fu(P,D,F,j,oe,P.stencilModeFor3D(),P.colorModeForRenderPass(),K);else{const he=P.colorModeForRenderPass();Fu(P,D,F,j,oe,Gn.disabled,he,K)}}}(s,u,m,v,w):o.cg(m)?function(P,D,F,j,W){if(P.renderPass!=="offscreen"&&P.renderPass!=="translucent")return;const{isRenderingToTexture:Q}=W,K=P.context,oe=P.style.projection.useSubdivision,he=P.getDepthModeForSublayer(0,Kn.ReadOnly),Pe=P.colorModeForRenderPass();if(P.renderPass==="offscreen")(function(Ee,Ie,Fe,He,Be,Ye,Ke){const $e=Ee.context,rt=$e.gl;for(const yt of Fe){const ht=Ie.getTile(yt),pt=ht.dem;if(!pt||!pt.data||!ht.needsHillshadePrepare)continue;const _t=pt.dim,sn=pt.stride,rn=pt.getPixels();if($e.activeTexture.set(rt.TEXTURE1),$e.pixelStoreUnpackPremultiplyAlpha.set(!1),ht.demTexture=ht.demTexture||Ee.getTileTexture(sn),ht.demTexture){const Mn=ht.demTexture;Mn.update(rn,{premultiply:!1}),Mn.bind(rt.NEAREST,rt.CLAMP_TO_EDGE)}else ht.demTexture=new o.T($e,rn,rt.RGBA,{premultiply:!1}),ht.demTexture.bind(rt.NEAREST,rt.CLAMP_TO_EDGE);$e.activeTexture.set(rt.TEXTURE0);let Vt=ht.fbo;if(!Vt){const Mn=new o.T($e,{width:_t,height:_t,data:null},rt.RGBA);Mn.bind(rt.LINEAR,rt.CLAMP_TO_EDGE),Vt=ht.fbo=$e.createFramebuffer(_t,_t,!0,!1),Vt.colorAttachment.set(Mn.texture)}$e.bindFramebuffer.set(Vt.framebuffer),$e.viewport.set([0,0,_t,_t]),Ee.useProgram("hillshadePrepare").draw($e,rt.TRIANGLES,Be,Ye,Ke,Wn.disabled,z2(ht.tileID,pt),null,null,He.id,Ee.rasterBoundsBuffer,Ee.quadTriangleIndexBuffer,Ee.rasterBoundsSegments),ht.needsHillshadePrepare=!1}})(P,D,j,F,he,Gn.disabled,Pe),K.viewport.set([0,0,P.width,P.height]);else if(P.renderPass==="translucent")if(oe){const[Ee,Ie,Fe]=P.stencilConfigForOverlapTwoPass(j);Nu(P,D,F,Fe,Ee,he,Pe,!1,Q),Nu(P,D,F,Fe,Ie,he,Pe,!0,Q)}else{const[Ee,Ie]=P.getStencilConfigForOverlapAndUpdateStencilID(j);Nu(P,D,F,Ie,Ee,he,Pe,!1,Q)}}(s,u,m,v,w):o.ch(m)?function(P,D,F,j,W){if(P.renderPass!=="translucent"||!j.length)return;const{isRenderingToTexture:Q}=W,K=P.style.projection.useSubdivision,oe=P.getDepthModeForSublayer(0,Kn.ReadOnly),he=P.colorModeForRenderPass();if(K){const[Pe,Ee,Ie]=P.stencilConfigForOverlapTwoPass(j);Pd(P,D,F,Ie,Pe,oe,he,!1,Q),Pd(P,D,F,Ie,Ee,oe,he,!0,Q)}else{const[Pe,Ee]=P.getStencilConfigForOverlapAndUpdateStencilID(j);Pd(P,D,F,Ee,Pe,oe,he,!1,Q)}}(s,u,m,v,w):o.ci(m)?function(P,D,F,j,W){if(P.renderPass!=="translucent"||F.paint.get("raster-opacity")===0||!j.length)return;const{isRenderingToTexture:Q}=W,K=D.getSource(),oe=P.style.projection.useSubdivision;if(K instanceof An)Ul(P,D,F,j,null,!1,!1,K.tileCoords,K.flippedWindingOrder,Q);else if(oe){const[he,Pe,Ee]=P.stencilConfigForOverlapTwoPass(j);Ul(P,D,F,Ee,he,!1,!0,Sv,!1,Q),Ul(P,D,F,Ee,Pe,!0,!0,Sv,!1,Q)}else{const[he,Pe]=P.getStencilConfigForOverlapAndUpdateStencilID(j);Ul(P,D,F,Pe,he,!1,!0,Sv,!1,Q)}}(s,u,m,v,w):o.cj(m)?function(P,D,F,j,W){const Q=F.paint.get("background-color"),K=F.paint.get("background-opacity");if(K===0)return;const{isRenderingToTexture:oe}=W,he=P.context,Pe=he.gl,Ee=P.style.projection,Ie=P.transform,Fe=Ie.tileSize,He=F.paint.get("background-pattern");if(P.isPatternMissing(He))return;const Be=!He&&Q.a===1&&K===1&&P.opaquePassEnabledForLayer()?"opaque":"translucent";if(P.renderPass!==Be)return;const Ye=Gn.disabled,Ke=P.getDepthModeForSublayer(0,Be==="opaque"?Kn.ReadWrite:Kn.ReadOnly),$e=P.colorModeForRenderPass(),rt=P.useProgram(He?"backgroundPattern":"background"),yt=j||De(Ie,{tileSize:Fe,terrain:P.style.map.terrain});He&&(he.activeTexture.set(Pe.TEXTURE0),P.imageManager.bind(P.context));const ht=F.getCrossfadeParameters();for(const pt of yt){const _t=Ie.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!oe,applyTerrainMatrix:!0}),sn=He?N2(K,P,He,{tileID:pt,tileSize:Fe},ht):ip(K,Q),rn=P.style.map.terrain&&P.style.map.terrain.getTerrainData(pt),Vt=Ee.getMeshFromTileID(he,pt.canonical,!1,!0,"raster");rt.draw(he,Pe.TRIANGLES,Ke,Ye,$e,Wn.backCCW,sn,rn,_t,F.id,Vt.vertexBuffer,Vt.indexBuffer,Vt.segments)}}(s,0,m,v,w):o.ck(m)&&function(P,D,F,j){const{isRenderingGlobe:W}=j,Q=P.context,K=F.implementation,oe=P.style.projection,he=P.transform,Pe=he.getProjectionDataForCustomLayer(W),Ee={farZ:he.farZ,nearZ:he.nearZ,fov:he.fov*Math.PI/180,modelViewProjectionMatrix:he.modelViewProjectionMatrix,projectionMatrix:he.projectionMatrix,shaderData:{variantName:oe.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${oe.shaderPreludeCode.vertexSource}`,define:oe.shaderDefine},defaultProjectionData:Pe},Ie=K.renderingMode?K.renderingMode:"2d";if(P.renderPass==="offscreen"){const Fe=K.prerender;Fe&&(P.setCustomLayerDefaults(),Q.setColorMode(P.colorModeForRenderPass()),Fe.call(K,Q.gl,Ee),Q.setDirty(),P.setBaseState())}else if(P.renderPass==="translucent"){P.setCustomLayerDefaults(),Q.setColorMode(P.colorModeForRenderPass()),Q.setStencilMode(Gn.disabled);const Fe=Ie==="3d"?P.getDepthModeFor3D():P.getDepthModeForSublayer(0,Kn.ReadOnly);Q.setDepthMode(Fe),K.render(Q.gl,Ee),Q.setDirty(),P.setBaseState(),Q.bindFramebuffer.set(null)}}(s,0,m,w))}saveTileTexture(s){const u=this._tileTextures[s.size[0]];u?u.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const u=this._tileTextures[s];return u&&u.length>0?u.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const u=this.imageManager.getPattern(s.from.toString()),m=this.imageManager.getPattern(s.to.toString());return!u||!m}useProgram(s,u,m=!1,v=[]){this.cache=this.cache||{};const w=!!this.style.map.terrain,P=this.style.projection,D=m?Vi.projectionMercator:P.shaderPreludeCode,F=m?Tc:P.shaderDefine,j=s+(u?u.cacheKey:"")+`/${m?Qg:P.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(w?"/terrain":"")+(v?`/${v.join("/")}`:"");return this.cache[j]||(this.cache[j]=new ep(this.context,Vi[s],u,Rx[s],this._showOverdrawInspector,w,D,F,v)),this.cache[j]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:s,drawingBufferHeight:u}=this.context.gl;return this.width!==s||this.height!==u}}function yp(b,s){let u,m=!1,v=null,w=null;const P=()=>{v=null,m&&(b.apply(w,u),v=setTimeout(P,s),m=!1)};return(...D)=>(m=!0,w=this,u=D,v||P(),v)}class Id{constructor(s){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let m;return u.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(m=v)}),(m&&m[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const m=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:m,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const m=u.join("/");let v=m;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${m}`);let w=window.location.hash.replace(v,"");w.startsWith("#&")?w=w.slice(0,1)+w.slice(2):w==="#"&&(w="");let P=window.location.href.replace(/(#.+)?$/,w);P=P.replace("&&","&"),window.history.replaceState(window.history.state,null,P)},this._updateHash=yp(this._updateHashUnthrottled,300),this._hashName=s&&encodeURIComponent(s)}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(s){const u=this._map.getCenter(),m=Math.round(100*this._map.getZoom())/100,v=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,v),P=Math.round(u.lng*w)/w,D=Math.round(u.lat*w)/w,F=this._map.getBearing(),j=this._map.getPitch();let W="";if(W+=s?`/${P}/${D}/${m}`:`${m}/${D}/${P}`,(F||j)&&(W+="/"+Math.round(10*F)/10),j&&(W+=`/${Math.round(j)}`),this._hashName){const Q=this._hashName;let K=!1;const oe=window.location.hash.slice(1).split("&").map(he=>{const Pe=he.split("=")[0];return Pe===Q?(K=!0,`${Pe}=${W}`):he}).filter(he=>he);return K||oe.push(`${Q}=${W}`),`#${oe.join("&")}`}return`#${W}`}_isValidHash(s){if(s.length<3||s.some(isNaN))return!1;try{new o.S(+s[2],+s[1])}catch{return!1}const u=+s[0],m=+(s[3]||0),v=+(s[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&m>=-180&&m<=180&&v>=this._map.getMinPitch()&&v<=this._map.getMaxPitch()}}const Bu={linearity:.3,easing:o.cl(0,0,.3,1)},Uu=o.e({deceleration:2500,maxSpeed:1400},Bu),Cv=o.e({deceleration:20,maxSpeed:1400},Bu),Rd=o.e({deceleration:1e3,maxSpeed:360},Bu),Ev=o.e({deceleration:1e3,maxSpeed:90},Bu),Xx=o.e({deceleration:1e3,maxSpeed:360},Bu);class Zx{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:M.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,u=M.now();for(;s.length>0&&u-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)u.zoom+=w.zoomDelta||0,u.bearing+=w.bearingDelta||0,u.pitch+=w.pitchDelta||0,u.roll+=w.rollDelta||0,w.panDelta&&u.pan._add(w.panDelta),w.around&&(u.around=w.around),w.pinchAround&&(u.pinchAround=w.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(u.pan.mag()){const w=Vu(u.pan.mag(),m,o.e({},Uu,s||{})),P=u.pan.mult(w.amount/u.pan.mag()),D=this._map.cameraHelper.handlePanInertia(P,this._map.transform);v.center=D.easingCenter,v.offset=D.easingOffset,$u(v,w)}if(u.zoom){const w=Vu(u.zoom,m,Cv);v.zoom=this._map.transform.zoom+w.amount,$u(v,w)}if(u.bearing){const w=Vu(u.bearing,m,Rd);v.bearing=this._map.transform.bearing+o.ag(w.amount,-179,179),$u(v,w)}if(u.pitch){const w=Vu(u.pitch,m,Ev);v.pitch=this._map.transform.pitch+w.amount,$u(v,w)}if(u.roll){const w=Vu(u.roll,m,Xx);v.roll=this._map.transform.roll+o.ag(w.amount,-179,179),$u(v,w)}if(v.zoom||v.bearing){const w=u.pinchAround===void 0?u.around:u.pinchAround;v.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),o.e(v,{noMoveStart:!0})}}function $u(b,s){(!b.duration||b.duration<s.duration)&&(b.duration=s.duration,b.easing=s.easing)}function Vu(b,s,u){const{maxSpeed:m,linearity:v,deceleration:w}=u,P=o.ag(b*v/(s/1e3),-m,m),D=Math.abs(P)/(w*v);return{easing:u.easing,duration:1e3*D,amount:P*(D/2)}}class Jo extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,m,v={}){m=m instanceof MouseEvent?m:new MouseEvent(s,m);const w=C.mousePos(u.getCanvas(),m),P=u.unproject(w);super(s,o.e({point:w,lngLat:P,originalEvent:m},v)),this._defaultPrevented=!1,this.target=u}}class Js extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,m){const v=s==="touchend"?m.changedTouches:m.touches,w=C.touchPos(u.getCanvasContainer(),v),P=w.map(F=>u.unproject(F)),D=w.reduce((F,j,W,Q)=>F.add(j.div(Q.length)),new o.P(0,0));super(s,{points:w,point:D,lngLats:P,lngLat:u.unproject(D),originalEvent:m}),this._defaultPrevented=!1}}class Tv extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,m){super(s,{originalEvent:m}),this._defaultPrevented=!1}}class Yx{constructor(s,u){this._map=s,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new Tv(s.type,this._map,s))}mousedown(s,u){return this._mousedownPos=u,this._firePreventable(new Jo(s.type,this._map,s))}mouseup(s){this._map.fire(new Jo(s.type,this._map,s))}click(s,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Jo(s.type,this._map,s))}dblclick(s){return this._firePreventable(new Jo(s.type,this._map,s))}mouseover(s){this._map.fire(new Jo(s.type,this._map,s))}mouseout(s){this._map.fire(new Jo(s.type,this._map,s))}touchstart(s){return this._firePreventable(new Js(s.type,this._map,s))}touchmove(s){this._map.fire(new Js(s.type,this._map,s))}touchend(s){this._map.fire(new Js(s.type,this._map,s))}touchcancel(s){this._map.fire(new Js(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Kx{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new Jo(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Jo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new Jo(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ju{constructor(s){this._map=s}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(s){return this.transform.screenPointToLocation(o.P.convert(s),this._map.terrain)}}class Pv{constructor(s,u){this._map=s,this._tr=new ju(s),this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,u){this.isEnabled()&&s.shiftKey&&s.button===0&&(C.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(s,u){if(!this._active)return;const m=u;if(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=m,this._box||(this._box=C.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",s));const w=Math.min(v.x,m.x),P=Math.max(v.x,m.x),D=Math.min(v.y,m.y),F=Math.max(v.y,m.y);C.setTransform(this._box,`translate(${w}px,${D}px)`),this._box.style.width=P-w+"px",this._box.style.height=F-D+"px"}mouseupWindow(s,u){if(!this._active||s.button!==0)return;const m=this._startPos,v=u;if(this.reset(),C.suppressClick(),m.x!==v.x||m.y!==v.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:s})),{cameraAnimation:w=>w.fitScreenCoordinates(m,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(C.remove(this._box),this._box=null),C.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,u){return this._map.fire(new o.l(s,{originalEvent:u}))}}function _p(b,s){if(b.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${s.length}`);const u={};for(let m=0;m<b.length;m++)u[b[m].identifier]=s[m];return u}class Jx{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,u,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),m.length===this.numTouches&&(this.centroid=function(v){const w=new o.P(0,0);for(const P of v)w._add(P);return w.div(v.length)}(u),this.touches=_p(m,u)))}touchmove(s,u,m){if(this.aborted||!this.centroid)return;const v=_p(m,u);for(const w in this.touches){const P=v[w];(!P||P.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(s,u,m){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class xp{constructor(s){this.singleTap=new Jx(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,u,m){this.singleTap.touchstart(s,u,m)}touchmove(s,u,m){this.singleTap.touchmove(s,u,m)}touchend(s,u,m){const v=this.singleTap.touchend(s,u,m);if(v){const w=s.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(v)<30;if(w&&P||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class bp{constructor(s){this._tr=new ju(s),this._zoomIn=new xp({numTouches:1,numTaps:2}),this._zoomOut=new xp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,u,m){this._zoomIn.touchstart(s,u,m),this._zoomOut.touchstart(s,u,m)}touchmove(s,u,m){this._zoomIn.touchmove(s,u,m),this._zoomOut.touchmove(s,u,m)}touchend(s,u,m){const v=this._zoomIn.touchend(s,u,m),w=this._zoomOut.touchend(s,u,m),P=this._tr;return v?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:P.zoom+1,around:P.unproject(v)},{originalEvent:s})}):w?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:P.zoom-1,around:P.unproject(w)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hu{constructor(s){this._enabled=!!s.enable,this._moveStateManager=s.moveStateManager,this._clickTolerance=s.clickTolerance||1,this._moveFunction=s.move,this._activateOnStart=!!s.activateOnStart,s.assignEvents(this),this.reset()}reset(s){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(s)}_move(...s){const u=this._moveFunction(...s);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(s,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(s)&&(this._moveStateManager.startMove(s),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(s,u){if(!this.isEnabled())return;const m=this._lastPoint;if(!m)return;if(s.preventDefault(),!this._moveStateManager.isValidMoveEvent(s))return void this.reset(s);const v=Array.isArray(u)?u[0]:u;return!this._moved&&v.dist(m)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(m,v))}dragEnd(s){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(s)&&(this._moved&&C.suppressClick(),this.reset(s))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Is=0,Qs=2,Qx={[Is]:1,[Qs]:2};class ko{constructor(s){this._correctEvent=s.checkCorrectEvent}startMove(s){const u=C.mouseButton(s);this._eventButton=u}endMove(s){delete this._eventButton}isValidStartEvent(s){return this._correctEvent(s)}isValidMoveEvent(s){return!function(u,m){const v=Qx[m];return u.buttons===void 0||(u.buttons&v)!==v}(s,this._eventButton)}isValidEndEvent(s){return C.mouseButton(s)===this._eventButton}}class Gu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(s){return s.targetTouches.length===1}_isSameTouchEvent(s){return s.targetTouches[0].identifier===this._firstTouch}startMove(s){this._firstTouch=s.targetTouches[0].identifier}endMove(s){delete this._firstTouch}isValidStartEvent(s){return this._isOneFingerTouch(s)}isValidMoveEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}isValidEndEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}}class q2{constructor(s=new ko({checkCorrectEvent:()=>!0}),u=new Gu){this.mouseMoveStateManager=s,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(s,u,m){return s instanceof MouseEvent?u(s):typeof TouchEvent<"u"&&s instanceof TouchEvent?m(s):void 0}startMove(s){this._executeRelevantHandler(s,u=>this.mouseMoveStateManager.startMove(u),u=>this.oneFingerTouchMoveStateManager.startMove(u))}endMove(s){this._executeRelevantHandler(s,u=>this.mouseMoveStateManager.endMove(u),u=>this.oneFingerTouchMoveStateManager.endMove(u))}isValidStartEvent(s){return this._executeRelevantHandler(s,u=>this.mouseMoveStateManager.isValidStartEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u))}isValidMoveEvent(s){return this._executeRelevantHandler(s,u=>this.mouseMoveStateManager.isValidMoveEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u))}isValidEndEvent(s){return this._executeRelevantHandler(s,u=>this.mouseMoveStateManager.isValidEndEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u))}}const wp=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=s=>{s.preventDefault()}};class X2{constructor(s,u){this._clickTolerance=s.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(s){return s<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(s,u,m){return this._calculateTransform(s,u,m)}touchmove(s,u,m){if(this._active){if(!this._shouldBePrevented(m.length))return s.preventDefault(),this._calculateTransform(s,u,m);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",s)}}touchend(s,u,m){this._calculateTransform(s,u,m),this._active&&this._shouldBePrevented(m.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,u,m){m.length>0&&(this._active=!0);const v=_p(m,u),w=new o.P(0,0),P=new o.P(0,0);let D=0;for(const j in v){const W=v[j],Q=this._touches[j];Q&&(w._add(W),P._add(W.sub(Q)),D++,v[j]=W)}if(this._touches=v,this._shouldBePrevented(D)||!P.mag())return;const F=P.div(D);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(D),panDelta:F}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Av{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(s,u,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([u[0],u[1]]))}touchmove(s,u,m){if(!this._firstTwoTouches)return;s.preventDefault();const[v,w]=this._firstTwoTouches,P=Ld(m,u,v),D=Ld(m,u,w);if(!P||!D)return;const F=this._aroundCenter?null:P.add(D).div(2);return this._move([P,D],F,s)}touchend(s,u,m){if(!this._firstTwoTouches)return;const[v,w]=this._firstTwoTouches,P=Ld(m,u,v),D=Ld(m,u,w);P&&D||(this._active&&C.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ld(b,s,u){for(let m=0;m<b.length;m++)if(b[m].identifier===u)return s[m]}function Wu(b,s){return Math.log(b/s)/Math.LN2}class ka extends Av{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,u){const m=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(Wu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Wu(this._distance,m),pinchAround:u}}}function xn(b,s){return 180*b.angleWith(s)/Math.PI}class Iv extends Av{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,u,m){const v=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xn(this._vector,v),pinchAround:u}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const u=25/(Math.PI*this._minDiameter)*360,m=xn(s,this._startVector);return Math.abs(m)<u}}function kd(b){return Math.abs(b.y)>Math.abs(b.x)}class Rv extends Av{constructor(s){super(),this._currentTouchCount=0,this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,u,m){super.touchstart(s,u,m),this._currentTouchCount=m.length}_start(s){this._lastPoints=s,kd(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,u,m){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const v=s[0].sub(this._lastPoints[0]),w=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,w,m.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(v.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(s,u,m){if(this._valid!==void 0)return this._valid;const v=s.mag()>=2,w=u.mag()>=2;if(!v&&!w)return;if(!v||!w)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;const P=s.y>0==u.y>0;return kd(s)&&kd(u)&&P}}const Dd={panStep:100,bearingStep:15,pitchStep:10};class qu{constructor(s){this._tr=new ju(s);const u=Dd;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let u=0,m=0,v=0,w=0,P=0;switch(s.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:s.shiftKey?m=-1:(s.preventDefault(),w=-1);break;case 39:s.shiftKey?m=1:(s.preventDefault(),w=1);break;case 38:s.shiftKey?v=1:(s.preventDefault(),P=-1);break;case 40:s.shiftKey?v=-1:(s.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(m=0,v=0),{cameraAnimation:D=>{const F=this._tr;D.easeTo({duration:300,easeId:"keyboardHandler",easing:Lv,zoom:u?Math.round(F.zoom)+u*(s.shiftKey?2:1):F.zoom,bearing:F.bearing+m*this._bearingStep,pitch:F.pitch+v*this._pitchStep,offset:[-w*this._panStep,-P*this._panStep],center:F.center},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Lv(b){return b*(2-b)}const rr=4.000244140625,kv=1/450;class e1{constructor(s,u){this._onTimeout=m=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(m)},this._map=s,this._tr=new ju(s),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=kv}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(s){return!!this._map.cooperativeGestures.isEnabled()&&!(s.ctrlKey||this._map.cooperativeGestures.isBypassed(s))}wheel(s){if(!this.isEnabled())return;if(this._shouldBePrevented(s))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",s);let u=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const m=M.now(),v=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,u!==0&&u%rr==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(v*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),s.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=s,this._delta-=u,this._active||this._start(s)),s.preventDefault()}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=C.mousePos(this._map.getCanvas(),s),m=this._tr;this._aroundPoint=this._aroundCenter?m.transform.locationToScreenPoint(o.S.convert(m.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const D=s.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=D),typeof this._targetZoom=="number"&&(this._targetZoom+=D)}if(this._delta!==0){const D=this._type==="wheel"&&Math.abs(this._delta)>rr?this._wheelZoomRate:this._defaultZoomRate;let F=2/(1+Math.exp(-Math.abs(this._delta*D)));this._delta<0&&F!==0&&(F=1/F);const j=typeof this._targetZoom!="number"?s.scale:o.ae(this._targetZoom);this._targetZoom=s.getConstrained(s.getCameraLngLat(),o.aj(j*F)).zoom,this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?s.zoom:this._targetZoom,m=this._startZoom,v=this._easing;let w,P=!1;if(this._type==="wheel"&&m&&v){const D=M.now()-this._lastWheelEventTime,F=Math.min((D+5)/200,1),j=v(F);w=o.C.number(m,u,j),F<1?this._frameId||(this._frameId=!0):P=!0}else w=u,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=w,{noInertia:!0,needsRenderFrame:!P,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let u=o.cn;if(this._prevEase){const m=this._prevEase,v=(M.now()-m.start)/m.duration,w=m.easing(v+.01)-m.easing(v),P=.27/Math.sqrt(w*w+1e-4)*.01,D=Math.sqrt(.0729-P*P);u=o.cl(P,D,.25,1)}return this._prevEase={start:M.now(),duration:s,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Sp{constructor(s,u){this._clickZoom=s,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Z2{constructor(s){this._tr=new ju(s),this.reset()}reset(){this._active=!1}dblclick(s,u){return s.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:this._tr.zoom+(s.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Y2{constructor(){this._tap=new xp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(s,u,m){if(!this._swipePoint)if(this._tapTime){const v=u[0],w=s.timeStamp-this._tapTime<500,P=this._tapPoint.dist(v)<30;w&&P?m.length>0&&(this._swipePoint=v,this._swipeTouch=m[0].identifier):this.reset()}else this._tap.touchstart(s,u,m)}touchmove(s,u,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const v=u[0],w=v.y-this._swipePoint.y;return this._swipePoint=v,s.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(s,u,m)}touchend(s,u,m){if(this._tapTime)this._swipePoint&&m.length===0&&this.reset();else{const v=this._tap.touchend(s,u,m);v&&(this._tapTime=s.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dv{constructor(s,u,m){this._el=s,this._mousePan=u,this._touchPan=m}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Mp{constructor(s,u,m,v){this._pitchWithRotate=s.pitchWithRotate,this._rollEnabled=s.rollEnabled,this._mouseRotate=u,this._mousePitch=m,this._mouseRoll=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class zv{constructor(s,u,m,v){this._el=s,this._touchZoom=u,this._touchRotate=m,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class t1{constructor(s,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=s,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const s=this._map.getCanvasContainer();s.classList.add("maplibregl-cooperative-gestures"),this._container=C.create("div","maplibregl-cooperative-gesture-screen",s);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const m=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=u,this._container.appendChild(v);const w=document.createElement("div");w.className="maplibregl-mobile-message",w.textContent=m,this._container.appendChild(w),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(C.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(s){return s[this._bypassKey]}notifyGestureBlocked(s,u){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:s,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const zd=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class K2 extends o.l{}function Ov(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class Vl{constructor(s,u){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,w)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const P=v.type==="renderFrame"?void 0:v,D={needsRenderFrame:!1},F={},j={};for(const{handlerName:K,handler:oe,allowed:he}of this._handlers){if(!oe.isEnabled())continue;let Pe;if(this._blockedByActive(j,he,K))oe.reset();else if(oe[w||v.type]){if(o.co(v,w||v.type)){const Ee=C.mousePos(this._map.getCanvas(),v);Pe=oe[w||v.type](v,Ee)}else if(o.cp(v,w||v.type)){const Ee=this._getMapTouches(v.touches),Ie=C.touchPos(this._map.getCanvas(),Ee);Pe=oe[w||v.type](v,Ie,Ee)}else o.cq(w||v.type)||(Pe=oe[w||v.type](v));this.mergeHandlerResult(D,F,Pe,K,P),Pe&&Pe.needsRenderFrame&&this._triggerRenderFrame()}(Pe||oe.isActive())&&(j[K]=oe)}const W={};for(const K in this._previousActiveHandlers)j[K]||(W[K]=P);this._previousActiveHandlers=j,(Object.keys(W).length||Ov(D))&&(this._changes.push([D,F,W]),this._triggerRenderFrame()),(Object.keys(j).length||Ov(D))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=D;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))},this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zx(s),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,w,P]of this._listeners)C.addEventListener(v,w,v===document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[s,u,m]of this._listeners)C.removeEventListener(s,u,s===document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(s){const u=this._map,m=u.getCanvasContainer();this._add("mapEvent",new Yx(u,s));const v=u.boxZoom=new Pv(u,s);this._add("boxZoom",v),s.interactive&&s.boxZoom&&v.enable();const w=u.cooperativeGestures=new t1(u,s.cooperativeGestures);this._add("cooperativeGestures",w),s.cooperativeGestures&&w.enable();const P=new bp(u),D=new Z2(u);u.doubleClickZoom=new Sp(D,P),this._add("tapZoom",P),this._add("clickZoom",D),s.interactive&&s.doubleClickZoom&&u.doubleClickZoom.enable();const F=new Y2;this._add("tapDragZoom",F);const j=u.touchPitch=new Rv(u);this._add("touchPitch",j),s.interactive&&s.touchPitch&&u.touchPitch.enable(s.touchPitch);const W=()=>u.project(u.getCenter()),Q=function({enable:Be,clickTolerance:Ye,aroundCenter:Ke=!0,minPixelCenterThreshold:$e=100,rotateDegreesPerPixelMoved:rt=.8},yt){const ht=new ko({checkCorrectEvent:pt=>C.mouseButton(pt)===0&&pt.ctrlKey||C.mouseButton(pt)===2&&!pt.ctrlKey});return new Hu({clickTolerance:Ye,move:(pt,_t)=>{const sn=yt();if(Ke&&Math.abs(sn.y-pt.y)>$e)return{bearingDelta:o.cm(new o.P(pt.x,_t.y),_t,sn)};let rn=(_t.x-pt.x)*rt;return Ke&&_t.y<sn.y&&(rn=-rn),{bearingDelta:rn}},moveStateManager:ht,enable:Be,assignEvents:wp})}(s,W),K=function({enable:Be,clickTolerance:Ye,pitchDegreesPerPixelMoved:Ke=-.5}){const $e=new ko({checkCorrectEvent:rt=>C.mouseButton(rt)===0&&rt.ctrlKey||C.mouseButton(rt)===2});return new Hu({clickTolerance:Ye,move:(rt,yt)=>({pitchDelta:(yt.y-rt.y)*Ke}),moveStateManager:$e,enable:Be,assignEvents:wp})}(s),oe=function({enable:Be,clickTolerance:Ye,rollDegreesPerPixelMoved:Ke=.3},$e){const rt=new ko({checkCorrectEvent:yt=>C.mouseButton(yt)===2&&yt.ctrlKey});return new Hu({clickTolerance:Ye,move:(yt,ht)=>{const pt=$e();let _t=(ht.x-yt.x)*Ke;return ht.y<pt.y&&(_t=-_t),{rollDelta:_t}},moveStateManager:rt,enable:Be,assignEvents:wp})}(s,W);u.dragRotate=new Mp(s,Q,K,oe),this._add("mouseRotate",Q,["mousePitch"]),this._add("mousePitch",K,["mouseRotate","mouseRoll"]),this._add("mouseRoll",oe,["mousePitch"]),s.interactive&&s.dragRotate&&u.dragRotate.enable();const he=function({enable:Be,clickTolerance:Ye}){const Ke=new ko({checkCorrectEvent:$e=>C.mouseButton($e)===0&&!$e.ctrlKey});return new Hu({clickTolerance:Ye,move:($e,rt)=>({around:rt,panDelta:rt.sub($e)}),activateOnStart:!0,moveStateManager:Ke,enable:Be,assignEvents:wp})}(s),Pe=new X2(s,u);u.dragPan=new Dv(m,he,Pe),this._add("mousePan",he),this._add("touchPan",Pe,["touchZoom","touchRotate"]),s.interactive&&s.dragPan&&u.dragPan.enable(s.dragPan);const Ee=new Iv,Ie=new ka;u.touchZoomRotate=new zv(m,Ie,Ee,F),this._add("touchRotate",Ee,["touchPan","touchZoom"]),this._add("touchZoom",Ie,["touchPan","touchRotate"]),s.interactive&&s.touchZoomRotate&&u.touchZoomRotate.enable(s.touchZoomRotate);const Fe=u.scrollZoom=new e1(u,()=>this._triggerRenderFrame());this._add("scrollZoom",Fe,["mousePan"]),s.interactive&&s.scrollZoom&&u.scrollZoom.enable(s.scrollZoom);const He=u.keyboard=new qu(u);this._add("keyboard",He),s.interactive&&s.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new Kx(u))}_add(s,u,m){this._handlers.push({handlerName:s,handler:u,allowed:m}),this._handlersById[s]=u}stop(s){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!zd(this._eventsInProgress)||this.isZooming()}_blockedByActive(s,u,m){for(const v in s)if(v!==m&&(!u||u.indexOf(v)<0))return!0;return!1}_getMapTouches(s){const u=[];for(const m of s)this._el.contains(m.target)&&u.push(m);return u}mergeHandlerResult(s,u,m,v,w){if(!m)return;o.e(s,m);const P={handlerName:v,originalEvent:m.originalEvent||w};m.zoomDelta!==void 0&&(u.zoom=P),m.panDelta!==void 0&&(u.drag=P),m.rollDelta!==void 0&&(u.roll=P),m.pitchDelta!==void 0&&(u.pitch=P),m.bearingDelta!==void 0&&(u.rotate=P)}_applyChanges(){const s={},u={},m={};for(const[v,w,P]of this._changes)v.panDelta&&(s.panDelta=(s.panDelta||new o.P(0,0))._add(v.panDelta)),v.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+v.pitchDelta),v.rollDelta&&(s.rollDelta=(s.rollDelta||0)+v.rollDelta),v.around!==void 0&&(s.around=v.around),v.pinchAround!==void 0&&(s.pinchAround=v.pinchAround),v.noInertia&&(s.noInertia=v.noInertia),o.e(u,w),o.e(m,P);this._updateMapTransform(s,u,m),this._changes=[]}_updateMapTransform(s,u,m){const v=this._map,w=v._getTransformForUpdate(),P=v.terrain;if(!(Ov(s)||P&&this._terrainMovement))return this._fireEvents(u,m,!0);v._stop(!0);let{panDelta:D,zoomDelta:F,bearingDelta:j,pitchDelta:W,rollDelta:Q,around:K,pinchAround:oe}=s;oe!==void 0&&(K=oe),K=K||v.transform.centerPoint,P&&!w.isPointOnMapSurface(K)&&(K=w.centerPoint);const he={panDelta:D,zoomDelta:F,rollDelta:Q,pitchDelta:W,bearingDelta:j,around:K};this._map.cameraHelper.useGlobeControls&&!w.isPointOnMapSurface(K)&&(K=w.centerPoint);const Pe=K.distSqr(w.centerPoint)<.01?w.center:w.screenPointToLocation(D?K.sub(D):K);P?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(he,w),this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?w.setCenter(w.screenPointToLocation(w.centerPoint.sub(D))):this._map.cameraHelper.handleMapControlsPan(he,w,Pe):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(he,w,Pe))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(he,w),this._map.cameraHelper.handleMapControlsPan(he,w,Pe)),v._applyUpdatedTransform(w),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(u,m,!0)}_fireEvents(s,u,m){const v=zd(this._eventsInProgress),w=zd(s),P={};for(const Q in s){const{originalEvent:K}=s[Q];this._eventsInProgress[Q]||(P[`${Q}start`]=K),this._eventsInProgress[Q]=s[Q]}!v&&w&&this._fireEvent("movestart",w.originalEvent);for(const Q in P)this._fireEvent(Q,P[Q]);w&&this._fireEvent("move",w.originalEvent);for(const Q in s){const{originalEvent:K}=s[Q];this._fireEvent(Q,K)}const D={};let F;for(const Q in this._eventsInProgress){const{handlerName:K,originalEvent:oe}=this._eventsInProgress[Q];this._handlersById[K].isActive()||(delete this._eventsInProgress[Q],F=u[K]||oe,D[`${Q}end`]=F)}for(const Q in D)this._fireEvent(Q,D[Q]);const j=zd(this._eventsInProgress),W=(v||w)&&!j;if(W&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Q=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Q.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Q)}if(m&&W){this._updatingCamera=!0;const Q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),K=oe=>oe!==0&&-this._bearingSnap<oe&&oe<this._bearingSnap;!Q||!Q.essential&&M.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:F})),K(this._map.getBearing())&&this._map.resetNorth()):(K(Q.bearing||this._map.getBearing())&&(Q.bearing=0),Q.freezeElevation=!0,this._map.easeTo(Q,{originalEvent:F})),this._updatingCamera=!1}}_fireEvent(s,u){this._map.fire(new o.l(s,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new K2("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Zr extends o.E{constructor(s,u,m){super(),this._renderFrameCallback=()=>{const v=Math.min((M.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(v)),v<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=m.bearingSnap,this.cameraHelper=u,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(s,u){s.apply(this.transform),this.transform=s,this.cameraHelper=u}getCenter(){return new o.S(this.transform.center.lng,this.transform.center.lat)}setCenter(s,u){return this.jumpTo({center:s},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(s,u){return this.jumpTo({elevation:s},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(s){this._centerClampedToGround=s}panBy(s,u,m){return s=o.P.convert(s).mult(-1),this.panTo(this.transform.center,o.e({offset:s},u),m)}panTo(s,u,m){return this.easeTo(o.e({center:s},u),m)}getZoom(){return this.transform.zoom}setZoom(s,u){return this.jumpTo({zoom:s},u),this}zoomTo(s,u,m){return this.easeTo(o.e({zoom:s},u),m)}zoomIn(s,u){return this.zoomTo(this.getZoom()+1,s,u),this}zoomOut(s,u){return this.zoomTo(this.getZoom()-1,s,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(s,u){return s!=this.transform.fov&&(this.transform.setFov(s),this.fire(new o.l("movestart",u)).fire(new o.l("move",u)).fire(new o.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(s,u){return this.jumpTo({bearing:s},u),this}getPadding(){return this.transform.padding}setPadding(s,u){return this.jumpTo({padding:s},u),this}rotateTo(s,u,m){return this.easeTo(o.e({bearing:s},u),m)}resetNorth(s,u){return this.rotateTo(0,o.e({duration:1e3},s),u),this}resetNorthPitch(s,u){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},s),u),this}snapToNorth(s,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,u):this}getPitch(){return this.transform.pitch}setPitch(s,u){return this.jumpTo({pitch:s},u),this}getRoll(){return this.transform.roll}setRoll(s,u){return this.jumpTo({roll:s},u),this}cameraForBounds(s,u){s=hn.convert(s).adjustAntiMeridian();const m=u&&u.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),m,u)}_cameraForBoxAndBearing(s,u,m,v){const w={top:0,bottom:0,right:0,left:0};if(typeof(v=o.e({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const j=v.padding;v.padding={top:j,bottom:j,right:j,left:j}}const P=o.e(w,v.padding);v.padding=P;const D=this.transform,F=new hn(s,u);return this.cameraHelper.cameraForBoxAndBearing(v,P,F,m,D)}fitBounds(s,u,m){return this._fitInternal(this.cameraForBounds(s,u),u,m)}fitScreenCoordinates(s,u,m,v,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(s)),this.transform.screenPointToLocation(o.P.convert(u)),m,v),v,w)}_fitInternal(s,u,m){return s?(delete(u=o.e(s,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this}jumpTo(s,u){this.stop();const m=this._getTransformForUpdate();let v=!1,w=!1,P=!1;const D=m.zoom;this.cameraHelper.handleJumpToCenterZoom(m,s);const F=m.zoom!==D;return"elevation"in s&&m.elevation!==+s.elevation&&m.setElevation(+s.elevation),"bearing"in s&&m.bearing!==+s.bearing&&(v=!0,m.setBearing(+s.bearing)),"pitch"in s&&m.pitch!==+s.pitch&&(w=!0,m.setPitch(+s.pitch)),"roll"in s&&m.roll!==+s.roll&&(P=!0,m.setRoll(+s.roll)),s.padding==null||m.isPaddingEqual(s.padding)||m.setPadding(s.padding),this._applyUpdatedTransform(m),this.fire(new o.l("movestart",u)).fire(new o.l("move",u)),F&&this.fire(new o.l("zoomstart",u)).fire(new o.l("zoom",u)).fire(new o.l("zoomend",u)),v&&this.fire(new o.l("rotatestart",u)).fire(new o.l("rotate",u)).fire(new o.l("rotateend",u)),w&&this.fire(new o.l("pitchstart",u)).fire(new o.l("pitch",u)).fire(new o.l("pitchend",u)),P&&this.fire(new o.l("rollstart",u)).fire(new o.l("roll",u)).fire(new o.l("rollend",u)),this.fire(new o.l("moveend",u))}calculateCameraOptionsFromTo(s,u,m,v=0){const w=o.a0.fromLngLat(s,u),P=o.a0.fromLngLat(m,v),D=P.x-w.x,F=P.y-w.y,j=P.z-w.z,W=Math.hypot(D,F,j);if(W===0)throw new Error("Can't calculate camera options with same From and To");const Q=Math.hypot(D,F),K=o.aj(this.transform.cameraToCenterDistance/W/this.transform.tileSize),oe=180*Math.atan2(D,-F)/Math.PI;let he=180*Math.acos(Q/W)/Math.PI;return he=j<0?90-he:90+he,{center:P.toLngLat(),elevation:v,zoom:K,pitch:he,bearing:oe}}calculateCameraOptionsFromCameraLngLatAltRotation(s,u,m,v,w){const P=this.transform.calculateCenterFromCameraLngLatAlt(s,u,m,v);return{center:P.center,elevation:P.elevation,zoom:P.zoom,bearing:m,pitch:v,roll:w}}easeTo(s,u){this._stop(!1,s.easeId),((s=o.e({offset:[0,0],duration:500,easing:o.cn},s)).animate===!1||!s.essential&&M.prefersReducedMotion)&&(s.duration=0);const m=this._getTransformForUpdate(),v=this.getBearing(),w=m.pitch,P=m.roll,D="bearing"in s?this._normalizeBearing(s.bearing,v):v,F="pitch"in s?+s.pitch:w,j="roll"in s?this._normalizeBearing(s.roll,P):P,W="padding"in s?s.padding:m.padding,Q=o.P.convert(s.offset);let K,oe;s.around&&(K=o.S.convert(s.around),oe=m.locationToScreenPoint(K));const he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Pe=this.cameraHelper.handleEaseTo(m,{bearing:D,pitch:F,roll:j,padding:W,around:K,aroundPoint:oe,offsetAsPoint:Q,offset:s.offset,zoom:s.zoom,center:s.center});return this._rotating=this._rotating||v!==D,this._pitching=this._pitching||F!==w,this._rolling=this._rolling||j!==P,this._padding=!m.isPaddingEqual(W),this._zooming=this._zooming||Pe.isZooming,this._easeId=s.easeId,this._prepareEase(u,s.noMoveStart,he),this.terrain&&this._prepareElevation(Pe.elevationCenter),this._ease(Ee=>{Pe.easeFunc(Ee),this.terrain&&!s.freezeElevation&&this._updateElevation(Ee),this._applyUpdatedTransform(m),this._fireMoveEvents(u)},Ee=>{this.terrain&&s.freezeElevation&&this._finalizeElevation(),this._afterEase(u,Ee)},s),this}_prepareEase(s,u,m={}){this._moving=!0,u||m.moving||this.fire(new o.l("movestart",s)),this._zooming&&!m.zooming&&this.fire(new o.l("zoomstart",s)),this._rotating&&!m.rotating&&this.fire(new o.l("rotatestart",s)),this._pitching&&!m.pitching&&this.fire(new o.l("pitchstart",s)),this._rolling&&!m.rolling&&this.fire(new o.l("rollstart",s))}_prepareElevation(s){this._elevationCenter=s,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(s){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(s<1&&u!==this._elevationTarget){const m=this._elevationTarget-this._elevationStart;this._elevationStart+=s*(m-(u-(m*s+this._elevationStart))/(1-s)),this._elevationTarget=u}this.transform.setElevation(o.C.number(this._elevationStart,this._elevationTarget,s))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(s){if(!this.terrain&&s.elevation>=0&&s.pitch<=90)return{};const u=s.getCameraLngLat(),m=s.getCameraAltitude(),v=this.terrain?this.terrain.getElevationForLngLatZoom(u,s.zoom):0;if(m<v){const w=this.calculateCameraOptionsFromTo(u,v,s.center,s.elevation);return{pitch:w.pitch,zoom:w.zoom}}return{}}_applyUpdatedTransform(s){const u=[];if(u.push(v=>this._elevateCameraIfInsideTerrain(v)),this.transformCameraUpdate&&u.push(v=>this.transformCameraUpdate(v)),!u.length)return;const m=s.clone();for(const v of u){const w=m.clone(),{center:P,zoom:D,roll:F,pitch:j,bearing:W,elevation:Q}=v(w);P&&w.setCenter(P),Q!==void 0&&w.setElevation(Q),D!==void 0&&w.setZoom(D),F!==void 0&&w.setRoll(F),j!==void 0&&w.setPitch(j),W!==void 0&&w.setBearing(W),m.apply(w)}this.transform.apply(m)}_fireMoveEvents(s){this.fire(new o.l("move",s)),this._zooming&&this.fire(new o.l("zoom",s)),this._rotating&&this.fire(new o.l("rotate",s)),this._pitching&&this.fire(new o.l("pitch",s)),this._rolling&&this.fire(new o.l("roll",s))}_afterEase(s,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const m=this._zooming,v=this._rotating,w=this._pitching,P=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,m&&this.fire(new o.l("zoomend",s)),v&&this.fire(new o.l("rotateend",s)),w&&this.fire(new o.l("pitchend",s)),P&&this.fire(new o.l("rollend",s)),this.fire(new o.l("moveend",s))}flyTo(s,u){if(!s.essential&&M.prefersReducedMotion){const _t=o.Q(s,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(_t,u)}this.stop(),s=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.cn},s);const m=this._getTransformForUpdate(),v=m.bearing,w=m.pitch,P=m.roll,D=m.padding,F="bearing"in s?this._normalizeBearing(s.bearing,v):v,j="pitch"in s?+s.pitch:w,W="roll"in s?this._normalizeBearing(s.roll,P):P,Q="padding"in s?s.padding:m.padding,K=o.P.convert(s.offset);let oe=m.centerPoint.add(K);const he=m.screenPointToLocation(oe),Pe=this.cameraHelper.handleFlyTo(m,{bearing:F,pitch:j,roll:W,padding:Q,locationAtOffset:he,offsetAsPoint:K,center:s.center,minZoom:s.minZoom,zoom:s.zoom});let Ee=s.curve;const Ie=Math.max(m.width,m.height),Fe=Ie/Pe.scaleOfZoom,He=Pe.pixelPathLength;typeof Pe.scaleOfMinZoom=="number"&&(Ee=Math.sqrt(Ie/Pe.scaleOfMinZoom/He*2));const Be=Ee*Ee;function Ye(_t){const sn=(Fe*Fe-Ie*Ie+(_t?-1:1)*Be*Be*He*He)/(2*(_t?Fe:Ie)*Be*He);return Math.log(Math.sqrt(sn*sn+1)-sn)}function Ke(_t){return(Math.exp(_t)-Math.exp(-_t))/2}function $e(_t){return(Math.exp(_t)+Math.exp(-_t))/2}const rt=Ye(!1);let yt=function(_t){return $e(rt)/$e(rt+Ee*_t)},ht=function(_t){return Ie*(($e(rt)*(Ke(sn=rt+Ee*_t)/$e(sn))-Ke(rt))/Be)/He;var sn},pt=(Ye(!0)-rt)/Ee;if(Math.abs(He)<2e-6||!isFinite(pt)){if(Math.abs(Ie-Fe)<1e-6)return this.easeTo(s,u);const _t=Fe<Ie?-1:1;pt=Math.abs(Math.log(Fe/Ie))/Ee,ht=()=>0,yt=sn=>Math.exp(_t*Ee*sn)}return s.duration="duration"in s?+s.duration:1e3*pt/("screenSpeed"in s?+s.screenSpeed/Ee:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=v!==F,this._pitching=j!==w,this._rolling=W!==P,this._padding=!m.isPaddingEqual(Q),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(Pe.targetCenter),this._ease(_t=>{const sn=_t*pt,rn=1/yt(sn),Vt=ht(sn);this._rotating&&m.setBearing(o.C.number(v,F,_t)),this._pitching&&m.setPitch(o.C.number(w,j,_t)),this._rolling&&m.setRoll(o.C.number(P,W,_t)),this._padding&&(m.interpolatePadding(D,Q,_t),oe=m.centerPoint.add(K)),Pe.easeFunc(_t,rn,Vt,oe),this.terrain&&!s.freezeElevation&&this._updateElevation(_t),this._applyUpdatedTransform(m),this._fireMoveEvents(u)},()=>{this.terrain&&s.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,u){var m;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,u)}return s||(m=this.handlers)===null||m===void 0||m.stop(!1),this}_ease(s,u,m){m.animate===!1||m.duration===0?(s(1),u()):(this._easeStart=M.now(),this._easeOptions=m,this._onEaseFrame=s,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(s,u){s=o.aN(s,-180,180);const m=Math.abs(s-u);return Math.abs(s-360-u)<m&&(s-=360),Math.abs(s+360-u)<m&&(s+=360),s}queryTerrainElevation(s){return this.terrain?this.terrain.getElevationForLngLatZoom(o.S.convert(s),this.transform.tileZoom):null}}const Od={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Cp{constructor(s=Od){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=s}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options.compact,this._container=C.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=C.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=C.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){C.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,u){const m=this._map._getUIString(`AttributionControl.${u}`);s.title=m,s.setAttribute("aria-label",m)}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const u=this._map.style.sourceCaches;for(const v in u){const w=u[v];if(w.used||w.usedForTerrain){const P=w.getSource();P.attribution&&s.indexOf(P.attribution)<0&&s.push(P.attribution)}}s=s.filter(v=>String(v).trim()),s.sort((v,w)=>v.length-w.length),s=s.filter((v,w)=>{for(let P=w+1;P<s.length;P++)if(s[P].indexOf(v)>=0)return!1;return!0});const m=s.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,s.length?(this._innerContainer.innerHTML=C.sanitize(m),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Fv{constructor(s={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const m=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&m.classList.add("maplibregl-compact"):m.classList.remove("maplibregl-compact")}},this.options=s}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=C.create("div","maplibregl-ctrl");const u=C.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){C.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class n1{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const u=++this._id;return this._queue.push({callback:s,id:u,cancelled:!1}),u}remove(s){const u=this._currentlyRunning,m=u?this._queue.concat(u):this._queue;for(const v of m)if(v.id===s)return void(v.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const m of u)if(!m.cancelled&&(m.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var r1=o.aI([{name:"a_pos3d",type:"Int16",components:3}]);class J2 extends o.E{constructor(s){super(),this._lastTilesetChange=M.now(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=s._source.tileSize*2**this.deltaZoom,s.usedForTerrain=!0,s.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(s,u){this.sourceCache.update(s,u),this._renderableTilesKeys=[];const m={};for(const v of De(s,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))m[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.terrainRttPosMatrix32f=new Float64Array(16),o.bX(v.terrainRttPosMatrix32f,0,o.$,o.$,0,0,1),this._tiles[v.key]=new Lt(v,this.tileSize),this._lastTilesetChange=M.now());for(const v in this._tiles)m[v]||delete this._tiles[v]}freeRtt(s){for(const u in this._tiles){const m=this._tiles[u];(!s||m.tileID.equals(s)||m.tileID.isChildOf(s)||s.isChildOf(m.tileID))&&(m.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s,u){return u?this._getTerrainCoordsForTileRanges(s,u):this._getTerrainCoordsForRegularTile(s)}_getTerrainCoordsForRegularTile(s){const u={};for(const m of this._renderableTilesKeys){const v=this._tiles[m].tileID,w=s.clone(),P=o.b9();if(v.canonical.equals(s.canonical))o.bX(P,0,o.$,o.$,0,0,1);else if(v.canonical.isChildOf(s.canonical)){const D=v.canonical.z-s.canonical.z,F=v.canonical.x-(v.canonical.x>>D<<D),j=v.canonical.y-(v.canonical.y>>D<<D),W=o.$>>D;o.bX(P,0,W,W,0,0,1),o.M(P,P,[-F*W,-j*W,0])}else{if(!s.canonical.isChildOf(v.canonical))continue;{const D=s.canonical.z-v.canonical.z,F=s.canonical.x-(s.canonical.x>>D<<D),j=s.canonical.y-(s.canonical.y>>D<<D),W=o.$>>D;o.bX(P,0,o.$,o.$,0,0,1),o.M(P,P,[F*W,j*W,0]),o.N(P,P,[1/2**D,1/2**D,0])}}w.terrainRttPosMatrix32f=new Float32Array(P),u[m]=w}return u}_getTerrainCoordsForTileRanges(s,u){const m={};for(const v of this._renderableTilesKeys){const w=this._tiles[v].tileID;if(!this._isWithinTileRanges(w,u))continue;const P=s.clone(),D=o.b9();if(w.canonical.z===s.canonical.z){const F=s.canonical.x-w.canonical.x,j=s.canonical.y-w.canonical.y;o.bX(D,0,o.$,o.$,0,0,1),o.M(D,D,[F*o.$,j*o.$,0])}else if(w.canonical.z>s.canonical.z){const F=w.canonical.z-s.canonical.z,j=w.canonical.x-(w.canonical.x>>F<<F),W=w.canonical.y-(w.canonical.y>>F<<F),Q=s.canonical.x-(w.canonical.x>>F),K=s.canonical.y-(w.canonical.y>>F),oe=o.$>>F;o.bX(D,0,oe,oe,0,0,1),o.M(D,D,[-j*oe+Q*o.$,-W*oe+K*o.$,0])}else{const F=s.canonical.z-w.canonical.z,j=s.canonical.x-(s.canonical.x>>F<<F),W=s.canonical.y-(s.canonical.y>>F<<F),Q=(s.canonical.x>>F)-w.canonical.x,K=(s.canonical.y>>F)-w.canonical.y,oe=o.$<<F;o.bX(D,0,oe,oe,0,0,1),o.M(D,D,[j*o.$+Q*oe,W*o.$+K*oe,0])}P.terrainRttPosMatrix32f=new Float32Array(D),m[v]=P}return m}getSourceTile(s,u){const m=this.sourceCache._source;let v=s.overscaledZ-this.deltaZoom;if(v>m.maxzoom&&(v=m.maxzoom),v<m.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(v).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!w||!w.dem)&&u)for(;v>=m.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(s.scaledTo(v--).key);return w}anyTilesAfterTime(s=Date.now()){return this._lastTilesetChange>=s}_isWithinTileRanges(s,u){return u[s.canonical.z]&&s.canonical.x>=u[s.canonical.z].minTileX&&s.canonical.x<=u[s.canonical.z].maxTileX&&s.canonical.y>=u[s.canonical.z].minTileY&&s.canonical.y<=u[s.canonical.z].maxTileY}}class Da{constructor(s,u,m){this._meshCache={},this.painter=s,this.sourceCache=new J2(u),this.options=m,this.exaggeration=typeof m.exaggeration=="number"?m.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(s,u,m,v=o.$){var w;if(!(u>=0&&u<v&&m>=0&&m<v))return 0;const P=this.getTerrainData(s),D=(w=P.tile)===null||w===void 0?void 0:w.dem;if(!D)return 0;const F=o.cr([],[u/v*o.$,m/v*o.$],P.u_terrain_matrix),j=[F[0]*D.dim,F[1]*D.dim],W=Math.floor(j[0]),Q=Math.floor(j[1]),K=j[0]-W,oe=j[1]-Q;return D.get(W,Q)*(1-K)*(1-oe)+D.get(W+1,Q)*K*(1-oe)+D.get(W,Q+1)*(1-K)*oe+D.get(W+1,Q+1)*K*oe}getElevationForLngLatZoom(s,u){if(!o.cs(u,s.wrap()))return 0;const{tileID:m,mercatorX:v,mercatorY:w}=this._getOverscaledTileIDFromLngLatZoom(s,u);return this.getElevation(m,v%o.$,w%o.$,o.$)}getElevation(s,u,m,v=o.$){return this.getDEMElevation(s,u,m,v)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){const v=this.painter.context,w=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(v,w,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(v,new o.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.af([])}const u=this.sourceCache.getSourceTile(s,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const v=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new o.T(v,u.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),u.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const m=u&&u+u.tileID.key+s.key;if(m&&!this._demMatrixCache[m]){const v=this.sourceCache.sourceCache._source.maxzoom;let w=s.canonical.z-u.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=v?w=s.canonical.z-v:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const P=s.canonical.x-(s.canonical.x>>w<<w),D=s.canonical.y-(s.canonical.y>>w<<w),F=o.ct(new Float64Array(16),[1/(o.$<<w),1/(o.$<<w),0]);o.M(F,F,[P*o.$,D*o.$,0]),this._demMatrixCache[s.key]={matrix:F,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:m?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(s){const u=this.painter,m=u.width/devicePixelRatio,v=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===m&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(u.context,{width:m,height:v,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(u.context,{width:m,height:v,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(m,v,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,m,v))),this._fbo.colorAttachment.set(s==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const s=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,P=0;w<this._coordsTextureSize;w++)for(let D=0;D<this._coordsTextureSize;D++,P+=4)u[P+0]=255&D,u[P+1]=255&w,u[P+2]=D>>8<<4|w>>8,u[P+3]=0;const m=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),v=new o.T(s,m,s.gl.RGBA,{premultiply:!1});return v.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(s){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),m=this.painter.context,v=m.gl,w=Math.round(s.x*this.painter.pixelRatio/devicePixelRatio),P=Math.round(s.y*this.painter.pixelRatio/devicePixelRatio),D=Math.round(this.painter.height/devicePixelRatio);m.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(w,D-P-1,1,1,v.RGBA,v.UNSIGNED_BYTE,u),m.bindFramebuffer.set(null);const F=u[0]+(u[2]>>4<<8),j=u[1]+((15&u[2])<<8),W=this.coordsIndex[255-u[3]],Q=W&&this.sourceCache.getTileByID(W);if(!Q)return null;const K=this._coordsTextureSize,oe=(1<<Q.tileID.canonical.z)*K;return new o.a0((Q.tileID.canonical.x*K+F)/oe+Q.tileID.wrap,(Q.tileID.canonical.y*K+j)/oe,this.getElevation(Q.tileID,F,j,K))}depthAtPoint(s){const u=new Uint8Array(4),m=this.painter.context,v=m.gl;return m.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,u),m.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(s){var u;const m=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,v=m&&s.canonical.y===0,w=m&&s.canonical.y===(1<<s.canonical.z)-1,P=`m_${v?"n":""}_${w?"s":""}`;if(this._meshCache[P])return this._meshCache[P];const D=this.painter.context,F=new o.cu,j=new o.aM,W=this.meshSize,Q=o.$/W,K=W*W;for(let $e=0;$e<=W;$e++)for(let rt=0;rt<=W;rt++)F.emplaceBack(rt*Q,$e*Q,0);for(let $e=0;$e<K;$e+=W+1)for(let rt=0;rt<W;rt++)j.emplaceBack(rt+$e,W+rt+$e+1,W+rt+$e+2),j.emplaceBack(rt+$e,W+rt+$e+2,rt+$e+1);const oe=F.length,he=oe+(W+1),Pe=(W+1)*W,Ee=v?o.bg:0,Ie=v?0:1,Fe=w?o.bh:o.$,He=w?0:1;for(let $e=0;$e<=W;$e++)F.emplaceBack($e*Q,Ee,Ie);for(let $e=0;$e<=W;$e++)F.emplaceBack($e*Q,Fe,He);for(let $e=0;$e<W;$e++)j.emplaceBack(Pe+$e,he+$e,he+$e+1),j.emplaceBack(Pe+$e,he+$e+1,Pe+$e+1),j.emplaceBack(0+$e,oe+$e+1,oe+$e),j.emplaceBack(0+$e,0+$e+1,oe+$e+1);const Be=F.length,Ye=Be+2*(W+1);for(const $e of[0,1])for(let rt=0;rt<=W;rt++)for(const yt of[0,1])F.emplaceBack($e*o.$,rt*Q,yt);for(let $e=0;$e<2*W;$e+=2)j.emplaceBack(Be+$e,Be+$e+1,Be+$e+3),j.emplaceBack(Be+$e,Be+$e+3,Be+$e+2),j.emplaceBack(Ye+$e,Ye+$e+3,Ye+$e+1),j.emplaceBack(Ye+$e,Ye+$e+2,Ye+$e+3);const Ke=new ol(D.createVertexBuffer(F,r1.members),D.createIndexBuffer(j),o.aL.simpleSegment(0,0,F.length,j.length));return this._meshCache[P]=Ke,Ke}getMeshFrameDelta(s){return 2*Math.PI*o.bt/Math.pow(2,Math.max(s,0))/5}getMinTileElevationForLngLatZoom(s,u){var m;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(s,u);return(m=this.getMinMaxElevation(v).minElevation)!==null&&m!==void 0?m:0}getMinMaxElevation(s){const u=this.getTerrainData(s).tile,m={minElevation:null,maxElevation:null};return u&&u.dem&&(m.minElevation=u.dem.min*this.exaggeration,m.maxElevation=u.dem.max*this.exaggeration),m}_getOverscaledTileIDFromLngLatZoom(s,u){const m=o.a0.fromLngLat(s.wrap()),v=(1<<u)*o.$,w=m.x*v,P=m.y*v,D=Math.floor(w/o.$),F=Math.floor(P/o.$);return{tileID:new o.Z(u,0,u,D,F),mercatorX:w,mercatorY:P}}}class Ep{constructor(s,u,m){this._context=s,this._size=u,this._tileSize=m,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const s of this._objects)s.texture.destroy(),s.fbo.destroy()}_createObject(s){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),m=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return m.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(m.texture),{id:s,fbo:u,texture:m,stamp:-1,inUse:!1}}getObjectForId(s){return this._objects[s]}useObject(s){s.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>s.id!==u),this._recentlyUsed.push(s.id)}stampObject(s){s.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const s=this._createObject(this._objects.length);return this._objects.push(s),s}freeObject(s){s.inUse=!1}freeAllObjects(){for(const s of this._objects)this.freeObject(s)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(s=>!s.inUse)===!1}}const En={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Vn{constructor(s,u){this.painter=s,this.terrain=u,this.pool=new Ep(s.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(s){return this.pool.getObjectForId(s.rtt[this._stacks.length-1].id).texture}prepareForRender(s,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=s._order.filter(m=>!s._layers[m].isHidden(u)),this._coordsAscending={};for(const m in s.sourceCaches){this._coordsAscending[m]={};const v=s.sourceCaches[m].getVisibleCoordinates(),w=s.sourceCaches[m].getSource(),P=w instanceof An?w.terrainTileRanges:null;for(const D of v){const F=this.terrain.sourceCache.getTerrainCoords(D,P);for(const j in F)this._coordsAscending[m][j]||(this._coordsAscending[m][j]=[]),this._coordsAscending[m][j].push(F[j])}}this._coordsAscendingStr={};for(const m of s._order){const v=s._layers[m],w=v.source;if(En[v.type]&&!this._coordsAscendingStr[w]){this._coordsAscendingStr[w]={};for(const P in this._coordsAscending[w])this._coordsAscendingStr[w][P]=this._coordsAscending[w][P].map(D=>D.key).sort().join()}}for(const m of this._renderableTiles)for(const v in this._coordsAscendingStr){const w=this._coordsAscendingStr[v][m.tileID.key];w&&w!==m.rttCoords[v]&&(m.rtt=[])}}renderLayer(s,u){if(s.isHidden(this.painter.transform.zoom))return!1;const m=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),v=s.type,w=this.painter,P=this._renderableLayerIds[this._renderableLayerIds.length-1]===s.id;if(En[v]&&(this._prevType&&En[this._prevType]||this._stacks.push([]),this._prevType=v,this._stacks[this._stacks.length-1].push(s.id),!P))return!0;if(En[this._prevType]||En[v]&&P){this._prevType=v;const D=this._stacks.length-1,F=this._stacks[D]||[];for(const j of this._renderableTiles){if(this.pool.isFull()&&(ai(this.painter,this.terrain,this._rttTiles,m),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(j),j.rtt[D]){const Q=this.pool.getObjectForId(j.rtt[D].id);if(Q.stamp===j.rtt[D].stamp){this.pool.useObject(Q);continue}}const W=this.pool.getOrCreateFreeObject();this.pool.useObject(W),this.pool.stampObject(W),j.rtt[D]={id:W.id,stamp:W.stamp},w.context.bindFramebuffer.set(W.fbo.framebuffer),w.context.clear({color:o.be.transparent,stencil:0}),w.currentStencilSource=void 0;for(let Q=0;Q<F.length;Q++){const K=w.style._layers[F[Q]],oe=K.source?this._coordsAscending[K.source][j.tileID.key]:[j.tileID];w.context.viewport.set([0,0,W.fbo.width,W.fbo.height]),w._renderTileClippingMasks(K,oe,!0),w.renderLayer(w,w.style.sourceCaches[K.source],K,oe,m),K.source&&(j.rttCoords[K.source]=this._coordsAscendingStr[K.source][j.tileID.key])}}return ai(this.painter,this.terrain,this._rttTiles,m),this._rttTiles=[],this.pool.freeAllObjects(),En[v]}return!1}}const Tp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Nv=f,Fd={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Od,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Do={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class i1{constructor(s,u,m=!1){this.mousedown=w=>{this.startMove(w,C.mousePos(this.element,w)),C.addEventListener(window,"mousemove",this.mousemove),C.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.move(w,C.mousePos(this.element,w))},this.mouseup=w=>{this._rotatePitchHanlder.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=C.touchPos(this.element,w.targetTouches)[0],this.startMove(w,this._startPos),C.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),C.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=C.touchPos(this.element,w.targetTouches)[0],this.move(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const v=new q2;this._rotatePitchHanlder=new Hu({clickTolerance:3,move:(w,P)=>{const D=u.getBoundingClientRect(),F=new o.P((D.bottom-D.top)/2,(D.right-D.left)/2);return{bearingDelta:o.cm(new o.P(w.x,P.y),P,F),pitchDelta:m?-.5*(P.y-w.y):void 0}},moveStateManager:v,enable:!0,assignEvents:()=>{}}),this.map=s,C.addEventListener(u,"mousedown",this.mousedown),C.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),C.addEventListener(u,"touchcancel",this.reset)}startMove(s,u){this._rotatePitchHanlder.dragStart(s,u),C.disableDrag()}move(s,u){const m=this.map,{bearingDelta:v,pitchDelta:w}=this._rotatePitchHanlder.dragMove(s,u)||{};v&&m.setBearing(m.getBearing()+v),w&&m.setPitch(m.getPitch()+w)}off(){const s=this.element;C.removeEventListener(s,"mousedown",this.mousedown),C.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),C.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),C.removeEventListener(window,"touchend",this.touchend),C.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){C.enableDrag(),C.removeEventListener(window,"mousemove",this.mousemove),C.removeEventListener(window,"mouseup",this.mouseup),C.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),C.removeEventListener(window,"touchend",this.touchend)}}let to;function o1(b,s,u,m=!1){if(m||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return b==null?void 0:b.wrap();const v=new o.S(b.lng,b.lat);if(b=new o.S(b.lng,b.lat),s){const w=new o.S(b.lng-360,b.lat),P=new o.S(b.lng+360,b.lat),D=u.locationToScreenPoint(b).distSqr(s);u.locationToScreenPoint(w).distSqr(s)<D?b=w:u.locationToScreenPoint(P).distSqr(s)<D&&(b=P)}for(;Math.abs(b.lng-u.center.lng)>180;){const w=u.locationToScreenPoint(b);if(w.x>=0&&w.y>=0&&w.x<=u.width&&w.y<=u.height)break;b.lng>u.center.lng?b.lng-=360:b.lng+=360}return b.lng!==v.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(b))?b:v}const zc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ti(b,s,u){const m=b.classList;for(const v in zc)m.remove(`maplibregl-${u}-anchor-${v}`);m.add(`maplibregl-${u}-anchor-${s}`)}class li extends o.E{constructor(s){if(super(),this._onKeyPress=u=>{const m=u.code,v=u.charCode||u.keyCode;m!=="Space"&&m!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=u=>{const m=u.originalEvent.target,v=this._element;this._popup&&(m===v||v.contains(m))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const m=this._map.loaded()&&!this._map.isMoving();((u==null?void 0:u.type)==="terrain"||(u==null?void 0:u.type)==="render"&&!m)&&this._map.once("render",this._update),this._lngLat=o1(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),C.setTransform(this._element,`${zc[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${v}`),M.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&u.type==="moveend")}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){const m=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._subpixelPositioning=s&&s.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment!=="auto"?s.pitchAlignment:this._rotationAlignment,this.setOpacity(s==null?void 0:s.opacity,s==null?void 0:s.opacityWhenCovered),s&&s.element)this._element=s.element,this._offset=o.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=C.create("div");const u=C.createNS("http://www.w3.org/2000/svg","svg"),m=41,v=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${m}px`),u.setAttributeNS(null,"width",`${v}px`),u.setAttributeNS(null,"viewBox",`0 0 ${v} ${m}`);const w=C.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const P=C.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill-rule","nonzero");const D=C.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"transform","translate(3.0, 29.0)"),D.setAttributeNS(null,"fill","#000000");const F=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ie of F){const Fe=C.createNS("http://www.w3.org/2000/svg","ellipse");Fe.setAttributeNS(null,"opacity","0.04"),Fe.setAttributeNS(null,"cx","10.5"),Fe.setAttributeNS(null,"cy","5.80029008"),Fe.setAttributeNS(null,"rx",Ie.rx),Fe.setAttributeNS(null,"ry",Ie.ry),D.appendChild(Fe)}const j=C.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill",this._color);const W=C.createNS("http://www.w3.org/2000/svg","path");W.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),j.appendChild(W);const Q=C.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"opacity","0.25"),Q.setAttributeNS(null,"fill","#000000");const K=C.createNS("http://www.w3.org/2000/svg","path");K.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Q.appendChild(K);const oe=C.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),oe.setAttributeNS(null,"fill","#FFFFFF");const he=C.createNS("http://www.w3.org/2000/svg","g");he.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Pe=C.createNS("http://www.w3.org/2000/svg","circle");Pe.setAttributeNS(null,"fill","#000000"),Pe.setAttributeNS(null,"opacity","0.25"),Pe.setAttributeNS(null,"cx","5.5"),Pe.setAttributeNS(null,"cy","5.5"),Pe.setAttributeNS(null,"r","5.4999962");const Ee=C.createNS("http://www.w3.org/2000/svg","circle");Ee.setAttributeNS(null,"fill","#FFFFFF"),Ee.setAttributeNS(null,"cx","5.5"),Ee.setAttributeNS(null,"cy","5.5"),Ee.setAttributeNS(null,"r","5.4999962"),he.appendChild(Pe),he.appendChild(Ee),P.appendChild(D),P.appendChild(j),P.appendChild(Q),P.appendChild(oe),P.appendChild(he),u.appendChild(P),u.setAttributeNS(null,"height",m*this._scale+"px"),u.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(u),this._offset=o.P.convert(s&&s.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),ti(this._element,this._anchor,"marker"),s&&s.className)for(const u of s.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(s){return this.remove(),this._map=s,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",s._getUIString("Marker.Title")),s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),s.on("terrain",this._update),s.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),C.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=o.S.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const v=Math.abs(13.5)/Math.SQRT2;s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(s){return this._subpixelPositioning=s,this}getPopup(){return this._popup}togglePopup(){const s=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:s?(s.isOpen()?s.remove():(s.setLngLat(this._lngLat),s.addTo(this._map)),this):this}_updateOpacity(s=!1){var u,m;const v=(u=this._map)===null||u===void 0?void 0:u.terrain,w=this._map.transform.isLocationOccluded(this._lngLat);if(!v||w){const oe=w?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==oe&&(this._element.style.opacity=oe))}if(s)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const P=this._map,D=P.terrain.depthAtPoint(this._pos),F=P.terrain.getElevationForLngLatZoom(this._lngLat,P.transform.tileZoom);if(P.transform.lngLatToCameraDepth(this._lngLat,F)-D<.006)return void(this._element.style.opacity=this._opacity);const j=-this._offset.y/P.transform.pixelsPerMeter,W=Math.sin(P.getPitch()*Math.PI/180)*j,Q=P.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),K=P.transform.lngLatToCameraDepth(this._lngLat,F+W)-Q>.006;!((m=this._popup)===null||m===void 0)&&m.isOpen()&&K&&this._popup.remove(),this._element.style.opacity=K?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(s){return this._offset=o.P.convert(s),this._update(),this}addClassName(s){this._element.classList.add(s)}removeClassName(s){this._element.classList.remove(s)}toggleClassName(s){return this._element.classList.toggle(s)}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&s!=="auto"?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(s,u){return(this._opacity===void 0||s===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),s!==void 0&&(this._opacity=s),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const s1={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let jl=0,Hl=!1;const Bv={maxWidth:100,unit:"metric"};function Pp(b,s,u){const m=u&&u.maxWidth||100,v=b._container.clientHeight/2,w=b._container.clientWidth/2,P=b.unproject([w-m/2,v]),D=b.unproject([w+m/2,v]),F=Math.round(b.project(D).x-b.project(P).x),j=Math.min(m,F,b._container.clientWidth),W=P.distanceTo(D);if(u&&u.unit==="imperial"){const Q=3.2808*W;Q>5280?Oc(s,j,Q/5280,b._getUIString("ScaleControl.Miles")):Oc(s,j,Q,b._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?Oc(s,j,W/1852,b._getUIString("ScaleControl.NauticalMiles")):W>=1e3?Oc(s,j,W/1e3,b._getUIString("ScaleControl.Kilometers")):Oc(s,j,W,b._getUIString("ScaleControl.Meters"))}function Oc(b,s,u,m){const v=function(w){const P=Math.pow(10,`${Math.floor(w)}`.length-1);let D=w/P;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(F){const j=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*j)/j}(D),P*D}(u);b.style.width=s*(v/u)+"px",b.innerHTML=`${v}&nbsp;${m}`}const Nd={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Uv=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ap(b){if(b){if(typeof b=="number"){const s=Math.round(Math.abs(b)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,b),"top-left":new o.P(s,s),"top-right":new o.P(-s,s),bottom:new o.P(0,-b),"bottom-left":new o.P(s,-s),"bottom-right":new o.P(-s,-s),left:new o.P(b,0),right:new o.P(-b,0)}}if(b instanceof o.P||Array.isArray(b)){const s=o.P.convert(b);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:o.P.convert(b.center||[0,0]),top:o.P.convert(b.top||[0,0]),"top-left":o.P.convert(b["top-left"]||[0,0]),"top-right":o.P.convert(b["top-right"]||[0,0]),bottom:o.P.convert(b.bottom||[0,0]),"bottom-left":o.P.convert(b["bottom-left"]||[0,0]),"bottom-right":o.P.convert(b["bottom-right"]||[0,0]),left:o.P.convert(b.left||[0,0]),right:o.P.convert(b.right||[0,0])}}return Ap(new o.P(0,0))}const $v=f;c.AJAXError=o.cy,c.Event=o.l,c.Evented=o.E,c.LngLat=o.S,c.MercatorCoordinate=o.a0,c.Point=o.P,c.addProtocol=o.cz,c.config=o.a,c.removeProtocol=o.cA,c.AttributionControl=Cp,c.BoxZoomHandler=Pv,c.CanvasSource=Le,c.CooperativeGesturesHandler=t1,c.DoubleClickZoomHandler=Sp,c.DragPanHandler=Dv,c.DragRotateHandler=Mp,c.EdgeInsets=Ts,c.FullscreenControl=class extends o.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var s;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((s=u==null?void 0:u.shadowRoot)===null||s===void 0)&&s.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){C.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=C.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);C.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},c.GeoJSONSource=Dt,c.GeolocateControl=class extends o.E{constructor(b){super(),this._onSuccess=s=>{if(this._map){if(this._isOutOfMapMaxBounds(s))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",s)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=s,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(s),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(s),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",s)),this._finish()}},this._updateCamera=s=>{const u=new o.S(s.coords.longitude,s.coords.latitude),m=s.coords.accuracy,v=this._map.getBearing(),w=o.e({bearing:v},this.options.fitBoundsOptions),P=hn.fromLngLat(u,m);this._map.fitBounds(P,w,{geolocateSource:!0})},this._updateMarker=s=>{if(s){const u=new o.S(s.coords.longitude,s.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=s.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=s=>{if(this._map){if(s.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(s.code===3&&Hl)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",s)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=C.create("button","maplibregl-ctrl-geolocate",this._container),C.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=s=>{if(this._map){if(s===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=C.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new li({element:this._dotElement}),this._circleElement=C.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new li({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))})}},this.options=o.e({},s1,b)}onAdd(b){return this._map=b,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return o._(this,arguments,void 0,function*(s=!1){if(to!==void 0&&!s)return to;if(window.navigator.permissions===void 0)return to=!!window.navigator.geolocation,to;try{to=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{to=!!window.navigator.geolocation}return to})}().then(s=>this._finishSetupUI(s)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),C.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,jl=0,Hl=!1}_isOutOfMapMaxBounds(b){const s=this._map.getMaxBounds(),u=b.coords;return s&&(u.longitude<s.getWest()||u.longitude>s.getEast()||u.latitude<s.getSouth()||u.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const b=this._map.getBounds(),s=b.getSouthEast(),u=b.getNorthEast(),m=s.distanceTo(u),v=Math.ceil(this._accuracy/(m/this._map._container.clientHeight)*2);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":jl--,Hl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),jl++,jl>1?(b={maximumAge:6e5,timeout:0},Hl=!0):(b=this.options.positionOptions,Hl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},c.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const s=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(s!=="mercator"&&s?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=C.create("button","maplibregl-ctrl-globe",this._container),C.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){C.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},c.Hash=Id,c.ImageSource=An,c.KeyboardHandler=qu,c.LngLatBounds=hn,c.LogoControl=Fv,c.Map=class extends Zr{constructor(b){var s,u;o.cv.mark(o.cw.create);const m=Object.assign(Object.assign(Object.assign({},Fd),b),{canvasContextAttributes:Object.assign(Object.assign({},Fd.canvasContextAttributes),b.canvasContextAttributes)});if(m.minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const v=new wi,w=new Jf;if(m.minZoom!==void 0&&v.setMinZoom(m.minZoom),m.maxZoom!==void 0&&v.setMaxZoom(m.maxZoom),m.minPitch!==void 0&&v.setMinPitch(m.minPitch),m.maxPitch!==void 0&&v.setMaxPitch(m.maxPitch),m.renderWorldCopies!==void 0&&v.setRenderWorldCopies(m.renderWorldCopies),super(v,w,{bearingSnap:m.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new n1,this._controls=[],this._mapId=o.a6(),this._contextLost=D=>{D.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.l("webglcontextlost",{originalEvent:D}))},this._contextRestored=D=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.l("webglcontextrestored",{originalEvent:D}))},this._onMapScroll=D=>{if(D.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=m.interactive,this._maxTileCacheSize=m.maxTileCacheSize,this._maxTileCacheZoomLevels=m.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},m.canvasContextAttributes),this._trackResize=m.trackResize===!0,this._bearingSnap=m.bearingSnap,this._centerClampedToGround=m.centerClampedToGround,this._refreshExpiredTiles=m.refreshExpiredTiles===!0,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions===!0,this._collectResourceTiming=m.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Tp),m.locale),this._clickTolerance=m.clickTolerance,this._overridePixelRatio=m.pixelRatio,this._maxCanvasSize=m.maxCanvasSize,this.transformCameraUpdate=m.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=m.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=U.addThrottleControl(()=>this.isMoving()),this._requestManager=new H(m.transformRequest),typeof m.container=="string"){if(this._container=document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let D=!1;const F=yp(j=>{this._trackResize&&!this._removed&&(this.resize(j),this.redraw())},50);this._resizeObserver=new ResizeObserver(j=>{D?F(j):D=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Vl(this,m),this._hash=m.hash&&new Id(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,elevation:m.elevation,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,roll:m.roll}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,o.e({},m.fitBoundsOptions,{duration:0}))));const P=typeof m.style=="string"||((u=(s=m.style)===null||s===void 0?void 0:s.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,P),this._localIdeographFontFamily=m.localIdeographFontFamily,this._validateStyle=m.validateStyle,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new Cp(typeof m.attributionControl=="boolean"?void 0:m.attributionControl)),m.maplibreLogo&&this.addControl(new Fv,m.logoPosition),this.on("style.load",()=>{if(P||this._resizeTransform(),this.transform.unmodified){const D=o.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(D)}}),this.on("data",D=>{this._update(D.dataType==="style"),this.fire(new o.l(`${D.dataType}data`,D))}),this.on("dataloading",D=>{this.fire(new o.l(`${D.dataType}dataloading`,D))}),this.on("dataabort",D=>{this.fire(new o.l("sourcedataabort",D))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,s){return this.style.setGlobalStateProperty(b,s),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,s){if(s===void 0&&(s=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=b.onAdd(this);this._controls.push(b);const m=this._controlPositions[s];return s.indexOf("bottom")!==-1?m.insertBefore(u,m.firstChild):m.appendChild(u),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(b);return s>-1&&this._controls.splice(s,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}calculateCameraOptionsFromTo(b,s,u,m){return m==null&&this.terrain&&(m=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,s,u,m)}resize(b,s=!0){const[u,m]=this._containerDimensions(),v=this._getClampedPixelRatio(u,m);if(this._resizeCanvas(u,m,v),this.painter.resize(u,m,v),this.painter.overLimit()){const P=this.painter.context.gl;this._maxCanvasSize=[P.drawingBufferWidth,P.drawingBufferHeight];const D=this._getClampedPixelRatio(u,m);this._resizeCanvas(u,m,D),this.painter.resize(u,m,D)}this._resizeTransform(s);const w=!this._moving;return w&&(this.stop(),this.fire(new o.l("movestart",b)).fire(new o.l("move",b))),this.fire(new o.l("resize",b)),w&&this.fire(new o.l("moveend",b)),this}_resizeTransform(b=!0){var s;const[u,m]=this._containerDimensions();this.transform.resize(u,m,b),(s=this._requestedCameraState)===null||s===void 0||s.resize(u,m,b)}_getClampedPixelRatio(b,s){const{0:u,1:m}=this._maxCanvasSize,v=this.getPixelRatio(),w=b*v,P=s*v;return Math.min(w>u?u/w:1,P>m?m/P:1)*v}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(hn.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}project(b){return this.transform.locationToScreenPoint(o.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(o.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,s,u){if(b==="mouseenter"||b==="mouseover"){let m=!1;return{layers:s,listener:u,delegates:{mousemove:w=>{const P=s.filter(F=>this.getLayer(F)),D=P.length!==0?this.queryRenderedFeatures(w.point,{layers:P}):[];D.length?m||(m=!0,u.call(this,new Jo(b,this,w.originalEvent,{features:D}))):m=!1},mouseout:()=>{m=!1}}}}if(b==="mouseleave"||b==="mouseout"){let m=!1;return{layers:s,listener:u,delegates:{mousemove:P=>{const D=s.filter(F=>this.getLayer(F));(D.length!==0?this.queryRenderedFeatures(P.point,{layers:D}):[]).length?m=!0:m&&(m=!1,u.call(this,new Jo(b,this,P.originalEvent)))},mouseout:P=>{m&&(m=!1,u.call(this,new Jo(b,this,P.originalEvent)))}}}}{const m=v=>{const w=s.filter(D=>this.getLayer(D)),P=w.length!==0?this.queryRenderedFeatures(v.point,{layers:w}):[];P.length&&(v.features=P,u.call(this,v),delete v.features)};return{layers:s,listener:u,delegates:{[b]:m}}}}_saveDelegatedListener(b,s){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(s)}_removeDelegatedListener(b,s,u){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const m=this._delegatedListeners[b];for(let v=0;v<m.length;v++){const w=m[v];if(w.listener===u&&w.layers.length===s.length&&w.layers.every(P=>s.includes(P))){for(const P in w.delegates)this.off(P,w.delegates[P]);return void m.splice(v,1)}}}on(b,s,u){if(u===void 0)return super.on(b,s);const m=typeof s=="string"?[s]:s,v=this._createDelegatedListener(b,m,u);this._saveDelegatedListener(b,v);for(const w in v.delegates)this.on(w,v.delegates[w]);return{unsubscribe:()=>{this._removeDelegatedListener(b,m,u)}}}once(b,s,u){if(u===void 0)return super.once(b,s);const m=typeof s=="string"?[s]:s,v=this._createDelegatedListener(b,m,u);for(const w in v.delegates){const P=v.delegates[w];v.delegates[w]=(...D)=>{this._removeDelegatedListener(b,m,u),P(...D)}}this._saveDelegatedListener(b,v);for(const w in v.delegates)this.once(w,v.delegates[w]);return this}off(b,s,u){return u===void 0?super.off(b,s):(this._removeDelegatedListener(b,typeof s=="string"?[s]:s,u),this)}queryRenderedFeatures(b,s){if(!this.style)return[];let u;const m=b instanceof o.P||Array.isArray(b),v=m?b:[[0,0],[this.transform.width,this.transform.height]];if(s=s||(m?{}:b)||{},v instanceof o.P||typeof v[0]=="number")u=[o.P.convert(v)];else{const w=o.P.convert(v[0]),P=o.P.convert(v[1]);u=[w,new o.P(P.x,w.y),P,new o.P(w.x,P.y),w]}return this.style.queryRenderedFeatures(u,s,this.transform)}querySourceFeatures(b,s){return this.style.querySourceFeatures(b,s)}setStyle(b,s){return(s=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(b,s))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const s=this._locale[b];if(s==null)throw new Error(`Missing UI string '${b}'`);return s}_updateStyle(b,s){var u,m;if(s.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,s));const v=this.style&&s.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new ov(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,s,v):this.style.loadJSON(b,s,v),this):((m=(u=this.style)===null||u===void 0?void 0:u.projection)===null||m===void 0||m.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ov(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,s){if(typeof b=="string"){const u=this._requestManager.transformRequest(b,"Style");o.j(u,new AbortController).then(m=>{this._updateDiff(m.data,s)}).catch(m=>{m&&this.fire(new o.k(m))})}else typeof b=="object"&&this._updateDiff(b,s)}_updateDiff(b,s){try{this.style.setState(b,s)&&this._update(!0)}catch(u){o.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(b,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(b,s){return this._lazyInitEmptyStyle(),this.style.addSource(b,s),this._update(!0)}isSourceLoaded(b){const s=this.style&&this.style.sourceCaches[b];if(s!==void 0)return s.loaded();this.fire(new o.k(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const s=this.style.sourceCaches[b.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&s.reload();for(const u in this.style._layers){const m=this.style._layers[u];m.type==="hillshade"&&m.source===b.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),m.type==="color-relief"&&m.source===b.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Da(this.painter,s,b),this.painter.renderToTexture=new Vn(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var m;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((m=u.source)===null||m===void 0?void 0:m.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:b})),this}getTerrain(){var b,s;return(s=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&s!==void 0?s:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const s in b){const u=b[s]._tiles;for(const m in u){const v=u[m];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,s,u){if(u){const m=this.getSource(u);if(!m)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);m.calculateTileZoom=fe(Math.max(1,b),Math.max(1,s))}else for(const m in this.style.sourceCaches)this.style.sourceCaches[m].getSource().calculateTileZoom=fe(Math.max(1,b),Math.max(1,s));return this._update(!0),this}refreshTiles(b,s){const u=this.style.sourceCaches[b];if(!u)throw new Error(`There is no source cache with ID "${b}", cannot refresh tile`);s===void 0?u.reload(!0):u.refreshTiles(s.map(m=>new o.a3(m.z,m.x,m.y)))}addImage(b,s,u={}){const{pixelRatio:m=1,sdf:v=!1,stretchX:w,stretchY:P,content:D,textFitWidth:F,textFitHeight:j}=u;if(this._lazyInitEmptyStyle(),!(s instanceof HTMLImageElement||o.b(s))){if(s.width===void 0||s.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:W,height:Q,data:K}=s,oe=s;return this.style.addImage(b,{data:new o.R({width:W,height:Q},new Uint8Array(K)),pixelRatio:m,stretchX:w,stretchY:P,content:D,textFitWidth:F,textFitHeight:j,sdf:v,version:0,userImage:oe}),oe.onAdd&&oe.onAdd(this,b),this}}{const{width:W,height:Q,data:K}=M.getImageData(s);this.style.addImage(b,{data:new o.R({width:W,height:Q},K),pixelRatio:m,stretchX:w,stretchY:P,content:D,textFitWidth:F,textFitHeight:j,sdf:v,version:0})}}updateImage(b,s){const u=this.style.getImage(b);if(!u)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=s instanceof HTMLImageElement||o.b(s)?M.getImageData(s):s,{width:v,height:w,data:P}=m;if(v===void 0||w===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==u.data.width||w!==u.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const D=!(s instanceof HTMLImageElement||o.b(s));return u.data.replace(P,D),this.style.updateImage(b,u),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return U.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,s){return this._lazyInitEmptyStyle(),this.style.addLayer(b,s),this._update(!0)}moveLayer(b,s){return this.style.moveLayer(b,s),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,s,u){return this.style.setLayerZoomRange(b,s,u),this._update(!0)}setFilter(b,s,u={}){return this.style.setFilter(b,s,u),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,s,u,m={}){return this.style.setPaintProperty(b,s,u,m),this._update(!0)}getPaintProperty(b,s){return this.style.getPaintProperty(b,s)}setLayoutProperty(b,s,u,m={}){return this.style.setLayoutProperty(b,s,u,m),this._update(!0)}getLayoutProperty(b,s){return this.style.getLayoutProperty(b,s)}setGlyphs(b,s={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,s),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,s,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,s,u,m=>{m||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,s={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,s,u=>{u||this._update(!0)}),this}setLight(b,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,s),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,s={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,s),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,s){return this.style.setFeatureState(b,s),this._update()}removeFeatureState(b,s){return this.style.removeFeatureState(b,s),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,s=0;return this._container&&(b=this._container.clientWidth||400,s=this._container.clientHeight||300),[b,s]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const s=this._canvasContainer=C.create("div","maplibregl-canvas-container",b);this._interactive&&s.classList.add("maplibregl-interactive"),this._canvas=C.create("canvas","maplibregl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),m=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],m);const v=this._controlContainer=C.create("div","maplibregl-control-container",b),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(P=>{w[P]=C.create("div",`maplibregl-ctrl-${P} `,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,s,u){this._canvas.width=Math.floor(u*b),this._canvas.height=Math.floor(u*s),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${s}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let s=null;this._canvas.addEventListener("webglcontextcreationerror",m=>{s={requestedAttributes:b},m&&(s.statusMessage=m.statusMessage,s.type=m.type)},{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!u){const m="Failed to initialize WebGL";throw s?(s.message=m,new Error(JSON.stringify(s))):new Error(m)}this.painter=new As(u,this.transform),A.testSupport(u)}migrateProjection(b,s){super.migrateProjection(b,s),this.painter.transform=b,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var s,u,m,v,w;const P=this._idleTriggered?this._fadeDuration:0,D=((s=this.style.projection)===null||s===void 0?void 0:s.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let F=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Q=this.transform.zoom,K=M.now();this.style.zoomHistory.update(Q,K);const oe=new o.F(Q,{now:K,fadeDuration:P,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),he=oe.crossFadingFactor();he===1&&he===this._crossFadingFactor||(F=!0,this._crossFadingFactor=he),this.style.update(oe)}const j=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==D;(m=this.style.projection)===null||m===void 0||m.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((v=this.style.projection)===null||v===void 0?void 0:v.transitionState,(w=this.style.projection)===null||w===void 0?void 0:w.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||j)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,P,this._crossSourceCollisions,j),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:P,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cv.mark(o.cw.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||F)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const W=this._sourcesDirty||this._styleDirty||this._placementDirty;return W||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||W||(this._fullyLoaded=!0,o.cv.mark(o.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),U.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const s=this.painter.context.gl.getExtension("WEBGL_lose_context");s!=null&&s.loseContext&&s.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),C.remove(this._canvasContainer),C.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cv.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,M.frame(this._frameRequest,b=>{o.cv.frame(b),this._frameRequest=null;try{this._render(b)}catch(s){if(!o.cx(s)&&!function(u){return u.message===xv}(s))throw s}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return Nv}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},c.MapMouseEvent=Jo,c.MapTouchEvent=Js,c.MapWheelEvent=Tv,c.Marker=li,c.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const s=this._map.getZoom(),u=s===this._map.getMaxZoom(),m=s===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(s,u)=>{const m=this._map._getUIString(`NavigationControl.${u}`);s.title=m,s.setAttribute("aria-label",m)},this.options=o.e({},Do,b),this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),C.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),C.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=C.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new i1(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){C.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,s){const u=C.create("button",b,this._container);return u.type="button",u.addEventListener("click",s),u}},c.Popup=class extends o.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&C.remove(this._content),this._container&&(C.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=s=>{this._update(s.point)},this._onMouseMove=s=>{this._update(s.point)},this._onDrag=s=>{this._update(s.point)},this._update=s=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=C.create("div","maplibregl-popup",this._map.getContainer()),this._tip=C.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const P of this.options.className.split(" "))this._container.classList.add(P);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=o1(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!s)return;const u=this._flatPos=this._pos=this._trackPointer&&s?s:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&s?s:this._map.transform.locationToScreenPoint(this._lngLat));let m=this.options.anchor;const v=Ap(this.options.offset);if(!m){const P=this._container.offsetWidth,D=this._container.offsetHeight;let F;F=u.y+v.bottom.y<D?["top"]:u.y>this._map.transform.height-D?["bottom"]:[],u.x<P/2?F.push("left"):u.x>this._map.transform.width-P/2&&F.push("right"),m=F.length===0?"bottom":F.join("-")}let w=u.add(v[m]);this.options.subpixelPositioning||(w=w.round()),C.setTransform(this._container,`${zc[m]} translate(${w.x}px,${w.y}px)`),ti(this._container,m,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Nd),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=o.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const s=document.createDocumentFragment(),u=document.createElement("body");let m;for(u.innerHTML=b;m=u.firstChild,m;)s.appendChild(m);return this.setDOMContent(s)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=C.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=C.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Uv);b&&b.focus()}},c.RasterDEMTileSource=tn,c.RasterTileSource=Ut,c.ScaleControl=class{constructor(b){this._onMove=()=>{Pp(this._map,this._container,this.options)},this.setUnit=s=>{this.options.unit=s,Pp(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Bv),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){C.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},c.ScrollZoomHandler=e1,c.Style=ov,c.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=C.create("button","maplibregl-ctrl-terrain",this._container),C.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){C.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},c.TwoFingersTouchPitchHandler=Rv,c.TwoFingersTouchRotateHandler=Iv,c.TwoFingersTouchZoomHandler=ka,c.TwoFingersTouchZoomRotateHandler=zv,c.VectorTileSource=vn,c.VideoSource=an,c.addSourceType=(b,s)=>o._(void 0,void 0,void 0,function*(){if(it(b))throw new Error(`A source type called "${b}" already exists.`);((u,m)=>{me[u]=m})(b,s)}),c.clearPrewarmedResources=function(){const b=Xt;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(Qe),Xt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},c.createTileMesh=nv,c.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},c.getRTLTextPluginStatus=function(){return Zt().getRTLTextPluginStatus()},c.getVersion=function(){return $v},c.getWorkerCount=function(){return st.workerCount},c.getWorkerUrl=function(){return o.a.WORKER_URL},c.importScriptInWorkers=function(b){return ut().broadcast("IS",b)},c.prewarm=function(){lt().acquire(Qe)},c.setMaxParallelImageRequests=function(b){o.a.MAX_PARALLEL_IMAGE_REQUESTS=b},c.setRTLTextPlugin=function(b,s){return Zt().setRTLTextPlugin(b,s)},c.setWorkerCount=function(b){st.workerCount=b},c.setWorkerUrl=function(b){o.a.WORKER_URL=b}});var a=n;return a})})(fj);var a2=fj.exports;const mj=oR(a2),Zde=v6({__proto__:null,default:mj},[a2]);var og=Math.pow,Uo=(e,t,n)=>new Promise((r,i)=>{var a=f=>{try{o(n.next(f))}catch(g){i(g)}},c=f=>{try{o(n.throw(f))}catch(g){i(g)}},o=f=>f.done?r(f.value):Promise.resolve(f.value).then(a,c);o((n=n.apply(e,t)).next())}),va=Uint8Array,gy=Uint16Array,Yde=Int32Array,gj=new va([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vj=new va([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Kde=new va([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yj=function(e,t){for(var n=new gy(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new Yde(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return{b:n,r:i}},_j=yj(gj,2),xj=_j.b,Jde=_j.r;xj[28]=258,Jde[258]=28;var Qde=yj(vj,0),efe=Qde.b,bj=new gy(32768);for(kr=0;kr<32768;++kr)$c=(kr&43690)>>1|(kr&21845)<<1,$c=($c&52428)>>2|($c&13107)<<2,$c=($c&61680)>>4|($c&3855)<<4,bj[kr]=(($c&65280)>>8|($c&255)<<8)>>1;var $c,kr,vy=function(e,t,n){for(var r=e.length,i=0,a=new gy(t);i<r;++i)e[i]&&++a[e[i]-1];var c=new gy(t);for(i=1;i<t;++i)c[i]=c[i-1]+a[i-1]<<1;var o;{o=new gy(1<<t);var f=15-t;for(i=0;i<r;++i)if(e[i])for(var g=i<<4|e[i],_=t-e[i],x=c[e[i]-1]++<<_,M=x|(1<<_)-1;x<=M;++x)o[bj[x]>>f]=g}return o},Q_=new va(288);for(kr=0;kr<144;++kr)Q_[kr]=8;var kr;for(kr=144;kr<256;++kr)Q_[kr]=9;var kr;for(kr=256;kr<280;++kr)Q_[kr]=7;var kr;for(kr=280;kr<288;++kr)Q_[kr]=8;var kr,wj=new va(32);for(kr=0;kr<32;++kr)wj[kr]=5;var kr,tfe=vy(Q_,9),nfe=vy(wj,5),kE=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},gl=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},DE=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},rfe=function(e){return(e+7)/8|0},ife=function(e,t,n){(n==null||n>e.length)&&(n=e.length);var r=new va(n-t);return r.set(e.subarray(t,n)),r},ofe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ua=function(e,t,n){var r=new Error(t||ofe[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,ua),!n)throw r;return r},mL=function(e,t,n,r){var i=e.length,a=0;if(!i||t.f&&!t.l)return n||new va(0);var c=!n||t.i!=2,o=t.i;n||(n=new va(i*3));var f=function(Ct){var un=n.length;if(Ct>un){var gn=new va(Math.max(un*2,Ct));gn.set(n),n=gn}},g=t.f||0,_=t.p||0,x=t.b||0,M=t.l,C=t.d,A=t.m,L=t.n,I=i*8;do{if(!M){g=gl(e,_,1);var T=gl(e,_+1,3);if(_+=3,T)if(T==1)M=tfe,C=nfe,A=9,L=5;else if(T==2){var H=gl(e,_,31)+257,V=gl(e,_+10,15)+4,q=H+gl(e,_+5,31)+1;_+=14;for(var J=new va(q),Y=new va(19),N=0;N<V;++N)Y[Kde[N]]=gl(e,_+N*3,7);_+=V*3;for(var ne=kE(Y),ye=(1<<ne)-1,ge=vy(Y,ne),N=0;N<q;){var Ne=ge[gl(e,_,ye)];_+=Ne&15;var z=Ne>>4;if(z<16)J[N++]=z;else{var Ae=0,ve=0;for(z==16?(ve=3+gl(e,_,3),_+=2,Ae=J[N-1]):z==17?(ve=3+gl(e,_,7),_+=3):z==18&&(ve=11+gl(e,_,127),_+=7);ve--;)J[N++]=Ae}}var Se=J.subarray(0,H),Me=J.subarray(H);A=kE(Se),L=kE(Me),M=vy(Se,A),C=vy(Me,L)}else ua(1);else{var z=rfe(_)+4,k=e[z-4]|e[z-3]<<8,U=z+k;if(U>i){o&&ua(0);break}c&&f(x+k),n.set(e.subarray(z,U),x),t.b=x+=k,t.p=_=U*8,t.f=g;continue}if(_>I){o&&ua(0);break}}c&&f(x+131072);for(var Ue=(1<<A)-1,Qe=(1<<L)-1,st=_;;st=_){var Ae=M[DE(e,_)&Ue],ct=Ae>>4;if(_+=Ae&15,_>I){o&&ua(0);break}if(Ae||ua(2),ct<256)n[x++]=ct;else if(ct==256){st=_,M=null;break}else{var Xt=ct-254;if(ct>264){var N=ct-257,je=gj[N];Xt=gl(e,_,(1<<je)-1)+xj[N],_+=je}var lt=C[DE(e,_)&Qe],Ot=lt>>4;lt||ua(3),_+=lt&15;var Me=efe[Ot];if(Ot>3){var je=vj[Ot];Me+=DE(e,_)&(1<<je)-1,_+=je}if(_>I){o&&ua(0);break}c&&f(x+131072);var ut=x+Xt;if(x<Me){var ot=a-Me,Tt=Math.min(Me,ut);for(ot+x<0&&ua(3);x<Tt;++x)n[x]=r[ot+x]}for(;x<ut;x+=4)n[x]=n[x-Me],n[x+1]=n[x+1-Me],n[x+2]=n[x+2-Me],n[x+3]=n[x+3-Me];x=ut}}t.l=M,t.p=st,t.b=x,t.f=g,M&&(g=1,t.m=A,t.d=C,t.n=L)}while(!g);return x==n.length?n:ife(n,0,x)},sfe=new va(0),afe=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&ua(6,"invalid gzip data");var t=e[3],n=10;t&4&&(n+=(e[10]|e[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(t&2)},lfe=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},cfe=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&ua(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&ua(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function ufe(e,t){return mL(e,{i:2},t,t)}function hfe(e,t){var n=afe(e);return n+8>e.length&&ua(6,"invalid gzip data"),mL(e.subarray(n,-8),{i:2},new va(lfe(e)),t)}function dfe(e,t){return mL(e.subarray(cfe(e,t),-4),{i:2},t,t)}function OA(e,t){return e[0]==31&&e[1]==139&&e[2]==8?hfe(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?ufe(e,t):dfe(e,t)}var ffe=typeof TextDecoder<"u"&&new TextDecoder,pfe=0;try{ffe.decode(sfe,{stream:!0}),pfe=1}catch{}var Sj=(e,t)=>e*og(2,t),C0=(e,t)=>Math.floor(e/og(2,t)),hS=(e,t)=>Sj(e.getUint16(t+1,!0),8)+e.getUint8(t),Mj=(e,t)=>Sj(e.getUint32(t+2,!0),16)+e.getUint16(t,!0),mfe=(e,t,n,r,i)=>{if(e!==r.getUint8(i))return e-r.getUint8(i);const a=hS(r,i+1);if(t!==a)return t-a;const c=hS(r,i+4);return n!==c?n-c:0},gfe=(e,t,n,r)=>{const i=Cj(e,t|128,n,r);return i?{z:t,x:n,y:r,offset:i[0],length:i[1],isDir:!0}:null},c4=(e,t,n,r)=>{const i=Cj(e,t,n,r);return i?{z:t,x:n,y:r,offset:i[0],length:i[1],isDir:!1}:null},Cj=(e,t,n,r)=>{let i=0,a=e.byteLength/17-1;for(;i<=a;){const c=a+i>>1,o=mfe(t,n,r,e,c*17);if(o>0)i=c+1;else if(o<0)a=c-1;else return[Mj(e,c*17+7),e.getUint32(c*17+13,!0)]}return null},vfe=(e,t)=>e.isDir&&!t.isDir?1:!e.isDir&&t.isDir?-1:e.z!==t.z?e.z-t.z:e.x!==t.x?e.x-t.x:e.y-t.y,Ej=(e,t)=>{const n=e.getUint8(t*17);return{z:n&127,x:hS(e,t*17+1),y:hS(e,t*17+4),offset:Mj(e,t*17+7),length:e.getUint32(t*17+13,!0),isDir:n>>7===1}},u4=e=>{const t=[],n=new DataView(e);for(let r=0;r<n.byteLength/17;r++)t.push(Ej(n,r));return yfe(t)},yfe=e=>{e.sort(vfe);const t=new ArrayBuffer(17*e.length),n=new Uint8Array(t);for(let r=0;r<e.length;r++){const i=e[r];let a=i.z;i.isDir&&(a=a|128),n[r*17]=a,n[r*17+1]=i.x&255,n[r*17+2]=i.x>>8&255,n[r*17+3]=i.x>>16&255,n[r*17+4]=i.y&255,n[r*17+5]=i.y>>8&255,n[r*17+6]=i.y>>16&255,n[r*17+7]=i.offset&255,n[r*17+8]=C0(i.offset,8)&255,n[r*17+9]=C0(i.offset,16)&255,n[r*17+10]=C0(i.offset,24)&255,n[r*17+11]=C0(i.offset,32)&255,n[r*17+12]=C0(i.offset,48)&255,n[r*17+13]=i.length&255,n[r*17+14]=i.length>>8&255,n[r*17+15]=i.length>>16&255,n[r*17+16]=i.length>>24&255}return t},_fe=(e,t)=>{if(e.byteLength<17)return null;const n=e.byteLength/17,r=Ej(e,n-1);if(r.isDir){const i=r.z,a=t.z-i,c=Math.trunc(t.x/(1<<a)),o=Math.trunc(t.y/(1<<a));return{z:i,x:c,y:o}}return null};function xfe(e){return Uo(this,null,function*(){const t=yield e.getBytes(0,512e3),n=new DataView(t.data),r=n.getUint32(4,!0),i=n.getUint16(8,!0),a=new TextDecoder("utf-8"),c=JSON.parse(a.decode(new DataView(t.data,10,r)));let o=0;c.compression==="gzip"&&(o=2);let f=0;"minzoom"in c&&(f=+c.minzoom);let g=0;"maxzoom"in c&&(g=+c.maxzoom);let _=0,x=0,M=0,C=-180,A=-85,L=180,I=85;if(c.bounds){const z=c.bounds.split(",");C=+z[0],A=+z[1],L=+z[2],I=+z[3]}if(c.center){const z=c.center.split(",");_=+z[0],x=+z[1],M=+z[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:i*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:o,tileType:1,minZoom:f,maxZoom:g,minLon:C,minLat:A,maxLon:L,maxLat:I,centerZoom:M,centerLon:_,centerLat:x,etag:t.etag}})}function bfe(e,t,n,r,i,a,c){return Uo(this,null,function*(){let o=yield n.getArrayBuffer(t,e.rootDirectoryOffset,e.rootDirectoryLength,e);e.specVersion===1&&(o=u4(o));const f=c4(new DataView(o),r,i,a);if(f){let x=(yield t.getBytes(f.offset,f.length,c)).data;const M=new DataView(x);return M.getUint8(0)===31&&M.getUint8(1)===139&&(x=OA(new Uint8Array(x))),{data:x}}const g=_fe(new DataView(o),{z:r,x:i,y:a});if(g){const _=gfe(new DataView(o),g.z,g.x,g.y);if(_){let x=yield n.getArrayBuffer(t,_.offset,_.length,e);e.specVersion===1&&(x=u4(x));const M=c4(new DataView(x),r,i,a);if(M){let A=(yield t.getBytes(M.offset,M.length,c)).data;const L=new DataView(A);return L.getUint8(0)===31&&L.getUint8(1)===139&&(A=OA(new Uint8Array(A))),{data:A}}}}})}var Tj={getHeader:xfe,getZxy:bfe},wfe=e=>(t,n)=>{if(n instanceof AbortController)return e(t,n);const r=new AbortController;return e(t,r).then(i=>n(void 0,i.data,i.cacheControl||"",i.expires||""),i=>n(i)).catch(i=>n(i)),{cancel:()=>r.abort()}},Sfe=class{constructor(e){this.tilev4=(t,n)=>Uo(this,null,function*(){if(t.type==="json"){const M=t.url.substr(10);let C=this.tiles.get(M);if(C||(C=new h4(M),this.tiles.set(M,C)),this.metadata)return{data:yield C.getTileJson(t.url)};const A=yield C.getHeader();return{data:{tiles:[`${t.url}/{z}/{x}/{y}`],minzoom:A.minZoom,maxzoom:A.maxZoom,bounds:[A.minLon,A.minLat,A.maxLon,A.maxLat]}}}const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),i=t.url.match(r);if(!i)throw new Error("Invalid PMTiles protocol URL");const a=i[1];let c=this.tiles.get(a);c||(c=new h4(a),this.tiles.set(a,c));const o=i[2],f=i[3],g=i[4],_=yield c.getHeader(),x=yield c==null?void 0:c.getZxy(+o,+f,+g,n.signal);return x?{data:new Uint8Array(x.data),cacheControl:x.cacheControl,expires:x.expires}:_.tileType===1?{data:new Uint8Array}:{data:null}}),this.tile=wfe(this.tilev4),this.tiles=new Map,this.metadata=(e==null?void 0:e.metadata)||!1}add(e){this.tiles.set(e.source.getKey(),e)}get(e){return this.tiles.get(e)}};function Yp(e,t){return(t>>>0)*4294967296+(e>>>0)}function Mfe(e,t){const n=t.buf;let r=n[t.pos++],i=(r&112)>>4;if(r<128||(r=n[t.pos++],i|=(r&127)<<3,r<128)||(r=n[t.pos++],i|=(r&127)<<10,r<128)||(r=n[t.pos++],i|=(r&127)<<17,r<128)||(r=n[t.pos++],i|=(r&127)<<24,r<128)||(r=n[t.pos++],i|=(r&1)<<31,r<128))return Yp(e,i);throw new Error("Expected varint not more than 10 bytes")}function E0(e){const t=e.buf;let n=t[e.pos++],r=n&127;return n<128||(n=t[e.pos++],r|=(n&127)<<7,n<128)||(n=t[e.pos++],r|=(n&127)<<14,n<128)||(n=t[e.pos++],r|=(n&127)<<21,n<128)?r:(n=t[e.pos],r|=(n&15)<<28,Mfe(r,e))}function Cfe(e,t,n,r){if(r===0){n===1&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);const i=t[0];t[0]=t[1],t[1]=i}}var Efe=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Tfe(e,t,n){if(e>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>og(2,e)-1||n>og(2,e)-1)throw Error("tile x/y outside zoom level bounds");const r=Efe[e],i=og(2,e);let a=0,c=0,o=0;const f=[t,n];let g=i/2;for(;g>0;)a=(f[0]&g)>0?1:0,c=(f[1]&g)>0?1:0,o+=g*g*(3*a^c),Cfe(g,f,a,c),g=g/2;return r+o}function Pj(e,t){return Uo(this,null,function*(){if(t===1||t===0)return e;if(t===2){if(typeof globalThis.DecompressionStream>"u")return OA(new Uint8Array(e));const n=new Response(e).body;if(!n)throw Error("Failed to read response stream");const r=n.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(r).arrayBuffer()}throw Error("Compression method not supported")})}function Pfe(e){return e===1?".mvt":e===2?".png":e===3?".jpg":e===4?".webp":e===5?".avif":""}var Afe=127;function Ife(e,t){let n=0,r=e.length-1;for(;n<=r;){const i=r+n>>1,a=t-e[i].tileId;if(a>0)n=i+1;else if(a<0)r=i-1;else return e[i]}return r>=0&&(e[r].runLength===0||t-e[r].tileId<e[r].runLength)?e[r]:null}var Rfe=class{constructor(e,t=new Headers){this.url=e,this.customHeaders=t,this.mustReload=!1;let n="";"navigator"in globalThis&&(n=globalThis.navigator.userAgent||"");const r=n.indexOf("Windows")>-1,i=/Chrome|Chromium|Edg|OPR|Brave/.test(n);this.chromeWindowsNoCache=!1,r&&i&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(e){this.customHeaders=e}getBytes(e,t,n,r){return Uo(this,null,function*(){let i,a;n?a=n:(i=new AbortController,a=i.signal);const c=new Headers(this.customHeaders);c.set("range",`bytes=${e}-${e+t-1}`);let o;this.mustReload?o="reload":this.chromeWindowsNoCache&&(o="no-store");let f=yield fetch(this.url,{signal:a,cache:o,headers:c});if(e===0&&f.status===416){const M=f.headers.get("Content-Range");if(!M||!M.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const C=+M.substr(8);f=yield fetch(this.url,{signal:a,cache:"reload",headers:{range:`bytes=0-${C-1}`}})}let g=f.headers.get("Etag");if(g!=null&&g.startsWith("W/")&&(g=null),f.status===416||r&&g&&g!==r)throw this.mustReload=!0,new FA(`Server returned non-matching ETag ${r} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(f.status>=300)throw Error(`Bad response code: ${f.status}`);const _=f.headers.get("Content-Length");if(f.status===200&&(!_||+_>t))throw i&&i.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield f.arrayBuffer(),etag:g||void 0,cacheControl:f.headers.get("Cache-Control")||void 0,expires:f.headers.get("Expires")||void 0}})}};function vl(e,t){const n=e.getUint32(t+4,!0),r=e.getUint32(t+0,!0);return n*og(2,32)+r}function Lfe(e,t){const n=new DataView(e),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:vl(n,8),rootDirectoryLength:vl(n,16),jsonMetadataOffset:vl(n,24),jsonMetadataLength:vl(n,32),leafDirectoryOffset:vl(n,40),leafDirectoryLength:vl(n,48),tileDataOffset:vl(n,56),tileDataLength:vl(n,64),numAddressedTiles:vl(n,72),numTileEntries:vl(n,80),numTileContents:vl(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:t}}function Aj(e){const t={buf:new Uint8Array(e),pos:0},n=E0(t),r=[];let i=0;for(let a=0;a<n;a++){const c=E0(t);r.push({tileId:i+c,offset:0,length:0,runLength:1}),i+=c}for(let a=0;a<n;a++)r[a].runLength=E0(t);for(let a=0;a<n;a++)r[a].length=E0(t);for(let a=0;a<n;a++){const c=E0(t);c===0&&a>0?r[a].offset=r[a-1].offset+r[a-1].length:r[a].offset=c-1}return r}function kfe(e){const t=new DataView(e);return t.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):t.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var FA=class extends Error{};function Dfe(e,t){return Uo(this,null,function*(){const n=yield e.getBytes(0,16384);if(new DataView(n.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(kfe(n.data)<3)return[yield Tj.getHeader(e)];const i=n.data.slice(0,Afe),a=Lfe(i,n.etag),c=n.data.slice(a.rootDirectoryOffset,a.rootDirectoryOffset+a.rootDirectoryLength),o=`${e.getKey()}|${a.etag||""}|${a.rootDirectoryOffset}|${a.rootDirectoryLength}`,f=Aj(yield t(c,a.internalCompression));return[a,[o,f.length,f]]})}function zfe(e,t,n,r,i){return Uo(this,null,function*(){const a=yield e.getBytes(n,r,void 0,i.etag),c=yield t(a.data,i.internalCompression),o=Aj(c);if(o.length===0)throw new Error("Empty directory is invalid");return o})}var Ofe=class{constructor(e=100,t=!0,n=Pj){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=e,this.counter=1,this.decompress=n}getHeader(e){return Uo(this,null,function*(){const t=e.getKey(),n=this.cache.get(t);if(n)return n.lastUsed=this.counter++,yield n.data;const r=new Promise((i,a)=>{Dfe(e,this.decompress).then(c=>{c[1]&&this.cache.set(c[1][0],{lastUsed:this.counter++,data:Promise.resolve(c[1][2])}),i(c[0]),this.prune()}).catch(c=>{a(c)})});return this.cache.set(t,{lastUsed:this.counter++,data:r}),r})}getDirectory(e,t,n,r){return Uo(this,null,function*(){const i=`${e.getKey()}|${r.etag||""}|${t}|${n}`,a=this.cache.get(i);if(a)return a.lastUsed=this.counter++,yield a.data;const c=new Promise((o,f)=>{zfe(e,this.decompress,t,n,r).then(g=>{o(g),this.prune()}).catch(g=>{f(g)})});return this.cache.set(i,{lastUsed:this.counter++,data:c}),c})}getArrayBuffer(e,t,n,r){return Uo(this,null,function*(){const i=`${e.getKey()}|${r.etag||""}|${t}|${n}`,a=this.cache.get(i);if(a)return a.lastUsed=this.counter++,yield a.data;const c=new Promise((o,f)=>{e.getBytes(t,n,void 0,r.etag).then(g=>{o(g.data),this.cache.has(i),this.prune()}).catch(g=>{f(g)})});return this.cache.set(i,{lastUsed:this.counter++,data:c}),c})}prune(){if(this.cache.size>=this.maxCacheEntries){let e=1/0,t;this.cache.forEach((n,r)=>{n.lastUsed<e&&(e=n.lastUsed,t=r)}),t&&this.cache.delete(t)}}invalidate(e){return Uo(this,null,function*(){const t=e.getKey();if(this.invalidations.get(t))return yield this.invalidations.get(t);this.cache.delete(e.getKey());const n=new Promise((r,i)=>{this.getHeader(e).then(a=>{r(),this.invalidations.delete(t)}).catch(a=>{i(a)})});this.invalidations.set(t,n)})}},h4=class{constructor(e,t,n){typeof e=="string"?this.source=new Rfe(e):this.source=e,n?this.decompress=n:this.decompress=Pj,t?this.cache=t:this.cache=new Ofe}getHeader(){return Uo(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(e,t,n,r){return Uo(this,null,function*(){const i=Tfe(e,t,n),a=yield this.cache.getHeader(this.source);if(a.specVersion<3)return Tj.getZxy(a,this.source,this.cache,e,t,n,r);if(e<a.minZoom||e>a.maxZoom)return;let c=a.rootDirectoryOffset,o=a.rootDirectoryLength;for(let f=0;f<=3;f++){const g=yield this.cache.getDirectory(this.source,c,o,a),_=Ife(g,i);if(_){if(_.runLength>0){const x=yield this.source.getBytes(a.tileDataOffset+_.offset,_.length,r,a.etag);return{data:yield this.decompress(x.data,a.tileCompression),cacheControl:x.cacheControl,expires:x.expires}}c=a.leafDirectoryOffset+_.offset,o=_.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(e,t,n,r){return Uo(this,null,function*(){try{return yield this.getZxyAttempt(e,t,n,r)}catch(i){if(i instanceof FA)return this.cache.invalidate(this.source),yield this.getZxyAttempt(e,t,n,r);throw i}})}getMetadataAttempt(){return Uo(this,null,function*(){const e=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength,void 0,e.etag),n=yield this.decompress(t.data,e.internalCompression),r=new TextDecoder("utf-8");return JSON.parse(r.decode(n))})}getMetadata(){return Uo(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(e){if(e instanceof FA)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw e}})}getTileJson(e){return Uo(this,null,function*(){const t=yield this.getHeader(),n=yield this.getMetadata(),r=Pfe(t.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${e}/{z}/{x}/{y}${r}`],vector_layers:n.vector_layers,attribution:n.attribution,description:n.description,name:n.name,version:n.version,bounds:[t.minLon,t.minLat,t.maxLon,t.maxLat],center:[t.centerLon,t.centerLat,t.centerZoom],minzoom:t.minZoom,maxzoom:t.maxZoom}})}};let d4=!1;function gL(){if(d4)return;const e=new Sfe;mj.addProtocol("pmtiles",e.tile),d4=!0}const l2=e=>{gL();const{mode:t="light",children:n,tileRootUrl:r}=e,i=pL[t];return ee.jsxs(ee.Fragment,{children:[ee.jsx(dr,{id:"background",type:"background",paint:{"background-color":i.land}}),ee.jsxs(jh,{id:"world",type:"vector",url:`pmtiles://${r}/world.pmtiles`,children:[ee.jsx(dr,{"source-layer":"water",type:"fill",paint:{"fill-color":i.water}}),n,ee.jsx(dr,{"source-layer":"states",type:"line",paint:{"line-color":i.stateBorder,"line-width":1,"line-opacity":1,"line-dasharray":[2,2]}}),ee.jsx(dr,{"source-layer":"countries",type:"line",filter:["!=",["get","name"],"Serbia-Kosovo"],paint:{"line-color":i.countryBorder,"line-width":2,"line-opacity":1}}),ee.jsx(dr,{"source-layer":"countries",type:"line",filter:["==",["get","name"],"Serbia-Kosovo"],paint:{"line-color":i.countryBorder,"line-width":2,"line-opacity":1,"line-dasharray":[3,2]}})]})]})},NA=e=>(gL(),ee.jsx(jh,{type:"vector",url:`pmtiles://${e.tileRootUrl}/${e.game}-contours.pmtiles`,children:ee.jsx(dr,{"source-layer":"contours",type:"fill",layout:{"fill-sort-key":["get","elevation"],visibility:e.showContours?"visible":"none"},paint:{"fill-color":["interpolate",["linear"],["get","elevation"],-200,"#77c571",0,"#77c571",100,"#afd35f",150,"#ece75b",200,"#decb4c",250,"#d2b446",300,"#bf9c4a",400,"#ba8839",500,"#ac792d"]}})}));class zl extends Error{constructor(t){super("unreachable value "+JSON.stringify(t))}}class Pg{static checkArgument(t,n){if(!t)throw new Error(n)}static checkState(t,n){if(!t)throw new Error(n)}static checkExists(t,n){return Qn(t,n)}}var Ai=(e=>(e[e.FuelStation=0]="FuelStation",e[e.Toll=1]="Toll",e[e.Parking=2]="Parking",e[e.RecruitmentAgency=3]="RecruitmentAgency",e[e.Service=4]="Service",e[e.TruckDealer=5]="TruckDealer",e[e.Port=6]="Port",e[e.Train=7]="Train",e[e.Viewpoint=8]="Viewpoint",e[e.PhotoSight=9]="PhotoSight",e[e.AgricultureCheck=10]="AgricultureCheck",e[e.BorderCheck=11]="BorderCheck",e[e.Garage=12]="Garage",e[e.WeighStation=13]="WeighStation",e[e.CityNames=14]="CityNames",e[e.Company=15]="Company",e[e.RoadNumber=16]="RoadNumber",e[e.Roadwork=17]="Roadwork",e[e.RailCrossing=18]="RailCrossing",e))(Ai||{});const Hh=new Set(Array.from({length:19},(e,t)=>t)),Ag=e=>{const{game:t,tileRootUrl:n,visibleIcons:r=Hh,enableIconAutoHide:i=!0,mode:a="light"}=e,c=t==="ats"?m4(t,e.dlcs??Nf):m4(t,e.dlcs??pde),o=pL[a];gL();const f=J_();return $.useEffect(()=>{if(!f.current)return;const g=f.current;g.on("styleimagemissing",_=>{if(_.id!=="exit-sign"||g.hasImage("exit-sign"))return;const x=64,M=4,C=new Uint8Array(x*x*M);for(let L=0;L<x;L++)for(let I=0;I<x;I++){const T=(I*x+L)*M;I===0||I===x-1||L===0||L===x-1?(C[T+0]=136,C[T+1]=136,C[T+2]=136,C[T+3]=255):L===1||L===2||L===x-2||L===x-3||I===1||I===2||I===x-2||I===x-3?(C[T+0]=255,C[T+1]=255,C[T+2]=255,C[T+3]=255):(C[T+0]=82,C[T+1]=177,C[T+2]=129,C[T+3]=255)}const A=8;g.addImage("exit-sign",{width:x,height:x,data:C},{stretchX:[[A,x-A]],stretchY:[[A,x-A]],content:[A,A,x-A,x-A],pixelRatio:2})})},[f.current]),ee.jsxs(jh,{id:t,type:"vector",url:`pmtiles://${n}/${t}.pmtiles`,children:[ee.jsx(dr,{id:t+"mapAreas","source-layer":t,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"mapArea"],c],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":OE(a),"fill-outline-color":["case",["==",["get","color"],aj.Road],o.mapAreaOutline,OE(a)]}}),ee.jsx(dr,{id:t+"prefabs","source-layer":t,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"prefab"],c],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":OE(a)}}),ee.jsx(Ffe,{game:t,tileRootUrl:n,mode:a,color:o.footprint}),ee.jsx(dr,{id:t+"hidden-roads","source-layer":t,type:"line",minzoom:9,filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","hidden"],!0],c],paint:{"line-color":o.hiddenRoad,"line-width":1,"line-opacity":.7}}),ee.jsx(dr,{id:t+"visible-roads-case","source-layer":t,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],c],layout:g4,paint:{"line-color":jfe(a),"line-gap-width":v4,"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,14,2,16,3]}}),ee.jsx(dr,{id:t+"visible-roads","source-layer":t,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],c],layout:g4,paint:{"line-color":Vfe(a),"line-width":v4}}),ee.jsx(dr,{id:t+"ferries","source-layer":t,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],paint:{"line-color":o.ferryLine,"line-width":1,"line-opacity":.8,"line-dasharray":[2,2]}}),ee.jsx(dr,{id:t+"trains-a","source-layer":t,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":o.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,-6]}}),ee.jsx(dr,{id:t+"trains-b","source-layer":t,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":o.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,6]}}),ee.jsx(dr,{id:t+"train-hatch","source-layer":t,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":o.trainLine,"line-width":10,"line-opacity":.8,"line-dasharray":[.1,1]}}),ee.jsx(dr,{id:t+"ferry-labels","source-layer":t,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],layout:{...ic,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":o.ferryHalo,"text-color":o.ferryLabel}}),ee.jsx(dr,{id:t+"train-labels","source-layer":t,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],layout:{...ic,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":o.trainHalo,"text-color":o.trainLabel}}),r.has(15)&&ee.jsx(dr,{id:t+"company-icons","source-layer":t,type:"symbol",minzoom:i?8:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"company"],c],layout:Vc(i,1,1.25,3.5)}),t==="ets2"&&r.has(16)&&ee.jsx(dr,{id:"euro-road-overlays","source-layer":t,minzoom:i?4.5:0,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["!",["in",["get","sprite"],["literal",f4]]]],layout:Vc(i,.4*1.25,.75*1.25,1.25*1.25)}),t==="ats"&&r.has(16)&&ee.jsx(dr,{id:t+"road-interstate-overlays","source-layer":t,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","is",["get","sprite"]],0],c],layout:Vc(i,.4,.75,1.25)}),t==="ats"&&r.has(16)&&ee.jsx(dr,{id:t+"road-us-route-overlays","source-layer":t,type:"symbol",minzoom:i?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","us",["get","sprite"]],0],c],layout:Vc(i,.4,.75,1.25)}),t==="ats"&&r.has(16)&&ee.jsx(dr,{id:t+"road-state-route-overlays","source-layer":t,type:"symbol",minzoom:i?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],c,["!",["any",["==",["index-of","is",["get","sprite"]],0],["==",["index-of","us",["get","sprite"]],0],["in",["get","sprite"],["literal",f4]]]]],layout:Vc(i,.4,.75,1.25)}),r.has(16)&&ee.jsx(dr,{id:t+"exit-points","source-layer":t,type:"symbol",paint:{"text-color":"#fff"},minzoom:i?10:0,layout:{...Vc(i,.4,.75,1.25),...ic,"text-field":"{name}","text-size":["interpolate",["linear"],["zoom"],4,4,10,10],"icon-text-fit":"both","icon-text-fit-padding":[0,2,0,2],"icon-image":"exit-sign"},filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"exit"],c]}),r.has(14)&&ee.jsx(dr,{id:t+"city-labels-small","source-layer":t,type:"symbol",minzoom:i?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],[">",["get","scaleRank"],6],c],layout:{...ic,"text-field":"{name}","text-allow-overlap":!i,"text-variable-anchor":ym,"text-size":12,"icon-image":zE,"icon-allow-overlap":!i,"icon-size":.6},paint:o.primaryTextPaint}),r.has(14)&&ee.jsx(dr,{id:t+"city-labels-medium","source-layer":t,type:"symbol",minzoom:i?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],6],[">",["get","scaleRank"],3],c],layout:{...ic,"text-field":"{name}","text-allow-overlap":!i,"text-variable-anchor":ym,"text-size":13,"icon-image":zE,"icon-allow-overlap":!i,"icon-size":.6},paint:o.primaryTextPaint}),r.has(14)&&ee.jsx(dr,{id:t+"city-labels-big","source-layer":t,type:"symbol",minzoom:i?4:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],3],c],layout:{...ic,"text-field":"{name}","text-allow-overlap":!i,"text-variable-anchor":ym,"text-size":14,"icon-image":zE,"icon-allow-overlap":!i,"icon-size":.8},paint:o.primaryTextPaint}),t==="ets2"&&r.has(14)&&ee.jsx(dr,{id:t+"country-labels","source-layer":t,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...ic,"text-font":["Klokantech Noto Sans Bold"],"text-field":"{name}","text-variable-anchor":ym,"text-size":14},paint:o.primaryTextPaint}),t==="ats"&&r.has(14)&&ee.jsx(dr,{id:t+"country-labels","source-layer":t,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...ic,"text-font":["Open Sans Light"],"text-field":"{name}","text-transform":"uppercase","text-variable-anchor":ym,"text-size":["step",["zoom"],10,5,13]},paint:o.secondaryTextPaint}),BA(r)&&ee.jsx(dr,{id:t+"poi-icons","source-layer":t,type:"symbol",minzoom:i?7:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],p4(r),c],layout:Vc(i,.6,1.25,2.5,{vertical:2,horizontal:2})}),BA(r)&&(r.has(8)||r.has(9)||r.has(5))&&ee.jsx(dr,{id:t+"poi-icon-labels","source-layer":t,type:"symbol",minzoom:i?9.5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["any",["in",["get","poiType"],["literal",["viewpoint","landmark"]]],["all",["==",["get","poiType"],"facility"],["==",["get","sprite"],"dealer_ico"]]],p4(r),c],layout:{...Vc(i,.6,1.25,2.5,{vertical:2,horizontal:2}),...ic,"text-field":"{poiName}","text-allow-overlap":!i,"text-variable-anchor":["left","right","top","bottom"],"text-radial-offset":1.5,"text-size":10},paint:o.primaryTextPaint}),(r.has(17)||r.has(18))&&ee.jsx(dr,{id:t+"traffic-icons","source-layer":t,type:"symbol",minzoom:i?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"traffic"],Ufe(r),c],layout:Vc(i,.6*.5,1.25*.5,2.5*.5,{vertical:2,horizontal:2})})]})},Ffe=({game:e,tileRootUrl:t,color:n,mode:r})=>ee.jsxs(jh,{id:e+"footprints",type:"vector",url:`pmtiles://${t}/${e}-footprints.pmtiles`,children:[ee.jsx(dr,{id:e+"footprints","source-layer":"footprints",type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-color":n,"fill-opacity":["step",["zoom"],1,9,.8]}}),ee.jsx(dr,{id:e+"extrusions",minzoom:9,"source-layer":"footprints",type:"fill-extrusion",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-extrusion-color":n,"fill-extrusion-height":["interpolate",["exponential",1.5],["zoom"],9,["*",10,["get","height"]],13,["*",20,["get","height"]]],"fill-extrusion-opacity":r==="light"?.33:.67}})]});function Vc(e,t,n,r,i={vertical:10,horizontal:30}){const a=["literal",[i.vertical,i.horizontal]];return{"icon-image":"{sprite}","icon-allow-overlap":!e,"icon-padding":a,"icon-size":["interpolate",["exponential",1.5],["zoom"],4,t,9,n,13,r]}}const zE=["step",["zoom"],["case",["==",["get","capital"],2],"dotdot","dot"],8,""],Nfe=[9,8,6,7,2,0,4,5,12,3,13,1,10,11],Ij=[17,18],f4=["weigh_ico","toll_ico","agri_check","border_ico"];function BA(e){return Nfe.some(t=>e.has(t))}function Bfe(e){return Ij.some(t=>e.has(t))}function Ufe(e){Pg.checkArgument(Bfe(e));const t=[];return e.has(17)&&t.push("roadwork"),e.has(18)&&t.push("railcrossing"),["any",t.length>0?["in",["get","sprite"],["literal",t]]:!1]}function p4(e){Pg.checkArgument(BA(e));const t=[];e.has(9)&&t.push("landmark"),e.has(8)&&t.push("viewpoint"),e.has(6)&&t.push("ferry"),e.has(7)&&t.push("train");const n=[];e.has(0)&&n.push("gas_ico"),e.has(4)&&n.push("service_ico"),e.has(13)&&n.push("weigh_station_ico"),e.has(5)&&n.push("dealer_ico"),e.has(12)&&n.push("garage_large_ico"),e.has(3)&&n.push("recruitment_ico"),e.has(2)&&n.push("parking_ico");const r=[];e.has(13)&&r.push("weigh_ico"),e.has(1)&&r.push("toll_ico"),e.has(10)&&r.push("agri_check"),e.has(11)&&r.push("border_ico");const i=t.length>0?["in",["get","poiType"],["literal",t]]:!1,a=n.length>0?["all",["==",["get","poiType"],"facility"],["in",["get","sprite"],["literal",n]]]:!1,c=r.length>0?["all",["==",["get","poiType"],"road"],["in",["get","sprite"],["literal",r]]]:!1;return["any",i,a,c]}function m4(e,t){let n;return e==="ats"?n=K_(t):(n=gde(t),n.add(null)),["in",["get","dlcGuard"],["literal",[...n]]]}const ym=["step",["zoom"],["literal",["top","bottom","right","left"]],7,["literal",["center"]]],ic={"text-radial-offset":.5,"text-justify":"auto","text-font":["Klokantech Noto Sans Regular"]},g4={"line-cap":"round","line-join":"bevel"},v4=["interpolate",["exponential",1.5],["zoom"],3,.8,14,30,16,150],Rj={light:{freeway:["#fde293","#f8c248"],divided:["#ffffff","#dddddd"],no_vehicles:["#aaaaaa","#888888"],local:["#f1f3f4","#dddddd"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]},dark:{freeway:["#95813e","#372f21"],divided:["#3c4043","#4c5043"],no_vehicles:["#606166","#888888"],local:["#606166","#333"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]}},$fe={light:{0:"hsl(200, 8%, 92%)",1:"hsl(38, 59%, 76%)",2:"hsl(38, 64%, 58%)",3:"hsl(92, 31%, 70%)",4:"hsl(0, 100%, 30%)",5:"hsl(107, 51%, 43%)",6:"hsl(201, 53%, 39%)",7:"hsl(53, 84%, 53%)",8:"hsl(267,46% ,45%)"},dark:{0:"hsl(200, 2%, 36%)",1:"hsl(38, 25%, 35%)",2:"hsl(38, 25%, 25%)",3:"hsl(143, 20%, 25%)",4:"hsl(0, 100%, 25%)",5:"hsl(107, 51%, 25%)",6:"hsl(201, 53%, 25%)",7:"hsl(53, 84%, 25%)",8:"hsl(267, 46%, 25%)"}},Vfe=e=>["match",["get","roadType"],...Object.entries(Rj[e]).flatMap(([t,[n]])=>[t,n]),"#f0f"],jfe=e=>["match",["get","roadType"],...Object.entries(Rj[e]).flatMap(([t,[,n]])=>[t,n]),"#b0b"],OE=e=>["match",["get","color"],...Object.entries($fe[e]).flatMap(([t,n])=>[Number(t),n]),"#b0b"],Hfe="/extra-labels.geojson",Gfe="/ets2-villages.geojson";var lo=(e=>(e.AR="AR",e.AZ="AZ",e.CA="CA",e.CO="CO",e.IA="IA",e.ID="ID",e.KS="KS",e.MO="MO",e.MT="MT",e.NE="NE",e.NM="NM",e.NV="NV",e.OK="OK",e.OR="OR",e.TX="TX",e.UT="UT",e.WA="WA",e.WY="WY",e))(lo||{});const Wfe={AR:void 0,AZ:void 0,CA:void 0,CO:void 0,IA:void 0,ID:void 0,KS:void 0,MO:void 0,MT:void 0,NE:void 0,NM:void 0,NV:void 0,OK:void 0,OR:void 0,TX:void 0,UT:void 0,WA:void 0,WY:void 0},qfe=new Set(Object.keys(Wfe)),UA=e=>{const{game:t,enableAutoHide:n=!0,mode:r="light"}=e,i=t==="ats"?Hfe:Gfe,a=t==="ats"?["all",["boolean",["get","show"],!0],["in",["slice",["get","country"],-2],["literal",[...e.enabledStates??qfe]]]]:["boolean",!0],c=pL[r];return ee.jsx(jh,{id:`${t}-scenery-towns`,type:"geojson",data:i,children:ee.jsx(dr,{id:`${t}-scenery-towns`,type:"symbol",minzoom:n?7:0,filter:a,layout:{...ic,"text-field":t==="ats"?"{text}":"{name}","text-allow-overlap":!n,"text-variable-anchor":ym,"text-size":10.5},paint:c.primaryTextPaint})})},c2=new Proxy({version:8,sprite:"/sprites",glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",sources:{},layers:[]},{get(e,t,n){var r;return t==="sprite"&&((r=e.sprite)!=null&&r.toString().match(/^\/\w/))?window.location.origin+e.sprite.toString():Reflect.get(e,t,n)}}),Xfe=qo(ee.jsx("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6"})),Zfe=qo(ee.jsx("path",{d:"M10.85 12.65h2.3L12 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM14.3 16l-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9z"})),Yfe=qo(ee.jsx("path",{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6m0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4"})),Kfe=qo(ee.jsx("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6"})),y4=qo(ee.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),Jfe=qo(ee.jsx("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"})),Qfe=qo(ee.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"})),epe=qo(ee.jsx("path",{d:"m12 5.69 5 4.5V18h-2v-6H9v6H7v-7.81zM12 3 2 12h3v8h6v-6h2v6h6v-8h3z"})),tpe=qo(ee.jsx("path",{d:"m16 5-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2"})),npe=qo(ee.jsx("path",{d:"M19 5v14H5V5zm1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9M11 7h6v2h-6zm0 4h6v2h-6zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z"})),rpe=qo(ee.jsx("path",{d:"M15 11V5l-3-3-3 3v2H3v14h18V11zm-8 8H5v-2h2zm0-4H5v-2h2zm0-4H5V9h2zm6 8h-2v-2h2zm0-4h-2v-2h2zm0-4h-2V9h2zm0-4h-2V5h2zm6 12h-2v-2h2zm0-4h-2v-2h2z"})),ipe=qo(ee.jsx("path",{d:"M2 18v4h3v-2h5.5v2h3v-2H19v2h3v-4zM18 2H6c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1m-3 6H9V6h6z"})),ope=qo(ee.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"})),Lj=qo(ee.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),kj=qo(ee.jsx("path",{d:"m21.58 16.09-1.09-7.66C20.21 6.46 18.52 5 16.53 5H7.47C5.48 5 3.79 6.46 3.51 8.43l-1.09 7.66C2.2 17.63 3.39 19 4.94 19c.68 0 1.32-.27 1.8-.75L9 16h6l2.25 2.25c.48.48 1.13.75 1.8.75 1.56 0 2.75-1.37 2.53-2.91M11 11H9v2H8v-2H6v-1h2V8h1v2h2zm4-1c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m2 3c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"})),Dj=qo(ee.jsx("path",{d:"M20.69 4.05C18.66 4.73 15.86 5.5 12 5.5c-3.89 0-6.95-.84-8.69-1.43-.64-.22-1.31.26-1.31.95V19c0 .68.66 1.17 1.31.95C5.36 19.26 8.1 18.5 12 18.5c3.87 0 6.66.76 8.69 1.45.65.21 1.31-.27 1.31-.95V5c0-.68-.66-1.16-1.31-.95M12 15c-2.34 0-4.52.15-6.52.41l3.69-4.42 2 2.4L14 10l4.51 5.4c-1.99-.25-4.21-.4-6.51-.4"}));function zj(e,t){return Nj(e,t,(n,r,i,a)=>Math.sqrt(Math.pow(i-n,2)+Math.pow(a-r,2)))}function spe(e,t){return Nj(e,t,(n,r,i,a)=>[(n+i)/2,(r+a)/2])}function _4([e,t,n,r]){return spe([e,t],[n,r])}function Oj(e){let t=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;for(const a of e)Array.isArray(a)?(t=Math.min(t,a[0]),r=Math.max(r,a[0]),n=Math.min(n,a[1]),i=Math.max(i,a[1])):(t=Math.min(t,a.x),r=Math.max(r,a.x),n=Math.min(n,a.y),i=Math.max(i,a.y));return[t,n,r,i]}function K1(e,t){const[n,r,i,a]=e,[c,o]=Array.isArray(t)?t:[t.x,t.y];return n<=c&&c<=i&&r<=o&&o<=a}function Fj(e){const t=Math.PI*2;let n=e%t;return n=(n+t)%t,n<=Math.PI?n:n-t}function x4(e){return Fj(e*Math.PI/180)}function b4(e,t){let n,r;return Array.isArray(e)?(Pg.checkArgument(e.length>=2),n=e[0],r=e[1]):(n=e.x,r=e.y),t(n,r)}function Nj(e,t,n){const[r,i]=b4(e,(o,f)=>[o,f]),[a,c]=b4(t,(o,f)=>[o,f]);return n(r,i,a,c)}function ape(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var t=1;t<=60;++t)e("EPSG:"+(32600+t),"+proj=utm +zone="+t+" +datum=WGS84 +units=m"),e("EPSG:"+(32700+t),"+proj=utm +zone="+t+" +south +datum=WGS84 +units=m");e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}var Bf=1,Uf=2,sg=3,lpe=4,$A=5,w4=6378137,cpe=6356752314e-3,S4=.0066943799901413165,yy=484813681109536e-20,on=Math.PI/2,upe=.16666666666666666,hpe=.04722222222222222,dpe=.022156084656084655,Pn=1e-10,No=.017453292519943295,hc=57.29577951308232,Fr=Math.PI/4,d_=Math.PI*2,zi=3.14159265359,Zs={};Zs.greenwich=0;Zs.lisbon=-9.131906111111;Zs.paris=2.337229166667;Zs.bogota=-74.080916666667;Zs.madrid=-3.687938888889;Zs.rome=12.452333333333;Zs.bern=7.439583333333;Zs.jakarta=106.807719444444;Zs.ferro=-17.666666666667;Zs.brussels=4.367975;Zs.stockholm=18.058277777778;Zs.athens=23.7163375;Zs.oslo=10.722916666667;const fpe={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var M4=/[\s_\-\/\(\)]/g;function Gh(e,t){if(e[t])return e[t];for(var n=Object.keys(e),r=t.toLowerCase().replace(M4,""),i=-1,a,c;++i<n.length;)if(a=n[i],c=a.toLowerCase().replace(M4,""),c===r)return e[a]}function VA(e){var t={},n=e.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,f){var g=f.split("=");return g.push(!0),o[g[0].toLowerCase()]=g[1],o},{}),r,i,a,c={proj:"projName",datum:"datumCode",rf:function(o){t.rf=parseFloat(o)},lat_0:function(o){t.lat0=o*No},lat_1:function(o){t.lat1=o*No},lat_2:function(o){t.lat2=o*No},lat_ts:function(o){t.lat_ts=o*No},lon_0:function(o){t.long0=o*No},lon_1:function(o){t.long1=o*No},lon_2:function(o){t.long2=o*No},alpha:function(o){t.alpha=parseFloat(o)*No},gamma:function(o){t.rectified_grid_angle=parseFloat(o)},lonc:function(o){t.longc=o*No},x_0:function(o){t.x0=parseFloat(o)},y_0:function(o){t.y0=parseFloat(o)},k_0:function(o){t.k0=parseFloat(o)},k:function(o){t.k0=parseFloat(o)},a:function(o){t.a=parseFloat(o)},b:function(o){t.b=parseFloat(o)},r:function(o){t.a=t.b=parseFloat(o)},r_a:function(){t.R_A=!0},zone:function(o){t.zone=parseInt(o,10)},south:function(){t.utmSouth=!0},towgs84:function(o){t.datum_params=o.split(",").map(function(f){return parseFloat(f)})},to_meter:function(o){t.to_meter=parseFloat(o)},units:function(o){t.units=o;var f=Gh(fpe,o);f&&(t.to_meter=f.to_meter)},from_greenwich:function(o){t.from_greenwich=o*No},pm:function(o){var f=Gh(Zs,o);t.from_greenwich=(f||parseFloat(o))*No},nadgrids:function(o){o==="@null"?t.datumCode="none":t.nadgrids=o},axis:function(o){var f="ewnsud";o.length===3&&f.indexOf(o.substr(0,1))!==-1&&f.indexOf(o.substr(1,1))!==-1&&f.indexOf(o.substr(2,1))!==-1&&(t.axis=o)},approx:function(){t.approx=!0}};for(r in n)i=n[r],r in c?(a=c[r],typeof a=="function"?a(i):t[a]=i):t[r]=i;return typeof t.datumCode=="string"&&t.datumCode!=="WGS84"&&(t.datumCode=t.datumCode.toLowerCase()),t}var f_=1,Bj=2,Uj=3,dS=4,$j=5,vL=-1,ppe=/\s/,mpe=/[A-Za-z]/,gpe=/[A-Za-z84_]/,u2=/[,\]]/,Vj=/[\d\.E\-\+]/;function wu(e){if(typeof e!="string")throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=f_}wu.prototype.readCharicter=function(){var e=this.text[this.place++];if(this.state!==dS)for(;ppe.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case f_:return this.neutral(e);case Bj:return this.keyword(e);case dS:return this.quoted(e);case $j:return this.afterquote(e);case Uj:return this.number(e);case vL:return}};wu.prototype.afterquote=function(e){if(e==='"'){this.word+='"',this.state=dS;return}if(u2.test(e)){this.word=this.word.trim(),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in afterquote yet, index '+this.place)};wu.prototype.afterItem=function(e){if(e===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=f_;return}if(e==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=f_,this.currentObject=this.stack.pop(),this.currentObject||(this.state=vL);return}};wu.prototype.number=function(e){if(Vj.test(e)){this.word+=e;return}if(u2.test(e)){this.word=parseFloat(this.word),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in number yet, index '+this.place)};wu.prototype.quoted=function(e){if(e==='"'){this.state=$j;return}this.word+=e};wu.prototype.keyword=function(e){if(gpe.test(e)){this.word+=e;return}if(e==="["){var t=[];t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=f_;return}if(u2.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in keyword yet, index '+this.place)};wu.prototype.neutral=function(e){if(mpe.test(e)){this.word=e,this.state=Bj;return}if(e==='"'){this.word="",this.state=dS;return}if(Vj.test(e)){this.word=e,this.state=Uj;return}if(u2.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in neutral yet, index '+this.place)};wu.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===vL)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function vpe(e){var t=new wu(e);return t.output()}function FE(e,t,n){Array.isArray(t)&&(n.unshift(t),t=null);var r=t?{}:e,i=n.reduce(function(a,c){return Nm(c,a),a},r);t&&(e[t]=i)}function Nm(e,t){if(!Array.isArray(e)){t[e]=!0;return}var n=e.shift();if(n==="PARAMETER"&&(n=e.shift()),e.length===1){if(Array.isArray(e[0])){t[n]={},Nm(e[0],t[n]);return}t[n]=e[0];return}if(!e.length){t[n]=!0;return}if(n==="TOWGS84"){t[n]=e;return}if(n==="AXIS"){n in t||(t[n]=[]),t[n].push(e);return}Array.isArray(n)||(t[n]={});var r;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[n]={name:e[0].toLowerCase(),convert:e[1]},e.length===3&&Nm(e[2],t[n]);return;case"SPHEROID":case"ELLIPSOID":t[n]={name:e[0],a:e[1],rf:e[2]},e.length===4&&Nm(e[3],t[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":e[0]=["name",e[0]],FE(t,n,e);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":e[0]=["name",e[0]],FE(t,n,e),t[n].type=n;return;default:for(r=-1;++r<e.length;)if(!Array.isArray(e[r]))return Nm(e,t[n]);return FE(t,n,e)}}var ype=.017453292519943295,_pe=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function xpe(e,t){var n=t[0],r=t[1];!(n in e)&&r in e&&(e[n]=e[r],t.length===3&&(e[n]=t[2](e[n])))}function Ql(e){return e*ype}function jj(e){for(var t=Object.keys(e),n=0,r=t.length;n<r;++n){var i=t[n];_pe.indexOf(i)!==-1&&bpe(e[i]),typeof e[i]=="object"&&jj(e[i])}}function bpe(e){if(e.AUTHORITY){var t=Object.keys(e.AUTHORITY)[0];t&&t in e.AUTHORITY&&(e.title=t+":"+e.AUTHORITY[t])}if(e.type==="GEOGCS"?e.projName="longlat":e.type==="LOCAL_CS"?(e.projName="identity",e.local=!0):typeof e.PROJECTION=="object"?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var n="",r=0,i=e.AXIS.length;r<i;++r){var a=[e.AXIS[r][0].toLowerCase(),e.AXIS[r][1].toLowerCase()];a[0].indexOf("north")!==-1||(a[0]==="y"||a[0]==="lat")&&a[1]==="north"?n+="n":a[0].indexOf("south")!==-1||(a[0]==="y"||a[0]==="lat")&&a[1]==="south"?n+="s":a[0].indexOf("east")!==-1||(a[0]==="x"||a[0]==="lon")&&a[1]==="east"?n+="e":(a[0].indexOf("west")!==-1||(a[0]==="x"||a[0]==="lon")&&a[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(e.axis=n)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.UNIT.convert&&(e.type==="GEOGCS"?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var c=e.GEOGCS;e.type==="GEOGCS"&&(c=e),c&&(c.DATUM?e.datumCode=c.DATUM.name.toLowerCase():e.datumCode=c.name.toLowerCase(),e.datumCode.slice(0,2)==="d_"&&(e.datumCode=e.datumCode.slice(2)),e.datumCode==="new_zealand_1949"&&(e.datumCode="nzgd49"),(e.datumCode==="wgs_1984"||e.datumCode==="world_geodetic_system_1984")&&(e.PROJECTION==="Mercator_Auxiliary_Sphere"&&(e.sphere=!0),e.datumCode="wgs84"),e.datumCode==="belge_1972"&&(e.datumCode="rnb72"),c.DATUM&&c.DATUM.SPHEROID&&(e.ellps=c.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),e.ellps.toLowerCase().slice(0,13)==="international"&&(e.ellps="intl"),e.a=c.DATUM.SPHEROID.a,e.rf=parseFloat(c.DATUM.SPHEROID.rf,10)),c.DATUM&&c.DATUM.TOWGS84&&(e.datum_params=c.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),e.datumCode==="ch1903+"&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a);function o(_){var x=e.to_meter||1;return _*x}var f=function(_){return xpe(e,_)},g=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Ql],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Ql],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Ql],["lat0","latitude_of_origin",Ql],["lat0","standard_parallel_1",Ql],["lat1","standard_parallel_1",Ql],["lat2","standard_parallel_2",Ql],["azimuth","Azimuth"],["alpha","azimuth",Ql],["srsCode","name"]];g.forEach(f),!e.long0&&e.longc&&(e.projName==="Albers_Conic_Equal_Area"||e.projName==="Lambert_Azimuthal_Equal_Area")&&(e.long0=e.longc),!e.lat_ts&&e.lat1&&(e.projName==="Stereographic_South_Pole"||e.projName==="Polar Stereographic (variant B)")?(e.lat0=Ql(e.lat1>0?90:-90),e.lat_ts=e.lat1):!e.lat_ts&&e.lat0&&e.projName==="Polar_Stereographic"&&(e.lat_ts=e.lat0,e.lat0=Ql(e.lat0>0?90:-90))}function Hj(e){var t=vpe(e),n=t[0],r={};return Nm(t,r),jj(r),r[n]}function vs(e){var t=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?vs[e]=VA(arguments[1]):vs[e]=Hj(arguments[1]):vs[e]=n}else if(arguments.length===1){if(Array.isArray(e))return e.map(function(r){Array.isArray(r)?vs.apply(t,r):vs(r)});if(typeof e=="string"){if(e in vs)return vs[e]}else"EPSG"in e?vs["EPSG:"+e.EPSG]=e:"ESRI"in e?vs["ESRI:"+e.ESRI]=e:"IAU2000"in e?vs["IAU2000:"+e.IAU2000]=e:console.log(e);return}}ape(vs);function wpe(e){return typeof e=="string"}function Spe(e){return e in vs}var Mpe=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Cpe(e){return Mpe.some(function(t){return e.indexOf(t)>-1})}var Epe=["3857","900913","3785","102113"];function Tpe(e){var t=Gh(e,"authority");if(t){var n=Gh(t,"epsg");return n&&Epe.indexOf(n)>-1}}function Ppe(e){var t=Gh(e,"extension");if(t)return Gh(t,"proj4")}function Ape(e){return e[0]==="+"}function Ipe(e){if(wpe(e)){if(Spe(e))return vs[e];if(Cpe(e)){var t=Hj(e);if(Tpe(t))return vs["EPSG:3857"];var n=Ppe(t);return n?VA(n):t}if(Ape(e))return VA(e)}else return e}function C4(e,t){e=e||{};var n,r;if(!t)return e;for(r in t)n=t[r],n!==void 0&&(e[r]=n);return e}function wc(e,t,n){var r=e*t;return n/Math.sqrt(1-r*r)}function ex(e){return e<0?-1:1}function Ln(e){return Math.abs(e)<=zi?e:e-ex(e)*d_}function Rl(e,t,n){var r=e*n,i=.5*e;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(on-t))/r}function p_(e,t){for(var n=.5*e,r,i,a=on-2*Math.atan(t),c=0;c<=15;c++)if(r=e*Math.sin(a),i=on-2*Math.atan(t*Math.pow((1-r)/(1+r),n))-a,a+=i,Math.abs(i)<=1e-10)return a;return-9999}function Rpe(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=wc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Lpe(e){var t=e.x,n=e.y;if(n*hc>90&&n*hc<-90&&t*hc>180&&t*hc<-180)return null;var r,i;if(Math.abs(Math.abs(n)-on)<=Pn)return null;if(this.sphere)r=this.x0+this.a*this.k0*Ln(t-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(Fr+.5*n));else{var a=Math.sin(n),c=Rl(this.e,n,a);r=this.x0+this.a*this.k0*Ln(t-this.long0),i=this.y0-this.a*this.k0*Math.log(c)}return e.x=r,e.y=i,e}function kpe(e){var t=e.x-this.x0,n=e.y-this.y0,r,i;if(this.sphere)i=on-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var a=Math.exp(-n/(this.a*this.k0));if(i=p_(this.e,a),i===-9999)return null}return r=Ln(this.long0+t/(this.a*this.k0)),e.x=r,e.y=i,e}var Dpe=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const zpe={init:Rpe,forward:Lpe,inverse:kpe,names:Dpe};function Ope(){}function E4(e){return e}var Fpe=["longlat","identity"];const Npe={init:Ope,forward:E4,inverse:E4,names:Fpe};var Bpe=[zpe,Npe],sw={},fS=[];function Gj(e,t){var n=fS.length;return e.names?(fS[n]=e,e.names.forEach(function(r){sw[r.toLowerCase()]=n}),this):(console.log(t),!0)}function Upe(e){if(!e)return!1;var t=e.toLowerCase();if(typeof sw[t]<"u"&&fS[sw[t]])return fS[sw[t]]}function $pe(){Bpe.forEach(Gj)}const Vpe={start:$pe,add:Gj,get:Upe};var Zn={};Zn.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};Zn.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};Zn.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};Zn.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};Zn.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};Zn.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};Zn.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};Zn.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};Zn.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};Zn.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};Zn.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};Zn.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};Zn.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};Zn.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};Zn.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};Zn.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};Zn.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};Zn.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};Zn.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};Zn.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};Zn.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};Zn.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};Zn.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};Zn.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};Zn.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};Zn.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};Zn.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};Zn.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};Zn.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};Zn.hough={a:6378270,rf:297,ellipseName:"Hough"};Zn.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};Zn.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};Zn.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};Zn.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};Zn.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};Zn.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};Zn.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};Zn.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};Zn.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};Zn.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};Zn.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};Zn.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var jpe=Zn.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Zn.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function Hpe(e,t,n,r){var i=e*e,a=t*t,c=(i-a)/i,o=0;r?(e*=1-c*(upe+c*(hpe+c*dpe)),i=e*e,c=0):o=Math.sqrt(c);var f=(i-a)/a;return{es:c,e:o,ep2:f}}function Gpe(e,t,n,r,i){if(!e){var a=Gh(Zn,r);a||(a=jpe),e=a.a,t=a.b,n=a.rf}return n&&!t&&(t=(1-1/n)*e),(n===0||Math.abs(e-t)<Pn)&&(i=!0,t=e),{a:e,b:t,rf:n,sphere:i}}var aw={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(var Wpe in aw){var T4=aw[Wpe];aw[T4.datumName]=T4}function qpe(e,t,n,r,i,a,c){var o={};return e===void 0||e==="none"?o.datum_type=$A:o.datum_type=lpe,t&&(o.datum_params=t.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=Bf),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=Uf,o.datum_params[3]*=yy,o.datum_params[4]*=yy,o.datum_params[5]*=yy,o.datum_params[6]=o.datum_params[6]/1e6+1)),c&&(o.datum_type=sg,o.grids=c),o.a=n,o.b=r,o.es=i,o.ep2=a,o}var Wj={};function Xpe(e,t){var n=new DataView(t),r=Kpe(n),i=Jpe(n,r),a=Qpe(n,i,r),c={header:i,subgrids:a};return Wj[e]=c,c}function Zpe(e){if(e===void 0)return null;var t=e.split(",");return t.map(Ype)}function Ype(e){if(e.length===0)return null;var t=e[0]==="@";return t&&(e=e.slice(1)),e==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:e,mandatory:!t,grid:Wj[e]||null,isNull:!1}}function Bm(e){return e/3600*Math.PI/180}function Kpe(e){var t=e.getInt32(8,!1);return t===11?!1:(t=e.getInt32(8,!0),t!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function Jpe(e,t){return{nFields:e.getInt32(8,t),nSubgridFields:e.getInt32(24,t),nSubgrids:e.getInt32(40,t),shiftType:jA(e,56,64).trim(),fromSemiMajorAxis:e.getFloat64(120,t),fromSemiMinorAxis:e.getFloat64(136,t),toSemiMajorAxis:e.getFloat64(152,t),toSemiMinorAxis:e.getFloat64(168,t)}}function jA(e,t,n){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(t,n)))}function Qpe(e,t,n){for(var r=176,i=[],a=0;a<t.nSubgrids;a++){var c=tme(e,r,n),o=nme(e,r,c,n),f=Math.round(1+(c.upperLongitude-c.lowerLongitude)/c.longitudeInterval),g=Math.round(1+(c.upperLatitude-c.lowerLatitude)/c.latitudeInterval);i.push({ll:[Bm(c.lowerLongitude),Bm(c.lowerLatitude)],del:[Bm(c.longitudeInterval),Bm(c.latitudeInterval)],lim:[f,g],count:c.gridNodeCount,cvs:eme(o)}),r+=176+c.gridNodeCount*16}return i}function eme(e){return e.map(function(t){return[Bm(t.longitudeShift),Bm(t.latitudeShift)]})}function tme(e,t,n){return{name:jA(e,t+8,t+16).trim(),parent:jA(e,t+24,t+24+8).trim(),lowerLatitude:e.getFloat64(t+72,n),upperLatitude:e.getFloat64(t+88,n),lowerLongitude:e.getFloat64(t+104,n),upperLongitude:e.getFloat64(t+120,n),latitudeInterval:e.getFloat64(t+136,n),longitudeInterval:e.getFloat64(t+152,n),gridNodeCount:e.getInt32(t+168,n)}}function nme(e,t,n,r){for(var i=t+176,a=16,c=[],o=0;o<n.gridNodeCount;o++){var f={latitudeShift:e.getFloat32(i+o*a,r),longitudeShift:e.getFloat32(i+o*a+4,r),latitudeAccuracy:e.getFloat32(i+o*a+8,r),longitudeAccuracy:e.getFloat32(i+o*a+12,r)};c.push(f)}return c}function _c(e,t){if(!(this instanceof _c))return new _c(e);t=t||function(g){if(g)throw g};var n=Ipe(e);if(typeof n!="object"){t("Could not parse to valid json: "+e);return}var r=_c.projections.get(n.projName);if(!r){t("Could not get projection name from: "+e);return}if(n.datumCode&&n.datumCode!=="none"){var i=Gh(aw,n.datumCode);i&&(n.datum_params=n.datum_params||(i.towgs84?i.towgs84.split(","):null),n.ellps=i.ellipse,n.datumName=i.datumName?i.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var a=Gpe(n.a,n.b,n.rf,n.ellps,n.sphere),c=Hpe(a.a,a.b,a.rf,n.R_A),o=Zpe(n.nadgrids),f=n.datum||qpe(n.datumCode,n.datum_params,a.a,a.b,c.es,c.ep2,o);C4(this,n),C4(this,r),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=c.es,this.e=c.e,this.ep2=c.ep2,this.datum=f,this.init(),t(null,this)}_c.projections=Vpe;_c.projections.start();function rme(e,t){return e.datum_type!==t.datum_type||e.a!==t.a||Math.abs(e.es-t.es)>5e-11?!1:e.datum_type===Bf?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:e.datum_type===Uf?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6]:!0}function qj(e,t,n){var r=e.x,i=e.y,a=e.z?e.z:0,c,o,f,g;if(i<-on&&i>-1.001*on)i=-on;else if(i>on&&i<1.001*on)i=on;else{if(i<-on)return{x:-1/0,y:-1/0,z:e.z};if(i>on)return{x:1/0,y:1/0,z:e.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),g=Math.cos(i),f=o*o,c=n/Math.sqrt(1-t*f),{x:(c+a)*g*Math.cos(r),y:(c+a)*g*Math.sin(r),z:(c*(1-t)+a)*o}}function Xj(e,t,n,r){var i=1e-12,a=i*i,c=30,o,f,g,_,x,M,C,A,L,I,T,z,k,U=e.x,H=e.y,V=e.z?e.z:0,q,J,Y;if(o=Math.sqrt(U*U+H*H),f=Math.sqrt(U*U+H*H+V*V),o/n<i){if(q=0,f/n<i)return J=on,Y=-r,{x:e.x,y:e.y,z:e.z}}else q=Math.atan2(H,U);g=V/f,_=o/f,x=1/Math.sqrt(1-t*(2-t)*_*_),A=_*(1-t)*x,L=g*x,k=0;do k++,C=n/Math.sqrt(1-t*L*L),Y=o*A+V*L-C*(1-t*L*L),M=t*C/(C+Y),x=1/Math.sqrt(1-M*(2-M)*_*_),I=_*(1-M)*x,T=g*x,z=T*A-I*L,A=I,L=T;while(z*z>a&&k<c);return J=Math.atan(T/Math.abs(I)),{x:q,y:J,z:Y}}function ime(e,t,n){if(t===Bf)return{x:e.x+n[0],y:e.y+n[1],z:e.z+n[2]};if(t===Uf){var r=n[0],i=n[1],a=n[2],c=n[3],o=n[4],f=n[5],g=n[6];return{x:g*(e.x-f*e.y+o*e.z)+r,y:g*(f*e.x+e.y-c*e.z)+i,z:g*(-o*e.x+c*e.y+e.z)+a}}}function ome(e,t,n){if(t===Bf)return{x:e.x-n[0],y:e.y-n[1],z:e.z-n[2]};if(t===Uf){var r=n[0],i=n[1],a=n[2],c=n[3],o=n[4],f=n[5],g=n[6],_=(e.x-r)/g,x=(e.y-i)/g,M=(e.z-a)/g;return{x:_+f*x-o*M,y:-f*_+x+c*M,z:o*_-c*x+M}}}function J1(e){return e===Bf||e===Uf}function sme(e,t,n){if(rme(e,t)||e.datum_type===$A||t.datum_type===$A)return n;var r=e.a,i=e.es;if(e.datum_type===sg){var a=P4(e,!1,n);if(a!==0)return;r=w4,i=S4}var c=t.a,o=t.b,f=t.es;if(t.datum_type===sg&&(c=w4,o=cpe,f=S4),i===f&&r===c&&!J1(e.datum_type)&&!J1(t.datum_type))return n;if(n=qj(n,i,r),J1(e.datum_type)&&(n=ime(n,e.datum_type,e.datum_params)),J1(t.datum_type)&&(n=ome(n,t.datum_type,t.datum_params)),n=Xj(n,f,c,o),t.datum_type===sg){var g=P4(t,!0,n);if(g!==0)return}return n}function P4(e,t,n){if(e.grids===null||e.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},i={x:Number.NaN,y:Number.NaN},a=[];e:for(var c=0;c<e.grids.length;c++){var o=e.grids[c];if(a.push(o.name),o.isNull){i=r;break}if(o.mandatory,o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var f=o.grid.subgrids,g=0,_=f.length;g<_;g++){var x=f[g],M=(Math.abs(x.del[1])+Math.abs(x.del[0]))/1e4,C=x.ll[0]-M,A=x.ll[1]-M,L=x.ll[0]+(x.lim[0]-1)*x.del[0]+M,I=x.ll[1]+(x.lim[1]-1)*x.del[1]+M;if(!(A>r.y||C>r.x||I<r.y||L<r.x)&&(i=ame(r,t,x),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*hc+" "+r.y*hc+" tried: '"+a+"'"),-1):(n.x=-i.x,n.y=i.y,0)}function ame(e,t,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return r;var i={x:e.x,y:e.y};i.x-=n.ll[0],i.y-=n.ll[1],i.x=Ln(i.x-Math.PI)+Math.PI;var a=A4(i,n);if(t){if(isNaN(a.x))return r;a.x=i.x-a.x,a.y=i.y-a.y;var c=9,o=1e-12,f,g;do{if(g=A4(a,n),isNaN(g.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}f={x:i.x-(g.x+a.x),y:i.y-(g.y+a.y)},a.x+=f.x,a.y+=f.y}while(c--&&Math.abs(f.x)>o&&Math.abs(f.y)>o);if(c<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=Ln(a.x+n.ll[0]),r.y=a.y+n.ll[1]}else isNaN(a.x)||(r.x=e.x+a.x,r.y=e.y+a.y);return r}function A4(e,t){var n={x:e.x/t.del[0],y:e.y/t.del[1]},r={x:Math.floor(n.x),y:Math.floor(n.y)},i={x:n.x-1*r.x,y:n.y-1*r.y},a={x:Number.NaN,y:Number.NaN},c;if(r.x<0||r.x>=t.lim[0]||r.y<0||r.y>=t.lim[1])return a;c=r.y*t.lim[0]+r.x;var o={x:t.cvs[c][0],y:t.cvs[c][1]};c++;var f={x:t.cvs[c][0],y:t.cvs[c][1]};c+=t.lim[0];var g={x:t.cvs[c][0],y:t.cvs[c][1]};c--;var _={x:t.cvs[c][0],y:t.cvs[c][1]},x=i.x*i.y,M=i.x*(1-i.y),C=(1-i.x)*(1-i.y),A=(1-i.x)*i.y;return a.x=C*o.x+M*f.x+A*_.x+x*g.x,a.y=C*o.y+M*f.y+A*_.y+x*g.y,a}function I4(e,t,n){var r=n.x,i=n.y,a=n.z||0,c,o,f,g={};for(f=0;f<3;f++)if(!(t&&f===2&&n.z===void 0))switch(f===0?(c=r,"ew".indexOf(e.axis[f])!==-1?o="x":o="y"):f===1?(c=i,"ns".indexOf(e.axis[f])!==-1?o="y":o="x"):(c=a,o="z"),e.axis[f]){case"e":g[o]=c;break;case"w":g[o]=-c;break;case"n":g[o]=c;break;case"s":g[o]=-c;break;case"u":n[o]!==void 0&&(g.z=c);break;case"d":n[o]!==void 0&&(g.z=-c);break;default:return null}return g}function Zj(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}function lme(e){R4(e.x),R4(e.y)}function R4(e){if(typeof Number.isFinite=="function"){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if(typeof e!="number"||e!==e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function cme(e,t){return(e.datum.datum_type===Bf||e.datum.datum_type===Uf||e.datum.datum_type===sg)&&t.datumCode!=="WGS84"||(t.datum.datum_type===Bf||t.datum.datum_type===Uf||t.datum.datum_type===sg)&&e.datumCode!=="WGS84"}function pS(e,t,n,r){var i;Array.isArray(n)?n=Zj(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var a=n.z!==void 0;if(lme(n),e.datum&&t.datum&&cme(e,t)&&(i=new _c("WGS84"),n=pS(e,i,n,r),e=i),r&&e.axis!=="enu"&&(n=I4(e,!1,n)),e.projName==="longlat")n={x:n.x*No,y:n.y*No,z:n.z||0};else if(e.to_meter&&(n={x:n.x*e.to_meter,y:n.y*e.to_meter,z:n.z||0}),n=e.inverse(n),!n)return;if(e.from_greenwich&&(n.x+=e.from_greenwich),n=sme(e.datum,t.datum,n),!!n)return t.from_greenwich&&(n={x:n.x-t.from_greenwich,y:n.y,z:n.z||0}),t.projName==="longlat"?n={x:n.x*hc,y:n.y*hc,z:n.z||0}:(n=t.forward(n),t.to_meter&&(n={x:n.x/t.to_meter,y:n.y/t.to_meter,z:n.z||0})),r&&t.axis!=="enu"?I4(t,!0,n):(n&&!a&&delete n.z,n)}var L4=_c("WGS84");function NE(e,t,n,r){var i,a,c;return Array.isArray(n)?(i=pS(e,t,n,r)||{x:NaN,y:NaN},n.length>2?typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(n.slice(3)):[i.x,i.y,n[2]].concat(n.slice(3)):[i.x,i.y].concat(n.slice(2)):[i.x,i.y]):(a=pS(e,t,n,r),c=Object.keys(n),c.length===2||c.forEach(function(o){if(typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;a[o]=n[o]}),a)}function k4(e){return e instanceof _c?e:e.oProj?e.oProj:_c(e)}function Xs(e,t,n){e=k4(e);var r=!1,i;return typeof t>"u"?(t=e,e=L4,r=!0):(typeof t.x<"u"||Array.isArray(t))&&(n=t,t=e,e=L4,r=!0),t=k4(t),n?NE(e,t,n):(i={forward:function(a,c){return NE(e,t,a,c)},inverse:function(a,c){return NE(t,e,a,c)}},r&&(i.oProj=t),i)}var D4=6,Yj="AJSAJS",Kj="AFAFAF",Um=65,ks=73,Na=79,Z0=86,Y0=90;const ume={forward:Jj,inverse:hme,toPoint:Qj};function Jj(e,t){return t=t||5,pme(dme({lat:e[1],lon:e[0]}),t)}function hme(e){var t=yL(t9(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]}function Qj(e){var t=yL(t9(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function BE(e){return e*(Math.PI/180)}function z4(e){return 180*(e/Math.PI)}function dme(e){var t=e.lat,n=e.lon,r=6378137,i=.00669438,a=.9996,c,o,f,g,_,x,M,C=BE(t),A=BE(n),L,I;I=Math.floor((n+180)/6)+1,n===180&&(I=60),t>=56&&t<64&&n>=3&&n<12&&(I=32),t>=72&&t<84&&(n>=0&&n<9?I=31:n>=9&&n<21?I=33:n>=21&&n<33?I=35:n>=33&&n<42&&(I=37)),c=(I-1)*6-180+3,L=BE(c),o=i/(1-i),f=r/Math.sqrt(1-i*Math.sin(C)*Math.sin(C)),g=Math.tan(C)*Math.tan(C),_=o*Math.cos(C)*Math.cos(C),x=Math.cos(C)*(A-L),M=r*((1-i/4-3*i*i/64-5*i*i*i/256)*C-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*C)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*C)-35*i*i*i/3072*Math.sin(6*C));var T=a*f*(x+(1-g+_)*x*x*x/6+(5-18*g+g*g+72*_-58*o)*x*x*x*x*x/120)+5e5,z=a*(M+f*Math.tan(C)*(x*x/2+(5-g+9*_+4*_*_)*x*x*x*x/24+(61-58*g+g*g+600*_-330*o)*x*x*x*x*x*x/720));return t<0&&(z+=1e7),{northing:Math.round(z),easting:Math.round(T),zoneNumber:I,zoneLetter:fme(t)}}function yL(e){var t=e.northing,n=e.easting,r=e.zoneLetter,i=e.zoneNumber;if(i<0||i>60)return null;var a=.9996,c=6378137,o=.00669438,f,g=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),_,x,M,C,A,L,I,T,z,k=n-5e5,U=t;r<"N"&&(U-=1e7),I=(i-1)*6-180+3,f=o/(1-o),L=U/a,T=L/(c*(1-o/4-3*o*o/64-5*o*o*o/256)),z=T+(3*g/2-27*g*g*g/32)*Math.sin(2*T)+(21*g*g/16-55*g*g*g*g/32)*Math.sin(4*T)+151*g*g*g/96*Math.sin(6*T),_=c/Math.sqrt(1-o*Math.sin(z)*Math.sin(z)),x=Math.tan(z)*Math.tan(z),M=f*Math.cos(z)*Math.cos(z),C=c*(1-o)/Math.pow(1-o*Math.sin(z)*Math.sin(z),1.5),A=k/(_*a);var H=z-_*Math.tan(z)/C*(A*A/2-(5+3*x+10*M-4*M*M-9*f)*A*A*A*A/24+(61+90*x+298*M+45*x*x-252*f-3*M*M)*A*A*A*A*A*A/720);H=z4(H);var V=(A-(1+2*x+M)*A*A*A/6+(5-2*M+28*x-3*M*M+8*f+24*x*x)*A*A*A*A*A/120)/Math.cos(z);V=I+z4(V);var q;if(e.accuracy){var J=yL({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});q={top:J.lat,right:J.lon,bottom:H,left:V}}else q={lat:H,lon:V};return q}function fme(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function pme(e,t){var n="00000"+e.easting,r="00000"+e.northing;return e.zoneNumber+e.zoneLetter+mme(e.easting,e.northing,e.zoneNumber)+n.substr(n.length-5,t)+r.substr(r.length-5,t)}function mme(e,t,n){var r=e9(n),i=Math.floor(e/1e5),a=Math.floor(t/1e5)%20;return gme(i,a,r)}function e9(e){var t=e%D4;return t===0&&(t=D4),t}function gme(e,t,n){var r=n-1,i=Yj.charCodeAt(r),a=Kj.charCodeAt(r),c=i+e-1,o=a+t,f=!1;c>Y0&&(c=c-Y0+Um-1,f=!0),(c===ks||i<ks&&c>ks||(c>ks||i<ks)&&f)&&c++,(c===Na||i<Na&&c>Na||(c>Na||i<Na)&&f)&&(c++,c===ks&&c++),c>Y0&&(c=c-Y0+Um-1),o>Z0?(o=o-Z0+Um-1,f=!0):f=!1,(o===ks||a<ks&&o>ks||(o>ks||a<ks)&&f)&&o++,(o===Na||a<Na&&o>Na||(o>Na||a<Na)&&f)&&(o++,o===ks&&o++),o>Z0&&(o=o-Z0+Um-1);var g=String.fromCharCode(c)+String.fromCharCode(o);return g}function t9(e){if(e&&e.length===0)throw"MGRSPoint coverting from nothing";for(var t=e.length,n=null,r="",i,a=0;!/[A-Z]/.test(i=e.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+e;r+=i,a++}var c=parseInt(r,10);if(a===0||a+3>t)throw"MGRSPoint bad conversion from: "+e;var o=e.charAt(a++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+e;n=e.substring(a,a+=2);for(var f=e9(c),g=vme(n.charAt(0),f),_=yme(n.charAt(1),f);_<_me(o);)_+=2e6;var x=t-a;if(x%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+e;var M=x/2,C=0,A=0,L,I,T,z,k;return M>0&&(L=1e5/Math.pow(10,M),I=e.substring(a,a+M),C=parseFloat(I)*L,T=e.substring(a+M),A=parseFloat(T)*L),z=C+g,k=A+_,{easting:z,northing:k,zoneLetter:o,zoneNumber:c,accuracy:L}}function vme(e,t){for(var n=Yj.charCodeAt(t-1),r=1e5,i=!1;n!==e.charCodeAt(0);){if(n++,n===ks&&n++,n===Na&&n++,n>Y0){if(i)throw"Bad character: "+e;n=Um,i=!0}r+=1e5}return r}function yme(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var n=Kj.charCodeAt(t-1),r=0,i=!1;n!==e.charCodeAt(0);){if(n++,n===ks&&n++,n===Na&&n++,n>Z0){if(i)throw"Bad character: "+e;n=Um,i=!0}r+=1e5}return r}function _me(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}function Ig(e,t,n){if(!(this instanceof Ig))return new Ig(e,t,n);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if(typeof e=="object")this.x=e.x,this.y=e.y,this.z=e.z||0;else if(typeof e=="string"&&typeof t>"u"){var r=e.split(",");this.x=parseFloat(r[0],10),this.y=parseFloat(r[1],10),this.z=parseFloat(r[2],10)||0}else this.x=e,this.y=t,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Ig.fromMGRS=function(e){return new Ig(Qj(e))};Ig.prototype.toMGRS=function(e){return Jj([this.x,this.y],e)};var xme=1,bme=.25,O4=.046875,F4=.01953125,N4=.01068115234375,wme=.75,Sme=.46875,Mme=.013020833333333334,Cme=.007120768229166667,Eme=.3645833333333333,Tme=.005696614583333333,Pme=.3076171875;function _L(e){var t=[];t[0]=xme-e*(bme+e*(O4+e*(F4+e*N4))),t[1]=e*(wme-e*(O4+e*(F4+e*N4)));var n=e*e;return t[2]=n*(Sme-e*(Mme+e*Cme)),n*=e,t[3]=n*(Eme-e*Tme),t[4]=n*e*Pme,t}function Gg(e,t,n,r){return n*=t,t*=t,r[0]*e-n*(r[1]+t*(r[2]+t*(r[3]+t*r[4])))}var Ame=20;function xL(e,t,n){for(var r=1/(1-t),i=e,a=Ame;a;--a){var c=Math.sin(i),o=1-t*c*c;if(o=(Gg(i,c,Math.cos(i),n)-e)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<Pn)return i}return i}function Ime(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=_L(this.es),this.ml0=Gg(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Rme(e){var t=e.x,n=e.y,r=Ln(t-this.long0),i,a,c,o=Math.sin(n),f=Math.cos(n);if(this.es){var _=f*r,x=Math.pow(_,2),M=this.ep2*Math.pow(f,2),C=Math.pow(M,2),A=Math.abs(f)>Pn?Math.tan(n):0,L=Math.pow(A,2),I=Math.pow(L,2);i=1-this.es*Math.pow(o,2),_=_/Math.sqrt(i);var T=Gg(n,o,f,this.en);a=this.a*(this.k0*_*(1+x/6*(1-L+M+x/20*(5-18*L+I+14*M-58*L*M+x/42*(61+179*I-I*L-479*L)))))+this.x0,c=this.a*(this.k0*(T-this.ml0+o*r*_/2*(1+x/12*(5-L+9*M+4*C+x/30*(61+I-58*L+270*M-330*L*M+x/56*(1385+543*I-I*L-3111*L))))))+this.y0}else{var g=f*Math.sin(r);if(Math.abs(Math.abs(g)-1)<Pn)return 93;if(a=.5*this.a*this.k0*Math.log((1+g)/(1-g))+this.x0,c=f*Math.cos(r)/Math.sqrt(1-Math.pow(g,2)),g=Math.abs(c),g>=1){if(g-1>Pn)return 93;c=0}else c=Math.acos(c);n<0&&(c=-c),c=this.a*this.k0*(c-this.lat0)+this.y0}return e.x=a,e.y=c,e}function Lme(e){var t,n,r,i,a=(e.x-this.x0)*(1/this.a),c=(e.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+c/this.k0,n=xL(t,this.es,this.en),Math.abs(n)<on){var x=Math.sin(n),M=Math.cos(n),C=Math.abs(M)>Pn?Math.tan(n):0,A=this.ep2*Math.pow(M,2),L=Math.pow(A,2),I=Math.pow(C,2),T=Math.pow(I,2);t=1-this.es*Math.pow(x,2);var z=a*Math.sqrt(t)/this.k0,k=Math.pow(z,2);t=t*C,r=n-t*k/(1-this.es)*.5*(1-k/12*(5+3*I-9*A*I+A-4*L-k/30*(61+90*I-252*A*I+45*T+46*A-k/56*(1385+3633*I+4095*T+1574*T*I)))),i=Ln(this.long0+z*(1-k/6*(1+2*I+A-k/20*(5+28*I+24*T+8*A*I+6*A-k/42*(61+662*I+1320*T+720*T*I))))/M)}else r=on*ex(c),i=0;else{var o=Math.exp(a/this.k0),f=.5*(o-1/o),g=this.lat0+c/this.k0,_=Math.cos(g);t=Math.sqrt((1-Math.pow(_,2))/(1+Math.pow(f,2))),r=Math.asin(t),c<0&&(r=-r),f===0&&_===0?i=0:i=Ln(Math.atan2(f,_)+this.long0)}return e.x=i,e.y=r,e}var kme=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const lw={init:Ime,forward:Rme,inverse:Lme,names:kme};function n9(e){var t=Math.exp(e);return t=(t-1/t)/2,t}function Os(e,t){e=Math.abs(e),t=Math.abs(t);var n=Math.max(e,t),r=Math.min(e,t)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function Dme(e){var t=1+e,n=t-1;return n===0?e:e*Math.log(t)/n}function zme(e){var t=Math.abs(e);return t=Dme(t*(1+t/(Os(1,t)+1))),e<0?-t:t}function bL(e,t){for(var n=2*Math.cos(2*t),r=e.length-1,i=e[r],a=0,c;--r>=0;)c=-a+n*i+e[r],a=i,i=c;return t+c*Math.sin(2*t)}function Ome(e,t){for(var n=2*Math.cos(t),r=e.length-1,i=e[r],a=0,c;--r>=0;)c=-a+n*i+e[r],a=i,i=c;return Math.sin(t)*c}function Fme(e){var t=Math.exp(e);return t=(t+1/t)/2,t}function r9(e,t,n){for(var r=Math.sin(t),i=Math.cos(t),a=n9(n),c=Fme(n),o=2*i*c,f=-2*r*a,g=e.length-1,_=e[g],x=0,M=0,C=0,A,L;--g>=0;)A=M,L=x,M=_,x=C,_=-A+o*M-f*x+e[g],C=-L+f*M+o*x;return o=r*c,f=i*a,[o*_-f*C,o*C+f*_]}function Nme(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(lw.init.apply(this),this.forward=lw.forward,this.inverse=lw.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),n=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),n=n*t,this.cgb[1]=n*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=n*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),n=n*t,this.cgb[2]=n*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=n*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),n=n*t,this.cgb[3]=n*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=n*(1237/630+t*(-12/5+t*(-24832/14175))),n=n*t,this.cgb[4]=n*(4174/315+t*(-144838/6237)),this.cbg[4]=n*(-734/315+t*(109598/31185)),n=n*t,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=n*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=n*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),n=n*t,this.utg[2]=n*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=n*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),n=n*t,this.utg[3]=n*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=n*(49561/161280+t*(-179/168+t*(6601661/7257600))),n=n*t,this.utg[4]=n*(-4583/161280+t*(108847/3991680)),this.gtu[4]=n*(34729/80640+t*(-3418889/1995840)),n=n*t,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var r=bL(this.cbg,this.lat0);this.Zb=-this.Qn*(r+Ome(this.gtu,2*r))}function Bme(e){var t=Ln(e.x-this.long0),n=e.y;n=bL(this.cbg,n);var r=Math.sin(n),i=Math.cos(n),a=Math.sin(t),c=Math.cos(t);n=Math.atan2(r,c*i),t=Math.atan2(a*i,Os(r,i*c)),t=zme(Math.tan(t));var o=r9(this.gtu,2*n,2*t);n=n+o[0],t=t+o[1];var f,g;return Math.abs(t)<=2.623395162778?(f=this.a*(this.Qn*t)+this.x0,g=this.a*(this.Qn*n+this.Zb)+this.y0):(f=1/0,g=1/0),e.x=f,e.y=g,e}function Ume(e){var t=(e.x-this.x0)*(1/this.a),n=(e.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,t=t/this.Qn;var r,i;if(Math.abs(t)<=2.623395162778){var a=r9(this.utg,2*n,2*t);n=n+a[0],t=t+a[1],t=Math.atan(n9(t));var c=Math.sin(n),o=Math.cos(n),f=Math.sin(t),g=Math.cos(t);n=Math.atan2(c*g,Os(f,g*o)),t=Math.atan2(f,g*o),r=Ln(t+this.long0),i=bL(this.cgb,n)}else r=1/0,i=1/0;return e.x=r,e.y=i,e}var $me=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const cw={init:Nme,forward:Bme,inverse:Ume,names:$me};function Vme(e,t){if(e===void 0){if(e=Math.floor((Ln(t)+Math.PI)*30/Math.PI)+1,e<0)return 0;if(e>60)return 60}return e}var jme="etmerc";function Hme(){var e=Vme(this.zone,this.long0);if(e===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*No,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,cw.init.apply(this),this.forward=cw.forward,this.inverse=cw.inverse}var Gme=["Universal Transverse Mercator System","utm"];const Wme={init:Hme,names:Gme,dependsOn:jme};function wL(e,t){return Math.pow((1-e)/(1+e),t)}var qme=20;function Xme(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Fr)/(Math.pow(Math.tan(.5*this.lat0+Fr),this.C)*wL(this.e*e,this.ratexp))}function Zme(e){var t=e.x,n=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+Fr),this.C)*wL(this.e*Math.sin(n),this.ratexp))-on,e.x=this.C*t,e}function Yme(e){for(var t=1e-14,n=e.x/this.C,r=e.y,i=Math.pow(Math.tan(.5*r+Fr)/this.K,1/this.C),a=qme;a>0&&(r=2*Math.atan(i*wL(this.e*Math.sin(e.y),-.5*this.e))-on,!(Math.abs(r-e.y)<t));--a)e.y=r;return a?(e.x=n,e.y=r,e):null}var Kme=["gauss"];const SL={init:Xme,forward:Zme,inverse:Yme,names:Kme};function Jme(){SL.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Qme(e){var t,n,r,i;return e.x=Ln(e.x-this.long0),SL.forward.apply(this,[e]),t=Math.sin(e.y),n=Math.cos(e.y),r=Math.cos(e.x),i=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*n*r),e.x=i*n*Math.sin(e.x),e.y=i*(this.cosc0*t-this.sinc0*n*r),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function ege(e){var t,n,r,i,a;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,a=Os(e.x,e.y)){var c=2*Math.atan2(a,this.R2);t=Math.sin(c),n=Math.cos(c),i=Math.asin(n*this.sinc0+e.y*t*this.cosc0/a),r=Math.atan2(e.x*t,a*this.cosc0*n-e.y*this.sinc0*t)}else i=this.phic0,r=0;return e.x=r,e.y=i,SL.inverse.apply(this,[e]),e.x=Ln(e.x+this.long0),e}var tge=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const nge={init:Jme,forward:Qme,inverse:ege,names:tge};function rge(e,t,n){return t*=n,Math.tan(.5*(on+e))*Math.pow((1-t)/(1+t),.5*n)}function ige(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Pn&&(this.k0=.5*(1+ex(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Pn&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Pn&&Math.abs(Math.cos(this.lat_ts))>Pn&&(this.k0=.5*this.cons*wc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Rl(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=wc(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-on,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function oge(e){var t=e.x,n=e.y,r=Math.sin(n),i=Math.cos(n),a,c,o,f,g,_,x=Ln(t-this.long0);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=Pn&&Math.abs(n+this.lat0)<=Pn?(e.x=NaN,e.y=NaN,e):this.sphere?(a=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(x)),e.x=this.a*a*i*Math.sin(x)+this.x0,e.y=this.a*a*(this.coslat0*r-this.sinlat0*i*Math.cos(x))+this.y0,e):(c=2*Math.atan(this.ssfn_(n,r,this.e))-on,f=Math.cos(c),o=Math.sin(c),Math.abs(this.coslat0)<=Pn?(g=Rl(this.e,n*this.con,this.con*r),_=2*this.a*this.k0*g/this.cons,e.x=this.x0+_*Math.sin(t-this.long0),e.y=this.y0-this.con*_*Math.cos(t-this.long0),e):(Math.abs(this.sinlat0)<Pn?(a=2*this.a*this.k0/(1+f*Math.cos(x)),e.y=a*o):(a=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*f*Math.cos(x))),e.y=a*(this.cosX0*o-this.sinX0*f*Math.cos(x))+this.y0),e.x=a*f*Math.sin(x)+this.x0,e))}function sge(e){e.x-=this.x0,e.y-=this.y0;var t,n,r,i,a,c=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var o=2*Math.atan(c/(2*this.a*this.k0));return t=this.long0,n=this.lat0,c<=Pn?(e.x=t,e.y=n,e):(n=Math.asin(Math.cos(o)*this.sinlat0+e.y*Math.sin(o)*this.coslat0/c),Math.abs(this.coslat0)<Pn?this.lat0>0?t=Ln(this.long0+Math.atan2(e.x,-1*e.y)):t=Ln(this.long0+Math.atan2(e.x,e.y)):t=Ln(this.long0+Math.atan2(e.x*Math.sin(o),c*this.coslat0*Math.cos(o)-e.y*this.sinlat0*Math.sin(o))),e.x=t,e.y=n,e)}else if(Math.abs(this.coslat0)<=Pn){if(c<=Pn)return n=this.lat0,t=this.long0,e.x=t,e.y=n,e;e.x*=this.con,e.y*=this.con,r=c*this.cons/(2*this.a*this.k0),n=this.con*p_(this.e,r),t=this.con*Ln(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else i=2*Math.atan(c*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,c<=Pn?a=this.X0:(a=Math.asin(Math.cos(i)*this.sinX0+e.y*Math.sin(i)*this.cosX0/c),t=Ln(this.long0+Math.atan2(e.x*Math.sin(i),c*this.cosX0*Math.cos(i)-e.y*this.sinX0*Math.sin(i)))),n=-1*p_(this.e,Math.tan(.5*(on+a)));return e.x=t,e.y=n,e}var age=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"];const lge={init:ige,forward:oge,inverse:sge,names:age,ssfn_:rge};function cge(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),n=this.a,r=this.rf,i=1/r,a=2*i-Math.pow(i,2),c=this.e=Math.sqrt(a);this.R=this.k0*n*Math.sqrt(1-a)/(1-a*Math.pow(t,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),f=Math.log(Math.tan(Math.PI/4+e/2)),g=Math.log((1+c*t)/(1-c*t));this.K=o-this.alpha*f+this.alpha*c/2*g}function uge(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),r=-this.alpha*(t+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),a=this.alpha*(e.x-this.lambda0),c=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(a))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(a));return e.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,e.x=this.R*c+this.x0,e}function hge(e){for(var t=e.x-this.x0,n=e.y-this.y0,r=t/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),c=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+c/this.alpha,f=0,g=a,_=-1e3,x=0;Math.abs(g-_)>1e-7;){if(++x>20)return;f=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(g))/2)),_=g,g=2*Math.atan(Math.exp(f))-Math.PI/2}return e.x=o,e.y=g,e}var dge=["somerc"];const fge={init:cge,forward:uge,inverse:hge,names:dge};var _m=1e-7;function pge(e){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof e.PROJECTION=="object"?Object.keys(e.PROJECTION)[0]:e.PROJECTION;return"no_uoff"in e||"no_off"in e||t.indexOf(n)!==-1}function mge(){var e,t,n,r,i,a,c,o,f,g,_=0,x,M=0,C=0,A=0,L=0,I=0,T=0;this.no_off=pge(this),this.no_rot="no_rot"in this;var z=!1;"alpha"in this&&(z=!0);var k=!1;if("rectified_grid_angle"in this&&(k=!0),z&&(T=this.alpha),k&&(_=this.rectified_grid_angle*No),z||k)M=this.longc;else if(C=this.long1,L=this.lat1,A=this.long2,I=this.lat2,Math.abs(L-I)<=_m||(e=Math.abs(L))<=_m||Math.abs(e-on)<=_m||Math.abs(Math.abs(this.lat0)-on)<=_m||Math.abs(Math.abs(I)-on)<=_m)throw new Error;var U=1-this.es;t=Math.sqrt(U),Math.abs(this.lat0)>Pn?(o=Math.sin(this.lat0),n=Math.cos(this.lat0),e=1-this.es*o*o,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/U),this.A=this.B*this.k0*t/e,r=this.B*t/(n*Math.sqrt(e)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(Rl(this.e,this.lat0,o),this.B)):(this.B=1/t,this.A=this.k0,this.E=r=i=1),z||k?(z?(x=Math.asin(Math.sin(T)/r),k||(_=T)):(x=_,T=Math.asin(r*Math.sin(x))),this.lam0=M-Math.asin(.5*(i-1/i)*Math.tan(x))/this.B):(a=Math.pow(Rl(this.e,L,Math.sin(L)),this.B),c=Math.pow(Rl(this.e,I,Math.sin(I)),this.B),i=this.E/a,f=(c-a)/(c+a),g=this.E*this.E,g=(g-c*a)/(g+c*a),e=C-A,e<-Math.pi?A-=d_:e>Math.pi&&(A+=d_),this.lam0=Ln(.5*(C+A)-Math.atan(g*Math.tan(.5*this.B*(C-A))/f)/this.B),x=Math.atan(2*Math.sin(this.B*Ln(C-this.lam0))/(i-1/i)),_=T=Math.asin(r*Math.sin(x))),this.singam=Math.sin(x),this.cosgam=Math.cos(x),this.sinrot=Math.sin(_),this.cosrot=Math.cos(_),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*x,this.v_pole_n=this.ArB*Math.log(Math.tan(Fr-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Fr+i))}function gge(e){var t={},n,r,i,a,c,o,f,g;if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-on)>Pn){if(c=this.E/Math.pow(Rl(this.e,e.y,Math.sin(e.y)),this.B),o=1/c,n=.5*(c-o),r=.5*(c+o),a=Math.sin(this.B*e.x),i=(n*this.singam-a*this.cosgam)/r,Math.abs(Math.abs(i)-1)<Pn)throw new Error;g=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*e.x),Math.abs(o)<_m?f=this.A*e.x:f=this.ArB*Math.atan2(n*this.cosgam+a*this.singam,o)}else g=e.y>0?this.v_pole_n:this.v_pole_s,f=this.ArB*e.y;return this.no_rot?(t.x=f,t.y=g):(f-=this.u_0,t.x=g*this.cosrot+f*this.sinrot,t.y=f*this.cosrot-g*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function vge(e){var t,n,r,i,a,c,o,f={};if(e.x=(e.x-this.x0)*(1/this.a),e.y=(e.y-this.y0)*(1/this.a),this.no_rot?(n=e.y,t=e.x):(n=e.x*this.cosrot-e.y*this.sinrot,t=e.y*this.cosrot+e.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*n),i=.5*(r-1/r),a=.5*(r+1/r),c=Math.sin(this.BrA*t),o=(c*this.cosgam+i*this.singam)/a,Math.abs(Math.abs(o)-1)<Pn)f.x=0,f.y=o<0?-on:on;else{if(f.y=this.E/Math.sqrt((1+o)/(1-o)),f.y=p_(this.e,Math.pow(f.y,1/this.B)),f.y===1/0)throw new Error;f.x=-this.rB*Math.atan2(i*this.cosgam-c*this.singam,Math.cos(this.BrA*t))}return f.x+=this.lam0,f}var yge=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const _ge={init:mge,forward:gge,inverse:vge,names:yge};function xge(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Pn)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),n=Math.cos(this.lat1),r=wc(this.e,t,n),i=Rl(this.e,this.lat1,t),a=Math.sin(this.lat2),c=Math.cos(this.lat2),o=wc(this.e,a,c),f=Rl(this.e,this.lat2,a),g=Rl(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Pn?this.ns=Math.log(r/o)/Math.log(i/f):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(g,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function bge(e){var t=e.x,n=e.y;Math.abs(2*Math.abs(n)-Math.PI)<=Pn&&(n=ex(n)*(on-2*Pn));var r=Math.abs(Math.abs(n)-on),i,a;if(r>Pn)i=Rl(this.e,n,Math.sin(n)),a=this.a*this.f0*Math.pow(i,this.ns);else{if(r=n*this.ns,r<=0)return null;a=0}var c=this.ns*Ln(t-this.long0);return e.x=this.k0*(a*Math.sin(c))+this.x0,e.y=this.k0*(this.rh-a*Math.cos(c))+this.y0,e}function wge(e){var t,n,r,i,a,c=(e.x-this.x0)/this.k0,o=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(c*c+o*o),n=1):(t=-Math.sqrt(c*c+o*o),n=-1);var f=0;if(t!==0&&(f=Math.atan2(n*c,n*o)),t!==0||this.ns>0){if(n=1/this.ns,r=Math.pow(t/(this.a*this.f0),n),i=p_(this.e,r),i===-9999)return null}else i=-on;return a=Ln(f/this.ns+this.long0),e.x=a,e.y=i,e}var Sge=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const Mge={init:xge,forward:bge,inverse:wge,names:Sge};function Cge(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Ege(e){var t,n,r,i,a,c,o,f=e.x,g=e.y,_=Ln(f-this.long0);return t=Math.pow((1+this.e*Math.sin(g))/(1-this.e*Math.sin(g)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(g/2+this.s45),this.alfa)/t)-this.s45),r=-_*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),a=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(i)),c=this.n*a,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),e.y=o*Math.cos(c)/1,e.x=o*Math.sin(c)/1,this.czech||(e.y*=-1,e.x*=-1),e}function Tge(e){var t,n,r,i,a,c,o,f,g=e.x;e.x=e.y,e.y=g,this.czech||(e.y*=-1,e.x*=-1),c=Math.sqrt(e.x*e.x+e.y*e.y),a=Math.atan2(e.y,e.x),i=a/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/c,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(t)),e.x=this.long0-n/this.alfa,o=t,f=0;var _=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-e.y)<1e-10&&(f=1),o=e.y,_+=1;while(f===0&&_<15);return _>=15?null:e}var Pge=["Krovak","krovak"];const Age={init:Cge,forward:Ege,inverse:Tge,names:Pge};function xs(e,t,n,r,i){return e*i-t*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)}function tx(e){return 1-.25*e*(1+e/16*(3+1.25*e))}function nx(e){return .375*e*(1+.25*e*(1+.46875*e))}function rx(e){return .05859375*e*e*(1+.75*e)}function ix(e){return e*e*e*(35/3072)}function Rg(e,t,n){var r=t*n;return e/Math.sqrt(1-r*r)}function sd(e){return Math.abs(e)<on?e:e-ex(e)*Math.PI}function mS(e,t,n,r,i){var a,c;a=e/t;for(var o=0;o<15;o++)if(c=(e-(t*a-n*Math.sin(2*a)+r*Math.sin(4*a)-i*Math.sin(6*a)))/(t-2*n*Math.cos(2*a)+4*r*Math.cos(4*a)-6*i*Math.cos(6*a)),a+=c,Math.abs(c)<=1e-10)return a;return NaN}function Ige(){this.sphere||(this.e0=tx(this.es),this.e1=nx(this.es),this.e2=rx(this.es),this.e3=ix(this.es),this.ml0=this.a*xs(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Rge(e){var t,n,r=e.x,i=e.y;if(r=Ln(r-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(i)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var a=Math.sin(i),c=Math.cos(i),o=Rg(this.a,this.e,a),f=Math.tan(i)*Math.tan(i),g=r*Math.cos(i),_=g*g,x=this.es*c*c/(1-this.es),M=this.a*xs(this.e0,this.e1,this.e2,this.e3,i);t=o*g*(1-_*f*(1/6-(8-f+8*x)*_/120)),n=M-this.ml0+o*a/c*_*(.5+(5-f+6*x)*_/24)}return e.x=t+this.x0,e.y=n+this.y0,e}function Lge(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,n=e.y/this.a,r,i;if(this.sphere){var a=n+this.lat0;r=Math.asin(Math.sin(a)*Math.cos(t)),i=Math.atan2(Math.tan(t),Math.cos(a))}else{var c=this.ml0/this.a+n,o=mS(c,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-on)<=Pn)return e.x=this.long0,e.y=on,n<0&&(e.y*=-1),e;var f=Rg(this.a,this.e,Math.sin(o)),g=f*f*f/this.a/this.a*(1-this.es),_=Math.pow(Math.tan(o),2),x=t*this.a/f,M=x*x;r=o-f*Math.tan(o)/g*x*x*(.5-(1+3*_)*x*x/24),i=x*(1-M*(_/3+(1+3*_)*_*M/15))/Math.cos(o)}return e.x=Ln(i+this.long0),e.y=sd(r),e}var kge=["Cassini","Cassini_Soldner","cass"];const Dge={init:Ige,forward:Rge,inverse:Lge,names:kge};function Lh(e,t){var n;return e>1e-7?(n=e*t,(1-e*e)*(t/(1-n*n)-.5/e*Math.log((1-n)/(1+n)))):2*t}var zge=1,Oge=2,Fge=3,Nge=4;function Bge(){var e=Math.abs(this.lat0);if(Math.abs(e-on)<Pn?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<Pn?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var t;switch(this.qp=Lh(this.e,1),this.mmf=.5/(1-this.es),this.apa=Xge(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Lh(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Uge(e){var t,n,r,i,a,c,o,f,g,_,x=e.x,M=e.y;if(x=Ln(x-this.long0),this.sphere){if(a=Math.sin(M),_=Math.cos(M),r=Math.cos(x),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+_*r:1+this.sinph0*a+this.cosph0*_*r,n<=Pn)return null;n=Math.sqrt(2/n),t=n*_*Math.sin(x),n*=this.mode===this.EQUIT?a:this.cosph0*a-this.sinph0*_*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(M+this.lat0)<Pn)return null;n=Fr-M*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),t=n*Math.sin(x),n*=r}}else{switch(o=0,f=0,g=0,r=Math.cos(x),i=Math.sin(x),a=Math.sin(M),c=Lh(this.e,a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=c/this.qp,f=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:g=1+this.sinb1*o+this.cosb1*f*r;break;case this.EQUIT:g=1+f*r;break;case this.N_POLE:g=on+M,c=this.qp-c;break;case this.S_POLE:g=M-on,c=this.qp+c;break}if(Math.abs(g)<Pn)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:g=Math.sqrt(2/g),this.mode===this.OBLIQ?n=this.ymf*g*(this.cosb1*o-this.sinb1*f*r):n=(g=Math.sqrt(2/(1+f*r)))*o*this.ymf,t=this.xmf*g*f*i;break;case this.N_POLE:case this.S_POLE:c>=0?(t=(g=Math.sqrt(c))*i,n=r*(this.mode===this.S_POLE?g:-g)):t=n=0;break}}return e.x=this.a*t+this.x0,e.y=this.a*n+this.y0,e}function $ge(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,n=e.y/this.a,r,i,a,c,o,f,g;if(this.sphere){var _=0,x,M=0;if(x=Math.sqrt(t*t+n*n),i=x*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(M=Math.sin(i),_=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(x)<=Pn?0:Math.asin(n*M/x),t*=M,n=_*x;break;case this.OBLIQ:i=Math.abs(x)<=Pn?this.lat0:Math.asin(_*this.sinph0+n*M*this.cosph0/x),t*=M*this.cosph0,n=(_-Math.sin(i)*this.sinph0)*x;break;case this.N_POLE:n=-n,i=on-i;break;case this.S_POLE:i-=on;break}r=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,n)}else{if(g=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,n*=this.dd,f=Math.sqrt(t*t+n*n),f<Pn)return e.x=this.long0,e.y=this.lat0,e;c=2*Math.asin(.5*f/this.rq),a=Math.cos(c),t*=c=Math.sin(c),this.mode===this.OBLIQ?(g=a*this.sinb1+n*c*this.cosb1/f,o=this.qp*g,n=f*this.cosb1*a-n*this.sinb1*c):(g=n*c/f,o=this.qp*g,n=f*a)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),o=t*t+n*n,!o)return e.x=this.long0,e.y=this.lat0,e;g=1-o/this.qp,this.mode===this.S_POLE&&(g=-g)}r=Math.atan2(t,n),i=Zge(Math.asin(g),this.apa)}return e.x=Ln(this.long0+r),e.y=i,e}var Vge=.3333333333333333,jge=.17222222222222222,Hge=.10257936507936508,Gge=.06388888888888888,Wge=.0664021164021164,qge=.016415012942191543;function Xge(e){var t,n=[];return n[0]=e*Vge,t=e*e,n[0]+=t*jge,n[1]=t*Gge,t*=e,n[0]+=t*Hge,n[1]+=t*Wge,n[2]=t*qge,n}function Zge(e,t){var n=e+e;return e+t[0]*Math.sin(n)+t[1]*Math.sin(n+n)+t[2]*Math.sin(n+n+n)}var Yge=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Kge={init:Bge,forward:Uge,inverse:$ge,names:Yge,S_POLE:zge,N_POLE:Oge,EQUIT:Fge,OBLIQ:Nge};function Wh(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}function Jge(){Math.abs(this.lat1+this.lat2)<Pn||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=wc(this.e3,this.sin_po,this.cos_po),this.qs1=Lh(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=wc(this.e3,this.sin_po,this.cos_po),this.qs2=Lh(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Lh(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Pn?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Qge(e){var t=e.x,n=e.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=Lh(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,a=this.ns0*Ln(t-this.long0),c=i*Math.sin(a)+this.x0,o=this.rh-i*Math.cos(a)+this.y0;return e.x=c,e.y=o,e}function eve(e){var t,n,r,i,a,c;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),r=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),r=-1),i=0,t!==0&&(i=Math.atan2(r*e.x,r*e.y)),r=t*this.ns0/this.a,this.sphere?c=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,c=this.phi1z(this.e3,n)),a=Ln(i/this.ns0+this.long0),e.x=a,e.y=c,e}function tve(e,t){var n,r,i,a,c,o=Wh(.5*t);if(e<Pn)return o;for(var f=e*e,g=1;g<=25;g++)if(n=Math.sin(o),r=Math.cos(o),i=e*n,a=1-i*i,c=.5*a*a/r*(t/(1-f)-n/a+.5/e*Math.log((1-i)/(1+i))),o=o+c,Math.abs(c)<=1e-7)return o;return null}var nve=["Albers_Conic_Equal_Area","Albers","aea"];const rve={init:Jge,forward:Qge,inverse:eve,names:nve,phi1z:tve};function ive(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function ove(e){var t,n,r,i,a,c,o,f,g=e.x,_=e.y;return r=Ln(g-this.long0),t=Math.sin(_),n=Math.cos(_),i=Math.cos(r),c=this.sin_p14*t+this.cos_p14*n*i,a=1,c>0||Math.abs(c)<=Pn?(o=this.x0+this.a*a*n*Math.sin(r)/c,f=this.y0+this.a*a*(this.cos_p14*t-this.sin_p14*n*i)/c):(o=this.x0+this.infinity_dist*n*Math.sin(r),f=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*n*i)),e.x=o,e.y=f,e}function sve(e){var t,n,r,i,a,c;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(i=Math.atan2(t,this.rc),n=Math.sin(i),r=Math.cos(i),c=Wh(r*this.sin_p14+e.y*n*this.cos_p14/t),a=Math.atan2(e.x*n,t*this.cos_p14*r-e.y*this.sin_p14*n),a=Ln(this.long0+a)):(c=this.phic0,a=0),e.x=a,e.y=c,e}var ave=["gnom"];const lve={init:ive,forward:ove,inverse:sve,names:ave};function cve(e,t){var n=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-n)<1e-6)return t<0?-1*on:on;for(var r=Math.asin(.5*t),i,a,c,o,f=0;f<30;f++)if(a=Math.sin(r),c=Math.cos(r),o=e*a,i=Math.pow(1-o*o,2)/(2*c)*(t/(1-e*e)-a/(1-o*o)+.5/e*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function uve(){this.sphere||(this.k0=wc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function hve(e){var t=e.x,n=e.y,r,i,a=Ln(t-this.long0);if(this.sphere)r=this.x0+this.a*a*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var c=Lh(this.e,Math.sin(n));r=this.x0+this.a*this.k0*a,i=this.y0+this.a*c*.5/this.k0}return e.x=r,e.y=i,e}function dve(e){e.x-=this.x0,e.y-=this.y0;var t,n;return this.sphere?(t=Ln(this.long0+e.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(n=cve(this.e,2*e.y*this.k0/this.a),t=Ln(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=n,e}var fve=["cea"];const pve={init:uve,forward:hve,inverse:dve,names:fve};function mve(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function gve(e){var t=e.x,n=e.y,r=Ln(t-this.long0),i=sd(n-this.lat0);return e.x=this.x0+this.a*r*this.rc,e.y=this.y0+this.a*i,e}function vve(e){var t=e.x,n=e.y;return e.x=Ln(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=sd(this.lat0+(n-this.y0)/this.a),e}var yve=["Equirectangular","Equidistant_Cylindrical","eqc"];const _ve={init:mve,forward:gve,inverse:vve,names:yve};var B4=20;function xve(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=tx(this.es),this.e1=nx(this.es),this.e2=rx(this.es),this.e3=ix(this.es),this.ml0=this.a*xs(this.e0,this.e1,this.e2,this.e3,this.lat0)}function bve(e){var t=e.x,n=e.y,r,i,a,c=Ln(t-this.long0);if(a=c*Math.sin(n),this.sphere)Math.abs(n)<=Pn?(r=this.a*c,i=-1*this.a*this.lat0):(r=this.a*Math.sin(a)/Math.tan(n),i=this.a*(sd(n-this.lat0)+(1-Math.cos(a))/Math.tan(n)));else if(Math.abs(n)<=Pn)r=this.a*c,i=-1*this.ml0;else{var o=Rg(this.a,this.e,Math.sin(n))/Math.tan(n);r=o*Math.sin(a),i=this.a*xs(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+o*(1-Math.cos(a))}return e.x=r+this.x0,e.y=i+this.y0,e}function wve(e){var t,n,r,i,a,c,o,f,g;if(r=e.x-this.x0,i=e.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=Pn)t=Ln(r/this.a+this.long0),n=0;else{c=this.lat0+i/this.a,o=r*r/this.a/this.a+c*c,f=c;var _;for(a=B4;a;--a)if(_=Math.tan(f),g=-1*(c*(f*_+1)-f-.5*(f*f+o)*_)/((f-c)/_-1),f+=g,Math.abs(g)<=Pn){n=f;break}t=Ln(this.long0+Math.asin(r*Math.tan(f)/this.a)/Math.sin(n))}else if(Math.abs(i+this.ml0)<=Pn)n=0,t=Ln(this.long0+r/this.a);else{c=(this.ml0+i)/this.a,o=r*r/this.a/this.a+c*c,f=c;var x,M,C,A,L;for(a=B4;a;--a)if(L=this.e*Math.sin(f),x=Math.sqrt(1-L*L)*Math.tan(f),M=this.a*xs(this.e0,this.e1,this.e2,this.e3,f),C=this.e0-2*this.e1*Math.cos(2*f)+4*this.e2*Math.cos(4*f)-6*this.e3*Math.cos(6*f),A=M/this.a,g=(c*(x*A+1)-A-.5*x*(A*A+o))/(this.es*Math.sin(2*f)*(A*A+o-2*c*A)/(4*x)+(c-A)*(x*C-2/Math.sin(2*f))-C),f-=g,Math.abs(g)<=Pn){n=f;break}x=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),t=Ln(this.long0+Math.asin(r*x/this.a)/Math.sin(n))}return e.x=t,e.y=n,e}var Sve=["Polyconic","poly"];const Mve={init:xve,forward:bve,inverse:wve,names:Sve};function Cve(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Eve(e){var t,n=e.x,r=e.y,i=r-this.lat0,a=n-this.long0,c=i/yy*1e-5,o=a,f=1,g=0;for(t=1;t<=10;t++)f=f*c,g=g+this.A[t]*f;var _=g,x=o,M=1,C=0,A,L,I=0,T=0;for(t=1;t<=6;t++)A=M*_-C*x,L=C*_+M*x,M=A,C=L,I=I+this.B_re[t]*M-this.B_im[t]*C,T=T+this.B_im[t]*M+this.B_re[t]*C;return e.x=T*this.a+this.x0,e.y=I*this.a+this.y0,e}function Tve(e){var t,n=e.x,r=e.y,i=n-this.x0,a=r-this.y0,c=a/this.a,o=i/this.a,f=1,g=0,_,x,M=0,C=0;for(t=1;t<=6;t++)_=f*c-g*o,x=g*c+f*o,f=_,g=x,M=M+this.C_re[t]*f-this.C_im[t]*g,C=C+this.C_im[t]*f+this.C_re[t]*g;for(var A=0;A<this.iterations;A++){var L=M,I=C,T,z,k=c,U=o;for(t=2;t<=6;t++)T=L*M-I*C,z=I*M+L*C,L=T,I=z,k=k+(t-1)*(this.B_re[t]*L-this.B_im[t]*I),U=U+(t-1)*(this.B_im[t]*L+this.B_re[t]*I);L=1,I=0;var H=this.B_re[1],V=this.B_im[1];for(t=2;t<=6;t++)T=L*M-I*C,z=I*M+L*C,L=T,I=z,H=H+t*(this.B_re[t]*L-this.B_im[t]*I),V=V+t*(this.B_im[t]*L+this.B_re[t]*I);var q=H*H+V*V;M=(k*H+U*V)/q,C=(U*H-k*V)/q}var J=M,Y=C,N=1,ne=0;for(t=1;t<=9;t++)N=N*J,ne=ne+this.D[t]*N;var ye=this.lat0+ne*yy*1e5,ge=this.long0+Y;return e.x=ge,e.y=ye,e}var Pve=["New_Zealand_Map_Grid","nzmg"];const Ave={init:Cve,forward:Eve,inverse:Tve,names:Pve};function Ive(){}function Rve(e){var t=e.x,n=e.y,r=Ln(t-this.long0),i=this.x0+this.a*r,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return e.x=i,e.y=a,e}function Lve(e){e.x-=this.x0,e.y-=this.y0;var t=Ln(this.long0+e.x/this.a),n=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=n,e}var kve=["Miller_Cylindrical","mill"];const Dve={init:Ive,forward:Rve,inverse:Lve,names:kve};var zve=20;function Ove(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=_L(this.es)}function Fve(e){var t,n,r=e.x,i=e.y;if(r=Ln(r-this.long0),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var a=this.n*Math.sin(i),c=zve;c;--c){var o=(this.m*i+Math.sin(i)-a)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<Pn)break}t=this.a*this.C_x*r*(this.m+Math.cos(i)),n=this.a*this.C_y*i}else{var f=Math.sin(i),g=Math.cos(i);n=this.a*Gg(i,f,g,this.en),t=this.a*r*g/Math.sqrt(1-this.es*f*f)}return e.x=t,e.y=n,e}function Nve(e){var t,n,r,i;return e.x-=this.x0,r=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(t))),this.m?t=Wh((this.m*t+Math.sin(t))/this.n):this.n!==1&&(t=Wh(Math.sin(t)/this.n)),r=Ln(r+this.long0),t=sd(t)):(t=xL(e.y/this.a,this.es,this.en),i=Math.abs(t),i<on?(i=Math.sin(t),n=this.long0+e.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(t)),r=Ln(n)):i-Pn<on&&(r=this.long0)),e.x=r,e.y=t,e}var Bve=["Sinusoidal","sinu"];const Uve={init:Ove,forward:Fve,inverse:Nve,names:Bve};function $ve(){}function Vve(e){for(var t=e.x,n=e.y,r=Ln(t-this.long0),i=n,a=Math.PI*Math.sin(n);;){var c=-(i+Math.sin(i)-a)/(1+Math.cos(i));if(i+=c,Math.abs(c)<Pn)break}i/=2,Math.PI/2-Math.abs(n)<Pn&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,f=1.4142135623731*this.a*Math.sin(i)+this.y0;return e.x=o,e.y=f,e}function jve(e){var t,n;e.x-=this.x0,e.y-=this.y0,n=e.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),t=Math.asin(n);var r=Ln(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*t+Math.sin(2*t))/Math.PI,Math.abs(n)>1&&(n=1);var i=Math.asin(n);return e.x=r,e.y=i,e}var Hve=["Mollweide","moll"];const Gve={init:$ve,forward:Vve,inverse:jve,names:Hve};function Wve(){Math.abs(this.lat1+this.lat2)<Pn||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=tx(this.es),this.e1=nx(this.es),this.e2=rx(this.es),this.e3=ix(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=wc(this.e,this.sinphi,this.cosphi),this.ml1=xs(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Pn?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=wc(this.e,this.sinphi,this.cosphi),this.ml2=xs(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=xs(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function qve(e){var t=e.x,n=e.y,r;if(this.sphere)r=this.a*(this.g-n);else{var i=xs(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-i)}var a=this.ns*Ln(t-this.long0),c=this.x0+r*Math.sin(a),o=this.y0+this.rh-r*Math.cos(a);return e.x=c,e.y=o,e}function Xve(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,n,r,i;this.ns>=0?(n=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(n=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var a=0;if(n!==0&&(a=Math.atan2(t*e.x,t*e.y)),this.sphere)return i=Ln(this.long0+a/this.ns),r=sd(this.g-n/this.a),e.x=i,e.y=r,e;var c=this.g-n/this.a;return r=mS(c,this.e0,this.e1,this.e2,this.e3),i=Ln(this.long0+a/this.ns),e.x=i,e.y=r,e}var Zve=["Equidistant_Conic","eqdc"];const Yve={init:Wve,forward:qve,inverse:Xve,names:Zve};function Kve(){this.R=this.a}function Jve(e){var t=e.x,n=e.y,r=Ln(t-this.long0),i,a;Math.abs(n)<=Pn&&(i=this.x0+this.R*r,a=this.y0);var c=Wh(2*Math.abs(n/Math.PI));(Math.abs(r)<=Pn||Math.abs(Math.abs(n)-on)<=Pn)&&(i=this.x0,n>=0?a=this.y0+Math.PI*this.R*Math.tan(.5*c):a=this.y0+Math.PI*this.R*-Math.tan(.5*c));var o=.5*Math.abs(Math.PI/r-r/Math.PI),f=o*o,g=Math.sin(c),_=Math.cos(c),x=_/(g+_-1),M=x*x,C=x*(2/g-1),A=C*C,L=Math.PI*this.R*(o*(x-A)+Math.sqrt(f*(x-A)*(x-A)-(A+f)*(M-A)))/(A+f);r<0&&(L=-L),i=this.x0+L;var I=f+x;return L=Math.PI*this.R*(C*I-o*Math.sqrt((A+f)*(f+1)-I*I))/(A+f),n>=0?a=this.y0+L:a=this.y0-L,e.x=i,e.y=a,e}function Qve(e){var t,n,r,i,a,c,o,f,g,_,x,M,C;return e.x-=this.x0,e.y-=this.y0,x=Math.PI*this.R,r=e.x/x,i=e.y/x,a=r*r+i*i,c=-Math.abs(i)*(1+a),o=c-2*i*i+r*r,f=-2*c+1+2*i*i+a*a,C=i*i/f+(2*o*o*o/f/f/f-9*c*o/f/f)/27,g=(c-o*o/3/f)/f,_=2*Math.sqrt(-g/3),x=3*C/g/_,Math.abs(x)>1&&(x>=0?x=1:x=-1),M=Math.acos(x)/3,e.y>=0?n=(-_*Math.cos(M+Math.PI/3)-o/3/f)*Math.PI:n=-(-_*Math.cos(M+Math.PI/3)-o/3/f)*Math.PI,Math.abs(r)<Pn?t=this.long0:t=Ln(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(r*r-i*i)+a*a))/2/r),e.x=t,e.y=n,e}var e0e=["Van_der_Grinten_I","VanDerGrinten","vandg"];const t0e={init:Kve,forward:Jve,inverse:Qve,names:e0e};function n0e(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function r0e(e){var t=e.x,n=e.y,r=Math.sin(e.y),i=Math.cos(e.y),a=Ln(t-this.long0),c,o,f,g,_,x,M,C,A,L,I,T,z,k,U,H,V,q,J,Y,N,ne,ye;return this.sphere?Math.abs(this.sin_p12-1)<=Pn?(e.x=this.x0+this.a*(on-n)*Math.sin(a),e.y=this.y0-this.a*(on-n)*Math.cos(a),e):Math.abs(this.sin_p12+1)<=Pn?(e.x=this.x0+this.a*(on+n)*Math.sin(a),e.y=this.y0+this.a*(on+n)*Math.cos(a),e):(q=this.sin_p12*r+this.cos_p12*i*Math.cos(a),H=Math.acos(q),V=H?H/Math.sin(H):1,e.x=this.x0+this.a*V*i*Math.sin(a),e.y=this.y0+this.a*V*(this.cos_p12*r-this.sin_p12*i*Math.cos(a)),e):(c=tx(this.es),o=nx(this.es),f=rx(this.es),g=ix(this.es),Math.abs(this.sin_p12-1)<=Pn?(_=this.a*xs(c,o,f,g,on),x=this.a*xs(c,o,f,g,n),e.x=this.x0+(_-x)*Math.sin(a),e.y=this.y0-(_-x)*Math.cos(a),e):Math.abs(this.sin_p12+1)<=Pn?(_=this.a*xs(c,o,f,g,on),x=this.a*xs(c,o,f,g,n),e.x=this.x0+(_+x)*Math.sin(a),e.y=this.y0+(_+x)*Math.cos(a),e):(M=r/i,C=Rg(this.a,this.e,this.sin_p12),A=Rg(this.a,this.e,r),L=Math.atan((1-this.es)*M+this.es*C*this.sin_p12/(A*i)),I=Math.atan2(Math.sin(a),this.cos_p12*Math.tan(L)-this.sin_p12*Math.cos(a)),I===0?J=Math.asin(this.cos_p12*Math.sin(L)-this.sin_p12*Math.cos(L)):Math.abs(Math.abs(I)-Math.PI)<=Pn?J=-Math.asin(this.cos_p12*Math.sin(L)-this.sin_p12*Math.cos(L)):J=Math.asin(Math.sin(a)*Math.cos(L)/Math.sin(I)),T=this.e*this.sin_p12/Math.sqrt(1-this.es),z=this.e*this.cos_p12*Math.cos(I)/Math.sqrt(1-this.es),k=T*z,U=z*z,Y=J*J,N=Y*J,ne=N*J,ye=ne*J,H=C*J*(1-Y*U*(1-U)/6+N/8*k*(1-2*U)+ne/120*(U*(4-7*U)-3*T*T*(1-7*U))-ye/48*k),e.x=this.x0+H*Math.sin(I),e.y=this.y0+H*Math.cos(I),e))}function i0e(e){e.x-=this.x0,e.y-=this.y0;var t,n,r,i,a,c,o,f,g,_,x,M,C,A,L,I,T,z,k,U,H,V,q,J;return this.sphere?(t=Math.sqrt(e.x*e.x+e.y*e.y),t>2*on*this.a?void 0:(n=t/this.a,r=Math.sin(n),i=Math.cos(n),a=this.long0,Math.abs(t)<=Pn?c=this.lat0:(c=Wh(i*this.sin_p12+e.y*r*this.cos_p12/t),o=Math.abs(this.lat0)-on,Math.abs(o)<=Pn?this.lat0>=0?a=Ln(this.long0+Math.atan2(e.x,-e.y)):a=Ln(this.long0-Math.atan2(-e.x,e.y)):a=Ln(this.long0+Math.atan2(e.x*r,t*this.cos_p12*i-e.y*this.sin_p12*r))),e.x=a,e.y=c,e)):(f=tx(this.es),g=nx(this.es),_=rx(this.es),x=ix(this.es),Math.abs(this.sin_p12-1)<=Pn?(M=this.a*xs(f,g,_,x,on),t=Math.sqrt(e.x*e.x+e.y*e.y),C=M-t,c=mS(C/this.a,f,g,_,x),a=Ln(this.long0+Math.atan2(e.x,-1*e.y)),e.x=a,e.y=c,e):Math.abs(this.sin_p12+1)<=Pn?(M=this.a*xs(f,g,_,x,on),t=Math.sqrt(e.x*e.x+e.y*e.y),C=t-M,c=mS(C/this.a,f,g,_,x),a=Ln(this.long0+Math.atan2(e.x,e.y)),e.x=a,e.y=c,e):(t=Math.sqrt(e.x*e.x+e.y*e.y),I=Math.atan2(e.x,e.y),A=Rg(this.a,this.e,this.sin_p12),T=Math.cos(I),z=this.e*this.cos_p12*T,k=-z*z/(1-this.es),U=3*this.es*(1-k)*this.sin_p12*this.cos_p12*T/(1-this.es),H=t/A,V=H-k*(1+k)*Math.pow(H,3)/6-U*(1+3*k)*Math.pow(H,4)/24,q=1-k*V*V/2-H*V*V*V/6,L=Math.asin(this.sin_p12*Math.cos(V)+this.cos_p12*Math.sin(V)*T),a=Ln(this.long0+Math.asin(Math.sin(I)*Math.sin(V)/Math.cos(L))),J=Math.sin(L),c=Math.atan2((J-this.es*q*this.sin_p12)*Math.tan(L),J*(1-this.es)),e.x=a,e.y=c,e))}var o0e=["Azimuthal_Equidistant","aeqd"];const s0e={init:n0e,forward:r0e,inverse:i0e,names:o0e};function a0e(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function l0e(e){var t,n,r,i,a,c,o,f,g=e.x,_=e.y;return r=Ln(g-this.long0),t=Math.sin(_),n=Math.cos(_),i=Math.cos(r),c=this.sin_p14*t+this.cos_p14*n*i,a=1,(c>0||Math.abs(c)<=Pn)&&(o=this.a*a*n*Math.sin(r),f=this.y0+this.a*a*(this.cos_p14*t-this.sin_p14*n*i)),e.x=o,e.y=f,e}function c0e(e){var t,n,r,i,a,c,o;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),n=Wh(t/this.a),r=Math.sin(n),i=Math.cos(n),c=this.long0,Math.abs(t)<=Pn?(o=this.lat0,e.x=c,e.y=o,e):(o=Wh(i*this.sin_p14+e.y*r*this.cos_p14/t),a=Math.abs(this.lat0)-on,Math.abs(a)<=Pn?(this.lat0>=0?c=Ln(this.long0+Math.atan2(e.x,-e.y)):c=Ln(this.long0-Math.atan2(-e.x,e.y)),e.x=c,e.y=o,e):(c=Ln(this.long0+Math.atan2(e.x*r,t*this.cos_p14*i-e.y*this.sin_p14*r)),e.x=c,e.y=o,e))}var u0e=["ortho"];const h0e={init:a0e,forward:l0e,inverse:c0e,names:u0e};var vi={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Nr={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function d0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=on-Fr/2?this.face=vi.TOP:this.lat0<=-(on-Fr/2)?this.face=vi.BOTTOM:Math.abs(this.long0)<=Fr?this.face=vi.FRONT:Math.abs(this.long0)<=on+Fr?this.face=this.long0>0?vi.RIGHT:vi.LEFT:this.face=vi.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function f0e(e){var t={x:0,y:0},n,r,i,a,c,o,f={value:0};if(e.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(e.y)):n=e.y,r=e.x,this.face===vi.TOP)a=on-n,r>=Fr&&r<=on+Fr?(f.value=Nr.AREA_0,i=r-on):r>on+Fr||r<=-(on+Fr)?(f.value=Nr.AREA_1,i=r>0?r-zi:r+zi):r>-(on+Fr)&&r<=-Fr?(f.value=Nr.AREA_2,i=r+on):(f.value=Nr.AREA_3,i=r);else if(this.face===vi.BOTTOM)a=on+n,r>=Fr&&r<=on+Fr?(f.value=Nr.AREA_0,i=-r+on):r<Fr&&r>=-Fr?(f.value=Nr.AREA_1,i=-r):r<-Fr&&r>=-(on+Fr)?(f.value=Nr.AREA_2,i=-r-on):(f.value=Nr.AREA_3,i=r>0?-r+zi:-r-zi);else{var g,_,x,M,C,A,L;this.face===vi.RIGHT?r=ag(r,+on):this.face===vi.BACK?r=ag(r,+zi):this.face===vi.LEFT&&(r=ag(r,-on)),M=Math.sin(n),C=Math.cos(n),A=Math.sin(r),L=Math.cos(r),g=C*L,_=C*A,x=M,this.face===vi.FRONT?(a=Math.acos(g),i=Q1(a,x,_,f)):this.face===vi.RIGHT?(a=Math.acos(_),i=Q1(a,x,-g,f)):this.face===vi.BACK?(a=Math.acos(-g),i=Q1(a,x,-_,f)):this.face===vi.LEFT?(a=Math.acos(-_),i=Q1(a,x,g,f)):(a=i=0,f.value=Nr.AREA_0)}return o=Math.atan(12/zi*(i+Math.acos(Math.sin(i)*Math.cos(Fr))-on)),c=Math.sqrt((1-Math.cos(a))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),f.value===Nr.AREA_1?o+=on:f.value===Nr.AREA_2?o+=zi:f.value===Nr.AREA_3&&(o+=1.5*zi),t.x=c*Math.cos(o),t.y=c*Math.sin(o),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,e.x=t.x,e.y=t.y,e}function p0e(e){var t={lam:0,phi:0},n,r,i,a,c,o,f,g,_,x={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,r=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),n=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?x.value=Nr.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(x.value=Nr.AREA_1,n-=on):e.x<0&&-e.x>=Math.abs(e.y)?(x.value=Nr.AREA_2,n=n<0?n+zi:n-zi):(x.value=Nr.AREA_3,n+=on),_=zi/12*Math.tan(n),c=Math.sin(_)/(Math.cos(_)-1/Math.sqrt(2)),o=Math.atan(c),i=Math.cos(n),a=Math.tan(r),f=1-i*i*a*a*(1-Math.cos(Math.atan(1/Math.cos(o)))),f<-1?f=-1:f>1&&(f=1),this.face===vi.TOP)g=Math.acos(f),t.phi=on-g,x.value===Nr.AREA_0?t.lam=o+on:x.value===Nr.AREA_1?t.lam=o<0?o+zi:o-zi:x.value===Nr.AREA_2?t.lam=o-on:t.lam=o;else if(this.face===vi.BOTTOM)g=Math.acos(f),t.phi=g-on,x.value===Nr.AREA_0?t.lam=-o+on:x.value===Nr.AREA_1?t.lam=-o:x.value===Nr.AREA_2?t.lam=-o-on:t.lam=o<0?-o-zi:-o+zi;else{var M,C,A;M=f,_=M*M,_>=1?A=0:A=Math.sqrt(1-_)*Math.sin(o),_+=A*A,_>=1?C=0:C=Math.sqrt(1-_),x.value===Nr.AREA_1?(_=C,C=-A,A=_):x.value===Nr.AREA_2?(C=-C,A=-A):x.value===Nr.AREA_3&&(_=C,C=A,A=-_),this.face===vi.RIGHT?(_=M,M=-C,C=_):this.face===vi.BACK?(M=-M,C=-C):this.face===vi.LEFT&&(_=M,M=C,C=-_),t.phi=Math.acos(-A)-on,t.lam=Math.atan2(C,M),this.face===vi.RIGHT?t.lam=ag(t.lam,-on):this.face===vi.BACK?t.lam=ag(t.lam,-zi):this.face===vi.LEFT&&(t.lam=ag(t.lam,+on))}if(this.es!==0){var L,I,T;L=t.phi<0?1:0,I=Math.tan(t.phi),T=this.b/Math.sqrt(I*I+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),L&&(t.phi=-t.phi)}return t.lam+=this.long0,e.x=t.lam,e.y=t.phi,e}function Q1(e,t,n,r){var i;return e<Pn?(r.value=Nr.AREA_0,i=0):(i=Math.atan2(t,n),Math.abs(i)<=Fr?r.value=Nr.AREA_0:i>Fr&&i<=on+Fr?(r.value=Nr.AREA_1,i-=on):i>on+Fr||i<=-(on+Fr)?(r.value=Nr.AREA_2,i=i>=0?i-zi:i+zi):(r.value=Nr.AREA_3,i+=on)),i}function ag(e,t){var n=e+t;return n<-zi?n+=d_:n>+zi&&(n-=d_),n}var m0e=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const g0e={init:d0e,forward:f0e,inverse:p0e,names:m0e};var HA=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],K0=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],i9=.8487,o9=1.3523,s9=hc/5,v0e=1/s9,$m=18,gS=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))},y0e=function(e,t){return e[1]+t*(2*e[2]+t*3*e[3])};function _0e(e,t,n,r){for(var i=t;r;--r){var a=e(i);if(i-=a,Math.abs(a)<n)break}return i}function x0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function b0e(e){var t=Ln(e.x-this.long0),n=Math.abs(e.y),r=Math.floor(n*s9);r<0?r=0:r>=$m&&(r=$m-1),n=hc*(n-v0e*r);var i={x:gS(HA[r],n)*t,y:gS(K0[r],n)};return e.y<0&&(i.y=-i.y),i.x=i.x*this.a*i9+this.x0,i.y=i.y*this.a*o9+this.y0,i}function w0e(e){var t={x:(e.x-this.x0)/(this.a*i9),y:Math.abs(e.y-this.y0)/(this.a*o9)};if(t.y>=1)t.x/=HA[$m][0],t.y=e.y<0?-on:on;else{var n=Math.floor(t.y*$m);for(n<0?n=0:n>=$m&&(n=$m-1);;)if(K0[n][0]>t.y)--n;else if(K0[n+1][0]<=t.y)++n;else break;var r=K0[n],i=5*(t.y-r[0])/(K0[n+1][0]-r[0]);i=_0e(function(a){return(gS(r,a)-t.y)/y0e(r,a)},i,Pn,100),t.x/=gS(HA[n],i),t.y=(5*n+i)*No,e.y<0&&(t.y=-t.y)}return t.x=Ln(t.x+this.long0),t}var S0e=["Robinson","robin"];const M0e={init:x0e,forward:b0e,inverse:w0e,names:S0e};function C0e(){this.name="geocent"}function E0e(e){var t=qj(e,this.es,this.a);return t}function T0e(e){var t=Xj(e,this.es,this.a,this.b);return t}var P0e=["Geocentric","geocentric","geocent","Geocent"];const A0e={init:C0e,forward:E0e,inverse:T0e,names:P0e};var as={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},T0={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function I0e(){if(Object.keys(T0).forEach((function(n){if(typeof this[n]>"u")this[n]=T0[n].def;else{if(T0[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);T0[n].num&&(this[n]=parseFloat(this[n]))}T0[n].degrees&&(this[n]=this[n]*No)}).bind(this)),Math.abs(Math.abs(this.lat0)-on)<Pn?this.mode=this.lat0<0?as.S_POLE:as.N_POLE:Math.abs(this.lat0)<Pn?this.mode=as.EQUIT:(this.mode=as.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(e),this.sw=Math.sin(e)}function R0e(e){e.x-=this.long0;var t=Math.sin(e.y),n=Math.cos(e.y),r=Math.cos(e.x),i,a;switch(this.mode){case as.OBLIQ:a=this.sinph0*t+this.cosph0*n*r;break;case as.EQUIT:a=n*r;break;case as.S_POLE:a=-t;break;case as.N_POLE:a=t;break}switch(a=this.pn1/(this.p-a),i=a*n*Math.sin(e.x),this.mode){case as.OBLIQ:a*=this.cosph0*t-this.sinph0*n*r;break;case as.EQUIT:a*=t;break;case as.N_POLE:a*=-(n*r);break;case as.S_POLE:a*=n*r;break}var c,o;return c=a*this.cg+i*this.sg,o=1/(c*this.sw*this.h1+this.cw),i=(i*this.cg-a*this.sg)*this.cw*o,a=c*o,e.x=i*this.a,e.y=a*this.a,e}function L0e(e){e.x/=this.a,e.y/=this.a;var t={x:e.x,y:e.y},n,r,i;i=1/(this.pn1-e.y*this.sw),n=this.pn1*e.x*i,r=this.pn1*e.y*this.cw*i,e.x=n*this.cg+r*this.sg,e.y=r*this.cg-n*this.sg;var a=Os(e.x,e.y);if(Math.abs(a)<Pn)t.x=0,t.y=e.y;else{var c,o;switch(o=1-a*a*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/a+a/this.pn1),c=Math.sqrt(1-o*o),this.mode){case as.OBLIQ:t.y=Math.asin(c*this.sinph0+e.y*o*this.cosph0/a),e.y=(c-this.sinph0*Math.sin(t.y))*a,e.x*=o*this.cosph0;break;case as.EQUIT:t.y=Math.asin(e.y*o/a),e.y=c*a,e.x*=o;break;case as.N_POLE:t.y=Math.asin(c),e.y=-e.y;break;case as.S_POLE:t.y=-Math.asin(c);break}t.x=Math.atan2(e.x,e.y)}return e.x=t.x+this.long0,e.y=t.y,e}var k0e=["Tilted_Perspective","tpers"];const D0e={init:I0e,forward:R0e,inverse:L0e,names:k0e};function z0e(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var e=1-this.es,t=1/e;this.radius_p=Math.sqrt(e),this.radius_p2=e,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function O0e(e){var t=e.x,n=e.y,r,i,a,c;if(t=t-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var o=this.radius_p/Os(this.radius_p*Math.cos(n),Math.sin(n));if(i=o*Math.cos(t)*Math.cos(n),a=o*Math.sin(t)*Math.cos(n),c=o*Math.sin(n),(this.radius_g-i)*i-a*a-c*c*this.radius_p_inv2<0)return e.x=Number.NaN,e.y=Number.NaN,e;r=this.radius_g-i,this.flip_axis?(e.x=this.radius_g_1*Math.atan(a/Os(c,r)),e.y=this.radius_g_1*Math.atan(c/r)):(e.x=this.radius_g_1*Math.atan(a/r),e.y=this.radius_g_1*Math.atan(c/Os(a,r)))}else this.shape==="sphere"&&(r=Math.cos(n),i=Math.cos(t)*r,a=Math.sin(t)*r,c=Math.sin(n),r=this.radius_g-i,this.flip_axis?(e.x=this.radius_g_1*Math.atan(a/Os(c,r)),e.y=this.radius_g_1*Math.atan(c/r)):(e.x=this.radius_g_1*Math.atan(a/r),e.y=this.radius_g_1*Math.atan(c/Os(a,r))));return e.x=e.x*this.a,e.y=e.y*this.a,e}function F0e(e){var t=-1,n=0,r=0,i,a,c,o;if(e.x=e.x/this.a,e.y=e.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(e.y/this.radius_g_1),n=Math.tan(e.x/this.radius_g_1)*Os(1,r)):(n=Math.tan(e.x/this.radius_g_1),r=Math.tan(e.y/this.radius_g_1)*Os(1,n));var f=r/this.radius_p;if(i=n*n+f*f+t*t,a=2*this.radius_g*t,c=a*a-4*i*this.C,c<0)return e.x=Number.NaN,e.y=Number.NaN,e;o=(-a-Math.sqrt(c))/(2*i),t=this.radius_g+o*t,n*=o,r*=o,e.x=Math.atan2(n,t),e.y=Math.atan(r*Math.cos(e.x)/t),e.y=Math.atan(this.radius_p_inv2*Math.tan(e.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(e.y/this.radius_g_1),n=Math.tan(e.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(e.x/this.radius_g_1),r=Math.tan(e.y/this.radius_g_1)*Math.sqrt(1+n*n)),i=n*n+r*r+t*t,a=2*this.radius_g*t,c=a*a-4*i*this.C,c<0)return e.x=Number.NaN,e.y=Number.NaN,e;o=(-a-Math.sqrt(c))/(2*i),t=this.radius_g+o*t,n*=o,r*=o,e.x=Math.atan2(n,t),e.y=Math.atan(r*Math.cos(e.x)/t)}return e.x=e.x+this.long0,e}var N0e=["Geostationary Satellite View","Geostationary_Satellite","geos"];const B0e={init:z0e,forward:O0e,inverse:F0e,names:N0e};var _y=1.340264,xy=-.081106,by=893e-6,wy=.003796,vS=Math.sqrt(3)/2;function U0e(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function $0e(e){var t=Ln(e.x-this.long0),n=e.y,r=Math.asin(vS*Math.sin(n)),i=r*r,a=i*i*i;return e.x=t*Math.cos(r)/(vS*(_y+3*xy*i+a*(7*by+9*wy*i))),e.y=r*(_y+xy*i+a*(by+wy*i)),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function V0e(e){e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a;var t=1e-9,n=12,r=e.y,i,a,c,o,f,g;for(g=0;g<n&&(i=r*r,a=i*i*i,c=r*(_y+xy*i+a*(by+wy*i))-e.y,o=_y+3*xy*i+a*(7*by+9*wy*i),r-=f=c/o,!(Math.abs(f)<t));++g);return i=r*r,a=i*i*i,e.x=vS*e.x*(_y+3*xy*i+a*(7*by+9*wy*i))/Math.cos(r),e.y=Math.asin(Math.sin(r)/vS),e.x=Ln(e.x+this.long0),e}var j0e=["eqearth","Equal Earth","Equal_Earth"];const H0e={init:U0e,forward:$0e,inverse:V0e,names:j0e};var m_=1e-10;function G0e(){var e;if(this.phi1=this.lat1,Math.abs(this.phi1)<m_)throw new Error;this.es?(this.en=_L(this.es),this.m1=Gg(this.phi1,this.am1=Math.sin(this.phi1),e=Math.cos(this.phi1),this.en),this.am1=e/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=q0e,this.forward=W0e):(Math.abs(this.phi1)+m_>=on?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Z0e,this.forward=X0e)}function W0e(e){var t=Ln(e.x-(this.long0||0)),n=e.y,r,i,a;return r=this.am1+this.m1-Gg(n,i=Math.sin(n),a=Math.cos(n),this.en),i=a*t/(r*Math.sqrt(1-this.es*i*i)),e.x=r*Math.sin(i),e.y=this.am1-r*Math.cos(i),e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function q0e(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,n,r,i;if(n=Os(e.x,e.y=this.am1-e.y),i=xL(this.am1+this.m1-n,this.es,this.en),(t=Math.abs(i))<on)t=Math.sin(i),r=n*Math.atan2(e.x,e.y)*Math.sqrt(1-this.es*t*t)/Math.cos(i);else if(Math.abs(t-on)<=m_)r=0;else throw new Error;return e.x=Ln(r+(this.long0||0)),e.y=sd(i),e}function X0e(e){var t=Ln(e.x-(this.long0||0)),n=e.y,r,i;return i=this.cphi1+this.phi1-n,Math.abs(i)>m_?(e.x=i*Math.sin(r=t*Math.cos(n)/i),e.y=this.cphi1-i*Math.cos(r)):e.x=e.y=0,e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function Z0e(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,n,r=Os(e.x,e.y=this.cphi1-e.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>on)throw new Error;return Math.abs(Math.abs(n)-on)<=m_?t=0:t=r*Math.atan2(e.x,e.y)/Math.cos(n),e.x=Ln(t+(this.long0||0)),e.y=sd(n),e}var Y0e=["bonne","Bonne (Werner lat_1=90)"];const K0e={init:G0e,names:Y0e};function J0e(e){e.Proj.projections.add(lw),e.Proj.projections.add(cw),e.Proj.projections.add(Wme),e.Proj.projections.add(nge),e.Proj.projections.add(lge),e.Proj.projections.add(fge),e.Proj.projections.add(_ge),e.Proj.projections.add(Mge),e.Proj.projections.add(Age),e.Proj.projections.add(Dge),e.Proj.projections.add(Kge),e.Proj.projections.add(rve),e.Proj.projections.add(lve),e.Proj.projections.add(pve),e.Proj.projections.add(_ve),e.Proj.projections.add(Mve),e.Proj.projections.add(Ave),e.Proj.projections.add(Dve),e.Proj.projections.add(Uve),e.Proj.projections.add(Gve),e.Proj.projections.add(Yve),e.Proj.projections.add(t0e),e.Proj.projections.add(s0e),e.Proj.projections.add(h0e),e.Proj.projections.add(g0e),e.Proj.projections.add(M0e),e.Proj.projections.add(A0e),e.Proj.projections.add(D0e),e.Proj.projections.add(B0e),e.Proj.projections.add(H0e),e.Proj.projections.add(K0e)}Xs.defaultDatum="WGS84";Xs.Proj=_c;Xs.WGS84=new Xs.Proj("WGS84");Xs.Point=Ig;Xs.toPoint=Zj;Xs.defs=vs;Xs.nadgrid=Xpe;Xs.transform=pS;Xs.mgrs=ume;Xs.version="__VERSION__";J0e(Xs);const ML=6370997,yS=ML*Math.PI/180,Vm={mapProjection:"lambert_conic",standardParalel1:33,standardParalel2:45,mapOrigin:[39,-96],mapFactor:[-.00017706234,.000176689948]},Q0e=["+proj=lcc",`+R=${ML}`,`+lat_1=${Vm.standardParalel1}`,`+lat_2=${Vm.standardParalel2}`,`+lat_0=${Vm.mapOrigin[0]}`,`+lon_0=${Vm.mapOrigin[1]}`].join(" "),eye=Xs(Q0e),a9=([e,t])=>{const n=eye.forward([e,t]);return[n[0]/Vm.mapFactor[1]/yS,n[1]/Vm.mapFactor[0]/yS].map(r=>Number(r.toFixed(10)))},bh={mapProjection:"lambert_conic",standardParalel1:37,standardParalel2:65,mapOrigin:[50,15],mapOffset:[16660,4150],mapFactor:[-.000171570875,.0001729241463]},tye=["+proj=lcc",`+R=${ML}`,`+lat_1=${bh.standardParalel1}`,`+lat_2=${bh.standardParalel2}`,`+lat_0=${bh.mapOrigin[0]}`,`+lon_0=${bh.mapOrigin[1]}`].join(" "),nye=Xs(tye),l9=([e,t])=>{const n=nye.forward([e,t]);let[r,i]=[n[0]/bh.mapFactor[1]/yS,n[1]/bh.mapFactor[0]/yS];const a=.75,c=[-31100,-5500],o=r/a-c[0]/2,f=i/a-c[1]/2;return o*a<c[0]&&o*a<c[1]&&(r=o,i=f),[r+bh.mapOffset[0],i+bh.mapOffset[1]].map(_=>Number(_.toFixed(10)))};var oa=63710088e-1,rye={centimeters:oa*100,centimetres:oa*100,degrees:360/(2*Math.PI),feet:oa*3.28084,inches:oa*39.37,kilometers:oa/1e3,kilometres:oa/1e3,meters:oa,metres:oa,miles:oa/1609.344,millimeters:oa*1e3,millimetres:oa*1e3,nauticalmiles:oa/1852,radians:1,yards:oa*1.0936};function iye(e,t="kilometers"){const n=rye[t];if(!n)throw new Error(t+" units is invalid");return e*n}function eb(e){return e%360*Math.PI/180}function U4(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function GA(e,t,n={}){var r=U4(e),i=U4(t),a=eb(i[1]-r[1]),c=eb(i[0]-r[0]),o=eb(r[1]),f=eb(i[1]),g=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(c/2),2)*Math.cos(o)*Math.cos(f);return iye(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)),n.units)}const th={ats:[[-124.477162,25.767968].map(e=>Math.floor(e)),[-88.777474,49.1223839].map(e=>Math.ceil(e))].flat(),ets2:[[-10.025698,34.897275].map(e=>Math.floor(e)),[33.284941,61.881437].map(e=>Math.ceil(e))].flat()},oye=()=>{const e=Qn(J_().current),[t,n]=$.useState(null),[r,i]=$.useState(!1),[a,c]=$.useState(!1),[o,f]=$.useState([]),g=$.useCallback(C=>{C!=="clickaway"&&i(!1)},[]),_=$.useCallback(()=>{c(!1),f([])},[]),x=C=>()=>{i(!0);const A=Qn(t).position;switch(C){case"lngLat":navigator.clipboard.writeText(A.lngLat.map(L=>V4(L,4)).join(","));break;case"xz":navigator.clipboard.writeText(Qn(A.xz).map(L=>V4(L,1)).join(";"));break;default:throw new zl(C)}},M=$.useCallback(()=>{n(null),e.off("move",M)},[]);return $.useEffect(()=>{const C=T=>{const{x:z,y:k}=T.point,U=T.lngLat.toArray();let H;K1(th.ats,U)?H=a9(U):K1(th.ets2,U)&&(H=l9(U));const V=GA(U,_4(th.ats)),q=GA(U,_4(th.ets2)),J=V<=q?"ats":"ets2";n({position:{lngLat:U,xz:H},closestGame:J,anchorEl:{getBoundingClientRect:()=>({width:0,height:0,top:k,right:z,bottom:k,left:z})}}),e.once("move",M)};let A;const L=T=>{A=window.setTimeout(()=>{A=void 0,C(T)},1e3)},I=()=>clearTimeout(A);return e.on("contextmenu",C),e.on("touchstart",L),e.on("touchend",I),e.on("touchmove",I),()=>{e.off("contextmenu",C),e.off("touchstart",L),e.off("touchend",I),e.off("touchmove",I)}},[e]),$.useEffect(()=>{if(!a){e.getCanvas().style.cursor="";return}let C=0;const A=()=>C++,L={type:"Feature",geometry:{type:"LineString",coordinates:o},properties:{id:A()}},I={type:"FeatureCollection",features:[...o.map(k=>j4(k,A())),...o.length>1?[L]:[]]},T=k=>{const U=e.queryRenderedFeatures(k.point,{layers:["measure-points"]}),H=K1(a==="ats"?th.ats:th.ets2,k.lngLat.toArray());e.getCanvas().style.cursor=H?U.length?"pointer":"crosshair":"not-allowed"},z=k=>{if(!K1(a==="ats"?th.ats:th.ets2,k.lngLat.toArray()))return;const H=e.queryRenderedFeatures(k.point,{layers:["measure-points"]});if(I.features.length>1&&I.features.pop(),H.length){const V=H[0].properties.id;I.features=I.features.filter(q=>q.properties.id!==V)}else I.features.push(j4(k.lngLat.toArray(),A()));I.features.length>1&&(L.geometry.coordinates=I.features.map(V=>(oj(V.geometry.type==="Point",`unexpected non-Point geometry: ${V.geometry.type}`),V.geometry.coordinates)),I.features.push(L)),Qn(e.getSource("measure")).setData(I),f(I.features.filter(V=>V.geometry.type==="Point").map(V=>V.geometry.coordinates))};return e.on("mousemove",T),e.on("click",z),Qn(e.getSource("measure")).setData(I),()=>{e.off("mousemove",T),e.off("click",z),Qn(e.getSource("measure")).setData({type:"FeatureCollection",features:[]})}},[e,o,a]),ee.jsxs(ee.Fragment,{children:[ee.jsx("div",{style:{display:t!=null?"block":"none",zIndex:10,position:"absolute",top:0,left:0,right:0,bottom:0},onMouseDown:C=>{C.currentTarget===C.target&&M()},children:ee.jsx(hV,{size:"sm",open:t!=null,anchorEl:t==null?void 0:t.anchorEl,placement:"bottom-start",onClick:M,onContextMenu:C=>C.preventDefault(),children:t?ee.jsxs(ee.Fragment,{children:[ee.jsxs(_f,{sx:{justifyContent:"space-between"},onClick:x("lngLat"),children:[ee.jsx(Lj,{}),ee.jsx(l_,{children:ee.jsx($4,{coords:{lat:t.position.lngLat[1],lng:t.position.lngLat[0]},fractionDigits:4})}),ee.jsx(y4,{sx:{ml:1}})]}),t.position.xz?ee.jsxs(ee.Fragment,{children:[ee.jsxs(_f,{sx:{justifyContent:"space-between"},onClick:x("xz"),children:[ee.jsx(kj,{}),ee.jsx(l_,{children:ee.jsx($4,{coords:{x:t.position.xz[0],z:t.position.xz[1]},fractionDigits:1})}),ee.jsx(y4,{sx:{ml:1}})]}),ee.jsx(CA,{}),a?ee.jsx(_f,{onClick:_,children:"Clear measurement"}):ee.jsx(_f,{onClick:()=>{c(Qn(t).closestGame),f([Qn(t).position.lngLat])},children:"Measure distance"})]}):ee.jsxs(ee.Fragment,{children:[ee.jsx(CA,{}),ee.jsx(rd,{children:ee.jsxs(oi,{level:"body-xs",sx:{opacity:.75},children:["Right-click within the"," ",t.closestGame.toUpperCase()," game map for more options."]})})]})]}):null})}),ee.jsx(sye,{measuring:a,close:_,measuringPoints:o}),ee.jsx(aye,{open:r,close:g})]})},$4=e=>Object.entries(e.coords).map(([t,n],r)=>ee.jsxs($.Fragment,{children:[r>0?ee.jsx("span",{children:""}):null,ee.jsx(H8,{size:"sm",variant:"plain",sx:{opacity:.4},children:t}),J0(n,e.fractionDigits)]},t)),sye=$.memo(e=>e.measuring===!1?null:ee.jsx(mV,{open:!0,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",sx:{alignItems:"baseline",mb:4},endDecorator:ee.jsx(fu,{onClick:e.close,children:ee.jsx(dL,{})}),children:ee.jsxs(Ga,{gap:1,children:[ee.jsx(oi,{level:"title-md",children:"Measure distance"}),e.measuringPoints.length<=1?ee.jsx(oi,{level:"body-sm",children:"Click on the map to trace a path you want to measure."}):ee.jsxs(Ga,{gap:2,children:[ee.jsx(oi,{level:"body-sm",children:"Click on the map to add to your path. Click on an existing point to remove it from the path."}),ee.jsxs(Ga,{direction:{xs:"column",md:"row"},gap:2,children:[ee.jsx(oi,{level:"title-sm",children:"Total distance:"}),ee.jsxs(Ga,{direction:"row",gap:.5,children:[ee.jsx(oi,{level:"body-xs",children:ee.jsx(Lj,{})}),ee.jsx(oi,{level:"title-sm",children:H4(e.measuringPoints,"irl",e.measuring)})]}),ee.jsxs(Ga,{direction:"row",gap:.5,children:[ee.jsx(oi,{level:"body-xs",children:ee.jsx(kj,{})}),ee.jsx(oi,{level:"title-sm",children:H4(e.measuringPoints,"game",e.measuring)})]})]})]})]})})),aye=$.memo(e=>ee.jsx(mV,{open:e.open,onClose:(t,n)=>e.close(n),autoHideDuration:3e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",endDecorator:ee.jsx(fu,{onClick:()=>e.close("escapeKeyDown"),children:ee.jsx(dL,{})}),children:"Copied to clipboard."}));function V4(e,t){return Number(e.toFixed(t))}function J0(e,t){return Number(e.toFixed(t)).toLocaleString(void 0,{maximumFractionDigits:t})}function j4(e,t){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{id:t}}}function H4(e,t,n){let r;if(t==="irl")r=e;else{const f=n==="ats"?a9:l9;r=e.map(f)}const i=t==="irl"?GA:(f,g)=>zj(f,g)/1e3;let a=r[0],c=0;for(const f of r.slice(1))c+=i(a,f),a=f;const o=c<1?`${J0(c*1e3,1)} meters`:`${J0(c,2)} km`;if(t==="irl"){const f=c*.6213712,g=f<1?`${J0(f*5280,0)} ft`:`${J0(f,2)} mi`;return`${n==="ats"?g:o} (${n==="ats"?o:g})`}else return o}const c9={[Ai.FuelStation]:{iconName:"gas_ico",label:"Fuel station"},[Ai.Toll]:{iconName:"toll_ico",label:"Toll gate"},[Ai.Parking]:{iconName:"parking_ico",label:"Rest stop"},[Ai.RecruitmentAgency]:{iconName:"recruitment_ico",label:"Recruitment agency"},[Ai.Service]:{iconName:"service_ico",label:"Service"},[Ai.TruckDealer]:{iconName:"dealer_ico",label:"Truck dealer"},[Ai.Port]:{iconName:"port_overlay",label:"Port"},[Ai.Train]:{iconName:"train_ico",label:"Train"},[Ai.Viewpoint]:{iconName:"viewpoint",label:"Viewpoint"},[Ai.PhotoSight]:{iconName:"photo_sight_captured",label:"Photo trophy"},[Ai.AgricultureCheck]:{iconName:"agri_check",label:"Agricultural inspection"},[Ai.BorderCheck]:{iconName:"border_ico",label:"Border inspection"},[Ai.Garage]:{iconName:"garage_large_ico",label:"Garage"},[Ai.WeighStation]:{iconName:"weigh_station_ico",label:"Weigh station"},[Ai.CityNames]:{iconName:"city_names_ico",label:"City names"},[Ai.Company]:{iconName:"companies_ico",label:"Companies"},[Ai.RoadNumber]:{iconName:"road_numbers_ico",label:"Road numbers"},[Ai.Roadwork]:{iconName:"roadwork",label:"Roadwork"},[Ai.RailCrossing]:{iconName:"railcrossing",label:"Rail Crossing"}},G4=new Map(Object.entries(c9).map(([e,t])=>[Number(e),t.label])),W4=new Map(Object.entries(dde).map(([e,t])=>[Number(e),t]));function _S(e,t,n){return{selectedItems:e,onSelectAllToggle:r=>t(new Set(r?n:[])),onItemToggle:(r,i)=>{t(a=>{const c=new Set(a);return i?c.add(r):c.delete(r),c})}}}const u9=e=>{const t=$.useRef(null),[n,r]=$.useState(!1),[i,a]=$.useState(0);return rl(()=>({onAdd:()=>Qn(t.current),onRemove:()=>Qn(t.current).remove()}),{position:"bottom-left"}),ee.jsxs("div",{ref:t,className:"maplibregl-ctrl maplibregl-ctrl-group",children:[ee.jsx(fu,{title:"Map Options",sx:{minWidth:0,minHeight:0,borderRadius:0},onClick:()=>r(!0),children:ee.jsx(npe,{})}),ee.jsx(uV,{open:n,onClose:()=>r(!1),variant:"plain",hideBackdrop:!0,slotProps:{root:{sx:{pointerEvents:"none"}},content:{sx:{bgcolor:"transparent",p:1,boxShadow:"none",justifyContent:"end"}}},children:ee.jsxs(fV,{variant:"outlined",sx:{pointerEvents:"auto",borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,height:"80%",overflow:"auto"},children:[ee.jsx(oV,{children:"Map Options"}),ee.jsx(dV,{}),ee.jsx(h5,{onChange:(c,o)=>a(Number(o)),children:ee.jsxs(xae,{tabFlex:1,sx:{borderRadius:0},children:[ee.jsx(SE,{children:"Icons"}),ee.jsx(SE,{children:"ATS DLC"}),ee.jsx(SE,{children:"Advanced"})]})}),ee.jsx(iV,{sx:{overflowX:"hidden"},children:ee.jsxs(h5,{value:i,children:[ee.jsx(ME,{sx:{p:0},value:0,children:ee.jsx(q4,{items:G4,selectedItems:e.icons.selectedItems,onItemToggle:e.icons.onItemToggle,icon:c=>ee.jsx("img",{style:{marginLeft:-3},width:32,height:32,src:`map-icons/${c9[c].iconName}.png`})})}),ee.jsx(ME,{sx:{p:0},value:1,children:ee.jsx(q4,{items:W4,selectedItems:e.atsDlcs.selectedItems,onItemToggle:e.atsDlcs.onItemToggle})}),ee.jsx(ME,{sx:{p:0},value:2,children:ee.jsx(hye,{showContours:e.advanced.showContours,onContoursToggle:e.advanced.onContoursToggle,showPhotoSpheresUi:e.advanced.showPhotoSpheresUi,onPhotoSpheresToggleUi:e.advanced.onPhotoSpheresToggleUi})})]})}),ee.jsx(a_,{}),i===0&&ee.jsx(lye,{enableAutoHiding:e.icons.enableAutoHiding,enableSelectAll:e.icons.selectedItems.size===G4.size,onAutoHidingToggle:e.icons.onAutoHidingToggle,onSelectAllToggle:e.icons.onSelectAllToggle}),i===1&&ee.jsx(uye,{enableSelectAll:e.atsDlcs.selectedItems.size===W4.size,onSelectAllToggle:e.atsDlcs.onSelectAllToggle})]})})]})},lye=$.memo(e=>ee.jsxs(Ga,{direction:"row",justifyContent:"space-between",gap:1,mx:2,children:[ee.jsx(gV,{enterDelay:500,title:"Enable to hide icons based on zoom and nearby icons. Disable to always show icons.",children:ee.jsx(Of,{label:"Enable icon hiding",checked:e.enableAutoHiding,onChange:t=>{var n;return(n=e.onAutoHidingToggle)==null?void 0:n.call(e,t.target.checked)}})}),ee.jsx(Of,{sx:{flexDirection:"row-reverse",flexShrink:0},label:"Select all",checked:e.enableSelectAll,onChange:t=>{var n;return(n=e.onSelectAllToggle)==null?void 0:n.call(e,t.target.checked)}})]})),cye=e=>ee.jsx(DM,{size:"lg",sx:{p:0,[`& .${Ef.root}`]:{flexGrow:1,alignItems:"center",flexDirection:"row-reverse"}},children:[...e.items.entries()].map(([t,n])=>{var r;return ee.jsxs(rd,{children:[(r=e.icon)==null?void 0:r.call(e,t),ee.jsx(Of,{overlay:!0,label:n,checked:e.selectedItems.has(t),onChange:i=>e.onItemToggle(t,i.target.checked)})]},String(t))})}),q4=$.memo(cye),uye=$.memo(e=>ee.jsx(Ga,{direction:"row",justifyContent:"end",gap:1,mx:2,children:ee.jsx(Of,{sx:{flexDirection:"row-reverse",flexShrink:0},label:"Select all",checked:e.enableSelectAll,onChange:t=>{var n;return(n=e.onSelectAllToggle)==null?void 0:n.call(e,t.target.checked)}})})),hye=e=>ee.jsxs(Ga,{mx:2,children:[ee.jsx(oi,{mb:2,level:"title-lg",children:"Experimental Features"}),ee.jsxs(Ga,{gap:2,children:[ee.jsxs(MA,{children:[ee.jsx(Of,{sx:{flexDirection:"row-reverse"},label:"Show elevation data",checked:e.showContours,onChange:t=>e.onContoursToggle(t.target.checked)}),ee.jsx(oi,{level:"body-xs",color:"warning",children:"Note: elevation data for points further away from roads is estimated and likely inaccurate."})]}),ee.jsxs(MA,{children:[ee.jsx(Of,{sx:{flexDirection:"row-reverse"},label:"Show Photo Spheres button",checked:e.showPhotoSpheresUi,onChange:t=>e.onPhotoSpheresToggleUi(t.target.checked)}),ee.jsxs(oi,{level:"body-xs",color:"neutral",children:["Shows a ",ee.jsx(Dj,{style:{position:"relative",top:"0.25em"}})," ","button in the upper-right of the app."]}),ee.jsx(oi,{level:"body-xs",color:"warning",children:"Note: the positions of Photo Spheres were determined with  heuristics. The landmarks they're meant to capture aren't always in view."})]})]})]}),h9=()=>{const e=$.useRef(null),{mode:t="light",setMode:n}=FR();return rl(()=>({onAdd:()=>Qn(e.current),onRemove:()=>Qn(e.current).remove()})),ee.jsx("div",{ref:e,className:"maplibregl-ctrl maplibregl-ctrl-group",children:ee.jsxs(DJ,{children:[ee.jsx(bse,{slots:{root:fu},sx:{minWidth:0,minHeight:0,borderRadius:0},title:"Set map theme",children:ee.jsx(Xfe,{})}),ee.jsxs(hV,{placement:"left",children:[ee.jsx(rd,{sticky:!0,children:ee.jsx(oi,{m:1,level:"body-xs",textTransform:"uppercase",fontWeight:"lg",children:"Map theme"})}),ee.jsxs(_f,{onClick:()=>n("light"),selected:t==="light",children:[ee.jsx(tg,{children:ee.jsx(Yfe,{})})," ","Light"]}),ee.jsxs(_f,{onClick:()=>n("dark"),selected:t==="dark",children:[ee.jsx(tg,{children:ee.jsx(Kfe,{})})," ","Dark"]}),ee.jsxs(_f,{onClick:()=>n("system"),selected:t==="system",children:[ee.jsx(tg,{children:ee.jsx(Zfe,{})})," ","Auto"]})]})]})})};function dye(e,t,n){let r=n.get(e);return r==null&&(r=t,n.set(e,r)),r}const X4=e=>{const{map:t,selectDecorator:n,onSelect:r}=e,[i,a]=$.useState([]);$.useEffect(()=>{const f=t==="usa"?"ats":"ets2";Promise.all([fetch(`${f}-achievements.json`).then(g=>g.json()),fetch(`${f}-achievements.geojson`).then(g=>g.json())]).then(([g,_])=>{const x=new Map;for(const C of _.features)dye(C.properties.name,[],x).push({coordinates:C.geometry.coordinates,dlcGuard:C.properties.dlcGuard});const M=new Set(_.features.map(C=>C.properties.name));a([...g.data.filter(C=>M.has(C.id)).map(C=>({...C,label:C.title,value:C.id,features:Qn(x.get(C.id))})).sort((C,A)=>C.label.localeCompare(A.label))])},()=>console.error("could not load achievements json."))},[t]);const c=i.filter(f=>{if(t==="europe")return!0;const g=K_(e.visibleStateDlcs);return f.features.some(_=>g.has(_.dlcGuard))}),o=z8({stringify:f=>[f.label,f.desc].join(" ")});return ee.jsx(iS,{onChange:(f,g)=>r(g),placeholder:"Search achievements...",options:c,filterOptions:o,blurOnSelect:!0,autoComplete:!0,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n,renderOption:(f,g)=>$.createElement(J8,{...f,key:g.value},ee.jsx(tg,{sx:{border:"2px solid var(--joy-palette-neutral-outlinedBorder)",borderRadius:6,overflow:"hidden",minWidth:"fit-content",mr:.5},children:ee.jsx("img",{loading:"lazy",width:"48",height:"48",src:g.imgUrl,alt:""})}),ee.jsxs(l_,{children:[ee.jsx(oi,{level:"title-md",children:g.label}),ee.jsx(oi,{level:"body-xs",children:g.desc})]}))},t)};function mu(e){return Array.isArray?Array.isArray(e):p9(e)==="[object Array]"}const fye=1/0;function pye(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-fye?"-0":t}function mye(e){return e==null?"":pye(e)}function dc(e){return typeof e=="string"}function d9(e){return typeof e=="number"}function gye(e){return e===!0||e===!1||vye(e)&&p9(e)=="[object Boolean]"}function f9(e){return typeof e=="object"}function vye(e){return f9(e)&&e!==null}function fa(e){return e!=null}function UE(e){return!e.trim().length}function p9(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const yye="Incorrect 'index' type",_ye=e=>`Invalid value for key ${e}`,xye=e=>`Pattern length exceeds max of ${e}.`,bye=e=>`Missing ${e} property in key`,wye=e=>`Property 'weight' in key '${e}' must be a positive integer`,Z4=Object.prototype.hasOwnProperty;class Sye{constructor(t){this._keys=[],this._keyMap={};let n=0;t.forEach(r=>{let i=m9(r);this._keys.push(i),this._keyMap[i.id]=i,n+=i.weight}),this._keys.forEach(r=>{r.weight/=n})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function m9(e){let t=null,n=null,r=null,i=1,a=null;if(dc(e)||mu(e))r=e,t=Y4(e),n=WA(e);else{if(!Z4.call(e,"name"))throw new Error(bye("name"));const c=e.name;if(r=c,Z4.call(e,"weight")&&(i=e.weight,i<=0))throw new Error(wye(c));t=Y4(c),n=WA(c),a=e.getFn}return{path:t,id:n,weight:i,src:r,getFn:a}}function Y4(e){return mu(e)?e:e.split(".")}function WA(e){return mu(e)?e.join("."):e}function Mye(e,t){let n=[],r=!1;const i=(a,c,o)=>{if(fa(a))if(!c[o])n.push(a);else{let f=c[o];const g=a[f];if(!fa(g))return;if(o===c.length-1&&(dc(g)||d9(g)||gye(g)))n.push(mye(g));else if(mu(g)){r=!0;for(let _=0,x=g.length;_<x;_+=1)i(g[_],c,o+1)}else c.length&&i(g,c,o+1)}};return i(e,dc(t)?t.split("."):t,0),r?n:n[0]}const Cye={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Eye={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},Tye={location:0,threshold:.6,distance:100},Pye={useExtendedSearch:!1,getFn:Mye,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var qn={...Eye,...Cye,...Tye,...Pye};const Aye=/[^ ]+/g;function Iye(e=1,t=3){const n=new Map,r=Math.pow(10,t);return{get(i){const a=i.match(Aye).length;if(n.has(a))return n.get(a);const c=1/Math.pow(a,.5*e),o=parseFloat(Math.round(c*r)/r);return n.set(a,o),o},clear(){n.clear()}}}class CL{constructor({getFn:t=qn.getFn,fieldNormWeight:n=qn.fieldNormWeight}={}){this.norm=Iye(n,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,dc(this.docs[0])?this.docs.forEach((t,n)=>{this._addString(t,n)}):this.docs.forEach((t,n)=>{this._addObject(t,n)}),this.norm.clear())}add(t){const n=this.size();dc(t)?this._addString(t,n):this._addObject(t,n)}removeAt(t){this.records.splice(t,1);for(let n=t,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(t,n){return t[this._keysMap[n]]}size(){return this.records.length}_addString(t,n){if(!fa(t)||UE(t))return;let r={v:t,i:n,n:this.norm.get(t)};this.records.push(r)}_addObject(t,n){let r={i:n,$:{}};this.keys.forEach((i,a)=>{let c=i.getFn?i.getFn(t):this.getFn(t,i.path);if(fa(c)){if(mu(c)){let o=[];const f=[{nestedArrIndex:-1,value:c}];for(;f.length;){const{nestedArrIndex:g,value:_}=f.pop();if(fa(_))if(dc(_)&&!UE(_)){let x={v:_,i:g,n:this.norm.get(_)};o.push(x)}else mu(_)&&_.forEach((x,M)=>{f.push({nestedArrIndex:M,value:x})})}r.$[a]=o}else if(dc(c)&&!UE(c)){let o={v:c,n:this.norm.get(c)};r.$[a]=o}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function g9(e,t,{getFn:n=qn.getFn,fieldNormWeight:r=qn.fieldNormWeight}={}){const i=new CL({getFn:n,fieldNormWeight:r});return i.setKeys(e.map(m9)),i.setSources(t),i.create(),i}function Rye(e,{getFn:t=qn.getFn,fieldNormWeight:n=qn.fieldNormWeight}={}){const{keys:r,records:i}=e,a=new CL({getFn:t,fieldNormWeight:n});return a.setKeys(r),a.setIndexRecords(i),a}function tb(e,{errors:t=0,currentLocation:n=0,expectedLocation:r=0,distance:i=qn.distance,ignoreLocation:a=qn.ignoreLocation}={}){const c=t/e.length;if(a)return c;const o=Math.abs(r-n);return i?c+o/i:o?1:c}function Lye(e=[],t=qn.minMatchCharLength){let n=[],r=-1,i=-1,a=0;for(let c=e.length;a<c;a+=1){let o=e[a];o&&r===-1?r=a:!o&&r!==-1&&(i=a-1,i-r+1>=t&&n.push([r,i]),r=-1)}return e[a-1]&&a-r>=t&&n.push([r,a-1]),n}const ff=32;function kye(e,t,n,{location:r=qn.location,distance:i=qn.distance,threshold:a=qn.threshold,findAllMatches:c=qn.findAllMatches,minMatchCharLength:o=qn.minMatchCharLength,includeMatches:f=qn.includeMatches,ignoreLocation:g=qn.ignoreLocation}={}){if(t.length>ff)throw new Error(xye(ff));const _=t.length,x=e.length,M=Math.max(0,Math.min(r,x));let C=a,A=M;const L=o>1||f,I=L?Array(x):[];let T;for(;(T=e.indexOf(t,A))>-1;){let q=tb(t,{currentLocation:T,expectedLocation:M,distance:i,ignoreLocation:g});if(C=Math.min(q,C),A=T+_,L){let J=0;for(;J<_;)I[T+J]=1,J+=1}}A=-1;let z=[],k=1,U=_+x;const H=1<<_-1;for(let q=0;q<_;q+=1){let J=0,Y=U;for(;J<Y;)tb(t,{errors:q,currentLocation:M+Y,expectedLocation:M,distance:i,ignoreLocation:g})<=C?J=Y:U=Y,Y=Math.floor((U-J)/2+J);U=Y;let N=Math.max(1,M-Y+1),ne=c?x:Math.min(M+Y,x)+_,ye=Array(ne+2);ye[ne+1]=(1<<q)-1;for(let Ne=ne;Ne>=N;Ne-=1){let Ae=Ne-1,ve=n[e.charAt(Ae)];if(L&&(I[Ae]=+!!ve),ye[Ne]=(ye[Ne+1]<<1|1)&ve,q&&(ye[Ne]|=(z[Ne+1]|z[Ne])<<1|1|z[Ne+1]),ye[Ne]&H&&(k=tb(t,{errors:q,currentLocation:Ae,expectedLocation:M,distance:i,ignoreLocation:g}),k<=C)){if(C=k,A=Ae,A<=M)break;N=Math.max(1,2*M-A)}}if(tb(t,{errors:q+1,currentLocation:M,expectedLocation:M,distance:i,ignoreLocation:g})>C)break;z=ye}const V={isMatch:A>=0,score:Math.max(.001,k)};if(L){const q=Lye(I,o);q.length?f&&(V.indices=q):V.isMatch=!1}return V}function Dye(e){let t={};for(let n=0,r=e.length;n<r;n+=1){const i=e.charAt(n);t[i]=(t[i]||0)|1<<r-n-1}return t}const xS=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class v9{constructor(t,{location:n=qn.location,threshold:r=qn.threshold,distance:i=qn.distance,includeMatches:a=qn.includeMatches,findAllMatches:c=qn.findAllMatches,minMatchCharLength:o=qn.minMatchCharLength,isCaseSensitive:f=qn.isCaseSensitive,ignoreDiacritics:g=qn.ignoreDiacritics,ignoreLocation:_=qn.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:i,includeMatches:a,findAllMatches:c,minMatchCharLength:o,isCaseSensitive:f,ignoreDiacritics:g,ignoreLocation:_},t=f?t:t.toLowerCase(),t=g?xS(t):t,this.pattern=t,this.chunks=[],!this.pattern.length)return;const x=(C,A)=>{this.chunks.push({pattern:C,alphabet:Dye(C),startIndex:A})},M=this.pattern.length;if(M>ff){let C=0;const A=M%ff,L=M-A;for(;C<L;)x(this.pattern.substr(C,ff),C),C+=ff;if(A){const I=M-ff;x(this.pattern.substr(I),I)}}else x(this.pattern,0)}searchIn(t){const{isCaseSensitive:n,ignoreDiacritics:r,includeMatches:i}=this.options;if(t=n?t:t.toLowerCase(),t=r?xS(t):t,this.pattern===t){let L={isMatch:!0,score:0};return i&&(L.indices=[[0,t.length-1]]),L}const{location:a,distance:c,threshold:o,findAllMatches:f,minMatchCharLength:g,ignoreLocation:_}=this.options;let x=[],M=0,C=!1;this.chunks.forEach(({pattern:L,alphabet:I,startIndex:T})=>{const{isMatch:z,score:k,indices:U}=kye(t,L,I,{location:a+T,distance:c,threshold:o,findAllMatches:f,minMatchCharLength:g,includeMatches:i,ignoreLocation:_});z&&(C=!0),M+=k,z&&U&&(x=[...x,...U])});let A={isMatch:C,score:C?M/this.chunks.length:1};return C&&i&&(A.indices=x),A}}class ad{constructor(t){this.pattern=t}static isMultiMatch(t){return K4(t,this.multiRegex)}static isSingleMatch(t){return K4(t,this.singleRegex)}search(){}}function K4(e,t){const n=e.match(t);return n?n[1]:null}class zye extends ad{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const n=t===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class Oye extends ad{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const r=t.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class Fye extends ad{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const n=t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class Nye extends ad{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const n=!t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class Bye extends ad{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const n=t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class Uye extends ad{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const n=!t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class y9 extends ad{constructor(t,{location:n=qn.location,threshold:r=qn.threshold,distance:i=qn.distance,includeMatches:a=qn.includeMatches,findAllMatches:c=qn.findAllMatches,minMatchCharLength:o=qn.minMatchCharLength,isCaseSensitive:f=qn.isCaseSensitive,ignoreDiacritics:g=qn.ignoreDiacritics,ignoreLocation:_=qn.ignoreLocation}={}){super(t),this._bitapSearch=new v9(t,{location:n,threshold:r,distance:i,includeMatches:a,findAllMatches:c,minMatchCharLength:o,isCaseSensitive:f,ignoreDiacritics:g,ignoreLocation:_})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class _9 extends ad{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let n=0,r;const i=[],a=this.pattern.length;for(;(r=t.indexOf(this.pattern,n))>-1;)n=r+a,i.push([r,n-1]);const c=!!i.length;return{isMatch:c,score:c?0:1,indices:i}}}const qA=[zye,_9,Fye,Nye,Uye,Bye,Oye,y9],J4=qA.length,$ye=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Vye="|";function jye(e,t={}){return e.split(Vye).map(n=>{let r=n.trim().split($ye).filter(a=>a&&!!a.trim()),i=[];for(let a=0,c=r.length;a<c;a+=1){const o=r[a];let f=!1,g=-1;for(;!f&&++g<J4;){const _=qA[g];let x=_.isMultiMatch(o);x&&(i.push(new _(x,t)),f=!0)}if(!f)for(g=-1;++g<J4;){const _=qA[g];let x=_.isSingleMatch(o);if(x){i.push(new _(x,t));break}}}return i})}const Hye=new Set([y9.type,_9.type]);class Gye{constructor(t,{isCaseSensitive:n=qn.isCaseSensitive,ignoreDiacritics:r=qn.ignoreDiacritics,includeMatches:i=qn.includeMatches,minMatchCharLength:a=qn.minMatchCharLength,ignoreLocation:c=qn.ignoreLocation,findAllMatches:o=qn.findAllMatches,location:f=qn.location,threshold:g=qn.threshold,distance:_=qn.distance}={}){this.query=null,this.options={isCaseSensitive:n,ignoreDiacritics:r,includeMatches:i,minMatchCharLength:a,findAllMatches:o,ignoreLocation:c,location:f,threshold:g,distance:_},t=n?t:t.toLowerCase(),t=r?xS(t):t,this.pattern=t,this.query=jye(this.pattern,this.options)}static condition(t,n){return n.useExtendedSearch}searchIn(t){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:i,ignoreDiacritics:a}=this.options;t=i?t:t.toLowerCase(),t=a?xS(t):t;let c=0,o=[],f=0;for(let g=0,_=n.length;g<_;g+=1){const x=n[g];o.length=0,c=0;for(let M=0,C=x.length;M<C;M+=1){const A=x[M],{isMatch:L,indices:I,score:T}=A.search(t);if(L){if(c+=1,f+=T,r){const z=A.constructor.type;Hye.has(z)?o=[...o,...I]:o.push(I)}}else{f=0,c=0,o.length=0;break}}if(c){let M={isMatch:!0,score:f/c};return r&&(M.indices=o),M}}return{isMatch:!1,score:1}}}const XA=[];function Wye(...e){XA.push(...e)}function ZA(e,t){for(let n=0,r=XA.length;n<r;n+=1){let i=XA[n];if(i.condition(e,t))return new i(e,t)}return new v9(e,t)}const bS={AND:"$and",OR:"$or"},YA={PATH:"$path",PATTERN:"$val"},KA=e=>!!(e[bS.AND]||e[bS.OR]),qye=e=>!!e[YA.PATH],Xye=e=>!mu(e)&&f9(e)&&!KA(e),Q4=e=>({[bS.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function x9(e,t,{auto:n=!0}={}){const r=i=>{let a=Object.keys(i);const c=qye(i);if(!c&&a.length>1&&!KA(i))return r(Q4(i));if(Xye(i)){const f=c?i[YA.PATH]:a[0],g=c?i[YA.PATTERN]:i[f];if(!dc(g))throw new Error(_ye(f));const _={keyId:WA(f),pattern:g};return n&&(_.searcher=ZA(g,t)),_}let o={children:[],operator:a[0]};return a.forEach(f=>{const g=i[f];mu(g)&&g.forEach(_=>{o.children.push(r(_))})}),o};return KA(e)||(e=Q4(e)),r(e)}function Zye(e,{ignoreFieldNorm:t=qn.ignoreFieldNorm}){e.forEach(n=>{let r=1;n.matches.forEach(({key:i,norm:a,score:c})=>{const o=i?i.weight:null;r*=Math.pow(c===0&&o?Number.EPSILON:c,(o||1)*(t?1:a))}),n.score=r})}function Yye(e,t){const n=e.matches;t.matches=[],fa(n)&&n.forEach(r=>{if(!fa(r.indices)||!r.indices.length)return;const{indices:i,value:a}=r;let c={indices:i,value:a};r.key&&(c.key=r.key.src),r.idx>-1&&(c.refIndex=r.idx),t.matches.push(c)})}function Kye(e,t){t.score=e.score}function Jye(e,t,{includeMatches:n=qn.includeMatches,includeScore:r=qn.includeScore}={}){const i=[];return n&&i.push(Yye),r&&i.push(Kye),e.map(a=>{const{idx:c}=a,o={item:t[c],refIndex:c};return i.length&&i.forEach(f=>{f(a,o)}),o})}class Wg{constructor(t,n={},r){this.options={...qn,...n},this.options.useExtendedSearch,this._keyStore=new Sye(this.options.keys),this.setCollection(t,r)}setCollection(t,n){if(this._docs=t,n&&!(n instanceof CL))throw new Error(yye);this._myIndex=n||g9(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){fa(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const n=[];for(let r=0,i=this._docs.length;r<i;r+=1){const a=this._docs[r];t(a,r)&&(this.removeAt(r),r-=1,i-=1,n.push(a))}return n}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:n=-1}={}){const{includeMatches:r,includeScore:i,shouldSort:a,sortFn:c,ignoreFieldNorm:o}=this.options;let f=dc(t)?dc(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return Zye(f,{ignoreFieldNorm:o}),a&&f.sort(c),d9(n)&&n>-1&&(f=f.slice(0,n)),Jye(f,this._docs,{includeMatches:r,includeScore:i})}_searchStringList(t){const n=ZA(t,this.options),{records:r}=this._myIndex,i=[];return r.forEach(({v:a,i:c,n:o})=>{if(!fa(a))return;const{isMatch:f,score:g,indices:_}=n.searchIn(a);f&&i.push({item:a,idx:c,matches:[{score:g,value:a,norm:o,indices:_}]})}),i}_searchLogical(t){const n=x9(t,this.options),r=(o,f,g)=>{if(!o.children){const{keyId:x,searcher:M}=o,C=this._findMatches({key:this._keyStore.get(x),value:this._myIndex.getValueForItemAtKeyId(f,x),searcher:M});return C&&C.length?[{idx:g,item:f,matches:C}]:[]}const _=[];for(let x=0,M=o.children.length;x<M;x+=1){const C=o.children[x],A=r(C,f,g);if(A.length)_.push(...A);else if(o.operator===bS.AND)return[]}return _},i=this._myIndex.records,a={},c=[];return i.forEach(({$:o,i:f})=>{if(fa(o)){let g=r(n,o,f);g.length&&(a[f]||(a[f]={idx:f,item:o,matches:[]},c.push(a[f])),g.forEach(({matches:_})=>{a[f].matches.push(..._)}))}}),c}_searchObjectList(t){const n=ZA(t,this.options),{keys:r,records:i}=this._myIndex,a=[];return i.forEach(({$:c,i:o})=>{if(!fa(c))return;let f=[];r.forEach((g,_)=>{f.push(...this._findMatches({key:g,value:c[_],searcher:n}))}),f.length&&a.push({idx:o,item:c,matches:f})}),a}_findMatches({key:t,value:n,searcher:r}){if(!fa(n))return[];let i=[];if(mu(n))n.forEach(({v:a,i:c,n:o})=>{if(!fa(a))return;const{isMatch:f,score:g,indices:_}=r.searchIn(a);f&&i.push({score:g,key:t,value:a,idx:c,norm:o,indices:_})});else{const{v:a,n:c}=n,{isMatch:o,score:f,indices:g}=r.searchIn(a);o&&i.push({score:f,key:t,value:a,norm:c,indices:g})}return i}}Wg.version="7.1.0";Wg.createIndex=g9;Wg.parseIndex=Rye;Wg.config=qn;Wg.parseQuery=x9;Wye(Gye);const eF=100,Qye=e=>e.match(/("[^"]*?"|[^"\s]+)+(?=\s*|\s*$)/g)??[],tF=e=>{const{map:t,selectDecorator:n,onSelect:r}=e,[i,a]=$.useState({}),[c,o]=$.useState(null),[f,g]=$.useState([]),[_,x]=$.useState(null),[M,C]=$.useState(0),A=I=>setTimeout(()=>C(I),0);$.useEffect(()=>{fetch("sprites@2x.json").then(I=>I.json()).then(I=>a(I),I=>console.error("could not load sprites json",I))},[]),$.useEffect(()=>{fetch(`${t==="usa"?"ats":"ets2"}-search.geojson`).then(T=>T.json()).then(T=>{let z;if(t==="usa"){const H=K_(e.visibleStateDlcs);z=V=>H.has(V.properties.dlcGuard)}else z=()=>!0;const k=T.features.filter(z),U=new Wg(k,{distance:0,threshold:.2,findAllMatches:!0,ignoreLocation:!0,sortFn:i_e,keys:[{name:"properties.label",weight:3},{name:"properties.city.name",weight:2},{name:"properties.stateName",weight:1.5},"properties.stateCode","properties.tags"]});o(U),g(k.map((H,V)=>({type:"poi",id:V.toString(),label:H.properties.label,poi:H})))},T=>console.error("could not load search json.",T))},[t,t==="usa"?e.visibleStateDlcs:null]);const L=(I,{inputValue:T})=>{if(Pg.checkState(c!=null),T.length<3)if(_!=null)typeof _=="string"?T=_:T=_.label;else return A(0),[];const z=Qye(T);if(!z.length)return console.warn("empty tokens for search input:",T),A(0),[];const k=c.search({$and:z.map(U=>({$or:[{"properties.label":U},{"properties.city.name":U},{"properties.stateName":U},{"properties.stateCode":U},{"properties.tags":U}]}))});return A(k.length),k.slice(0,eF).map(U=>I[U.refIndex])};return ee.jsx(iS,{onChange:(I,T)=>{if(T==null)x(null),r(null);else if(typeof T=="string")x(T);else if(T&&T.type==="poi")C(1),x(T),r(T);else if(T)throw new Error("suggestions not yet supported")},onInputChange:(I,T,z)=>{z!=="reset"&&x(null)},placeholder:"Search cities, companies, points of interest...",options:f,filterOptions:L,getOptionLabel:n_e,blurOnSelect:!0,handleHomeEndKeys:!0,freeSolo:!0,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n,endDecorator:ee.jsx(e_e,{maxResults:eF,numSearchResults:M}),renderOption:(I,T)=>$.createElement(J8,{...I,key:T.id},ee.jsx(t_e,{option:T,sprites:i}))},t)},e_e=({numSearchResults:e,maxResults:t})=>e>t?ee.jsx(gV,{title:`Showing first ${t} of ${e} results, only. Try adding more terms to narrow your search.`,children:ee.jsx(Qfe,{color:"warning",sx:{width:"0.8em"}})}):null,t_e=$.memo(({option:e,sprites:t})=>ee.jsxs(ee.Fragment,{children:[ee.jsx(tg,{sx:{display:"flex",justifyContent:"center",mx:0},children:ee.jsx(nF,{option:e,sprites:t})}),ee.jsx(r_e,{option:e}),ee.jsx(tg,{children:e.type==="poi"&&e.poi.properties.type==="company"?ee.jsx(nF,{option:e,sprites:t,position:"end"}):null})]})),nF=({option:e,sprites:t,position:n})=>{if(e.type==="suggestion")return null;if(e.poi.properties.type==="city")return ee.jsx(rpe,{});if(e.poi.properties.type==="scenery")return ee.jsx(epe,{});let r;switch(e.poi.properties.type){case"company":if(!n)return ee.jsx(ipe,{});r=e.poi.properties.sprite;break;case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":r=e.poi.properties.sprite;break;default:throw new zl(e.poi.properties.type)}const i=Qn(t[r]);return ee.jsx(eoe,{sx:{width:i.width+"px",height:i.height+"px",background:`url(sprites.png) -${i.x}px -${i.y}px`,transform:"scale(0.70)"}})};function n_e(e){if(typeof e=="string")return e;if(e.type==="suggestion")return"suggestion";const t=e.poi.properties;switch(t.type){case"city":case"scenery":return`${e.label}, ${t.stateCode}`;case"company":case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":{const n=b9(t.label,t.city);switch(n){case 0:return`${e.label} in ${t.city.name}, ${t.stateCode}`;case 1:return`${e.label} near ${t.city.name}, ${t.stateCode}`;case 2:return`${e.label} in ${t.stateName}`;default:throw new zl(n)}}default:throw new zl(t)}}const r_e=({option:e})=>{if(e.type==="suggestion")return"suggestion";const t=e.poi.properties;switch(t.type){case"city":case"scenery":return ee.jsxs(l_,{children:[e.label,", ",t.stateCode]});case"company":case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":{let n;const r=b9(t.label,t.city);switch(r){case 0:n=`${t.city.name}, ${t.stateCode}`;break;case 1:n=`near ${t.city.name}, ${t.stateCode}`;break;case 2:n=`${t.stateName}`;break;default:throw new zl(r)}return ee.jsxs(l_,{children:[ee.jsx(oi,{children:e.label}),ee.jsx(oi,{level:"body-sm",children:n})]})}default:throw new zl(t)}};function b9(e,t){return t.distance<=250||e.startsWith(t.name)||e.endsWith(t.name)?0:t.distance<=1e3?1:2}const rF={company:0,city:1,scenery:1,landmark:2,viewpoint:3,dealer:4,ferry:5,train:6};function i_e(e,t){if(e.score!==t.score)return e.score-t.score;const n=e.item[1],r=t.item[1];if(n&&r)return n.v.localeCompare(r.v);if(n&&!r)return 1;if(!n&&r)return-1;const i=e.item[4],a=t.item[4];if(!Array.isArray(i)||!Array.isArray(a))throw new Error("unexpected non-arrays at key 5");const c=Qn(i.find(_=>_.i===0)).v,o=Qn(a.find(_=>_.i===0)).v;if(c!==o)return rF[c]-rF[o];const f=e.item[0],g=t.item[0];return f.v.localeCompare(g.v)}var iF=Object.prototype.toString,w9=function(t){var n=iF.call(t),r=n==="[object Arguments]";return r||(r=n!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&iF.call(t.callee)==="[object Function]"),r},$E,oF;function o_e(){if(oF)return $E;oF=1;var e;if(!Object.keys){var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=w9,i=Object.prototype.propertyIsEnumerable,a=!i.call({toString:null},"toString"),c=i.call(function(){},"prototype"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(M){var C=M.constructor;return C&&C.prototype===M},g={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},_=function(){if(typeof window>"u")return!1;for(var M in window)try{if(!g["$"+M]&&t.call(window,M)&&window[M]!==null&&typeof window[M]=="object")try{f(window[M])}catch{return!0}}catch{return!0}return!1}(),x=function(M){if(typeof window>"u"||!_)return f(M);try{return f(M)}catch{return!1}};e=function(C){var A=C!==null&&typeof C=="object",L=n.call(C)==="[object Function]",I=r(C),T=A&&n.call(C)==="[object String]",z=[];if(!A&&!L&&!I)throw new TypeError("Object.keys called on a non-object");var k=c&&L;if(T&&C.length>0&&!t.call(C,0))for(var U=0;U<C.length;++U)z.push(String(U));if(I&&C.length>0)for(var H=0;H<C.length;++H)z.push(String(H));else for(var V in C)!(k&&V==="prototype")&&t.call(C,V)&&z.push(String(V));if(a)for(var q=x(C),J=0;J<o.length;++J)!(q&&o[J]==="constructor")&&t.call(C,o[J])&&z.push(o[J]);return z}}return $E=e,$E}var s_e=Array.prototype.slice,a_e=w9,sF=Object.keys,uw=sF?function(t){return sF(t)}:o_e(),aF=Object.keys;uw.shim=function(){if(Object.keys){var t=function(){var n=Object.keys(arguments);return n&&n.length===arguments.length}(1,2);t||(Object.keys=function(r){return a_e(r)?aF(s_e.call(r)):aF(r)})}else Object.keys=uw;return Object.keys||uw};var l_e=uw,hw=Object.defineProperty||!1;if(hw)try{hw({},"a",{value:1})}catch{hw=!1}var ox=hw,ld=SyntaxError,ir=TypeError,c_e=Object.getOwnPropertyDescriptor,dw=c_e;if(dw)try{dw([],"length")}catch{dw=null}var qg=dw,lF=ox,u_e=ld,Kp=ir,cF=qg,S9=function(t,n,r){if(!t||typeof t!="object"&&typeof t!="function")throw new Kp("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new Kp("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Kp("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Kp("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Kp("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Kp("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,a=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,o=arguments.length>6?arguments[6]:!1,f=!!cF&&cF(t,n);if(lF)lF(t,n,{configurable:c===null&&f?f.configurable:!c,enumerable:i===null&&f?f.enumerable:!i,value:r,writable:a===null&&f?f.writable:!a});else if(o||!i&&!a&&!c)t[n]=r;else throw new u_e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},JA=ox,M9=function(){return!!JA};M9.hasArrayLengthDefineBug=function(){if(!JA)return null;try{return JA([],"length",{value:1}).length!==1}catch{return!0}};var EL=M9,h_e=l_e,d_e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",f_e=Object.prototype.toString,p_e=Array.prototype.concat,uF=S9,m_e=function(e){return typeof e=="function"&&f_e.call(e)==="[object Function]"},C9=EL(),g_e=function(e,t,n,r){if(t in e){if(r===!0){if(e[t]===n)return}else if(!m_e(r)||!r())return}C9?uF(e,t,n,!0):uF(e,t,n)},E9=function(e,t){var n=arguments.length>2?arguments[2]:{},r=h_e(t);d_e&&(r=p_e.call(r,Object.getOwnPropertySymbols(t)));for(var i=0;i<r.length;i+=1)g_e(e,r[i],t[r[i]],n[r[i]])};E9.supportsDescriptors=!!C9;var T9=E9,P9={exports:{}},v_e=Object,y_e=Error,__e=EvalError,x_e=RangeError,b_e=ReferenceError,w_e=URIError,A9=Math.abs,I9=Math.floor,S_e=Math.max,M_e=Math.min,C_e=Math.pow,VE,hF;function R9(){return hF||(hF=1,VE=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;t[n]=i;for(var a in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var c=Object.getOwnPropertySymbols(t);if(c.length!==1||c[0]!==n||!Object.prototype.propertyIsEnumerable.call(t,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,n);if(o.value!==i||o.enumerable!==!0)return!1}return!0}),VE}var jE,dF;function h2(){if(dF)return jE;dF=1;var e=typeof Symbol<"u"&&Symbol,t=R9();return jE=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},jE}var E_e="Function.prototype.bind called on incompatible ",T_e=Object.prototype.toString,P_e=Math.max,A_e="[object Function]",fF=function(t,n){for(var r=[],i=0;i<t.length;i+=1)r[i]=t[i];for(var a=0;a<n.length;a+=1)r[a+t.length]=n[a];return r},I_e=function(t,n){for(var r=[],i=n,a=0;i<t.length;i+=1,a+=1)r[a]=t[i];return r},R_e=function(e,t){for(var n="",r=0;r<e.length;r+=1)n+=e[r],r+1<e.length&&(n+=t);return n},L_e=function(t){var n=this;if(typeof n!="function"||T_e.apply(n)!==A_e)throw new TypeError(E_e+n);for(var r=I_e(arguments,1),i,a=function(){if(this instanceof i){var _=n.apply(this,fF(r,arguments));return Object(_)===_?_:this}return n.apply(t,fF(r,arguments))},c=P_e(0,n.length-r.length),o=[],f=0;f<c;f++)o[f]="$"+f;if(i=Function("binder","return function ("+R_e(o,",")+"){ return binder.apply(this,arguments); }")(a),n.prototype){var g=function(){};g.prototype=n.prototype,i.prototype=new g,g.prototype=null}return i},k_e=L_e,sx=Function.prototype.bind||k_e,TL=Function.prototype.call,PL=Function.prototype.apply,D_e=typeof Reflect<"u"&&Reflect&&Reflect.apply,z_e=sx,O_e=PL,F_e=TL,N_e=D_e,L9=N_e||z_e.call(F_e,O_e),B_e=sx,U_e=ir,$_e=TL,V_e=L9,AL=function(t){if(t.length<1||typeof t[0]!="function")throw new U_e("a function is required");return V_e(B_e,$_e,t)},HE,pF;function j_e(){if(pF)return HE;pF=1;var e=AL,t=qg,n;try{n=[].__proto__===Array.prototype}catch(c){if(!c||typeof c!="object"||!("code"in c)||c.code!=="ERR_PROTO_ACCESS")throw c}var r=!!n&&t&&t(Object.prototype,"__proto__"),i=Object,a=i.getPrototypeOf;return HE=r&&typeof r.get=="function"?e([r.get]):typeof a=="function"?function(o){return a(o==null?o:i(o))}:!1,HE}var GE,mF;function Su(){if(mF)return GE;mF=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,n=sx;return GE=n.call(e,t),GE}var _r,k9=v_e,H_e=y_e,G_e=__e,W_e=x_e,q_e=b_e,Lg=ld,lg=ir,X_e=w_e,Z_e=A9,Y_e=I9,K_e=S_e,J_e=M_e,Q_e=C_e,D9=Function,WE=function(e){try{return D9('"use strict"; return ('+e+").constructor;")()}catch{}},g_=qg,exe=ox,qE=function(){throw new lg},txe=g_?function(){try{return arguments.callee,qE}catch{try{return g_(arguments,"callee").get}catch{return qE}}}():qE,Jp=h2()(),nxe=j_e(),So=typeof Reflect=="function"&&Reflect.getPrototypeOf||k9.getPrototypeOf||nxe,z9=PL,ax=TL,xm={},rxe=typeof Uint8Array>"u"||!So?_r:So(Uint8Array),Pf={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?_r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?_r:ArrayBuffer,"%ArrayIteratorPrototype%":Jp&&So?So([][Symbol.iterator]()):_r,"%AsyncFromSyncIteratorPrototype%":_r,"%AsyncFunction%":xm,"%AsyncGenerator%":xm,"%AsyncGeneratorFunction%":xm,"%AsyncIteratorPrototype%":xm,"%Atomics%":typeof Atomics>"u"?_r:Atomics,"%BigInt%":typeof BigInt>"u"?_r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?_r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?_r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?_r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":H_e,"%eval%":eval,"%EvalError%":G_e,"%Float32Array%":typeof Float32Array>"u"?_r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?_r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?_r:FinalizationRegistry,"%Function%":D9,"%GeneratorFunction%":xm,"%Int8Array%":typeof Int8Array>"u"?_r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?_r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?_r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Jp&&So?So(So([][Symbol.iterator]())):_r,"%JSON%":typeof JSON=="object"?JSON:_r,"%Map%":typeof Map>"u"?_r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Jp||!So?_r:So(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":k9,"%Object.getOwnPropertyDescriptor%":g_,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?_r:Promise,"%Proxy%":typeof Proxy>"u"?_r:Proxy,"%RangeError%":W_e,"%ReferenceError%":q_e,"%Reflect%":typeof Reflect>"u"?_r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?_r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Jp||!So?_r:So(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?_r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Jp&&So?So(""[Symbol.iterator]()):_r,"%Symbol%":Jp?Symbol:_r,"%SyntaxError%":Lg,"%ThrowTypeError%":txe,"%TypedArray%":rxe,"%TypeError%":lg,"%Uint8Array%":typeof Uint8Array>"u"?_r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?_r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?_r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?_r:Uint32Array,"%URIError%":X_e,"%WeakMap%":typeof WeakMap>"u"?_r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?_r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?_r:WeakSet,"%Function.prototype.call%":ax,"%Function.prototype.apply%":z9,"%Object.defineProperty%":exe,"%Math.abs%":Z_e,"%Math.floor%":Y_e,"%Math.max%":K_e,"%Math.min%":J_e,"%Math.pow%":Q_e};if(So)try{null.error}catch(e){var ixe=So(So(e));Pf["%Error.prototype%"]=ixe}var oxe=function e(t){var n;if(t==="%AsyncFunction%")n=WE("async function () {}");else if(t==="%GeneratorFunction%")n=WE("function* () {}");else if(t==="%AsyncGeneratorFunction%")n=WE("async function* () {}");else if(t==="%AsyncGenerator%"){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=e("%AsyncGenerator%");i&&So&&(n=So(i.prototype))}return Pf[t]=n,n},gF={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},lx=sx,wS=Su(),sxe=lx.call(ax,Array.prototype.concat),axe=lx.call(z9,Array.prototype.splice),vF=lx.call(ax,String.prototype.replace),SS=lx.call(ax,String.prototype.slice),lxe=lx.call(ax,RegExp.prototype.exec),cxe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,uxe=/\\(\\)?/g,hxe=function(t){var n=SS(t,0,1),r=SS(t,-1);if(n==="%"&&r!=="%")throw new Lg("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Lg("invalid intrinsic syntax, expected opening `%`");var i=[];return vF(t,cxe,function(a,c,o,f){i[i.length]=o?vF(f,uxe,"$1"):c||a}),i},dxe=function(t,n){var r=t,i;if(wS(gF,r)&&(i=gF[r],r="%"+i[0]+"%"),wS(Pf,r)){var a=Pf[r];if(a===xm&&(a=oxe(r)),typeof a>"u"&&!n)throw new lg("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:a}}throw new Lg("intrinsic "+t+" does not exist!")},us=function(t,n){if(typeof t!="string"||t.length===0)throw new lg("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new lg('"allowMissing" argument must be a boolean');if(lxe(/^%?[^%]*%?$/,t)===null)throw new Lg("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=hxe(t),i=r.length>0?r[0]:"",a=dxe("%"+i+"%",n),c=a.name,o=a.value,f=!1,g=a.alias;g&&(i=g[0],axe(r,sxe([0,1],g)));for(var _=1,x=!0;_<r.length;_+=1){var M=r[_],C=SS(M,0,1),A=SS(M,-1);if((C==='"'||C==="'"||C==="`"||A==='"'||A==="'"||A==="`")&&C!==A)throw new Lg("property names with quotes must have matching quotes");if((M==="constructor"||!x)&&(f=!0),i+="."+M,c="%"+i+"%",wS(Pf,c))o=Pf[c];else if(o!=null){if(!(M in o)){if(!n)throw new lg("base intrinsic for "+t+" exists, but the property is not available.");return}if(g_&&_+1>=r.length){var L=g_(o,M);x=!!L,x&&"get"in L&&!("originalValue"in L.get)?o=L.get:o=o[M]}else x=wS(o,M),o=o[M];x&&!f&&(Pf[c]=o)}}return o},fxe=us,yF=S9,pxe=EL(),_F=qg,xF=ir,mxe=fxe("%Math.floor%"),gxe=function(t,n){if(typeof t!="function")throw new xF("`fn` is not a function");if(typeof n!="number"||n<0||n>4294967295||mxe(n)!==n)throw new xF("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],i=!0,a=!0;if("length"in t&&_F){var c=_F(t,"length");c&&!c.configurable&&(i=!1),c&&!c.writable&&(a=!1)}return(i||a||!r)&&(pxe?yF(t,"length",n,!0,!0):yF(t,"length",n)),t},vxe=sx,yxe=PL,_xe=L9,xxe=function(){return _xe(vxe,yxe,arguments)};(function(e){var t=gxe,n=ox,r=AL,i=xxe;e.exports=function(c){var o=r(arguments),f=c.length-(arguments.length-1);return t(o,1+(f>0?f:0),!0)},n?n(e.exports,"apply",{value:i}):e.exports.apply=i})(P9);var O9=P9.exports,Zf=function(t){return typeof t=="string"||typeof t=="symbol"},bxe=ir,P0=Su(),wxe={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0},Yf=function(t){if(!t||typeof t!="object")return!1;for(var n in t)if(P0(t,n)&&!wxe[n])return!1;var r=P0(t,"[[Value]]")||P0(t,"[[Writable]]"),i=P0(t,"[[Get]]")||P0(t,"[[Set]]");if(r&&i)throw new bxe("Property Descriptors may not be both accessor and data descriptors");return!0},Sxe=ir,bF=Su(),Mxe=Yf,IL=function(t){if(typeof t>"u")return!1;if(!Mxe(t))throw new Sxe("Assertion failed: `Desc` must be a Property Descriptor");return!(!bF(t,"[[Get]]")&&!bF(t,"[[Set]]"))},XE,wF;function Cxe(){return wF||(wF=1,XE=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),XE}var F9=us,Exe=F9("%Object.preventExtensions%",!0),Txe=F9("%Object.isExtensible%",!0),SF=Cxe(),Pxe=Exe?function(t){return!SF(t)&&Txe(t)}:function(t){return!SF(t)},N9=Function.prototype.toString,jm=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,QA,fw;if(typeof jm=="function"&&typeof Object.defineProperty=="function")try{QA=Object.defineProperty({},"length",{get:function(){throw fw}}),fw={},jm(function(){throw 42},null,QA)}catch(e){e!==fw&&(jm=null)}else jm=null;var Axe=/^\s*class\b/,eI=function(t){try{var n=N9.call(t);return Axe.test(n)}catch{return!1}},ZE=function(t){try{return eI(t)?!1:(N9.call(t),!0)}catch{return!1}},pw=Object.prototype.toString,Ixe="[object Object]",Rxe="[object Function]",Lxe="[object GeneratorFunction]",kxe="[object HTMLAllCollection]",Dxe="[object HTML document.all class]",zxe="[object HTMLCollection]",Oxe=typeof Symbol=="function"&&!!Symbol.toStringTag,Fxe=!(0 in[,]),tI=function(){return!1};if(typeof document=="object"){var Nxe=document.all;pw.call(Nxe)===pw.call(document.all)&&(tI=function(t){if((Fxe||!t)&&(typeof t>"u"||typeof t=="object"))try{var n=pw.call(t);return(n===kxe||n===Dxe||n===zxe||n===Ixe)&&t("")==null}catch{}return!1})}var B9=jm?function(t){if(tI(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{jm(t,null,QA)}catch(n){if(n!==fw)return!1}return!eI(t)&&ZE(t)}:function(t){if(tI(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(Oxe)return ZE(t);if(eI(t))return!1;var n=pw.call(t);return n!==Rxe&&n!==Lxe&&!/^\[object HTML/.test(n)?!1:ZE(t)},cx=B9,U9=function(t){return!!t},Cs=function(t){return!!t&&(typeof t=="function"||typeof t=="object")},ec=Su(),nb=ir,MF=cx,YE=U9,Bxe=Cs,Uxe=function(t){if(!Bxe(t))throw new nb("ToPropertyDescriptor requires an object");var n={};if(ec(t,"enumerable")&&(n["[[Enumerable]]"]=YE(t.enumerable)),ec(t,"configurable")&&(n["[[Configurable]]"]=YE(t.configurable)),ec(t,"value")&&(n["[[Value]]"]=t.value),ec(t,"writable")&&(n["[[Writable]]"]=YE(t.writable)),ec(t,"get")){var r=t.get;if(typeof r<"u"&&!MF(r))throw new nb("getter must be a function");n["[[Get]]"]=r}if(ec(t,"set")){var i=t.set;if(typeof i<"u"&&!MF(i))throw new nb("setter must be a function");n["[[Set]]"]=i}if((ec(n,"[[Get]]")||ec(n,"[[Set]]"))&&(ec(n,"[[Value]]")||ec(n,"[[Writable]]")))throw new nb("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return n},KE,CF;function RL(){return CF||(CF=1,KE=Number.isNaN||function(t){return t!==t}),KE}var JE,EF;function LL(){if(EF)return JE;EF=1;var e=RL();return JE=function(n,r){return n===r?n===0?1/n===1/r:!0:e(n)&&e(r)},JE}var $9=us,V9=AL,$xe=V9([$9("%String.prototype.indexOf%")]),Ys=function(t,n){var r=$9(t,!!n);return typeof r=="function"&&$xe(t,".prototype.")>-1?V9([r]):r},QE,TF;function kL(){if(TF)return QE;TF=1;var e=us,t=e("%Array%"),n=!t.isArray&&Ys("Object.prototype.toString");return QE=t.isArray||function(i){return n(i)==="[object Array]"},QE}var Vxe=EL,PF=ox,j9=Vxe.hasArrayLengthDefineBug(),jxe=j9&&kL(),Hxe=Ys,Gxe=Hxe("Object.prototype.propertyIsEnumerable"),Wxe=function(t,n,r,i,a,c){if(!PF){if(!t(c)||!c["[[Configurable]]"]||!c["[[Writable]]"]||a in i&&Gxe(i,a)!==!!c["[[Enumerable]]"])return!1;var o=c["[[Value]]"];return i[a]=o,n(i[a],o)}return j9&&a==="length"&&"[[Value]]"in c&&jxe(i)&&i.length!==c["[[Value]]"]?(i.length=c["[[Value]]"],i.length===c["[[Value]]"]):(PF(i,a,r(c)),!0)},qxe=Yf,Xxe=function(t,n){return qxe(n)&&"[[Enumerable]]"in n&&"[[Configurable]]"in n&&(t.IsAccessorDescriptor(n)||t.IsDataDescriptor(n))},Zxe=function(t){if(typeof t>"u")return t;var n={};return"[[Value]]"in t&&(n.value=t["[[Value]]"]),"[[Writable]]"in t&&(n.writable=!!t["[[Writable]]"]),"[[Get]]"in t&&(n.get=t["[[Get]]"]),"[[Set]]"in t&&(n.set=t["[[Set]]"]),"[[Enumerable]]"in t&&(n.enumerable=!!t["[[Enumerable]]"]),"[[Configurable]]"in t&&(n.configurable=!!t["[[Configurable]]"]),n},Yxe=ir,Kxe=Yf,Jxe=Zxe,Qxe=function(t){if(typeof t<"u"&&!Kxe(t))throw new Yxe("Assertion failed: `Desc` must be a Property Descriptor");return Jxe(t)},e1e=ir,AF=Su(),t1e=Yf,H9=function(t){if(typeof t>"u")return!1;if(!t1e(t))throw new e1e("Assertion failed: `Desc` must be a Property Descriptor");return!(!AF(t,"[[Value]]")&&!AF(t,"[[Writable]]"))},n1e=ir,r1e=IL,i1e=H9,o1e=Yf,s1e=function(t){if(typeof t>"u")return!1;if(!o1e(t))throw new n1e("Assertion failed: `Desc` must be a Property Descriptor");return!r1e(t)&&!i1e(t)},a1e=Cs,l1e=function(t){if(t===null)return"Null";if(typeof t>"u")return"Undefined";if(a1e(t))return"Object";if(typeof t=="number")return"Number";if(typeof t=="boolean")return"Boolean";if(typeof t=="string")return"String"},c1e=l1e,u1e=function(t){return typeof t=="symbol"?"Symbol":typeof t=="bigint"?"BigInt":c1e(t)},Qp=ir,A0=Wxe,h1e=Xxe,IF=Yf,I0=Qxe,Jd=IL,nh=H9,d1e=s1e,f1e=Zf,tc=LL(),p1e=u1e,m1e=Cs,g1e=function(t,n,r,i,a){var c=p1e(t);if(typeof t<"u"&&!m1e(t))throw new Qp("Assertion failed: O must be undefined or an Object");if(!f1e(n))throw new Qp("Assertion failed: P must be a Property Key");if(typeof r!="boolean")throw new Qp("Assertion failed: extensible must be a Boolean");if(!IF(i))throw new Qp("Assertion failed: Desc must be a Property Descriptor");if(typeof a<"u"&&!IF(a))throw new Qp("Assertion failed: current must be a Property Descriptor, or undefined");if(typeof a>"u")return r?c==="Undefined"?!0:Jd(i)?A0(nh,tc,I0,t,n,i):A0(nh,tc,I0,t,n,{"[[Configurable]]":!!i["[[Configurable]]"],"[[Enumerable]]":!!i["[[Enumerable]]"],"[[Value]]":i["[[Value]]"],"[[Writable]]":!!i["[[Writable]]"]}):!1;if(!h1e({IsAccessorDescriptor:Jd,IsDataDescriptor:nh},a))throw new Qp("`current`, when present, must be a fully populated and valid Property Descriptor");if(!a["[[Configurable]]"]){if("[[Configurable]]"in i&&i["[[Configurable]]"]||"[[Enumerable]]"in i&&!tc(i["[[Enumerable]]"],a["[[Enumerable]]"])||!d1e(i)&&!tc(Jd(i),Jd(a)))return!1;if(Jd(a)){if("[[Get]]"in i&&!tc(i["[[Get]]"],a["[[Get]]"])||"[[Set]]"in i&&!tc(i["[[Set]]"],a["[[Set]]"]))return!1}else if(!a["[[Writable]]"]&&("[[Writable]]"in i&&i["[[Writable]]"]||"[[Value]]"in i&&!tc(i["[[Value]]"],a["[[Value]]"])))return!1}if(c!=="Undefined"){var o,f;return nh(a)&&Jd(i)?(o=("[[Configurable]]"in i?i:a)["[[Configurable]]"],f=("[[Enumerable]]"in i?i:a)["[[Enumerable]]"],A0(nh,tc,I0,t,n,{"[[Configurable]]":!!o,"[[Enumerable]]":!!f,"[[Get]]":("[[Get]]"in i?i:a)["[[Get]]"],"[[Set]]":("[[Set]]"in i?i:a)["[[Set]]"]})):Jd(a)&&nh(i)?(o=("[[Configurable]]"in i?i:a)["[[Configurable]]"],f=("[[Enumerable]]"in i?i:a)["[[Enumerable]]"],A0(nh,tc,I0,t,n,{"[[Configurable]]":!!o,"[[Enumerable]]":!!f,"[[Value]]":("[[Value]]"in i?i:a)["[[Value]]"],"[[Writable]]":!!("[[Writable]]"in i?i:a)["[[Writable]]"]})):A0(nh,tc,I0,t,n,i)}return!0},RF=qg,LF=ld,eT=ir,v1e=Yf,y1e=IL,_1e=Pxe,x1e=Zf,b1e=Uxe,w1e=LL(),S1e=g1e,M1e=Cs,C1e=function(t,n,r){if(!M1e(t))throw new eT("Assertion failed: O must be an Object");if(!x1e(n))throw new eT("Assertion failed: P must be a Property Key");if(!v1e(r))throw new eT("Assertion failed: Desc must be a Property Descriptor");if(!RF){if(y1e(r))throw new LF("This environment does not support accessor property descriptors.");var i=!(n in t)&&r["[[Writable]]"]&&r["[[Enumerable]]"]&&r["[[Configurable]]"]&&"[[Value]]"in r,a=n in t&&(!("[[Configurable]]"in r)||r["[[Configurable]]"])&&(!("[[Enumerable]]"in r)||r["[[Enumerable]]"])&&(!("[[Writable]]"in r)||r["[[Writable]]"])&&"[[Value]]"in r;if(i||a)return t[n]=r["[[Value]]"],w1e(t[n],r["[[Value]]"]);throw new LF("This environment does not support defining non-writable, non-enumerable, or non-configurable properties")}var c=RF(t,n),o=c&&b1e(c),f=_1e(t);return S1e(t,n,f,r,o)},kF=ir,E1e=Zf,T1e=C1e,P1e=Cs,A1e=function(t,n,r){if(!P1e(t))throw new kF("Assertion failed: Type(O) is not Object");if(!E1e(n))throw new kF("Assertion failed: P is not a Property Key");var i={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Value]]":r,"[[Writable]]":!0};return T1e(t,n,i)},tT=ir,I1e=A1e,R1e=Cs,L1e=Zf,k1e=function(t,n,r){if(!R1e(t))throw new tT("Assertion failed: Type(O) is not Object");if(!L1e(n))throw new tT("Assertion failed: P is not a Property Key");var i=I1e(t,n,r);if(!i)throw new tT("unable to create data property")},nT,DF;function DL(){return DF||(DF=1,nT=kL()),nT}var zL=function(t,n){for(var r=0;r<t.length;r+=1)n(t[r],r,t)};const D1e={},z1e=Object.freeze(Object.defineProperty({__proto__:null,default:D1e},Symbol.toStringTag,{value:"Module"})),O1e=OX(z1e);var rT,zF;function cd(){if(zF)return rT;zF=1;var e=typeof Map=="function"&&Map.prototype,t=Object.getOwnPropertyDescriptor&&e?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,n=e&&t&&typeof t.get=="function"?t.get:null,r=e&&Map.prototype.forEach,i=typeof Set=="function"&&Set.prototype,a=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,c=i&&a&&typeof a.get=="function"?a.get:null,o=i&&Set.prototype.forEach,f=typeof WeakMap=="function"&&WeakMap.prototype,g=f?WeakMap.prototype.has:null,_=typeof WeakSet=="function"&&WeakSet.prototype,x=_?WeakSet.prototype.has:null,M=typeof WeakRef=="function"&&WeakRef.prototype,C=M?WeakRef.prototype.deref:null,A=Boolean.prototype.valueOf,L=Object.prototype.toString,I=Function.prototype.toString,T=String.prototype.match,z=String.prototype.slice,k=String.prototype.replace,U=String.prototype.toUpperCase,H=String.prototype.toLowerCase,V=RegExp.prototype.test,q=Array.prototype.concat,J=Array.prototype.join,Y=Array.prototype.slice,N=Math.floor,ne=typeof BigInt=="function"?BigInt.prototype.valueOf:null,ye=Object.getOwnPropertySymbols,ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ne=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Ae=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ne||!0)?Symbol.toStringTag:null,ve=Object.prototype.propertyIsEnumerable,Se=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(Z){return Z.__proto__}:null);function Me(Z,le){if(Z===1/0||Z===-1/0||Z!==Z||Z&&Z>-1e3&&Z<1e3||V.call(/e/,le))return le;var Te=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof Z=="number"){var Ve=Z<0?-N(-Z):N(Z);if(Ve!==Z){var fe=String(Ve),xe=z.call(le,fe.length+1);return k.call(fe,Te,"$&_")+"."+k.call(k.call(xe,/([0-9]{3})/g,"$&_"),/_$/,"")}}return k.call(le,Te,"$&_")}var Ue=O1e,Qe=Ue.custom,st=hn(Qe)?Qe:null,ct={__proto__:null,double:'"',single:"'"},Xt={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};rT=function Z(le,Te,Ve,fe){var xe=Te||{};if(Ut(xe,"quoteStyle")&&!Ut(ct,xe.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ut(xe,"maxStringLength")&&(typeof xe.maxStringLength=="number"?xe.maxStringLength<0&&xe.maxStringLength!==1/0:xe.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Re=Ut(xe,"customInspect")?xe.customInspect:!0;if(typeof Re!="boolean"&&Re!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ut(xe,"indent")&&xe.indent!==null&&xe.indent!=="	"&&!(parseInt(xe.indent,10)===xe.indent&&xe.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ut(xe,"numericSeparator")&&typeof xe.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var De=xe.numericSeparator;if(typeof le>"u")return"undefined";if(le===null)return"null";if(typeof le=="boolean")return le?"true":"false";if(typeof le=="string")return wt(le,xe);if(typeof le=="number"){if(le===0)return 1/0/le>0?"0":"-0";var ze=String(le);return De?Me(le,ze):ze}if(typeof le=="bigint"){var Je=String(le)+"n";return De?Me(le,Je):Je}var Oe=typeof xe.depth>"u"?5:xe.depth;if(typeof Ve>"u"&&(Ve=0),Ve>=Oe&&Oe>0&&typeof le=="object")return Ot(le)?"[Array]":"[Object]";var Et=_e(xe,Ve);if(typeof fe>"u")fe=[];else if(An(fe,le)>=0)return"[Circular]";function Ft(Wt,pn,ur){if(pn&&(fe=Y.call(fe),fe.push(pn)),ur){var Xn={depth:xe.depth};return Ut(xe,"quoteStyle")&&(Xn.quoteStyle=xe.quoteStyle),Z(Wt,Xn,Ve+1,fe)}return Z(Wt,xe,Ve+1,fe)}if(typeof le=="function"&&!ot(le)){var be=Dt(le),qe=re(le,Ft);return"[Function"+(be?": "+be:" (anonymous)")+"]"+(qe.length>0?" { "+J.call(qe,", ")+" }":"")}if(hn(le)){var tt=Ne?k.call(String(le),/^(Symbol\(.*\))_[^)]*$/,"$1"):ge.call(le);return typeof le=="object"&&!Ne?Lt(tt):tt}if(It(le)){for(var At="<"+H.call(String(le.nodeName)),Ht=le.attributes||[],Yt=0;Yt<Ht.length;Yt++)At+=" "+Ht[Yt].name+"="+je(lt(Ht[Yt].value),"double",xe);return At+=">",le.childNodes&&le.childNodes.length&&(At+="..."),At+="</"+H.call(String(le.nodeName))+">",At}if(Ot(le)){if(le.length===0)return"[]";var qt=re(le,Ft);return Et&&!zt(qt)?"["+te(qt,Et)+"]":"[ "+J.call(qt,", ")+" ]"}if(Tt(le)){var Gt=re(le,Ft);return!("cause"in Error.prototype)&&"cause"in le&&!ve.call(le,"cause")?"{ ["+String(le)+"] "+J.call(q.call("[cause]: "+Ft(le.cause),Gt),", ")+" }":Gt.length===0?"["+String(le)+"]":"{ ["+String(le)+"] "+J.call(Gt,", ")+" }"}if(typeof le=="object"&&Re){if(st&&typeof le[st]=="function"&&Ue)return Ue(le,{depth:Oe-Ve});if(Re!=="symbol"&&typeof le.inspect=="function")return le.inspect()}if(an(le)){var yn=[];return r&&r.call(le,function(Wt,pn){yn.push(Ft(pn,le,!0)+" => "+Ft(Wt,le))}),bn("Map",n.call(le),yn,Et)}if(it(le)){var gt=[];return o&&o.call(le,function(Wt){gt.push(Ft(Wt,le))}),bn("Set",c.call(le),gt,Et)}if(Le(le))return kt("WeakMap");if(St(le))return kt("WeakSet");if(me(le))return kt("WeakRef");if(un(le))return Lt(Ft(Number(le)));if(We(le))return Lt(Ft(ne.call(le)));if(gn(le))return Lt(A.call(le));if(Ct(le))return Lt(Ft(String(le)));if(typeof window<"u"&&le===window)return"{ [object Window] }";if(typeof globalThis<"u"&&le===globalThis||typeof xP<"u"&&le===xP)return"{ [object globalThis] }";if(!ut(le)&&!ot(le)){var In=re(le,Ft),cn=Se?Se(le)===Object.prototype:le instanceof Object||le.constructor===Object,Nn=le instanceof Object?"":"null prototype",xt=!cn&&Ae&&Object(le)===le&&Ae in le?z.call(tn(le),8,-1):Nn?"Object":"",Ze=cn||typeof le.constructor!="function"?"":le.constructor.name?le.constructor.name+" ":"",Rt=Ze+(xt||Nn?"["+J.call(q.call([],xt||[],Nn||[]),": ")+"] ":"");return In.length===0?Rt+"{}":Et?Rt+"{"+te(In,Et)+"}":Rt+"{ "+J.call(In,", ")+" }"}return String(le)};function je(Z,le,Te){var Ve=Te.quoteStyle||le,fe=ct[Ve];return fe+Z+fe}function lt(Z){return k.call(String(Z),/"/g,"&quot;")}function Ot(Z){return tn(Z)==="[object Array]"&&(!Ae||!(typeof Z=="object"&&Ae in Z))}function ut(Z){return tn(Z)==="[object Date]"&&(!Ae||!(typeof Z=="object"&&Ae in Z))}function ot(Z){return tn(Z)==="[object RegExp]"&&(!Ae||!(typeof Z=="object"&&Ae in Z))}function Tt(Z){return tn(Z)==="[object Error]"&&(!Ae||!(typeof Z=="object"&&Ae in Z))}function Ct(Z){return tn(Z)==="[object String]"&&(!Ae||!(typeof Z=="object"&&Ae in Z))}function un(Z){return tn(Z)==="[object Number]"&&(!Ae||!(typeof Z=="object"&&Ae in Z))}function gn(Z){return tn(Z)==="[object Boolean]"&&(!Ae||!(typeof Z=="object"&&Ae in Z))}function hn(Z){if(Ne)return Z&&typeof Z=="object"&&Z instanceof Symbol;if(typeof Z=="symbol")return!0;if(!Z||typeof Z!="object"||!ge)return!1;try{return ge.call(Z),!0}catch{}return!1}function We(Z){if(!Z||typeof Z!="object"||!ne)return!1;try{return ne.call(Z),!0}catch{}return!1}var vn=Object.prototype.hasOwnProperty||function(Z){return Z in this};function Ut(Z,le){return vn.call(Z,le)}function tn(Z){return L.call(Z)}function Dt(Z){if(Z.name)return Z.name;var le=T.call(I.call(Z),/^function\s*([\w$]+)/);return le?le[1]:null}function An(Z,le){if(Z.indexOf)return Z.indexOf(le);for(var Te=0,Ve=Z.length;Te<Ve;Te++)if(Z[Te]===le)return Te;return-1}function an(Z){if(!n||!Z||typeof Z!="object")return!1;try{n.call(Z);try{c.call(Z)}catch{return!0}return Z instanceof Map}catch{}return!1}function Le(Z){if(!g||!Z||typeof Z!="object")return!1;try{g.call(Z,g);try{x.call(Z,x)}catch{return!0}return Z instanceof WeakMap}catch{}return!1}function me(Z){if(!C||!Z||typeof Z!="object")return!1;try{return C.call(Z),!0}catch{}return!1}function it(Z){if(!c||!Z||typeof Z!="object")return!1;try{c.call(Z);try{n.call(Z)}catch{return!0}return Z instanceof Set}catch{}return!1}function St(Z){if(!x||!Z||typeof Z!="object")return!1;try{x.call(Z,x);try{g.call(Z,g)}catch{return!0}return Z instanceof WeakSet}catch{}return!1}function It(Z){return!Z||typeof Z!="object"?!1:typeof HTMLElement<"u"&&Z instanceof HTMLElement?!0:typeof Z.nodeName=="string"&&typeof Z.getAttribute=="function"}function wt(Z,le){if(Z.length>le.maxStringLength){var Te=Z.length-le.maxStringLength,Ve="... "+Te+" more character"+(Te>1?"s":"");return wt(z.call(Z,0,le.maxStringLength),le)+Ve}var fe=Xt[le.quoteStyle||"single"];fe.lastIndex=0;var xe=k.call(k.call(Z,fe,"\\$1"),/[\x00-\x1f]/g,Zt);return je(xe,"single",le)}function Zt(Z){var le=Z.charCodeAt(0),Te={8:"b",9:"t",10:"n",12:"f",13:"r"}[le];return Te?"\\"+Te:"\\x"+(le<16?"0":"")+U.call(le.toString(16))}function Lt(Z){return"Object("+Z+")"}function kt(Z){return Z+" { ? }"}function bn(Z,le,Te,Ve){var fe=Ve?te(Te,Ve):J.call(Te,", ");return Z+" ("+le+") {"+fe+"}"}function zt(Z){for(var le=0;le<Z.length;le++)if(An(Z[le],`
`)>=0)return!1;return!0}function _e(Z,le){var Te;if(Z.indent==="	")Te="	";else if(typeof Z.indent=="number"&&Z.indent>0)Te=J.call(Array(Z.indent+1)," ");else return null;return{base:Te,prev:J.call(Array(le+1),Te)}}function te(Z,le){if(Z.length===0)return"";var Te=`
`+le.prev+le.base;return Te+J.call(Z,","+Te)+`
`+le.prev}function re(Z,le){var Te=Ot(Z),Ve=[];if(Te){Ve.length=Z.length;for(var fe=0;fe<Z.length;fe++)Ve[fe]=Ut(Z,fe)?le(Z[fe],Z):""}var xe=typeof ye=="function"?ye(Z):[],Re;if(Ne){Re={};for(var De=0;De<xe.length;De++)Re["$"+xe[De]]=xe[De]}for(var ze in Z)Ut(Z,ze)&&(Te&&String(Number(ze))===ze&&ze<Z.length||Ne&&Re["$"+ze]instanceof Symbol||(V.call(/[^\w$]/,ze)?Ve.push(le(ze,Z)+": "+le(Z[ze],Z)):Ve.push(ze+": "+le(Z[ze],Z))));if(typeof ye=="function")for(var Je=0;Je<xe.length;Je++)ve.call(Z,xe[Je])&&Ve.push("["+le(xe[Je])+"]: "+le(Z[xe[Je]],Z));return Ve}return rT}var iT,OF;function F1e(){if(OF)return iT;OF=1;var e=cd(),t=ir,n=function(o,f,g){for(var _=o,x;(x=_.next)!=null;_=x)if(x.key===f)return _.next=x.next,g||(x.next=o.next,o.next=x),x},r=function(o,f){if(o){var g=n(o,f);return g&&g.value}},i=function(o,f,g){var _=n(o,f);_?_.value=g:o.next={key:f,next:o.next,value:g}},a=function(o,f){return o?!!n(o,f):!1},c=function(o,f){if(o)return n(o,f,!0)};return iT=function(){var f,g={assert:function(_){if(!g.has(_))throw new t("Side channel does not contain "+e(_))},delete:function(_){var x=f&&f.next,M=c(f,_);return M&&x&&x===M&&(f=void 0),!!M},get:function(_){return r(f,_)},has:function(_){return a(f,_)},set:function(_,x){f||(f={next:void 0}),i(f,_,x)}};return g},iT}var oT,FF;function G9(){if(FF)return oT;FF=1;var e=us,t=Ys,n=cd(),r=ir,i=e("%Map%",!0),a=t("Map.prototype.get",!0),c=t("Map.prototype.set",!0),o=t("Map.prototype.has",!0),f=t("Map.prototype.delete",!0),g=t("Map.prototype.size",!0);return oT=!!i&&function(){var x,M={assert:function(C){if(!M.has(C))throw new r("Side channel does not contain "+n(C))},delete:function(C){if(x){var A=f(x,C);return g(x)===0&&(x=void 0),A}return!1},get:function(C){if(x)return a(x,C)},has:function(C){return x?o(x,C):!1},set:function(C,A){x||(x=new i),c(x,C,A)}};return M},oT}var sT,NF;function N1e(){if(NF)return sT;NF=1;var e=us,t=Ys,n=cd(),r=G9(),i=ir,a=e("%WeakMap%",!0),c=t("WeakMap.prototype.get",!0),o=t("WeakMap.prototype.set",!0),f=t("WeakMap.prototype.has",!0),g=t("WeakMap.prototype.delete",!0);return sT=a?function(){var x,M,C={assert:function(A){if(!C.has(A))throw new i("Side channel does not contain "+n(A))},delete:function(A){if(a&&A&&(typeof A=="object"||typeof A=="function")){if(x)return g(x,A)}else if(r&&M)return M.delete(A);return!1},get:function(A){return a&&A&&(typeof A=="object"||typeof A=="function")&&x?c(x,A):M&&M.get(A)},has:function(A){return a&&A&&(typeof A=="object"||typeof A=="function")&&x?f(x,A):!!M&&M.has(A)},set:function(A,L){a&&A&&(typeof A=="object"||typeof A=="function")?(x||(x=new a),o(x,A,L)):r&&(M||(M=r()),M.set(A,L))}};return C}:r,sT}var aT,BF;function B1e(){if(BF)return aT;BF=1;var e=ir,t=cd(),n=F1e(),r=G9(),i=N1e(),a=i||r||n;return aT=function(){var o,f={assert:function(g){if(!f.has(g))throw new e("Side channel does not contain "+t(g))},delete:function(g){return!!o&&o.delete(g)},get:function(g){return o&&o.get(g)},has:function(g){return!!o&&o.has(g)},set:function(g,_){o||(o=a()),o.set(g,_)}};return f},aT}var lT,UF;function OL(){if(UF)return lT;UF=1;var e=Su(),t=B1e()(),n=ir,r={assert:function(i,a){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof a!="string")throw new n("`slot` must be a string");if(t.assert(i),!r.has(i,a))throw new n("`"+a+"` is not present on `O`")},get:function(i,a){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof a!="string")throw new n("`slot` must be a string");var c=t.get(i);return c&&c["$"+a]},has:function(i,a){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof a!="string")throw new n("`slot` must be a string");var c=t.get(i);return!!c&&e(c,"$"+a)},set:function(i,a,c){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof a!="string")throw new n("`slot` must be a string");var o=t.get(i);o||(o={},t.set(i,o)),o["$"+a]=c}};return Object.freeze&&Object.freeze(r),lT=r,lT}var cT,$F;function U1e(){if($F)return cT;$F=1;var e={__proto__:null,foo:{}},t={__proto__:e}.foo===e.foo&&!(e instanceof Object);return cT=function(){return t},cT}var $1e=us,VF=$1e("%Object.create%",!0),jF=ir,V1e=ld,j1e=DL(),H1e=zL,G1e=Cs,W1e=OL(),q1e=U1e()(),W9=function(t){if(t!==null&&!G1e(t))throw new jF("Assertion failed: `proto` must be null or an object");var n=arguments.length<2?[]:arguments[1];if(!j1e(n))throw new jF("Assertion failed: `additionalInternalSlotsList` must be an Array");var r;if(VF)r=VF(t);else if(q1e)r={__proto__:t};else{if(t===null)throw new V1e("native Object.create support is required to create null objects");var i=function(){};i.prototype=t,r=new i}return n.length>0&&H1e(n,function(a){W1e.set(r,a,void 0)}),r},X1e=function(t){return t===0&&1/t===-1/0},q9=Number.MAX_SAFE_INTEGER||9007199254740991,uT,HF;function Z1e(){return HF||(HF=1,uT=function(t,n){for(var r=0;r<t.length;r+=1)if(!n(t[r],r,t))return!1;return!0}),uT}var GF=ir,Y1e=Ys,WF=Y1e("Array.prototype.push"),K1e=LL(),X9=kL(),J1e=Z1e(),Q1e=zL,qF=Su(),ebe=function(e){return qF(e,"[[Key]]")&&qF(e,"[[Elements]]")&&X9(e["[[Elements]]"])},tbe=function(t,n,r){if(!X9(t)||t.length>0&&!J1e(t,ebe))throw new GF("Assertion failed: `groups` must be a List of Records with [[Key]] and [[Elements]]");var i=0;if(Q1e(t,function(c){if(K1e(c["[[Key]]"],n)){if(i+=1,i>1)throw new GF("Assertion failed: Exactly one element of groups meets this criterion");WF(c["[[Elements]]"],r)}}),i===0){var a={"[[Key]]":n,"[[Elements]]":[r]};WF(t,a)}},nbe=us,rbe=Ys,ibe=ir,obe=DL(),sbe=nbe("%Reflect.apply%",!0)||rbe("Function.prototype.apply"),ux=function(t,n){var r=arguments.length>2?arguments[2]:[];if(!obe(r))throw new ibe("Assertion failed: optional `argumentsList`, if provided, must be a List");return sbe(t,n,r)},hT,XF;function Z9(){return XF||(XF=1,hT=function(t){return typeof t=="number"&&t>=55296&&t<=56319}),hT}var dT,ZF;function Y9(){return ZF||(ZF=1,dT=function(t){return typeof t=="number"&&t>=56320&&t<=57343}),dT}var fT,YF;function abe(){if(YF)return fT;YF=1;var e=us,t=ir,n=e("%String.fromCharCode%"),r=Z9(),i=Y9();return fT=function(c,o){if(!r(c)||!i(o))throw new t("Assertion failed: `lead` must be a leading surrogate char code, and `trail` must be a trailing surrogate char code");return n(c)+n(o)},fT}var pT,KF;function lbe(){if(KF)return pT;KF=1;var e=ir,t=Ys,n=Z9(),r=Y9(),i=abe(),a=t("String.prototype.charAt"),c=t("String.prototype.charCodeAt");return pT=function(f,g){if(typeof f!="string")throw new e("Assertion failed: `string` must be a String");var _=f.length;if(g<0||g>=_)throw new e("Assertion failed: `position` must be >= 0, and < the length of `string`");var x=c(f,g),M=a(f,g),C=n(x),A=r(x);if(!C&&!A)return{"[[CodePoint]]":M,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!1};if(A||g+1===_)return{"[[CodePoint]]":M,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0};var L=c(f,g+1);return r(L)?{"[[CodePoint]]":i(x,L),"[[CodeUnitCount]]":2,"[[IsUnpairedSurrogate]]":!1}:{"[[CodePoint]]":M,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0}},pT}var mT,JF;function cbe(){if(JF)return mT;JF=1;var e=RL();return mT=function(n){return(typeof n=="number"||typeof n=="bigint")&&!e(n)&&n!==1/0&&n!==-1/0},mT}var gT,QF;function ube(){if(QF)return gT;QF=1;var e=A9,t=I9,n=RL(),r=cbe();return gT=function(a){if(typeof a!="number"||n(a)||!r(a))return!1;var c=e(a);return t(c)===c},gT}var vT,eN;function hbe(){if(eN)return vT;eN=1;var e=lbe(),t=ir,n=ube(),r=q9;return vT=function(a,c,o){if(typeof a!="string")throw new t("Assertion failed: `S` must be a String");if(!n(c)||c<0||c>r)throw new t("Assertion failed: `length` must be an integer >= 0 and <= 2**53");if(typeof o!="boolean")throw new t("Assertion failed: `unicode` must be a Boolean");if(!o)return c+1;var f=a.length;if(c+1>=f)return c+1;var g=e(a,c);return c+g["[[CodeUnitCount]]"]},vT}var yT,tN;function K9(){if(tN)return yT;tN=1;var e=ir;return yT=function(n,r){if(typeof r!="boolean")throw new e("Assertion failed: Type(done) is not Boolean");return{value:n,done:r}},yT}var nN=ir,dbe=cd(),fbe=Cs,pbe=Zf,d2=function(t,n){if(!fbe(t))throw new nN("Assertion failed: Type(O) is not Object");if(!pbe(n))throw new nN("Assertion failed: P is not a Property Key, got "+dbe(n));return t[n]},mbe=ir,gbe=d2,vbe=U9,ybe=Cs,J9=function(t){if(!ybe(t))throw new mbe("Assertion failed: Type(iterResult) is not Object");return vbe(gbe(t,"done"))},_be=ir,xbe=d2,bbe=Cs,Q9=function(t){if(!bbe(t))throw new _be("Assertion failed: Type(iterResult) is not Object");return xbe(t,"value")},_T,rN;function wbe(){if(rN)return _T;rN=1;var e=us,t=O9,n=ld,r=e("%Promise.resolve%",!0),i=r&&t(r);return _T=function(c,o){if(!i)throw new n("This environment does not support Promises.");return i(c,o)},_T}var xT,iN;function Sbe(){if(iN)return xT;iN=1;var e=us,t=ld,n=ir,r=e("%Promise%",!0),i=Ys,a=K9(),c=J9,o=Q9,f=wbe(),g=Cs,_=i("Promise.prototype.then",!0);return xT=function(M){if(!g(M))throw new n("Assertion failed: Type(O) is not Object");if(arguments.length>1)throw new t("although AsyncFromSyncIteratorContinuation should take a second argument, it is not used in this implementation");if(!r)throw new t("This environment does not support Promises.");return new r(function(C){var A=c(M),L=o(M),I=f(r,L),T=function(z){return a(z,A)};C(_(I,T))})},xT}var Mbe=ir,Cbe=cd(),Ebe=Zf,Tbe=function(t,n){if(!Ebe(n))throw new Mbe("Assertion failed: P is not a Property Key, got "+Cbe(n));return t[n]},oN=ir,Pbe=Tbe,Abe=cx,Ibe=Zf,sN=cd(),FL=function(t,n){if(!Ibe(n))throw new oN("Assertion failed: P is not a Property Key");var r=Pbe(t,n);if(r!=null){if(!Abe(r))throw new oN(sN(n)+" is not a function: "+sN(r));return r}},bT=Su(),f2=function(t){return!!t&&typeof t=="object"&&bT(t,"[[Iterator]]")&&bT(t,"[[NextMethod]]")&&bT(t,"[[Done]]")&&typeof t["[[Done]]"]=="boolean"},aN=ir,lN=ux,Rbe=Cs,Lbe=f2,e7=function(t){if(!Lbe(t))throw new aN("Assertion failed: `iteratorRecord` must be an Iterator Record");var n;if(arguments.length<2?n=lN(t["[[NextMethod]]"],t["[[Iterator]]"]):n=lN(t["[[NextMethod]]"],t["[[Iterator]]"],[arguments[1]]),!Rbe(n))throw new aN("iterator next must return an object");return n},wT,cN;function kbe(){if(cN)return wT;cN=1;var e=us,t=ld,n=ir,r=e("%Promise%",!0),i=Sbe(),a=ux,c=K9(),o=d2,f=FL,g=e7,_=W9,x=Cs,M=f2,C=OL(),A=e("%AsyncFromSyncIteratorPrototype%",!0)||{next:function(I){if(!r)throw new t("This environment does not support Promises.");var T=this;C.assert(T,"[[SyncIteratorRecord]]");var z=arguments.length;return new r(function(k){var U=C.get(T,"[[SyncIteratorRecord]]"),H;z>0?H=g(U,I):H=g(U),k(i(H))})},return:function(){if(!r)throw new t("This environment does not support Promises.");var L=this;C.assert(L,"[[SyncIteratorRecord]]");var I=arguments.length>0,T=I?arguments[0]:void 0;return new r(function(z,k){var U=C.get(L,"[[SyncIteratorRecord]]")["[[Iterator]]"],H=f(U,"return");if(typeof H>"u"){var V=c(T,!0);a(z,void 0,[V]);return}var q;if(I?q=a(H,U,[T]):q=a(H,U),!x(q)){a(k,void 0,[new n("Iterator `return` method returned a non-object value.")]);return}z(i(q))})},throw:function(){if(!r)throw new t("This environment does not support Promises.");var L=this;C.assert(L,"[[SyncIteratorRecord]]");var I=arguments.length>0,T=I?arguments[0]:void 0;return new r(function(z,k){var U=C.get(L,"[[SyncIteratorRecord]]")["[[Iterator]]"],H=f(U,"throw");if(typeof H>"u"){a(k,void 0,[T]);return}var V;if(I?V=a(H,U,[T]):V=a(H,U),!x(V)){a(k,void 0,[new n("Iterator `throw` method returned a non-object value.")]);return}z(i(V))})}};return wT=function(I){if(!M(I))throw new n("Assertion failed: `syncIteratorRecord` must be an Iterator Record");var T=_(A);C.set(T,"[[SyncIteratorRecord]]",I);var z=o(T,"next");return{"[[Iterator]]":T,"[[NextMethod]]":z,"[[Done]]":!1}},wT}var ST,uN;function Dbe(){if(uN)return ST;uN=1;var e=ir,t=ux,n=d2,r=cx,i=Cs;return ST=function(c,o){if(!r(o))throw new e("method must be a function");var f=t(o,c);if(!i(f))throw new e("iterator must return an object");var g=n(f,"next");return{"[[Iterator]]":f,"[[NextMethod]]":g,"[[Done]]":!1}},ST}var MT,hN;function NL(){if(hN)return MT;hN=1;var e=R9();return MT=function(){return e()&&!!Symbol.toStringTag},MT}var CT,dN;function zbe(){if(dN)return CT;dN=1;var e=Ys,t=e("String.prototype.valueOf"),n=function(o){try{return t(o),!0}catch{return!1}},r=e("Object.prototype.toString"),i="[object String]",a=NL()();return CT=function(o){return typeof o=="string"?!0:!o||typeof o!="object"?!1:a?n(o):r(o)===i},CT}var ET,fN;function Obe(){if(fN)return ET;fN=1;var e=h2()(),t=us,n=Ys,r=zbe(),i=t("%Symbol.iterator%",!0),a=n("String.prototype.slice"),c=t("%String%");return ET=function(f,g){var _;return e?_=f.GetMethod(g,i):f.IsArray(g)?_=function(){var x=-1,M=this;return{next:function(){return x+=1,{done:x>=M.length,value:M[x]}}}}:r(g)&&(_=function(){var x=0;return{next:function(){var M=f.AdvanceStringIndex(c(g),x,!0),C=a(g,x,M);return x=M,{done:M>g.length,value:C}}}}),_},ET}var Fbe=us,TT=ir,pN=Fbe("%Symbol.asyncIterator%",!0),Nbe=cd(),Bbe=h2()(),Ube=hbe(),$be=kbe(),mN=Dbe(),t7=FL,Vbe=DL(),jbe={AdvanceStringIndex:Ube,GetMethod:t7,IsArray:Vbe},Hbe=Obe(),Gbe=function(t,n){if(n!=="SYNC"&&n!=="ASYNC")throw new TT("Assertion failed: `kind` must be one of 'sync' or 'async', got "+Nbe(n));var r;if(n==="ASYNC"&&Bbe&&pN&&(r=t7(t,pN)),typeof r>"u"){var i=Hbe(jbe,t);if(n==="ASYNC"){if(typeof i>"u")throw new TT("iterator method is `undefined`");var a=mN(t,i);return $be(a)}r=i}if(typeof r>"u")throw new TT("iterator method is `undefined`");return mN(t,r)},n7=ld,qh=OL(),hx=function e(t,n){if(!(this instanceof e))return new e(t,n);if(t!=="normal"&&t!=="break"&&t!=="continue"&&t!=="return"&&t!=="throw")throw new n7('Assertion failed: `type` must be one of "normal", "break", "continue", "return", or "throw"');qh.set(this,"[[Type]]",t),qh.set(this,"[[Value]]",n)};hx.prototype.type=function(){return qh.get(this,"[[Type]]")};hx.prototype.value=function(){return qh.get(this,"[[Value]]")};hx.prototype["?"]=function(){var t=qh.get(this,"[[Type]]"),n=qh.get(this,"[[Value]]");if(t==="throw")throw n;return n};hx.prototype["!"]=function(){var t=qh.get(this,"[[Type]]");if(t!=="normal")throw new n7('Assertion failed: Completion Record is not of type "normal"');return qh.get(this,"[[Value]]")};var r7=hx,rb=ir,Wbe=ux,gN=r7,qbe=FL,Xbe=cx,vN=Cs,Zbe=f2,Ybe=function(t,n){if(!Zbe(t))throw new rb("Assertion failed: `iteratorRecord` must be an Iterator Record");if(!vN(t["[[Iterator]]"]))throw new rb("Assertion failed: iteratorRecord.[[Iterator]] must be an Object");if(!Xbe(n)&&!(n instanceof gN))throw new rb("Assertion failed: completion is not a thunk representing a Completion Record, nor a Completion Record instance");var r=n instanceof gN?function(){return n["?"]()}:n,i=t["[[Iterator]]"],a;try{a=qbe(i,"return")}catch(f){throw r(),r=null,f}if(typeof a>"u")return r();var c;try{c=Wbe(a,i,[])}catch(f){throw r(),r=null,f}var o=r();if(r=null,!vN(c))throw new rb("iterator .return must return an object");return o},Kbe=ir,Jbe=J9,Qbe=e7,ewe=f2,twe=function(t){if(!ewe(t))throw new Kbe("Assertion failed: `iteratorRecord` must be an Iterator Record");var n=Qbe(t),r=Jbe(n);return r===!0?!1:n},nwe=ir,rwe=function(t){if(t==null)throw new nwe(arguments.length>0&&arguments[1]||"Cannot call method on "+t);return t},iwe=rwe,owe=r7,swe=function(t){return new owe("throw",t)},PT,yN;function awe(){return yN||(yN=1,PT=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),PT}var AT,_N;function lwe(){if(_N)return AT;_N=1;var e=Ys,t=e("Date.prototype.getDay"),n=function(o){try{return t(o),!0}catch{return!1}},r=e("Object.prototype.toString"),i="[object Date]",a=NL()();return AT=function(o){return typeof o!="object"||o===null?!1:a?n(o):r(o)===i},AT}var ib={exports:{}},IT,xN;function cwe(){if(xN)return IT;xN=1;var e=Ys,t=NL()(),n=Su(),r=qg,i;if(t){var a=e("RegExp.prototype.exec"),c={},o=function(){throw c},f={toString:o,valueOf:o};typeof Symbol.toPrimitive=="symbol"&&(f[Symbol.toPrimitive]=o),i=function(M){if(!M||typeof M!="object")return!1;var C=r(M,"lastIndex"),A=C&&n(C,"value");if(!A)return!1;try{a(M,f)}catch(L){return L===c}}}else{var g=e("Object.prototype.toString"),_="[object RegExp]";i=function(M){return!M||typeof M!="object"&&typeof M!="function"?!1:g(M)===_}}return IT=i,IT}var RT,bN;function uwe(){if(bN)return RT;bN=1;var e=Ys,t=cwe(),n=e("RegExp.prototype.exec"),r=ir;return RT=function(a){if(!t(a))throw new r("`regex` must be a RegExp");return function(o){return n(a,o)!==null}},RT}var wN;function hwe(){if(wN)return ib.exports;wN=1;var e=Ys,t=e("Object.prototype.toString"),n=h2()(),r=uwe();if(n){var i=e("Symbol.prototype.toString"),a=r(/^Symbol\(.*\)$/),c=function(f){return typeof f.valueOf()!="symbol"?!1:a(i(f))};ib.exports=function(f){if(typeof f=="symbol")return!0;if(!f||typeof f!="object"||t(f)!=="[object Symbol]")return!1;try{return c(f)}catch{return!1}}}else ib.exports=function(f){return!1};return ib.exports}var LT,SN;function dwe(){if(SN)return LT;SN=1;var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",t=awe(),n=B9,r=lwe(),i=hwe(),a=function(f,g){if(typeof f>"u"||f===null)throw new TypeError("Cannot call method on "+f);if(typeof g!="string"||g!=="number"&&g!=="string")throw new TypeError('hint must be "string" or "number"');var _=g==="string"?["toString","valueOf"]:["valueOf","toString"],x,M,C;for(C=0;C<_.length;++C)if(x=f[_[C]],n(x)&&(M=x.call(f),t(M)))return M;throw new TypeError("No default value")},c=function(f,g){var _=f[g];if(_!==null&&typeof _<"u"){if(!n(_))throw new TypeError(_+" returned for property "+String(g)+" of object "+f+" is not a function");return _}};return LT=function(f){if(t(f))return f;var g="default";arguments.length>1&&(arguments[1]===String?g="string":arguments[1]===Number&&(g="number"));var _;if(e&&(Symbol.toPrimitive?_=c(f,Symbol.toPrimitive):i(f)&&(_=Symbol.prototype.valueOf)),typeof _<"u"){var x=_.call(f,g);if(t(x))return x;throw new TypeError("unable to convert exotic object to primitive")}return g==="default"&&(r(f)||i(f))&&(g="string"),a(f,g==="default"?"number":g)},LT}var kT,MN;function fwe(){if(MN)return kT;MN=1;var e=dwe();return kT=function(n){return arguments.length>1?e(n,arguments[1]):e(n)},kT}var DT,CN;function pwe(){if(CN)return DT;CN=1;var e=us,t=e("%String%"),n=ir;return DT=function(i){if(typeof i=="symbol")throw new n("Cannot convert a Symbol value to a string");return t(i)},DT}var mwe=us,gwe=mwe("%String%"),vwe=fwe(),ywe=pwe(),_we=function(t){var n=vwe(t,gwe);return typeof n=="symbol"?n:ywe(n)},ob=ir,xwe=X1e,bwe=q9,wwe=tbe,Swe=ux,Mwe=Gbe,Cwe=cx,zT=Ybe,Ewe=twe,Twe=Q9,Pwe=iwe,OT=swe,Awe=_we,Iwe=function(t,n,r){if(r!=="PROPERTY"&&r!=="ZERO")throw new ob('Assertion failed: `keyCoercion` must be `"PROPERTY"` or `"ZERO"`');if(Pwe(t),!Cwe(n))throw new ob("callbackfn must be callable");for(var i=[],a=Mwe(t,"SYNC"),c=0;;){if(c>=bwe){var o=OT(new ob("k must be less than 2 ** 53 - 1"));zT(a,o);return}var f=Ewe(a);if(!f)return i;var g=Twe(f),_;try{_=Swe(n,void 0,[g,c])}catch(x){zT(a,OT(x));return}if(r==="PROPERTY")try{_=Awe(_)}catch(x){zT(a,OT(x));return}else{if(r!=="ZERO")throw new ob("keyCoercion must be ~PROPERTY~ or ~ZERO~");xwe(_)&&(_=0)}wwe(i,_,g),c+=1}},Rwe=k1e,Lwe=W9,kwe=zL,Dwe=Iwe,i7=function(t,n){var r=Dwe(t,n,"PROPERTY"),i=Lwe(null);return kwe(r,function(a){Rwe(i,a["[[Key]]"],a["[[Elements]]"])}),i},zwe=i7,o7=function(){return Object.groupBy||zwe},FT,EN;function Owe(){if(EN)return FT;EN=1;var e=T9,t=o7;return FT=function(){var r=t();return e(Object,{groupBy:r},{groupBy:function(){return Object.groupBy!==r}}),r},FT}var Fwe=T9,Nwe=O9,Bwe=i7,s7=o7,Uwe=s7(),$we=Owe(),a7=Nwe(Uwe,Object);Fwe(a7,{getPolyfill:s7,implementation:Bwe,shim:$we});var Vwe=a7;const jwe=oR(Vwe),MS=[{label:"ATS",value:{map:"usa",search:"places"}},{label:"ATS",value:{map:"usa",search:"achievements"}},{label:"ETS2",value:{map:"europe",search:"places"}},{label:"ETS2",value:{map:"europe",search:"achievements"}}],NT=(e,t)=>{const n=MS.find(r=>r.value.map===e&&r.value.search===t);return n||Qn(MS.find(r=>r.value.map))},sb=({selected:e,onSelect:t})=>ee.jsx(Kse,{sx:{paddingBlock:0,minWidth:"fit-content"},variant:"plain",size:"sm",slotProps:{listbox:{placement:"bottom-start"}},value:e,onChange:(n,r)=>{n!=null&&t(Qn(MS.find(i=>i.value===r)))},renderValue:n=>{if(n)return ee.jsxs(Ga,{direction:"row",gap:1,sx:{alignItems:"center"},children:[ee.jsx(oi,{level:"body-xs",fontWeight:"lg",children:n.value.map==="usa"?"ATS":"ETS2"}),ee.jsx(TN,{search:n.value.search})]})},children:Object.entries(jwe(MS,({label:n})=>n)).map(([n,r])=>ee.jsxs(DM,{children:[ee.jsx(rd,{children:ee.jsx(oi,{level:"body-xs",fontWeight:"lg",children:n})}),r==null?void 0:r.map(i=>ee.jsxs(Nse,{value:i.value,sx:{px:"1em",textTransform:"capitalize"},children:[ee.jsx(TN,{search:i.value.search}),i.value.search]},i.value.search))]},n))}),TN=({search:e})=>{switch(e){case"achievements":return ee.jsx(Jfe,{});case"places":return ee.jsx(ope,{});default:throw new zl(e)}},mw={usa:{longitude:-108,latitude:39},europe:{longitude:12,latitude:51}},Hwe=e=>{const t=$.useRef(null);rl(()=>({onAdd:()=>Qn(t.current),onRemove:()=>Qn(t.current).remove()}),{position:"top-left"});const{current:n}=J_(),[r,i]=$.useState(NT(localStorage.getItem("tm-map")==="europe"?"europe":"usa",Wwe(localStorage.getItem("tm-search")))),a=ty.useCallback(C=>{if(C==null||(i(C),localStorage.setItem("tm-map",C.value.map),localStorage.setItem("tm-search",C.value.search),!n||C.value.map===r.value.map))return;const{longitude:A,latitude:L}=mw[C.value.map];n.easeTo({zoom:4,center:[A,L]})},[n,r]);$.useEffect(()=>{if(!n)return;const C=()=>{const A=n.getCenter().lng,L=PN(A,mw.usa.longitude),I=PN(A,mw.europe.longitude);L<I&&r.value.map!=="usa"?(i(NT("usa",r.value.search)),localStorage.setItem("tm-map","usa")):I<L&&r.value.map!=="europe"&&(i(NT("europe",r.value.search)),localStorage.setItem("tm-map","europe"))};return n.on("moveend",C),()=>void n.off("moveend",C)},[n,r,i]);const c=ty.useCallback(C=>{n==null||C==null||(n.flyTo({curve:1,zoom:10.5,center:C.poi.geometry.coordinates}),n.once("moveend",A=>{const{lat:L,lng:I}=A.target.getCenter(),T=A.target.getZoom(),z=Number(A.target.getBearing().toFixed(1)),k=Math.round(A.target.getPitch());k?window.location.hash=`${T}/${L.toFixed(3)}/${I.toFixed(3)}/${z}/${k}`:z?window.location.hash=`${T}/${L.toFixed(3)}/${I.toFixed(3)}/${z}`:window.location.hash=`${T}/${L.toFixed(3)}/${I.toFixed(3)}`}))},[n]),[o,f]=$.useState([]),g=C=>ty.useCallback((A,L={enableFitBounds:!0})=>{if(o.forEach(z=>z.remove()),C(A),n==null||A==null)return;const I=K_(e.visibleStateDlcs),T=A.features.filter(z=>I.has(z.dlcGuard)).map(({coordinates:z})=>new a2.Marker().setLngLat(z).addTo(n.getMap()));if(f(T),T.length&&L.enableFitBounds){const z=Oj(T.map(H=>H.getLngLat().toArray())),k=[z[0],z[1]],U=[z[2],z[3]];n.fitBounds([k,U],{curve:1,padding:100,maxZoom:9})}},[n,o,C,f,e.visibleStateDlcs]),[_,x]=$.useState(null),M=g(x);return $.useEffect(()=>{M(_,{enableFitBounds:!1})},[_,e.visibleStateDlcs]),ee.jsx("div",{ref:t,className:"maplibregl-ctrl",style:{width:"calc(100svw - 64px)"},children:ee.jsx(Ga,{direction:"row",gap:1,children:ee.jsx(Gwe,{selected:r.value,onMapSelect:a,onPlaceSelect:c,onAchievementSelect:M,visibleStates:e.visibleStates,visibleStateDlcs:e.visibleStateDlcs})})})},Gwe=({selected:e,onMapSelect:t,onPlaceSelect:n,onAchievementSelect:r,visibleStateDlcs:i})=>{switch(e.map){case"usa":switch(e.search){case"places":return ee.jsx(tF,{selectDecorator:ee.jsx(sb,{selected:e,onSelect:t}),map:e.map,onSelect:n,visibleStateDlcs:i});case"achievements":return ee.jsx(X4,{selectDecorator:ee.jsx(sb,{selected:e,onSelect:t}),map:e.map,onSelect:r,visibleStateDlcs:i});default:throw new zl(e.search)}case"europe":switch(e.search){case"places":return ee.jsx(tF,{selectDecorator:ee.jsx(sb,{selected:e,onSelect:t}),map:e.map,onSelect:n});case"achievements":return ee.jsx(X4,{selectDecorator:ee.jsx(sb,{selected:e,onSelect:t}),map:e.map,onSelect:r});default:throw new zl(e.search)}}};function Wwe(e){return e==="achievements"?e:"places"}function PN(e,t){const n=x4(e)/2,r=x4(t)/2;return Math.abs(Math.sin(n)-Math.sin(r))}const qwe=e=>{const t=$.useRef(null),[n,r]=$.useState(!1);rl(()=>({onAdd:()=>Qn(t.current),onRemove:()=>Qn(t.current).remove()}));const i=$.useCallback(()=>{r(!n),e.onToggle(!n)},[n]);return ee.jsx("div",{ref:t,className:"maplibregl-ctrl maplibregl-ctrl-group",style:{display:e.visible?"":"none"},children:ee.jsx(fu,{slots:{root:fu},sx:{minWidth:0,minHeight:0,borderRadius:0,backgroundColor:n?"var(--joy-palette-primary-softHoverBg) !important":void 0},variant:n?"soft":"plain",title:"Browse Photo Spheres",onClick:i,children:ee.jsx(Dj,{})})})},BT=(e,t)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},Xwe=()=>{const e=$.useRef(null),[t,n]=$.useState(!1),[r,i]=$.useState(!1),[a,c]=$.useState(window.location.origin),o=J_();return rl(()=>({onAdd:()=>Qn(e.current),onRemove:()=>Qn(e.current).remove()})),$.useEffect(()=>{const f=o.current;if(!f||!t)return;const g=()=>{const M=f.getCenter(),C=f.getBearing(),A=f.getPitch(),L=C||A?[C,A]:[],I=f.getZoom(),T=_?"?"+new URLSearchParams({mlat:String(BT(_.getLngLat().lat,2)),mlon:String(BT(_.getLngLat().lng,2))}).toString():"",z="#"+[I,M.lat,M.lng,...L].map(k=>BT(k,2)).join("/");c(window.location.origin+T+z)};let _,x;if(r){_=new a2.Marker,_.setLngLat(f.getCenter()).setDraggable(!0).addTo(f.getMap());let M=!0;x=()=>M&&_.setLngLat(f.getCenter()),_.on("dragend",()=>{M=!1,f.easeTo({center:_==null?void 0:_.getLngLat()}),f.once("moveend",()=>M=!0)})}return g(),f.on("moveend",g),x&&f.on("move",x),()=>{f.off("moveend",g),x&&f.off("move",x),_==null||_.remove()}},[o,t,r]),ee.jsxs("div",{ref:e,children:[ee.jsx("div",{className:"maplibregl-ctrl maplibregl-ctrl-group",children:ee.jsx(fu,{sx:{minWidth:0,minHeight:0,borderRadius:0},title:"Share",onClick:()=>n(!t),children:ee.jsx(tpe,{})})}),ee.jsx(uV,{open:t,anchor:"right",onClose:()=>n(!1),variant:"plain",hideBackdrop:!0,slotProps:{root:{sx:{pointerEvents:"none"}},content:{sx:{bgcolor:"transparent",p:1,boxShadow:"none",right:t?48:0}}},children:ee.jsxs(fV,{variant:"outlined",sx:{pointerEvents:"auto",borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,overflow:"auto"},children:[ee.jsx(oV,{children:"Share"}),ee.jsx(dV,{}),ee.jsx(a_,{}),ee.jsxs(iV,{sx:{gap:2,overflow:"hidden",flexGrow:1,justifyContent:"center"},children:[ee.jsx(oi,{children:"Share a link to this map"}),ee.jsx(xie,{readOnly:!0,sx:{"--Input-decoratorChildHeight":"36px"},onFocus:f=>f.target.select(),value:a,endDecorator:ee.jsx(eV,{sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:()=>void navigator.clipboard.writeText(a).catch(()=>alert("Could not copy to clipboard ")),children:"Copy"})}),ee.jsx(Of,{label:"Include marker",checked:r,onChange:f=>i(f.target.checked)})]})]})})]})};function l7(e){return new Set([...e].map(Zwe).concat(lo.CA))}function Zwe(e){switch(e){case wo.Arizona:return lo.AZ;case wo.Arkansas:return lo.AR;case wo.Colorado:return lo.CO;case wo.Idaho:return lo.ID;case wo.Iowa:return lo.IA;case wo.Kansas:return lo.KS;case wo.Missouri:return lo.MO;case wo.Montana:return lo.MT;case wo.Nebraska:return lo.NE;case wo.Nevada:return lo.NV;case wo.NewMexico:return lo.NM;case wo.Oklahoma:return lo.OK;case wo.Oregon:return lo.OR;case wo.Texas:return lo.TX;case wo.Utah:return lo.UT;case wo.Washington:return lo.WA;case wo.Wyoming:return lo.WY;default:throw new zl(e)}}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const BL="175",Ywe=0,AN=1,Kwe=2,c7=1,Jwe=2,Xc=3,Xh=0,Hs=1,Jc=2,kh=0,cg=1,IN=2,RN=3,LN=4,Qwe=5,pf=100,eSe=101,tSe=102,nSe=103,rSe=104,iSe=200,oSe=201,sSe=202,aSe=203,nI=204,rI=205,lSe=206,cSe=207,uSe=208,hSe=209,dSe=210,fSe=211,pSe=212,mSe=213,gSe=214,iI=0,oI=1,sI=2,kg=3,aI=4,lI=5,cI=6,uI=7,u7=0,vSe=1,ySe=2,Dh=0,h7=1,_Se=2,xSe=3,bSe=4,wSe=5,SSe=6,MSe=7,d7=300,Dg=301,zg=302,hI=303,dI=304,p2=306,fI=1e3,wf=1001,pI=1002,Ll=1003,CSe=1004,ab=1005,_a=1006,UT=1007,wh=1008,gu=1009,f7=1010,p7=1011,v_=1012,UL=1013,$f=1014,tu=1015,dx=1016,$L=1017,VL=1018,y_=1020,m7=35902,g7=1021,v7=1022,Pl=1023,y7=1024,_7=1025,__=1026,x_=1027,x7=1028,jL=1029,b7=1030,HL=1031,GL=1033,gw=33776,vw=33777,yw=33778,_w=33779,mI=35840,gI=35841,vI=35842,yI=35843,_I=36196,xI=37492,bI=37496,wI=37808,SI=37809,MI=37810,CI=37811,EI=37812,TI=37813,PI=37814,AI=37815,II=37816,RI=37817,LI=37818,kI=37819,DI=37820,zI=37821,xw=36492,OI=36494,FI=36495,w7=36283,NI=36284,BI=36285,UI=36286,ESe=3200,TSe=3201,PSe=0,ASe=1,yh="",Ua="srgb",Vf="srgb-linear",CS="linear",qr="srgb",em=7680,kN=519,ISe=512,RSe=513,LSe=514,S7=515,kSe=516,DSe=517,zSe=518,OSe=519,DN=35044,zN="300 es",nu=2e3,ES=2001;class Xg{addEventListener(t,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(n)===-1&&r[t].push(n)}hasEventListener(t,n){const r=this._listeners;return r===void 0?!1:r[t]!==void 0&&r[t].indexOf(n)!==-1}removeEventListener(t,n){const r=this._listeners;if(r===void 0)return;const i=r[t];if(i!==void 0){const a=i.indexOf(n);a!==-1&&i.splice(a,1)}}dispatchEvent(t){const n=this._listeners;if(n===void 0)return;const r=n[t.type];if(r!==void 0){t.target=this;const i=r.slice(0);for(let a=0,c=i.length;a<c;a++)i[a].call(this,t);t.target=null}}}const is=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ON=1234567;const Sy=Math.PI/180,b_=180/Math.PI;function Zg(){const e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(is[e&255]+is[e>>8&255]+is[e>>16&255]+is[e>>24&255]+"-"+is[t&255]+is[t>>8&255]+"-"+is[t>>16&15|64]+is[t>>24&255]+"-"+is[n&63|128]+is[n>>8&255]+"-"+is[n>>16&255]+is[n>>24&255]+is[r&255]+is[r>>8&255]+is[r>>16&255]+is[r>>24&255]).toLowerCase()}function xr(e,t,n){return Math.max(t,Math.min(n,e))}function WL(e,t){return(e%t+t)%t}function FSe(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)}function NSe(e,t,n){return e!==t?(n-e)/(t-e):0}function My(e,t,n){return(1-n)*e+n*t}function BSe(e,t,n,r){return My(e,t,1-Math.exp(-n*r))}function USe(e,t=1){return t-Math.abs(WL(e,t*2)-t)}function $Se(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*(3-2*e))}function VSe(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*e*(e*(e*6-15)+10))}function jSe(e,t){return e+Math.floor(Math.random()*(t-e+1))}function HSe(e,t){return e+Math.random()*(t-e)}function GSe(e){return e*(.5-Math.random())}function WSe(e){e!==void 0&&(ON=e);let t=ON+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function qSe(e){return e*Sy}function XSe(e){return e*b_}function ZSe(e){return(e&e-1)===0&&e!==0}function YSe(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function KSe(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function JSe(e,t,n,r,i){const a=Math.cos,c=Math.sin,o=a(n/2),f=c(n/2),g=a((t+r)/2),_=c((t+r)/2),x=a((t-r)/2),M=c((t-r)/2),C=a((r-t)/2),A=c((r-t)/2);switch(i){case"XYX":e.set(o*_,f*x,f*M,o*g);break;case"YZY":e.set(f*M,o*_,f*x,o*g);break;case"ZXZ":e.set(f*x,f*M,o*_,o*g);break;case"XZX":e.set(o*_,f*A,f*C,o*g);break;case"YXY":e.set(f*C,o*_,f*A,o*g);break;case"ZYZ":e.set(f*A,f*C,o*_,o*g);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function bm(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function ms(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(e*4294967295);case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int32Array:return Math.round(e*2147483647);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}const mr={DEG2RAD:Sy,RAD2DEG:b_,generateUUID:Zg,clamp:xr,euclideanModulo:WL,mapLinear:FSe,inverseLerp:NSe,lerp:My,damp:BSe,pingpong:USe,smoothstep:$Se,smootherstep:VSe,randInt:jSe,randFloat:HSe,randFloatSpread:GSe,seededRandom:WSe,degToRad:qSe,radToDeg:XSe,isPowerOfTwo:ZSe,ceilPowerOfTwo:YSe,floorPowerOfTwo:KSe,setQuaternionFromProperEuler:JSe,normalize:ms,denormalize:bm};class Dr{constructor(t=0,n=0){Dr.prototype.isVector2=!0,this.x=t,this.y=n}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,n){return this.x=t,this.y=n,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const n=this.x,r=this.y,i=t.elements;return this.x=i[0]*n+i[3]*r+i[6],this.y=i[1]*n+i[4]*r+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,n){return this.x=xr(this.x,t.x,n.x),this.y=xr(this.y,t.y,n.y),this}clampScalar(t,n){return this.x=xr(this.x,t,n),this.y=xr(this.y,t,n),this}clampLength(t,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(xr(r,t,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const n=Math.sqrt(this.lengthSq()*t.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(t)/n;return Math.acos(xr(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const n=this.x-t.x,r=this.y-t.y;return n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this}lerpVectors(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t}fromBufferAttribute(t,n){return this.x=t.getX(n),this.y=t.getY(n),this}rotateAround(t,n){const r=Math.cos(n),i=Math.sin(n),a=this.x-t.x,c=this.y-t.y;return this.x=a*r-c*i+t.x,this.y=a*i+c*r+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class sr{constructor(t,n,r,i,a,c,o,f,g){sr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,n,r,i,a,c,o,f,g)}set(t,n,r,i,a,c,o,f,g){const _=this.elements;return _[0]=t,_[1]=i,_[2]=o,_[3]=n,_[4]=a,_[5]=f,_[6]=r,_[7]=c,_[8]=g,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const n=this.elements,r=t.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(t,n,r){return t.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const n=t.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,n){const r=t.elements,i=n.elements,a=this.elements,c=r[0],o=r[3],f=r[6],g=r[1],_=r[4],x=r[7],M=r[2],C=r[5],A=r[8],L=i[0],I=i[3],T=i[6],z=i[1],k=i[4],U=i[7],H=i[2],V=i[5],q=i[8];return a[0]=c*L+o*z+f*H,a[3]=c*I+o*k+f*V,a[6]=c*T+o*U+f*q,a[1]=g*L+_*z+x*H,a[4]=g*I+_*k+x*V,a[7]=g*T+_*U+x*q,a[2]=M*L+C*z+A*H,a[5]=M*I+C*k+A*V,a[8]=M*T+C*U+A*q,this}multiplyScalar(t){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=t,n[4]*=t,n[7]*=t,n[2]*=t,n[5]*=t,n[8]*=t,this}determinant(){const t=this.elements,n=t[0],r=t[1],i=t[2],a=t[3],c=t[4],o=t[5],f=t[6],g=t[7],_=t[8];return n*c*_-n*o*g-r*a*_+r*o*f+i*a*g-i*c*f}invert(){const t=this.elements,n=t[0],r=t[1],i=t[2],a=t[3],c=t[4],o=t[5],f=t[6],g=t[7],_=t[8],x=_*c-o*g,M=o*f-_*a,C=g*a-c*f,A=n*x+r*M+i*C;if(A===0)return this.set(0,0,0,0,0,0,0,0,0);const L=1/A;return t[0]=x*L,t[1]=(i*g-_*r)*L,t[2]=(o*r-i*c)*L,t[3]=M*L,t[4]=(_*n-i*f)*L,t[5]=(i*a-o*n)*L,t[6]=C*L,t[7]=(r*f-g*n)*L,t[8]=(c*n-r*a)*L,this}transpose(){let t;const n=this.elements;return t=n[1],n[1]=n[3],n[3]=t,t=n[2],n[2]=n[6],n[6]=t,t=n[5],n[5]=n[7],n[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const n=this.elements;return t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8],this}setUvTransform(t,n,r,i,a,c,o){const f=Math.cos(a),g=Math.sin(a);return this.set(r*f,r*g,-r*(f*c+g*o)+c+t,-i*g,i*f,-i*(-g*c+f*o)+o+n,0,0,1),this}scale(t,n){return this.premultiply($T.makeScale(t,n)),this}rotate(t){return this.premultiply($T.makeRotation(-t)),this}translate(t,n){return this.premultiply($T.makeTranslation(t,n)),this}makeTranslation(t,n){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,n,0,0,1),this}makeRotation(t){const n=Math.cos(t),r=Math.sin(t);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(t,n){return this.set(t,0,0,0,n,0,0,0,1),this}equals(t){const n=this.elements,r=t.elements;for(let i=0;i<9;i++)if(n[i]!==r[i])return!1;return!0}fromArray(t,n=0){for(let r=0;r<9;r++)this.elements[r]=t[r+n];return this}toArray(t=[],n=0){const r=this.elements;return t[n]=r[0],t[n+1]=r[1],t[n+2]=r[2],t[n+3]=r[3],t[n+4]=r[4],t[n+5]=r[5],t[n+6]=r[6],t[n+7]=r[7],t[n+8]=r[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const $T=new sr;function M7(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function TS(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function QSe(){const e=TS("canvas");return e.style.display="block",e}const FN={};function bw(e){e in FN||(FN[e]=!0,console.warn(e))}function eMe(e,t,n){return new Promise(function(r,i){function a(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(a,n);break;default:r()}}setTimeout(a,n)})}function tMe(e){const t=e.elements;t[2]=.5*t[2]+.5*t[3],t[6]=.5*t[6]+.5*t[7],t[10]=.5*t[10]+.5*t[11],t[14]=.5*t[14]+.5*t[15]}function nMe(e){const t=e.elements;t[11]===-1?(t[10]=-t[10]-1,t[14]=-t[14]):(t[10]=-t[10],t[14]=-t[14]+1)}const NN=new sr().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),BN=new sr().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function rMe(){const e={enabled:!0,workingColorSpace:Vf,spaces:{},convert:function(i,a,c){return this.enabled===!1||a===c||!a||!c||(this.spaces[a].transfer===qr&&(i.r=iu(i.r),i.g=iu(i.g),i.b=iu(i.b)),this.spaces[a].primaries!==this.spaces[c].primaries&&(i.applyMatrix3(this.spaces[a].toXYZ),i.applyMatrix3(this.spaces[c].fromXYZ)),this.spaces[c].transfer===qr&&(i.r=ug(i.r),i.g=ug(i.g),i.b=ug(i.b))),i},fromWorkingColorSpace:function(i,a){return this.convert(i,this.workingColorSpace,a)},toWorkingColorSpace:function(i,a){return this.convert(i,a,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===yh?CS:this.spaces[i].transfer},getLuminanceCoefficients:function(i,a=this.workingColorSpace){return i.fromArray(this.spaces[a].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,a,c){return i.copy(this.spaces[a].toXYZ).multiply(this.spaces[c].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return e.define({[Vf]:{primaries:t,whitePoint:r,transfer:CS,toXYZ:NN,fromXYZ:BN,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Ua},outputColorSpaceConfig:{drawingBufferColorSpace:Ua}},[Ua]:{primaries:t,whitePoint:r,transfer:qr,toXYZ:NN,fromXYZ:BN,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Ua}}}),e}const Tr=rMe();function iu(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function ug(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}let tm;class iMe{static getDataURL(t,n="image/png"){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let r;if(t instanceof HTMLCanvasElement)r=t;else{tm===void 0&&(tm=TS("canvas")),tm.width=t.width,tm.height=t.height;const i=tm.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),r=tm}return r.toDataURL(n)}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const n=TS("canvas");n.width=t.width,n.height=t.height;const r=n.getContext("2d");r.drawImage(t,0,0,t.width,t.height);const i=r.getImageData(0,0,t.width,t.height),a=i.data;for(let c=0;c<a.length;c++)a[c]=iu(a[c]/255)*255;return r.putImageData(i,0,0),n}else if(t.data){const n=t.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(iu(n[r]/255)*255):n[r]=iu(n[r]);return{data:n,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let oMe=0;class qL{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:oMe++}),this.uuid=Zg(),this.data=t,this.dataReady=!0,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const n=t===void 0||typeof t=="string";if(!n&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let a;if(Array.isArray(i)){a=[];for(let c=0,o=i.length;c<o;c++)i[c].isDataTexture?a.push(VT(i[c].image)):a.push(VT(i[c]))}else a=VT(i);r.url=a}return n||(t.images[this.uuid]=r),r}}function VT(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?iMe.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let sMe=0;class Ho extends Xg{constructor(t=Ho.DEFAULT_IMAGE,n=Ho.DEFAULT_MAPPING,r=wf,i=wf,a=_a,c=wh,o=Pl,f=gu,g=Ho.DEFAULT_ANISOTROPY,_=yh){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:sMe++}),this.uuid=Zg(),this.name="",this.source=new qL(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=a,this.minFilter=c,this.anisotropy=g,this.format=o,this.internalFormat=null,this.type=f,this.offset=new Dr(0,0),this.repeat=new Dr(1,1),this.center=new Dr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new sr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=_,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=t===void 0||typeof t=="string";if(!n&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==d7)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case fI:t.x=t.x-Math.floor(t.x);break;case wf:t.x=t.x<0?0:1;break;case pI:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case fI:t.y=t.y-Math.floor(t.y);break;case wf:t.y=t.y<0?0:1;break;case pI:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}Ho.DEFAULT_IMAGE=null;Ho.DEFAULT_MAPPING=d7;Ho.DEFAULT_ANISOTROPY=1;class Fi{constructor(t=0,n=0,r=0,i=1){Fi.prototype.isVector4=!0,this.x=t,this.y=n,this.z=r,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,n,r,i){return this.x=t,this.y=n,this.z=r,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this.w=t.w+n.w,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this.w+=t.w*n,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this.w=t.w-n.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const n=this.x,r=this.y,i=this.z,a=this.w,c=t.elements;return this.x=c[0]*n+c[4]*r+c[8]*i+c[12]*a,this.y=c[1]*n+c[5]*r+c[9]*i+c[13]*a,this.z=c[2]*n+c[6]*r+c[10]*i+c[14]*a,this.w=c[3]*n+c[7]*r+c[11]*i+c[15]*a,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const n=Math.sqrt(1-t.w*t.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/n,this.y=t.y/n,this.z=t.z/n),this}setAxisAngleFromRotationMatrix(t){let n,r,i,a;const f=t.elements,g=f[0],_=f[4],x=f[8],M=f[1],C=f[5],A=f[9],L=f[2],I=f[6],T=f[10];if(Math.abs(_-M)<.01&&Math.abs(x-L)<.01&&Math.abs(A-I)<.01){if(Math.abs(_+M)<.1&&Math.abs(x+L)<.1&&Math.abs(A+I)<.1&&Math.abs(g+C+T-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const k=(g+1)/2,U=(C+1)/2,H=(T+1)/2,V=(_+M)/4,q=(x+L)/4,J=(A+I)/4;return k>U&&k>H?k<.01?(r=0,i=.707106781,a=.707106781):(r=Math.sqrt(k),i=V/r,a=q/r):U>H?U<.01?(r=.707106781,i=0,a=.707106781):(i=Math.sqrt(U),r=V/i,a=J/i):H<.01?(r=.707106781,i=.707106781,a=0):(a=Math.sqrt(H),r=q/a,i=J/a),this.set(r,i,a,n),this}let z=Math.sqrt((I-A)*(I-A)+(x-L)*(x-L)+(M-_)*(M-_));return Math.abs(z)<.001&&(z=1),this.x=(I-A)/z,this.y=(x-L)/z,this.z=(M-_)/z,this.w=Math.acos((g+C+T-1)/2),this}setFromMatrixPosition(t){const n=t.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,n){return this.x=xr(this.x,t.x,n.x),this.y=xr(this.y,t.y,n.y),this.z=xr(this.z,t.z,n.z),this.w=xr(this.w,t.w,n.w),this}clampScalar(t,n){return this.x=xr(this.x,t,n),this.y=xr(this.y,t,n),this.z=xr(this.z,t,n),this.w=xr(this.w,t,n),this}clampLength(t,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(xr(r,t,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this.w+=(t.w-this.w)*n,this}lerpVectors(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this.z=t.z+(n.z-t.z)*r,this.w=t.w+(n.w-t.w)*r,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this.z=t[n+2],this.w=t[n+3],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t[n+3]=this.w,t}fromBufferAttribute(t,n){return this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this.w=t.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class aMe extends Xg{constructor(t=1,n=1,r={}){super(),this.isRenderTarget=!0,this.width=t,this.height=n,this.depth=1,this.scissor=new Fi(0,0,t,n),this.scissorTest=!1,this.viewport=new Fi(0,0,t,n);const i={width:t,height:n,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:_a,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const a=new Ho(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);a.flipY=!1,a.generateMipmaps=r.generateMipmaps,a.internalFormat=r.internalFormat,this.textures=[];const c=r.count;for(let o=0;o<c;o++)this.textures[o]=a.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(t){this.textures[0]=t}set depthTexture(t){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),t!==null&&(t.renderTarget=this),this._depthTexture=t}get depthTexture(){return this._depthTexture}setSize(t,n,r=1){if(this.width!==t||this.height!==n||this.depth!==r){this.width=t,this.height=n,this.depth=r;for(let i=0,a=this.textures.length;i<a;i++)this.textures[i].image.width=t,this.textures[i].image.height=n,this.textures[i].image.depth=r;this.dispose()}this.viewport.set(0,0,t,n),this.scissor.set(0,0,t,n)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.textures.length=0;for(let n=0,r=t.textures.length;n<r;n++){this.textures[n]=t.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const i=Object.assign({},t.textures[n].image);this.textures[n].source=new qL(i)}return this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.resolveDepthBuffer=t.resolveDepthBuffer,this.resolveStencilBuffer=t.resolveStencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Zh extends aMe{constructor(t=1,n=1,r={}){super(t,n,r),this.isWebGLRenderTarget=!0}}class C7 extends Ho{constructor(t=null,n=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:n,height:r,depth:i},this.magFilter=Ll,this.minFilter=Ll,this.wrapR=wf,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class lMe extends Ho{constructor(t=null,n=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:n,height:r,depth:i},this.magFilter=Ll,this.minFilter=Ll,this.wrapR=wf,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ud{constructor(t=0,n=0,r=0,i=1){this.isQuaternion=!0,this._x=t,this._y=n,this._z=r,this._w=i}static slerpFlat(t,n,r,i,a,c,o){let f=r[i+0],g=r[i+1],_=r[i+2],x=r[i+3];const M=a[c+0],C=a[c+1],A=a[c+2],L=a[c+3];if(o===0){t[n+0]=f,t[n+1]=g,t[n+2]=_,t[n+3]=x;return}if(o===1){t[n+0]=M,t[n+1]=C,t[n+2]=A,t[n+3]=L;return}if(x!==L||f!==M||g!==C||_!==A){let I=1-o;const T=f*M+g*C+_*A+x*L,z=T>=0?1:-1,k=1-T*T;if(k>Number.EPSILON){const H=Math.sqrt(k),V=Math.atan2(H,T*z);I=Math.sin(I*V)/H,o=Math.sin(o*V)/H}const U=o*z;if(f=f*I+M*U,g=g*I+C*U,_=_*I+A*U,x=x*I+L*U,I===1-o){const H=1/Math.sqrt(f*f+g*g+_*_+x*x);f*=H,g*=H,_*=H,x*=H}}t[n]=f,t[n+1]=g,t[n+2]=_,t[n+3]=x}static multiplyQuaternionsFlat(t,n,r,i,a,c){const o=r[i],f=r[i+1],g=r[i+2],_=r[i+3],x=a[c],M=a[c+1],C=a[c+2],A=a[c+3];return t[n]=o*A+_*x+f*C-g*M,t[n+1]=f*A+_*M+g*x-o*C,t[n+2]=g*A+_*C+o*M-f*x,t[n+3]=_*A-o*x-f*M-g*C,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,n,r,i){return this._x=t,this._y=n,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,n=!0){const r=t._x,i=t._y,a=t._z,c=t._order,o=Math.cos,f=Math.sin,g=o(r/2),_=o(i/2),x=o(a/2),M=f(r/2),C=f(i/2),A=f(a/2);switch(c){case"XYZ":this._x=M*_*x+g*C*A,this._y=g*C*x-M*_*A,this._z=g*_*A+M*C*x,this._w=g*_*x-M*C*A;break;case"YXZ":this._x=M*_*x+g*C*A,this._y=g*C*x-M*_*A,this._z=g*_*A-M*C*x,this._w=g*_*x+M*C*A;break;case"ZXY":this._x=M*_*x-g*C*A,this._y=g*C*x+M*_*A,this._z=g*_*A+M*C*x,this._w=g*_*x-M*C*A;break;case"ZYX":this._x=M*_*x-g*C*A,this._y=g*C*x+M*_*A,this._z=g*_*A-M*C*x,this._w=g*_*x+M*C*A;break;case"YZX":this._x=M*_*x+g*C*A,this._y=g*C*x+M*_*A,this._z=g*_*A-M*C*x,this._w=g*_*x-M*C*A;break;case"XZY":this._x=M*_*x-g*C*A,this._y=g*C*x-M*_*A,this._z=g*_*A+M*C*x,this._w=g*_*x+M*C*A;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,n){const r=n/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const n=t.elements,r=n[0],i=n[4],a=n[8],c=n[1],o=n[5],f=n[9],g=n[2],_=n[6],x=n[10],M=r+o+x;if(M>0){const C=.5/Math.sqrt(M+1);this._w=.25/C,this._x=(_-f)*C,this._y=(a-g)*C,this._z=(c-i)*C}else if(r>o&&r>x){const C=2*Math.sqrt(1+r-o-x);this._w=(_-f)/C,this._x=.25*C,this._y=(i+c)/C,this._z=(a+g)/C}else if(o>x){const C=2*Math.sqrt(1+o-r-x);this._w=(a-g)/C,this._x=(i+c)/C,this._y=.25*C,this._z=(f+_)/C}else{const C=2*Math.sqrt(1+x-r-o);this._w=(c-i)/C,this._x=(a+g)/C,this._y=(f+_)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(t,n){let r=t.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*n.z-t.z*n.y,this._y=t.z*n.x-t.x*n.z,this._z=t.x*n.y-t.y*n.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(xr(this.dot(t),-1,1)))}rotateTowards(t,n){const r=this.angleTo(t);if(r===0)return this;const i=Math.min(1,n/r);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,n){const r=t._x,i=t._y,a=t._z,c=t._w,o=n._x,f=n._y,g=n._z,_=n._w;return this._x=r*_+c*o+i*g-a*f,this._y=i*_+c*f+a*o-r*g,this._z=a*_+c*g+r*f-i*o,this._w=c*_-r*o-i*f-a*g,this._onChangeCallback(),this}slerp(t,n){if(n===0)return this;if(n===1)return this.copy(t);const r=this._x,i=this._y,a=this._z,c=this._w;let o=c*t._w+r*t._x+i*t._y+a*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=c,this._x=r,this._y=i,this._z=a,this;const f=1-o*o;if(f<=Number.EPSILON){const C=1-n;return this._w=C*c+n*this._w,this._x=C*r+n*this._x,this._y=C*i+n*this._y,this._z=C*a+n*this._z,this.normalize(),this}const g=Math.sqrt(f),_=Math.atan2(g,o),x=Math.sin((1-n)*_)/g,M=Math.sin(n*_)/g;return this._w=c*x+this._w*M,this._x=r*x+this._x*M,this._y=i*x+this._y*M,this._z=a*x+this._z*M,this._onChangeCallback(),this}slerpQuaternions(t,n,r){return this.copy(t).slerp(n,r)}random(){const t=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),a=Math.sqrt(r);return this.set(i*Math.sin(t),i*Math.cos(t),a*Math.sin(n),a*Math.cos(n))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,n=0){return this._x=t[n],this._y=t[n+1],this._z=t[n+2],this._w=t[n+3],this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._w,t}fromBufferAttribute(t,n){return this._x=t.getX(n),this._y=t.getY(n),this._z=t.getZ(n),this._w=t.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class dt{constructor(t=0,n=0,r=0){dt.prototype.isVector3=!0,this.x=t,this.y=n,this.z=r}set(t,n,r){return r===void 0&&(r=this.z),this.x=t,this.y=n,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,n){return this.x=t.x*n.x,this.y=t.y*n.y,this.z=t.z*n.z,this}applyEuler(t){return this.applyQuaternion(UN.setFromEuler(t))}applyAxisAngle(t,n){return this.applyQuaternion(UN.setFromAxisAngle(t,n))}applyMatrix3(t){const n=this.x,r=this.y,i=this.z,a=t.elements;return this.x=a[0]*n+a[3]*r+a[6]*i,this.y=a[1]*n+a[4]*r+a[7]*i,this.z=a[2]*n+a[5]*r+a[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const n=this.x,r=this.y,i=this.z,a=t.elements,c=1/(a[3]*n+a[7]*r+a[11]*i+a[15]);return this.x=(a[0]*n+a[4]*r+a[8]*i+a[12])*c,this.y=(a[1]*n+a[5]*r+a[9]*i+a[13])*c,this.z=(a[2]*n+a[6]*r+a[10]*i+a[14])*c,this}applyQuaternion(t){const n=this.x,r=this.y,i=this.z,a=t.x,c=t.y,o=t.z,f=t.w,g=2*(c*i-o*r),_=2*(o*n-a*i),x=2*(a*r-c*n);return this.x=n+f*g+c*x-o*_,this.y=r+f*_+o*g-a*x,this.z=i+f*x+a*_-c*g,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const n=this.x,r=this.y,i=this.z,a=t.elements;return this.x=a[0]*n+a[4]*r+a[8]*i,this.y=a[1]*n+a[5]*r+a[9]*i,this.z=a[2]*n+a[6]*r+a[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,n){return this.x=xr(this.x,t.x,n.x),this.y=xr(this.y,t.y,n.y),this.z=xr(this.z,t.z,n.z),this}clampScalar(t,n){return this.x=xr(this.x,t,n),this.y=xr(this.y,t,n),this.z=xr(this.z,t,n),this}clampLength(t,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(xr(r,t,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this}lerpVectors(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this.z=t.z+(n.z-t.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,n){const r=t.x,i=t.y,a=t.z,c=n.x,o=n.y,f=n.z;return this.x=i*f-a*o,this.y=a*c-r*f,this.z=r*o-i*c,this}projectOnVector(t){const n=t.lengthSq();if(n===0)return this.set(0,0,0);const r=t.dot(this)/n;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return jT.copy(this).projectOnVector(t),this.sub(jT)}reflect(t){return this.sub(jT.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const n=Math.sqrt(this.lengthSq()*t.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(t)/n;return Math.acos(xr(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const n=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return n*n+r*r+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,n,r){const i=Math.sin(n)*t;return this.x=i*Math.sin(r),this.y=Math.cos(n)*t,this.z=i*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,n,r){return this.x=t*Math.sin(n),this.y=r,this.z=t*Math.cos(n),this}setFromMatrixPosition(t){const n=t.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(t){const n=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=n,this.y=r,this.z=i,this}setFromMatrixColumn(t,n){return this.fromArray(t.elements,n*4)}setFromMatrix3Column(t,n){return this.fromArray(t.elements,n*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this.z=t[n+2],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t}fromBufferAttribute(t,n){return this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,n=Math.random()*2-1,r=Math.sqrt(1-n*n);return this.x=r*Math.cos(t),this.y=n,this.z=r*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const jT=new dt,UN=new ud;class Yg{constructor(t=new dt(1/0,1/0,1/0),n=new dt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=n}set(t,n){return this.min.copy(t),this.max.copy(n),this}setFromArray(t){this.makeEmpty();for(let n=0,r=t.length;n<r;n+=3)this.expandByPoint(yl.fromArray(t,n));return this}setFromBufferAttribute(t){this.makeEmpty();for(let n=0,r=t.count;n<r;n++)this.expandByPoint(yl.fromBufferAttribute(t,n));return this}setFromPoints(t){this.makeEmpty();for(let n=0,r=t.length;n<r;n++)this.expandByPoint(t[n]);return this}setFromCenterAndSize(t,n){const r=yl.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}setFromObject(t,n=!1){return this.makeEmpty(),this.expandByObject(t,n)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,n=!1){t.updateWorldMatrix(!1,!1);const r=t.geometry;if(r!==void 0){const a=r.getAttribute("position");if(n===!0&&a!==void 0&&t.isInstancedMesh!==!0)for(let c=0,o=a.count;c<o;c++)t.isMesh===!0?t.getVertexPosition(c,yl):yl.fromBufferAttribute(a,c),yl.applyMatrix4(t.matrixWorld),this.expandByPoint(yl);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),lb.copy(t.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),lb.copy(r.boundingBox)),lb.applyMatrix4(t.matrixWorld),this.union(lb)}const i=t.children;for(let a=0,c=i.length;a<c;a++)this.expandByObject(i[a],n);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,n){return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,yl),yl.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let n,r;return t.normal.x>0?(n=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(n=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(n+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(n+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(n+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(n+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),n<=-t.constant&&r>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(R0),cb.subVectors(this.max,R0),nm.subVectors(t.a,R0),rm.subVectors(t.b,R0),im.subVectors(t.c,R0),rh.subVectors(rm,nm),ih.subVectors(im,rm),Qd.subVectors(nm,im);let n=[0,-rh.z,rh.y,0,-ih.z,ih.y,0,-Qd.z,Qd.y,rh.z,0,-rh.x,ih.z,0,-ih.x,Qd.z,0,-Qd.x,-rh.y,rh.x,0,-ih.y,ih.x,0,-Qd.y,Qd.x,0];return!HT(n,nm,rm,im,cb)||(n=[1,0,0,0,1,0,0,0,1],!HT(n,nm,rm,im,cb))?!1:(ub.crossVectors(rh,ih),n=[ub.x,ub.y,ub.z],HT(n,nm,rm,im,cb))}clampPoint(t,n){return n.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,yl).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(yl).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(jc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),jc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),jc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),jc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),jc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),jc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),jc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),jc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(jc),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const jc=[new dt,new dt,new dt,new dt,new dt,new dt,new dt,new dt],yl=new dt,lb=new Yg,nm=new dt,rm=new dt,im=new dt,rh=new dt,ih=new dt,Qd=new dt,R0=new dt,cb=new dt,ub=new dt,ef=new dt;function HT(e,t,n,r,i){for(let a=0,c=e.length-3;a<=c;a+=3){ef.fromArray(e,a);const o=i.x*Math.abs(ef.x)+i.y*Math.abs(ef.y)+i.z*Math.abs(ef.z),f=t.dot(ef),g=n.dot(ef),_=r.dot(ef);if(Math.max(-Math.max(f,g,_),Math.min(f,g,_))>o)return!1}return!0}const cMe=new Yg,L0=new dt,GT=new dt;class m2{constructor(t=new dt,n=-1){this.isSphere=!0,this.center=t,this.radius=n}set(t,n){return this.center.copy(t),this.radius=n,this}setFromPoints(t,n){const r=this.center;n!==void 0?r.copy(n):cMe.setFromPoints(t).getCenter(r);let i=0;for(let a=0,c=t.length;a<c;a++)i=Math.max(i,r.distanceToSquared(t[a]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const n=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=n*n}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,n){const r=this.center.distanceToSquared(t);return n.copy(t),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;L0.subVectors(t,this.center);const n=L0.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),i=(r-this.radius)*.5;this.center.addScaledVector(L0,i/r),this.radius+=i}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(GT.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(L0.copy(t.center).add(GT)),this.expandByPoint(L0.copy(t.center).sub(GT))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Hc=new dt,WT=new dt,hb=new dt,oh=new dt,qT=new dt,db=new dt,XT=new dt;class XL{constructor(t=new dt,n=new dt(0,0,-1)){this.origin=t,this.direction=n}set(t,n){return this.origin.copy(t),this.direction.copy(n),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,n){return n.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Hc)),this}closestPointToPoint(t,n){n.subVectors(t,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const n=Hc.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(Hc.copy(this.origin).addScaledVector(this.direction,n),Hc.distanceToSquared(t))}distanceSqToSegment(t,n,r,i){WT.copy(t).add(n).multiplyScalar(.5),hb.copy(n).sub(t).normalize(),oh.copy(this.origin).sub(WT);const a=t.distanceTo(n)*.5,c=-this.direction.dot(hb),o=oh.dot(this.direction),f=-oh.dot(hb),g=oh.lengthSq(),_=Math.abs(1-c*c);let x,M,C,A;if(_>0)if(x=c*f-o,M=c*o-f,A=a*_,x>=0)if(M>=-A)if(M<=A){const L=1/_;x*=L,M*=L,C=x*(x+c*M+2*o)+M*(c*x+M+2*f)+g}else M=a,x=Math.max(0,-(c*M+o)),C=-x*x+M*(M+2*f)+g;else M=-a,x=Math.max(0,-(c*M+o)),C=-x*x+M*(M+2*f)+g;else M<=-A?(x=Math.max(0,-(-c*a+o)),M=x>0?-a:Math.min(Math.max(-a,-f),a),C=-x*x+M*(M+2*f)+g):M<=A?(x=0,M=Math.min(Math.max(-a,-f),a),C=M*(M+2*f)+g):(x=Math.max(0,-(c*a+o)),M=x>0?a:Math.min(Math.max(-a,-f),a),C=-x*x+M*(M+2*f)+g);else M=c>0?-a:a,x=Math.max(0,-(c*M+o)),C=-x*x+M*(M+2*f)+g;return r&&r.copy(this.origin).addScaledVector(this.direction,x),i&&i.copy(WT).addScaledVector(hb,M),C}intersectSphere(t,n){Hc.subVectors(t.center,this.origin);const r=Hc.dot(this.direction),i=Hc.dot(Hc)-r*r,a=t.radius*t.radius;if(i>a)return null;const c=Math.sqrt(a-i),o=r-c,f=r+c;return f<0?null:o<0?this.at(f,n):this.at(o,n)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const n=t.normal.dot(this.direction);if(n===0)return t.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(t.normal)+t.constant)/n;return r>=0?r:null}intersectPlane(t,n){const r=this.distanceToPlane(t);return r===null?null:this.at(r,n)}intersectsPlane(t){const n=t.distanceToPoint(this.origin);return n===0||t.normal.dot(this.direction)*n<0}intersectBox(t,n){let r,i,a,c,o,f;const g=1/this.direction.x,_=1/this.direction.y,x=1/this.direction.z,M=this.origin;return g>=0?(r=(t.min.x-M.x)*g,i=(t.max.x-M.x)*g):(r=(t.max.x-M.x)*g,i=(t.min.x-M.x)*g),_>=0?(a=(t.min.y-M.y)*_,c=(t.max.y-M.y)*_):(a=(t.max.y-M.y)*_,c=(t.min.y-M.y)*_),r>c||a>i||((a>r||isNaN(r))&&(r=a),(c<i||isNaN(i))&&(i=c),x>=0?(o=(t.min.z-M.z)*x,f=(t.max.z-M.z)*x):(o=(t.max.z-M.z)*x,f=(t.min.z-M.z)*x),r>f||o>i)||((o>r||r!==r)&&(r=o),(f<i||i!==i)&&(i=f),i<0)?null:this.at(r>=0?r:i,n)}intersectsBox(t){return this.intersectBox(t,Hc)!==null}intersectTriangle(t,n,r,i,a){qT.subVectors(n,t),db.subVectors(r,t),XT.crossVectors(qT,db);let c=this.direction.dot(XT),o;if(c>0){if(i)return null;o=1}else if(c<0)o=-1,c=-c;else return null;oh.subVectors(this.origin,t);const f=o*this.direction.dot(db.crossVectors(oh,db));if(f<0)return null;const g=o*this.direction.dot(qT.cross(oh));if(g<0||f+g>c)return null;const _=-o*oh.dot(XT);return _<0?null:this.at(_/c,a)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class jr{constructor(t,n,r,i,a,c,o,f,g,_,x,M,C,A,L,I){jr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,n,r,i,a,c,o,f,g,_,x,M,C,A,L,I)}set(t,n,r,i,a,c,o,f,g,_,x,M,C,A,L,I){const T=this.elements;return T[0]=t,T[4]=n,T[8]=r,T[12]=i,T[1]=a,T[5]=c,T[9]=o,T[13]=f,T[2]=g,T[6]=_,T[10]=x,T[14]=M,T[3]=C,T[7]=A,T[11]=L,T[15]=I,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new jr().fromArray(this.elements)}copy(t){const n=this.elements,r=t.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(t){const n=this.elements,r=t.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(t){const n=t.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(t,n,r){return t.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(t,n,r){return this.set(t.x,n.x,r.x,0,t.y,n.y,r.y,0,t.z,n.z,r.z,0,0,0,0,1),this}extractRotation(t){const n=this.elements,r=t.elements,i=1/om.setFromMatrixColumn(t,0).length(),a=1/om.setFromMatrixColumn(t,1).length(),c=1/om.setFromMatrixColumn(t,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*a,n[5]=r[5]*a,n[6]=r[6]*a,n[7]=0,n[8]=r[8]*c,n[9]=r[9]*c,n[10]=r[10]*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(t){const n=this.elements,r=t.x,i=t.y,a=t.z,c=Math.cos(r),o=Math.sin(r),f=Math.cos(i),g=Math.sin(i),_=Math.cos(a),x=Math.sin(a);if(t.order==="XYZ"){const M=c*_,C=c*x,A=o*_,L=o*x;n[0]=f*_,n[4]=-f*x,n[8]=g,n[1]=C+A*g,n[5]=M-L*g,n[9]=-o*f,n[2]=L-M*g,n[6]=A+C*g,n[10]=c*f}else if(t.order==="YXZ"){const M=f*_,C=f*x,A=g*_,L=g*x;n[0]=M+L*o,n[4]=A*o-C,n[8]=c*g,n[1]=c*x,n[5]=c*_,n[9]=-o,n[2]=C*o-A,n[6]=L+M*o,n[10]=c*f}else if(t.order==="ZXY"){const M=f*_,C=f*x,A=g*_,L=g*x;n[0]=M-L*o,n[4]=-c*x,n[8]=A+C*o,n[1]=C+A*o,n[5]=c*_,n[9]=L-M*o,n[2]=-c*g,n[6]=o,n[10]=c*f}else if(t.order==="ZYX"){const M=c*_,C=c*x,A=o*_,L=o*x;n[0]=f*_,n[4]=A*g-C,n[8]=M*g+L,n[1]=f*x,n[5]=L*g+M,n[9]=C*g-A,n[2]=-g,n[6]=o*f,n[10]=c*f}else if(t.order==="YZX"){const M=c*f,C=c*g,A=o*f,L=o*g;n[0]=f*_,n[4]=L-M*x,n[8]=A*x+C,n[1]=x,n[5]=c*_,n[9]=-o*_,n[2]=-g*_,n[6]=C*x+A,n[10]=M-L*x}else if(t.order==="XZY"){const M=c*f,C=c*g,A=o*f,L=o*g;n[0]=f*_,n[4]=-x,n[8]=g*_,n[1]=M*x+L,n[5]=c*_,n[9]=C*x-A,n[2]=A*x-C,n[6]=o*_,n[10]=L*x+M}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(t){return this.compose(uMe,t,hMe)}lookAt(t,n,r){const i=this.elements;return sa.subVectors(t,n),sa.lengthSq()===0&&(sa.z=1),sa.normalize(),sh.crossVectors(r,sa),sh.lengthSq()===0&&(Math.abs(r.z)===1?sa.x+=1e-4:sa.z+=1e-4,sa.normalize(),sh.crossVectors(r,sa)),sh.normalize(),fb.crossVectors(sa,sh),i[0]=sh.x,i[4]=fb.x,i[8]=sa.x,i[1]=sh.y,i[5]=fb.y,i[9]=sa.y,i[2]=sh.z,i[6]=fb.z,i[10]=sa.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,n){const r=t.elements,i=n.elements,a=this.elements,c=r[0],o=r[4],f=r[8],g=r[12],_=r[1],x=r[5],M=r[9],C=r[13],A=r[2],L=r[6],I=r[10],T=r[14],z=r[3],k=r[7],U=r[11],H=r[15],V=i[0],q=i[4],J=i[8],Y=i[12],N=i[1],ne=i[5],ye=i[9],ge=i[13],Ne=i[2],Ae=i[6],ve=i[10],Se=i[14],Me=i[3],Ue=i[7],Qe=i[11],st=i[15];return a[0]=c*V+o*N+f*Ne+g*Me,a[4]=c*q+o*ne+f*Ae+g*Ue,a[8]=c*J+o*ye+f*ve+g*Qe,a[12]=c*Y+o*ge+f*Se+g*st,a[1]=_*V+x*N+M*Ne+C*Me,a[5]=_*q+x*ne+M*Ae+C*Ue,a[9]=_*J+x*ye+M*ve+C*Qe,a[13]=_*Y+x*ge+M*Se+C*st,a[2]=A*V+L*N+I*Ne+T*Me,a[6]=A*q+L*ne+I*Ae+T*Ue,a[10]=A*J+L*ye+I*ve+T*Qe,a[14]=A*Y+L*ge+I*Se+T*st,a[3]=z*V+k*N+U*Ne+H*Me,a[7]=z*q+k*ne+U*Ae+H*Ue,a[11]=z*J+k*ye+U*ve+H*Qe,a[15]=z*Y+k*ge+U*Se+H*st,this}multiplyScalar(t){const n=this.elements;return n[0]*=t,n[4]*=t,n[8]*=t,n[12]*=t,n[1]*=t,n[5]*=t,n[9]*=t,n[13]*=t,n[2]*=t,n[6]*=t,n[10]*=t,n[14]*=t,n[3]*=t,n[7]*=t,n[11]*=t,n[15]*=t,this}determinant(){const t=this.elements,n=t[0],r=t[4],i=t[8],a=t[12],c=t[1],o=t[5],f=t[9],g=t[13],_=t[2],x=t[6],M=t[10],C=t[14],A=t[3],L=t[7],I=t[11],T=t[15];return A*(+a*f*x-i*g*x-a*o*M+r*g*M+i*o*C-r*f*C)+L*(+n*f*C-n*g*M+a*c*M-i*c*C+i*g*_-a*f*_)+I*(+n*g*x-n*o*C-a*c*x+r*c*C+a*o*_-r*g*_)+T*(-i*o*_-n*f*x+n*o*M+i*c*x-r*c*M+r*f*_)}transpose(){const t=this.elements;let n;return n=t[1],t[1]=t[4],t[4]=n,n=t[2],t[2]=t[8],t[8]=n,n=t[6],t[6]=t[9],t[9]=n,n=t[3],t[3]=t[12],t[12]=n,n=t[7],t[7]=t[13],t[13]=n,n=t[11],t[11]=t[14],t[14]=n,this}setPosition(t,n,r){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=n,i[14]=r),this}invert(){const t=this.elements,n=t[0],r=t[1],i=t[2],a=t[3],c=t[4],o=t[5],f=t[6],g=t[7],_=t[8],x=t[9],M=t[10],C=t[11],A=t[12],L=t[13],I=t[14],T=t[15],z=x*I*g-L*M*g+L*f*C-o*I*C-x*f*T+o*M*T,k=A*M*g-_*I*g-A*f*C+c*I*C+_*f*T-c*M*T,U=_*L*g-A*x*g+A*o*C-c*L*C-_*o*T+c*x*T,H=A*x*f-_*L*f-A*o*M+c*L*M+_*o*I-c*x*I,V=n*z+r*k+i*U+a*H;if(V===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const q=1/V;return t[0]=z*q,t[1]=(L*M*a-x*I*a-L*i*C+r*I*C+x*i*T-r*M*T)*q,t[2]=(o*I*a-L*f*a+L*i*g-r*I*g-o*i*T+r*f*T)*q,t[3]=(x*f*a-o*M*a-x*i*g+r*M*g+o*i*C-r*f*C)*q,t[4]=k*q,t[5]=(_*I*a-A*M*a+A*i*C-n*I*C-_*i*T+n*M*T)*q,t[6]=(A*f*a-c*I*a-A*i*g+n*I*g+c*i*T-n*f*T)*q,t[7]=(c*M*a-_*f*a+_*i*g-n*M*g-c*i*C+n*f*C)*q,t[8]=U*q,t[9]=(A*x*a-_*L*a-A*r*C+n*L*C+_*r*T-n*x*T)*q,t[10]=(c*L*a-A*o*a+A*r*g-n*L*g-c*r*T+n*o*T)*q,t[11]=(_*o*a-c*x*a-_*r*g+n*x*g+c*r*C-n*o*C)*q,t[12]=H*q,t[13]=(_*L*i-A*x*i+A*r*M-n*L*M-_*r*I+n*x*I)*q,t[14]=(A*o*i-c*L*i-A*r*f+n*L*f+c*r*I-n*o*I)*q,t[15]=(c*x*i-_*o*i+_*r*f-n*x*f-c*r*M+n*o*M)*q,this}scale(t){const n=this.elements,r=t.x,i=t.y,a=t.z;return n[0]*=r,n[4]*=i,n[8]*=a,n[1]*=r,n[5]*=i,n[9]*=a,n[2]*=r,n[6]*=i,n[10]*=a,n[3]*=r,n[7]*=i,n[11]*=a,this}getMaxScaleOnAxis(){const t=this.elements,n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(n,r,i))}makeTranslation(t,n,r){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(t){const n=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(t){const n=Math.cos(t),r=Math.sin(t);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(t){const n=Math.cos(t),r=Math.sin(t);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,n){const r=Math.cos(n),i=Math.sin(n),a=1-r,c=t.x,o=t.y,f=t.z,g=a*c,_=a*o;return this.set(g*c+r,g*o-i*f,g*f+i*o,0,g*o+i*f,_*o+r,_*f-i*c,0,g*f-i*o,_*f+i*c,a*f*f+r,0,0,0,0,1),this}makeScale(t,n,r){return this.set(t,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,n,r,i,a,c){return this.set(1,r,a,0,t,1,c,0,n,i,1,0,0,0,0,1),this}compose(t,n,r){const i=this.elements,a=n._x,c=n._y,o=n._z,f=n._w,g=a+a,_=c+c,x=o+o,M=a*g,C=a*_,A=a*x,L=c*_,I=c*x,T=o*x,z=f*g,k=f*_,U=f*x,H=r.x,V=r.y,q=r.z;return i[0]=(1-(L+T))*H,i[1]=(C+U)*H,i[2]=(A-k)*H,i[3]=0,i[4]=(C-U)*V,i[5]=(1-(M+T))*V,i[6]=(I+z)*V,i[7]=0,i[8]=(A+k)*q,i[9]=(I-z)*q,i[10]=(1-(M+L))*q,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,n,r){const i=this.elements;let a=om.set(i[0],i[1],i[2]).length();const c=om.set(i[4],i[5],i[6]).length(),o=om.set(i[8],i[9],i[10]).length();this.determinant()<0&&(a=-a),t.x=i[12],t.y=i[13],t.z=i[14],_l.copy(this);const g=1/a,_=1/c,x=1/o;return _l.elements[0]*=g,_l.elements[1]*=g,_l.elements[2]*=g,_l.elements[4]*=_,_l.elements[5]*=_,_l.elements[6]*=_,_l.elements[8]*=x,_l.elements[9]*=x,_l.elements[10]*=x,n.setFromRotationMatrix(_l),r.x=a,r.y=c,r.z=o,this}makePerspective(t,n,r,i,a,c,o=nu){const f=this.elements,g=2*a/(n-t),_=2*a/(r-i),x=(n+t)/(n-t),M=(r+i)/(r-i);let C,A;if(o===nu)C=-(c+a)/(c-a),A=-2*c*a/(c-a);else if(o===ES)C=-c/(c-a),A=-c*a/(c-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return f[0]=g,f[4]=0,f[8]=x,f[12]=0,f[1]=0,f[5]=_,f[9]=M,f[13]=0,f[2]=0,f[6]=0,f[10]=C,f[14]=A,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(t,n,r,i,a,c,o=nu){const f=this.elements,g=1/(n-t),_=1/(r-i),x=1/(c-a),M=(n+t)*g,C=(r+i)*_;let A,L;if(o===nu)A=(c+a)*x,L=-2*x;else if(o===ES)A=a*x,L=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return f[0]=2*g,f[4]=0,f[8]=0,f[12]=-M,f[1]=0,f[5]=2*_,f[9]=0,f[13]=-C,f[2]=0,f[6]=0,f[10]=L,f[14]=-A,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(t){const n=this.elements,r=t.elements;for(let i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0}fromArray(t,n=0){for(let r=0;r<16;r++)this.elements[r]=t[r+n];return this}toArray(t=[],n=0){const r=this.elements;return t[n]=r[0],t[n+1]=r[1],t[n+2]=r[2],t[n+3]=r[3],t[n+4]=r[4],t[n+5]=r[5],t[n+6]=r[6],t[n+7]=r[7],t[n+8]=r[8],t[n+9]=r[9],t[n+10]=r[10],t[n+11]=r[11],t[n+12]=r[12],t[n+13]=r[13],t[n+14]=r[14],t[n+15]=r[15],t}}const om=new dt,_l=new jr,uMe=new dt(0,0,0),hMe=new dt(1,1,1),sh=new dt,fb=new dt,sa=new dt,$N=new jr,VN=new ud;class Sc{constructor(t=0,n=0,r=0,i=Sc.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,i=this._order){return this._x=t,this._y=n,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const i=t.elements,a=i[0],c=i[4],o=i[8],f=i[1],g=i[5],_=i[9],x=i[2],M=i[6],C=i[10];switch(n){case"XYZ":this._y=Math.asin(xr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-_,C),this._z=Math.atan2(-c,a)):(this._x=Math.atan2(M,g),this._z=0);break;case"YXZ":this._x=Math.asin(-xr(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(o,C),this._z=Math.atan2(f,g)):(this._y=Math.atan2(-x,a),this._z=0);break;case"ZXY":this._x=Math.asin(xr(M,-1,1)),Math.abs(M)<.9999999?(this._y=Math.atan2(-x,C),this._z=Math.atan2(-c,g)):(this._y=0,this._z=Math.atan2(f,a));break;case"ZYX":this._y=Math.asin(-xr(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(M,C),this._z=Math.atan2(f,a)):(this._x=0,this._z=Math.atan2(-c,g));break;case"YZX":this._z=Math.asin(xr(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-_,g),this._y=Math.atan2(-x,a)):(this._x=0,this._y=Math.atan2(o,C));break;case"XZY":this._z=Math.asin(-xr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(M,g),this._y=Math.atan2(o,a)):(this._x=Math.atan2(-_,C),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return $N.makeRotationFromQuaternion(t),this.setFromRotationMatrix($N,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return VN.setFromEuler(this),this.setFromQuaternion(VN,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Sc.DEFAULT_ORDER="XYZ";class ZL{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let dMe=0;const jN=new dt,sm=new ud,Gc=new jr,pb=new dt,k0=new dt,fMe=new dt,pMe=new ud,HN=new dt(1,0,0),GN=new dt(0,1,0),WN=new dt(0,0,1),qN={type:"added"},mMe={type:"removed"},am={type:"childadded",child:null},ZT={type:"childremoved",child:null};class Go extends Xg{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:dMe++}),this.uuid=Zg(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Go.DEFAULT_UP.clone();const t=new dt,n=new Sc,r=new ud,i=new dt(1,1,1);function a(){r.setFromEuler(n,!1)}function c(){n.setFromQuaternion(r,void 0,!1)}n._onChange(a),r._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new jr},normalMatrix:{value:new sr}}),this.matrix=new jr,this.matrixWorld=new jr,this.matrixAutoUpdate=Go.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Go.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new ZL,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return sm.setFromAxisAngle(t,n),this.quaternion.multiply(sm),this}rotateOnWorldAxis(t,n){return sm.setFromAxisAngle(t,n),this.quaternion.premultiply(sm),this}rotateX(t){return this.rotateOnAxis(HN,t)}rotateY(t){return this.rotateOnAxis(GN,t)}rotateZ(t){return this.rotateOnAxis(WN,t)}translateOnAxis(t,n){return jN.copy(t).applyQuaternion(this.quaternion),this.position.add(jN.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(HN,t)}translateY(t){return this.translateOnAxis(GN,t)}translateZ(t){return this.translateOnAxis(WN,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Gc.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?pb.copy(t):pb.set(t,n,r);const i=this.parent;this.updateWorldMatrix(!0,!1),k0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Gc.lookAt(k0,pb,this.up):Gc.lookAt(pb,k0,this.up),this.quaternion.setFromRotationMatrix(Gc),i&&(Gc.extractRotation(i.matrixWorld),sm.setFromRotationMatrix(Gc),this.quaternion.premultiply(sm.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(qN),am.child=t,this.dispatchEvent(am),am.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(t);return n!==-1&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(mMe),ZT.child=t,this.dispatchEvent(ZT),ZT.child=null),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Gc.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Gc.multiply(t.parent.matrixWorld)),t.applyMatrix4(Gc),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(qN),am.child=t,this.dispatchEvent(am),am.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,i=this.children.length;r<i;r++){const c=this.children[r].getObjectByProperty(t,n);if(c!==void 0)return c}}getObjectsByProperty(t,n,r=[]){this[t]===n&&r.push(this);const i=this.children;for(let a=0,c=i.length;a<c;a++)i[a].getObjectsByProperty(t,n,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(k0,t,fMe),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(k0,pMe,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverseVisible(t)}traverseAncestors(t){const n=this.parent;n!==null&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].updateMatrixWorld(t)}updateWorldMatrix(t,n){const r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const i=this.children;for(let a=0,c=i.length;a<c;a++)i[a].updateWorldMatrix(!1,!0)}}toJSON(t){const n=t===void 0||typeof t=="string",r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(o=>({boxInitialized:o.boxInitialized,boxMin:o.box.min.toArray(),boxMax:o.box.max.toArray(),sphereInitialized:o.sphereInitialized,sphereRadius:o.sphere.radius,sphereCenter:o.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(t),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function a(o,f){return o[f.uuid]===void 0&&(o[f.uuid]=f.toJSON(t)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(t.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const f=o.shapes;if(Array.isArray(f))for(let g=0,_=f.length;g<_;g++){const x=f[g];a(t.shapes,x)}else a(t.shapes,f)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let f=0,g=this.material.length;f<g;f++)o.push(a(t.materials,this.material[f]));i.material=o}else i.material=a(t.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const f=this.animations[o];i.animations.push(a(t.animations,f))}}if(n){const o=c(t.geometries),f=c(t.materials),g=c(t.textures),_=c(t.images),x=c(t.shapes),M=c(t.skeletons),C=c(t.animations),A=c(t.nodes);o.length>0&&(r.geometries=o),f.length>0&&(r.materials=f),g.length>0&&(r.textures=g),_.length>0&&(r.images=_),x.length>0&&(r.shapes=x),M.length>0&&(r.skeletons=M),C.length>0&&(r.animations=C),A.length>0&&(r.nodes=A)}return r.object=i,r;function c(o){const f=[];for(const g in o){const _=o[g];delete _.metadata,f.push(_)}return f}}clone(t){return new this.constructor().copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),n===!0)for(let r=0;r<t.children.length;r++){const i=t.children[r];this.add(i.clone())}return this}}Go.DEFAULT_UP=new dt(0,1,0);Go.DEFAULT_MATRIX_AUTO_UPDATE=!0;Go.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const xl=new dt,Wc=new dt,YT=new dt,qc=new dt,lm=new dt,cm=new dt,XN=new dt,KT=new dt,JT=new dt,QT=new dt,eP=new Fi,tP=new Fi,nP=new Fi;class El{constructor(t=new dt,n=new dt,r=new dt){this.a=t,this.b=n,this.c=r}static getNormal(t,n,r,i){i.subVectors(r,n),xl.subVectors(t,n),i.cross(xl);const a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(t,n,r,i,a){xl.subVectors(i,n),Wc.subVectors(r,n),YT.subVectors(t,n);const c=xl.dot(xl),o=xl.dot(Wc),f=xl.dot(YT),g=Wc.dot(Wc),_=Wc.dot(YT),x=c*g-o*o;if(x===0)return a.set(0,0,0),null;const M=1/x,C=(g*f-o*_)*M,A=(c*_-o*f)*M;return a.set(1-C-A,A,C)}static containsPoint(t,n,r,i){return this.getBarycoord(t,n,r,i,qc)===null?!1:qc.x>=0&&qc.y>=0&&qc.x+qc.y<=1}static getInterpolation(t,n,r,i,a,c,o,f){return this.getBarycoord(t,n,r,i,qc)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(a,qc.x),f.addScaledVector(c,qc.y),f.addScaledVector(o,qc.z),f)}static getInterpolatedAttribute(t,n,r,i,a,c){return eP.setScalar(0),tP.setScalar(0),nP.setScalar(0),eP.fromBufferAttribute(t,n),tP.fromBufferAttribute(t,r),nP.fromBufferAttribute(t,i),c.setScalar(0),c.addScaledVector(eP,a.x),c.addScaledVector(tP,a.y),c.addScaledVector(nP,a.z),c}static isFrontFacing(t,n,r,i){return xl.subVectors(r,n),Wc.subVectors(t,n),xl.cross(Wc).dot(i)<0}set(t,n,r){return this.a.copy(t),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(t,n,r,i){return this.a.copy(t[n]),this.b.copy(t[r]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,n,r,i){return this.a.fromBufferAttribute(t,n),this.b.fromBufferAttribute(t,r),this.c.fromBufferAttribute(t,i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return xl.subVectors(this.c,this.b),Wc.subVectors(this.a,this.b),xl.cross(Wc).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return El.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,n){return El.getBarycoord(t,this.a,this.b,this.c,n)}getInterpolation(t,n,r,i,a){return El.getInterpolation(t,this.a,this.b,this.c,n,r,i,a)}containsPoint(t){return El.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return El.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,n){const r=this.a,i=this.b,a=this.c;let c,o;lm.subVectors(i,r),cm.subVectors(a,r),KT.subVectors(t,r);const f=lm.dot(KT),g=cm.dot(KT);if(f<=0&&g<=0)return n.copy(r);JT.subVectors(t,i);const _=lm.dot(JT),x=cm.dot(JT);if(_>=0&&x<=_)return n.copy(i);const M=f*x-_*g;if(M<=0&&f>=0&&_<=0)return c=f/(f-_),n.copy(r).addScaledVector(lm,c);QT.subVectors(t,a);const C=lm.dot(QT),A=cm.dot(QT);if(A>=0&&C<=A)return n.copy(a);const L=C*g-f*A;if(L<=0&&g>=0&&A<=0)return o=g/(g-A),n.copy(r).addScaledVector(cm,o);const I=_*A-C*x;if(I<=0&&x-_>=0&&C-A>=0)return XN.subVectors(a,i),o=(x-_)/(x-_+(C-A)),n.copy(i).addScaledVector(XN,o);const T=1/(I+L+M);return c=L*T,o=M*T,n.copy(r).addScaledVector(lm,c).addScaledVector(cm,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const E7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ah={h:0,s:0,l:0},mb={h:0,s:0,l:0};function rP(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*6*(2/3-n):e}class Br{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,n,r)}set(t,n,r){if(n===void 0&&r===void 0){const i=t;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(t,n,r);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=Ua){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Tr.toWorkingColorSpace(this,n),this}setRGB(t,n,r,i=Tr.workingColorSpace){return this.r=t,this.g=n,this.b=r,Tr.toWorkingColorSpace(this,i),this}setHSL(t,n,r,i=Tr.workingColorSpace){if(t=WL(t,1),n=xr(n,0,1),r=xr(r,0,1),n===0)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+n):r+n-r*n,c=2*r-a;this.r=rP(c,a,t+1/3),this.g=rP(c,a,t),this.b=rP(c,a,t-1/3)}return Tr.toWorkingColorSpace(this,i),this}setStyle(t,n=Ua){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let a;const c=i[1],o=i[2];switch(c){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,n);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,n);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const a=i[1],c=a.length;if(c===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,n);if(c===6)return this.setHex(parseInt(a,16),n);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,n);return this}setColorName(t,n=Ua){const r=E7[t.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=iu(t.r),this.g=iu(t.g),this.b=iu(t.b),this}copyLinearToSRGB(t){return this.r=ug(t.r),this.g=ug(t.g),this.b=ug(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Ua){return Tr.fromWorkingColorSpace(os.copy(this),t),Math.round(xr(os.r*255,0,255))*65536+Math.round(xr(os.g*255,0,255))*256+Math.round(xr(os.b*255,0,255))}getHexString(t=Ua){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=Tr.workingColorSpace){Tr.fromWorkingColorSpace(os.copy(this),n);const r=os.r,i=os.g,a=os.b,c=Math.max(r,i,a),o=Math.min(r,i,a);let f,g;const _=(o+c)/2;if(o===c)f=0,g=0;else{const x=c-o;switch(g=_<=.5?x/(c+o):x/(2-c-o),c){case r:f=(i-a)/x+(i<a?6:0);break;case i:f=(a-r)/x+2;break;case a:f=(r-i)/x+4;break}f/=6}return t.h=f,t.s=g,t.l=_,t}getRGB(t,n=Tr.workingColorSpace){return Tr.fromWorkingColorSpace(os.copy(this),n),t.r=os.r,t.g=os.g,t.b=os.b,t}getStyle(t=Ua){Tr.fromWorkingColorSpace(os.copy(this),t);const n=os.r,r=os.g,i=os.b;return t!==Ua?`color(${t} ${n.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(t,n,r){return this.getHSL(ah),this.setHSL(ah.h+t,ah.s+n,ah.l+r)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL(ah),t.getHSL(mb);const r=My(ah.h,mb.h,n),i=My(ah.s,mb.s,n),a=My(ah.l,mb.l,n);return this.setHSL(r,i,a),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const n=this.r,r=this.g,i=this.b,a=t.elements;return this.r=a[0]*n+a[3]*r+a[6]*i,this.g=a[1]*n+a[4]*r+a[7]*i,this.b=a[2]*n+a[5]*r+a[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const os=new Br;Br.NAMES=E7;let gMe=0;class fx extends Xg{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:gMe++}),this.uuid=Zg(),this.name="",this.type="Material",this.blending=cg,this.side=Xh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=nI,this.blendDst=rI,this.blendEquation=pf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Br(0,0,0),this.blendAlpha=0,this.depthFunc=kg,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=kN,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=em,this.stencilZFail=em,this.stencilZPass=em,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const n in t){const r=t[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const i=this[n];if(i===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[n]=r}}toJSON(t){const n=t===void 0||typeof t=="string";n&&(t={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==cg&&(r.blending=this.blending),this.side!==Xh&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==nI&&(r.blendSrc=this.blendSrc),this.blendDst!==rI&&(r.blendDst=this.blendDst),this.blendEquation!==pf&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==kg&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==kN&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==em&&(r.stencilFail=this.stencilFail),this.stencilZFail!==em&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==em&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(a){const c=[];for(const o in a){const f=a[o];delete f.metadata,c.push(f)}return c}if(n){const a=i(t.textures),c=i(t.images);a.length>0&&(r.textures=a),c.length>0&&(r.images=c)}return r}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const n=t.clippingPlanes;let r=null;if(n!==null){const i=n.length;r=new Array(i);for(let a=0;a!==i;++a)r[a]=n[a].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Yh extends fx{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Br(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Sc,this.combine=u7,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Ki=new dt,gb=new Dr;let vMe=0;class xc{constructor(t,n,r=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:vMe++}),this.name="",this.array=t,this.itemSize=n,this.count=t!==void 0?t.length/n:0,this.normalized=r,this.usage=DN,this.updateRanges=[],this.gpuType=tu,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,n){this.updateRanges.push({start:t,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,n,r){t*=this.itemSize,r*=n.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[t+i]=n.array[r+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)gb.fromBufferAttribute(this,n),gb.applyMatrix3(t),this.setXY(n,gb.x,gb.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)Ki.fromBufferAttribute(this,n),Ki.applyMatrix3(t),this.setXYZ(n,Ki.x,Ki.y,Ki.z);return this}applyMatrix4(t){for(let n=0,r=this.count;n<r;n++)Ki.fromBufferAttribute(this,n),Ki.applyMatrix4(t),this.setXYZ(n,Ki.x,Ki.y,Ki.z);return this}applyNormalMatrix(t){for(let n=0,r=this.count;n<r;n++)Ki.fromBufferAttribute(this,n),Ki.applyNormalMatrix(t),this.setXYZ(n,Ki.x,Ki.y,Ki.z);return this}transformDirection(t){for(let n=0,r=this.count;n<r;n++)Ki.fromBufferAttribute(this,n),Ki.transformDirection(t),this.setXYZ(n,Ki.x,Ki.y,Ki.z);return this}set(t,n=0){return this.array.set(t,n),this}getComponent(t,n){let r=this.array[t*this.itemSize+n];return this.normalized&&(r=bm(r,this.array)),r}setComponent(t,n,r){return this.normalized&&(r=ms(r,this.array)),this.array[t*this.itemSize+n]=r,this}getX(t){let n=this.array[t*this.itemSize];return this.normalized&&(n=bm(n,this.array)),n}setX(t,n){return this.normalized&&(n=ms(n,this.array)),this.array[t*this.itemSize]=n,this}getY(t){let n=this.array[t*this.itemSize+1];return this.normalized&&(n=bm(n,this.array)),n}setY(t,n){return this.normalized&&(n=ms(n,this.array)),this.array[t*this.itemSize+1]=n,this}getZ(t){let n=this.array[t*this.itemSize+2];return this.normalized&&(n=bm(n,this.array)),n}setZ(t,n){return this.normalized&&(n=ms(n,this.array)),this.array[t*this.itemSize+2]=n,this}getW(t){let n=this.array[t*this.itemSize+3];return this.normalized&&(n=bm(n,this.array)),n}setW(t,n){return this.normalized&&(n=ms(n,this.array)),this.array[t*this.itemSize+3]=n,this}setXY(t,n,r){return t*=this.itemSize,this.normalized&&(n=ms(n,this.array),r=ms(r,this.array)),this.array[t+0]=n,this.array[t+1]=r,this}setXYZ(t,n,r,i){return t*=this.itemSize,this.normalized&&(n=ms(n,this.array),r=ms(r,this.array),i=ms(i,this.array)),this.array[t+0]=n,this.array[t+1]=r,this.array[t+2]=i,this}setXYZW(t,n,r,i,a){return t*=this.itemSize,this.normalized&&(n=ms(n,this.array),r=ms(r,this.array),i=ms(i,this.array),a=ms(a,this.array)),this.array[t+0]=n,this.array[t+1]=r,this.array[t+2]=i,this.array[t+3]=a,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==DN&&(t.usage=this.usage),t}}class T7 extends xc{constructor(t,n,r){super(new Uint16Array(t),n,r)}}class P7 extends xc{constructor(t,n,r){super(new Uint32Array(t),n,r)}}class Ca extends xc{constructor(t,n,r){super(new Float32Array(t),n,r)}}let yMe=0;const Oa=new jr,iP=new Go,um=new dt,aa=new Yg,D0=new Yg,bo=new dt;class Ec extends Xg{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:yMe++}),this.uuid=Zg(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(M7(t)?P7:T7)(t,1):this.index=t,this}setIndirect(t){return this.indirect=t,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,n){return this.attributes[t]=n,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,n,r=0){this.groups.push({start:t,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(t,n){this.drawRange.start=t,this.drawRange.count=n}applyMatrix4(t){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(t),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const a=new sr().getNormalMatrix(t);r.applyNormalMatrix(a),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(t),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Oa.makeRotationFromQuaternion(t),this.applyMatrix4(Oa),this}rotateX(t){return Oa.makeRotationX(t),this.applyMatrix4(Oa),this}rotateY(t){return Oa.makeRotationY(t),this.applyMatrix4(Oa),this}rotateZ(t){return Oa.makeRotationZ(t),this.applyMatrix4(Oa),this}translate(t,n,r){return Oa.makeTranslation(t,n,r),this.applyMatrix4(Oa),this}scale(t,n,r){return Oa.makeScale(t,n,r),this.applyMatrix4(Oa),this}lookAt(t){return iP.lookAt(t),iP.updateMatrix(),this.applyMatrix4(iP.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(um).negate(),this.translate(um.x,um.y,um.z),this}setFromPoints(t){const n=this.getAttribute("position");if(n===void 0){const r=[];for(let i=0,a=t.length;i<a;i++){const c=t[i];r.push(c.x,c.y,c.z||0)}this.setAttribute("position",new Ca(r,3))}else{const r=Math.min(t.length,n.count);for(let i=0;i<r;i++){const a=t[i];n.setXYZ(i,a.x,a.y,a.z||0)}t.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Yg);const t=this.attributes.position,n=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new dt(-1/0,-1/0,-1/0),new dt(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),n)for(let r=0,i=n.length;r<i;r++){const a=n[r];aa.setFromBufferAttribute(a),this.morphTargetsRelative?(bo.addVectors(this.boundingBox.min,aa.min),this.boundingBox.expandByPoint(bo),bo.addVectors(this.boundingBox.max,aa.max),this.boundingBox.expandByPoint(bo)):(this.boundingBox.expandByPoint(aa.min),this.boundingBox.expandByPoint(aa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new m2);const t=this.attributes.position,n=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new dt,1/0);return}if(t){const r=this.boundingSphere.center;if(aa.setFromBufferAttribute(t),n)for(let a=0,c=n.length;a<c;a++){const o=n[a];D0.setFromBufferAttribute(o),this.morphTargetsRelative?(bo.addVectors(aa.min,D0.min),aa.expandByPoint(bo),bo.addVectors(aa.max,D0.max),aa.expandByPoint(bo)):(aa.expandByPoint(D0.min),aa.expandByPoint(D0.max))}aa.getCenter(r);let i=0;for(let a=0,c=t.count;a<c;a++)bo.fromBufferAttribute(t,a),i=Math.max(i,r.distanceToSquared(bo));if(n)for(let a=0,c=n.length;a<c;a++){const o=n[a],f=this.morphTargetsRelative;for(let g=0,_=o.count;g<_;g++)bo.fromBufferAttribute(o,g),f&&(um.fromBufferAttribute(t,g),bo.add(um)),i=Math.max(i,r.distanceToSquared(bo))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,n=this.attributes;if(t===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=n.position,i=n.normal,a=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new xc(new Float32Array(4*r.count),4));const c=this.getAttribute("tangent"),o=[],f=[];for(let J=0;J<r.count;J++)o[J]=new dt,f[J]=new dt;const g=new dt,_=new dt,x=new dt,M=new Dr,C=new Dr,A=new Dr,L=new dt,I=new dt;function T(J,Y,N){g.fromBufferAttribute(r,J),_.fromBufferAttribute(r,Y),x.fromBufferAttribute(r,N),M.fromBufferAttribute(a,J),C.fromBufferAttribute(a,Y),A.fromBufferAttribute(a,N),_.sub(g),x.sub(g),C.sub(M),A.sub(M);const ne=1/(C.x*A.y-A.x*C.y);isFinite(ne)&&(L.copy(_).multiplyScalar(A.y).addScaledVector(x,-C.y).multiplyScalar(ne),I.copy(x).multiplyScalar(C.x).addScaledVector(_,-A.x).multiplyScalar(ne),o[J].add(L),o[Y].add(L),o[N].add(L),f[J].add(I),f[Y].add(I),f[N].add(I))}let z=this.groups;z.length===0&&(z=[{start:0,count:t.count}]);for(let J=0,Y=z.length;J<Y;++J){const N=z[J],ne=N.start,ye=N.count;for(let ge=ne,Ne=ne+ye;ge<Ne;ge+=3)T(t.getX(ge+0),t.getX(ge+1),t.getX(ge+2))}const k=new dt,U=new dt,H=new dt,V=new dt;function q(J){H.fromBufferAttribute(i,J),V.copy(H);const Y=o[J];k.copy(Y),k.sub(H.multiplyScalar(H.dot(Y))).normalize(),U.crossVectors(V,Y);const ne=U.dot(f[J])<0?-1:1;c.setXYZW(J,k.x,k.y,k.z,ne)}for(let J=0,Y=z.length;J<Y;++J){const N=z[J],ne=N.start,ye=N.count;for(let ge=ne,Ne=ne+ye;ge<Ne;ge+=3)q(t.getX(ge+0)),q(t.getX(ge+1)),q(t.getX(ge+2))}}computeVertexNormals(){const t=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new xc(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let M=0,C=r.count;M<C;M++)r.setXYZ(M,0,0,0);const i=new dt,a=new dt,c=new dt,o=new dt,f=new dt,g=new dt,_=new dt,x=new dt;if(t)for(let M=0,C=t.count;M<C;M+=3){const A=t.getX(M+0),L=t.getX(M+1),I=t.getX(M+2);i.fromBufferAttribute(n,A),a.fromBufferAttribute(n,L),c.fromBufferAttribute(n,I),_.subVectors(c,a),x.subVectors(i,a),_.cross(x),o.fromBufferAttribute(r,A),f.fromBufferAttribute(r,L),g.fromBufferAttribute(r,I),o.add(_),f.add(_),g.add(_),r.setXYZ(A,o.x,o.y,o.z),r.setXYZ(L,f.x,f.y,f.z),r.setXYZ(I,g.x,g.y,g.z)}else for(let M=0,C=n.count;M<C;M+=3)i.fromBufferAttribute(n,M+0),a.fromBufferAttribute(n,M+1),c.fromBufferAttribute(n,M+2),_.subVectors(c,a),x.subVectors(i,a),_.cross(x),r.setXYZ(M+0,_.x,_.y,_.z),r.setXYZ(M+1,_.x,_.y,_.z),r.setXYZ(M+2,_.x,_.y,_.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let n=0,r=t.count;n<r;n++)bo.fromBufferAttribute(t,n),bo.normalize(),t.setXYZ(n,bo.x,bo.y,bo.z)}toNonIndexed(){function t(o,f){const g=o.array,_=o.itemSize,x=o.normalized,M=new g.constructor(f.length*_);let C=0,A=0;for(let L=0,I=f.length;L<I;L++){o.isInterleavedBufferAttribute?C=f[L]*o.data.stride+o.offset:C=f[L]*_;for(let T=0;T<_;T++)M[A++]=g[C++]}return new xc(M,_,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Ec,r=this.index.array,i=this.attributes;for(const o in i){const f=i[o],g=t(f,r);n.setAttribute(o,g)}const a=this.morphAttributes;for(const o in a){const f=[],g=a[o];for(let _=0,x=g.length;_<x;_++){const M=g[_],C=t(M,r);f.push(C)}n.morphAttributes[o]=f}n.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let o=0,f=c.length;o<f;o++){const g=c[o];n.addGroup(g.start,g.count,g.materialIndex)}return n}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const g in f)f[g]!==void 0&&(t[g]=f[g]);return t}t.data={attributes:{}};const n=this.index;n!==null&&(t.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const f in r){const g=r[f];t.data.attributes[f]=g.toJSON(t.data)}const i={};let a=!1;for(const f in this.morphAttributes){const g=this.morphAttributes[f],_=[];for(let x=0,M=g.length;x<M;x++){const C=g[x];_.push(C.toJSON(t.data))}_.length>0&&(i[f]=_,a=!0)}a&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(t.data.groups=JSON.parse(JSON.stringify(c)));const o=this.boundingSphere;return o!==null&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=t.name;const r=t.index;r!==null&&this.setIndex(r.clone());const i=t.attributes;for(const g in i){const _=i[g];this.setAttribute(g,_.clone(n))}const a=t.morphAttributes;for(const g in a){const _=[],x=a[g];for(let M=0,C=x.length;M<C;M++)_.push(x[M].clone(n));this.morphAttributes[g]=_}this.morphTargetsRelative=t.morphTargetsRelative;const c=t.groups;for(let g=0,_=c.length;g<_;g++){const x=c[g];this.addGroup(x.start,x.count,x.materialIndex)}const o=t.boundingBox;o!==null&&(this.boundingBox=o.clone());const f=t.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const ZN=new jr,tf=new XL,vb=new m2,YN=new dt,yb=new dt,_b=new dt,xb=new dt,oP=new dt,bb=new dt,KN=new dt,wb=new dt;class Ns extends Go{constructor(t=new Ec,n=new Yh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,n){return super.copy(t,n),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=i.length;a<c;a++){const o=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}getVertexPosition(t,n){const r=this.geometry,i=r.attributes.position,a=r.morphAttributes.position,c=r.morphTargetsRelative;n.fromBufferAttribute(i,t);const o=this.morphTargetInfluences;if(a&&o){bb.set(0,0,0);for(let f=0,g=a.length;f<g;f++){const _=o[f],x=a[f];_!==0&&(oP.fromBufferAttribute(x,t),c?bb.addScaledVector(oP,_):bb.addScaledVector(oP.sub(n),_))}n.add(bb)}return n}raycast(t,n){const r=this.geometry,i=this.material,a=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),vb.copy(r.boundingSphere),vb.applyMatrix4(a),tf.copy(t.ray).recast(t.near),!(vb.containsPoint(tf.origin)===!1&&(tf.intersectSphere(vb,YN)===null||tf.origin.distanceToSquared(YN)>(t.far-t.near)**2))&&(ZN.copy(a).invert(),tf.copy(t.ray).applyMatrix4(ZN),!(r.boundingBox!==null&&tf.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(t,n,tf)))}_computeIntersections(t,n,r){let i;const a=this.geometry,c=this.material,o=a.index,f=a.attributes.position,g=a.attributes.uv,_=a.attributes.uv1,x=a.attributes.normal,M=a.groups,C=a.drawRange;if(o!==null)if(Array.isArray(c))for(let A=0,L=M.length;A<L;A++){const I=M[A],T=c[I.materialIndex],z=Math.max(I.start,C.start),k=Math.min(o.count,Math.min(I.start+I.count,C.start+C.count));for(let U=z,H=k;U<H;U+=3){const V=o.getX(U),q=o.getX(U+1),J=o.getX(U+2);i=Sb(this,T,t,r,g,_,x,V,q,J),i&&(i.faceIndex=Math.floor(U/3),i.face.materialIndex=I.materialIndex,n.push(i))}}else{const A=Math.max(0,C.start),L=Math.min(o.count,C.start+C.count);for(let I=A,T=L;I<T;I+=3){const z=o.getX(I),k=o.getX(I+1),U=o.getX(I+2);i=Sb(this,c,t,r,g,_,x,z,k,U),i&&(i.faceIndex=Math.floor(I/3),n.push(i))}}else if(f!==void 0)if(Array.isArray(c))for(let A=0,L=M.length;A<L;A++){const I=M[A],T=c[I.materialIndex],z=Math.max(I.start,C.start),k=Math.min(f.count,Math.min(I.start+I.count,C.start+C.count));for(let U=z,H=k;U<H;U+=3){const V=U,q=U+1,J=U+2;i=Sb(this,T,t,r,g,_,x,V,q,J),i&&(i.faceIndex=Math.floor(U/3),i.face.materialIndex=I.materialIndex,n.push(i))}}else{const A=Math.max(0,C.start),L=Math.min(f.count,C.start+C.count);for(let I=A,T=L;I<T;I+=3){const z=I,k=I+1,U=I+2;i=Sb(this,c,t,r,g,_,x,z,k,U),i&&(i.faceIndex=Math.floor(I/3),n.push(i))}}}}function _Me(e,t,n,r,i,a,c,o){let f;if(t.side===Hs?f=r.intersectTriangle(c,a,i,!0,o):f=r.intersectTriangle(i,a,c,t.side===Xh,o),f===null)return null;wb.copy(o),wb.applyMatrix4(e.matrixWorld);const g=n.ray.origin.distanceTo(wb);return g<n.near||g>n.far?null:{distance:g,point:wb.clone(),object:e}}function Sb(e,t,n,r,i,a,c,o,f,g){e.getVertexPosition(o,yb),e.getVertexPosition(f,_b),e.getVertexPosition(g,xb);const _=_Me(e,t,n,r,yb,_b,xb,KN);if(_){const x=new dt;El.getBarycoord(KN,yb,_b,xb,x),i&&(_.uv=El.getInterpolatedAttribute(i,o,f,g,x,new Dr)),a&&(_.uv1=El.getInterpolatedAttribute(a,o,f,g,x,new Dr)),c&&(_.normal=El.getInterpolatedAttribute(c,o,f,g,x,new dt),_.normal.dot(r.direction)>0&&_.normal.multiplyScalar(-1));const M={a:o,b:f,c:g,normal:new dt,materialIndex:0};El.getNormal(yb,_b,xb,M.normal),_.face=M,_.barycoord=x}return _}class px extends Ec{constructor(t=1,n=1,r=1,i=1,a=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:n,depth:r,widthSegments:i,heightSegments:a,depthSegments:c};const o=this;i=Math.floor(i),a=Math.floor(a),c=Math.floor(c);const f=[],g=[],_=[],x=[];let M=0,C=0;A("z","y","x",-1,-1,r,n,t,c,a,0),A("z","y","x",1,-1,r,n,-t,c,a,1),A("x","z","y",1,1,t,r,n,i,c,2),A("x","z","y",1,-1,t,r,-n,i,c,3),A("x","y","z",1,-1,t,n,r,i,a,4),A("x","y","z",-1,-1,t,n,-r,i,a,5),this.setIndex(f),this.setAttribute("position",new Ca(g,3)),this.setAttribute("normal",new Ca(_,3)),this.setAttribute("uv",new Ca(x,2));function A(L,I,T,z,k,U,H,V,q,J,Y){const N=U/q,ne=H/J,ye=U/2,ge=H/2,Ne=V/2,Ae=q+1,ve=J+1;let Se=0,Me=0;const Ue=new dt;for(let Qe=0;Qe<ve;Qe++){const st=Qe*ne-ge;for(let ct=0;ct<Ae;ct++){const Xt=ct*N-ye;Ue[L]=Xt*z,Ue[I]=st*k,Ue[T]=Ne,g.push(Ue.x,Ue.y,Ue.z),Ue[L]=0,Ue[I]=0,Ue[T]=V>0?1:-1,_.push(Ue.x,Ue.y,Ue.z),x.push(ct/q),x.push(1-Qe/J),Se+=1}}for(let Qe=0;Qe<J;Qe++)for(let st=0;st<q;st++){const ct=M+st+Ae*Qe,Xt=M+st+Ae*(Qe+1),je=M+(st+1)+Ae*(Qe+1),lt=M+(st+1)+Ae*Qe;f.push(ct,Xt,lt),f.push(Xt,je,lt),Me+=6}o.addGroup(C,Me,Y),C+=Me,M+=Se}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new px(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Og(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function gs(e){const t={};for(let n=0;n<e.length;n++){const r=Og(e[n]);for(const i in r)t[i]=r[i]}return t}function xMe(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}function A7(e){const t=e.getRenderTarget();return t===null?e.outputColorSpace:t.isXRRenderTarget===!0?t.texture.colorSpace:Tr.workingColorSpace}const bMe={clone:Og,merge:gs};var wMe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,SMe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class vu extends fx{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=wMe,this.fragmentShader=SMe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Og(t.uniforms),this.uniformsGroups=xMe(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const n=super.toJSON(t);n.glslVersion=this.glslVersion,n.uniforms={};for(const i in this.uniforms){const c=this.uniforms[i].value;c&&c.isTexture?n.uniforms[i]={type:"t",value:c.toJSON(t).uuid}:c&&c.isColor?n.uniforms[i]={type:"c",value:c.getHex()}:c&&c.isVector2?n.uniforms[i]={type:"v2",value:c.toArray()}:c&&c.isVector3?n.uniforms[i]={type:"v3",value:c.toArray()}:c&&c.isVector4?n.uniforms[i]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?n.uniforms[i]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?n.uniforms[i]={type:"m4",value:c.toArray()}:n.uniforms[i]={value:c}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class I7 extends Go{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new jr,this.projectionMatrix=new jr,this.projectionMatrixInverse=new jr,this.coordinateSystem=nu}copy(t,n){return super.copy(t,n),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,n){super.updateWorldMatrix(t,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const lh=new dt,JN=new Dr,QN=new Dr;class pa extends I7{constructor(t=50,n=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,n){return super.copy(t,n),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const n=.5*this.getFilmHeight()/t;this.fov=b_*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(Sy*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return b_*2*Math.atan(Math.tan(Sy*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,n,r){lh.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(lh.x,lh.y).multiplyScalar(-t/lh.z),lh.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(lh.x,lh.y).multiplyScalar(-t/lh.z)}getViewSize(t,n){return this.getViewBounds(t,JN,QN),n.subVectors(QN,JN)}setViewOffset(t,n,r,i,a,c){this.aspect=t/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let n=t*Math.tan(Sy*.5*this.fov)/this.zoom,r=2*n,i=this.aspect*r,a=-.5*i;const c=this.view;if(this.view!==null&&this.view.enabled){const f=c.fullWidth,g=c.fullHeight;a+=c.offsetX*i/f,n-=c.offsetY*r/g,i*=c.width/f,r*=c.height/g}const o=this.filmOffset;o!==0&&(a+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,n,n-r,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const n=super.toJSON(t);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const hm=-90,dm=1;class MMe extends Go{constructor(t,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new pa(hm,dm,t,n);i.layers=this.layers,this.add(i);const a=new pa(hm,dm,t,n);a.layers=this.layers,this.add(a);const c=new pa(hm,dm,t,n);c.layers=this.layers,this.add(c);const o=new pa(hm,dm,t,n);o.layers=this.layers,this.add(o);const f=new pa(hm,dm,t,n);f.layers=this.layers,this.add(f);const g=new pa(hm,dm,t,n);g.layers=this.layers,this.add(g)}updateCoordinateSystem(){const t=this.coordinateSystem,n=this.children.concat(),[r,i,a,c,o,f]=n;for(const g of n)this.remove(g);if(t===nu)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else if(t===ES)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);for(const g of n)this.add(g),g.updateMatrixWorld()}update(t,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[a,c,o,f,g,_]=this.children,x=t.getRenderTarget(),M=t.getActiveCubeFace(),C=t.getActiveMipmapLevel(),A=t.xr.enabled;t.xr.enabled=!1;const L=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0,i),t.render(n,a),t.setRenderTarget(r,1,i),t.render(n,c),t.setRenderTarget(r,2,i),t.render(n,o),t.setRenderTarget(r,3,i),t.render(n,f),t.setRenderTarget(r,4,i),t.render(n,g),r.texture.generateMipmaps=L,t.setRenderTarget(r,5,i),t.render(n,_),t.setRenderTarget(x,M,C),t.xr.enabled=A,r.texture.needsPMREMUpdate=!0}}class R7 extends Ho{constructor(t=[],n=Dg,r,i,a,c,o,f,g,_){super(t,n,r,i,a,c,o,f,g,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class CMe extends Zh{constructor(t=1,n={}){super(t,t,n),this.isWebGLCubeRenderTarget=!0;const r={width:t,height:t,depth:1},i=[r,r,r,r,r,r];this.texture=new R7(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:_a}fromEquirectangularTexture(t,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new px(5,5,5),a=new vu({name:"CubemapFromEquirect",uniforms:Og(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Hs,blending:kh});a.uniforms.tEquirect.value=n;const c=new Ns(i,a),o=n.minFilter;return n.minFilter===wh&&(n.minFilter=_a),new MMe(1,10,this).update(t,c),n.minFilter=o,c.geometry.dispose(),c.material.dispose(),this}clear(t,n=!0,r=!0,i=!0){const a=t.getRenderTarget();for(let c=0;c<6;c++)t.setRenderTarget(this,c),t.clear(n,r,i);t.setRenderTarget(a)}}class Sh extends Go{constructor(){super(),this.isGroup=!0,this.type="Group"}}const EMe={type:"move"};class sP{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Sh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Sh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new dt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new dt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Sh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new dt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new dt),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const n=this._hand;if(n)for(const r of t.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,n,r){let i=null,a=null,c=null;const o=this._targetRay,f=this._grip,g=this._hand;if(t&&n.session.visibilityState!=="visible-blurred"){if(g&&t.hand){c=!0;for(const L of t.hand.values()){const I=n.getJointPose(L,r),T=this._getHandJoint(g,L);I!==null&&(T.matrix.fromArray(I.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=!0,T.jointRadius=I.radius),T.visible=I!==null}const _=g.joints["index-finger-tip"],x=g.joints["thumb-tip"],M=_.position.distanceTo(x.position),C=.02,A=.005;g.inputState.pinching&&M>C+A?(g.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!g.inputState.pinching&&M<=C-A&&(g.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else f!==null&&t.gripSpace&&(a=n.getPose(t.gripSpace,r),a!==null&&(f.matrix.fromArray(a.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,a.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(a.linearVelocity)):f.hasLinearVelocity=!1,a.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(a.angularVelocity)):f.hasAngularVelocity=!1));o!==null&&(i=n.getPose(t.targetRaySpace,r),i===null&&a!==null&&(i=a),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(EMe)))}return o!==null&&(o.visible=i!==null),f!==null&&(f.visible=a!==null),g!==null&&(g.visible=c!==null),this}_getHandJoint(t,n){if(t.joints[n.jointName]===void 0){const r=new Sh;r.matrixAutoUpdate=!1,r.visible=!1,t.joints[n.jointName]=r,t.add(r)}return t.joints[n.jointName]}}class PS extends Go{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Sc,this.environmentIntensity=1,this.environmentRotation=new Sc,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,n){return super.copy(t,n),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const n=super.toJSON(t);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}const aP=new dt,TMe=new dt,PMe=new sr;class cf{constructor(t=new dt(1,0,0),n=0){this.isPlane=!0,this.normal=t,this.constant=n}set(t,n){return this.normal.copy(t),this.constant=n,this}setComponents(t,n,r,i){return this.normal.set(t,n,r),this.constant=i,this}setFromNormalAndCoplanarPoint(t,n){return this.normal.copy(t),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(t,n,r){const i=aP.subVectors(r,n).cross(TMe.subVectors(t,n)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,n){return n.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,n){const r=t.delta(aP),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(t.start)===0?n.copy(t.start):null;const a=-(t.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:n.copy(t.start).addScaledVector(r,a)}intersectsLine(t){const n=this.distanceToPoint(t.start),r=this.distanceToPoint(t.end);return n<0&&r>0||r<0&&n>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,n){const r=n||PMe.getNormalMatrix(t),i=this.coplanarPoint(aP).applyMatrix4(t),a=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(a),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const nf=new m2,Mb=new dt;class YL{constructor(t=new cf,n=new cf,r=new cf,i=new cf,a=new cf,c=new cf){this.planes=[t,n,r,i,a,c]}set(t,n,r,i,a,c){const o=this.planes;return o[0].copy(t),o[1].copy(n),o[2].copy(r),o[3].copy(i),o[4].copy(a),o[5].copy(c),this}copy(t){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(t.planes[r]);return this}setFromProjectionMatrix(t,n=nu){const r=this.planes,i=t.elements,a=i[0],c=i[1],o=i[2],f=i[3],g=i[4],_=i[5],x=i[6],M=i[7],C=i[8],A=i[9],L=i[10],I=i[11],T=i[12],z=i[13],k=i[14],U=i[15];if(r[0].setComponents(f-a,M-g,I-C,U-T).normalize(),r[1].setComponents(f+a,M+g,I+C,U+T).normalize(),r[2].setComponents(f+c,M+_,I+A,U+z).normalize(),r[3].setComponents(f-c,M-_,I-A,U-z).normalize(),r[4].setComponents(f-o,M-x,I-L,U-k).normalize(),n===nu)r[5].setComponents(f+o,M+x,I+L,U+k).normalize();else if(n===ES)r[5].setComponents(o,x,L,k).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(t){if(t.boundingSphere!==void 0)t.boundingSphere===null&&t.computeBoundingSphere(),nf.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const n=t.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),nf.copy(n.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(nf)}intersectsSprite(t){return nf.center.set(0,0,0),nf.radius=.7071067811865476,nf.applyMatrix4(t.matrixWorld),this.intersectsSphere(nf)}intersectsSphere(t){const n=this.planes,r=t.center,i=-t.radius;for(let a=0;a<6;a++)if(n[a].distanceToPoint(r)<i)return!1;return!0}intersectsBox(t){const n=this.planes;for(let r=0;r<6;r++){const i=n[r];if(Mb.x=i.normal.x>0?t.max.x:t.min.x,Mb.y=i.normal.y>0?t.max.y:t.min.y,Mb.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(Mb)<0)return!1}return!0}containsPoint(t){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class AMe extends fx{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Br(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const AS=new dt,IS=new dt,eB=new jr,z0=new XL,Cb=new m2,lP=new dt,tB=new dt;class IMe extends Go{constructor(t=new Ec,n=new AMe){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,n){return super.copy(t,n),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.index===null){const n=t.attributes.position,r=[0];for(let i=1,a=n.count;i<a;i++)AS.fromBufferAttribute(n,i-1),IS.fromBufferAttribute(n,i),r[i]=r[i-1],r[i]+=AS.distanceTo(IS);t.setAttribute("lineDistance",new Ca(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,n){const r=this.geometry,i=this.matrixWorld,a=t.params.Line.threshold,c=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Cb.copy(r.boundingSphere),Cb.applyMatrix4(i),Cb.radius+=a,t.ray.intersectsSphere(Cb)===!1)return;eB.copy(i).invert(),z0.copy(t.ray).applyMatrix4(eB);const o=a/((this.scale.x+this.scale.y+this.scale.z)/3),f=o*o,g=this.isLineSegments?2:1,_=r.index,M=r.attributes.position;if(_!==null){const C=Math.max(0,c.start),A=Math.min(_.count,c.start+c.count);for(let L=C,I=A-1;L<I;L+=g){const T=_.getX(L),z=_.getX(L+1),k=Eb(this,t,z0,f,T,z,L);k&&n.push(k)}if(this.isLineLoop){const L=_.getX(A-1),I=_.getX(C),T=Eb(this,t,z0,f,L,I,A-1);T&&n.push(T)}}else{const C=Math.max(0,c.start),A=Math.min(M.count,c.start+c.count);for(let L=C,I=A-1;L<I;L+=g){const T=Eb(this,t,z0,f,L,L+1,L);T&&n.push(T)}if(this.isLineLoop){const L=Eb(this,t,z0,f,A-1,C,A-1);L&&n.push(L)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=i.length;a<c;a++){const o=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}}function Eb(e,t,n,r,i,a,c){const o=e.geometry.attributes.position;if(AS.fromBufferAttribute(o,i),IS.fromBufferAttribute(o,a),n.distanceSqToSegment(AS,IS,lP,tB)>r)return;lP.applyMatrix4(e.matrixWorld);const g=t.ray.origin.distanceTo(lP);if(!(g<t.near||g>t.far))return{distance:g,point:tB.clone().applyMatrix4(e.matrixWorld),index:c,face:null,faceIndex:null,barycoord:null,object:e}}const nB=new dt,rB=new dt;class RMe extends IMe{constructor(t,n){super(t,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.index===null){const n=t.attributes.position,r=[];for(let i=0,a=n.count;i<a;i+=2)nB.fromBufferAttribute(n,i),rB.fromBufferAttribute(n,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+nB.distanceTo(rB);t.setAttribute("lineDistance",new Ca(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LMe extends Ho{constructor(t,n,r,i,a=_a,c=_a,o,f,g){super(t,n,r,i,a,c,o,f,g),this.isVideoTexture=!0,this.generateMipmaps=!1;const _=this;function x(){_.needsUpdate=!0,t.requestVideoFrameCallback(x)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(x)}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;"requestVideoFrameCallback"in t===!1&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class L7 extends Ho{constructor(t,n,r=$f,i,a,c,o=Ll,f=Ll,g,_=__){if(_!==__&&_!==x_)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,i,a,c,o,f,_,r,g),this.isDepthTexture=!0,this.image={width:t,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.source=new qL(Object.assign({},t.image)),this.compareFunction=t.compareFunction,this}toJSON(t){const n=super.toJSON(t);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class mx extends Ec{constructor(t=1,n=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:n,widthSegments:r,heightSegments:i};const a=t/2,c=n/2,o=Math.floor(r),f=Math.floor(i),g=o+1,_=f+1,x=t/o,M=n/f,C=[],A=[],L=[],I=[];for(let T=0;T<_;T++){const z=T*M-c;for(let k=0;k<g;k++){const U=k*x-a;A.push(U,-z,0),L.push(0,0,1),I.push(k/o),I.push(1-T/f)}}for(let T=0;T<f;T++)for(let z=0;z<o;z++){const k=z+g*T,U=z+g*(T+1),H=z+1+g*(T+1),V=z+1+g*T;C.push(k,U,V),C.push(U,H,V)}this.setIndex(C),this.setAttribute("position",new Ca(A,3)),this.setAttribute("normal",new Ca(L,3)),this.setAttribute("uv",new Ca(I,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new mx(t.width,t.height,t.widthSegments,t.heightSegments)}}class Kg extends Ec{constructor(t=1,n=32,r=16,i=0,a=Math.PI*2,c=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:n,heightSegments:r,phiStart:i,phiLength:a,thetaStart:c,thetaLength:o},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const f=Math.min(c+o,Math.PI);let g=0;const _=[],x=new dt,M=new dt,C=[],A=[],L=[],I=[];for(let T=0;T<=r;T++){const z=[],k=T/r;let U=0;T===0&&c===0?U=.5/n:T===r&&f===Math.PI&&(U=-.5/n);for(let H=0;H<=n;H++){const V=H/n;x.x=-t*Math.cos(i+V*a)*Math.sin(c+k*o),x.y=t*Math.cos(c+k*o),x.z=t*Math.sin(i+V*a)*Math.sin(c+k*o),A.push(x.x,x.y,x.z),M.copy(x).normalize(),L.push(M.x,M.y,M.z),I.push(V+U,1-k),z.push(g++)}_.push(z)}for(let T=0;T<r;T++)for(let z=0;z<n;z++){const k=_[T][z+1],U=_[T][z],H=_[T+1][z],V=_[T+1][z+1];(T!==0||c>0)&&C.push(k,U,V),(T!==r-1||f<Math.PI)&&C.push(U,H,V)}this.setIndex(C),this.setAttribute("position",new Ca(A,3)),this.setAttribute("normal",new Ca(L,3)),this.setAttribute("uv",new Ca(I,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Kg(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class kMe extends Ec{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},t!==null){const n=[],r=new Set,i=new dt,a=new dt;if(t.index!==null){const c=t.attributes.position,o=t.index;let f=t.groups;f.length===0&&(f=[{start:0,count:o.count,materialIndex:0}]);for(let g=0,_=f.length;g<_;++g){const x=f[g],M=x.start,C=x.count;for(let A=M,L=M+C;A<L;A+=3)for(let I=0;I<3;I++){const T=o.getX(A+I),z=o.getX(A+(I+1)%3);i.fromBufferAttribute(c,T),a.fromBufferAttribute(c,z),iB(i,a,r)===!0&&(n.push(i.x,i.y,i.z),n.push(a.x,a.y,a.z))}}}else{const c=t.attributes.position;for(let o=0,f=c.count/3;o<f;o++)for(let g=0;g<3;g++){const _=3*o+g,x=3*o+(g+1)%3;i.fromBufferAttribute(c,_),a.fromBufferAttribute(c,x),iB(i,a,r)===!0&&(n.push(i.x,i.y,i.z),n.push(a.x,a.y,a.z))}}this.setAttribute("position",new Ca(n,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}function iB(e,t,n){const r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return n.has(r)===!0||n.has(i)===!0?!1:(n.add(r),n.add(i),!0)}class DMe extends fx{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ESe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class zMe extends fx{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}const $I={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class OMe{constructor(t,n,r){const i=this;let a=!1,c=0,o=0,f;const g=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(_){o++,a===!1&&i.onStart!==void 0&&i.onStart(_,c,o),a=!0},this.itemEnd=function(_){c++,i.onProgress!==void 0&&i.onProgress(_,c,o),c===o&&(a=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(_){i.onError!==void 0&&i.onError(_)},this.resolveURL=function(_){return f?f(_):_},this.setURLModifier=function(_){return f=_,this},this.addHandler=function(_,x){return g.push(_,x),this},this.removeHandler=function(_){const x=g.indexOf(_);return x!==-1&&g.splice(x,2),this},this.getHandler=function(_){for(let x=0,M=g.length;x<M;x+=2){const C=g[x],A=g[x+1];if(C.global&&(C.lastIndex=0),C.test(_))return A}return null}}}const FMe=new OMe;let KL=class{constructor(t){this.manager=t!==void 0?t:FMe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){const r=this;return new Promise(function(i,a){r.load(t,i,n,a)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}};KL.DEFAULT_MATERIAL_NAME="__DEFAULT";class NMe extends I7{constructor(t=-1,n=1,r=1,i=-1,a=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=n,this.top=r,this.bottom=i,this.near=a,this.far=c,this.updateProjectionMatrix()}copy(t,n){return super.copy(t,n),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,n,r,i,a,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=r-t,c=r+t,o=i+n,f=i-n;if(this.view!==null&&this.view.enabled){const g=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=g*this.view.offsetX,c=a+g*this.view.width,o-=_*this.view.offsetY,f=o-_*this.view.height}this.projectionMatrix.makeOrthographic(a,c,o,f,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const n=super.toJSON(t);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class BMe extends pa{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t,this.index=0}}const oB=new jr;class UMe{constructor(t,n,r=0,i=1/0){this.ray=new XL(t,n),this.near=r,this.far=i,this.camera=null,this.layers=new ZL,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,n){this.ray.set(t,n)}setFromCamera(t,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(t){return oB.identity().extractRotation(t.matrixWorld),this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(oB),this}intersectObject(t,n=!0,r=[]){return VI(t,this,r,n),r.sort(sB),r}intersectObjects(t,n=!0,r=[]){for(let i=0,a=t.length;i<a;i++)VI(t[i],this,r,n);return r.sort(sB),r}}function sB(e,t){return e.distance-t.distance}function VI(e,t,n,r){let i=!0;if(e.layers.test(t.layers)&&e.raycast(t,n)===!1&&(i=!1),i===!0&&r===!0){const a=e.children;for(let c=0,o=a.length;c<o;c++)VI(a[c],t,n,!0)}}function aB(e,t,n,r){const i=$Me(r);switch(n){case g7:return e*t;case y7:return e*t;case _7:return e*t*2;case x7:return e*t/i.components*i.byteLength;case jL:return e*t/i.components*i.byteLength;case b7:return e*t*2/i.components*i.byteLength;case HL:return e*t*2/i.components*i.byteLength;case v7:return e*t*3/i.components*i.byteLength;case Pl:return e*t*4/i.components*i.byteLength;case GL:return e*t*4/i.components*i.byteLength;case gw:case vw:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case yw:case _w:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case gI:case yI:return Math.max(e,16)*Math.max(t,8)/4;case mI:case vI:return Math.max(e,8)*Math.max(t,8)/2;case _I:case xI:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case bI:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case wI:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case SI:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case MI:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case CI:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case EI:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case TI:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case PI:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case AI:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case II:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case RI:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case LI:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case kI:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case DI:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case zI:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case xw:case OI:case FI:return Math.ceil(e/4)*Math.ceil(t/4)*16;case w7:case NI:return Math.ceil(e/4)*Math.ceil(t/4)*8;case BI:case UI:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function $Me(e){switch(e){case gu:case f7:return{byteLength:1,components:1};case v_:case p7:case dx:return{byteLength:2,components:1};case $L:case VL:return{byteLength:2,components:4};case $f:case UL:case tu:return{byteLength:4,components:1};case m7:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:BL}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=BL);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function k7(){let e=null,t=!1,n=null,r=null;function i(a,c){n(a,c),r=e.requestAnimationFrame(i)}return{start:function(){t!==!0&&n!==null&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(a){n=a},setContext:function(a){e=a}}}function VMe(e){const t=new WeakMap;function n(o,f){const g=o.array,_=o.usage,x=g.byteLength,M=e.createBuffer();e.bindBuffer(f,M),e.bufferData(f,g,_),o.onUploadCallback();let C;if(g instanceof Float32Array)C=e.FLOAT;else if(g instanceof Uint16Array)o.isFloat16BufferAttribute?C=e.HALF_FLOAT:C=e.UNSIGNED_SHORT;else if(g instanceof Int16Array)C=e.SHORT;else if(g instanceof Uint32Array)C=e.UNSIGNED_INT;else if(g instanceof Int32Array)C=e.INT;else if(g instanceof Int8Array)C=e.BYTE;else if(g instanceof Uint8Array)C=e.UNSIGNED_BYTE;else if(g instanceof Uint8ClampedArray)C=e.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+g);return{buffer:M,type:C,bytesPerElement:g.BYTES_PER_ELEMENT,version:o.version,size:x}}function r(o,f,g){const _=f.array,x=f.updateRanges;if(e.bindBuffer(g,o),x.length===0)e.bufferSubData(g,0,_);else{x.sort((C,A)=>C.start-A.start);let M=0;for(let C=1;C<x.length;C++){const A=x[M],L=x[C];L.start<=A.start+A.count+1?A.count=Math.max(A.count,L.start+L.count-A.start):(++M,x[M]=L)}x.length=M+1;for(let C=0,A=x.length;C<A;C++){const L=x[C];e.bufferSubData(g,L.start*_.BYTES_PER_ELEMENT,_,L.start,L.count)}f.clearUpdateRanges()}f.onUploadCallback()}function i(o){return o.isInterleavedBufferAttribute&&(o=o.data),t.get(o)}function a(o){o.isInterleavedBufferAttribute&&(o=o.data);const f=t.get(o);f&&(e.deleteBuffer(f.buffer),t.delete(o))}function c(o,f){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const _=t.get(o);(!_||_.version<o.version)&&t.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const g=t.get(o);if(g===void 0)t.set(o,n(o,f));else if(g.version<o.version){if(g.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(g.buffer,o,f),g.version=o.version}}return{get:i,remove:a,update:c}}var jMe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,HMe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,GMe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,WMe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,qMe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,XMe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,ZMe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,YMe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,KMe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,JMe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,QMe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,e2e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,t2e=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,n2e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,r2e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,i2e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,o2e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,s2e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,a2e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,l2e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,c2e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,u2e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,h2e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,d2e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,f2e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,p2e=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,m2e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,g2e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,v2e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,y2e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,_2e="gl_FragColor = linearToOutputTexel( gl_FragColor );",x2e=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,b2e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,w2e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,S2e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,M2e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,C2e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,E2e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,T2e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,P2e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,A2e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,I2e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,R2e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,L2e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,k2e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,D2e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,z2e=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,O2e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,F2e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,N2e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,B2e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,U2e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,$2e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,V2e=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,j2e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,H2e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,G2e=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,W2e=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,q2e=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,X2e=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Z2e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Y2e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,K2e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,J2e=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Q2e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,eCe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,tCe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,nCe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,rCe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,iCe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,oCe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,sCe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,aCe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,lCe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,cCe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,uCe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,hCe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,dCe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,fCe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,pCe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,mCe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,gCe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,vCe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,yCe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,_Ce=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,xCe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,bCe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,wCe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,SCe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,MCe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,CCe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,ECe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,TCe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,PCe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,ACe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,ICe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,RCe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,LCe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,kCe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,DCe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,zCe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,OCe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,FCe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,NCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,BCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,UCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,$Ce=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const VCe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,jCe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,HCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,GCe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,WCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,qCe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,XCe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,ZCe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,YCe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,KCe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,JCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,QCe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,eEe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,tEe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,nEe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,rEe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iEe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,oEe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sEe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,aEe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lEe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,cEe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,uEe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,hEe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dEe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fEe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pEe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,mEe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gEe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,vEe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,yEe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_Ee=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,xEe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,bEe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,lr={alphahash_fragment:jMe,alphahash_pars_fragment:HMe,alphamap_fragment:GMe,alphamap_pars_fragment:WMe,alphatest_fragment:qMe,alphatest_pars_fragment:XMe,aomap_fragment:ZMe,aomap_pars_fragment:YMe,batching_pars_vertex:KMe,batching_vertex:JMe,begin_vertex:QMe,beginnormal_vertex:e2e,bsdfs:t2e,iridescence_fragment:n2e,bumpmap_pars_fragment:r2e,clipping_planes_fragment:i2e,clipping_planes_pars_fragment:o2e,clipping_planes_pars_vertex:s2e,clipping_planes_vertex:a2e,color_fragment:l2e,color_pars_fragment:c2e,color_pars_vertex:u2e,color_vertex:h2e,common:d2e,cube_uv_reflection_fragment:f2e,defaultnormal_vertex:p2e,displacementmap_pars_vertex:m2e,displacementmap_vertex:g2e,emissivemap_fragment:v2e,emissivemap_pars_fragment:y2e,colorspace_fragment:_2e,colorspace_pars_fragment:x2e,envmap_fragment:b2e,envmap_common_pars_fragment:w2e,envmap_pars_fragment:S2e,envmap_pars_vertex:M2e,envmap_physical_pars_fragment:z2e,envmap_vertex:C2e,fog_vertex:E2e,fog_pars_vertex:T2e,fog_fragment:P2e,fog_pars_fragment:A2e,gradientmap_pars_fragment:I2e,lightmap_pars_fragment:R2e,lights_lambert_fragment:L2e,lights_lambert_pars_fragment:k2e,lights_pars_begin:D2e,lights_toon_fragment:O2e,lights_toon_pars_fragment:F2e,lights_phong_fragment:N2e,lights_phong_pars_fragment:B2e,lights_physical_fragment:U2e,lights_physical_pars_fragment:$2e,lights_fragment_begin:V2e,lights_fragment_maps:j2e,lights_fragment_end:H2e,logdepthbuf_fragment:G2e,logdepthbuf_pars_fragment:W2e,logdepthbuf_pars_vertex:q2e,logdepthbuf_vertex:X2e,map_fragment:Z2e,map_pars_fragment:Y2e,map_particle_fragment:K2e,map_particle_pars_fragment:J2e,metalnessmap_fragment:Q2e,metalnessmap_pars_fragment:eCe,morphinstance_vertex:tCe,morphcolor_vertex:nCe,morphnormal_vertex:rCe,morphtarget_pars_vertex:iCe,morphtarget_vertex:oCe,normal_fragment_begin:sCe,normal_fragment_maps:aCe,normal_pars_fragment:lCe,normal_pars_vertex:cCe,normal_vertex:uCe,normalmap_pars_fragment:hCe,clearcoat_normal_fragment_begin:dCe,clearcoat_normal_fragment_maps:fCe,clearcoat_pars_fragment:pCe,iridescence_pars_fragment:mCe,opaque_fragment:gCe,packing:vCe,premultiplied_alpha_fragment:yCe,project_vertex:_Ce,dithering_fragment:xCe,dithering_pars_fragment:bCe,roughnessmap_fragment:wCe,roughnessmap_pars_fragment:SCe,shadowmap_pars_fragment:MCe,shadowmap_pars_vertex:CCe,shadowmap_vertex:ECe,shadowmask_pars_fragment:TCe,skinbase_vertex:PCe,skinning_pars_vertex:ACe,skinning_vertex:ICe,skinnormal_vertex:RCe,specularmap_fragment:LCe,specularmap_pars_fragment:kCe,tonemapping_fragment:DCe,tonemapping_pars_fragment:zCe,transmission_fragment:OCe,transmission_pars_fragment:FCe,uv_pars_fragment:NCe,uv_pars_vertex:BCe,uv_vertex:UCe,worldpos_vertex:$Ce,background_vert:VCe,background_frag:jCe,backgroundCube_vert:HCe,backgroundCube_frag:GCe,cube_vert:WCe,cube_frag:qCe,depth_vert:XCe,depth_frag:ZCe,distanceRGBA_vert:YCe,distanceRGBA_frag:KCe,equirect_vert:JCe,equirect_frag:QCe,linedashed_vert:eEe,linedashed_frag:tEe,meshbasic_vert:nEe,meshbasic_frag:rEe,meshlambert_vert:iEe,meshlambert_frag:oEe,meshmatcap_vert:sEe,meshmatcap_frag:aEe,meshnormal_vert:lEe,meshnormal_frag:cEe,meshphong_vert:uEe,meshphong_frag:hEe,meshphysical_vert:dEe,meshphysical_frag:fEe,meshtoon_vert:pEe,meshtoon_frag:mEe,points_vert:gEe,points_frag:vEe,shadow_vert:yEe,shadow_frag:_Ee,sprite_vert:xEe,sprite_frag:bEe},Tn={common:{diffuse:{value:new Br(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new sr},alphaMap:{value:null},alphaMapTransform:{value:new sr},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new sr}},envmap:{envMap:{value:null},envMapRotation:{value:new sr},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new sr}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new sr}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new sr},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new sr},normalScale:{value:new Dr(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new sr},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new sr}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new sr}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new sr}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Br(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Br(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new sr},alphaTest:{value:0},uvTransform:{value:new sr}},sprite:{diffuse:{value:new Br(16777215)},opacity:{value:1},center:{value:new Dr(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new sr},alphaMap:{value:null},alphaMapTransform:{value:new sr},alphaTest:{value:0}}},cc={basic:{uniforms:gs([Tn.common,Tn.specularmap,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.fog]),vertexShader:lr.meshbasic_vert,fragmentShader:lr.meshbasic_frag},lambert:{uniforms:gs([Tn.common,Tn.specularmap,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.fog,Tn.lights,{emissive:{value:new Br(0)}}]),vertexShader:lr.meshlambert_vert,fragmentShader:lr.meshlambert_frag},phong:{uniforms:gs([Tn.common,Tn.specularmap,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.fog,Tn.lights,{emissive:{value:new Br(0)},specular:{value:new Br(1118481)},shininess:{value:30}}]),vertexShader:lr.meshphong_vert,fragmentShader:lr.meshphong_frag},standard:{uniforms:gs([Tn.common,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.roughnessmap,Tn.metalnessmap,Tn.fog,Tn.lights,{emissive:{value:new Br(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:lr.meshphysical_vert,fragmentShader:lr.meshphysical_frag},toon:{uniforms:gs([Tn.common,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.gradientmap,Tn.fog,Tn.lights,{emissive:{value:new Br(0)}}]),vertexShader:lr.meshtoon_vert,fragmentShader:lr.meshtoon_frag},matcap:{uniforms:gs([Tn.common,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.fog,{matcap:{value:null}}]),vertexShader:lr.meshmatcap_vert,fragmentShader:lr.meshmatcap_frag},points:{uniforms:gs([Tn.points,Tn.fog]),vertexShader:lr.points_vert,fragmentShader:lr.points_frag},dashed:{uniforms:gs([Tn.common,Tn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:lr.linedashed_vert,fragmentShader:lr.linedashed_frag},depth:{uniforms:gs([Tn.common,Tn.displacementmap]),vertexShader:lr.depth_vert,fragmentShader:lr.depth_frag},normal:{uniforms:gs([Tn.common,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,{opacity:{value:1}}]),vertexShader:lr.meshnormal_vert,fragmentShader:lr.meshnormal_frag},sprite:{uniforms:gs([Tn.sprite,Tn.fog]),vertexShader:lr.sprite_vert,fragmentShader:lr.sprite_frag},background:{uniforms:{uvTransform:{value:new sr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:lr.background_vert,fragmentShader:lr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new sr}},vertexShader:lr.backgroundCube_vert,fragmentShader:lr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:lr.cube_vert,fragmentShader:lr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:lr.equirect_vert,fragmentShader:lr.equirect_frag},distanceRGBA:{uniforms:gs([Tn.common,Tn.displacementmap,{referencePosition:{value:new dt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:lr.distanceRGBA_vert,fragmentShader:lr.distanceRGBA_frag},shadow:{uniforms:gs([Tn.lights,Tn.fog,{color:{value:new Br(0)},opacity:{value:1}}]),vertexShader:lr.shadow_vert,fragmentShader:lr.shadow_frag}};cc.physical={uniforms:gs([cc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new sr},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new sr},clearcoatNormalScale:{value:new Dr(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new sr},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new sr},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new sr},sheen:{value:0},sheenColor:{value:new Br(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new sr},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new sr},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new sr},transmissionSamplerSize:{value:new Dr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new sr},attenuationDistance:{value:0},attenuationColor:{value:new Br(0)},specularColor:{value:new Br(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new sr},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new sr},anisotropyVector:{value:new Dr},anisotropyMap:{value:null},anisotropyMapTransform:{value:new sr}}]),vertexShader:lr.meshphysical_vert,fragmentShader:lr.meshphysical_frag};const Tb={r:0,b:0,g:0},rf=new Sc,wEe=new jr;function SEe(e,t,n,r,i,a,c){const o=new Br(0);let f=a===!0?0:1,g,_,x=null,M=0,C=null;function A(k){let U=k.isScene===!0?k.background:null;return U&&U.isTexture&&(U=(k.backgroundBlurriness>0?n:t).get(U)),U}function L(k){let U=!1;const H=A(k);H===null?T(o,f):H&&H.isColor&&(T(H,1),U=!0);const V=e.xr.getEnvironmentBlendMode();V==="additive"?r.buffers.color.setClear(0,0,0,1,c):V==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,c),(e.autoClear||U)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))}function I(k,U){const H=A(U);H&&(H.isCubeTexture||H.mapping===p2)?(_===void 0&&(_=new Ns(new px(1,1,1),new vu({name:"BackgroundCubeMaterial",uniforms:Og(cc.backgroundCube.uniforms),vertexShader:cc.backgroundCube.vertexShader,fragmentShader:cc.backgroundCube.fragmentShader,side:Hs,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(V,q,J){this.matrixWorld.copyPosition(J.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(_)),rf.copy(U.backgroundRotation),rf.x*=-1,rf.y*=-1,rf.z*=-1,H.isCubeTexture&&H.isRenderTargetTexture===!1&&(rf.y*=-1,rf.z*=-1),_.material.uniforms.envMap.value=H,_.material.uniforms.flipEnvMap.value=H.isCubeTexture&&H.isRenderTargetTexture===!1?-1:1,_.material.uniforms.backgroundBlurriness.value=U.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=U.backgroundIntensity,_.material.uniforms.backgroundRotation.value.setFromMatrix4(wEe.makeRotationFromEuler(rf)),_.material.toneMapped=Tr.getTransfer(H.colorSpace)!==qr,(x!==H||M!==H.version||C!==e.toneMapping)&&(_.material.needsUpdate=!0,x=H,M=H.version,C=e.toneMapping),_.layers.enableAll(),k.unshift(_,_.geometry,_.material,0,0,null)):H&&H.isTexture&&(g===void 0&&(g=new Ns(new mx(2,2),new vu({name:"BackgroundMaterial",uniforms:Og(cc.background.uniforms),vertexShader:cc.background.vertexShader,fragmentShader:cc.background.fragmentShader,side:Xh,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),g.geometry.deleteAttribute("normal"),Object.defineProperty(g.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(g)),g.material.uniforms.t2D.value=H,g.material.uniforms.backgroundIntensity.value=U.backgroundIntensity,g.material.toneMapped=Tr.getTransfer(H.colorSpace)!==qr,H.matrixAutoUpdate===!0&&H.updateMatrix(),g.material.uniforms.uvTransform.value.copy(H.matrix),(x!==H||M!==H.version||C!==e.toneMapping)&&(g.material.needsUpdate=!0,x=H,M=H.version,C=e.toneMapping),g.layers.enableAll(),k.unshift(g,g.geometry,g.material,0,0,null))}function T(k,U){k.getRGB(Tb,A7(e)),r.buffers.color.setClear(Tb.r,Tb.g,Tb.b,U,c)}function z(){_!==void 0&&(_.geometry.dispose(),_.material.dispose(),_=void 0),g!==void 0&&(g.geometry.dispose(),g.material.dispose(),g=void 0)}return{getClearColor:function(){return o},setClearColor:function(k,U=1){o.set(k),f=U,T(o,f)},getClearAlpha:function(){return f},setClearAlpha:function(k){f=k,T(o,f)},render:L,addToRenderList:I,dispose:z}}function MEe(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},i=M(null);let a=i,c=!1;function o(N,ne,ye,ge,Ne){let Ae=!1;const ve=x(ge,ye,ne);a!==ve&&(a=ve,g(a.object)),Ae=C(N,ge,ye,Ne),Ae&&A(N,ge,ye,Ne),Ne!==null&&t.update(Ne,e.ELEMENT_ARRAY_BUFFER),(Ae||c)&&(c=!1,U(N,ne,ye,ge),Ne!==null&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(Ne).buffer))}function f(){return e.createVertexArray()}function g(N){return e.bindVertexArray(N)}function _(N){return e.deleteVertexArray(N)}function x(N,ne,ye){const ge=ye.wireframe===!0;let Ne=r[N.id];Ne===void 0&&(Ne={},r[N.id]=Ne);let Ae=Ne[ne.id];Ae===void 0&&(Ae={},Ne[ne.id]=Ae);let ve=Ae[ge];return ve===void 0&&(ve=M(f()),Ae[ge]=ve),ve}function M(N){const ne=[],ye=[],ge=[];for(let Ne=0;Ne<n;Ne++)ne[Ne]=0,ye[Ne]=0,ge[Ne]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ne,enabledAttributes:ye,attributeDivisors:ge,object:N,attributes:{},index:null}}function C(N,ne,ye,ge){const Ne=a.attributes,Ae=ne.attributes;let ve=0;const Se=ye.getAttributes();for(const Me in Se)if(Se[Me].location>=0){const Qe=Ne[Me];let st=Ae[Me];if(st===void 0&&(Me==="instanceMatrix"&&N.instanceMatrix&&(st=N.instanceMatrix),Me==="instanceColor"&&N.instanceColor&&(st=N.instanceColor)),Qe===void 0||Qe.attribute!==st||st&&Qe.data!==st.data)return!0;ve++}return a.attributesNum!==ve||a.index!==ge}function A(N,ne,ye,ge){const Ne={},Ae=ne.attributes;let ve=0;const Se=ye.getAttributes();for(const Me in Se)if(Se[Me].location>=0){let Qe=Ae[Me];Qe===void 0&&(Me==="instanceMatrix"&&N.instanceMatrix&&(Qe=N.instanceMatrix),Me==="instanceColor"&&N.instanceColor&&(Qe=N.instanceColor));const st={};st.attribute=Qe,Qe&&Qe.data&&(st.data=Qe.data),Ne[Me]=st,ve++}a.attributes=Ne,a.attributesNum=ve,a.index=ge}function L(){const N=a.newAttributes;for(let ne=0,ye=N.length;ne<ye;ne++)N[ne]=0}function I(N){T(N,0)}function T(N,ne){const ye=a.newAttributes,ge=a.enabledAttributes,Ne=a.attributeDivisors;ye[N]=1,ge[N]===0&&(e.enableVertexAttribArray(N),ge[N]=1),Ne[N]!==ne&&(e.vertexAttribDivisor(N,ne),Ne[N]=ne)}function z(){const N=a.newAttributes,ne=a.enabledAttributes;for(let ye=0,ge=ne.length;ye<ge;ye++)ne[ye]!==N[ye]&&(e.disableVertexAttribArray(ye),ne[ye]=0)}function k(N,ne,ye,ge,Ne,Ae,ve){ve===!0?e.vertexAttribIPointer(N,ne,ye,Ne,Ae):e.vertexAttribPointer(N,ne,ye,ge,Ne,Ae)}function U(N,ne,ye,ge){L();const Ne=ge.attributes,Ae=ye.getAttributes(),ve=ne.defaultAttributeValues;for(const Se in Ae){const Me=Ae[Se];if(Me.location>=0){let Ue=Ne[Se];if(Ue===void 0&&(Se==="instanceMatrix"&&N.instanceMatrix&&(Ue=N.instanceMatrix),Se==="instanceColor"&&N.instanceColor&&(Ue=N.instanceColor)),Ue!==void 0){const Qe=Ue.normalized,st=Ue.itemSize,ct=t.get(Ue);if(ct===void 0)continue;const Xt=ct.buffer,je=ct.type,lt=ct.bytesPerElement,Ot=je===e.INT||je===e.UNSIGNED_INT||Ue.gpuType===UL;if(Ue.isInterleavedBufferAttribute){const ut=Ue.data,ot=ut.stride,Tt=Ue.offset;if(ut.isInstancedInterleavedBuffer){for(let Ct=0;Ct<Me.locationSize;Ct++)T(Me.location+Ct,ut.meshPerAttribute);N.isInstancedMesh!==!0&&ge._maxInstanceCount===void 0&&(ge._maxInstanceCount=ut.meshPerAttribute*ut.count)}else for(let Ct=0;Ct<Me.locationSize;Ct++)I(Me.location+Ct);e.bindBuffer(e.ARRAY_BUFFER,Xt);for(let Ct=0;Ct<Me.locationSize;Ct++)k(Me.location+Ct,st/Me.locationSize,je,Qe,ot*lt,(Tt+st/Me.locationSize*Ct)*lt,Ot)}else{if(Ue.isInstancedBufferAttribute){for(let ut=0;ut<Me.locationSize;ut++)T(Me.location+ut,Ue.meshPerAttribute);N.isInstancedMesh!==!0&&ge._maxInstanceCount===void 0&&(ge._maxInstanceCount=Ue.meshPerAttribute*Ue.count)}else for(let ut=0;ut<Me.locationSize;ut++)I(Me.location+ut);e.bindBuffer(e.ARRAY_BUFFER,Xt);for(let ut=0;ut<Me.locationSize;ut++)k(Me.location+ut,st/Me.locationSize,je,Qe,st*lt,st/Me.locationSize*ut*lt,Ot)}}else if(ve!==void 0){const Qe=ve[Se];if(Qe!==void 0)switch(Qe.length){case 2:e.vertexAttrib2fv(Me.location,Qe);break;case 3:e.vertexAttrib3fv(Me.location,Qe);break;case 4:e.vertexAttrib4fv(Me.location,Qe);break;default:e.vertexAttrib1fv(Me.location,Qe)}}}}z()}function H(){J();for(const N in r){const ne=r[N];for(const ye in ne){const ge=ne[ye];for(const Ne in ge)_(ge[Ne].object),delete ge[Ne];delete ne[ye]}delete r[N]}}function V(N){if(r[N.id]===void 0)return;const ne=r[N.id];for(const ye in ne){const ge=ne[ye];for(const Ne in ge)_(ge[Ne].object),delete ge[Ne];delete ne[ye]}delete r[N.id]}function q(N){for(const ne in r){const ye=r[ne];if(ye[N.id]===void 0)continue;const ge=ye[N.id];for(const Ne in ge)_(ge[Ne].object),delete ge[Ne];delete ye[N.id]}}function J(){Y(),c=!0,a!==i&&(a=i,g(a.object))}function Y(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:o,reset:J,resetDefaultState:Y,dispose:H,releaseStatesOfGeometry:V,releaseStatesOfProgram:q,initAttributes:L,enableAttribute:I,disableUnusedAttributes:z}}function CEe(e,t,n){let r;function i(g){r=g}function a(g,_){e.drawArrays(r,g,_),n.update(_,r,1)}function c(g,_,x){x!==0&&(e.drawArraysInstanced(r,g,_,x),n.update(_,r,x))}function o(g,_,x){if(x===0)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,g,0,_,0,x);let C=0;for(let A=0;A<x;A++)C+=_[A];n.update(C,r,1)}function f(g,_,x,M){if(x===0)return;const C=t.get("WEBGL_multi_draw");if(C===null)for(let A=0;A<g.length;A++)c(g[A],_[A],M[A]);else{C.multiDrawArraysInstancedWEBGL(r,g,0,_,0,M,0,x);let A=0;for(let L=0;L<x;L++)A+=_[L]*M[L];n.update(A,r,1)}}this.setMode=i,this.render=a,this.renderInstances=c,this.renderMultiDraw=o,this.renderMultiDrawInstances=f}function EEe(e,t,n,r){let i;function a(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){const q=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(q.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function c(q){return!(q!==Pl&&r.convert(q)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(q){const J=q===dx&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(q!==gu&&r.convert(q)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&q!==tu&&!J)}function f(q){if(q==="highp"){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";q="mediump"}return q==="mediump"&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let g=n.precision!==void 0?n.precision:"highp";const _=f(g);_!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",_,"instead."),g=_);const x=n.logarithmicDepthBuffer===!0,M=n.reverseDepthBuffer===!0&&t.has("EXT_clip_control"),C=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),A=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),L=e.getParameter(e.MAX_TEXTURE_SIZE),I=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),T=e.getParameter(e.MAX_VERTEX_ATTRIBS),z=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),k=e.getParameter(e.MAX_VARYING_VECTORS),U=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),H=A>0,V=e.getParameter(e.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:f,textureFormatReadable:c,textureTypeReadable:o,precision:g,logarithmicDepthBuffer:x,reverseDepthBuffer:M,maxTextures:C,maxVertexTextures:A,maxTextureSize:L,maxCubemapSize:I,maxAttributes:T,maxVertexUniforms:z,maxVaryings:k,maxFragmentUniforms:U,vertexTextures:H,maxSamples:V}}function TEe(e){const t=this;let n=null,r=0,i=!1,a=!1;const c=new cf,o=new sr,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(x,M){const C=x.length!==0||M||r!==0||i;return i=M,r=x.length,C},this.beginShadows=function(){a=!0,_(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(x,M){n=_(x,M,0)},this.setState=function(x,M,C){const A=x.clippingPlanes,L=x.clipIntersection,I=x.clipShadows,T=e.get(x);if(!i||A===null||A.length===0||a&&!I)a?_(null):g();else{const z=a?0:r,k=z*4;let U=T.clippingState||null;f.value=U,U=_(A,M,k,C);for(let H=0;H!==k;++H)U[H]=n[H];T.clippingState=U,this.numIntersection=L?this.numPlanes:0,this.numPlanes+=z}};function g(){f.value!==n&&(f.value=n,f.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function _(x,M,C,A){const L=x!==null?x.length:0;let I=null;if(L!==0){if(I=f.value,A!==!0||I===null){const T=C+L*4,z=M.matrixWorldInverse;o.getNormalMatrix(z),(I===null||I.length<T)&&(I=new Float32Array(T));for(let k=0,U=C;k!==L;++k,U+=4)c.copy(x[k]).applyMatrix4(z,o),c.normal.toArray(I,U),I[U+3]=c.constant}f.value=I,f.needsUpdate=!0}return t.numPlanes=L,t.numIntersection=0,I}}function PEe(e){let t=new WeakMap;function n(c,o){return o===hI?c.mapping=Dg:o===dI&&(c.mapping=zg),c}function r(c){if(c&&c.isTexture){const o=c.mapping;if(o===hI||o===dI)if(t.has(c)){const f=t.get(c).texture;return n(f,c.mapping)}else{const f=c.image;if(f&&f.height>0){const g=new CMe(f.height);return g.fromEquirectangularTexture(e,c),t.set(c,g),c.addEventListener("dispose",i),n(g.texture,c.mapping)}else return null}}return c}function i(c){const o=c.target;o.removeEventListener("dispose",i);const f=t.get(o);f!==void 0&&(t.delete(o),f.dispose())}function a(){t=new WeakMap}return{get:r,dispose:a}}const Hm=4,lB=[.125,.215,.35,.446,.526,.582],mf=20,cP=new NMe,cB=new Br;let uP=null,hP=0,dP=0,fP=!1;const uf=(1+Math.sqrt(5))/2,fm=1/uf,uB=[new dt(-uf,fm,0),new dt(uf,fm,0),new dt(-fm,0,uf),new dt(fm,0,uf),new dt(0,uf,-fm),new dt(0,uf,fm),new dt(-1,1,-1),new dt(1,1,-1),new dt(-1,1,1),new dt(1,1,1)],AEe=new dt;class hB{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,n=0,r=.1,i=100,a={}){const{size:c=256,position:o=AEe}=a;uP=this._renderer.getRenderTarget(),hP=this._renderer.getActiveCubeFace(),dP=this._renderer.getActiveMipmapLevel(),fP=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(c);const f=this._allocateTargets();return f.depthBuffer=!0,this._sceneToCubeUV(t,r,i,f,o),n>0&&this._blur(f,0,0,n),this._applyPMREM(f),this._cleanup(f),f}fromEquirectangular(t,n=null){return this._fromTexture(t,n)}fromCubemap(t,n=null){return this._fromTexture(t,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=pB(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=fB(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(uP,hP,dP),this._renderer.xr.enabled=fP,t.scissorTest=!1,Pb(t,0,0,t.width,t.height)}_fromTexture(t,n){t.mapping===Dg||t.mapping===zg?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),uP=this._renderer.getRenderTarget(),hP=this._renderer.getActiveCubeFace(),dP=this._renderer.getActiveMipmapLevel(),fP=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=n||this._allocateTargets();return this._textureToCubeUV(t,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:_a,minFilter:_a,generateMipmaps:!1,type:dx,format:Pl,colorSpace:Vf,depthBuffer:!1},i=dB(t,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=dB(t,n,r);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=IEe(a)),this._blurMaterial=REe(a,t,n)}return i}_compileMaterial(t){const n=new Ns(this._lodPlanes[0],t);this._renderer.compile(n,cP)}_sceneToCubeUV(t,n,r,i,a){const f=new pa(90,1,n,r),g=[1,-1,1,1,1,1],_=[1,1,1,-1,-1,-1],x=this._renderer,M=x.autoClear,C=x.toneMapping;x.getClearColor(cB),x.toneMapping=Dh,x.autoClear=!1;const A=new Yh({name:"PMREM.Background",side:Hs,depthWrite:!1,depthTest:!1}),L=new Ns(new px,A);let I=!1;const T=t.background;T?T.isColor&&(A.color.copy(T),t.background=null,I=!0):(A.color.copy(cB),I=!0);for(let z=0;z<6;z++){const k=z%3;k===0?(f.up.set(0,g[z],0),f.position.set(a.x,a.y,a.z),f.lookAt(a.x+_[z],a.y,a.z)):k===1?(f.up.set(0,0,g[z]),f.position.set(a.x,a.y,a.z),f.lookAt(a.x,a.y+_[z],a.z)):(f.up.set(0,g[z],0),f.position.set(a.x,a.y,a.z),f.lookAt(a.x,a.y,a.z+_[z]));const U=this._cubeSize;Pb(i,k*U,z>2?U:0,U,U),x.setRenderTarget(i),I&&x.render(L,f),x.render(t,f)}L.geometry.dispose(),L.material.dispose(),x.toneMapping=C,x.autoClear=M,t.background=T}_textureToCubeUV(t,n){const r=this._renderer,i=t.mapping===Dg||t.mapping===zg;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=pB()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=fB());const a=i?this._cubemapMaterial:this._equirectMaterial,c=new Ns(this._lodPlanes[0],a),o=a.uniforms;o.envMap.value=t;const f=this._cubeSize;Pb(n,0,0,3*f,2*f),r.setRenderTarget(n),r.render(c,cP)}_applyPMREM(t){const n=this._renderer,r=n.autoClear;n.autoClear=!1;const i=this._lodPlanes.length;for(let a=1;a<i;a++){const c=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),o=uB[(i-a-1)%uB.length];this._blur(t,a-1,a,c,o)}n.autoClear=r}_blur(t,n,r,i,a){const c=this._pingPongRenderTarget;this._halfBlur(t,c,n,r,i,"latitudinal",a),this._halfBlur(c,t,r,r,i,"longitudinal",a)}_halfBlur(t,n,r,i,a,c,o){const f=this._renderer,g=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const _=3,x=new Ns(this._lodPlanes[i],g),M=g.uniforms,C=this._sizeLods[r]-1,A=isFinite(a)?Math.PI/(2*C):2*Math.PI/(2*mf-1),L=a/A,I=isFinite(a)?1+Math.floor(_*L):mf;I>mf&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${I} samples when the maximum is set to ${mf}`);const T=[];let z=0;for(let q=0;q<mf;++q){const J=q/L,Y=Math.exp(-J*J/2);T.push(Y),q===0?z+=Y:q<I&&(z+=2*Y)}for(let q=0;q<T.length;q++)T[q]=T[q]/z;M.envMap.value=t.texture,M.samples.value=I,M.weights.value=T,M.latitudinal.value=c==="latitudinal",o&&(M.poleAxis.value=o);const{_lodMax:k}=this;M.dTheta.value=A,M.mipInt.value=k-r;const U=this._sizeLods[i],H=3*U*(i>k-Hm?i-k+Hm:0),V=4*(this._cubeSize-U);Pb(n,H,V,3*U,2*U),f.setRenderTarget(n),f.render(x,cP)}}function IEe(e){const t=[],n=[],r=[];let i=e;const a=e-Hm+1+lB.length;for(let c=0;c<a;c++){const o=Math.pow(2,i);n.push(o);let f=1/o;c>e-Hm?f=lB[c-e+Hm-1]:c===0&&(f=0),r.push(f);const g=1/(o-2),_=-g,x=1+g,M=[_,_,x,_,x,x,_,_,x,x,_,x],C=6,A=6,L=3,I=2,T=1,z=new Float32Array(L*A*C),k=new Float32Array(I*A*C),U=new Float32Array(T*A*C);for(let V=0;V<C;V++){const q=V%3*2/3-1,J=V>2?0:-1,Y=[q,J,0,q+2/3,J,0,q+2/3,J+1,0,q,J,0,q+2/3,J+1,0,q,J+1,0];z.set(Y,L*A*V),k.set(M,I*A*V);const N=[V,V,V,V,V,V];U.set(N,T*A*V)}const H=new Ec;H.setAttribute("position",new xc(z,L)),H.setAttribute("uv",new xc(k,I)),H.setAttribute("faceIndex",new xc(U,T)),t.push(H),i>Hm&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}function dB(e,t,n){const r=new Zh(e,t,n);return r.texture.mapping=p2,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Pb(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function REe(e,t,n){const r=new Float32Array(mf),i=new dt(0,1,0);return new vu({name:"SphericalGaussianBlur",defines:{n:mf,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:JL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:kh,depthTest:!1,depthWrite:!1})}function fB(){return new vu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:JL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:kh,depthTest:!1,depthWrite:!1})}function pB(){return new vu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:JL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:kh,depthTest:!1,depthWrite:!1})}function JL(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function LEe(e){let t=new WeakMap,n=null;function r(o){if(o&&o.isTexture){const f=o.mapping,g=f===hI||f===dI,_=f===Dg||f===zg;if(g||_){let x=t.get(o);const M=x!==void 0?x.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==M)return n===null&&(n=new hB(e)),x=g?n.fromEquirectangular(o,x):n.fromCubemap(o,x),x.texture.pmremVersion=o.pmremVersion,t.set(o,x),x.texture;if(x!==void 0)return x.texture;{const C=o.image;return g&&C&&C.height>0||_&&C&&i(C)?(n===null&&(n=new hB(e)),x=g?n.fromEquirectangular(o):n.fromCubemap(o),x.texture.pmremVersion=o.pmremVersion,t.set(o,x),o.addEventListener("dispose",a),x.texture):null}}}return o}function i(o){let f=0;const g=6;for(let _=0;_<g;_++)o[_]!==void 0&&f++;return f===g}function a(o){const f=o.target;f.removeEventListener("dispose",a);const g=t.get(f);g!==void 0&&(t.delete(f),g.dispose())}function c(){t=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:c}}function kEe(e){const t={};function n(r){if(t[r]!==void 0)return t[r];let i;switch(r){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(r)}return t[r]=i,i}return{has:function(r){return n(r)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(r){const i=n(r);return i===null&&bw("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function DEe(e,t,n,r){const i={},a=new WeakMap;function c(x){const M=x.target;M.index!==null&&t.remove(M.index);for(const A in M.attributes)t.remove(M.attributes[A]);M.removeEventListener("dispose",c),delete i[M.id];const C=a.get(M);C&&(t.remove(C),a.delete(M)),r.releaseStatesOfGeometry(M),M.isInstancedBufferGeometry===!0&&delete M._maxInstanceCount,n.memory.geometries--}function o(x,M){return i[M.id]===!0||(M.addEventListener("dispose",c),i[M.id]=!0,n.memory.geometries++),M}function f(x){const M=x.attributes;for(const C in M)t.update(M[C],e.ARRAY_BUFFER)}function g(x){const M=[],C=x.index,A=x.attributes.position;let L=0;if(C!==null){const z=C.array;L=C.version;for(let k=0,U=z.length;k<U;k+=3){const H=z[k+0],V=z[k+1],q=z[k+2];M.push(H,V,V,q,q,H)}}else if(A!==void 0){const z=A.array;L=A.version;for(let k=0,U=z.length/3-1;k<U;k+=3){const H=k+0,V=k+1,q=k+2;M.push(H,V,V,q,q,H)}}else return;const I=new(M7(M)?P7:T7)(M,1);I.version=L;const T=a.get(x);T&&t.remove(T),a.set(x,I)}function _(x){const M=a.get(x);if(M){const C=x.index;C!==null&&M.version<C.version&&g(x)}else g(x);return a.get(x)}return{get:o,update:f,getWireframeAttribute:_}}function zEe(e,t,n){let r;function i(M){r=M}let a,c;function o(M){a=M.type,c=M.bytesPerElement}function f(M,C){e.drawElements(r,C,a,M*c),n.update(C,r,1)}function g(M,C,A){A!==0&&(e.drawElementsInstanced(r,C,a,M*c,A),n.update(C,r,A))}function _(M,C,A){if(A===0)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,C,0,a,M,0,A);let I=0;for(let T=0;T<A;T++)I+=C[T];n.update(I,r,1)}function x(M,C,A,L){if(A===0)return;const I=t.get("WEBGL_multi_draw");if(I===null)for(let T=0;T<M.length;T++)g(M[T]/c,C[T],L[T]);else{I.multiDrawElementsInstancedWEBGL(r,C,0,a,M,0,L,0,A);let T=0;for(let z=0;z<A;z++)T+=C[z]*L[z];n.update(T,r,1)}}this.setMode=i,this.setIndex=o,this.render=f,this.renderInstances=g,this.renderMultiDraw=_,this.renderMultiDrawInstances=x}function OEe(e){const t={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(a,c,o){switch(n.calls++,c){case e.TRIANGLES:n.triangles+=o*(a/3);break;case e.LINES:n.lines+=o*(a/2);break;case e.LINE_STRIP:n.lines+=o*(a-1);break;case e.LINE_LOOP:n.lines+=o*a;break;case e.POINTS:n.points+=o*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function i(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:t,render:n,programs:null,autoReset:!0,reset:i,update:r}}function FEe(e,t,n){const r=new WeakMap,i=new Fi;function a(c,o,f){const g=c.morphTargetInfluences,_=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,x=_!==void 0?_.length:0;let M=r.get(o);if(M===void 0||M.count!==x){let N=function(){J.dispose(),r.delete(o),o.removeEventListener("dispose",N)};var C=N;M!==void 0&&M.texture.dispose();const A=o.morphAttributes.position!==void 0,L=o.morphAttributes.normal!==void 0,I=o.morphAttributes.color!==void 0,T=o.morphAttributes.position||[],z=o.morphAttributes.normal||[],k=o.morphAttributes.color||[];let U=0;A===!0&&(U=1),L===!0&&(U=2),I===!0&&(U=3);let H=o.attributes.position.count*U,V=1;H>t.maxTextureSize&&(V=Math.ceil(H/t.maxTextureSize),H=t.maxTextureSize);const q=new Float32Array(H*V*4*x),J=new C7(q,H,V,x);J.type=tu,J.needsUpdate=!0;const Y=U*4;for(let ne=0;ne<x;ne++){const ye=T[ne],ge=z[ne],Ne=k[ne],Ae=H*V*4*ne;for(let ve=0;ve<ye.count;ve++){const Se=ve*Y;A===!0&&(i.fromBufferAttribute(ye,ve),q[Ae+Se+0]=i.x,q[Ae+Se+1]=i.y,q[Ae+Se+2]=i.z,q[Ae+Se+3]=0),L===!0&&(i.fromBufferAttribute(ge,ve),q[Ae+Se+4]=i.x,q[Ae+Se+5]=i.y,q[Ae+Se+6]=i.z,q[Ae+Se+7]=0),I===!0&&(i.fromBufferAttribute(Ne,ve),q[Ae+Se+8]=i.x,q[Ae+Se+9]=i.y,q[Ae+Se+10]=i.z,q[Ae+Se+11]=Ne.itemSize===4?i.w:1)}}M={count:x,texture:J,size:new Dr(H,V)},r.set(o,M),o.addEventListener("dispose",N)}if(c.isInstancedMesh===!0&&c.morphTexture!==null)f.getUniforms().setValue(e,"morphTexture",c.morphTexture,n);else{let A=0;for(let I=0;I<g.length;I++)A+=g[I];const L=o.morphTargetsRelative?1:1-A;f.getUniforms().setValue(e,"morphTargetBaseInfluence",L),f.getUniforms().setValue(e,"morphTargetInfluences",g)}f.getUniforms().setValue(e,"morphTargetsTexture",M.texture,n),f.getUniforms().setValue(e,"morphTargetsTextureSize",M.size)}return{update:a}}function NEe(e,t,n,r){let i=new WeakMap;function a(f){const g=r.render.frame,_=f.geometry,x=t.get(f,_);if(i.get(x)!==g&&(t.update(x),i.set(x,g)),f.isInstancedMesh&&(f.hasEventListener("dispose",o)===!1&&f.addEventListener("dispose",o),i.get(f)!==g&&(n.update(f.instanceMatrix,e.ARRAY_BUFFER),f.instanceColor!==null&&n.update(f.instanceColor,e.ARRAY_BUFFER),i.set(f,g))),f.isSkinnedMesh){const M=f.skeleton;i.get(M)!==g&&(M.update(),i.set(M,g))}return x}function c(){i=new WeakMap}function o(f){const g=f.target;g.removeEventListener("dispose",o),n.remove(g.instanceMatrix),g.instanceColor!==null&&n.remove(g.instanceColor)}return{update:a,dispose:c}}const D7=new Ho,mB=new L7(1,1),z7=new C7,O7=new lMe,F7=new R7,gB=[],vB=[],yB=new Float32Array(16),_B=new Float32Array(9),xB=new Float32Array(4);function Jg(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let a=gB[i];if(a===void 0&&(a=new Float32Array(i),gB[i]=a),t!==0){r.toArray(a,0);for(let c=1,o=0;c!==t;++c)o+=n,e[c].toArray(a,o)}return a}function fo(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function po(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function g2(e,t){let n=vB[t];n===void 0&&(n=new Int32Array(t),vB[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function BEe(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function UEe(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(fo(n,t))return;e.uniform2fv(this.addr,t),po(n,t)}}function $Ee(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(t.r!==void 0)(n[0]!==t.r||n[1]!==t.g||n[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(fo(n,t))return;e.uniform3fv(this.addr,t),po(n,t)}}function VEe(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(fo(n,t))return;e.uniform4fv(this.addr,t),po(n,t)}}function jEe(e,t){const n=this.cache,r=t.elements;if(r===void 0){if(fo(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),po(n,t)}else{if(fo(n,r))return;xB.set(r),e.uniformMatrix2fv(this.addr,!1,xB),po(n,r)}}function HEe(e,t){const n=this.cache,r=t.elements;if(r===void 0){if(fo(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),po(n,t)}else{if(fo(n,r))return;_B.set(r),e.uniformMatrix3fv(this.addr,!1,_B),po(n,r)}}function GEe(e,t){const n=this.cache,r=t.elements;if(r===void 0){if(fo(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),po(n,t)}else{if(fo(n,r))return;yB.set(r),e.uniformMatrix4fv(this.addr,!1,yB),po(n,r)}}function WEe(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function qEe(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(fo(n,t))return;e.uniform2iv(this.addr,t),po(n,t)}}function XEe(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(fo(n,t))return;e.uniform3iv(this.addr,t),po(n,t)}}function ZEe(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(fo(n,t))return;e.uniform4iv(this.addr,t),po(n,t)}}function YEe(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function KEe(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(fo(n,t))return;e.uniform2uiv(this.addr,t),po(n,t)}}function JEe(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(fo(n,t))return;e.uniform3uiv(this.addr,t),po(n,t)}}function QEe(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(fo(n,t))return;e.uniform4uiv(this.addr,t),po(n,t)}}function eTe(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i);let a;this.type===e.SAMPLER_2D_SHADOW?(mB.compareFunction=S7,a=mB):a=D7,n.setTexture2D(t||a,i)}function tTe(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||O7,i)}function nTe(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||F7,i)}function rTe(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||z7,i)}function iTe(e){switch(e){case 5126:return BEe;case 35664:return UEe;case 35665:return $Ee;case 35666:return VEe;case 35674:return jEe;case 35675:return HEe;case 35676:return GEe;case 5124:case 35670:return WEe;case 35667:case 35671:return qEe;case 35668:case 35672:return XEe;case 35669:case 35673:return ZEe;case 5125:return YEe;case 36294:return KEe;case 36295:return JEe;case 36296:return QEe;case 35678:case 36198:case 36298:case 36306:case 35682:return eTe;case 35679:case 36299:case 36307:return tTe;case 35680:case 36300:case 36308:case 36293:return nTe;case 36289:case 36303:case 36311:case 36292:return rTe}}function oTe(e,t){e.uniform1fv(this.addr,t)}function sTe(e,t){const n=Jg(t,this.size,2);e.uniform2fv(this.addr,n)}function aTe(e,t){const n=Jg(t,this.size,3);e.uniform3fv(this.addr,n)}function lTe(e,t){const n=Jg(t,this.size,4);e.uniform4fv(this.addr,n)}function cTe(e,t){const n=Jg(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function uTe(e,t){const n=Jg(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function hTe(e,t){const n=Jg(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function dTe(e,t){e.uniform1iv(this.addr,t)}function fTe(e,t){e.uniform2iv(this.addr,t)}function pTe(e,t){e.uniform3iv(this.addr,t)}function mTe(e,t){e.uniform4iv(this.addr,t)}function gTe(e,t){e.uniform1uiv(this.addr,t)}function vTe(e,t){e.uniform2uiv(this.addr,t)}function yTe(e,t){e.uniform3uiv(this.addr,t)}function _Te(e,t){e.uniform4uiv(this.addr,t)}function xTe(e,t,n){const r=this.cache,i=t.length,a=g2(n,i);fo(r,a)||(e.uniform1iv(this.addr,a),po(r,a));for(let c=0;c!==i;++c)n.setTexture2D(t[c]||D7,a[c])}function bTe(e,t,n){const r=this.cache,i=t.length,a=g2(n,i);fo(r,a)||(e.uniform1iv(this.addr,a),po(r,a));for(let c=0;c!==i;++c)n.setTexture3D(t[c]||O7,a[c])}function wTe(e,t,n){const r=this.cache,i=t.length,a=g2(n,i);fo(r,a)||(e.uniform1iv(this.addr,a),po(r,a));for(let c=0;c!==i;++c)n.setTextureCube(t[c]||F7,a[c])}function STe(e,t,n){const r=this.cache,i=t.length,a=g2(n,i);fo(r,a)||(e.uniform1iv(this.addr,a),po(r,a));for(let c=0;c!==i;++c)n.setTexture2DArray(t[c]||z7,a[c])}function MTe(e){switch(e){case 5126:return oTe;case 35664:return sTe;case 35665:return aTe;case 35666:return lTe;case 35674:return cTe;case 35675:return uTe;case 35676:return hTe;case 5124:case 35670:return dTe;case 35667:case 35671:return fTe;case 35668:case 35672:return pTe;case 35669:case 35673:return mTe;case 5125:return gTe;case 36294:return vTe;case 36295:return yTe;case 36296:return _Te;case 35678:case 36198:case 36298:case 36306:case 35682:return xTe;case 35679:case 36299:case 36307:return bTe;case 35680:case 36300:case 36308:case 36293:return wTe;case 36289:case 36303:case 36311:case 36292:return STe}}class CTe{constructor(t,n,r){this.id=t,this.addr=r,this.cache=[],this.type=n.type,this.setValue=iTe(n.type)}}class ETe{constructor(t,n,r){this.id=t,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=MTe(n.type)}}class TTe{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,n,r){const i=this.seq;for(let a=0,c=i.length;a!==c;++a){const o=i[a];o.setValue(t,n[o.id],r)}}}const pP=/(\w+)(\])?(\[|\.)?/g;function bB(e,t){e.seq.push(t),e.map[t.id]=t}function PTe(e,t,n){const r=e.name,i=r.length;for(pP.lastIndex=0;;){const a=pP.exec(r),c=pP.lastIndex;let o=a[1];const f=a[2]==="]",g=a[3];if(f&&(o=o|0),g===void 0||g==="["&&c+2===i){bB(n,g===void 0?new CTe(o,e,t):new ETe(o,e,t));break}else{let x=n.map[o];x===void 0&&(x=new TTe(o),bB(n,x)),n=x}}}class ww{constructor(t,n){this.seq=[],this.map={};const r=t.getProgramParameter(n,t.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const a=t.getActiveUniform(n,i),c=t.getUniformLocation(n,a.name);PTe(a,c,this)}}setValue(t,n,r,i){const a=this.map[n];a!==void 0&&a.setValue(t,r,i)}setOptional(t,n,r){const i=n[r];i!==void 0&&this.setValue(t,r,i)}static upload(t,n,r,i){for(let a=0,c=n.length;a!==c;++a){const o=n[a],f=r[o.id];f.needsUpdate!==!1&&o.setValue(t,f.value,i)}}static seqWithValue(t,n){const r=[];for(let i=0,a=t.length;i!==a;++i){const c=t[i];c.id in n&&r.push(c)}return r}}function wB(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}const ATe=37297;let ITe=0;function RTe(e,t){const n=e.split(`
`),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let c=i;c<a;c++){const o=c+1;r.push(`${o===t?">":" "} ${o}: ${n[c]}`)}return r.join(`
`)}const SB=new sr;function LTe(e){Tr._getMatrix(SB,Tr.workingColorSpace,e);const t=`mat3( ${SB.elements.map(n=>n.toFixed(4))} )`;switch(Tr.getTransfer(e)){case CS:return[t,"LinearTransferOETF"];case qr:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}function MB(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&i==="")return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const c=parseInt(a[1]);return n.toUpperCase()+`

`+i+`

`+RTe(e.getShaderSource(t),c)}else return i}function kTe(e,t){const n=LTe(t);return[`vec4 ${e}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function DTe(e,t){let n;switch(t){case h7:n="Linear";break;case _Se:n="Reinhard";break;case xSe:n="Cineon";break;case bSe:n="ACESFilmic";break;case SSe:n="AgX";break;case MSe:n="Neutral";break;case wSe:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const Ab=new dt;function zTe(){Tr.getLuminanceCoefficients(Ab);const e=Ab.x.toFixed(4),t=Ab.y.toFixed(4),n=Ab.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${e}, ${t}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function OTe(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Q0).join(`
`)}function FTe(e){const t=[];for(const n in e){const r=e[n];r!==!1&&t.push("#define "+n+" "+r)}return t.join(`
`)}function NTe(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const a=e.getActiveAttrib(t,i),c=a.name;let o=1;a.type===e.FLOAT_MAT2&&(o=2),a.type===e.FLOAT_MAT3&&(o=3),a.type===e.FLOAT_MAT4&&(o=4),n[c]={type:a.type,location:e.getAttribLocation(t,c),locationSize:o}}return n}function Q0(e){return e!==""}function CB(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function EB(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const BTe=/^[ \t]*#include +<([\w\d./]+)>/gm;function jI(e){return e.replace(BTe,$Te)}const UTe=new Map;function $Te(e,t){let n=lr[t];if(n===void 0){const r=UTe.get(t);if(r!==void 0)n=lr[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,r);else throw new Error("Can not resolve #include <"+t+">")}return jI(n)}const VTe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function TB(e){return e.replace(VTe,jTe)}function jTe(e,t,n,r){let i="";for(let a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function PB(e){let t=`precision ${e.precision} float;
	precision ${e.precision} int;
	precision ${e.precision} sampler2D;
	precision ${e.precision} samplerCube;
	precision ${e.precision} sampler3D;
	precision ${e.precision} sampler2DArray;
	precision ${e.precision} sampler2DShadow;
	precision ${e.precision} samplerCubeShadow;
	precision ${e.precision} sampler2DArrayShadow;
	precision ${e.precision} isampler2D;
	precision ${e.precision} isampler3D;
	precision ${e.precision} isamplerCube;
	precision ${e.precision} isampler2DArray;
	precision ${e.precision} usampler2D;
	precision ${e.precision} usampler3D;
	precision ${e.precision} usamplerCube;
	precision ${e.precision} usampler2DArray;
	`;return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function HTe(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===c7?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===Jwe?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Xc&&(t="SHADOWMAP_TYPE_VSM"),t}function GTe(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Dg:case zg:t="ENVMAP_TYPE_CUBE";break;case p2:t="ENVMAP_TYPE_CUBE_UV";break}return t}function WTe(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case zg:t="ENVMAP_MODE_REFRACTION";break}return t}function qTe(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case u7:t="ENVMAP_BLENDING_MULTIPLY";break;case vSe:t="ENVMAP_BLENDING_MIX";break;case ySe:t="ENVMAP_BLENDING_ADD";break}return t}function XTe(e){const t=e.envMapCubeUVHeight;if(t===null)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:r,maxMip:n}}function ZTe(e,t,n,r){const i=e.getContext(),a=n.defines;let c=n.vertexShader,o=n.fragmentShader;const f=HTe(n),g=GTe(n),_=WTe(n),x=qTe(n),M=XTe(n),C=OTe(n),A=FTe(a),L=i.createProgram();let I,T,z=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(I=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A].filter(Q0).join(`
`),I.length>0&&(I+=`
`),T=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A].filter(Q0).join(`
`),T.length>0&&(T+=`
`)):(I=[PB(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+_:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Q0).join(`
`),T=[PB(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.envMap?"#define "+_:"",n.envMap?"#define "+x:"",M?"#define CUBEUV_TEXEL_WIDTH "+M.texelWidth:"",M?"#define CUBEUV_TEXEL_HEIGHT "+M.texelHeight:"",M?"#define CUBEUV_MAX_MIP "+M.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Dh?"#define TONE_MAPPING":"",n.toneMapping!==Dh?lr.tonemapping_pars_fragment:"",n.toneMapping!==Dh?DTe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",lr.colorspace_pars_fragment,kTe("linearToOutputTexel",n.outputColorSpace),zTe(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Q0).join(`
`)),c=jI(c),c=CB(c,n),c=EB(c,n),o=jI(o),o=CB(o,n),o=EB(o,n),c=TB(c),o=TB(o),n.isRawShaderMaterial!==!0&&(z=`#version 300 es
`,I=[C,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+I,T=["#define varying in",n.glslVersion===zN?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===zN?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);const k=z+I+c,U=z+T+o,H=wB(i,i.VERTEX_SHADER,k),V=wB(i,i.FRAGMENT_SHADER,U);i.attachShader(L,H),i.attachShader(L,V),n.index0AttributeName!==void 0?i.bindAttribLocation(L,0,n.index0AttributeName):n.morphTargets===!0&&i.bindAttribLocation(L,0,"position"),i.linkProgram(L);function q(ne){if(e.debug.checkShaderErrors){const ye=i.getProgramInfoLog(L).trim(),ge=i.getShaderInfoLog(H).trim(),Ne=i.getShaderInfoLog(V).trim();let Ae=!0,ve=!0;if(i.getProgramParameter(L,i.LINK_STATUS)===!1)if(Ae=!1,typeof e.debug.onShaderError=="function")e.debug.onShaderError(i,L,H,V);else{const Se=MB(i,H,"vertex"),Me=MB(i,V,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(L,i.VALIDATE_STATUS)+`

Material Name: `+ne.name+`
Material Type: `+ne.type+`

Program Info Log: `+ye+`
`+Se+`
`+Me)}else ye!==""?console.warn("THREE.WebGLProgram: Program Info Log:",ye):(ge===""||Ne==="")&&(ve=!1);ve&&(ne.diagnostics={runnable:Ae,programLog:ye,vertexShader:{log:ge,prefix:I},fragmentShader:{log:Ne,prefix:T}})}i.deleteShader(H),i.deleteShader(V),J=new ww(i,L),Y=NTe(i,L)}let J;this.getUniforms=function(){return J===void 0&&q(this),J};let Y;this.getAttributes=function(){return Y===void 0&&q(this),Y};let N=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return N===!1&&(N=i.getProgramParameter(L,ATe)),N},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(L),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=ITe++,this.cacheKey=t,this.usedTimes=1,this.program=L,this.vertexShader=H,this.fragmentShader=V,this}let YTe=0;class KTe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const n=t.vertexShader,r=t.fragmentShader,i=this._getShaderStage(n),a=this._getShaderStage(r),c=this._getShaderCacheForMaterial(t);return c.has(i)===!1&&(c.add(i),i.usedTimes++),c.has(a)===!1&&(c.add(a),a.usedTimes++),this}remove(t){const n=this.materialCache.get(t);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const n=this.materialCache;let r=n.get(t);return r===void 0&&(r=new Set,n.set(t,r)),r}_getShaderStage(t){const n=this.shaderCache;let r=n.get(t);return r===void 0&&(r=new JTe(t),n.set(t,r)),r}}class JTe{constructor(t){this.id=YTe++,this.code=t,this.usedTimes=0}}function QTe(e,t,n,r,i,a,c){const o=new ZL,f=new KTe,g=new Set,_=[],x=i.logarithmicDepthBuffer,M=i.vertexTextures;let C=i.precision;const A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function L(Y){return g.add(Y),Y===0?"uv":`uv${Y}`}function I(Y,N,ne,ye,ge){const Ne=ye.fog,Ae=ge.geometry,ve=Y.isMeshStandardMaterial?ye.environment:null,Se=(Y.isMeshStandardMaterial?n:t).get(Y.envMap||ve),Me=Se&&Se.mapping===p2?Se.image.height:null,Ue=A[Y.type];Y.precision!==null&&(C=i.getMaxPrecision(Y.precision),C!==Y.precision&&console.warn("THREE.WebGLProgram.getParameters:",Y.precision,"not supported, using",C,"instead."));const Qe=Ae.morphAttributes.position||Ae.morphAttributes.normal||Ae.morphAttributes.color,st=Qe!==void 0?Qe.length:0;let ct=0;Ae.morphAttributes.position!==void 0&&(ct=1),Ae.morphAttributes.normal!==void 0&&(ct=2),Ae.morphAttributes.color!==void 0&&(ct=3);let Xt,je,lt,Ot;if(Ue){const be=cc[Ue];Xt=be.vertexShader,je=be.fragmentShader}else Xt=Y.vertexShader,je=Y.fragmentShader,f.update(Y),lt=f.getVertexShaderID(Y),Ot=f.getFragmentShaderID(Y);const ut=e.getRenderTarget(),ot=e.state.buffers.depth.getReversed(),Tt=ge.isInstancedMesh===!0,Ct=ge.isBatchedMesh===!0,un=!!Y.map,gn=!!Y.matcap,hn=!!Se,We=!!Y.aoMap,vn=!!Y.lightMap,Ut=!!Y.bumpMap,tn=!!Y.normalMap,Dt=!!Y.displacementMap,An=!!Y.emissiveMap,an=!!Y.metalnessMap,Le=!!Y.roughnessMap,me=Y.anisotropy>0,it=Y.clearcoat>0,St=Y.dispersion>0,It=Y.iridescence>0,wt=Y.sheen>0,Zt=Y.transmission>0,Lt=me&&!!Y.anisotropyMap,kt=it&&!!Y.clearcoatMap,bn=it&&!!Y.clearcoatNormalMap,zt=it&&!!Y.clearcoatRoughnessMap,_e=It&&!!Y.iridescenceMap,te=It&&!!Y.iridescenceThicknessMap,re=wt&&!!Y.sheenColorMap,Z=wt&&!!Y.sheenRoughnessMap,le=!!Y.specularMap,Te=!!Y.specularColorMap,Ve=!!Y.specularIntensityMap,fe=Zt&&!!Y.transmissionMap,xe=Zt&&!!Y.thicknessMap,Re=!!Y.gradientMap,De=!!Y.alphaMap,ze=Y.alphaTest>0,Je=!!Y.alphaHash,Oe=!!Y.extensions;let Et=Dh;Y.toneMapped&&(ut===null||ut.isXRRenderTarget===!0)&&(Et=e.toneMapping);const Ft={shaderID:Ue,shaderType:Y.type,shaderName:Y.name,vertexShader:Xt,fragmentShader:je,defines:Y.defines,customVertexShaderID:lt,customFragmentShaderID:Ot,isRawShaderMaterial:Y.isRawShaderMaterial===!0,glslVersion:Y.glslVersion,precision:C,batching:Ct,batchingColor:Ct&&ge._colorsTexture!==null,instancing:Tt,instancingColor:Tt&&ge.instanceColor!==null,instancingMorph:Tt&&ge.morphTexture!==null,supportsVertexTextures:M,outputColorSpace:ut===null?e.outputColorSpace:ut.isXRRenderTarget===!0?ut.texture.colorSpace:Vf,alphaToCoverage:!!Y.alphaToCoverage,map:un,matcap:gn,envMap:hn,envMapMode:hn&&Se.mapping,envMapCubeUVHeight:Me,aoMap:We,lightMap:vn,bumpMap:Ut,normalMap:tn,displacementMap:M&&Dt,emissiveMap:An,normalMapObjectSpace:tn&&Y.normalMapType===ASe,normalMapTangentSpace:tn&&Y.normalMapType===PSe,metalnessMap:an,roughnessMap:Le,anisotropy:me,anisotropyMap:Lt,clearcoat:it,clearcoatMap:kt,clearcoatNormalMap:bn,clearcoatRoughnessMap:zt,dispersion:St,iridescence:It,iridescenceMap:_e,iridescenceThicknessMap:te,sheen:wt,sheenColorMap:re,sheenRoughnessMap:Z,specularMap:le,specularColorMap:Te,specularIntensityMap:Ve,transmission:Zt,transmissionMap:fe,thicknessMap:xe,gradientMap:Re,opaque:Y.transparent===!1&&Y.blending===cg&&Y.alphaToCoverage===!1,alphaMap:De,alphaTest:ze,alphaHash:Je,combine:Y.combine,mapUv:un&&L(Y.map.channel),aoMapUv:We&&L(Y.aoMap.channel),lightMapUv:vn&&L(Y.lightMap.channel),bumpMapUv:Ut&&L(Y.bumpMap.channel),normalMapUv:tn&&L(Y.normalMap.channel),displacementMapUv:Dt&&L(Y.displacementMap.channel),emissiveMapUv:An&&L(Y.emissiveMap.channel),metalnessMapUv:an&&L(Y.metalnessMap.channel),roughnessMapUv:Le&&L(Y.roughnessMap.channel),anisotropyMapUv:Lt&&L(Y.anisotropyMap.channel),clearcoatMapUv:kt&&L(Y.clearcoatMap.channel),clearcoatNormalMapUv:bn&&L(Y.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:zt&&L(Y.clearcoatRoughnessMap.channel),iridescenceMapUv:_e&&L(Y.iridescenceMap.channel),iridescenceThicknessMapUv:te&&L(Y.iridescenceThicknessMap.channel),sheenColorMapUv:re&&L(Y.sheenColorMap.channel),sheenRoughnessMapUv:Z&&L(Y.sheenRoughnessMap.channel),specularMapUv:le&&L(Y.specularMap.channel),specularColorMapUv:Te&&L(Y.specularColorMap.channel),specularIntensityMapUv:Ve&&L(Y.specularIntensityMap.channel),transmissionMapUv:fe&&L(Y.transmissionMap.channel),thicknessMapUv:xe&&L(Y.thicknessMap.channel),alphaMapUv:De&&L(Y.alphaMap.channel),vertexTangents:!!Ae.attributes.tangent&&(tn||me),vertexColors:Y.vertexColors,vertexAlphas:Y.vertexColors===!0&&!!Ae.attributes.color&&Ae.attributes.color.itemSize===4,pointsUvs:ge.isPoints===!0&&!!Ae.attributes.uv&&(un||De),fog:!!Ne,useFog:Y.fog===!0,fogExp2:!!Ne&&Ne.isFogExp2,flatShading:Y.flatShading===!0,sizeAttenuation:Y.sizeAttenuation===!0,logarithmicDepthBuffer:x,reverseDepthBuffer:ot,skinning:ge.isSkinnedMesh===!0,morphTargets:Ae.morphAttributes.position!==void 0,morphNormals:Ae.morphAttributes.normal!==void 0,morphColors:Ae.morphAttributes.color!==void 0,morphTargetsCount:st,morphTextureStride:ct,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numSpotLightMaps:N.spotLightMap.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numSpotLightShadowsWithMaps:N.numSpotLightShadowsWithMaps,numLightProbes:N.numLightProbes,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:Y.dithering,shadowMapEnabled:e.shadowMap.enabled&&ne.length>0,shadowMapType:e.shadowMap.type,toneMapping:Et,decodeVideoTexture:un&&Y.map.isVideoTexture===!0&&Tr.getTransfer(Y.map.colorSpace)===qr,decodeVideoTextureEmissive:An&&Y.emissiveMap.isVideoTexture===!0&&Tr.getTransfer(Y.emissiveMap.colorSpace)===qr,premultipliedAlpha:Y.premultipliedAlpha,doubleSided:Y.side===Jc,flipSided:Y.side===Hs,useDepthPacking:Y.depthPacking>=0,depthPacking:Y.depthPacking||0,index0AttributeName:Y.index0AttributeName,extensionClipCullDistance:Oe&&Y.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Oe&&Y.extensions.multiDraw===!0||Ct)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:Y.customProgramCacheKey()};return Ft.vertexUv1s=g.has(1),Ft.vertexUv2s=g.has(2),Ft.vertexUv3s=g.has(3),g.clear(),Ft}function T(Y){const N=[];if(Y.shaderID?N.push(Y.shaderID):(N.push(Y.customVertexShaderID),N.push(Y.customFragmentShaderID)),Y.defines!==void 0)for(const ne in Y.defines)N.push(ne),N.push(Y.defines[ne]);return Y.isRawShaderMaterial===!1&&(z(N,Y),k(N,Y),N.push(e.outputColorSpace)),N.push(Y.customProgramCacheKey),N.join()}function z(Y,N){Y.push(N.precision),Y.push(N.outputColorSpace),Y.push(N.envMapMode),Y.push(N.envMapCubeUVHeight),Y.push(N.mapUv),Y.push(N.alphaMapUv),Y.push(N.lightMapUv),Y.push(N.aoMapUv),Y.push(N.bumpMapUv),Y.push(N.normalMapUv),Y.push(N.displacementMapUv),Y.push(N.emissiveMapUv),Y.push(N.metalnessMapUv),Y.push(N.roughnessMapUv),Y.push(N.anisotropyMapUv),Y.push(N.clearcoatMapUv),Y.push(N.clearcoatNormalMapUv),Y.push(N.clearcoatRoughnessMapUv),Y.push(N.iridescenceMapUv),Y.push(N.iridescenceThicknessMapUv),Y.push(N.sheenColorMapUv),Y.push(N.sheenRoughnessMapUv),Y.push(N.specularMapUv),Y.push(N.specularColorMapUv),Y.push(N.specularIntensityMapUv),Y.push(N.transmissionMapUv),Y.push(N.thicknessMapUv),Y.push(N.combine),Y.push(N.fogExp2),Y.push(N.sizeAttenuation),Y.push(N.morphTargetsCount),Y.push(N.morphAttributeCount),Y.push(N.numDirLights),Y.push(N.numPointLights),Y.push(N.numSpotLights),Y.push(N.numSpotLightMaps),Y.push(N.numHemiLights),Y.push(N.numRectAreaLights),Y.push(N.numDirLightShadows),Y.push(N.numPointLightShadows),Y.push(N.numSpotLightShadows),Y.push(N.numSpotLightShadowsWithMaps),Y.push(N.numLightProbes),Y.push(N.shadowMapType),Y.push(N.toneMapping),Y.push(N.numClippingPlanes),Y.push(N.numClipIntersection),Y.push(N.depthPacking)}function k(Y,N){o.disableAll(),N.supportsVertexTextures&&o.enable(0),N.instancing&&o.enable(1),N.instancingColor&&o.enable(2),N.instancingMorph&&o.enable(3),N.matcap&&o.enable(4),N.envMap&&o.enable(5),N.normalMapObjectSpace&&o.enable(6),N.normalMapTangentSpace&&o.enable(7),N.clearcoat&&o.enable(8),N.iridescence&&o.enable(9),N.alphaTest&&o.enable(10),N.vertexColors&&o.enable(11),N.vertexAlphas&&o.enable(12),N.vertexUv1s&&o.enable(13),N.vertexUv2s&&o.enable(14),N.vertexUv3s&&o.enable(15),N.vertexTangents&&o.enable(16),N.anisotropy&&o.enable(17),N.alphaHash&&o.enable(18),N.batching&&o.enable(19),N.dispersion&&o.enable(20),N.batchingColor&&o.enable(21),Y.push(o.mask),o.disableAll(),N.fog&&o.enable(0),N.useFog&&o.enable(1),N.flatShading&&o.enable(2),N.logarithmicDepthBuffer&&o.enable(3),N.reverseDepthBuffer&&o.enable(4),N.skinning&&o.enable(5),N.morphTargets&&o.enable(6),N.morphNormals&&o.enable(7),N.morphColors&&o.enable(8),N.premultipliedAlpha&&o.enable(9),N.shadowMapEnabled&&o.enable(10),N.doubleSided&&o.enable(11),N.flipSided&&o.enable(12),N.useDepthPacking&&o.enable(13),N.dithering&&o.enable(14),N.transmission&&o.enable(15),N.sheen&&o.enable(16),N.opaque&&o.enable(17),N.pointsUvs&&o.enable(18),N.decodeVideoTexture&&o.enable(19),N.decodeVideoTextureEmissive&&o.enable(20),N.alphaToCoverage&&o.enable(21),Y.push(o.mask)}function U(Y){const N=A[Y.type];let ne;if(N){const ye=cc[N];ne=bMe.clone(ye.uniforms)}else ne=Y.uniforms;return ne}function H(Y,N){let ne;for(let ye=0,ge=_.length;ye<ge;ye++){const Ne=_[ye];if(Ne.cacheKey===N){ne=Ne,++ne.usedTimes;break}}return ne===void 0&&(ne=new ZTe(e,N,Y,a),_.push(ne)),ne}function V(Y){if(--Y.usedTimes===0){const N=_.indexOf(Y);_[N]=_[_.length-1],_.pop(),Y.destroy()}}function q(Y){f.remove(Y)}function J(){f.dispose()}return{getParameters:I,getProgramCacheKey:T,getUniforms:U,acquireProgram:H,releaseProgram:V,releaseShaderCache:q,programs:_,dispose:J}}function ePe(){let e=new WeakMap;function t(c){return e.has(c)}function n(c){let o=e.get(c);return o===void 0&&(o={},e.set(c,o)),o}function r(c){e.delete(c)}function i(c,o,f){e.get(c)[o]=f}function a(){e=new WeakMap}return{has:t,get:n,remove:r,update:i,dispose:a}}function tPe(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function AB(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function IB(){const e=[];let t=0;const n=[],r=[],i=[];function a(){t=0,n.length=0,r.length=0,i.length=0}function c(x,M,C,A,L,I){let T=e[t];return T===void 0?(T={id:x.id,object:x,geometry:M,material:C,groupOrder:A,renderOrder:x.renderOrder,z:L,group:I},e[t]=T):(T.id=x.id,T.object=x,T.geometry=M,T.material=C,T.groupOrder=A,T.renderOrder=x.renderOrder,T.z=L,T.group=I),t++,T}function o(x,M,C,A,L,I){const T=c(x,M,C,A,L,I);C.transmission>0?r.push(T):C.transparent===!0?i.push(T):n.push(T)}function f(x,M,C,A,L,I){const T=c(x,M,C,A,L,I);C.transmission>0?r.unshift(T):C.transparent===!0?i.unshift(T):n.unshift(T)}function g(x,M){n.length>1&&n.sort(x||tPe),r.length>1&&r.sort(M||AB),i.length>1&&i.sort(M||AB)}function _(){for(let x=t,M=e.length;x<M;x++){const C=e[x];if(C.id===null)break;C.id=null,C.object=null,C.geometry=null,C.material=null,C.group=null}}return{opaque:n,transmissive:r,transparent:i,init:a,push:o,unshift:f,finish:_,sort:g}}function nPe(){let e=new WeakMap;function t(r,i){const a=e.get(r);let c;return a===void 0?(c=new IB,e.set(r,[c])):i>=a.length?(c=new IB,a.push(c)):c=a[i],c}function n(){e=new WeakMap}return{get:t,dispose:n}}function rPe(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new dt,color:new Br};break;case"SpotLight":n={position:new dt,direction:new dt,color:new Br,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new dt,color:new Br,distance:0,decay:0};break;case"HemisphereLight":n={direction:new dt,skyColor:new Br,groundColor:new Br};break;case"RectAreaLight":n={color:new Br,position:new dt,halfWidth:new dt,halfHeight:new dt};break}return e[t.id]=n,n}}}function iPe(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let n;switch(t.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Dr};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Dr};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Dr,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=n,n}}}let oPe=0;function sPe(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function aPe(e){const t=new rPe,n=iPe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let g=0;g<9;g++)r.probe.push(new dt);const i=new dt,a=new jr,c=new jr;function o(g){let _=0,x=0,M=0;for(let Y=0;Y<9;Y++)r.probe[Y].set(0,0,0);let C=0,A=0,L=0,I=0,T=0,z=0,k=0,U=0,H=0,V=0,q=0;g.sort(sPe);for(let Y=0,N=g.length;Y<N;Y++){const ne=g[Y],ye=ne.color,ge=ne.intensity,Ne=ne.distance,Ae=ne.shadow&&ne.shadow.map?ne.shadow.map.texture:null;if(ne.isAmbientLight)_+=ye.r*ge,x+=ye.g*ge,M+=ye.b*ge;else if(ne.isLightProbe){for(let ve=0;ve<9;ve++)r.probe[ve].addScaledVector(ne.sh.coefficients[ve],ge);q++}else if(ne.isDirectionalLight){const ve=t.get(ne);if(ve.color.copy(ne.color).multiplyScalar(ne.intensity),ne.castShadow){const Se=ne.shadow,Me=n.get(ne);Me.shadowIntensity=Se.intensity,Me.shadowBias=Se.bias,Me.shadowNormalBias=Se.normalBias,Me.shadowRadius=Se.radius,Me.shadowMapSize=Se.mapSize,r.directionalShadow[C]=Me,r.directionalShadowMap[C]=Ae,r.directionalShadowMatrix[C]=ne.shadow.matrix,z++}r.directional[C]=ve,C++}else if(ne.isSpotLight){const ve=t.get(ne);ve.position.setFromMatrixPosition(ne.matrixWorld),ve.color.copy(ye).multiplyScalar(ge),ve.distance=Ne,ve.coneCos=Math.cos(ne.angle),ve.penumbraCos=Math.cos(ne.angle*(1-ne.penumbra)),ve.decay=ne.decay,r.spot[L]=ve;const Se=ne.shadow;if(ne.map&&(r.spotLightMap[H]=ne.map,H++,Se.updateMatrices(ne),ne.castShadow&&V++),r.spotLightMatrix[L]=Se.matrix,ne.castShadow){const Me=n.get(ne);Me.shadowIntensity=Se.intensity,Me.shadowBias=Se.bias,Me.shadowNormalBias=Se.normalBias,Me.shadowRadius=Se.radius,Me.shadowMapSize=Se.mapSize,r.spotShadow[L]=Me,r.spotShadowMap[L]=Ae,U++}L++}else if(ne.isRectAreaLight){const ve=t.get(ne);ve.color.copy(ye).multiplyScalar(ge),ve.halfWidth.set(ne.width*.5,0,0),ve.halfHeight.set(0,ne.height*.5,0),r.rectArea[I]=ve,I++}else if(ne.isPointLight){const ve=t.get(ne);if(ve.color.copy(ne.color).multiplyScalar(ne.intensity),ve.distance=ne.distance,ve.decay=ne.decay,ne.castShadow){const Se=ne.shadow,Me=n.get(ne);Me.shadowIntensity=Se.intensity,Me.shadowBias=Se.bias,Me.shadowNormalBias=Se.normalBias,Me.shadowRadius=Se.radius,Me.shadowMapSize=Se.mapSize,Me.shadowCameraNear=Se.camera.near,Me.shadowCameraFar=Se.camera.far,r.pointShadow[A]=Me,r.pointShadowMap[A]=Ae,r.pointShadowMatrix[A]=ne.shadow.matrix,k++}r.point[A]=ve,A++}else if(ne.isHemisphereLight){const ve=t.get(ne);ve.skyColor.copy(ne.color).multiplyScalar(ge),ve.groundColor.copy(ne.groundColor).multiplyScalar(ge),r.hemi[T]=ve,T++}}I>0&&(e.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Tn.LTC_FLOAT_1,r.rectAreaLTC2=Tn.LTC_FLOAT_2):(r.rectAreaLTC1=Tn.LTC_HALF_1,r.rectAreaLTC2=Tn.LTC_HALF_2)),r.ambient[0]=_,r.ambient[1]=x,r.ambient[2]=M;const J=r.hash;(J.directionalLength!==C||J.pointLength!==A||J.spotLength!==L||J.rectAreaLength!==I||J.hemiLength!==T||J.numDirectionalShadows!==z||J.numPointShadows!==k||J.numSpotShadows!==U||J.numSpotMaps!==H||J.numLightProbes!==q)&&(r.directional.length=C,r.spot.length=L,r.rectArea.length=I,r.point.length=A,r.hemi.length=T,r.directionalShadow.length=z,r.directionalShadowMap.length=z,r.pointShadow.length=k,r.pointShadowMap.length=k,r.spotShadow.length=U,r.spotShadowMap.length=U,r.directionalShadowMatrix.length=z,r.pointShadowMatrix.length=k,r.spotLightMatrix.length=U+H-V,r.spotLightMap.length=H,r.numSpotLightShadowsWithMaps=V,r.numLightProbes=q,J.directionalLength=C,J.pointLength=A,J.spotLength=L,J.rectAreaLength=I,J.hemiLength=T,J.numDirectionalShadows=z,J.numPointShadows=k,J.numSpotShadows=U,J.numSpotMaps=H,J.numLightProbes=q,r.version=oPe++)}function f(g,_){let x=0,M=0,C=0,A=0,L=0;const I=_.matrixWorldInverse;for(let T=0,z=g.length;T<z;T++){const k=g[T];if(k.isDirectionalLight){const U=r.directional[x];U.direction.setFromMatrixPosition(k.matrixWorld),i.setFromMatrixPosition(k.target.matrixWorld),U.direction.sub(i),U.direction.transformDirection(I),x++}else if(k.isSpotLight){const U=r.spot[C];U.position.setFromMatrixPosition(k.matrixWorld),U.position.applyMatrix4(I),U.direction.setFromMatrixPosition(k.matrixWorld),i.setFromMatrixPosition(k.target.matrixWorld),U.direction.sub(i),U.direction.transformDirection(I),C++}else if(k.isRectAreaLight){const U=r.rectArea[A];U.position.setFromMatrixPosition(k.matrixWorld),U.position.applyMatrix4(I),c.identity(),a.copy(k.matrixWorld),a.premultiply(I),c.extractRotation(a),U.halfWidth.set(k.width*.5,0,0),U.halfHeight.set(0,k.height*.5,0),U.halfWidth.applyMatrix4(c),U.halfHeight.applyMatrix4(c),A++}else if(k.isPointLight){const U=r.point[M];U.position.setFromMatrixPosition(k.matrixWorld),U.position.applyMatrix4(I),M++}else if(k.isHemisphereLight){const U=r.hemi[L];U.direction.setFromMatrixPosition(k.matrixWorld),U.direction.transformDirection(I),L++}}}return{setup:o,setupView:f,state:r}}function RB(e){const t=new aPe(e),n=[],r=[];function i(_){g.camera=_,n.length=0,r.length=0}function a(_){n.push(_)}function c(_){r.push(_)}function o(){t.setup(n)}function f(_){t.setupView(n,_)}const g={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:i,state:g,setupLights:o,setupLightsView:f,pushLight:a,pushShadow:c}}function lPe(e){let t=new WeakMap;function n(i,a=0){const c=t.get(i);let o;return c===void 0?(o=new RB(e),t.set(i,[o])):a>=c.length?(o=new RB(e),c.push(o)):o=c[a],o}function r(){t=new WeakMap}return{get:n,dispose:r}}const cPe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,uPe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function hPe(e,t,n){let r=new YL;const i=new Dr,a=new Dr,c=new Fi,o=new DMe({depthPacking:TSe}),f=new zMe,g={},_=n.maxTextureSize,x={[Xh]:Hs,[Hs]:Xh,[Jc]:Jc},M=new vu({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Dr},radius:{value:4}},vertexShader:cPe,fragmentShader:uPe}),C=M.clone();C.defines.HORIZONTAL_PASS=1;const A=new Ec;A.setAttribute("position",new xc(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const L=new Ns(A,M),I=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=c7;let T=this.type;this.render=function(V,q,J){if(I.enabled===!1||I.autoUpdate===!1&&I.needsUpdate===!1||V.length===0)return;const Y=e.getRenderTarget(),N=e.getActiveCubeFace(),ne=e.getActiveMipmapLevel(),ye=e.state;ye.setBlending(kh),ye.buffers.color.setClear(1,1,1,1),ye.buffers.depth.setTest(!0),ye.setScissorTest(!1);const ge=T!==Xc&&this.type===Xc,Ne=T===Xc&&this.type!==Xc;for(let Ae=0,ve=V.length;Ae<ve;Ae++){const Se=V[Ae],Me=Se.shadow;if(Me===void 0){console.warn("THREE.WebGLShadowMap:",Se,"has no shadow.");continue}if(Me.autoUpdate===!1&&Me.needsUpdate===!1)continue;i.copy(Me.mapSize);const Ue=Me.getFrameExtents();if(i.multiply(Ue),a.copy(Me.mapSize),(i.x>_||i.y>_)&&(i.x>_&&(a.x=Math.floor(_/Ue.x),i.x=a.x*Ue.x,Me.mapSize.x=a.x),i.y>_&&(a.y=Math.floor(_/Ue.y),i.y=a.y*Ue.y,Me.mapSize.y=a.y)),Me.map===null||ge===!0||Ne===!0){const st=this.type!==Xc?{minFilter:Ll,magFilter:Ll}:{};Me.map!==null&&Me.map.dispose(),Me.map=new Zh(i.x,i.y,st),Me.map.texture.name=Se.name+".shadowMap",Me.camera.updateProjectionMatrix()}e.setRenderTarget(Me.map),e.clear();const Qe=Me.getViewportCount();for(let st=0;st<Qe;st++){const ct=Me.getViewport(st);c.set(a.x*ct.x,a.y*ct.y,a.x*ct.z,a.y*ct.w),ye.viewport(c),Me.updateMatrices(Se,st),r=Me.getFrustum(),U(q,J,Me.camera,Se,this.type)}Me.isPointLightShadow!==!0&&this.type===Xc&&z(Me,J),Me.needsUpdate=!1}T=this.type,I.needsUpdate=!1,e.setRenderTarget(Y,N,ne)};function z(V,q){const J=t.update(L);M.defines.VSM_SAMPLES!==V.blurSamples&&(M.defines.VSM_SAMPLES=V.blurSamples,C.defines.VSM_SAMPLES=V.blurSamples,M.needsUpdate=!0,C.needsUpdate=!0),V.mapPass===null&&(V.mapPass=new Zh(i.x,i.y)),M.uniforms.shadow_pass.value=V.map.texture,M.uniforms.resolution.value=V.mapSize,M.uniforms.radius.value=V.radius,e.setRenderTarget(V.mapPass),e.clear(),e.renderBufferDirect(q,null,J,M,L,null),C.uniforms.shadow_pass.value=V.mapPass.texture,C.uniforms.resolution.value=V.mapSize,C.uniforms.radius.value=V.radius,e.setRenderTarget(V.map),e.clear(),e.renderBufferDirect(q,null,J,C,L,null)}function k(V,q,J,Y){let N=null;const ne=J.isPointLight===!0?V.customDistanceMaterial:V.customDepthMaterial;if(ne!==void 0)N=ne;else if(N=J.isPointLight===!0?f:o,e.localClippingEnabled&&q.clipShadows===!0&&Array.isArray(q.clippingPlanes)&&q.clippingPlanes.length!==0||q.displacementMap&&q.displacementScale!==0||q.alphaMap&&q.alphaTest>0||q.map&&q.alphaTest>0){const ye=N.uuid,ge=q.uuid;let Ne=g[ye];Ne===void 0&&(Ne={},g[ye]=Ne);let Ae=Ne[ge];Ae===void 0&&(Ae=N.clone(),Ne[ge]=Ae,q.addEventListener("dispose",H)),N=Ae}if(N.visible=q.visible,N.wireframe=q.wireframe,Y===Xc?N.side=q.shadowSide!==null?q.shadowSide:q.side:N.side=q.shadowSide!==null?q.shadowSide:x[q.side],N.alphaMap=q.alphaMap,N.alphaTest=q.alphaTest,N.map=q.map,N.clipShadows=q.clipShadows,N.clippingPlanes=q.clippingPlanes,N.clipIntersection=q.clipIntersection,N.displacementMap=q.displacementMap,N.displacementScale=q.displacementScale,N.displacementBias=q.displacementBias,N.wireframeLinewidth=q.wireframeLinewidth,N.linewidth=q.linewidth,J.isPointLight===!0&&N.isMeshDistanceMaterial===!0){const ye=e.properties.get(N);ye.light=J}return N}function U(V,q,J,Y,N){if(V.visible===!1)return;if(V.layers.test(q.layers)&&(V.isMesh||V.isLine||V.isPoints)&&(V.castShadow||V.receiveShadow&&N===Xc)&&(!V.frustumCulled||r.intersectsObject(V))){V.modelViewMatrix.multiplyMatrices(J.matrixWorldInverse,V.matrixWorld);const ge=t.update(V),Ne=V.material;if(Array.isArray(Ne)){const Ae=ge.groups;for(let ve=0,Se=Ae.length;ve<Se;ve++){const Me=Ae[ve],Ue=Ne[Me.materialIndex];if(Ue&&Ue.visible){const Qe=k(V,Ue,Y,N);V.onBeforeShadow(e,V,q,J,ge,Qe,Me),e.renderBufferDirect(J,null,ge,Qe,V,Me),V.onAfterShadow(e,V,q,J,ge,Qe,Me)}}}else if(Ne.visible){const Ae=k(V,Ne,Y,N);V.onBeforeShadow(e,V,q,J,ge,Ae,null),e.renderBufferDirect(J,null,ge,Ae,V,null),V.onAfterShadow(e,V,q,J,ge,Ae,null)}}const ye=V.children;for(let ge=0,Ne=ye.length;ge<Ne;ge++)U(ye[ge],q,J,Y,N)}function H(V){V.target.removeEventListener("dispose",H);for(const J in g){const Y=g[J],N=V.target.uuid;N in Y&&(Y[N].dispose(),delete Y[N])}}}const dPe={[iI]:oI,[sI]:cI,[aI]:uI,[kg]:lI,[oI]:iI,[cI]:sI,[uI]:aI,[lI]:kg};function fPe(e,t){function n(){let fe=!1;const xe=new Fi;let Re=null;const De=new Fi(0,0,0,0);return{setMask:function(ze){Re!==ze&&!fe&&(e.colorMask(ze,ze,ze,ze),Re=ze)},setLocked:function(ze){fe=ze},setClear:function(ze,Je,Oe,Et,Ft){Ft===!0&&(ze*=Et,Je*=Et,Oe*=Et),xe.set(ze,Je,Oe,Et),De.equals(xe)===!1&&(e.clearColor(ze,Je,Oe,Et),De.copy(xe))},reset:function(){fe=!1,Re=null,De.set(-1,0,0,0)}}}function r(){let fe=!1,xe=!1,Re=null,De=null,ze=null;return{setReversed:function(Je){if(xe!==Je){const Oe=t.get("EXT_clip_control");Je?Oe.clipControlEXT(Oe.LOWER_LEFT_EXT,Oe.ZERO_TO_ONE_EXT):Oe.clipControlEXT(Oe.LOWER_LEFT_EXT,Oe.NEGATIVE_ONE_TO_ONE_EXT),xe=Je;const Et=ze;ze=null,this.setClear(Et)}},getReversed:function(){return xe},setTest:function(Je){Je?ut(e.DEPTH_TEST):ot(e.DEPTH_TEST)},setMask:function(Je){Re!==Je&&!fe&&(e.depthMask(Je),Re=Je)},setFunc:function(Je){if(xe&&(Je=dPe[Je]),De!==Je){switch(Je){case iI:e.depthFunc(e.NEVER);break;case oI:e.depthFunc(e.ALWAYS);break;case sI:e.depthFunc(e.LESS);break;case kg:e.depthFunc(e.LEQUAL);break;case aI:e.depthFunc(e.EQUAL);break;case lI:e.depthFunc(e.GEQUAL);break;case cI:e.depthFunc(e.GREATER);break;case uI:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}De=Je}},setLocked:function(Je){fe=Je},setClear:function(Je){ze!==Je&&(xe&&(Je=1-Je),e.clearDepth(Je),ze=Je)},reset:function(){fe=!1,Re=null,De=null,ze=null,xe=!1}}}function i(){let fe=!1,xe=null,Re=null,De=null,ze=null,Je=null,Oe=null,Et=null,Ft=null;return{setTest:function(be){fe||(be?ut(e.STENCIL_TEST):ot(e.STENCIL_TEST))},setMask:function(be){xe!==be&&!fe&&(e.stencilMask(be),xe=be)},setFunc:function(be,qe,tt){(Re!==be||De!==qe||ze!==tt)&&(e.stencilFunc(be,qe,tt),Re=be,De=qe,ze=tt)},setOp:function(be,qe,tt){(Je!==be||Oe!==qe||Et!==tt)&&(e.stencilOp(be,qe,tt),Je=be,Oe=qe,Et=tt)},setLocked:function(be){fe=be},setClear:function(be){Ft!==be&&(e.clearStencil(be),Ft=be)},reset:function(){fe=!1,xe=null,Re=null,De=null,ze=null,Je=null,Oe=null,Et=null,Ft=null}}}const a=new n,c=new r,o=new i,f=new WeakMap,g=new WeakMap;let _={},x={},M=new WeakMap,C=[],A=null,L=!1,I=null,T=null,z=null,k=null,U=null,H=null,V=null,q=new Br(0,0,0),J=0,Y=!1,N=null,ne=null,ye=null,ge=null,Ne=null;const Ae=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ve=!1,Se=0;const Me=e.getParameter(e.VERSION);Me.indexOf("WebGL")!==-1?(Se=parseFloat(/^WebGL (\d)/.exec(Me)[1]),ve=Se>=1):Me.indexOf("OpenGL ES")!==-1&&(Se=parseFloat(/^OpenGL ES (\d)/.exec(Me)[1]),ve=Se>=2);let Ue=null,Qe={};const st=e.getParameter(e.SCISSOR_BOX),ct=e.getParameter(e.VIEWPORT),Xt=new Fi().fromArray(st),je=new Fi().fromArray(ct);function lt(fe,xe,Re,De){const ze=new Uint8Array(4),Je=e.createTexture();e.bindTexture(fe,Je),e.texParameteri(fe,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(fe,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let Oe=0;Oe<Re;Oe++)fe===e.TEXTURE_3D||fe===e.TEXTURE_2D_ARRAY?e.texImage3D(xe,0,e.RGBA,1,1,De,0,e.RGBA,e.UNSIGNED_BYTE,ze):e.texImage2D(xe+Oe,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,ze);return Je}const Ot={};Ot[e.TEXTURE_2D]=lt(e.TEXTURE_2D,e.TEXTURE_2D,1),Ot[e.TEXTURE_CUBE_MAP]=lt(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ot[e.TEXTURE_2D_ARRAY]=lt(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),Ot[e.TEXTURE_3D]=lt(e.TEXTURE_3D,e.TEXTURE_3D,1,1),a.setClear(0,0,0,1),c.setClear(1),o.setClear(0),ut(e.DEPTH_TEST),c.setFunc(kg),Ut(!1),tn(AN),ut(e.CULL_FACE),We(kh);function ut(fe){_[fe]!==!0&&(e.enable(fe),_[fe]=!0)}function ot(fe){_[fe]!==!1&&(e.disable(fe),_[fe]=!1)}function Tt(fe,xe){return x[fe]!==xe?(e.bindFramebuffer(fe,xe),x[fe]=xe,fe===e.DRAW_FRAMEBUFFER&&(x[e.FRAMEBUFFER]=xe),fe===e.FRAMEBUFFER&&(x[e.DRAW_FRAMEBUFFER]=xe),!0):!1}function Ct(fe,xe){let Re=C,De=!1;if(fe){Re=M.get(xe),Re===void 0&&(Re=[],M.set(xe,Re));const ze=fe.textures;if(Re.length!==ze.length||Re[0]!==e.COLOR_ATTACHMENT0){for(let Je=0,Oe=ze.length;Je<Oe;Je++)Re[Je]=e.COLOR_ATTACHMENT0+Je;Re.length=ze.length,De=!0}}else Re[0]!==e.BACK&&(Re[0]=e.BACK,De=!0);De&&e.drawBuffers(Re)}function un(fe){return A!==fe?(e.useProgram(fe),A=fe,!0):!1}const gn={[pf]:e.FUNC_ADD,[eSe]:e.FUNC_SUBTRACT,[tSe]:e.FUNC_REVERSE_SUBTRACT};gn[nSe]=e.MIN,gn[rSe]=e.MAX;const hn={[iSe]:e.ZERO,[oSe]:e.ONE,[sSe]:e.SRC_COLOR,[nI]:e.SRC_ALPHA,[dSe]:e.SRC_ALPHA_SATURATE,[uSe]:e.DST_COLOR,[lSe]:e.DST_ALPHA,[aSe]:e.ONE_MINUS_SRC_COLOR,[rI]:e.ONE_MINUS_SRC_ALPHA,[hSe]:e.ONE_MINUS_DST_COLOR,[cSe]:e.ONE_MINUS_DST_ALPHA,[fSe]:e.CONSTANT_COLOR,[pSe]:e.ONE_MINUS_CONSTANT_COLOR,[mSe]:e.CONSTANT_ALPHA,[gSe]:e.ONE_MINUS_CONSTANT_ALPHA};function We(fe,xe,Re,De,ze,Je,Oe,Et,Ft,be){if(fe===kh){L===!0&&(ot(e.BLEND),L=!1);return}if(L===!1&&(ut(e.BLEND),L=!0),fe!==Qwe){if(fe!==I||be!==Y){if((T!==pf||U!==pf)&&(e.blendEquation(e.FUNC_ADD),T=pf,U=pf),be)switch(fe){case cg:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case IN:e.blendFunc(e.ONE,e.ONE);break;case RN:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case LN:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe);break}else switch(fe){case cg:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case IN:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case RN:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case LN:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe);break}z=null,k=null,H=null,V=null,q.set(0,0,0),J=0,I=fe,Y=be}return}ze=ze||xe,Je=Je||Re,Oe=Oe||De,(xe!==T||ze!==U)&&(e.blendEquationSeparate(gn[xe],gn[ze]),T=xe,U=ze),(Re!==z||De!==k||Je!==H||Oe!==V)&&(e.blendFuncSeparate(hn[Re],hn[De],hn[Je],hn[Oe]),z=Re,k=De,H=Je,V=Oe),(Et.equals(q)===!1||Ft!==J)&&(e.blendColor(Et.r,Et.g,Et.b,Ft),q.copy(Et),J=Ft),I=fe,Y=!1}function vn(fe,xe){fe.side===Jc?ot(e.CULL_FACE):ut(e.CULL_FACE);let Re=fe.side===Hs;xe&&(Re=!Re),Ut(Re),fe.blending===cg&&fe.transparent===!1?We(kh):We(fe.blending,fe.blendEquation,fe.blendSrc,fe.blendDst,fe.blendEquationAlpha,fe.blendSrcAlpha,fe.blendDstAlpha,fe.blendColor,fe.blendAlpha,fe.premultipliedAlpha),c.setFunc(fe.depthFunc),c.setTest(fe.depthTest),c.setMask(fe.depthWrite),a.setMask(fe.colorWrite);const De=fe.stencilWrite;o.setTest(De),De&&(o.setMask(fe.stencilWriteMask),o.setFunc(fe.stencilFunc,fe.stencilRef,fe.stencilFuncMask),o.setOp(fe.stencilFail,fe.stencilZFail,fe.stencilZPass)),An(fe.polygonOffset,fe.polygonOffsetFactor,fe.polygonOffsetUnits),fe.alphaToCoverage===!0?ut(e.SAMPLE_ALPHA_TO_COVERAGE):ot(e.SAMPLE_ALPHA_TO_COVERAGE)}function Ut(fe){N!==fe&&(fe?e.frontFace(e.CW):e.frontFace(e.CCW),N=fe)}function tn(fe){fe!==Ywe?(ut(e.CULL_FACE),fe!==ne&&(fe===AN?e.cullFace(e.BACK):fe===Kwe?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):ot(e.CULL_FACE),ne=fe}function Dt(fe){fe!==ye&&(ve&&e.lineWidth(fe),ye=fe)}function An(fe,xe,Re){fe?(ut(e.POLYGON_OFFSET_FILL),(ge!==xe||Ne!==Re)&&(e.polygonOffset(xe,Re),ge=xe,Ne=Re)):ot(e.POLYGON_OFFSET_FILL)}function an(fe){fe?ut(e.SCISSOR_TEST):ot(e.SCISSOR_TEST)}function Le(fe){fe===void 0&&(fe=e.TEXTURE0+Ae-1),Ue!==fe&&(e.activeTexture(fe),Ue=fe)}function me(fe,xe,Re){Re===void 0&&(Ue===null?Re=e.TEXTURE0+Ae-1:Re=Ue);let De=Qe[Re];De===void 0&&(De={type:void 0,texture:void 0},Qe[Re]=De),(De.type!==fe||De.texture!==xe)&&(Ue!==Re&&(e.activeTexture(Re),Ue=Re),e.bindTexture(fe,xe||Ot[fe]),De.type=fe,De.texture=xe)}function it(){const fe=Qe[Ue];fe!==void 0&&fe.type!==void 0&&(e.bindTexture(fe.type,null),fe.type=void 0,fe.texture=void 0)}function St(){try{e.compressedTexImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function It(){try{e.compressedTexImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function wt(){try{e.texSubImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Zt(){try{e.texSubImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Lt(){try{e.compressedTexSubImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function kt(){try{e.compressedTexSubImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function bn(){try{e.texStorage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function zt(){try{e.texStorage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function _e(){try{e.texImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function te(){try{e.texImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function re(fe){Xt.equals(fe)===!1&&(e.scissor(fe.x,fe.y,fe.z,fe.w),Xt.copy(fe))}function Z(fe){je.equals(fe)===!1&&(e.viewport(fe.x,fe.y,fe.z,fe.w),je.copy(fe))}function le(fe,xe){let Re=g.get(xe);Re===void 0&&(Re=new WeakMap,g.set(xe,Re));let De=Re.get(fe);De===void 0&&(De=e.getUniformBlockIndex(xe,fe.name),Re.set(fe,De))}function Te(fe,xe){const De=g.get(xe).get(fe);f.get(xe)!==De&&(e.uniformBlockBinding(xe,De,fe.__bindingPointIndex),f.set(xe,De))}function Ve(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),c.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),_={},Ue=null,Qe={},x={},M=new WeakMap,C=[],A=null,L=!1,I=null,T=null,z=null,k=null,U=null,H=null,V=null,q=new Br(0,0,0),J=0,Y=!1,N=null,ne=null,ye=null,ge=null,Ne=null,Xt.set(0,0,e.canvas.width,e.canvas.height),je.set(0,0,e.canvas.width,e.canvas.height),a.reset(),c.reset(),o.reset()}return{buffers:{color:a,depth:c,stencil:o},enable:ut,disable:ot,bindFramebuffer:Tt,drawBuffers:Ct,useProgram:un,setBlending:We,setMaterial:vn,setFlipSided:Ut,setCullFace:tn,setLineWidth:Dt,setPolygonOffset:An,setScissorTest:an,activeTexture:Le,bindTexture:me,unbindTexture:it,compressedTexImage2D:St,compressedTexImage3D:It,texImage2D:_e,texImage3D:te,updateUBOMapping:le,uniformBlockBinding:Te,texStorage2D:bn,texStorage3D:zt,texSubImage2D:wt,texSubImage3D:Zt,compressedTexSubImage2D:Lt,compressedTexSubImage3D:kt,scissor:re,viewport:Z,reset:Ve}}function pPe(e,t,n,r,i,a,c){const o=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),g=new Dr,_=new WeakMap;let x;const M=new WeakMap;let C=!1;try{C=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function A(Le,me){return C?new OffscreenCanvas(Le,me):TS("canvas")}function L(Le,me,it){let St=1;const It=an(Le);if((It.width>it||It.height>it)&&(St=it/Math.max(It.width,It.height)),St<1)if(typeof HTMLImageElement<"u"&&Le instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Le instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Le instanceof ImageBitmap||typeof VideoFrame<"u"&&Le instanceof VideoFrame){const wt=Math.floor(St*It.width),Zt=Math.floor(St*It.height);x===void 0&&(x=A(wt,Zt));const Lt=me?A(wt,Zt):x;return Lt.width=wt,Lt.height=Zt,Lt.getContext("2d").drawImage(Le,0,0,wt,Zt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+It.width+"x"+It.height+") to ("+wt+"x"+Zt+")."),Lt}else return"data"in Le&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+It.width+"x"+It.height+")."),Le;return Le}function I(Le){return Le.generateMipmaps}function T(Le){e.generateMipmap(Le)}function z(Le){return Le.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:Le.isWebGL3DRenderTarget?e.TEXTURE_3D:Le.isWebGLArrayRenderTarget||Le.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function k(Le,me,it,St,It=!1){if(Le!==null){if(e[Le]!==void 0)return e[Le];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Le+"'")}let wt=me;if(me===e.RED&&(it===e.FLOAT&&(wt=e.R32F),it===e.HALF_FLOAT&&(wt=e.R16F),it===e.UNSIGNED_BYTE&&(wt=e.R8)),me===e.RED_INTEGER&&(it===e.UNSIGNED_BYTE&&(wt=e.R8UI),it===e.UNSIGNED_SHORT&&(wt=e.R16UI),it===e.UNSIGNED_INT&&(wt=e.R32UI),it===e.BYTE&&(wt=e.R8I),it===e.SHORT&&(wt=e.R16I),it===e.INT&&(wt=e.R32I)),me===e.RG&&(it===e.FLOAT&&(wt=e.RG32F),it===e.HALF_FLOAT&&(wt=e.RG16F),it===e.UNSIGNED_BYTE&&(wt=e.RG8)),me===e.RG_INTEGER&&(it===e.UNSIGNED_BYTE&&(wt=e.RG8UI),it===e.UNSIGNED_SHORT&&(wt=e.RG16UI),it===e.UNSIGNED_INT&&(wt=e.RG32UI),it===e.BYTE&&(wt=e.RG8I),it===e.SHORT&&(wt=e.RG16I),it===e.INT&&(wt=e.RG32I)),me===e.RGB_INTEGER&&(it===e.UNSIGNED_BYTE&&(wt=e.RGB8UI),it===e.UNSIGNED_SHORT&&(wt=e.RGB16UI),it===e.UNSIGNED_INT&&(wt=e.RGB32UI),it===e.BYTE&&(wt=e.RGB8I),it===e.SHORT&&(wt=e.RGB16I),it===e.INT&&(wt=e.RGB32I)),me===e.RGBA_INTEGER&&(it===e.UNSIGNED_BYTE&&(wt=e.RGBA8UI),it===e.UNSIGNED_SHORT&&(wt=e.RGBA16UI),it===e.UNSIGNED_INT&&(wt=e.RGBA32UI),it===e.BYTE&&(wt=e.RGBA8I),it===e.SHORT&&(wt=e.RGBA16I),it===e.INT&&(wt=e.RGBA32I)),me===e.RGB&&it===e.UNSIGNED_INT_5_9_9_9_REV&&(wt=e.RGB9_E5),me===e.RGBA){const Zt=It?CS:Tr.getTransfer(St);it===e.FLOAT&&(wt=e.RGBA32F),it===e.HALF_FLOAT&&(wt=e.RGBA16F),it===e.UNSIGNED_BYTE&&(wt=Zt===qr?e.SRGB8_ALPHA8:e.RGBA8),it===e.UNSIGNED_SHORT_4_4_4_4&&(wt=e.RGBA4),it===e.UNSIGNED_SHORT_5_5_5_1&&(wt=e.RGB5_A1)}return(wt===e.R16F||wt===e.R32F||wt===e.RG16F||wt===e.RG32F||wt===e.RGBA16F||wt===e.RGBA32F)&&t.get("EXT_color_buffer_float"),wt}function U(Le,me){let it;return Le?me===null||me===$f||me===y_?it=e.DEPTH24_STENCIL8:me===tu?it=e.DEPTH32F_STENCIL8:me===v_&&(it=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):me===null||me===$f||me===y_?it=e.DEPTH_COMPONENT24:me===tu?it=e.DEPTH_COMPONENT32F:me===v_&&(it=e.DEPTH_COMPONENT16),it}function H(Le,me){return I(Le)===!0||Le.isFramebufferTexture&&Le.minFilter!==Ll&&Le.minFilter!==_a?Math.log2(Math.max(me.width,me.height))+1:Le.mipmaps!==void 0&&Le.mipmaps.length>0?Le.mipmaps.length:Le.isCompressedTexture&&Array.isArray(Le.image)?me.mipmaps.length:1}function V(Le){const me=Le.target;me.removeEventListener("dispose",V),J(me),me.isVideoTexture&&_.delete(me)}function q(Le){const me=Le.target;me.removeEventListener("dispose",q),N(me)}function J(Le){const me=r.get(Le);if(me.__webglInit===void 0)return;const it=Le.source,St=M.get(it);if(St){const It=St[me.__cacheKey];It.usedTimes--,It.usedTimes===0&&Y(Le),Object.keys(St).length===0&&M.delete(it)}r.remove(Le)}function Y(Le){const me=r.get(Le);e.deleteTexture(me.__webglTexture);const it=Le.source,St=M.get(it);delete St[me.__cacheKey],c.memory.textures--}function N(Le){const me=r.get(Le);if(Le.depthTexture&&(Le.depthTexture.dispose(),r.remove(Le.depthTexture)),Le.isWebGLCubeRenderTarget)for(let St=0;St<6;St++){if(Array.isArray(me.__webglFramebuffer[St]))for(let It=0;It<me.__webglFramebuffer[St].length;It++)e.deleteFramebuffer(me.__webglFramebuffer[St][It]);else e.deleteFramebuffer(me.__webglFramebuffer[St]);me.__webglDepthbuffer&&e.deleteRenderbuffer(me.__webglDepthbuffer[St])}else{if(Array.isArray(me.__webglFramebuffer))for(let St=0;St<me.__webglFramebuffer.length;St++)e.deleteFramebuffer(me.__webglFramebuffer[St]);else e.deleteFramebuffer(me.__webglFramebuffer);if(me.__webglDepthbuffer&&e.deleteRenderbuffer(me.__webglDepthbuffer),me.__webglMultisampledFramebuffer&&e.deleteFramebuffer(me.__webglMultisampledFramebuffer),me.__webglColorRenderbuffer)for(let St=0;St<me.__webglColorRenderbuffer.length;St++)me.__webglColorRenderbuffer[St]&&e.deleteRenderbuffer(me.__webglColorRenderbuffer[St]);me.__webglDepthRenderbuffer&&e.deleteRenderbuffer(me.__webglDepthRenderbuffer)}const it=Le.textures;for(let St=0,It=it.length;St<It;St++){const wt=r.get(it[St]);wt.__webglTexture&&(e.deleteTexture(wt.__webglTexture),c.memory.textures--),r.remove(it[St])}r.remove(Le)}let ne=0;function ye(){ne=0}function ge(){const Le=ne;return Le>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Le+" texture units while this GPU supports only "+i.maxTextures),ne+=1,Le}function Ne(Le){const me=[];return me.push(Le.wrapS),me.push(Le.wrapT),me.push(Le.wrapR||0),me.push(Le.magFilter),me.push(Le.minFilter),me.push(Le.anisotropy),me.push(Le.internalFormat),me.push(Le.format),me.push(Le.type),me.push(Le.generateMipmaps),me.push(Le.premultiplyAlpha),me.push(Le.flipY),me.push(Le.unpackAlignment),me.push(Le.colorSpace),me.join()}function Ae(Le,me){const it=r.get(Le);if(Le.isVideoTexture&&Dt(Le),Le.isRenderTargetTexture===!1&&Le.version>0&&it.__version!==Le.version){const St=Le.image;if(St===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(St.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{je(it,Le,me);return}}n.bindTexture(e.TEXTURE_2D,it.__webglTexture,e.TEXTURE0+me)}function ve(Le,me){const it=r.get(Le);if(Le.version>0&&it.__version!==Le.version){je(it,Le,me);return}n.bindTexture(e.TEXTURE_2D_ARRAY,it.__webglTexture,e.TEXTURE0+me)}function Se(Le,me){const it=r.get(Le);if(Le.version>0&&it.__version!==Le.version){je(it,Le,me);return}n.bindTexture(e.TEXTURE_3D,it.__webglTexture,e.TEXTURE0+me)}function Me(Le,me){const it=r.get(Le);if(Le.version>0&&it.__version!==Le.version){lt(it,Le,me);return}n.bindTexture(e.TEXTURE_CUBE_MAP,it.__webglTexture,e.TEXTURE0+me)}const Ue={[fI]:e.REPEAT,[wf]:e.CLAMP_TO_EDGE,[pI]:e.MIRRORED_REPEAT},Qe={[Ll]:e.NEAREST,[CSe]:e.NEAREST_MIPMAP_NEAREST,[ab]:e.NEAREST_MIPMAP_LINEAR,[_a]:e.LINEAR,[UT]:e.LINEAR_MIPMAP_NEAREST,[wh]:e.LINEAR_MIPMAP_LINEAR},st={[ISe]:e.NEVER,[OSe]:e.ALWAYS,[RSe]:e.LESS,[S7]:e.LEQUAL,[LSe]:e.EQUAL,[zSe]:e.GEQUAL,[kSe]:e.GREATER,[DSe]:e.NOTEQUAL};function ct(Le,me){if(me.type===tu&&t.has("OES_texture_float_linear")===!1&&(me.magFilter===_a||me.magFilter===UT||me.magFilter===ab||me.magFilter===wh||me.minFilter===_a||me.minFilter===UT||me.minFilter===ab||me.minFilter===wh)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(Le,e.TEXTURE_WRAP_S,Ue[me.wrapS]),e.texParameteri(Le,e.TEXTURE_WRAP_T,Ue[me.wrapT]),(Le===e.TEXTURE_3D||Le===e.TEXTURE_2D_ARRAY)&&e.texParameteri(Le,e.TEXTURE_WRAP_R,Ue[me.wrapR]),e.texParameteri(Le,e.TEXTURE_MAG_FILTER,Qe[me.magFilter]),e.texParameteri(Le,e.TEXTURE_MIN_FILTER,Qe[me.minFilter]),me.compareFunction&&(e.texParameteri(Le,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(Le,e.TEXTURE_COMPARE_FUNC,st[me.compareFunction])),t.has("EXT_texture_filter_anisotropic")===!0){if(me.magFilter===Ll||me.minFilter!==ab&&me.minFilter!==wh||me.type===tu&&t.has("OES_texture_float_linear")===!1)return;if(me.anisotropy>1||r.get(me).__currentAnisotropy){const it=t.get("EXT_texture_filter_anisotropic");e.texParameterf(Le,it.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(me.anisotropy,i.getMaxAnisotropy())),r.get(me).__currentAnisotropy=me.anisotropy}}}function Xt(Le,me){let it=!1;Le.__webglInit===void 0&&(Le.__webglInit=!0,me.addEventListener("dispose",V));const St=me.source;let It=M.get(St);It===void 0&&(It={},M.set(St,It));const wt=Ne(me);if(wt!==Le.__cacheKey){It[wt]===void 0&&(It[wt]={texture:e.createTexture(),usedTimes:0},c.memory.textures++,it=!0),It[wt].usedTimes++;const Zt=It[Le.__cacheKey];Zt!==void 0&&(It[Le.__cacheKey].usedTimes--,Zt.usedTimes===0&&Y(me)),Le.__cacheKey=wt,Le.__webglTexture=It[wt].texture}return it}function je(Le,me,it){let St=e.TEXTURE_2D;(me.isDataArrayTexture||me.isCompressedArrayTexture)&&(St=e.TEXTURE_2D_ARRAY),me.isData3DTexture&&(St=e.TEXTURE_3D);const It=Xt(Le,me),wt=me.source;n.bindTexture(St,Le.__webglTexture,e.TEXTURE0+it);const Zt=r.get(wt);if(wt.version!==Zt.__version||It===!0){n.activeTexture(e.TEXTURE0+it);const Lt=Tr.getPrimaries(Tr.workingColorSpace),kt=me.colorSpace===yh?null:Tr.getPrimaries(me.colorSpace),bn=me.colorSpace===yh||Lt===kt?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,me.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,me.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,me.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,bn);let zt=L(me.image,!1,i.maxTextureSize);zt=An(me,zt);const _e=a.convert(me.format,me.colorSpace),te=a.convert(me.type);let re=k(me.internalFormat,_e,te,me.colorSpace,me.isVideoTexture);ct(St,me);let Z;const le=me.mipmaps,Te=me.isVideoTexture!==!0,Ve=Zt.__version===void 0||It===!0,fe=wt.dataReady,xe=H(me,zt);if(me.isDepthTexture)re=U(me.format===x_,me.type),Ve&&(Te?n.texStorage2D(e.TEXTURE_2D,1,re,zt.width,zt.height):n.texImage2D(e.TEXTURE_2D,0,re,zt.width,zt.height,0,_e,te,null));else if(me.isDataTexture)if(le.length>0){Te&&Ve&&n.texStorage2D(e.TEXTURE_2D,xe,re,le[0].width,le[0].height);for(let Re=0,De=le.length;Re<De;Re++)Z=le[Re],Te?fe&&n.texSubImage2D(e.TEXTURE_2D,Re,0,0,Z.width,Z.height,_e,te,Z.data):n.texImage2D(e.TEXTURE_2D,Re,re,Z.width,Z.height,0,_e,te,Z.data);me.generateMipmaps=!1}else Te?(Ve&&n.texStorage2D(e.TEXTURE_2D,xe,re,zt.width,zt.height),fe&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,zt.width,zt.height,_e,te,zt.data)):n.texImage2D(e.TEXTURE_2D,0,re,zt.width,zt.height,0,_e,te,zt.data);else if(me.isCompressedTexture)if(me.isCompressedArrayTexture){Te&&Ve&&n.texStorage3D(e.TEXTURE_2D_ARRAY,xe,re,le[0].width,le[0].height,zt.depth);for(let Re=0,De=le.length;Re<De;Re++)if(Z=le[Re],me.format!==Pl)if(_e!==null)if(Te){if(fe)if(me.layerUpdates.size>0){const ze=aB(Z.width,Z.height,me.format,me.type);for(const Je of me.layerUpdates){const Oe=Z.data.subarray(Je*ze/Z.data.BYTES_PER_ELEMENT,(Je+1)*ze/Z.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,Re,0,0,Je,Z.width,Z.height,1,_e,Oe)}me.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,Re,0,0,0,Z.width,Z.height,zt.depth,_e,Z.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,Re,re,Z.width,Z.height,zt.depth,0,Z.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Te?fe&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,Re,0,0,0,Z.width,Z.height,zt.depth,_e,te,Z.data):n.texImage3D(e.TEXTURE_2D_ARRAY,Re,re,Z.width,Z.height,zt.depth,0,_e,te,Z.data)}else{Te&&Ve&&n.texStorage2D(e.TEXTURE_2D,xe,re,le[0].width,le[0].height);for(let Re=0,De=le.length;Re<De;Re++)Z=le[Re],me.format!==Pl?_e!==null?Te?fe&&n.compressedTexSubImage2D(e.TEXTURE_2D,Re,0,0,Z.width,Z.height,_e,Z.data):n.compressedTexImage2D(e.TEXTURE_2D,Re,re,Z.width,Z.height,0,Z.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Te?fe&&n.texSubImage2D(e.TEXTURE_2D,Re,0,0,Z.width,Z.height,_e,te,Z.data):n.texImage2D(e.TEXTURE_2D,Re,re,Z.width,Z.height,0,_e,te,Z.data)}else if(me.isDataArrayTexture)if(Te){if(Ve&&n.texStorage3D(e.TEXTURE_2D_ARRAY,xe,re,zt.width,zt.height,zt.depth),fe)if(me.layerUpdates.size>0){const Re=aB(zt.width,zt.height,me.format,me.type);for(const De of me.layerUpdates){const ze=zt.data.subarray(De*Re/zt.data.BYTES_PER_ELEMENT,(De+1)*Re/zt.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,De,zt.width,zt.height,1,_e,te,ze)}me.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,zt.width,zt.height,zt.depth,_e,te,zt.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,re,zt.width,zt.height,zt.depth,0,_e,te,zt.data);else if(me.isData3DTexture)Te?(Ve&&n.texStorage3D(e.TEXTURE_3D,xe,re,zt.width,zt.height,zt.depth),fe&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,zt.width,zt.height,zt.depth,_e,te,zt.data)):n.texImage3D(e.TEXTURE_3D,0,re,zt.width,zt.height,zt.depth,0,_e,te,zt.data);else if(me.isFramebufferTexture){if(Ve)if(Te)n.texStorage2D(e.TEXTURE_2D,xe,re,zt.width,zt.height);else{let Re=zt.width,De=zt.height;for(let ze=0;ze<xe;ze++)n.texImage2D(e.TEXTURE_2D,ze,re,Re,De,0,_e,te,null),Re>>=1,De>>=1}}else if(le.length>0){if(Te&&Ve){const Re=an(le[0]);n.texStorage2D(e.TEXTURE_2D,xe,re,Re.width,Re.height)}for(let Re=0,De=le.length;Re<De;Re++)Z=le[Re],Te?fe&&n.texSubImage2D(e.TEXTURE_2D,Re,0,0,_e,te,Z):n.texImage2D(e.TEXTURE_2D,Re,re,_e,te,Z);me.generateMipmaps=!1}else if(Te){if(Ve){const Re=an(zt);n.texStorage2D(e.TEXTURE_2D,xe,re,Re.width,Re.height)}fe&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,_e,te,zt)}else n.texImage2D(e.TEXTURE_2D,0,re,_e,te,zt);I(me)&&T(St),Zt.__version=wt.version,me.onUpdate&&me.onUpdate(me)}Le.__version=me.version}function lt(Le,me,it){if(me.image.length!==6)return;const St=Xt(Le,me),It=me.source;n.bindTexture(e.TEXTURE_CUBE_MAP,Le.__webglTexture,e.TEXTURE0+it);const wt=r.get(It);if(It.version!==wt.__version||St===!0){n.activeTexture(e.TEXTURE0+it);const Zt=Tr.getPrimaries(Tr.workingColorSpace),Lt=me.colorSpace===yh?null:Tr.getPrimaries(me.colorSpace),kt=me.colorSpace===yh||Zt===Lt?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,me.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,me.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,me.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,kt);const bn=me.isCompressedTexture||me.image[0].isCompressedTexture,zt=me.image[0]&&me.image[0].isDataTexture,_e=[];for(let De=0;De<6;De++)!bn&&!zt?_e[De]=L(me.image[De],!0,i.maxCubemapSize):_e[De]=zt?me.image[De].image:me.image[De],_e[De]=An(me,_e[De]);const te=_e[0],re=a.convert(me.format,me.colorSpace),Z=a.convert(me.type),le=k(me.internalFormat,re,Z,me.colorSpace),Te=me.isVideoTexture!==!0,Ve=wt.__version===void 0||St===!0,fe=It.dataReady;let xe=H(me,te);ct(e.TEXTURE_CUBE_MAP,me);let Re;if(bn){Te&&Ve&&n.texStorage2D(e.TEXTURE_CUBE_MAP,xe,le,te.width,te.height);for(let De=0;De<6;De++){Re=_e[De].mipmaps;for(let ze=0;ze<Re.length;ze++){const Je=Re[ze];me.format!==Pl?re!==null?Te?fe&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze,0,0,Je.width,Je.height,re,Je.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze,le,Je.width,Je.height,0,Je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Te?fe&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze,0,0,Je.width,Je.height,re,Z,Je.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze,le,Je.width,Je.height,0,re,Z,Je.data)}}}else{if(Re=me.mipmaps,Te&&Ve){Re.length>0&&xe++;const De=an(_e[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,xe,le,De.width,De.height)}for(let De=0;De<6;De++)if(zt){Te?fe&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,_e[De].width,_e[De].height,re,Z,_e[De].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,le,_e[De].width,_e[De].height,0,re,Z,_e[De].data);for(let ze=0;ze<Re.length;ze++){const Oe=Re[ze].image[De].image;Te?fe&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze+1,0,0,Oe.width,Oe.height,re,Z,Oe.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze+1,le,Oe.width,Oe.height,0,re,Z,Oe.data)}}else{Te?fe&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,re,Z,_e[De]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,le,re,Z,_e[De]);for(let ze=0;ze<Re.length;ze++){const Je=Re[ze];Te?fe&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze+1,0,0,re,Z,Je.image[De]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze+1,le,re,Z,Je.image[De])}}}I(me)&&T(e.TEXTURE_CUBE_MAP),wt.__version=It.version,me.onUpdate&&me.onUpdate(me)}Le.__version=me.version}function Ot(Le,me,it,St,It,wt){const Zt=a.convert(it.format,it.colorSpace),Lt=a.convert(it.type),kt=k(it.internalFormat,Zt,Lt,it.colorSpace),bn=r.get(me),zt=r.get(it);if(zt.__renderTarget=me,!bn.__hasExternalTextures){const _e=Math.max(1,me.width>>wt),te=Math.max(1,me.height>>wt);It===e.TEXTURE_3D||It===e.TEXTURE_2D_ARRAY?n.texImage3D(It,wt,kt,_e,te,me.depth,0,Zt,Lt,null):n.texImage2D(It,wt,kt,_e,te,0,Zt,Lt,null)}n.bindFramebuffer(e.FRAMEBUFFER,Le),tn(me)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,St,It,zt.__webglTexture,0,Ut(me)):(It===e.TEXTURE_2D||It>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&It<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,St,It,zt.__webglTexture,wt),n.bindFramebuffer(e.FRAMEBUFFER,null)}function ut(Le,me,it){if(e.bindRenderbuffer(e.RENDERBUFFER,Le),me.depthBuffer){const St=me.depthTexture,It=St&&St.isDepthTexture?St.type:null,wt=U(me.stencilBuffer,It),Zt=me.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,Lt=Ut(me);tn(me)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,Lt,wt,me.width,me.height):it?e.renderbufferStorageMultisample(e.RENDERBUFFER,Lt,wt,me.width,me.height):e.renderbufferStorage(e.RENDERBUFFER,wt,me.width,me.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,Zt,e.RENDERBUFFER,Le)}else{const St=me.textures;for(let It=0;It<St.length;It++){const wt=St[It],Zt=a.convert(wt.format,wt.colorSpace),Lt=a.convert(wt.type),kt=k(wt.internalFormat,Zt,Lt,wt.colorSpace),bn=Ut(me);it&&tn(me)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,bn,kt,me.width,me.height):tn(me)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,bn,kt,me.width,me.height):e.renderbufferStorage(e.RENDERBUFFER,kt,me.width,me.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function ot(Le,me){if(me&&me.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,Le),!(me.depthTexture&&me.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const St=r.get(me.depthTexture);St.__renderTarget=me,(!St.__webglTexture||me.depthTexture.image.width!==me.width||me.depthTexture.image.height!==me.height)&&(me.depthTexture.image.width=me.width,me.depthTexture.image.height=me.height,me.depthTexture.needsUpdate=!0),Ae(me.depthTexture,0);const It=St.__webglTexture,wt=Ut(me);if(me.depthTexture.format===__)tn(me)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,It,0,wt):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,It,0);else if(me.depthTexture.format===x_)tn(me)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,It,0,wt):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,It,0);else throw new Error("Unknown depthTexture format")}function Tt(Le){const me=r.get(Le),it=Le.isWebGLCubeRenderTarget===!0;if(me.__boundDepthTexture!==Le.depthTexture){const St=Le.depthTexture;if(me.__depthDisposeCallback&&me.__depthDisposeCallback(),St){const It=()=>{delete me.__boundDepthTexture,delete me.__depthDisposeCallback,St.removeEventListener("dispose",It)};St.addEventListener("dispose",It),me.__depthDisposeCallback=It}me.__boundDepthTexture=St}if(Le.depthTexture&&!me.__autoAllocateDepthBuffer){if(it)throw new Error("target.depthTexture not supported in Cube render targets");ot(me.__webglFramebuffer,Le)}else if(it){me.__webglDepthbuffer=[];for(let St=0;St<6;St++)if(n.bindFramebuffer(e.FRAMEBUFFER,me.__webglFramebuffer[St]),me.__webglDepthbuffer[St]===void 0)me.__webglDepthbuffer[St]=e.createRenderbuffer(),ut(me.__webglDepthbuffer[St],Le,!1);else{const It=Le.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,wt=me.__webglDepthbuffer[St];e.bindRenderbuffer(e.RENDERBUFFER,wt),e.framebufferRenderbuffer(e.FRAMEBUFFER,It,e.RENDERBUFFER,wt)}}else if(n.bindFramebuffer(e.FRAMEBUFFER,me.__webglFramebuffer),me.__webglDepthbuffer===void 0)me.__webglDepthbuffer=e.createRenderbuffer(),ut(me.__webglDepthbuffer,Le,!1);else{const St=Le.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,It=me.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,It),e.framebufferRenderbuffer(e.FRAMEBUFFER,St,e.RENDERBUFFER,It)}n.bindFramebuffer(e.FRAMEBUFFER,null)}function Ct(Le,me,it){const St=r.get(Le);me!==void 0&&Ot(St.__webglFramebuffer,Le,Le.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),it!==void 0&&Tt(Le)}function un(Le){const me=Le.texture,it=r.get(Le),St=r.get(me);Le.addEventListener("dispose",q);const It=Le.textures,wt=Le.isWebGLCubeRenderTarget===!0,Zt=It.length>1;if(Zt||(St.__webglTexture===void 0&&(St.__webglTexture=e.createTexture()),St.__version=me.version,c.memory.textures++),wt){it.__webglFramebuffer=[];for(let Lt=0;Lt<6;Lt++)if(me.mipmaps&&me.mipmaps.length>0){it.__webglFramebuffer[Lt]=[];for(let kt=0;kt<me.mipmaps.length;kt++)it.__webglFramebuffer[Lt][kt]=e.createFramebuffer()}else it.__webglFramebuffer[Lt]=e.createFramebuffer()}else{if(me.mipmaps&&me.mipmaps.length>0){it.__webglFramebuffer=[];for(let Lt=0;Lt<me.mipmaps.length;Lt++)it.__webglFramebuffer[Lt]=e.createFramebuffer()}else it.__webglFramebuffer=e.createFramebuffer();if(Zt)for(let Lt=0,kt=It.length;Lt<kt;Lt++){const bn=r.get(It[Lt]);bn.__webglTexture===void 0&&(bn.__webglTexture=e.createTexture(),c.memory.textures++)}if(Le.samples>0&&tn(Le)===!1){it.__webglMultisampledFramebuffer=e.createFramebuffer(),it.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,it.__webglMultisampledFramebuffer);for(let Lt=0;Lt<It.length;Lt++){const kt=It[Lt];it.__webglColorRenderbuffer[Lt]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,it.__webglColorRenderbuffer[Lt]);const bn=a.convert(kt.format,kt.colorSpace),zt=a.convert(kt.type),_e=k(kt.internalFormat,bn,zt,kt.colorSpace,Le.isXRRenderTarget===!0),te=Ut(Le);e.renderbufferStorageMultisample(e.RENDERBUFFER,te,_e,Le.width,Le.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+Lt,e.RENDERBUFFER,it.__webglColorRenderbuffer[Lt])}e.bindRenderbuffer(e.RENDERBUFFER,null),Le.depthBuffer&&(it.__webglDepthRenderbuffer=e.createRenderbuffer(),ut(it.__webglDepthRenderbuffer,Le,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(wt){n.bindTexture(e.TEXTURE_CUBE_MAP,St.__webglTexture),ct(e.TEXTURE_CUBE_MAP,me);for(let Lt=0;Lt<6;Lt++)if(me.mipmaps&&me.mipmaps.length>0)for(let kt=0;kt<me.mipmaps.length;kt++)Ot(it.__webglFramebuffer[Lt][kt],Le,me,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+Lt,kt);else Ot(it.__webglFramebuffer[Lt],Le,me,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+Lt,0);I(me)&&T(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Zt){for(let Lt=0,kt=It.length;Lt<kt;Lt++){const bn=It[Lt],zt=r.get(bn);n.bindTexture(e.TEXTURE_2D,zt.__webglTexture),ct(e.TEXTURE_2D,bn),Ot(it.__webglFramebuffer,Le,bn,e.COLOR_ATTACHMENT0+Lt,e.TEXTURE_2D,0),I(bn)&&T(e.TEXTURE_2D)}n.unbindTexture()}else{let Lt=e.TEXTURE_2D;if((Le.isWebGL3DRenderTarget||Le.isWebGLArrayRenderTarget)&&(Lt=Le.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(Lt,St.__webglTexture),ct(Lt,me),me.mipmaps&&me.mipmaps.length>0)for(let kt=0;kt<me.mipmaps.length;kt++)Ot(it.__webglFramebuffer[kt],Le,me,e.COLOR_ATTACHMENT0,Lt,kt);else Ot(it.__webglFramebuffer,Le,me,e.COLOR_ATTACHMENT0,Lt,0);I(me)&&T(Lt),n.unbindTexture()}Le.depthBuffer&&Tt(Le)}function gn(Le){const me=Le.textures;for(let it=0,St=me.length;it<St;it++){const It=me[it];if(I(It)){const wt=z(Le),Zt=r.get(It).__webglTexture;n.bindTexture(wt,Zt),T(wt),n.unbindTexture()}}}const hn=[],We=[];function vn(Le){if(Le.samples>0){if(tn(Le)===!1){const me=Le.textures,it=Le.width,St=Le.height;let It=e.COLOR_BUFFER_BIT;const wt=Le.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,Zt=r.get(Le),Lt=me.length>1;if(Lt)for(let kt=0;kt<me.length;kt++)n.bindFramebuffer(e.FRAMEBUFFER,Zt.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+kt,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,Zt.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+kt,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,Zt.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,Zt.__webglFramebuffer);for(let kt=0;kt<me.length;kt++){if(Le.resolveDepthBuffer&&(Le.depthBuffer&&(It|=e.DEPTH_BUFFER_BIT),Le.stencilBuffer&&Le.resolveStencilBuffer&&(It|=e.STENCIL_BUFFER_BIT)),Lt){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,Zt.__webglColorRenderbuffer[kt]);const bn=r.get(me[kt]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,bn,0)}e.blitFramebuffer(0,0,it,St,0,0,it,St,It,e.NEAREST),f===!0&&(hn.length=0,We.length=0,hn.push(e.COLOR_ATTACHMENT0+kt),Le.depthBuffer&&Le.resolveDepthBuffer===!1&&(hn.push(wt),We.push(wt),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,We)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,hn))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),Lt)for(let kt=0;kt<me.length;kt++){n.bindFramebuffer(e.FRAMEBUFFER,Zt.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+kt,e.RENDERBUFFER,Zt.__webglColorRenderbuffer[kt]);const bn=r.get(me[kt]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,Zt.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+kt,e.TEXTURE_2D,bn,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,Zt.__webglMultisampledFramebuffer)}else if(Le.depthBuffer&&Le.resolveDepthBuffer===!1&&f){const me=Le.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[me])}}}function Ut(Le){return Math.min(i.maxSamples,Le.samples)}function tn(Le){const me=r.get(Le);return Le.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&me.__useRenderToTexture!==!1}function Dt(Le){const me=c.render.frame;_.get(Le)!==me&&(_.set(Le,me),Le.update())}function An(Le,me){const it=Le.colorSpace,St=Le.format,It=Le.type;return Le.isCompressedTexture===!0||Le.isVideoTexture===!0||it!==Vf&&it!==yh&&(Tr.getTransfer(it)===qr?(St!==Pl||It!==gu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",it)),me}function an(Le){return typeof HTMLImageElement<"u"&&Le instanceof HTMLImageElement?(g.width=Le.naturalWidth||Le.width,g.height=Le.naturalHeight||Le.height):typeof VideoFrame<"u"&&Le instanceof VideoFrame?(g.width=Le.displayWidth,g.height=Le.displayHeight):(g.width=Le.width,g.height=Le.height),g}this.allocateTextureUnit=ge,this.resetTextureUnits=ye,this.setTexture2D=Ae,this.setTexture2DArray=ve,this.setTexture3D=Se,this.setTextureCube=Me,this.rebindTextures=Ct,this.setupRenderTarget=un,this.updateRenderTargetMipmap=gn,this.updateMultisampleRenderTarget=vn,this.setupDepthRenderbuffer=Tt,this.setupFrameBufferTexture=Ot,this.useMultisampledRTT=tn}function mPe(e,t){function n(r,i=yh){let a;const c=Tr.getTransfer(i);if(r===gu)return e.UNSIGNED_BYTE;if(r===$L)return e.UNSIGNED_SHORT_4_4_4_4;if(r===VL)return e.UNSIGNED_SHORT_5_5_5_1;if(r===m7)return e.UNSIGNED_INT_5_9_9_9_REV;if(r===f7)return e.BYTE;if(r===p7)return e.SHORT;if(r===v_)return e.UNSIGNED_SHORT;if(r===UL)return e.INT;if(r===$f)return e.UNSIGNED_INT;if(r===tu)return e.FLOAT;if(r===dx)return e.HALF_FLOAT;if(r===g7)return e.ALPHA;if(r===v7)return e.RGB;if(r===Pl)return e.RGBA;if(r===y7)return e.LUMINANCE;if(r===_7)return e.LUMINANCE_ALPHA;if(r===__)return e.DEPTH_COMPONENT;if(r===x_)return e.DEPTH_STENCIL;if(r===x7)return e.RED;if(r===jL)return e.RED_INTEGER;if(r===b7)return e.RG;if(r===HL)return e.RG_INTEGER;if(r===GL)return e.RGBA_INTEGER;if(r===gw||r===vw||r===yw||r===_w)if(c===qr)if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(r===gw)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===vw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===yw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===_w)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=t.get("WEBGL_compressed_texture_s3tc"),a!==null){if(r===gw)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===vw)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===yw)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===_w)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===mI||r===gI||r===vI||r===yI)if(a=t.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(r===mI)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===gI)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===vI)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===yI)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===_I||r===xI||r===bI)if(a=t.get("WEBGL_compressed_texture_etc"),a!==null){if(r===_I||r===xI)return c===qr?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(r===bI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===wI||r===SI||r===MI||r===CI||r===EI||r===TI||r===PI||r===AI||r===II||r===RI||r===LI||r===kI||r===DI||r===zI)if(a=t.get("WEBGL_compressed_texture_astc"),a!==null){if(r===wI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===SI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===MI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===CI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===EI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===TI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===PI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===AI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===II)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===RI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===LI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===kI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===DI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===zI)return c===qr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===xw||r===OI||r===FI)if(a=t.get("EXT_texture_compression_bptc"),a!==null){if(r===xw)return c===qr?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===OI)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===FI)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===w7||r===NI||r===BI||r===UI)if(a=t.get("EXT_texture_compression_rgtc"),a!==null){if(r===xw)return a.COMPRESSED_RED_RGTC1_EXT;if(r===NI)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===BI)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===UI)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===y_?e.UNSIGNED_INT_24_8:e[r]!==void 0?e[r]:null}return{convert:n}}const gPe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,vPe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class yPe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(t,n,r){if(this.texture===null){const i=new Ho,a=t.properties.get(i);a.__webglTexture=n.texture,(n.depthNear!==r.depthNear||n.depthFar!==r.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=i}}getMesh(t){if(this.texture!==null&&this.mesh===null){const n=t.cameras[0].viewport,r=new vu({vertexShader:gPe,fragmentShader:vPe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Ns(new mx(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class _Pe extends Xg{constructor(t,n){super();const r=this;let i=null,a=1,c=null,o="local-floor",f=1,g=null,_=null,x=null,M=null,C=null,A=null;const L=new yPe,I=n.getContextAttributes();let T=null,z=null;const k=[],U=[],H=new Dr;let V=null;const q=new pa;q.viewport=new Fi;const J=new pa;J.viewport=new Fi;const Y=[q,J],N=new BMe;let ne=null,ye=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(je){let lt=k[je];return lt===void 0&&(lt=new sP,k[je]=lt),lt.getTargetRaySpace()},this.getControllerGrip=function(je){let lt=k[je];return lt===void 0&&(lt=new sP,k[je]=lt),lt.getGripSpace()},this.getHand=function(je){let lt=k[je];return lt===void 0&&(lt=new sP,k[je]=lt),lt.getHandSpace()};function ge(je){const lt=U.indexOf(je.inputSource);if(lt===-1)return;const Ot=k[lt];Ot!==void 0&&(Ot.update(je.inputSource,je.frame,g||c),Ot.dispatchEvent({type:je.type,data:je.inputSource}))}function Ne(){i.removeEventListener("select",ge),i.removeEventListener("selectstart",ge),i.removeEventListener("selectend",ge),i.removeEventListener("squeeze",ge),i.removeEventListener("squeezestart",ge),i.removeEventListener("squeezeend",ge),i.removeEventListener("end",Ne),i.removeEventListener("inputsourceschange",Ae);for(let je=0;je<k.length;je++){const lt=U[je];lt!==null&&(U[je]=null,k[je].disconnect(lt))}ne=null,ye=null,L.reset(),t.setRenderTarget(T),C=null,M=null,x=null,i=null,z=null,Xt.stop(),r.isPresenting=!1,t.setPixelRatio(V),t.setSize(H.width,H.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(je){a=je,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(je){o=je,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return g||c},this.setReferenceSpace=function(je){g=je},this.getBaseLayer=function(){return M!==null?M:C},this.getBinding=function(){return x},this.getFrame=function(){return A},this.getSession=function(){return i},this.setSession=async function(je){if(i=je,i!==null){if(T=t.getRenderTarget(),i.addEventListener("select",ge),i.addEventListener("selectstart",ge),i.addEventListener("selectend",ge),i.addEventListener("squeeze",ge),i.addEventListener("squeezestart",ge),i.addEventListener("squeezeend",ge),i.addEventListener("end",Ne),i.addEventListener("inputsourceschange",Ae),I.xrCompatible!==!0&&await n.makeXRCompatible(),V=t.getPixelRatio(),t.getSize(H),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ot=null,ut=null,ot=null;I.depth&&(ot=I.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,Ot=I.stencil?x_:__,ut=I.stencil?y_:$f);const Tt={colorFormat:n.RGBA8,depthFormat:ot,scaleFactor:a};x=new XRWebGLBinding(i,n),M=x.createProjectionLayer(Tt),i.updateRenderState({layers:[M]}),t.setPixelRatio(1),t.setSize(M.textureWidth,M.textureHeight,!1),z=new Zh(M.textureWidth,M.textureHeight,{format:Pl,type:gu,depthTexture:new L7(M.textureWidth,M.textureHeight,ut,void 0,void 0,void 0,void 0,void 0,void 0,Ot),stencilBuffer:I.stencil,colorSpace:t.outputColorSpace,samples:I.antialias?4:0,resolveDepthBuffer:M.ignoreDepthValues===!1,resolveStencilBuffer:M.ignoreDepthValues===!1})}else{const Ot={antialias:I.antialias,alpha:!0,depth:I.depth,stencil:I.stencil,framebufferScaleFactor:a};C=new XRWebGLLayer(i,n,Ot),i.updateRenderState({baseLayer:C}),t.setPixelRatio(1),t.setSize(C.framebufferWidth,C.framebufferHeight,!1),z=new Zh(C.framebufferWidth,C.framebufferHeight,{format:Pl,type:gu,colorSpace:t.outputColorSpace,stencilBuffer:I.stencil,resolveDepthBuffer:C.ignoreDepthValues===!1,resolveStencilBuffer:C.ignoreDepthValues===!1})}z.isXRRenderTarget=!0,this.setFoveation(f),g=null,c=await i.requestReferenceSpace(o),Xt.setContext(i),Xt.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return L.getDepthTexture()};function Ae(je){for(let lt=0;lt<je.removed.length;lt++){const Ot=je.removed[lt],ut=U.indexOf(Ot);ut>=0&&(U[ut]=null,k[ut].disconnect(Ot))}for(let lt=0;lt<je.added.length;lt++){const Ot=je.added[lt];let ut=U.indexOf(Ot);if(ut===-1){for(let Tt=0;Tt<k.length;Tt++)if(Tt>=U.length){U.push(Ot),ut=Tt;break}else if(U[Tt]===null){U[Tt]=Ot,ut=Tt;break}if(ut===-1)break}const ot=k[ut];ot&&ot.connect(Ot)}}const ve=new dt,Se=new dt;function Me(je,lt,Ot){ve.setFromMatrixPosition(lt.matrixWorld),Se.setFromMatrixPosition(Ot.matrixWorld);const ut=ve.distanceTo(Se),ot=lt.projectionMatrix.elements,Tt=Ot.projectionMatrix.elements,Ct=ot[14]/(ot[10]-1),un=ot[14]/(ot[10]+1),gn=(ot[9]+1)/ot[5],hn=(ot[9]-1)/ot[5],We=(ot[8]-1)/ot[0],vn=(Tt[8]+1)/Tt[0],Ut=Ct*We,tn=Ct*vn,Dt=ut/(-We+vn),An=Dt*-We;if(lt.matrixWorld.decompose(je.position,je.quaternion,je.scale),je.translateX(An),je.translateZ(Dt),je.matrixWorld.compose(je.position,je.quaternion,je.scale),je.matrixWorldInverse.copy(je.matrixWorld).invert(),ot[10]===-1)je.projectionMatrix.copy(lt.projectionMatrix),je.projectionMatrixInverse.copy(lt.projectionMatrixInverse);else{const an=Ct+Dt,Le=un+Dt,me=Ut-An,it=tn+(ut-An),St=gn*un/Le*an,It=hn*un/Le*an;je.projectionMatrix.makePerspective(me,it,St,It,an,Le),je.projectionMatrixInverse.copy(je.projectionMatrix).invert()}}function Ue(je,lt){lt===null?je.matrixWorld.copy(je.matrix):je.matrixWorld.multiplyMatrices(lt.matrixWorld,je.matrix),je.matrixWorldInverse.copy(je.matrixWorld).invert()}this.updateCamera=function(je){if(i===null)return;let lt=je.near,Ot=je.far;L.texture!==null&&(L.depthNear>0&&(lt=L.depthNear),L.depthFar>0&&(Ot=L.depthFar)),N.near=J.near=q.near=lt,N.far=J.far=q.far=Ot,(ne!==N.near||ye!==N.far)&&(i.updateRenderState({depthNear:N.near,depthFar:N.far}),ne=N.near,ye=N.far),q.layers.mask=je.layers.mask|2,J.layers.mask=je.layers.mask|4,N.layers.mask=q.layers.mask|J.layers.mask;const ut=je.parent,ot=N.cameras;Ue(N,ut);for(let Tt=0;Tt<ot.length;Tt++)Ue(ot[Tt],ut);ot.length===2?Me(N,q,J):N.projectionMatrix.copy(q.projectionMatrix),Qe(je,N,ut)};function Qe(je,lt,Ot){Ot===null?je.matrix.copy(lt.matrixWorld):(je.matrix.copy(Ot.matrixWorld),je.matrix.invert(),je.matrix.multiply(lt.matrixWorld)),je.matrix.decompose(je.position,je.quaternion,je.scale),je.updateMatrixWorld(!0),je.projectionMatrix.copy(lt.projectionMatrix),je.projectionMatrixInverse.copy(lt.projectionMatrixInverse),je.isPerspectiveCamera&&(je.fov=b_*2*Math.atan(1/je.projectionMatrix.elements[5]),je.zoom=1)}this.getCamera=function(){return N},this.getFoveation=function(){if(!(M===null&&C===null))return f},this.setFoveation=function(je){f=je,M!==null&&(M.fixedFoveation=je),C!==null&&C.fixedFoveation!==void 0&&(C.fixedFoveation=je)},this.hasDepthSensing=function(){return L.texture!==null},this.getDepthSensingMesh=function(){return L.getMesh(N)};let st=null;function ct(je,lt){if(_=lt.getViewerPose(g||c),A=lt,_!==null){const Ot=_.views;C!==null&&(t.setRenderTargetFramebuffer(z,C.framebuffer),t.setRenderTarget(z));let ut=!1;Ot.length!==N.cameras.length&&(N.cameras.length=0,ut=!0);for(let Ct=0;Ct<Ot.length;Ct++){const un=Ot[Ct];let gn=null;if(C!==null)gn=C.getViewport(un);else{const We=x.getViewSubImage(M,un);gn=We.viewport,Ct===0&&(t.setRenderTargetTextures(z,We.colorTexture,We.depthStencilTexture),t.setRenderTarget(z))}let hn=Y[Ct];hn===void 0&&(hn=new pa,hn.layers.enable(Ct),hn.viewport=new Fi,Y[Ct]=hn),hn.matrix.fromArray(un.transform.matrix),hn.matrix.decompose(hn.position,hn.quaternion,hn.scale),hn.projectionMatrix.fromArray(un.projectionMatrix),hn.projectionMatrixInverse.copy(hn.projectionMatrix).invert(),hn.viewport.set(gn.x,gn.y,gn.width,gn.height),Ct===0&&(N.matrix.copy(hn.matrix),N.matrix.decompose(N.position,N.quaternion,N.scale)),ut===!0&&N.cameras.push(hn)}const ot=i.enabledFeatures;if(ot&&ot.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&x){const Ct=x.getDepthInformation(Ot[0]);Ct&&Ct.isValid&&Ct.texture&&L.init(t,Ct,i.renderState)}}for(let Ot=0;Ot<k.length;Ot++){const ut=U[Ot],ot=k[Ot];ut!==null&&ot!==void 0&&ot.update(ut,lt,g||c)}st&&st(je,lt),lt.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:lt}),A=null}const Xt=new k7;Xt.setAnimationLoop(ct),this.setAnimationLoop=function(je){st=je},this.dispose=function(){}}}const of=new Sc,xPe=new jr;function bPe(e,t){function n(I,T){I.matrixAutoUpdate===!0&&I.updateMatrix(),T.value.copy(I.matrix)}function r(I,T){T.color.getRGB(I.fogColor.value,A7(e)),T.isFog?(I.fogNear.value=T.near,I.fogFar.value=T.far):T.isFogExp2&&(I.fogDensity.value=T.density)}function i(I,T,z,k,U){T.isMeshBasicMaterial||T.isMeshLambertMaterial?a(I,T):T.isMeshToonMaterial?(a(I,T),x(I,T)):T.isMeshPhongMaterial?(a(I,T),_(I,T)):T.isMeshStandardMaterial?(a(I,T),M(I,T),T.isMeshPhysicalMaterial&&C(I,T,U)):T.isMeshMatcapMaterial?(a(I,T),A(I,T)):T.isMeshDepthMaterial?a(I,T):T.isMeshDistanceMaterial?(a(I,T),L(I,T)):T.isMeshNormalMaterial?a(I,T):T.isLineBasicMaterial?(c(I,T),T.isLineDashedMaterial&&o(I,T)):T.isPointsMaterial?f(I,T,z,k):T.isSpriteMaterial?g(I,T):T.isShadowMaterial?(I.color.value.copy(T.color),I.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}function a(I,T){I.opacity.value=T.opacity,T.color&&I.diffuse.value.copy(T.color),T.emissive&&I.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(I.map.value=T.map,n(T.map,I.mapTransform)),T.alphaMap&&(I.alphaMap.value=T.alphaMap,n(T.alphaMap,I.alphaMapTransform)),T.bumpMap&&(I.bumpMap.value=T.bumpMap,n(T.bumpMap,I.bumpMapTransform),I.bumpScale.value=T.bumpScale,T.side===Hs&&(I.bumpScale.value*=-1)),T.normalMap&&(I.normalMap.value=T.normalMap,n(T.normalMap,I.normalMapTransform),I.normalScale.value.copy(T.normalScale),T.side===Hs&&I.normalScale.value.negate()),T.displacementMap&&(I.displacementMap.value=T.displacementMap,n(T.displacementMap,I.displacementMapTransform),I.displacementScale.value=T.displacementScale,I.displacementBias.value=T.displacementBias),T.emissiveMap&&(I.emissiveMap.value=T.emissiveMap,n(T.emissiveMap,I.emissiveMapTransform)),T.specularMap&&(I.specularMap.value=T.specularMap,n(T.specularMap,I.specularMapTransform)),T.alphaTest>0&&(I.alphaTest.value=T.alphaTest);const z=t.get(T),k=z.envMap,U=z.envMapRotation;k&&(I.envMap.value=k,of.copy(U),of.x*=-1,of.y*=-1,of.z*=-1,k.isCubeTexture&&k.isRenderTargetTexture===!1&&(of.y*=-1,of.z*=-1),I.envMapRotation.value.setFromMatrix4(xPe.makeRotationFromEuler(of)),I.flipEnvMap.value=k.isCubeTexture&&k.isRenderTargetTexture===!1?-1:1,I.reflectivity.value=T.reflectivity,I.ior.value=T.ior,I.refractionRatio.value=T.refractionRatio),T.lightMap&&(I.lightMap.value=T.lightMap,I.lightMapIntensity.value=T.lightMapIntensity,n(T.lightMap,I.lightMapTransform)),T.aoMap&&(I.aoMap.value=T.aoMap,I.aoMapIntensity.value=T.aoMapIntensity,n(T.aoMap,I.aoMapTransform))}function c(I,T){I.diffuse.value.copy(T.color),I.opacity.value=T.opacity,T.map&&(I.map.value=T.map,n(T.map,I.mapTransform))}function o(I,T){I.dashSize.value=T.dashSize,I.totalSize.value=T.dashSize+T.gapSize,I.scale.value=T.scale}function f(I,T,z,k){I.diffuse.value.copy(T.color),I.opacity.value=T.opacity,I.size.value=T.size*z,I.scale.value=k*.5,T.map&&(I.map.value=T.map,n(T.map,I.uvTransform)),T.alphaMap&&(I.alphaMap.value=T.alphaMap,n(T.alphaMap,I.alphaMapTransform)),T.alphaTest>0&&(I.alphaTest.value=T.alphaTest)}function g(I,T){I.diffuse.value.copy(T.color),I.opacity.value=T.opacity,I.rotation.value=T.rotation,T.map&&(I.map.value=T.map,n(T.map,I.mapTransform)),T.alphaMap&&(I.alphaMap.value=T.alphaMap,n(T.alphaMap,I.alphaMapTransform)),T.alphaTest>0&&(I.alphaTest.value=T.alphaTest)}function _(I,T){I.specular.value.copy(T.specular),I.shininess.value=Math.max(T.shininess,1e-4)}function x(I,T){T.gradientMap&&(I.gradientMap.value=T.gradientMap)}function M(I,T){I.metalness.value=T.metalness,T.metalnessMap&&(I.metalnessMap.value=T.metalnessMap,n(T.metalnessMap,I.metalnessMapTransform)),I.roughness.value=T.roughness,T.roughnessMap&&(I.roughnessMap.value=T.roughnessMap,n(T.roughnessMap,I.roughnessMapTransform)),T.envMap&&(I.envMapIntensity.value=T.envMapIntensity)}function C(I,T,z){I.ior.value=T.ior,T.sheen>0&&(I.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),I.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(I.sheenColorMap.value=T.sheenColorMap,n(T.sheenColorMap,I.sheenColorMapTransform)),T.sheenRoughnessMap&&(I.sheenRoughnessMap.value=T.sheenRoughnessMap,n(T.sheenRoughnessMap,I.sheenRoughnessMapTransform))),T.clearcoat>0&&(I.clearcoat.value=T.clearcoat,I.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(I.clearcoatMap.value=T.clearcoatMap,n(T.clearcoatMap,I.clearcoatMapTransform)),T.clearcoatRoughnessMap&&(I.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap,n(T.clearcoatRoughnessMap,I.clearcoatRoughnessMapTransform)),T.clearcoatNormalMap&&(I.clearcoatNormalMap.value=T.clearcoatNormalMap,n(T.clearcoatNormalMap,I.clearcoatNormalMapTransform),I.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),T.side===Hs&&I.clearcoatNormalScale.value.negate())),T.dispersion>0&&(I.dispersion.value=T.dispersion),T.iridescence>0&&(I.iridescence.value=T.iridescence,I.iridescenceIOR.value=T.iridescenceIOR,I.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],I.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(I.iridescenceMap.value=T.iridescenceMap,n(T.iridescenceMap,I.iridescenceMapTransform)),T.iridescenceThicknessMap&&(I.iridescenceThicknessMap.value=T.iridescenceThicknessMap,n(T.iridescenceThicknessMap,I.iridescenceThicknessMapTransform))),T.transmission>0&&(I.transmission.value=T.transmission,I.transmissionSamplerMap.value=z.texture,I.transmissionSamplerSize.value.set(z.width,z.height),T.transmissionMap&&(I.transmissionMap.value=T.transmissionMap,n(T.transmissionMap,I.transmissionMapTransform)),I.thickness.value=T.thickness,T.thicknessMap&&(I.thicknessMap.value=T.thicknessMap,n(T.thicknessMap,I.thicknessMapTransform)),I.attenuationDistance.value=T.attenuationDistance,I.attenuationColor.value.copy(T.attenuationColor)),T.anisotropy>0&&(I.anisotropyVector.value.set(T.anisotropy*Math.cos(T.anisotropyRotation),T.anisotropy*Math.sin(T.anisotropyRotation)),T.anisotropyMap&&(I.anisotropyMap.value=T.anisotropyMap,n(T.anisotropyMap,I.anisotropyMapTransform))),I.specularIntensity.value=T.specularIntensity,I.specularColor.value.copy(T.specularColor),T.specularColorMap&&(I.specularColorMap.value=T.specularColorMap,n(T.specularColorMap,I.specularColorMapTransform)),T.specularIntensityMap&&(I.specularIntensityMap.value=T.specularIntensityMap,n(T.specularIntensityMap,I.specularIntensityMapTransform))}function A(I,T){T.matcap&&(I.matcap.value=T.matcap)}function L(I,T){const z=t.get(T).light;I.referencePosition.value.setFromMatrixPosition(z.matrixWorld),I.nearDistance.value=z.shadow.camera.near,I.farDistance.value=z.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function wPe(e,t,n,r){let i={},a={},c=[];const o=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function f(z,k){const U=k.program;r.uniformBlockBinding(z,U)}function g(z,k){let U=i[z.id];U===void 0&&(A(z),U=_(z),i[z.id]=U,z.addEventListener("dispose",I));const H=k.program;r.updateUBOMapping(z,H);const V=t.render.frame;a[z.id]!==V&&(M(z),a[z.id]=V)}function _(z){const k=x();z.__bindingPointIndex=k;const U=e.createBuffer(),H=z.__size,V=z.usage;return e.bindBuffer(e.UNIFORM_BUFFER,U),e.bufferData(e.UNIFORM_BUFFER,H,V),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,k,U),U}function x(){for(let z=0;z<o;z++)if(c.indexOf(z)===-1)return c.push(z),z;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function M(z){const k=i[z.id],U=z.uniforms,H=z.__cache;e.bindBuffer(e.UNIFORM_BUFFER,k);for(let V=0,q=U.length;V<q;V++){const J=Array.isArray(U[V])?U[V]:[U[V]];for(let Y=0,N=J.length;Y<N;Y++){const ne=J[Y];if(C(ne,V,Y,H)===!0){const ye=ne.__offset,ge=Array.isArray(ne.value)?ne.value:[ne.value];let Ne=0;for(let Ae=0;Ae<ge.length;Ae++){const ve=ge[Ae],Se=L(ve);typeof ve=="number"||typeof ve=="boolean"?(ne.__data[0]=ve,e.bufferSubData(e.UNIFORM_BUFFER,ye+Ne,ne.__data)):ve.isMatrix3?(ne.__data[0]=ve.elements[0],ne.__data[1]=ve.elements[1],ne.__data[2]=ve.elements[2],ne.__data[3]=0,ne.__data[4]=ve.elements[3],ne.__data[5]=ve.elements[4],ne.__data[6]=ve.elements[5],ne.__data[7]=0,ne.__data[8]=ve.elements[6],ne.__data[9]=ve.elements[7],ne.__data[10]=ve.elements[8],ne.__data[11]=0):(ve.toArray(ne.__data,Ne),Ne+=Se.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,ye,ne.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}function C(z,k,U,H){const V=z.value,q=k+"_"+U;if(H[q]===void 0)return typeof V=="number"||typeof V=="boolean"?H[q]=V:H[q]=V.clone(),!0;{const J=H[q];if(typeof V=="number"||typeof V=="boolean"){if(J!==V)return H[q]=V,!0}else if(J.equals(V)===!1)return J.copy(V),!0}return!1}function A(z){const k=z.uniforms;let U=0;const H=16;for(let q=0,J=k.length;q<J;q++){const Y=Array.isArray(k[q])?k[q]:[k[q]];for(let N=0,ne=Y.length;N<ne;N++){const ye=Y[N],ge=Array.isArray(ye.value)?ye.value:[ye.value];for(let Ne=0,Ae=ge.length;Ne<Ae;Ne++){const ve=ge[Ne],Se=L(ve),Me=U%H,Ue=Me%Se.boundary,Qe=Me+Ue;U+=Ue,Qe!==0&&H-Qe<Se.storage&&(U+=H-Qe),ye.__data=new Float32Array(Se.storage/Float32Array.BYTES_PER_ELEMENT),ye.__offset=U,U+=Se.storage}}}const V=U%H;return V>0&&(U+=H-V),z.__size=U,z.__cache={},this}function L(z){const k={boundary:0,storage:0};return typeof z=="number"||typeof z=="boolean"?(k.boundary=4,k.storage=4):z.isVector2?(k.boundary=8,k.storage=8):z.isVector3||z.isColor?(k.boundary=16,k.storage=12):z.isVector4?(k.boundary=16,k.storage=16):z.isMatrix3?(k.boundary=48,k.storage=48):z.isMatrix4?(k.boundary=64,k.storage=64):z.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",z),k}function I(z){const k=z.target;k.removeEventListener("dispose",I);const U=c.indexOf(k.__bindingPointIndex);c.splice(U,1),e.deleteBuffer(i[k.id]),delete i[k.id],delete a[k.id]}function T(){for(const z in i)e.deleteBuffer(i[z]);c=[],i={},a={}}return{bind:f,update:g,dispose:T}}class SPe{constructor(t={}){const{canvas:n=QSe(),context:r=null,depth:i=!0,stencil:a=!1,alpha:c=!1,antialias:o=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:g=!1,powerPreference:_="default",failIfMajorPerformanceCaveat:x=!1,reverseDepthBuffer:M=!1}=t;this.isWebGLRenderer=!0;let C;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");C=r.getContextAttributes().alpha}else C=c;const A=new Uint32Array(4),L=new Int32Array(4);let I=null,T=null;const z=[],k=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Dh,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const U=this;let H=!1;this._outputColorSpace=Ua;let V=0,q=0,J=null,Y=-1,N=null;const ne=new Fi,ye=new Fi;let ge=null;const Ne=new Br(0);let Ae=0,ve=n.width,Se=n.height,Me=1,Ue=null,Qe=null;const st=new Fi(0,0,ve,Se),ct=new Fi(0,0,ve,Se);let Xt=!1;const je=new YL;let lt=!1,Ot=!1;const ut=new jr,ot=new jr,Tt=new dt,Ct=new Fi,un={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let gn=!1;function hn(){return J===null?Me:1}let We=r;function vn(pe,nt){return n.getContext(pe,nt)}try{const pe={alpha:!0,depth:i,stencil:a,antialias:o,premultipliedAlpha:f,preserveDrawingBuffer:g,powerPreference:_,failIfMajorPerformanceCaveat:x};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${BL}`),n.addEventListener("webglcontextlost",De,!1),n.addEventListener("webglcontextrestored",ze,!1),n.addEventListener("webglcontextcreationerror",Je,!1),We===null){const nt="webgl2";if(We=vn(nt,pe),We===null)throw vn(nt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(pe){throw console.error("THREE.WebGLRenderer: "+pe.message),pe}let Ut,tn,Dt,An,an,Le,me,it,St,It,wt,Zt,Lt,kt,bn,zt,_e,te,re,Z,le,Te,Ve,fe;function xe(){Ut=new kEe(We),Ut.init(),Te=new mPe(We,Ut),tn=new EEe(We,Ut,t,Te),Dt=new fPe(We,Ut),tn.reverseDepthBuffer&&M&&Dt.buffers.depth.setReversed(!0),An=new OEe(We),an=new ePe,Le=new pPe(We,Ut,Dt,an,tn,Te,An),me=new PEe(U),it=new LEe(U),St=new VMe(We),Ve=new MEe(We,St),It=new DEe(We,St,An,Ve),wt=new NEe(We,It,St,An),re=new FEe(We,tn,Le),zt=new TEe(an),Zt=new QTe(U,me,it,Ut,tn,Ve,zt),Lt=new bPe(U,an),kt=new nPe,bn=new lPe(Ut),te=new SEe(U,me,it,Dt,wt,C,f),_e=new hPe(U,wt,tn),fe=new wPe(We,An,tn,Dt),Z=new CEe(We,Ut,An),le=new zEe(We,Ut,An),An.programs=Zt.programs,U.capabilities=tn,U.extensions=Ut,U.properties=an,U.renderLists=kt,U.shadowMap=_e,U.state=Dt,U.info=An}xe();const Re=new _Pe(U,We);this.xr=Re,this.getContext=function(){return We},this.getContextAttributes=function(){return We.getContextAttributes()},this.forceContextLoss=function(){const pe=Ut.get("WEBGL_lose_context");pe&&pe.loseContext()},this.forceContextRestore=function(){const pe=Ut.get("WEBGL_lose_context");pe&&pe.restoreContext()},this.getPixelRatio=function(){return Me},this.setPixelRatio=function(pe){pe!==void 0&&(Me=pe,this.setSize(ve,Se,!1))},this.getSize=function(pe){return pe.set(ve,Se)},this.setSize=function(pe,nt,vt=!0){if(Re.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ve=pe,Se=nt,n.width=Math.floor(pe*Me),n.height=Math.floor(nt*Me),vt===!0&&(n.style.width=pe+"px",n.style.height=nt+"px"),this.setViewport(0,0,pe,nt)},this.getDrawingBufferSize=function(pe){return pe.set(ve*Me,Se*Me).floor()},this.setDrawingBufferSize=function(pe,nt,vt){ve=pe,Se=nt,Me=vt,n.width=Math.floor(pe*vt),n.height=Math.floor(nt*vt),this.setViewport(0,0,pe,nt)},this.getCurrentViewport=function(pe){return pe.copy(ne)},this.getViewport=function(pe){return pe.copy(st)},this.setViewport=function(pe,nt,vt,ft){pe.isVector4?st.set(pe.x,pe.y,pe.z,pe.w):st.set(pe,nt,vt,ft),Dt.viewport(ne.copy(st).multiplyScalar(Me).round())},this.getScissor=function(pe){return pe.copy(ct)},this.setScissor=function(pe,nt,vt,ft){pe.isVector4?ct.set(pe.x,pe.y,pe.z,pe.w):ct.set(pe,nt,vt,ft),Dt.scissor(ye.copy(ct).multiplyScalar(Me).round())},this.getScissorTest=function(){return Xt},this.setScissorTest=function(pe){Dt.setScissorTest(Xt=pe)},this.setOpaqueSort=function(pe){Ue=pe},this.setTransparentSort=function(pe){Qe=pe},this.getClearColor=function(pe){return pe.copy(te.getClearColor())},this.setClearColor=function(){te.setClearColor(...arguments)},this.getClearAlpha=function(){return te.getClearAlpha()},this.setClearAlpha=function(){te.setClearAlpha(...arguments)},this.clear=function(pe=!0,nt=!0,vt=!0){let ft=0;if(pe){let at=!1;if(J!==null){const Kt=J.texture.format;at=Kt===GL||Kt===HL||Kt===jL}if(at){const Kt=J.texture.type,fn=Kt===gu||Kt===$f||Kt===v_||Kt===y_||Kt===$L||Kt===VL,Qt=te.getClearColor(),ln=te.getClearAlpha(),Nt=Qt.r,zn=Qt.g,_n=Qt.b;fn?(A[0]=Nt,A[1]=zn,A[2]=_n,A[3]=ln,We.clearBufferuiv(We.COLOR,0,A)):(L[0]=Nt,L[1]=zn,L[2]=_n,L[3]=ln,We.clearBufferiv(We.COLOR,0,L))}else ft|=We.COLOR_BUFFER_BIT}nt&&(ft|=We.DEPTH_BUFFER_BIT),vt&&(ft|=We.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),We.clear(ft)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",De,!1),n.removeEventListener("webglcontextrestored",ze,!1),n.removeEventListener("webglcontextcreationerror",Je,!1),te.dispose(),kt.dispose(),bn.dispose(),an.dispose(),me.dispose(),it.dispose(),wt.dispose(),Ve.dispose(),fe.dispose(),Zt.dispose(),Re.dispose(),Re.removeEventListener("sessionstart",At),Re.removeEventListener("sessionend",Ht),Yt.stop()};function De(pe){pe.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function ze(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1;const pe=An.autoReset,nt=_e.enabled,vt=_e.autoUpdate,ft=_e.needsUpdate,at=_e.type;xe(),An.autoReset=pe,_e.enabled=nt,_e.autoUpdate=vt,_e.needsUpdate=ft,_e.type=at}function Je(pe){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",pe.statusMessage)}function Oe(pe){const nt=pe.target;nt.removeEventListener("dispose",Oe),Et(nt)}function Et(pe){Ft(pe),an.remove(pe)}function Ft(pe){const nt=an.get(pe).programs;nt!==void 0&&(nt.forEach(function(vt){Zt.releaseProgram(vt)}),pe.isShaderMaterial&&Zt.releaseShaderCache(pe))}this.renderBufferDirect=function(pe,nt,vt,ft,at,Kt){nt===null&&(nt=un);const fn=at.isMesh&&at.matrixWorld.determinant()<0,Qt=Ze(pe,nt,vt,ft,at);Dt.setMaterial(ft,fn);let ln=vt.index,Nt=1;if(ft.wireframe===!0){if(ln=It.getWireframeAttribute(vt),ln===void 0)return;Nt=2}const zn=vt.drawRange,_n=vt.attributes.position;let Rn=zn.start*Nt,jn=(zn.start+zn.count)*Nt;Kt!==null&&(Rn=Math.max(Rn,Kt.start*Nt),jn=Math.min(jn,(Kt.start+Kt.count)*Nt)),ln!==null?(Rn=Math.max(Rn,0),jn=Math.min(jn,ln.count)):_n!=null&&(Rn=Math.max(Rn,0),jn=Math.min(jn,_n.count));const fr=jn-Rn;if(fr<0||fr===1/0)return;Ve.setup(at,ft,Qt,vt,ln);let pr,Yn=Z;if(ln!==null&&(pr=St.get(ln),Yn=le,Yn.setIndex(pr)),at.isMesh)ft.wireframe===!0?(Dt.setLineWidth(ft.wireframeLinewidth*hn()),Yn.setMode(We.LINES)):Yn.setMode(We.TRIANGLES);else if(at.isLine){let Hn=ft.linewidth;Hn===void 0&&(Hn=1),Dt.setLineWidth(Hn*hn()),at.isLineSegments?Yn.setMode(We.LINES):at.isLineLoop?Yn.setMode(We.LINE_LOOP):Yn.setMode(We.LINE_STRIP)}else at.isPoints?Yn.setMode(We.POINTS):at.isSprite&&Yn.setMode(We.TRIANGLES);if(at.isBatchedMesh)if(at._multiDrawInstances!==null)bw("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Yn.renderMultiDrawInstances(at._multiDrawStarts,at._multiDrawCounts,at._multiDrawCount,at._multiDrawInstances);else if(Ut.get("WEBGL_multi_draw"))Yn.renderMultiDraw(at._multiDrawStarts,at._multiDrawCounts,at._multiDrawCount);else{const Hn=at._multiDrawStarts,Qr=at._multiDrawCounts,Sr=at._multiDrawCount,Xo=ln?St.get(ln).bytesPerElement:1,Es=an.get(ft).currentProgram.getUniforms();for(let Io=0;Io<Sr;Io++)Es.setValue(We,"_gl_DrawID",Io),Yn.render(Hn[Io]/Xo,Qr[Io])}else if(at.isInstancedMesh)Yn.renderInstances(Rn,fr,at.count);else if(vt.isInstancedBufferGeometry){const Hn=vt._maxInstanceCount!==void 0?vt._maxInstanceCount:1/0,Qr=Math.min(vt.instanceCount,Hn);Yn.renderInstances(Rn,fr,Qr)}else Yn.render(Rn,fr)};function be(pe,nt,vt){pe.transparent===!0&&pe.side===Jc&&pe.forceSinglePass===!1?(pe.side=Hs,pe.needsUpdate=!0,cn(pe,nt,vt),pe.side=Xh,pe.needsUpdate=!0,cn(pe,nt,vt),pe.side=Jc):cn(pe,nt,vt)}this.compile=function(pe,nt,vt=null){vt===null&&(vt=pe),T=bn.get(vt),T.init(nt),k.push(T),vt.traverseVisible(function(at){at.isLight&&at.layers.test(nt.layers)&&(T.pushLight(at),at.castShadow&&T.pushShadow(at))}),pe!==vt&&pe.traverseVisible(function(at){at.isLight&&at.layers.test(nt.layers)&&(T.pushLight(at),at.castShadow&&T.pushShadow(at))}),T.setupLights();const ft=new Set;return pe.traverse(function(at){if(!(at.isMesh||at.isPoints||at.isLine||at.isSprite))return;const Kt=at.material;if(Kt)if(Array.isArray(Kt))for(let fn=0;fn<Kt.length;fn++){const Qt=Kt[fn];be(Qt,vt,at),ft.add(Qt)}else be(Kt,vt,at),ft.add(Kt)}),T=k.pop(),ft},this.compileAsync=function(pe,nt,vt=null){const ft=this.compile(pe,nt,vt);return new Promise(at=>{function Kt(){if(ft.forEach(function(fn){an.get(fn).currentProgram.isReady()&&ft.delete(fn)}),ft.size===0){at(pe);return}setTimeout(Kt,10)}Ut.get("KHR_parallel_shader_compile")!==null?Kt():setTimeout(Kt,10)})};let qe=null;function tt(pe){qe&&qe(pe)}function At(){Yt.stop()}function Ht(){Yt.start()}const Yt=new k7;Yt.setAnimationLoop(tt),typeof self<"u"&&Yt.setContext(self),this.setAnimationLoop=function(pe){qe=pe,Re.setAnimationLoop(pe),pe===null?Yt.stop():Yt.start()},Re.addEventListener("sessionstart",At),Re.addEventListener("sessionend",Ht),this.render=function(pe,nt){if(nt!==void 0&&nt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(H===!0)return;if(pe.matrixWorldAutoUpdate===!0&&pe.updateMatrixWorld(),nt.parent===null&&nt.matrixWorldAutoUpdate===!0&&nt.updateMatrixWorld(),Re.enabled===!0&&Re.isPresenting===!0&&(Re.cameraAutoUpdate===!0&&Re.updateCamera(nt),nt=Re.getCamera()),pe.isScene===!0&&pe.onBeforeRender(U,pe,nt,J),T=bn.get(pe,k.length),T.init(nt),k.push(T),ot.multiplyMatrices(nt.projectionMatrix,nt.matrixWorldInverse),je.setFromProjectionMatrix(ot),Ot=this.localClippingEnabled,lt=zt.init(this.clippingPlanes,Ot),I=kt.get(pe,z.length),I.init(),z.push(I),Re.enabled===!0&&Re.isPresenting===!0){const Kt=U.xr.getDepthSensingMesh();Kt!==null&&qt(Kt,nt,-1/0,U.sortObjects)}qt(pe,nt,0,U.sortObjects),I.finish(),U.sortObjects===!0&&I.sort(Ue,Qe),gn=Re.enabled===!1||Re.isPresenting===!1||Re.hasDepthSensing()===!1,gn&&te.addToRenderList(I,pe),this.info.render.frame++,lt===!0&&zt.beginShadows();const vt=T.state.shadowsArray;_e.render(vt,pe,nt),lt===!0&&zt.endShadows(),this.info.autoReset===!0&&this.info.reset();const ft=I.opaque,at=I.transmissive;if(T.setupLights(),nt.isArrayCamera){const Kt=nt.cameras;if(at.length>0)for(let fn=0,Qt=Kt.length;fn<Qt;fn++){const ln=Kt[fn];yn(ft,at,pe,ln)}gn&&te.render(pe);for(let fn=0,Qt=Kt.length;fn<Qt;fn++){const ln=Kt[fn];Gt(I,pe,ln,ln.viewport)}}else at.length>0&&yn(ft,at,pe,nt),gn&&te.render(pe),Gt(I,pe,nt);J!==null&&q===0&&(Le.updateMultisampleRenderTarget(J),Le.updateRenderTargetMipmap(J)),pe.isScene===!0&&pe.onAfterRender(U,pe,nt),Ve.resetDefaultState(),Y=-1,N=null,k.pop(),k.length>0?(T=k[k.length-1],lt===!0&&zt.setGlobalState(U.clippingPlanes,T.state.camera)):T=null,z.pop(),z.length>0?I=z[z.length-1]:I=null};function qt(pe,nt,vt,ft){if(pe.visible===!1)return;if(pe.layers.test(nt.layers)){if(pe.isGroup)vt=pe.renderOrder;else if(pe.isLOD)pe.autoUpdate===!0&&pe.update(nt);else if(pe.isLight)T.pushLight(pe),pe.castShadow&&T.pushShadow(pe);else if(pe.isSprite){if(!pe.frustumCulled||je.intersectsSprite(pe)){ft&&Ct.setFromMatrixPosition(pe.matrixWorld).applyMatrix4(ot);const fn=wt.update(pe),Qt=pe.material;Qt.visible&&I.push(pe,fn,Qt,vt,Ct.z,null)}}else if((pe.isMesh||pe.isLine||pe.isPoints)&&(!pe.frustumCulled||je.intersectsObject(pe))){const fn=wt.update(pe),Qt=pe.material;if(ft&&(pe.boundingSphere!==void 0?(pe.boundingSphere===null&&pe.computeBoundingSphere(),Ct.copy(pe.boundingSphere.center)):(fn.boundingSphere===null&&fn.computeBoundingSphere(),Ct.copy(fn.boundingSphere.center)),Ct.applyMatrix4(pe.matrixWorld).applyMatrix4(ot)),Array.isArray(Qt)){const ln=fn.groups;for(let Nt=0,zn=ln.length;Nt<zn;Nt++){const _n=ln[Nt],Rn=Qt[_n.materialIndex];Rn&&Rn.visible&&I.push(pe,fn,Rn,vt,Ct.z,_n)}}else Qt.visible&&I.push(pe,fn,Qt,vt,Ct.z,null)}}const Kt=pe.children;for(let fn=0,Qt=Kt.length;fn<Qt;fn++)qt(Kt[fn],nt,vt,ft)}function Gt(pe,nt,vt,ft){const at=pe.opaque,Kt=pe.transmissive,fn=pe.transparent;T.setupLightsView(vt),lt===!0&&zt.setGlobalState(U.clippingPlanes,vt),ft&&Dt.viewport(ne.copy(ft)),at.length>0&&gt(at,nt,vt),Kt.length>0&&gt(Kt,nt,vt),fn.length>0&&gt(fn,nt,vt),Dt.buffers.depth.setTest(!0),Dt.buffers.depth.setMask(!0),Dt.buffers.color.setMask(!0),Dt.setPolygonOffset(!1)}function yn(pe,nt,vt,ft){if((vt.isScene===!0?vt.overrideMaterial:null)!==null)return;T.state.transmissionRenderTarget[ft.id]===void 0&&(T.state.transmissionRenderTarget[ft.id]=new Zh(1,1,{generateMipmaps:!0,type:Ut.has("EXT_color_buffer_half_float")||Ut.has("EXT_color_buffer_float")?dx:gu,minFilter:wh,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Tr.workingColorSpace}));const Kt=T.state.transmissionRenderTarget[ft.id],fn=ft.viewport||ne;Kt.setSize(fn.z*U.transmissionResolutionScale,fn.w*U.transmissionResolutionScale);const Qt=U.getRenderTarget();U.setRenderTarget(Kt),U.getClearColor(Ne),Ae=U.getClearAlpha(),Ae<1&&U.setClearColor(16777215,.5),U.clear(),gn&&te.render(vt);const ln=U.toneMapping;U.toneMapping=Dh;const Nt=ft.viewport;if(ft.viewport!==void 0&&(ft.viewport=void 0),T.setupLightsView(ft),lt===!0&&zt.setGlobalState(U.clippingPlanes,ft),gt(pe,vt,ft),Le.updateMultisampleRenderTarget(Kt),Le.updateRenderTargetMipmap(Kt),Ut.has("WEBGL_multisampled_render_to_texture")===!1){let zn=!1;for(let _n=0,Rn=nt.length;_n<Rn;_n++){const jn=nt[_n],fr=jn.object,pr=jn.geometry,Yn=jn.material,Hn=jn.group;if(Yn.side===Jc&&fr.layers.test(ft.layers)){const Qr=Yn.side;Yn.side=Hs,Yn.needsUpdate=!0,In(fr,vt,ft,pr,Yn,Hn),Yn.side=Qr,Yn.needsUpdate=!0,zn=!0}}zn===!0&&(Le.updateMultisampleRenderTarget(Kt),Le.updateRenderTargetMipmap(Kt))}U.setRenderTarget(Qt),U.setClearColor(Ne,Ae),Nt!==void 0&&(ft.viewport=Nt),U.toneMapping=ln}function gt(pe,nt,vt){const ft=nt.isScene===!0?nt.overrideMaterial:null;for(let at=0,Kt=pe.length;at<Kt;at++){const fn=pe[at],Qt=fn.object,ln=fn.geometry,Nt=fn.group;let zn=fn.material;zn.allowOverride===!0&&ft!==null&&(zn=ft),Qt.layers.test(vt.layers)&&In(Qt,nt,vt,ln,zn,Nt)}}function In(pe,nt,vt,ft,at,Kt){pe.onBeforeRender(U,nt,vt,ft,at,Kt),pe.modelViewMatrix.multiplyMatrices(vt.matrixWorldInverse,pe.matrixWorld),pe.normalMatrix.getNormalMatrix(pe.modelViewMatrix),at.onBeforeRender(U,nt,vt,ft,pe,Kt),at.transparent===!0&&at.side===Jc&&at.forceSinglePass===!1?(at.side=Hs,at.needsUpdate=!0,U.renderBufferDirect(vt,nt,ft,at,pe,Kt),at.side=Xh,at.needsUpdate=!0,U.renderBufferDirect(vt,nt,ft,at,pe,Kt),at.side=Jc):U.renderBufferDirect(vt,nt,ft,at,pe,Kt),pe.onAfterRender(U,nt,vt,ft,at,Kt)}function cn(pe,nt,vt){nt.isScene!==!0&&(nt=un);const ft=an.get(pe),at=T.state.lights,Kt=T.state.shadowsArray,fn=at.state.version,Qt=Zt.getParameters(pe,at.state,Kt,nt,vt),ln=Zt.getProgramCacheKey(Qt);let Nt=ft.programs;ft.environment=pe.isMeshStandardMaterial?nt.environment:null,ft.fog=nt.fog,ft.envMap=(pe.isMeshStandardMaterial?it:me).get(pe.envMap||ft.environment),ft.envMapRotation=ft.environment!==null&&pe.envMap===null?nt.environmentRotation:pe.envMapRotation,Nt===void 0&&(pe.addEventListener("dispose",Oe),Nt=new Map,ft.programs=Nt);let zn=Nt.get(ln);if(zn!==void 0){if(ft.currentProgram===zn&&ft.lightsStateVersion===fn)return xt(pe,Qt),zn}else Qt.uniforms=Zt.getUniforms(pe),pe.onBeforeCompile(Qt,U),zn=Zt.acquireProgram(Qt,ln),Nt.set(ln,zn),ft.uniforms=Qt.uniforms;const _n=ft.uniforms;return(!pe.isShaderMaterial&&!pe.isRawShaderMaterial||pe.clipping===!0)&&(_n.clippingPlanes=zt.uniform),xt(pe,Qt),ft.needsLights=Wt(pe),ft.lightsStateVersion=fn,ft.needsLights&&(_n.ambientLightColor.value=at.state.ambient,_n.lightProbe.value=at.state.probe,_n.directionalLights.value=at.state.directional,_n.directionalLightShadows.value=at.state.directionalShadow,_n.spotLights.value=at.state.spot,_n.spotLightShadows.value=at.state.spotShadow,_n.rectAreaLights.value=at.state.rectArea,_n.ltc_1.value=at.state.rectAreaLTC1,_n.ltc_2.value=at.state.rectAreaLTC2,_n.pointLights.value=at.state.point,_n.pointLightShadows.value=at.state.pointShadow,_n.hemisphereLights.value=at.state.hemi,_n.directionalShadowMap.value=at.state.directionalShadowMap,_n.directionalShadowMatrix.value=at.state.directionalShadowMatrix,_n.spotShadowMap.value=at.state.spotShadowMap,_n.spotLightMatrix.value=at.state.spotLightMatrix,_n.spotLightMap.value=at.state.spotLightMap,_n.pointShadowMap.value=at.state.pointShadowMap,_n.pointShadowMatrix.value=at.state.pointShadowMatrix),ft.currentProgram=zn,ft.uniformsList=null,zn}function Nn(pe){if(pe.uniformsList===null){const nt=pe.currentProgram.getUniforms();pe.uniformsList=ww.seqWithValue(nt.seq,pe.uniforms)}return pe.uniformsList}function xt(pe,nt){const vt=an.get(pe);vt.outputColorSpace=nt.outputColorSpace,vt.batching=nt.batching,vt.batchingColor=nt.batchingColor,vt.instancing=nt.instancing,vt.instancingColor=nt.instancingColor,vt.instancingMorph=nt.instancingMorph,vt.skinning=nt.skinning,vt.morphTargets=nt.morphTargets,vt.morphNormals=nt.morphNormals,vt.morphColors=nt.morphColors,vt.morphTargetsCount=nt.morphTargetsCount,vt.numClippingPlanes=nt.numClippingPlanes,vt.numIntersection=nt.numClipIntersection,vt.vertexAlphas=nt.vertexAlphas,vt.vertexTangents=nt.vertexTangents,vt.toneMapping=nt.toneMapping}function Ze(pe,nt,vt,ft,at){nt.isScene!==!0&&(nt=un),Le.resetTextureUnits();const Kt=nt.fog,fn=ft.isMeshStandardMaterial?nt.environment:null,Qt=J===null?U.outputColorSpace:J.isXRRenderTarget===!0?J.texture.colorSpace:Vf,ln=(ft.isMeshStandardMaterial?it:me).get(ft.envMap||fn),Nt=ft.vertexColors===!0&&!!vt.attributes.color&&vt.attributes.color.itemSize===4,zn=!!vt.attributes.tangent&&(!!ft.normalMap||ft.anisotropy>0),_n=!!vt.morphAttributes.position,Rn=!!vt.morphAttributes.normal,jn=!!vt.morphAttributes.color;let fr=Dh;ft.toneMapped&&(J===null||J.isXRRenderTarget===!0)&&(fr=U.toneMapping);const pr=vt.morphAttributes.position||vt.morphAttributes.normal||vt.morphAttributes.color,Yn=pr!==void 0?pr.length:0,Hn=an.get(ft),Qr=T.state.lights;if(lt===!0&&(Ot===!0||pe!==N)){const $i=pe===N&&ft.id===Y;zt.setState(ft,pe,$i)}let Sr=!1;ft.version===Hn.__version?(Hn.needsLights&&Hn.lightsStateVersion!==Qr.state.version||Hn.outputColorSpace!==Qt||at.isBatchedMesh&&Hn.batching===!1||!at.isBatchedMesh&&Hn.batching===!0||at.isBatchedMesh&&Hn.batchingColor===!0&&at.colorTexture===null||at.isBatchedMesh&&Hn.batchingColor===!1&&at.colorTexture!==null||at.isInstancedMesh&&Hn.instancing===!1||!at.isInstancedMesh&&Hn.instancing===!0||at.isSkinnedMesh&&Hn.skinning===!1||!at.isSkinnedMesh&&Hn.skinning===!0||at.isInstancedMesh&&Hn.instancingColor===!0&&at.instanceColor===null||at.isInstancedMesh&&Hn.instancingColor===!1&&at.instanceColor!==null||at.isInstancedMesh&&Hn.instancingMorph===!0&&at.morphTexture===null||at.isInstancedMesh&&Hn.instancingMorph===!1&&at.morphTexture!==null||Hn.envMap!==ln||ft.fog===!0&&Hn.fog!==Kt||Hn.numClippingPlanes!==void 0&&(Hn.numClippingPlanes!==zt.numPlanes||Hn.numIntersection!==zt.numIntersection)||Hn.vertexAlphas!==Nt||Hn.vertexTangents!==zn||Hn.morphTargets!==_n||Hn.morphNormals!==Rn||Hn.morphColors!==jn||Hn.toneMapping!==fr||Hn.morphTargetsCount!==Yn)&&(Sr=!0):(Sr=!0,Hn.__version=ft.version);let Xo=Hn.currentProgram;Sr===!0&&(Xo=cn(ft,nt,at));let Es=!1,Io=!1,Fl=!1;const Er=Xo.getUniforms(),mo=Hn.uniforms;if(Dt.useProgram(Xo.program)&&(Es=!0,Io=!0,Fl=!0),ft.id!==Y&&(Y=ft.id,Io=!0),Es||N!==pe){Dt.buffers.depth.getReversed()?(ut.copy(pe.projectionMatrix),tMe(ut),nMe(ut),Er.setValue(We,"projectionMatrix",ut)):Er.setValue(We,"projectionMatrix",pe.projectionMatrix),Er.setValue(We,"viewMatrix",pe.matrixWorldInverse);const Ri=Er.map.cameraPosition;Ri!==void 0&&Ri.setValue(We,Tt.setFromMatrixPosition(pe.matrixWorld)),tn.logarithmicDepthBuffer&&Er.setValue(We,"logDepthBufFC",2/(Math.log(pe.far+1)/Math.LN2)),(ft.isMeshPhongMaterial||ft.isMeshToonMaterial||ft.isMeshLambertMaterial||ft.isMeshBasicMaterial||ft.isMeshStandardMaterial||ft.isShaderMaterial)&&Er.setValue(We,"isOrthographic",pe.isOrthographicCamera===!0),N!==pe&&(N=pe,Io=!0,Fl=!0)}if(at.isSkinnedMesh){Er.setOptional(We,at,"bindMatrix"),Er.setOptional(We,at,"bindMatrixInverse");const $i=at.skeleton;$i&&($i.boneTexture===null&&$i.computeBoneTexture(),Er.setValue(We,"boneTexture",$i.boneTexture,Le))}at.isBatchedMesh&&(Er.setOptional(We,at,"batchingTexture"),Er.setValue(We,"batchingTexture",at._matricesTexture,Le),Er.setOptional(We,at,"batchingIdTexture"),Er.setValue(We,"batchingIdTexture",at._indirectTexture,Le),Er.setOptional(We,at,"batchingColorTexture"),at._colorsTexture!==null&&Er.setValue(We,"batchingColorTexture",at._colorsTexture,Le));const go=vt.morphAttributes;if((go.position!==void 0||go.normal!==void 0||go.color!==void 0)&&re.update(at,vt,Xo),(Io||Hn.receiveShadow!==at.receiveShadow)&&(Hn.receiveShadow=at.receiveShadow,Er.setValue(We,"receiveShadow",at.receiveShadow)),ft.isMeshGouraudMaterial&&ft.envMap!==null&&(mo.envMap.value=ln,mo.flipEnvMap.value=ln.isCubeTexture&&ln.isRenderTargetTexture===!1?-1:1),ft.isMeshStandardMaterial&&ft.envMap===null&&nt.environment!==null&&(mo.envMapIntensity.value=nt.environmentIntensity),Io&&(Er.setValue(We,"toneMappingExposure",U.toneMappingExposure),Hn.needsLights&&Rt(mo,Fl),Kt&&ft.fog===!0&&Lt.refreshFogUniforms(mo,Kt),Lt.refreshMaterialUniforms(mo,ft,Me,Se,T.state.transmissionRenderTarget[pe.id]),ww.upload(We,Nn(Hn),mo,Le)),ft.isShaderMaterial&&ft.uniformsNeedUpdate===!0&&(ww.upload(We,Nn(Hn),mo,Le),ft.uniformsNeedUpdate=!1),ft.isSpriteMaterial&&Er.setValue(We,"center",at.center),Er.setValue(We,"modelViewMatrix",at.modelViewMatrix),Er.setValue(We,"normalMatrix",at.normalMatrix),Er.setValue(We,"modelMatrix",at.matrixWorld),ft.isShaderMaterial||ft.isRawShaderMaterial){const $i=ft.uniformsGroups;for(let Ri=0,Nl=$i.length;Ri<Nl;Ri++){const Vi=$i[Ri];fe.update(Vi,Xo),fe.bind(Vi,Xo)}}return Xo}function Rt(pe,nt){pe.ambientLightColor.needsUpdate=nt,pe.lightProbe.needsUpdate=nt,pe.directionalLights.needsUpdate=nt,pe.directionalLightShadows.needsUpdate=nt,pe.pointLights.needsUpdate=nt,pe.pointLightShadows.needsUpdate=nt,pe.spotLights.needsUpdate=nt,pe.spotLightShadows.needsUpdate=nt,pe.rectAreaLights.needsUpdate=nt,pe.hemisphereLights.needsUpdate=nt}function Wt(pe){return pe.isMeshLambertMaterial||pe.isMeshToonMaterial||pe.isMeshPhongMaterial||pe.isMeshStandardMaterial||pe.isShadowMaterial||pe.isShaderMaterial&&pe.lights===!0}this.getActiveCubeFace=function(){return V},this.getActiveMipmapLevel=function(){return q},this.getRenderTarget=function(){return J},this.setRenderTargetTextures=function(pe,nt,vt){const ft=an.get(pe);ft.__autoAllocateDepthBuffer=pe.resolveDepthBuffer===!1,ft.__autoAllocateDepthBuffer===!1&&(ft.__useRenderToTexture=!1),an.get(pe.texture).__webglTexture=nt,an.get(pe.depthTexture).__webglTexture=ft.__autoAllocateDepthBuffer?void 0:vt,ft.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(pe,nt){const vt=an.get(pe);vt.__webglFramebuffer=nt,vt.__useDefaultFramebuffer=nt===void 0};const pn=We.createFramebuffer();this.setRenderTarget=function(pe,nt=0,vt=0){J=pe,V=nt,q=vt;let ft=!0,at=null,Kt=!1,fn=!1;if(pe){const ln=an.get(pe);if(ln.__useDefaultFramebuffer!==void 0)Dt.bindFramebuffer(We.FRAMEBUFFER,null),ft=!1;else if(ln.__webglFramebuffer===void 0)Le.setupRenderTarget(pe);else if(ln.__hasExternalTextures)Le.rebindTextures(pe,an.get(pe.texture).__webglTexture,an.get(pe.depthTexture).__webglTexture);else if(pe.depthBuffer){const _n=pe.depthTexture;if(ln.__boundDepthTexture!==_n){if(_n!==null&&an.has(_n)&&(pe.width!==_n.image.width||pe.height!==_n.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Le.setupDepthRenderbuffer(pe)}}const Nt=pe.texture;(Nt.isData3DTexture||Nt.isDataArrayTexture||Nt.isCompressedArrayTexture)&&(fn=!0);const zn=an.get(pe).__webglFramebuffer;pe.isWebGLCubeRenderTarget?(Array.isArray(zn[nt])?at=zn[nt][vt]:at=zn[nt],Kt=!0):pe.samples>0&&Le.useMultisampledRTT(pe)===!1?at=an.get(pe).__webglMultisampledFramebuffer:Array.isArray(zn)?at=zn[vt]:at=zn,ne.copy(pe.viewport),ye.copy(pe.scissor),ge=pe.scissorTest}else ne.copy(st).multiplyScalar(Me).floor(),ye.copy(ct).multiplyScalar(Me).floor(),ge=Xt;if(vt!==0&&(at=pn),Dt.bindFramebuffer(We.FRAMEBUFFER,at)&&ft&&Dt.drawBuffers(pe,at),Dt.viewport(ne),Dt.scissor(ye),Dt.setScissorTest(ge),Kt){const ln=an.get(pe.texture);We.framebufferTexture2D(We.FRAMEBUFFER,We.COLOR_ATTACHMENT0,We.TEXTURE_CUBE_MAP_POSITIVE_X+nt,ln.__webglTexture,vt)}else if(fn){const ln=an.get(pe.texture),Nt=nt;We.framebufferTextureLayer(We.FRAMEBUFFER,We.COLOR_ATTACHMENT0,ln.__webglTexture,vt,Nt)}else if(pe!==null&&vt!==0){const ln=an.get(pe.texture);We.framebufferTexture2D(We.FRAMEBUFFER,We.COLOR_ATTACHMENT0,We.TEXTURE_2D,ln.__webglTexture,vt)}Y=-1},this.readRenderTargetPixels=function(pe,nt,vt,ft,at,Kt,fn){if(!(pe&&pe.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Qt=an.get(pe).__webglFramebuffer;if(pe.isWebGLCubeRenderTarget&&fn!==void 0&&(Qt=Qt[fn]),Qt){Dt.bindFramebuffer(We.FRAMEBUFFER,Qt);try{const ln=pe.texture,Nt=ln.format,zn=ln.type;if(!tn.textureFormatReadable(Nt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!tn.textureTypeReadable(zn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}nt>=0&&nt<=pe.width-ft&&vt>=0&&vt<=pe.height-at&&We.readPixels(nt,vt,ft,at,Te.convert(Nt),Te.convert(zn),Kt)}finally{const ln=J!==null?an.get(J).__webglFramebuffer:null;Dt.bindFramebuffer(We.FRAMEBUFFER,ln)}}},this.readRenderTargetPixelsAsync=async function(pe,nt,vt,ft,at,Kt,fn){if(!(pe&&pe.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Qt=an.get(pe).__webglFramebuffer;if(pe.isWebGLCubeRenderTarget&&fn!==void 0&&(Qt=Qt[fn]),Qt)if(nt>=0&&nt<=pe.width-ft&&vt>=0&&vt<=pe.height-at){Dt.bindFramebuffer(We.FRAMEBUFFER,Qt);const ln=pe.texture,Nt=ln.format,zn=ln.type;if(!tn.textureFormatReadable(Nt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!tn.textureTypeReadable(zn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const _n=We.createBuffer();We.bindBuffer(We.PIXEL_PACK_BUFFER,_n),We.bufferData(We.PIXEL_PACK_BUFFER,Kt.byteLength,We.STREAM_READ),We.readPixels(nt,vt,ft,at,Te.convert(Nt),Te.convert(zn),0);const Rn=J!==null?an.get(J).__webglFramebuffer:null;Dt.bindFramebuffer(We.FRAMEBUFFER,Rn);const jn=We.fenceSync(We.SYNC_GPU_COMMANDS_COMPLETE,0);return We.flush(),await eMe(We,jn,4),We.bindBuffer(We.PIXEL_PACK_BUFFER,_n),We.getBufferSubData(We.PIXEL_PACK_BUFFER,0,Kt),We.deleteBuffer(_n),We.deleteSync(jn),Kt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(pe,nt=null,vt=0){const ft=Math.pow(2,-vt),at=Math.floor(pe.image.width*ft),Kt=Math.floor(pe.image.height*ft),fn=nt!==null?nt.x:0,Qt=nt!==null?nt.y:0;Le.setTexture2D(pe,0),We.copyTexSubImage2D(We.TEXTURE_2D,vt,0,0,fn,Qt,at,Kt),Dt.unbindTexture()};const ur=We.createFramebuffer(),Xn=We.createFramebuffer();this.copyTextureToTexture=function(pe,nt,vt=null,ft=null,at=0,Kt=null){Kt===null&&(at!==0?(bw("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Kt=at,at=0):Kt=0);let fn,Qt,ln,Nt,zn,_n,Rn,jn,fr;const pr=pe.isCompressedTexture?pe.mipmaps[Kt]:pe.image;if(vt!==null)fn=vt.max.x-vt.min.x,Qt=vt.max.y-vt.min.y,ln=vt.isBox3?vt.max.z-vt.min.z:1,Nt=vt.min.x,zn=vt.min.y,_n=vt.isBox3?vt.min.z:0;else{const go=Math.pow(2,-at);fn=Math.floor(pr.width*go),Qt=Math.floor(pr.height*go),pe.isDataArrayTexture?ln=pr.depth:pe.isData3DTexture?ln=Math.floor(pr.depth*go):ln=1,Nt=0,zn=0,_n=0}ft!==null?(Rn=ft.x,jn=ft.y,fr=ft.z):(Rn=0,jn=0,fr=0);const Yn=Te.convert(nt.format),Hn=Te.convert(nt.type);let Qr;nt.isData3DTexture?(Le.setTexture3D(nt,0),Qr=We.TEXTURE_3D):nt.isDataArrayTexture||nt.isCompressedArrayTexture?(Le.setTexture2DArray(nt,0),Qr=We.TEXTURE_2D_ARRAY):(Le.setTexture2D(nt,0),Qr=We.TEXTURE_2D),We.pixelStorei(We.UNPACK_FLIP_Y_WEBGL,nt.flipY),We.pixelStorei(We.UNPACK_PREMULTIPLY_ALPHA_WEBGL,nt.premultiplyAlpha),We.pixelStorei(We.UNPACK_ALIGNMENT,nt.unpackAlignment);const Sr=We.getParameter(We.UNPACK_ROW_LENGTH),Xo=We.getParameter(We.UNPACK_IMAGE_HEIGHT),Es=We.getParameter(We.UNPACK_SKIP_PIXELS),Io=We.getParameter(We.UNPACK_SKIP_ROWS),Fl=We.getParameter(We.UNPACK_SKIP_IMAGES);We.pixelStorei(We.UNPACK_ROW_LENGTH,pr.width),We.pixelStorei(We.UNPACK_IMAGE_HEIGHT,pr.height),We.pixelStorei(We.UNPACK_SKIP_PIXELS,Nt),We.pixelStorei(We.UNPACK_SKIP_ROWS,zn),We.pixelStorei(We.UNPACK_SKIP_IMAGES,_n);const Er=pe.isDataArrayTexture||pe.isData3DTexture,mo=nt.isDataArrayTexture||nt.isData3DTexture;if(pe.isDepthTexture){const go=an.get(pe),$i=an.get(nt),Ri=an.get(go.__renderTarget),Nl=an.get($i.__renderTarget);Dt.bindFramebuffer(We.READ_FRAMEBUFFER,Ri.__webglFramebuffer),Dt.bindFramebuffer(We.DRAW_FRAMEBUFFER,Nl.__webglFramebuffer);for(let Vi=0;Vi<ln;Vi++)Er&&(We.framebufferTextureLayer(We.READ_FRAMEBUFFER,We.COLOR_ATTACHMENT0,an.get(pe).__webglTexture,at,_n+Vi),We.framebufferTextureLayer(We.DRAW_FRAMEBUFFER,We.COLOR_ATTACHMENT0,an.get(nt).__webglTexture,Kt,fr+Vi)),We.blitFramebuffer(Nt,zn,fn,Qt,Rn,jn,fn,Qt,We.DEPTH_BUFFER_BIT,We.NEAREST);Dt.bindFramebuffer(We.READ_FRAMEBUFFER,null),Dt.bindFramebuffer(We.DRAW_FRAMEBUFFER,null)}else if(at!==0||pe.isRenderTargetTexture||an.has(pe)){const go=an.get(pe),$i=an.get(nt);Dt.bindFramebuffer(We.READ_FRAMEBUFFER,ur),Dt.bindFramebuffer(We.DRAW_FRAMEBUFFER,Xn);for(let Ri=0;Ri<ln;Ri++)Er?We.framebufferTextureLayer(We.READ_FRAMEBUFFER,We.COLOR_ATTACHMENT0,go.__webglTexture,at,_n+Ri):We.framebufferTexture2D(We.READ_FRAMEBUFFER,We.COLOR_ATTACHMENT0,We.TEXTURE_2D,go.__webglTexture,at),mo?We.framebufferTextureLayer(We.DRAW_FRAMEBUFFER,We.COLOR_ATTACHMENT0,$i.__webglTexture,Kt,fr+Ri):We.framebufferTexture2D(We.DRAW_FRAMEBUFFER,We.COLOR_ATTACHMENT0,We.TEXTURE_2D,$i.__webglTexture,Kt),at!==0?We.blitFramebuffer(Nt,zn,fn,Qt,Rn,jn,fn,Qt,We.COLOR_BUFFER_BIT,We.NEAREST):mo?We.copyTexSubImage3D(Qr,Kt,Rn,jn,fr+Ri,Nt,zn,fn,Qt):We.copyTexSubImage2D(Qr,Kt,Rn,jn,Nt,zn,fn,Qt);Dt.bindFramebuffer(We.READ_FRAMEBUFFER,null),Dt.bindFramebuffer(We.DRAW_FRAMEBUFFER,null)}else mo?pe.isDataTexture||pe.isData3DTexture?We.texSubImage3D(Qr,Kt,Rn,jn,fr,fn,Qt,ln,Yn,Hn,pr.data):nt.isCompressedArrayTexture?We.compressedTexSubImage3D(Qr,Kt,Rn,jn,fr,fn,Qt,ln,Yn,pr.data):We.texSubImage3D(Qr,Kt,Rn,jn,fr,fn,Qt,ln,Yn,Hn,pr):pe.isDataTexture?We.texSubImage2D(We.TEXTURE_2D,Kt,Rn,jn,fn,Qt,Yn,Hn,pr.data):pe.isCompressedTexture?We.compressedTexSubImage2D(We.TEXTURE_2D,Kt,Rn,jn,pr.width,pr.height,Yn,pr.data):We.texSubImage2D(We.TEXTURE_2D,Kt,Rn,jn,fn,Qt,Yn,Hn,pr);We.pixelStorei(We.UNPACK_ROW_LENGTH,Sr),We.pixelStorei(We.UNPACK_IMAGE_HEIGHT,Xo),We.pixelStorei(We.UNPACK_SKIP_PIXELS,Es),We.pixelStorei(We.UNPACK_SKIP_ROWS,Io),We.pixelStorei(We.UNPACK_SKIP_IMAGES,Fl),Kt===0&&nt.generateMipmaps&&We.generateMipmap(Qr),Dt.unbindTexture()},this.copyTextureToTexture3D=function(pe,nt,vt=null,ft=null,at=0){return bw('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(pe,nt,vt,ft,at)},this.initRenderTarget=function(pe){an.get(pe).__webglFramebuffer===void 0&&Le.setupRenderTarget(pe)},this.initTexture=function(pe){pe.isCubeTexture?Le.setTextureCube(pe,0):pe.isData3DTexture?Le.setTexture3D(pe,0):pe.isDataArrayTexture||pe.isCompressedArrayTexture?Le.setTexture2DArray(pe,0):Le.setTexture2D(pe,0),Dt.unbindTexture()},this.resetState=function(){V=0,q=0,J=null,Dt.reset(),Ve.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return nu}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const n=this.getContext();n.drawingBufferColorSpace=Tr._getDrawingBufferColorSpace(t),n.unpackColorSpace=Tr._getUnpackColorSpace()}}/*!
 * Photo Sphere Viewer 5.13.4
 * @copyright 2014-2015 Jrmy Heleine
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var MPe=Object.defineProperty,QL=(e,t)=>{for(var n in t)MPe(e,n,{get:t[n],enumerable:!0})},Fg={};QL(Fg,{ACTIONS:()=>j7,ANIMATION_MIN_DURATION:()=>HI,CAPTURE_EVENTS_CLASS:()=>gx,CTRLZOOM_TIMEOUT:()=>V7,DBLCLICK_DELAY:()=>B7,EASINGS:()=>Sw,ICONS:()=>Ol,IDS:()=>$o,KEY_CODES:()=>Eo,LONGTOUCH_DELAY:()=>U7,MOVE_THRESHOLD:()=>N7,SPHERE_RADIUS:()=>jf,TWOFINGERSOVERLAY_DELAY:()=>$7,VIEWER_DATA:()=>Kh});var CPe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g><!-- Created by Flatart from the Noun Project --></svg>
`,EPe='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',TPe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/><!--Created by Michael Zenaty from the Noun Project--></svg>
`,PPe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,APe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,IPe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/><!--Created by Arafat Uddin from the Noun Project--></svg>
`,RPe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g><!-- Created by Richard Kunk from the Noun Project--></svg>
`,LPe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,kPe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,HI=500,N7=4,B7=300,U7=500,$7=100,V7=2e3,jf=10,Kh="photoSphereViewer",gx="psv--capture-event",j7=(e=>(e.ROTATE_UP="ROTATE_UP",e.ROTATE_DOWN="ROTATE_DOWN",e.ROTATE_RIGHT="ROTATE_RIGHT",e.ROTATE_LEFT="ROTATE_LEFT",e.ZOOM_IN="ZOOM_IN",e.ZOOM_OUT="ZOOM_OUT",e))(j7||{}),$o={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},Eo={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},Ol={arrow:CPe,close:EPe,download:TPe,fullscreenIn:PPe,fullscreenOut:APe,info:IPe,menu:RPe,zoomIn:LPe,zoomOut:kPe},Sw={linear:e=>e,inQuad:e=>e*e,outQuad:e=>e*(2-e),inOutQuad:e=>e<.5?2*e*e:-1+(4-2*e)*e,inCubic:e=>e*e*e,outCubic:e=>--e*e*e+1,inOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,inQuart:e=>e*e*e*e,outQuart:e=>1- --e*e*e*e,inOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,inQuint:e=>e*e*e*e*e,outQuint:e=>1+--e*e*e*e*e,inOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e,inSine:e=>1-Math.cos(e*(Math.PI/2)),outSine:e=>Math.sin(e*(Math.PI/2)),inOutSine:e=>.5-.5*Math.cos(Math.PI*e),inExpo:e=>Math.pow(2,10*(e-1)),outExpo:e=>1-Math.pow(2,-10*e),inOutExpo:e=>(e=e*2-1)<0?.5*Math.pow(2,10*e):1-.5*Math.pow(2,-10*e),inCirc:e=>1-Math.sqrt(1-e*e),outCirc:e=>Math.sqrt(1-(e-1)*(e-1)),inOutCirc:e=>(e*=2)<1?.5-.5*Math.sqrt(1-e*e):.5+.5*Math.sqrt(1-(e-=2)*e)},Dn={};QL(Dn,{Animation:()=>zS,Dynamic:()=>ey,MultiDynamic:()=>dH,PressHandler:()=>b2,Slider:()=>pH,SliderDirection:()=>fH,addClasses:()=>ek,angle:()=>G7,applyEulerInverse:()=>ZI,checkClosedShadowDom:()=>uH,checkStylesheet:()=>cH,checkVersion:()=>ok,cleanCssPosition:()=>aH,clone:()=>y2,createTexture:()=>XI,cssPositionIsOrdered:()=>ik,dasherize:()=>NPe,deepEqual:()=>iH,deepmerge:()=>nH,distance:()=>H7,exitFullscreen:()=>eH,firstNonNull:()=>uh,getAbortError:()=>WI,getAngle:()=>q7,getClosest:()=>Z7,getConfigParser:()=>x2,getElement:()=>X7,getEventTarget:()=>RS,getMatchingTarget:()=>Y7,getPosition:()=>K7,getShortestArc:()=>W7,getStyleProperty:()=>fc,getTouchData:()=>GI,getXMPValue:()=>la,greatArcDistance:()=>zPe,hasParent:()=>FPe,invertResolvableBoolean:()=>_2,isAbortError:()=>sH,isEmpty:()=>rH,isExtendedPosition:()=>rk,isFullscreenEnabled:()=>J7,isNil:()=>To,isPlainObject:()=>tk,logWarn:()=>Vo,mergePanoData:()=>hH,parseAngle:()=>sc,parsePoint:()=>BPe,parseSpeed:()=>lH,removeClasses:()=>OPe,requestFullscreen:()=>Q7,resolveBoolean:()=>nk,speedToDuration:()=>qI,sum:()=>DPe,throttle:()=>tH,toggleClass:()=>v2,wrap:()=>Cy});function Cy(e,t){let n=e%t;return n<0&&(n+=t),n}function DPe(e){return e.reduce((t,n)=>t+n,0)}function H7(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function G7(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function W7(e,t){return[0,Math.PI*2,-Math.PI*2].reduce((r,i)=>{const a=t-e+i;return Math.abs(a)<Math.abs(r)?a:r},1/0)}function q7(e,t){return Math.acos(Math.cos(e.pitch)*Math.cos(t.pitch)*Math.cos(e.yaw-t.yaw)+Math.sin(e.pitch)*Math.sin(t.pitch))}function zPe([e,t],[n,r]){e-n>Math.PI?e-=2*Math.PI:e-n<-Math.PI&&(e+=2*Math.PI);const i=(n-e)*Math.cos((t+r)/2),a=r-t;return Math.sqrt(i*i+a*a)}function X7(e){return typeof e=="string"?e.match(/^[a-z]/i)?document.getElementById(e):document.querySelector(e):e}function v2(e,t,n){n===void 0?e.classList.toggle(t):n?e.classList.add(t):n||e.classList.remove(t)}function ek(e,t){e.classList.add(...t.split(" ").filter(n=>!!n))}function OPe(e,t){e.classList.remove(...t.split(" ").filter(n=>!!n))}function FPe(e,t){let n=e;do{if(n===t)return!0;n=n.parentElement}while(n);return!1}function Z7(e,t){if(!(e!=null&&e.matches))return null;let n=e;do{if(n.matches(t))return n;n=n.parentElement}while(n);return null}function RS(e){return(e==null?void 0:e.composedPath()[0])||null}function Y7(e,t){return e?e.composedPath().find(n=>!(n instanceof HTMLElement)&&!(n instanceof SVGElement)?!1:n.matches(t)):null}function K7(e){let t=0,n=0,r=e;for(;r;)t+=r.offsetLeft-r.scrollLeft+r.clientLeft,n+=r.offsetTop-r.scrollTop+r.clientTop,r=r.offsetParent;return t-=window.scrollX,n-=window.scrollY,{x:t,y:n}}function fc(e,t){return window.getComputedStyle(e).getPropertyValue(t)}function GI(e){if(e.touches.length<2)return null;const t={x:e.touches[0].clientX,y:e.touches[0].clientY},n={x:e.touches[1].clientX,y:e.touches[1].clientY};return{distance:H7(t,n),angle:G7(t,n),center:{x:(t.x+n.x)/2,y:(t.y+n.y)/2}}}var LS;function J7(e,t=!1){return t?e===LS:document.fullscreenElement===e}function Q7(e,t=!1){t?(LS=e,e.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):e.requestFullscreen()}function eH(e=!1){e?(LS.classList.remove("psv-fullscreen-emulation"),LS=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function NPe(e){return e.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(t,n)=>(n>0?"-":"")+t.toLowerCase())}function tH(e,t){let n=!1;return function(...r){n||(n=!0,setTimeout(()=>{e.apply(this,r),n=!1},t))}}function tk(e){if(typeof e!="object"||e===null||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function nH(e,t){const n=t;return function r(i,a){return Array.isArray(a)?(!i||!Array.isArray(i)?i=[]:i.length=0,a.forEach((c,o)=>{i[o]=r(null,c)})):typeof a=="object"?((!i||Array.isArray(i))&&(i={}),Object.keys(a).forEach(c=>{c!=="__proto__"&&(typeof a[c]!="object"||!a[c]||!tk(a[c])?i[c]=a[c]:a[c]!==n&&(i[c]?r(i[c],a[c]):i[c]=r(null,a[c])))})):i=a,i}(e,t)}function y2(e){return nH(null,e)}function rH(e){return!e||Object.keys(e).length===0&&e.constructor===Object}function To(e){return e==null}function uh(...e){for(const t of e)if(!To(t))return t;return null}function iH(e,t){if(e===t)return!0;if(LB(e)&&LB(t)){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n of Object.keys(e))if(!iH(e[n],t[n]))return!1;return!0}else return!1}function LB(e){return typeof e=="object"&&e!==null}var Sn=class oH extends Error{constructor(t,n){var r;super(n&&n instanceof Error?`${t}: ${n.message}`:t),this.name="PSVError",(r=Error.captureStackTrace)==null||r.call(Error,this,oH)}};function nk(e,t){tk(e)?(t(e.initial,!0),e.promise.then(n=>t(n,!1))):t(e,!0)}function _2(e){return{initial:!e.initial,promise:e.promise.then(t=>!t)}}function WI(){const e=new Error("Loading was aborted.");return e.name="AbortError",e}function sH(e){return(e==null?void 0:e.name)==="AbortError"}function Vo(e){console.warn(`PhotoSphereViewer: ${e}`)}function rk(e){return!e||Array.isArray(e)?!1:[["textureX","textureY"],["yaw","pitch"]].some(([t,n])=>e[t]!==void 0&&e[n]!==void 0)}function la(e,t,n=!0){let r=e.match("<GPano:"+t+">(.*)</GPano:"+t+">");if(r!==null){const i=n?parseInt(r[1],10):parseFloat(r[1]);return isNaN(i)?null:i}if(r=e.match("GPano:"+t+'="(.*?)"'),r!==null){const i=n?parseInt(r[1],10):parseFloat(r[1]);return isNaN(i)?null:i}return null}var kB={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},kS=["left","center","right"],DS=["top","center","bottom"],DB=[...kS,...DS],Fa="center";function BPe(e){if(!e)return{x:.5,y:.5};if(typeof e=="object")return e;let t=e.toLocaleLowerCase().split(" ").slice(0,2);t.length===1&&(kB[t[0]]?t=[t[0],Fa]:t=[t[0],t[0]]);const n=t[1]!=="left"&&t[1]!=="right"&&t[0]!=="top"&&t[0]!=="bottom";t=t.map(i=>kB[i]||i),n||t.reverse();const r=t.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return r?{x:parseFloat(r[1])/100,y:parseFloat(r[2])/100}:{x:.5,y:.5}}function aH(e,{allowCenter:t,cssOrder:n}={allowCenter:!0,cssOrder:!0}){return e?(typeof e=="string"&&(e=e.split(" ")),e.length===1&&(e[0]===Fa?e=[Fa,Fa]:kS.indexOf(e[0])!==-1?e=[Fa,e[0]]:DS.indexOf(e[0])!==-1&&(e=[e[0],Fa])),e.length!==2||DB.indexOf(e[0])===-1||DB.indexOf(e[1])===-1?(Vo(`Unparsable position ${e}`),null):!t&&e[0]===Fa&&e[1]===Fa?(Vo("Invalid position center center"),null):(n&&!ik(e)&&(e=[e[1],e[0]]),e[1]===Fa&&kS.indexOf(e[0])!==-1&&(e=[Fa,e[0]]),e[0]===Fa&&DS.indexOf(e[1])!==-1&&(e=[e[1],Fa]),e)):null}function ik(e){return DS.indexOf(e[0])!==-1&&kS.indexOf(e[1])!==-1}function lH(e){let t;if(typeof e=="string"){const n=e.toString().trim();let r=parseFloat(n.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const i=n.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(i.match(/(pm|per minute)$/)&&(r/=60),i){case"dpm":case"degrees per minute":case"dps":case"degrees per second":t=mr.degToRad(r);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":t=r;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":t=r*Math.PI*2;break;default:throw new Sn(`Unknown speed unit "${i}"`)}}else t=e;return t}function qI(e,t){if(typeof e!="number"){const n=lH(e);return t/Math.abs(n)*1e3}else return Math.abs(e)}function sc(e,t=!1,n=t){let r;if(typeof e=="string"){const i=e.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!i)throw new Sn(`Unknown angle "${e}"`);const a=parseFloat(i[1]),c=i[2];if(c)switch(c){case"deg":case"degs":r=mr.degToRad(a);break;case"rad":case"rads":r=a;break;default:throw new Sn(`Unknown angle unit "${c}"`)}else r=a}else if(typeof e=="number"&&!isNaN(e))r=e;else throw new Sn(`Unknown angle "${e}"`);return r=Cy(t?r+Math.PI:r,Math.PI*2),t?mr.clamp(r-Math.PI,-Math.PI/(n?2:1),Math.PI/(n?2:1)):r}function XI(e,t=!1){const n=new Ho(e);return n.needsUpdate=!0,n.minFilter=t?wh:_a,n.generateMipmaps=t,n.anisotropy=t?2:1,n}var zB=new ud;function ZI(e,t){zB.setFromEuler(t).invert(),e.applyQuaternion(zB)}function x2(e,t){const n=function(r){const i=y2({...e,...r}),a={};for(let[c,o]of Object.entries(i)){if(t&&c in t)o=t[c](o,{rawConfig:i,defValue:e[c]});else if(!(c in e)){Vo(`Unknown option ${c}`);continue}a[c]=o}return a};return n.defaults=e,n.parsers=t||{},n}function cH(e,t){fc(e,`--psv-${t}-loaded`)!=="true"&&console.error(`PhotoSphereViewer: stylesheet "@photo-sphere-viewer/${t}/index.css" is not loaded`)}function ok(e,t,n){t&&t!==n&&console.error(`PhotoSphereViewer: @photo-sphere-viewer/${e} is in version ${t} but @photo-sphere-viewer/core is in version ${n}`)}function uH(e){do{if(e instanceof ShadowRoot&&e.mode==="closed"){console.error("PhotoSphereViewer: closed shadow DOM detected, the viewer might not work as expected");return}e=e.parentNode}while(e)}function hH(e,t,n,r){const i={isEquirectangular:!0,fullWidth:uh(n==null?void 0:n.fullWidth,r==null?void 0:r.fullWidth),fullHeight:uh(n==null?void 0:n.fullHeight,r==null?void 0:r.fullHeight),croppedWidth:e,croppedHeight:t,croppedX:uh(n==null?void 0:n.croppedX,r==null?void 0:r.croppedX),croppedY:uh(n==null?void 0:n.croppedY,r==null?void 0:r.croppedY),poseHeading:uh(n==null?void 0:n.poseHeading,r==null?void 0:r.poseHeading,0),posePitch:uh(n==null?void 0:n.posePitch,r==null?void 0:r.posePitch,0),poseRoll:uh(n==null?void 0:n.poseRoll,r==null?void 0:r.poseRoll,0),initialHeading:r==null?void 0:r.initialHeading,initialPitch:r==null?void 0:r.initialPitch,initialFov:r==null?void 0:r.initialFov};return!i.fullWidth&&!i.fullHeight&&(i.fullWidth=Math.max(e,t*2),i.fullHeight=Math.round(i.fullWidth/2)),i.fullWidth||(i.fullWidth=i.fullHeight*2),i.fullHeight||(i.fullHeight=Math.round(i.fullWidth/2)),i.croppedX===null&&(i.croppedX=Math.round((i.fullWidth-e)/2)),i.croppedY===null&&(i.croppedY=Math.round((i.fullHeight-t)/2)),Math.abs(i.fullWidth-i.fullHeight*2)>1&&(Vo("Invalid panoData, fullWidth should be twice fullHeight"),i.fullHeight=Math.round(i.fullWidth/2)),i.croppedX+i.croppedWidth>i.fullWidth&&(Vo("Invalid panoData, croppedX + croppedWidth > fullWidth"),i.croppedX=i.fullWidth-i.croppedWidth),i.croppedY+i.croppedHeight>i.fullHeight&&(Vo("Invalid panoData, croppedY + croppedHeight > fullHeight"),i.croppedY=i.fullHeight-i.croppedHeight),i.croppedX<0&&(Vo("Invalid panoData, croppedX < 0"),i.croppedX=0),i.croppedY<0&&(Vo("Invalid panoData, croppedY < 0"),i.croppedY=0),i}var zS=class{constructor(e){this.easing=Sw.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=e,e?(e.easing&&(this.easing=typeof e.easing=="function"?e.easing:Sw[e.easing]||Sw.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(t=>this.__run(t))},e.delay||0)):this.resolved=!0}__run(e){if(this.cancelled)return;this.start||(this.start=e);const t=(e-this.start)/this.options.duration,n={};if(t<1){for(const[r,i]of Object.entries(this.options.properties))if(i){const a=i.start+(i.end-i.start)*this.easing(t);n[r]=a}this.options.onTick(n,t),this.animationFrame=window.requestAnimationFrame(r=>this.__run(r))}else{for(const[r,i]of Object.entries(this.options.properties))i&&(n[r]=i.end);this.options.onTick(n,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(e){e?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(t=>t(e)),this.callbacks.length=0}then(e){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(e):new Promise(t=>{this.callbacks.push(t)}).then(e)}cancel(){!this.cancelled&&!this.resolved&&(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},ey=class{constructor(e,t){if(this.fn=e,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=t.min,this.max=t.max,this.wrap=t.wrap,this.current=t.defaultValue,this.wrap&&this.min!==0)throw new Sn("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(e){this.__current=e}setSpeed(e){this.speed=e}goto(e,t=1){this.mode=2,this.target=this.wrap?Cy(e,this.max):mr.clamp(e,this.min,this.max),this.speedMult=t}step(e,t=1){t===0?this.setValue(this.current+e):(this.mode!==2&&(this.target=this.current),this.goto(this.target+e,t))}roll(e=!1,t=1){this.mode=1,this.target=e?-1/0:1/0,this.speedMult=t}stop(){this.mode=0}setValue(e){return this.target=this.wrap?Cy(e,this.max):mr.clamp(e,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current?(this.current=this.target,this.fn&&this.fn(this.current),!0):!1}update(e){if(this.mode===2){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const r=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=r&&(this.mode=0)}let t=this.mode===0?0:this.speed*this.speedMult;this.target<this.current&&(t=-t),this.currentSpeed<t?this.currentSpeed=Math.min(t,this.currentSpeed+e/1e3*this.speed*this.speedMult*2):this.currentSpeed>t&&(this.currentSpeed=Math.max(t,this.currentSpeed-e/1e3*this.speed*this.speedMult*2));let n=null;return this.current>this.target&&this.currentSpeed?n=Math.max(this.target,this.current+this.currentSpeed*e/1e3):this.current<this.target&&this.currentSpeed&&(n=Math.min(this.target,this.current+this.currentSpeed*e/1e3)),n!==null&&(n=this.wrap?Cy(n,this.max):mr.clamp(n,this.min,this.max),n!==this.current)?(this.current=n,this.fn&&this.fn(this.current),!0):!1}},dH=class{constructor(e,t){this.fn=e,this.dynamics=t,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((e,[t,n])=>(e[t]=n.current,e),{})}setSpeed(e){for(const t of Object.values(this.dynamics))t.setSpeed(e)}goto(e,t=1){for(const[n,r]of Object.entries(e))this.dynamics[n].goto(r,t)}step(e,t=1){if(t===0)this.setValue(Object.keys(e).reduce((n,r)=>(n[r]=e[r]+this.dynamics[r].current,n),{}));else for(const[n,r]of Object.entries(e))this.dynamics[n].step(r,t)}roll(e,t=1){for(const[n,r]of Object.entries(e))this.dynamics[n].roll(r,t)}stop(){for(const e of Object.values(this.dynamics))e.stop()}setValue(e){let t=!1;for(const[n,r]of Object.entries(e))t=this.dynamics[n].setValue(r)||t;return t&&this.fn&&this.fn(this.current),t}update(e){let t=!1;for(const n of Object.values(this.dynamics))t=n.update(e)||t;return t&&this.fn&&this.fn(this.current),t}},b2=class{constructor(e=200){this.delay=e,this.time=0,this.delay=e}get pending(){return this.time!==0}down(e){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=new Date().getTime(),this.data=e}up(e){if(!this.time)return;Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{e(this.data),this.timeout=void 0,this.time=0,this.data=void 0},this.delay):(e(this.data),this.time=0,this.data=void 0)}},fH=(e=>(e.VERTICAL="VERTICAL",e.HORIZONTAL="HORIZONTAL",e))(fH||{}),pH=class{constructor(e,t,n){this.container=e,this.direction=t,this.listener=n,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return this.direction==="VERTICAL"}get isHorizontal(){return this.direction==="HORIZONTAL"}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(e){switch(e.type){case"click":e.stopPropagation();break;case"mousedown":this.__onMouseDown(e);break;case"mouseenter":this.__onMouseEnter(e);break;case"mouseleave":this.__onMouseLeave(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e);break}}__onMouseDown(e){this.mousedown=!0,this.__update(e.clientX,e.clientY,!0)}__onMouseEnter(e){this.mouseover=!0,this.__update(e.clientX,e.clientY,!0)}__onTouchStart(e){this.mouseover=!0,this.mousedown=!0;const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}__onMouseMove(e){(this.mousedown||this.mouseover)&&(e.stopPropagation(),this.__update(e.clientX,e.clientY,!0))}__onTouchMove(e){if(this.mousedown||this.mouseover){e.stopPropagation();const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}}__onMouseUp(e){this.mousedown&&(this.mousedown=!1,this.__update(e.clientX,e.clientY,!1))}__onMouseLeave(e){this.mouseover&&(this.mouseover=!1,this.__update(e.clientX,e.clientY,!0))}__onTouchEnd(e){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!1)}}__update(e,t,n){const r=this.container.getBoundingClientRect();let i;this.isVertical?i=mr.clamp((r.bottom-t)/r.height,0,1):i=mr.clamp((e-r.left)/r.width,0,1),this.listener({value:i,click:!n,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:e,clientY:t}})}},Fn={};QL(Fn,{BeforeAnimateEvent:()=>sk,BeforeRenderEvent:()=>Ey,BeforeRotateEvent:()=>wH,ClickEvent:()=>CH,ConfigChangedEvent:()=>Gs,DoubleClickEvent:()=>IH,FullscreenEvent:()=>Ty,HideNotificationEvent:()=>Py,HideOverlayEvent:()=>FH,HidePanelEvent:()=>zh,HideTooltipEvent:()=>VH,KeypressEvent:()=>Oh,LoadProgressEvent:()=>qH,ObjectEnterEvent:()=>LG,ObjectEvent:()=>w2,ObjectHoverEvent:()=>FG,ObjectLeaveEvent:()=>YI,PanoramaErrorEvent:()=>tG,PanoramaLoadEvent:()=>YH,PanoramaLoadedEvent:()=>hg,PositionUpdatedEvent:()=>Ay,ReadyEvent:()=>Ry,RenderEvent:()=>fG,RollUpdatedEvent:()=>Iy,ShowNotificationEvent:()=>Ly,ShowOverlayEvent:()=>yG,ShowPanelEvent:()=>Fh,ShowTooltipEvent:()=>SG,SizeUpdatedEvent:()=>ky,StopAllEvent:()=>Dy,TransitionDoneEvent:()=>iG,ViewerEvent:()=>$r,ZoomUpdatedEvent:()=>ou});var vx=class extends Event{constructor(e,t=!1){super(e,{cancelable:t})}},mH=class extends EventTarget{dispatchEvent(e){return super.dispatchEvent(e)}addEventListener(e,t,n){super.addEventListener(e,t,n)}removeEventListener(e,t,n){super.removeEventListener(e,t,n)}},$r=class extends vx{},gH=class vH extends $r{constructor(t,n){super(vH.type,!0),this.position=t,this.zoomLevel=n}};gH.type="before-animate";var sk=gH,yH=class _H extends $r{constructor(t,n){super(_H.type),this.timestamp=t,this.elapsed=n}};yH.type="before-render";var Ey=yH,xH=class bH extends $r{constructor(t){super(bH.type,!0),this.position=t}};xH.type="before-rotate";var wH=xH,SH=class MH extends $r{constructor(t){super(MH.type),this.data=t}};SH.type="click";var CH=SH,EH=class TH extends $r{constructor(t){super(TH.type),this.options=t}containsOptions(...t){return t.some(n=>this.options.includes(n))}};EH.type="config-changed";var Gs=EH,PH=class AH extends $r{constructor(t){super(AH.type),this.data=t}};PH.type="dblclick";var IH=PH,RH=class LH extends $r{constructor(t){super(LH.type),this.fullscreenEnabled=t}};RH.type="fullscreen";var Ty=RH,kH=class DH extends $r{constructor(t){super(DH.type),this.notificationId=t}};kH.type="hide-notification";var Py=kH,zH=class OH extends $r{constructor(t){super(OH.type),this.overlayId=t}};zH.type="hide-overlay";var FH=zH,NH=class BH extends $r{constructor(t){super(BH.type),this.panelId=t}};NH.type="hide-panel";var zh=NH,UH=class $H extends $r{constructor(t){super($H.type),this.tooltipData=t}};UH.type="hide-tooltip";var VH=UH,jH=class HH extends $r{constructor(t,n){super(HH.type,!0),this.key=t,this.originalEvent=n}};jH.type="key-press";var Oh=jH,GH=class WH extends $r{constructor(t){super(WH.type),this.progress=t}};GH.type="load-progress";var qH=GH,XH=class ZH extends $r{constructor(t){super(ZH.type),this.panorama=t}};XH.type="panorama-load";var YH=XH,KH=class JH extends $r{constructor(t){super(JH.type),this.data=t}};KH.type="panorama-loaded";var hg=KH,QH=class eG extends $r{constructor(t,n){super(eG.type),this.panorama=t,this.error=n}};QH.type="panorama-error";var tG=QH,nG=class rG extends $r{constructor(t){super(rG.type),this.completed=t}};nG.type="transition-done";var iG=nG,oG=class sG extends $r{constructor(t){super(sG.type),this.position=t}};oG.type="position-updated";var Ay=oG,aG=class lG extends $r{constructor(t){super(lG.type),this.roll=t}};aG.type="roll-updated";var Iy=aG,cG=class uG extends $r{constructor(){super(uG.type)}};cG.type="ready";var Ry=cG,hG=class dG extends $r{constructor(){super(dG.type)}};hG.type="render";var fG=hG,pG=class mG extends $r{constructor(t){super(mG.type),this.notificationId=t}};pG.type="show-notification";var Ly=pG,gG=class vG extends $r{constructor(t){super(vG.type),this.overlayId=t}};gG.type="show-overlay";var yG=gG,_G=class xG extends $r{constructor(t){super(xG.type),this.panelId=t}};_G.type="show-panel";var Fh=_G,bG=class wG extends $r{constructor(t,n){super(wG.type),this.tooltip=t,this.tooltipData=n}};bG.type="show-tooltip";var SG=bG,MG=class CG extends $r{constructor(t){super(CG.type),this.size=t}};MG.type="size-updated";var ky=MG,EG=class TG extends $r{constructor(){super(TG.type)}};EG.type="stop-all";var Dy=EG,PG=class AG extends $r{constructor(t){super(AG.type),this.zoomLevel=t}};PG.type="zoom-updated";var ou=PG,w2=class extends $r{constructor(e,t,n,r,i){super(e),this.originalEvent=t,this.object=n,this.viewerPoint=r,this.userDataKey=i}},IG=class RG extends w2{constructor(t,n,r,i){super(RG.type,t,n,r,i)}};IG.type="enter-object";var LG=IG,kG=class DG extends w2{constructor(t,n,r,i){super(DG.type,t,n,r,i)}};kG.type="leave-object";var YI=kG,zG=class OG extends w2{constructor(t,n,r,i){super(OG.type,t,n,r,i)}};zG.type="hover-object";var FG=zG,S2=class{constructor(e){this.viewer=e}init(){}destroy(){}supportsTransition(e){return!1}supportsPreload(e){return!1}textureCoordsToSphericalCoords(e,t){throw new Sn("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(e,t){throw new Sn("Current adapter does not support texture coordinates.")}};S2.supportsDownload=!1;function OB(e){if(e){for(const[,t]of[["_",e],...Object.entries(e)])if(t.prototype instanceof S2)return ok(t.id,t.VERSION,"5.13.4"),t}return null}var O0=`${Kh}_touchSupport`,_s={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return this.__maxCanvasWidth===null&&(this.__maxCanvasWidth=VPe(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const e=UPe();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=!!e,this.maxTextureWidth=e?e.getParameter(e.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=$Pe(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!_s.isWebGLSupported)throw new Sn("WebGL 2 is not supported.");if(_s.maxTextureWidth===0)throw new Sn("Unable to detect system capabilities")}};function UPe(){try{return document.createElement("canvas").getContext("webgl2")}catch{return null}}function $Pe(){let e="ontouchstart"in window||navigator.maxTouchPoints>0;O0 in localStorage&&(e=localStorage[O0]==="true");const t=new Promise(n=>{const r=()=>{window.removeEventListener("mousedown",i),window.removeEventListener("touchstart",a),clearTimeout(o)},i=()=>{r(),localStorage[O0]=!1,n(!1)},a=()=>{r(),localStorage[O0]=!0,n(!0)},c=()=>{r(),localStorage[O0]=e,n(e)};window.addEventListener("mousedown",i,!1),window.addEventListener("touchstart",a,!1);const o=setTimeout(c,1e4)});return{initial:e,promise:t}}function VPe(e){let t=e,n=!1;const r=document.createElement("canvas"),i=r.getContext("2d");for(r.width=1,r.height=1;t>1024&&!n;){const a=document.createElement("canvas"),c=a.getContext("2d");a.width=t,a.height=t/2;try{c.fillStyle="white",c.fillRect(t-1,t/2-1,1,1),i.drawImage(a,t-1,t/2-1,1,1,0,0,1,1),i.getImageData(0,0,1,1).data[0]>0&&(n=!0)}catch{}a.width=0,a.height=0,n||(t/=2)}if(n)return t;throw new Sn("Unable to detect system capabilities")}var jPe=x2({resolution:64,useXmpData:!0,blur:!1},{resolution:e=>{if(!e||!mr.isPowerOfTwo(e))throw new Sn("EquirectangularAdapter resolution must be power of two.");return e}}),M2=class NG extends S2{static withConfig(t){return[NG,t]}constructor(t,n){super(t),this.config=jPe(n),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}textureCoordsToSphericalCoords(t,n){if(To(t.textureX)||To(t.textureY))throw new Sn("Texture position is missing 'textureX' or 'textureY'");const r=(t.textureX+n.croppedX)/n.fullWidth*Math.PI*2,i=(t.textureY+n.croppedY)/n.fullHeight*Math.PI;return{yaw:r>=Math.PI?r-Math.PI:r+Math.PI,pitch:Math.PI/2-i}}sphericalCoordsToTextureCoords(t,n){const r=t.yaw/Math.PI/2*n.fullWidth,i=t.pitch/Math.PI*n.fullHeight;let a=Math.round(t.yaw<Math.PI?r+n.fullWidth/2:r-n.fullWidth/2)-n.croppedX,c=Math.round(n.fullHeight/2-i)-n.croppedY;return(a<0||a>n.croppedWidth||c<0||c>n.croppedHeight)&&(a=c=void 0),{textureX:a,textureY:c}}async loadTexture(t,n=!0,r,i=this.config.useXmpData){if(typeof t!="string"&&(typeof t!="object"||!t.path))return Promise.reject(new Sn("Invalid panorama url, are you using the right adapter?"));let a;typeof t=="string"?a={path:t,data:r}:a={data:r,...t};const c=await this.viewer.textureLoader.loadFile(a.path,n?x=>this.viewer.textureLoader.dispatchProgress(x):null,a.path),o=i?await this.loadXMP(c):null,f=await this.viewer.textureLoader.blobToImage(c);typeof a.data=="function"&&(a.data=a.data(f,o));const g=hH(f.width,f.height,a.data,o),_=this.createEquirectangularTexture(f);return{panorama:t,texture:_,panoData:g,cacheKey:a.path}}async loadXMP(t){const n=await this.loadBlobAsString(t),r=n.indexOf("<x:xmpmeta");if(r===-1)return null;const i=n.indexOf("</x:xmpmeta>",r);if(i===-1)return null;const a=n.substring(r,i);return a.includes("GPano:")?{fullWidth:la(a,"FullPanoWidthPixels"),fullHeight:la(a,"FullPanoHeightPixels"),croppedWidth:la(a,"CroppedAreaImageWidthPixels"),croppedHeight:la(a,"CroppedAreaImageHeightPixels"),croppedX:la(a,"CroppedAreaLeftPixels"),croppedY:la(a,"CroppedAreaTopPixels"),poseHeading:la(a,"PoseHeadingDegrees",!1),posePitch:la(a,"PosePitchDegrees",!1),poseRoll:la(a,"PoseRollDegrees",!1),initialHeading:la(a,"InitialViewHeadingDegrees",!1),initialPitch:la(a,"InitialViewPitchDegrees",!1),initialFov:la(a,"InitialHorizontalFOVDegrees",!1)}:null}loadBlobAsString(t){return new Promise((n,r)=>{const i=new FileReader;i.onload=()=>n(i.result),i.onerror=r,i.readAsText(t)})}createEquirectangularTexture(t){if(this.config.blur||t.width>_s.maxTextureWidth){const n=Math.min(1,_s.maxCanvasWidth/t.width),r=new OffscreenCanvas(Math.floor(t.width*n),Math.floor(t.height*n)),i=r.getContext("2d");return this.config.blur&&(i.filter=`blur(${r.width/2048}px)`),i.drawImage(t,0,0,r.width,r.height),XI(r)}return XI(t)}createMesh(t){const n=t.croppedX/t.fullWidth*2*Math.PI,r=t.croppedWidth/t.fullWidth*2*Math.PI,i=t.croppedY/t.fullHeight*Math.PI,a=t.croppedHeight/t.fullHeight*Math.PI,c=new Kg(jf,Math.round(this.SPHERE_SEGMENTS/(2*Math.PI)*r),Math.round(this.SPHERE_HORIZONTAL_SEGMENTS/Math.PI*a),-Math.PI/2+n,r,i,a).scale(-1,1,1),o=new Yh({depthTest:!1,depthWrite:!1});return new Ns(c,o)}setTexture(t,n){t.material.map=n.texture}setTextureOpacity(t,n){t.material.opacity=n,t.material.transparent=n<1}disposeTexture({texture:t}){t.dispose()}disposeMesh(t){t.geometry.dispose(),t.material.dispose()}};M2.id="equirectangular";M2.VERSION="5.13.4";M2.supportsDownload=!0;var ak=M2,BG=class UG extends ak{static withConfig(t){return[UG,t]}constructor(t,n){super(t,{resolution:(n==null?void 0:n.resolution)??64,useXmpData:!1})}async loadTexture(t,n){const r=await super.loadTexture(t,n,null,!1);return r.panoData=null,r}createMesh(){const t=new Kg(jf,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS).scale(-1,1,1).toNonIndexed(),n=t.getAttribute("uv"),r=t.getAttribute("normal");for(let a=0;a<n.count;a++)for(let c=0;c<3;c++){const o=a*3+c,f=r.getX(o),g=r.getY(o),_=r.getZ(o),x=.947;if(a<n.count/6){const M=f===0&&_===0?1:Math.acos(g)/Math.sqrt(f*f+_*_)*(2/Math.PI);n.setXY(o,f*(x/4)*M+1/4,_*(x/2)*M+1/2)}else{const M=f===0&&_===0?1:Math.acos(-g)/Math.sqrt(f*f+_*_)*(2/Math.PI);n.setXY(o,-f*(x/4)*M+3/4,_*(x/2)*M+1/2)}}t.rotateX(-Math.PI/2),t.rotateY(Math.PI);const i=new Yh({depthTest:!1,depthWrite:!1});return new Ns(t,i)}};BG.id="dual-fisheye";BG.VERSION="5.13.4";var hd=class $G{constructor(t,n){this.parent=t,this.children=[],this.state={visible:!0},this.viewer=t instanceof $G?t.viewer:t,this.container=document.createElement(n.tagName??"div"),this.container.className=n.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const t=this.parent.children.indexOf(this);t!==-1&&this.parent.children.splice(t,1),this.children.slice().forEach(n=>n.destroy()),this.children.length=0}toggle(t=!this.isVisible()){t?this.show():this.hide()}hide(t){this.container.style.display="none",this.state.visible=!1}show(t){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},HPe=x2({id:null,tagName:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),bs=class extends hd{constructor(e,t){super(e,{tagName:t.tagName,className:`psv-button ${t.hoverScale?"psv-button--hover-scale":""} ${t.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=HPe(t),t.id||(this.config.id=this.constructor.id),t.icon&&this.__setIcon(t.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.viewer.config.lang[this.config.title]??this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),t.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",n=>{this.state.enabled&&this.onClick(),n.stopPropagation()}),this.container.addEventListener("keydown",n=>{n.key===Eo.Enter&&this.state.enabled&&(this.onClick(),n.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(e=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),e&&this.viewer.navbar.autoSize())}hide(e=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",e&&this.viewer.navbar.autoSize())}checkSupported(){nk(this.isSupported(),(e,t)=>{this.state&&(this.state.supported=e,t?e||this.hide():this.toggle(e))})}autoSize(){}isSupported(){return!0}toggleActive(e=!this.state.active){e!==this.state.active&&(this.state.active=e,v2(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(e){this.container.innerHTML=e,ek(this.container.querySelector("svg"),"psv-button-svg")}},GPe=class extends bs{constructor(e,t){var n,r;super(e,{id:t.id??`psvButton-${Math.random().toString(36).substring(2)}`,className:`psv-custom-button ${t.className||""}`,hoverScale:!1,collapsable:t.collapsable!==!1,tabbable:t.tabbable!==!1,title:t.title}),this.customOnClick=t.onClick,t.content&&(typeof t.content=="string"?this.container.innerHTML=t.content:(this.container.classList.add("psv-custom-button--no-padding"),t.content.style.height="100%",(r=(n=t.content).attachViewer)==null||r.call(n,this.viewer),this.container.appendChild(t.content))),this.state.width=this.container.offsetWidth,t.disabled&&this.disable(),t.visible===!1&&this.hide()}onClick(){var e;(e=this.customOnClick)==null||e.call(this,this.viewer)}},w_=class extends bs{constructor(e){super(e,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ol.info}),this.mode=0,this.viewer.addEventListener(Py.type,this),this.viewer.addEventListener(Ly.type,this),this.viewer.addEventListener(zh.type,this),this.viewer.addEventListener(Fh.type,this),this.viewer.addEventListener(Gs.type,this)}destroy(){this.viewer.removeEventListener(Py.type,this),this.viewer.removeEventListener(Ly.type,this),this.viewer.removeEventListener(zh.type,this),this.viewer.removeEventListener(Fh.type,this),this.viewer.removeEventListener(Gs.type,this),super.destroy()}handleEvent(e){if(e instanceof Gs){e.containsOptions("description")&&this.autoSize(!0);return}if(!this.mode)return;let t=!1;e instanceof Py?t=this.mode===1:e instanceof Ly?t=this.mode===1&&e.notificationId!==$o.DESCRIPTION:e instanceof zh?t=this.mode===2:e instanceof Fh&&(t=this.mode===2&&e.panelId!==$o.DESCRIPTION),t&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(e){super.hide(e),this.mode&&this.__close()}autoSize(e=!1){if(e){const t=this.viewer.navbar.getButton("caption",!1),n=t&&!t.isVisible(),r=!!this.viewer.config.description;n||r?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide($o.DESCRIPTION);break;case 2:this.viewer.panel.hide($o.DESCRIPTION);break}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:$o.DESCRIPTION,content:`${this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:""}${this.viewer.config.description}`})):(this.mode=1,this.viewer.notification.show({id:$o.DESCRIPTION,content:this.viewer.config.caption}))}};w_.id="description";var VG=class extends bs{constructor(e){super(e,{tagName:"a",className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:Ol.download}),this.viewer.addEventListener(Gs.type,this),this.viewer.addEventListener(hg.type,this)}destroy(){this.viewer.removeEventListener(Gs.type,this),this.viewer.removeEventListener(hg.type,this),super.destroy()}handleEvent(e){e instanceof Gs?(e.containsOptions("downloadUrl")&&this.checkSupported(),e.containsOptions("downloadUrl","downloadName")&&this.__update()):e instanceof hg&&this.__update()}onClick(){}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}__update(){const e=this.container;e.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,e.target="_blank",e.href.startsWith("data:")&&!this.viewer.config.downloadName?e.download="panorama."+e.href.substring(0,e.href.indexOf(";")).split("/").pop():e.download=this.viewer.config.downloadName||e.href.split("/").pop()}};VG.id="download";var jG=class extends bs{constructor(e){super(e,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ol.fullscreenIn,iconActive:Ol.fullscreenOut}),this.viewer.addEventListener(Ty.type,this)}destroy(){this.viewer.removeEventListener(Ty.type,this),super.destroy()}handleEvent(e){e instanceof Ty&&this.toggleActive(e.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};jG.id="fullscreen";var WPe="psvButton",qPe=(e,t)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
  <h1 class="psv-panel-menu-title">${Ol.menu} ${t}</h1>
  <ul class="psv-panel-menu-list">
    ${e.map(n=>`
    <li data-psv-button="${n.id}" class="psv-panel-menu-item" tabindex="0">
      <span class="psv-panel-menu-item-icon">${n.content}</span>
      <span class="psv-panel-menu-item-label">${n.title}</span>
    </li>
    `).join("")}
  </ul>
</div>
`,Mw=class extends bs{constructor(e){super(e,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ol.menu}),this.viewer.addEventListener(Fh.type,this),this.viewer.addEventListener(zh.type,this),super.hide()}destroy(){this.viewer.removeEventListener(Fh.type,this),this.viewer.removeEventListener(zh.type,this),super.destroy()}handleEvent(e){e instanceof Fh?this.toggleActive(e.panelId===$o.MENU):e instanceof zh&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(e){super.hide(e),this.__hideMenu()}show(e){super.show(e),this.state.active&&this.__showMenu()}__showMenu(){this.viewer.panel.show({id:$o.MENU,content:qPe(this.viewer.navbar.collapsed,this.viewer.config.lang.menu),noMargin:!0,clickHandler:e=>{const t=e?Z7(e,".psv-panel-menu-item"):void 0,n=t?t.dataset[WPe]:void 0;n&&(this.viewer.navbar.getButton(n).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide($o.MENU)}};Mw.id="menu";function XPe(e){let t=0;switch(e){case 0:t=90;break;case 1:t=-90;break;case 3:t=180;break;default:t=0;break}return Ol.arrow.replace("rotate(0",`rotate(${t}`)}var yx=class extends bs{constructor(e,t){super(e,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:XPe(t)}),this.direction=t,this.handler=new b2,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":e.key===Eo.Enter&&this.__onMouseDown();break;case"keyup":e.key===Eo.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return _2(_s.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const e={};switch(this.direction){case 0:e.pitch=!1;break;case 1:e.pitch=!0;break;case 3:e.yaw=!1;break;default:e.yaw=!0;break}this.viewer.stopAll(),this.viewer.dynamics.position.roll(e),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};yx.groupId="move";var HG=class extends yx{constructor(e){super(e,1)}};HG.id="moveDown";var GG=class extends yx{constructor(e){super(e,2)}};GG.id="moveLeft";var WG=class extends yx{constructor(e){super(e,3)}};WG.id="moveRight";var qG=class extends yx{constructor(e){super(e,0)}};qG.id="moveUp";var lk=class extends bs{constructor(e,t,n){super(e,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:t}),this.direction=n,this.handler=new b2,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":e.key===Eo.Enter&&this.__onMouseDown();break;case"keyup":e.key===Eo.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return _2(_s.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(this.direction===1),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};lk.groupId="zoom";var XG=class extends lk{constructor(e){super(e,Ol.zoomIn,0)}};XG.id="zoomIn";var ZG=class extends lk{constructor(e){super(e,Ol.zoomOut,1)}};ZG.id="zoomOut";var ck=class extends bs{constructor(e){super(e,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new pH(this.container,"HORIZONTAL",t=>this.__onSliderUpdate(t)),this.mediaMinWidth=parseInt(fc(this.container,"max-width"),10),this.viewer.addEventListener(ou.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(Ry.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(ou.type,this),this.viewer.removeEventListener(Ry.type,this),super.destroy()}handleEvent(e){e instanceof ou?this.__moveZoomValue(e.zoomLevel):e instanceof Ry&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return _2(_s.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(e){this.zoomValue.style.left=e/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(e){e.mousedown&&this.viewer.zoom(e.value*100)}};ck.id="zoomRange";ck.groupId="zoom";var YG=class extends mH{constructor(e){super(),this.viewer=e}init(){}destroy(){}},uk=class extends YG{constructor(e,t){super(e),this.config=this.constructor.configParser(t)}setOption(e,t){this.setOptions({[e]:t})}setOptions(e){const t={...this.config,...e},n=this.constructor,r=n.configParser,i=n.readonlyOptions,a=n.id;for(let[c,o]of Object.entries(e)){if(!(c in r.defaults)){Vo(`${a}: Unknown option "${c}"`);continue}if(i.includes(c)){Vo(`${a}: Option "${c}" cannot be updated`);continue}c in r.parsers&&(o=r.parsers[c](o,{rawConfig:t,defValue:r.defaults[c]})),this.config[c]=o}}};uk.readonlyOptions=[];function KI(e){if(e){for(const[,t]of[["_",e],...Object.entries(e)])if(t.prototype instanceof YG)return ok(t.id,t.VERSION,"5.13.4"),t}return null}var yu={panorama:null,container:null,adapter:[ak,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:.8,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,canvasBackground:"#000",defaultTransition:{speed:1500,rotation:!0,effect:"fade"},rendererParameters:{alpha:!0,antialias:!0},withCredentials:()=>!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[Eo.ArrowUp]:"ROTATE_UP",[Eo.ArrowDown]:"ROTATE_DOWN",[Eo.ArrowRight]:"ROTATE_RIGHT",[Eo.ArrowLeft]:"ROTATE_LEFT",[Eo.PageUp]:"ZOOM_IN",[Eo.PageDown]:"ZOOM_OUT",[Eo.Plus]:"ZOOM_IN",[Eo.Minus]:"ZOOM_OUT"}},FB={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},JI={container:e=>{if(!e)throw new Sn("No value given for container.");return e},adapter:(e,{defValue:t})=>{if(e?Array.isArray(e)?e=[OB(e[0]),e[1]]:e=[OB(e),null]:e=t,!e[0])throw new Sn("An undefined value was given for adapter.");if(!e[0].id)throw new Sn("Adapter has no id.");return e},defaultYaw:e=>sc(e),defaultPitch:e=>sc(e,!0),defaultZoomLvl:e=>mr.clamp(e,0,100),minFov:(e,{rawConfig:t})=>(t.maxFov<e&&(Vo("maxFov cannot be lower than minFov"),e=t.maxFov),mr.clamp(e,1,179)),maxFov:(e,{rawConfig:t})=>(e<t.minFov&&(e=t.minFov),mr.clamp(e,1,179)),moveInertia:(e,{defValue:t})=>e===!0?t:e===!1?0:e,lang:e=>({...yu.lang,...e}),keyboardActions:(e,{rawConfig:t})=>t.keyboard&&typeof t.keyboard=="object"?t.keyboard:e,fisheye:e=>e===!0?1:e===!1?0:e,requestHeaders:e=>e&&typeof e=="object"?()=>e:typeof e=="function"?e:null,withCredentials:e=>typeof e=="boolean"?()=>e:typeof e=="function"?e:()=>!1,defaultTransition:(e,{defValue:t})=>e===null||e.speed===0?null:{...t,...e},rendererParameters:(e,{defValue:t})=>({...e,...t}),plugins:e=>e.map((t,n)=>{if(Array.isArray(t)?t=[KI(t[0]),t[1]]:t=[KI(t),null],!t[0])throw new Sn(`An undefined value was given for plugin ${n}.`);if(!t[0].id)throw new Sn(`Plugin ${n} has no id.`);return t}),navbar:e=>e===!1?null:e===!0?y2(yu.navbar):typeof e=="string"?e.split(/[ ,]/):e},ZPe=x2(yu,JI),Gm=class extends bs{constructor(e){super(e,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(e){this.show(),this.contentElt.innerHTML=e??"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){var e;(e=this.viewer.navbar.getButton(w_.id,!1))==null||e.autoSize(!0)}};Gm.id="caption";var QI={},OS={};function hk(e,t){if(!e.id)throw new Sn("Button id is required");if(QI[e.id]=e,e.groupId&&(OS[e.groupId]=OS[e.groupId]||[]).push(e),t){const n=yu.navbar;switch(t){case"start":n.unshift(e.id);break;case"end":n.push(e.id);break;default:{const[r,i]=t.split(":"),a=n.indexOf(r);if(!r||!i||a===-1)throw new Sn(`Invalid defaultPosition ${t}`);n.splice(a+(i==="right"?1:0),0,e.id)}}}}[ZG,ck,XG,w_,Gm,VG,jG,GG,WG,qG,HG].forEach(e=>hk(e));var YPe=class extends hd{constructor(e){super(e,{className:`psv-navbar ${gx}`}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(e){this.children.slice().forEach(t=>t.destroy()),this.children.length=0,e.indexOf(Gm.id)!==-1&&e.indexOf(w_.id)===-1&&e.splice(e.indexOf(Gm.id),0,w_.id),e.forEach(t=>{typeof t=="object"?new GPe(this,t):QI[t]?new QI[t](this):OS[t]?OS[t].forEach(n=>{new n(this)}):Vo(`Unknown button ${t}`)}),new Mw(this),this.children.forEach(t=>{t instanceof bs&&t.checkSupported()}),this.autoSize()}setCaption(e){this.children.some(t=>t instanceof Gm?(t.setCaption(e),!0):!1)}getButton(e,t=!0){const n=this.children.find(r=>r instanceof bs&&r.id===e);return!n&&t&&Vo(`button "${e}" not found in the navbar`),n}focusButton(e){var t,n;this.isVisible()&&((n=((t=this.getButton(e,!1))==null?void 0:t.container)||this.container.firstElementChild)==null||n.focus())}autoSize(){var r;this.children.forEach(i=>{i instanceof bs&&i.autoSize()});const e=this.container.offsetWidth;let t=0;const n=[];this.children.forEach(i=>{i.isVisible()&&i instanceof bs&&(t+=i.width,i.collapsable&&n.push(i))}),t!==0&&(e<t&&n.length>0?(n.forEach(i=>i.collapse()),this.collapsed=n,this.getButton(Mw.id).show(!1)):e>=t&&this.collapsed.length>0&&(this.collapsed.forEach(i=>i.uncollapse()),this.collapsed=[],this.getButton(Mw.id).hide(!1)),(r=this.getButton(Gm.id,!1))==null||r.autoSize())}};$I.enabled=!1;var wm={enabled:!0,maxItems:10,ttl:10*60,items:{},purgeInterval:null,init(){$I.enabled&&(Vo("ThreeJS cache should be disabled"),$I.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval(()=>this.purge(),60*1e3))},add(e,t,n){this.enabled&&t&&(this.items[t]=this.items[t]??{files:{},lastAccess:null},this.items[t].files[e]=n,this.items[t].lastAccess=Date.now())},get(e,t){if(this.enabled&&t&&this.items[t])return this.items[t].lastAccess=Date.now(),this.items[t].files[e]},remove(e,t){this.enabled&&t&&this.items[t]&&(delete this.items[t].files[e],Object.keys(this.items[t].files).length===0&&delete this.items[t])},purge(){Object.entries(this.items).sort(([,e],[,t])=>t.lastAccess-e.lastAccess).forEach(([e,{lastAccess:t}],n)=>{n>0&&(Date.now()-t>=this.ttl*1e3||n>=this.maxItems)&&delete this.items[e]})}},KPe=class extends hd{constructor(e){super(e,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox",`0 0 ${this.size} ${this.size}`),this.loader.appendChild(this.canvas),this.textColor=fc(this.loader,"color"),this.color=fc(this.canvas,"color"),this.border=parseInt(fc(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(fc(this.loader,"--psv-loader-tickness"),10);const t=this.size/2;this.canvas.innerHTML=`
            <circle cx="${t}" cy="${t}" r="${t}" fill="${this.color}"/>
            <path d="" fill="none" stroke="${this.textColor}" stroke-width="${this.thickness}" stroke-linecap="round"/>
        `,this.viewer.addEventListener(Gs.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(Gs.type,this),super.destroy()}handleEvent(e){e instanceof Gs&&e.containsOptions("loadingImg","loadingTxt","lang")&&this.__updateContent()}setProgress(e){this.container.classList.remove("psv-loader--undefined");const t=mr.clamp(e,0,99.999)/100*Math.PI*2,n=this.size/2,r=n,i=this.thickness/2+this.border,a=(this.size-this.thickness)/2-this.border,c=Math.sin(t)*a+n,o=-Math.cos(t)*a+n,f=e>50?"1":"0";this.canvas.querySelector("path").setAttributeNS(null,"d",`M ${r} ${i} A ${a} ${a} 0 ${f} 1 ${c} ${o}`)}showUndefined(){this.show(),this.setProgress(25),this.container.classList.add("psv-loader--undefined")}__updateContent(){const e=this.loader.querySelector(".psv-loader-image, .psv-loader-text");e&&this.loader.removeChild(e);let t;if(this.viewer.config.loadingImg?(t=document.createElement("img"),t.className="psv-loader-image",t.src=this.viewer.config.loadingImg):this.viewer.config.loadingTxt!==null&&(t=document.createElement("div"),t.className="psv-loader-text",t.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),t){const n=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));t.style.maxWidth=n+"px",t.style.maxHeight=n+"px",this.loader.appendChild(t)}}},JPe=class extends hd{constructor(e){super(e,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",()=>this.hide())}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new Sn("Notification cannot be toggled")}show(e){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),typeof e=="string"&&(e={content:e}),this.state.contentId=e.id||null,this.content.innerHTML=e.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new Ly(this.state.contentId)),e.timeout&&(this.state.timeout=setTimeout(()=>this.hide(this.state.contentId),e.timeout))}hide(e){if(this.isVisible(e)){const t=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new Py(t))}}},QPe=class extends hd{constructor(e){super(e,{className:`psv-overlay ${gx}`}),this.state={visible:!1,contentId:null,dismissible:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(Oh.type,this),super.hide()}destroy(){this.viewer.removeEventListener(Oh.type,this),super.destroy()}handleEvent(e){e.type==="click"?this.isVisible()&&this.state.dismissible&&(this.hide(),e.stopPropagation()):e instanceof Oh&&this.isVisible()&&this.state.dismissible&&e.key===Eo.Escape&&(this.hide(),e.preventDefault())}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new Sn("Overlay cannot be toggled")}show(e){typeof e=="string"&&(e={title:e}),this.state.contentId=e.id||null,this.state.dismissible=e.dismissible!==!1,this.image.innerHTML=e.image||"",this.title.innerHTML=e.title||"",this.text.innerHTML=e.text||"",super.show(),this.viewer.dispatchEvent(new yG(this.state.contentId))}hide(e){if(this.isVisible(e)){const t=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new FH(t))}}},eAe=200,mP="psv-panel-content--no-interaction",tAe=class extends hd{constructor(e){super(e,{className:`psv-panel ${gx}`}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const t=document.createElement("div");t.className="psv-panel-resizer",this.container.appendChild(t);const n=document.createElement("div");n.className="psv-panel-close-button",n.innerHTML=Ol.close,n.title=e.config.lang.close,this.container.appendChild(n),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),n.addEventListener("click",()=>this.hide()),t.addEventListener("mousedown",this),t.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(Oh.type,this)}destroy(){this.viewer.removeEventListener(Oh.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e);break;case Oh.type:this.__onKeyPress(e);break}}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new Sn("Panel cannot be toggled")}show(e){typeof e=="string"&&(e={content:e});const t=this.isVisible(e.id);this.state.contentId=e.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),e.id&&this.state.width[e.id]?this.container.style.width=this.state.width[e.id]:e.width?this.container.style.width=e.width:this.container.style.width=null,this.content.innerHTML=e.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),v2(this.content,"psv-panel-content--no-margin",e.noMargin===!0),e.clickHandler&&(this.state.clickHandler=n=>{e.clickHandler(RS(n))},this.state.keyHandler=n=>{n.key===Eo.Enter&&e.clickHandler(RS(n))},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),t||setTimeout(()=>{var n;(n=this.content.querySelector("a,button,[tabindex]"))==null||n.focus()},300)),this.viewer.dispatchEvent(new Fh(this.state.contentId))}hide(e){if(this.isVisible(e)){const t=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),this.viewer.dispatchEvent(new zh(t))}}__onMouseDown(e){e.stopPropagation(),this.__startResize(e.clientX,e.clientY)}__onTouchStart(e){if(e.stopPropagation(),e.touches.length===1){const t=e.touches[0];this.__startResize(t.clientX,t.clientY)}}__onMouseUp(e){this.state.mousedown&&(e.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(mP))}__onTouchEnd(e){this.state.mousedown&&(e.stopPropagation(),e.touches.length===0&&(this.state.mousedown=!1,this.content.classList.remove(mP)))}__onMouseMove(e){this.state.mousedown&&(e.stopPropagation(),this.__resize(e.clientX,e.clientY))}__onTouchMove(e){if(this.state.mousedown){const t=e.touches[0];this.__resize(t.clientX,t.clientY)}}__onKeyPress(e){this.isVisible()&&e.key===Eo.Escape&&(this.hide(),e.preventDefault())}__startResize(e,t){this.state.mouseX=e,this.state.mouseY=t,this.state.mousedown=!0,this.content.classList.add(mP)}__resize(e,t){const n=e,r=t,i=Math.max(eAe,this.container.offsetWidth-(n-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=i),this.container.style.width=i,this.state.mouseX=n,this.state.mouseY=r}},nAe=class extends hd{constructor(e,t){super(e,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null,hideTimeout:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",n=>n.stopPropagation()),this.container.addEventListener("mousedown",n=>n.stopPropagation()),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(t)}handleEvent(e){e.type==="transitionend"&&this.__onTransitionEnd(e)}destroy(){clearTimeout(this.state.hideTimeout),delete this.state.data,super.destroy()}toggle(){throw new Sn("Tooltip cannot be toggled")}show(e){if(this.state.state!==0)throw new Sn("Initialized tooltip cannot be re-initialized");e.className&&ek(this.container,e.className),e.style&&Object.assign(this.container.style,e.style),this.state.state=3,this.update(e.content,e),this.state.data=e.data,this.state.state=1,this.viewer.dispatchEvent(new SG(this,this.state.data)),this.__waitImages()}update(e,t){this.content.innerHTML=e;const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.state.arrow=parseInt(fc(this.arrow,"border-top-width"),10),this.state.border=parseInt(fc(this.container,"border-top-left-radius"),10),this.move(t??this.state.config),this.__waitImages()}move(e){var o;if(this.state.state!==1&&this.state.state!==3)throw new Sn("Uninitialized tooltip cannot be moved");e.box=e.box??((o=this.state.config)==null?void 0:o.box)??{width:0,height:0},this.state.config=e;const t=this.container,n=this.arrow,r={posClass:aH(e.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(r,e);let i=null,a=null;if(r.top<0?i="bottom":r.top+r.height>this.viewer.state.size.height&&(i="top"),r.left<0?a="right":r.left+r.width>this.viewer.state.size.width&&(a="left"),a||i){const f=ik(r.posClass);i&&(r.posClass[f?0:1]=i),a&&(r.posClass[f?1:0]=a),this.__computeTooltipPosition(r,e)}t.style.top=r.top+"px",t.style.left=r.left+"px",n.style.top=r.arrowTop+"px",n.style.left=r.arrowLeft+"px";const c=r.posClass.join("-");c!==this.state.pos&&(t.classList.remove(`psv-tooltip--${this.state.pos}`),this.state.pos=c,t.classList.add(`psv-tooltip--${this.state.pos}`))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new VH(this.state.data));const e=parseFloat(fc(this.container,"transition-duration"));this.state.hideTimeout=setTimeout(()=>{this.destroy()},e*2)}__onTransitionEnd(e){if(e.propertyName==="transform")switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy();break}}__computeTooltipPosition(e,t){const n=this.state.arrow,r=t.top,i=e.height,a=t.left,c=e.width,o=n+this.state.border,f=t.box.width/2+n*2,g=t.box.height/2+n*2;switch(e.posClass.join("-")){case"top-left":e.top=r-g-i,e.left=a+o-c,e.arrowTop=i,e.arrowLeft=c-o-n;break;case"top-center":e.top=r-g-i,e.left=a-c/2,e.arrowTop=i,e.arrowLeft=c/2-n;break;case"top-right":e.top=r-g-i,e.left=a-o,e.arrowTop=i,e.arrowLeft=n;break;case"bottom-left":e.top=r+g,e.left=a+o-c,e.arrowTop=-n*2,e.arrowLeft=c-o-n;break;case"bottom-center":e.top=r+g,e.left=a-c/2,e.arrowTop=-n*2,e.arrowLeft=c/2-n;break;case"bottom-right":e.top=r+g,e.left=a-o,e.arrowTop=-n*2,e.arrowLeft=n;break;case"left-top":e.top=r+o-i,e.left=a-f-c,e.arrowTop=i-o-n,e.arrowLeft=c;break;case"center-left":e.top=r-i/2,e.left=a-f-c,e.arrowTop=i/2-n,e.arrowLeft=c;break;case"left-bottom":e.top=r-o,e.left=a-f-c,e.arrowTop=n,e.arrowLeft=c;break;case"right-top":e.top=r+o-i,e.left=a+f,e.arrowTop=i-o-n,e.arrowLeft=-n*2;break;case"center-right":e.top=r-i/2,e.left=a+f,e.arrowTop=i/2-n,e.arrowLeft=-n*2;break;case"right-bottom":e.top=r-o,e.left=a+f,e.arrowTop=n,e.arrowLeft=-n*2;break}}__waitImages(){const e=this.content.querySelectorAll("img");if(e.length>0){const t=[];e.forEach(n=>{n.complete||t.push(new Promise(r=>{n.onload=r,n.onerror=r}))}),t.length&&Promise.all(t).then(()=>{if(this.state.state===1||this.state.state===3){const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.move(this.state.config)}})}}},rAe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/><!--Created by Shastry from the Noun Project--></svg>
`,_x=class{constructor(e){this.viewer=e,this.config=e.config,this.state=e.state}destroy(){}},bl=new dt,Ib=new Sc(0,0,0,"ZXY"),iAe=class extends _x{constructor(e){super(e)}fovToZoomLevel(e){const t=Math.round((e-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return mr.clamp(t-2*(t-50),0,100)}zoomLevelToFov(e){return this.config.maxFov+e/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(e){return mr.radToDeg(2*Math.atan(Math.tan(mr.degToRad(e)/2)*this.state.aspect))}hFovToVFov(e){return mr.radToDeg(2*Math.atan(Math.tan(mr.degToRad(e)/2)/this.state.aspect))}getAnimationProperties(e,t,n){const r=!To(t),i=!To(n),a={};let c=null;if(r){const o=this.viewer.getPosition(),f=W7(o.yaw,t.yaw);a.yaw={start:o.yaw,end:o.yaw+f},a.pitch={start:o.pitch,end:t.pitch},c=qI(e,q7(o,t))}if(i){const o=this.viewer.getZoomLevel(),f=Math.abs(n-o);a.zoom={start:o,end:n},c===null&&(c=qI(e,Math.PI/4*f/100))}return c===null?typeof e=="number"?c=e:c=HI:c=Math.max(HI,c),{duration:c,properties:a}}getTransitionOptions(e){let t;const n=this.config.defaultTransition??yu.defaultTransition;return e.transition===!1||e.transition===null?t=null:e.transition===!0?t={...n}:typeof e.transition=="object"?t={...n,...e.transition}:t=this.config.defaultTransition,t}textureCoordsToSphericalCoords(e){var n;if(!((n=this.state.textureData)!=null&&n.panoData))throw new Sn("Current adapter does not support texture coordinates or no texture has been loaded");const t=this.viewer.adapter.textureCoordsToSphericalCoords(e,this.state.textureData.panoData);return!Ib.equals(this.viewer.renderer.panoramaPose)||!Ib.equals(this.viewer.renderer.sphereCorrection)?(this.sphericalCoordsToVector3(t,bl),bl.applyEuler(this.viewer.renderer.panoramaPose),bl.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(bl)):t}sphericalCoordsToTextureCoords(e){var t;if(!((t=this.state.textureData)!=null&&t.panoData))throw new Sn("Current adapter does not support texture coordinates or no texture has been loaded");return(!Ib.equals(this.viewer.renderer.panoramaPose)||!Ib.equals(this.viewer.renderer.sphereCorrection))&&(this.sphericalCoordsToVector3(e,bl),ZI(bl,this.viewer.renderer.sphereCorrection),ZI(bl,this.viewer.renderer.panoramaPose),e=this.vector3ToSphericalCoords(bl)),this.viewer.adapter.sphericalCoordsToTextureCoords(e,this.state.textureData.panoData)}sphericalCoordsToVector3(e,t,n=jf){return t||(t=new dt),t.x=n*-Math.cos(e.pitch)*Math.sin(e.yaw),t.y=n*Math.sin(e.pitch),t.z=n*Math.cos(e.pitch)*Math.cos(e.yaw),t}vector3ToSphericalCoords(e){const t=Math.acos(e.y/Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)),n=Math.atan2(e.x,e.z);return{yaw:n<0?-n:Math.PI*2-n,pitch:Math.PI/2-t}}viewerCoordsToVector3(e){const t=this.viewer.renderer.getIntersections(e).filter(n=>n.object.userData[Kh]);return t.length?t[0].point:null}viewerCoordsToSphericalCoords(e){const t=this.viewerCoordsToVector3(e);return t?this.vector3ToSphericalCoords(t):null}vector3ToViewerCoords(e){const t=e.clone();return t.project(this.viewer.renderer.camera),{x:Math.round((t.x+1)/2*this.state.size.width),y:Math.round((1-t.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(e){return this.sphericalCoordsToVector3(e,bl),this.vector3ToViewerCoords(bl)}isPointVisible(e){let t,n;if(e instanceof dt)t=e,n=this.vector3ToViewerCoords(e);else if(rk(e))t=this.sphericalCoordsToVector3(e,bl),n=this.vector3ToViewerCoords(t);else return!1;return t.dot(this.viewer.state.direction)>0&&n.x>=0&&n.x<=this.viewer.state.size.width&&n.y>=0&&n.y<=this.viewer.state.size.height}cleanPosition(e){if("yaw"in e||"pitch"in e){if(!("yaw"in e)||!("pitch"in e))throw new Sn("Position is missing 'yaw' or 'pitch'");return{yaw:sc(e.yaw),pitch:sc(e.pitch,!0)}}else return this.textureCoordsToSphericalCoords(e)}cleanSphereCorrection(e){return{pan:sc((e==null?void 0:e.pan)||0),tilt:sc((e==null?void 0:e.tilt)||0,!0),roll:sc((e==null?void 0:e.roll)||0,!0,!1)}}cleanPanoramaPose(e){return{pan:mr.degToRad((e==null?void 0:e.poseHeading)||0),tilt:mr.degToRad((e==null?void 0:e.posePitch)||0),roll:mr.degToRad((e==null?void 0:e.poseRoll)||0)}}cleanPanoramaOptions(e,t){return t!=null&&t.isEquirectangular&&(To(e.zoom)&&!To(t.initialFov)&&(e={...e,zoom:this.fovToZoomLevel(this.hFovToVFov(t.initialFov))}),To(e.position)&&!To(t.initialHeading)&&!To(t.initialPitch)&&(e={...e,position:{yaw:sc(t.initialHeading),pitch:sc(t.initialPitch,!0)}})),e}},oAe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/><!--Created by AomAm from the Noun Project--></svg>
`,sAe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/><!-- Created by Icon Island from the Noun Project --></svg>
`,C2=class KG{constructor(){this.$=KG.IDLE}is(...t){return t.some(n=>this.$&n)}set(t){this.$=t}add(t){this.$|=t}remove(t){this.$&=~t}};C2.IDLE=0;C2.CLICK=1;C2.MOVING=2;var Ji=C2,aAe=class extends _x{constructor(e){super(e),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,pinchDist:0,moveDelta:{yaw:0,pitch:0,zoom:0},accumulatorFactor:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new Ji,this.keyHandler=new b2,this.resizeObserver=new ResizeObserver(tH(()=>this.viewer.autoSize(),50)),this.moveThreshold=N7*_s.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container),this.viewer.addEventListener(Ey.type,this),this.viewer.addEventListener(Dy.type,this)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),this.viewer.removeEventListener(Ey.type,this),this.viewer.removeEventListener(Dy.type,this),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(e){switch(e.type){case"keydown":this.__onKeyDown(e);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchmove":this.__onTouchMove(e);break;case"touchend":this.__onTouchEnd(e);break;case"fullscreenchange":this.__onFullscreenChange();break;case Ey.type:this.__applyMoveDelta();break;case Dy.type:this.__clearMoveDelta();break}if(!Y7(e,"."+gx))switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"wheel":this.__onMouseWheel(e);break}}__onKeyDown(e){var n;if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=e.key===Eo.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide($o.CTRL_ZOOM))),!this.viewer.dispatchEvent(new Oh(e.key,e))||!this.state.keyboardEnabled)return;const t=(n=this.config.keyboardActions)==null?void 0:n[e.key];if(typeof t=="function"){t(this.viewer,e),e.preventDefault();return}if(!(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&t&&!this.keyHandler.pending){switch(t!=="ZOOM_IN"&&t!=="ZOOM_OUT"&&this.viewer.stopAll(),t){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0);break}this.keyHandler.down(t),e.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(e=>{e==="ZOOM_IN"||e==="ZOOM_OUT"?this.viewer.dynamics.zoom.stop():(this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer())})}__onMouseDown(e){this.step.add(Ji.CLICK),this.data.startMouseX=e.clientX,this.data.startMouseY=e.clientY,this.config.mousemove&&e.preventDefault()}__onMouseUp(e){this.step.is(Ji.CLICK,Ji.MOVING)&&this.__stopMove(e.clientX,e.clientY,e,e.button===2)}__onMouseMove(e){this.config.mousemove&&this.step.is(Ji.CLICK,Ji.MOVING)&&(e.preventDefault(),this.__doMove(e.clientX,e.clientY)),this.__handleObjectsEvents(e)}__onTouchStart(e){e.touches.length===1?(this.step.add(Ji.CLICK),this.data.startMouseX=e.touches[0].clientX,this.data.startMouseY=e.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(()=>{const t=e.touches[0];this.__stopMove(t.clientX,t.clientY,e,!0),this.data.longtouchTimeout=null},U7))):e.touches.length===2&&(this.step.set(Ji.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(e),e.preventDefault()))}__onTouchEnd(e){if(this.__cancelLongTouch(),this.step.is(Ji.CLICK,Ji.MOVING)){if(e.preventDefault(),this.__cancelTwoFingersOverlay(),e.touches.length===1)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(e.touches.length===0){const t=e.changedTouches[0];this.__stopMove(t.clientX,t.clientY,e)}}}__onTouchMove(e){if(this.__cancelLongTouch(),!!this.config.mousemove)if(e.touches.length===1){if(this.config.touchmoveTwoFingers)this.step.is(Ji.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(()=>{this.viewer.overlay.show({id:$o.TWO_FINGERS,image:oAe,title:this.config.lang.twoFingers})},$7));else if(this.step.is(Ji.CLICK,Ji.MOVING)){e.preventDefault();const t=e.touches[0];this.__doMove(t.clientX,t.clientY)}}else this.__doMoveZoom(e),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide($o.TWO_FINGERS))}__onMouseWheel(e){if(!this.config.mousewheel||!e.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown){this.viewer.overlay.show({id:$o.CTRL_ZOOM,image:sAe,title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),this.data.ctrlZoomTimeout=setTimeout(()=>this.viewer.overlay.hide($o.CTRL_ZOOM),V7);return}e.preventDefault(),e.stopPropagation();const t=e.deltaY/Math.abs(e.deltaY)*5*this.config.zoomSpeed;t!==0&&this.viewer.dynamics.zoom.step(-t,5)}__onFullscreenChange(){const e=this.viewer.isFullscreenEnabled();this.config.keyboard==="fullscreen"&&(e?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new Ty(e))}__resetMove(){this.step.set(Ji.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0}__startMoveZoom(e){this.viewer.stopAll(),this.__resetMove();const t=GI(e);this.step.set(Ji.MOVING),this.data.accumulatorFactor=this.config.moveInertia,{distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=t}__stopMove(e,t,n,r=!1){this.step.is(Ji.CLICK)&&!this.__moveThresholdReached(e,t)&&this.__doClick(e,t,n,r),this.config.moveInertia&&(this.data.accumulatorFactor=Math.pow(this.config.moveInertia,.5)),this.__resetMove(),this.viewer.resetIdleTimer()}__doClick(e,t,n,r=!1){const i=this.viewer.container.getBoundingClientRect(),a=e-i.left,c=t-i.top,o=this.viewer.renderer.getIntersections({x:a,y:c}),f=o.find(g=>g.object.userData[Kh]);if(f){const g=this.viewer.dataHelper.vector3ToSphericalCoords(f.point),_={rightclick:r,originalEvent:n,target:RS(n),clientX:e,clientY:t,viewerX:a,viewerY:c,yaw:g.yaw,pitch:g.pitch,objects:o.map(x=>x.object).filter(x=>!x.userData[Kh])};try{const x=this.viewer.dataHelper.sphericalCoordsToTextureCoords(_);Object.assign(_,x)}catch{}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-_.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-_.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new IH(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new CH(_)),this.data.dblclickData=y2(_),this.data.dblclickTimeout=setTimeout(()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null},B7))}}__handleObjectsEvents(e){if(!rH(this.state.objectsObservers)&&e.composedPath().includes(this.viewer.container)){const t=K7(this.viewer.container),n={x:e.clientX-t.x,y:e.clientY-t.y},r=this.viewer.renderer.getIntersections(n),i=(a,c,o)=>{this.viewer.dispatchEvent(new o(e,a,n,c))};for(const[a,c]of Object.entries(this.state.objectsObservers)){const o=r.find(f=>f.object.userData[a]);o?(c&&o.object!==c&&(i(c,a,YI),this.state.objectsObservers[a]=null),c?i(o.object,a,FG):(this.state.objectsObservers[a]=o.object,i(o.object,a,LG))):c&&(i(c,a,YI),this.state.objectsObservers[a]=null)}}}__doMove(e,t){if(this.step.is(Ji.CLICK)&&this.__moveThresholdReached(e,t))this.viewer.stopAll(),this.__resetMove(),this.step.set(Ji.MOVING),this.data.mouseX=e,this.data.mouseY=t,this.data.accumulatorFactor=this.config.moveInertia;else if(this.step.is(Ji.MOVING)){const n=(e-this.data.mouseX)*Math.cos(this.state.roll)-(t-this.data.mouseY)*Math.sin(this.state.roll),r=(t-this.data.mouseY)*Math.cos(this.state.roll)+(e-this.data.mouseX)*Math.sin(this.state.roll),i={yaw:this.config.moveSpeed*(n/this.state.size.width)*mr.degToRad(this.state.hFov),pitch:this.config.moveSpeed*(r/this.state.size.height)*mr.degToRad(this.state.vFov)};this.data.moveDelta.yaw+=i.yaw,this.data.moveDelta.pitch+=i.pitch,this.data.mouseX=e,this.data.mouseY=t}}__moveThresholdReached(e,t){return Math.abs(e-this.data.startMouseX)>=this.moveThreshold||Math.abs(t-this.data.startMouseY)>=this.moveThreshold}__doMoveZoom(e){if(this.step.is(Ji.MOVING)){e.preventDefault();const t=GI(e);this.__doMove(t.center.x,t.center.y),this.data.moveDelta.zoom+=this.config.zoomSpeed*((t.distance-this.data.pinchDist)/_s.pixelRatio),this.data.pinchDist=t.distance}}__applyMoveDelta(){if(Math.abs(this.data.moveDelta.yaw)>0||Math.abs(this.data.moveDelta.pitch)>0){const t=this.viewer.getPosition();this.viewer.rotate({yaw:t.yaw-this.data.moveDelta.yaw*(1-this.config.moveInertia),pitch:t.pitch+this.data.moveDelta.pitch*(1-this.config.moveInertia)}),this.data.moveDelta.yaw*=this.data.accumulatorFactor,this.data.moveDelta.pitch*=this.data.accumulatorFactor,Math.abs(this.data.moveDelta.yaw)<=.001&&(this.data.moveDelta.yaw=0),Math.abs(this.data.moveDelta.pitch)<=.001&&(this.data.moveDelta.pitch=0)}if(Math.abs(this.data.moveDelta.zoom)>0){const t=this.viewer.getZoomLevel();this.viewer.zoom(t+this.data.moveDelta.zoom*(1-this.config.moveInertia)),this.data.moveDelta.zoom*=this.config.moveInertia,Math.abs(this.data.moveDelta.zoom)<=.001&&(this.data.moveDelta.zoom=0)}}__clearMoveDelta(){this.data.moveDelta.yaw=0,this.data.moveDelta.pitch=0,this.data.moveDelta.zoom=0}};Tr.enabled=!1;var Rb=new Dr,NB=new jr,BB=new Yg,lAe=class extends _x{constructor(e){super(e),this.frustumNeedsUpdate=!0,this.renderer=new SPe(this.config.rendererParameters),this.renderer.setPixelRatio(_s.pixelRatio),this.renderer.outputColorSpace=Vf,this.renderer.toneMapping=h7,this.renderer.domElement.className="psv-canvas",this.renderer.domElement.style.background=this.config.canvasBackground,this.scene=new PS,this.camera=new pa(50,16/9,.1,2*jf),this.camera.matrixAutoUpdate=!1;const t=new Ns(new Kg(jf).scale(-1,1,1),new Yh({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1}));t.userData={[Kh]:!0},this.scene.add(t),this.raycaster=new UMe,this.frustum=new YL,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",n=>n.preventDefault()),this.viewer.addEventListener(ky.type,this),this.viewer.addEventListener(ou.type,this),this.viewer.addEventListener(Ay.type,this),this.viewer.addEventListener(Iy.type,this),this.viewer.addEventListener(Gs.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop(e=>this.__renderLoop(e))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.renderer.dispose(),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(ky.type,this),this.viewer.removeEventListener(ou.type,this),this.viewer.removeEventListener(Ay.type,this),this.viewer.removeEventListener(Iy.type,this),this.viewer.removeEventListener(Gs.type,this),super.destroy()}handleEvent(e){switch(e.type){case ky.type:this.__onSizeUpdated();break;case ou.type:this.__onZoomUpdated();break;case Ay.type:this.__onPositionUpdated();break;case Iy.type:this.__onPositionUpdated();break;case Gs.type:e.containsOptions("fisheye")&&this.__onPositionUpdated(),e.containsOptions("canvasBackground")&&(this.renderer.domElement.style.background=this.config.canvasBackground);break}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(e){e?this.customRenderer=e(this.renderer):this.customRenderer=null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(e){const t=this.timestamp?e-this.timestamp:0;this.timestamp=e,this.viewer.dispatchEvent(new Ey(e,t)),this.viewer.dynamics.update(t),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new fG))}setTexture(e){this.meshContainer||(this.meshContainer=new Sh,this.scene.add(this.meshContainer)),this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.mesh&&(this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh)),this.mesh=this.viewer.adapter.createMesh(e.panoData),this.viewer.adapter.setTexture(this.mesh,e,!1),this.meshContainer.add(this.mesh),this.state.textureData=e,this.viewer.needsUpdate()}setPanoramaPose(e,t=this.mesh){const n=this.viewer.dataHelper.cleanPanoramaPose(e);t.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}setSphereCorrection(e,t=this.meshContainer){const n=this.viewer.dataHelper.cleanSphereCorrection(e);t.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}transition(e,t,n){const r=n.effect==="fade"||n.rotation,i=!To(t.position),a=!To(t.zoom),c=new sk(i?this.viewer.dataHelper.cleanPosition(t.position):void 0,t.zoom);this.viewer.dispatchEvent(c);const o=new Sh,f=this.viewer.adapter.createMesh(e.panoData);if(this.viewer.adapter.setTexture(f,e,!0),this.viewer.adapter.setTextureOpacity(f,0),this.setPanoramaPose(e.panoData,f),this.setSphereCorrection(t.sphereCorrection,o),i&&!n.rotation){const M=this.viewer.getPosition(),C=new dt(0,1,0);o.rotateOnWorldAxis(C,c.position.yaw-M.yaw);const A=new dt(0,1,0).cross(this.camera.getWorldDirection(new dt)).normalize();o.rotateOnWorldAxis(A,c.position.pitch-M.pitch)}o.add(f),this.scene.add(o),this.renderer.setRenderTarget(new Zh),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:g,properties:_}=this.viewer.dataHelper.getAnimationProperties(n.speed,n.rotation?c.position:null,r?c.zoomLevel:null),x=new zS({properties:{..._,opacity:{start:0,end:1}},duration:g,easing:"inOutCubic",onTick:M=>{switch(n.effect){case"fade":this.viewer.adapter.setTextureOpacity(f,M.opacity);break;case"black":case"white":M.opacity<.5?this.renderer.toneMappingExposure=n.effect==="black"?mr.mapLinear(M.opacity,0,.5,1,0):mr.mapLinear(M.opacity,0,.5,1,4):(this.renderer.toneMappingExposure=n.effect==="black"?mr.mapLinear(M.opacity,.5,1,0,1):mr.mapLinear(M.opacity,.5,1,4,1),this.mesh.visible=!1,this.viewer.adapter.setTextureOpacity(f,1),a&&!r&&this.viewer.dynamics.zoom.setValue(c.zoomLevel));break}i&&n.rotation&&this.viewer.dynamics.position.setValue({yaw:M.yaw,pitch:M.pitch}),a&&r&&this.viewer.dynamics.zoom.setValue(M.zoom),this.viewer.needsUpdate()}});return x.then(M=>{o.remove(f),this.scene.remove(o),M?(this.viewer.adapter.disposeTexture(this.state.textureData),this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh),this.mesh=f,this.meshContainer.add(f),this.state.textureData=e,this.setPanoramaPose(e.panoData),this.setSphereCorrection(t.sphereCorrection),i&&!n.rotation&&this.viewer.rotate(t.position)):(this.viewer.adapter.disposeTexture(e),this.viewer.adapter.disposeMesh(f))}),x}getIntersections(e){var n;Rb.x=2*e.x/this.state.size.width-1,Rb.y=-2*e.y/this.state.size.height+1,this.raycaster.setFromCamera(Rb,this.camera);const t=this.raycaster.intersectObjects(this.scene.children,!0).filter(r=>r.object.visible).filter(r=>r.object.isMesh&&!!r.object.userData);return(n=this.customRenderer)!=null&&n.getIntersections&&t.push(...this.customRenderer.getIntersections(this.raycaster,Rb)),t}isObjectVisible(e){if(!e)return!1;if(this.frustumNeedsUpdate&&(NB.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(NB),this.frustumNeedsUpdate=!1),e.isVector3)return this.frustum.containsPoint(e);if(e.isMesh&&e.geometry){const t=e;return t.geometry.boundingBox||t.geometry.computeBoundingBox(),BB.copy(t.geometry.boundingBox).applyMatrix4(t.matrixWorld),this.frustum.intersectsBox(BB)}else return e.isObject3D?this.frustum.intersectsObject(e):!1}addObject(e){this.scene.add(e)}removeObject(e){this.scene.remove(e)}cleanScene(e){const t=n=>{var r;(r=n.map)==null||r.dispose(),n.uniforms&&Object.values(n.uniforms).forEach(i=>{var a,c;(c=(a=i.value)==null?void 0:a.dispose)==null||c.call(a)}),n.dispose()};e.traverse(n=>{var r,i;(r=n.geometry)==null||r.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(a=>{t(a)}):t(n.material)),n instanceof PS||(i=n.dispose)==null||i.call(n),n!==e&&this.cleanScene(n)})}},cAe=class extends KL{load(e,t,n,r,i){const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(a,{signal:i}).then(c=>{if(c.status===200||c.status===0){const o=c.body.getReader(),f=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),g=f?parseInt(f):0,_=g!==0;let x=0;const M=new ReadableStream({start(C){A();function A(){o.read().then(({done:L,value:I})=>{if(L)C.close();else{x+=I.byteLength;const T=new ProgressEvent("progress",{lengthComputable:_,loaded:x,total:g});n(T),C.enqueue(I),A()}}).catch(L=>{r(L)})}}});return new Response(M)}else throw new Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>c.blob()).then(c=>{t(c)}).catch(c=>{r(c)})}},uAe=class extends KL{load(e,t,n,r){const i=document.createElement("img");function a(){f(),t(this)}function c(g){if(f(),r!=null&&r.aborted){const _=new Error;_.name="AbortError",_.message="The operation was aborted.",n(_)}else n(g)}function o(){i.src=""}function f(){i.removeEventListener("load",a,!1),i.removeEventListener("error",c,!1),r==null||r.removeEventListener("abort",o,!1)}return i.addEventListener("load",a,!1),i.addEventListener("error",c,!1),r==null||r.addEventListener("abort",o,!1),e.startsWith("data:")||(i.crossOrigin=this.withCredentials?"use-credentials":"anonymous"),i.src=e,i}},hAe=class extends _x{constructor(e){super(e),this.abortCtrl={},this.fileLoader=new cAe,this.imageLoader=new uAe}destroy(){this.abortLoading(),super.destroy()}abortLoading(){Object.values(this.abortCtrl).forEach(e=>e.abort()),this.abortCtrl={}}loadFile(e,t,n){const r=wm.get(e,n);if(r){if(r instanceof Blob)return t==null||t(100),Promise.resolve(r);wm.remove(e,n)}return this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(e)),this.fileLoader.setWithCredentials(this.config.withCredentials(e)),new Promise((i,a)=>{let c=0;t==null||t(c),this.fileLoader.load(e,o=>{c=100,t==null||t(c),wm.add(e,n,o),i(o)},o=>{if(o.lengthComputable){const f=o.loaded/o.total*100;f>c&&(c=f,t==null||t(c))}},o=>{a(o)},this.__getAbortSignal(n))})}loadImage(e,t,n){const r=wm.get(e,n);return r?(t==null||t(100),r instanceof Blob?this.blobToImage(r):Promise.resolve(r)):!t&&!this.config.requestHeaders?(this.imageLoader.setWithCredentials(this.config.withCredentials(e)),new Promise((i,a)=>{this.imageLoader.load(e,c=>{wm.add(e,n,c),i(c)},c=>{a(c)},this.__getAbortSignal(n))})):this.loadFile(e,t,n).then(i=>this.blobToImage(i))}blobToImage(e){return new Promise((t,n)=>{const r=document.createElement("img");r.onload=()=>{URL.revokeObjectURL(r.src),t(r)},r.onerror=n,r.src=URL.createObjectURL(e)})}preloadPanorama(e){return this.viewer.adapter.supportsPreload(e)?this.viewer.adapter.loadTexture(e,!1):Promise.reject(new Sn("Current adapter does not support preload"))}dispatchProgress(e){this.viewer.loader.setProgress(e),this.viewer.dispatchEvent(new qH(Math.round(e)))}__getAbortSignal(e){var t;return e?((t=this.abortCtrl[e])!=null&&t.signal.aborted&&delete this.abortCtrl[e],this.abortCtrl[e]||(this.abortCtrl[e]=new AbortController),this.abortCtrl[e].signal):null}},dAe=class extends _x{constructor(e){super(e),this.zoom=new ey(t=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(t),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new ou(t))},{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new dH(t=>{this.viewer.dataHelper.sphericalCoordsToVector3(t,this.viewer.state.direction),this.viewer.dispatchEvent(new Ay(t))},{yaw:new ey(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new ey(null,{defaultValue:this.config.defaultPitch,min:-Math.PI/2,max:Math.PI/2,wrap:!1})}),this.roll=new ey(t=>{this.viewer.state.roll=t,this.viewer.dispatchEvent(new Iy(t))},{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(this.config.zoomSpeed*50),this.position.setSpeed(mr.degToRad(this.config.moveSpeed*50)),this.roll.setSpeed(mr.degToRad(this.config.moveSpeed*50))}update(e){this.zoom.update(e),this.position.update(e),this.roll.update(e)}},fAe=class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new dt(0,0,jf),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},pAe=class extends mH{constructor(e){var t,n,r;if(super(),this.plugins={},this.children=[],this.parent=X7(e.container),!this.parent)throw new Sn('"container" element not found.');this.parent[Kh]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),uH(this.parent),cH(this.container,"core"),this.state=new fAe,this.config=ZPe(e),this.__setSize(this.config.size),this.overlay=new QPe(this);try{_s.load()}catch(i){console.error(i),this.showError(this.config.lang.webglError);return}wm.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new lAe(this),this.textureLoader=new hAe(this),this.eventsHandler=new aAe(this),this.dataHelper=new iAe(this),this.dynamics=new dAe(this),(n=(t=this.adapter).init)==null||n.call(t),this.loader=new KPe(this),this.navbar=new YPe(this),this.panel=new tAe(this),this.notification=new JPe(this),this.autoSize(),this.setCursor(null),nk(_s.isTouchEnabled,i=>{v2(this.container,"psv--is-touch",i)}),this.config.plugins.forEach(([i,a])=>{this.plugins[i.id]=new i(this,a)});for(const i of Object.values(this.plugins))(r=i.init)==null||r.call(i);this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama,{sphereCorrection:this.config.sphereCorrection,panoData:this.config.panoData}):this.loader.show())}destroy(){var e,t,n,r,i,a;this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[c,o]of Object.entries(this.plugins))o.destroy(),delete this.plugins[c];this.children.slice().forEach(c=>c.destroy()),this.children.length=0,(e=this.eventsHandler)==null||e.destroy(),(t=this.renderer)==null||t.destroy(),(n=this.textureLoader)==null||n.destroy(),(r=this.dataHelper)==null||r.destroy(),(i=this.adapter)==null||i.destroy(),(a=this.dynamics)==null||a.destroy(),this.parent.removeChild(this.container),delete this.parent[Kh]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),this.config.keyboard==="always"&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new Ry)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(e){if(typeof e=="string")return this.plugins[e];{const t=KI(e);return t?this.plugins[t.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return{...this.state.size}}isFullscreenEnabled(){return J7(this.parent,_s.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(e){e?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){(this.container.clientWidth!==this.state.size.width||this.container.clientHeight!==this.state.size.height)&&(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new ky(this.getSize())),this.navbar.autoSize())}setPanorama(e,t={}){var a;this.textureLoader.abortLoading(),(a=this.state.transitionAnimation)==null||a.cancel();const n=this.dataHelper.getTransitionOptions(t);t.showLoader===void 0&&(t.showLoader=!0),t.caption===void 0&&(t.caption=this.config.caption),t.description===void 0&&(t.description=this.config.description),!t.panoData&&typeof this.config.panoData=="function"&&(t.panoData=this.config.panoData),this.hideError(),this.resetIdleTimer(),this.config.panorama=e,this.config.caption=t.caption,this.config.description=t.description,this.config.sphereCorrection=t.sphereCorrection;const r=c=>{if(sH(c))return!1;if(this.loader.hide(),this.state.loadingPromise=null,c)throw this.navbar.setCaption(null),this.showError(this.config.lang.loadError),console.error(c),this.dispatchEvent(new tG(e,c)),c;return this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption(`<em>${this.config.lang.loading}</em>`),(t.showLoader||!this.state.ready)&&this.loader.show(),this.dispatchEvent(new YH(e));const i=this.adapter.loadTexture(this.config.panorama,!0,t.panoData).then(c=>{if(c.panorama!==this.config.panorama)throw this.adapter.disposeTexture(c),WI();const o=this.dataHelper.cleanPanoramaOptions(t,c.panoData);return(!To(o.zoom)||!To(o.position))&&this.stopAll(),{textureData:c,cleanOptions:o}});return!n||!this.state.ready||!this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=i.then(({textureData:c,cleanOptions:o})=>{this.renderer.show(),this.renderer.setTexture(c),this.renderer.setPanoramaPose(c.panoData),this.renderer.setSphereCorrection(t.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new hg(c)),To(o.zoom)||this.zoom(o.zoom),To(o.position)||this.rotate(o.position)}).then(()=>r(),c=>r(c)):this.state.loadingPromise=i.then(({textureData:c,cleanOptions:o})=>(this.loader.hide(),this.dispatchEvent(new hg(c)),this.state.transitionAnimation=this.renderer.transition(c,o,n),this.state.transitionAnimation)).then(c=>{if(this.state.transitionAnimation=null,this.dispatchEvent(new iG(c)),!c)throw WI()}).then(()=>r(),c=>r(c)),this.state.loadingPromise}setOptions(e){const t={...this.config,...e};for(let[n,r]of Object.entries(e)){if(!(n in yu)){Vo(`Unknown option ${n}`);continue}if(n in FB){Vo(FB[n]);continue}switch(n in JI&&(r=JI[n](r,{rawConfig:t,defValue:yu[n]})),this.config[n]=r,n){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new ou(this.getZoomLevel()));break;case"keyboard":this.config.keyboard==="always"?this.startKeyboardControl():this.stopKeyboardControl();break}}this.needsUpdate(),this.dispatchEvent(new Gs(Object.keys(e)))}setOption(e,t){this.setOptions({[e]:t})}showError(e){this.overlay.show({id:$o.ERROR,image:rAe,title:e,dismissible:!1})}hideError(){this.overlay.hide($o.ERROR)}rotate(e){const t=new wH(this.dataHelper.cleanPosition(e));this.dispatchEvent(t),!t.defaultPrevented&&this.dynamics.position.setValue(t.position)}zoom(e){this.dynamics.zoom.setValue(e)}zoomIn(e=1){this.dynamics.zoom.step(e)}zoomOut(e=1){this.dynamics.zoom.step(-e)}animate(e){const t=rk(e),n=!To(e.zoom),r=new sk(t?this.dataHelper.cleanPosition(e):void 0,e.zoom);if(this.dispatchEvent(r),r.defaultPrevented)return;this.stopAll();const{duration:i,properties:a}=this.dataHelper.getAnimationProperties(e.speed,r.position,r.zoomLevel);return i?(this.state.animation=new zS({properties:a,duration:i,easing:e.easing||"inOutSine",onTick:c=>{t&&this.dynamics.position.setValue({yaw:c.yaw,pitch:c.pitch}),n&&this.dynamics.zoom.setValue(c.zoom)}}),this.state.animation.then(()=>{this.state.animation=null,this.resetIdleTimer()}),this.state.animation):(t&&this.rotate(r.position),n&&this.zoom(r.zoomLevel),new zS(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(e){this.__setSize(e),this.autoSize()}__setSize(e){["width","height"].forEach(t=>{e!=null&&e[t]&&(/^[0-9.]+$/.test(e[t])&&(e[t]+="px"),this.parent.style[t]=e[t])})}enterFullscreen(){this.isFullscreenEnabled()||Q7(this.parent,_s.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&eH(_s.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(e){return new nAe(this,e)}setCursor(e){this.state.cursorOverride=e,e?this.container.style.cursor=e:this.container.style.cursor=this.config.mousemove?"move":"default"}observeObjects(e){this.state.objectsObservers[e]||(this.state.objectsObservers[e]=null)}unobserveObjects(e){delete this.state.objectsObservers[e]}stopAll(){return this.dispatchEvent(new Dy),this.disableIdleTimer(),this.stopAnimation()}};/*!
 * Photo Sphere Viewer / Equirectangular Tiles Adapter 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var mAe=class{constructor(e,t,n){this.id=e,this.priority=t,this.fn=n,this.status=1}start(){return this.status=2,this.fn(this).then(()=>{this.status=4},()=>{this.status=5})}cancel(){this.status=3}isCancelled(){return this.status===3}},gAe=class{constructor(t=8){this.concurency=t,this.runningTasks={},this.tasks={}}enqueue(t){this.tasks[t.id]=t}clear(){Object.values(this.tasks).forEach(t=>t.cancel()),this.tasks={},this.runningTasks={}}setPriority(t,n){const r=this.tasks[t];r&&(r.priority=n,r.status===0&&(r.status=1))}disableAllTasks(){Object.values(this.tasks).forEach(t=>{t.status=0})}start(){if(Object.keys(this.runningTasks).length>=this.concurency)return;const t=Object.values(this.tasks).filter(n=>n.status===1).sort((n,r)=>r.priority-n.priority).pop();t&&(this.runningTasks[t.id]=!0,t.start().then(()=>{t.isCancelled()||(delete this.tasks[t.id],delete this.runningTasks[t.id],this.start())}),this.start())}};function vAe(e){let t=0;e.forEach((n,r)=>{if(!n.zoomRange||n.zoomRange.length!==2)throw new Sn(`Tiles level ${r} is missing "zoomRange" property`);if(n.zoomRange[0]>=n.zoomRange[1]||n.zoomRange[0]!==t||r===0&&n.zoomRange[0]!==0||r===e.length-1&&n.zoomRange[1]!==100)throw new Sn(`Tiles levels' "zoomRange" are not orderer or are not covering the whole 0-100 range`);t=n.zoomRange[1]})}function yAe(e,t){return e.findIndex(n=>t>=n.zoomRange[0]&&t<=n.zoomRange[1])}function _Ae(){const e=new OffscreenCanvas(512,512),t=e.getContext("2d");return t.fillStyle="#333",t.fillRect(0,0,e.width,e.height),t.font=`${e.width/5}px serif`,t.fillStyle="#a22",t.textAlign="center",t.textBaseline="middle",t.fillText("",e.width/2,e.height/2),new Yh({map:Dn.createTexture(e)})}function xAe(e){const t=new kMe(e),n=new RMe(t);return n.material.depthTest=!1,n.material.depthWrite=!1,n.material.opacity=.25,n.material.transparent=!0,n}var UB=["dodgerblue","limegreen","indianred"];function bAe(e,t,n){const r=document.createElement("canvas");r.width=e.width,r.height=e.height;const i=r.getContext("2d");i.fillStyle=UB[t%UB.length],i.fillRect(0,0,r.width,r.height),i.globalCompositeOperation="multiply",i.drawImage(e,0,0);const a=e.width/7;return i.globalCompositeOperation="source-over",i.fillStyle="white",i.font=`${a}px monospace`,i.textAlign="center",n.split(`
`).forEach((c,o)=>{i.fillText(c,e.width/2,e.height/2+a*(.3+o))}),r}function dk(e){return!!e.levels}function JG(e,t,n){return{...e,level:t,colSize:e.width/e.cols,rowSize:e.width/2/e.rows,facesByCol:n.SPHERE_SEGMENTS/e.cols,facesByRow:n.SPHERE_HORIZONTAL_SEGMENTS/e.rows}}function $B(e,t,n){let r,i;return dk(e)?(i=yAe(e.levels,t),r=e.levels[i]):(i=0,r={...e,zoomRange:[0,100]}),JG(r,i,n)}function wAe(e,t,n){return!dk(e)||!e.levels[t]?null:JG(e.levels[t],t,n)}function SAe(e,t){if(typeof e!="object"||!e.tileUrl)throw new Sn("Invalid panorama configuration, are you using the right adapter?");dk(e)?(e.levels.forEach(n=>VB(n,t)),vAe(e.levels)):VB(e,t)}function VB(e,t){if(!e.width||!e.cols||!e.rows)throw new Sn("Invalid panorama configuration, are you using the right adapter?");if(e.cols>t.SPHERE_SEGMENTS)throw new Sn(`Panorama cols must not be greater than ${t.SPHERE_SEGMENTS}.`);if(e.rows>t.SPHERE_HORIZONTAL_SEGMENTS)throw new Sn(`Panorama rows must not be greater than ${t.SPHERE_HORIZONTAL_SEGMENTS}.`);if(!mr.isPowerOfTwo(e.cols)||!mr.isPowerOfTwo(e.rows))throw new Sn("Panorama cols and rows must be powers of 2.")}function MAe(e,t){for(let n=0;n<t.cols;n++){const r=e.tileUrl(n,t.rows/2,t.level);if(r)return r}return e.tileUrl.toString()}var F0=6,Rs=3,CAe="uv",EAe="position",jB=-1;function gP(e){return`${e.col}x${e.row}/${e.config.level}`}function Lb(e){return e.children}var TAe=Dn.getConfigParser({resolution:64,showErrorTile:!0,baseBlur:!0,antialias:!0,debug:!1,useXmpData:!1}),kb=new dt,E2=class QG extends S2{constructor(t,n){super(t),this.state={tileConfig:null,tiles:{},faces:{},geom:null,materials:[],errorMaterial:null,inTransition:!1},this.queue=new gAe,this.config=TAe(n),this.adapter=new ak(this.viewer,{resolution:this.config.resolution,blur:this.config.baseBlur}),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2,this.NB_VERTICES=2*this.SPHERE_SEGMENTS*Rs+(this.SPHERE_HORIZONTAL_SEGMENTS-2)*this.SPHERE_SEGMENTS*F0,this.NB_GROUPS=this.SPHERE_SEGMENTS*this.SPHERE_HORIZONTAL_SEGMENTS,this.viewer.config.requestHeaders&&Dn.logWarn('EquirectangularTilesAdapter fallbacks to file loader because "requestHeaders" where provided. Consider removing "requestHeaders" if you experience performances issues.')}static withConfig(t){return[QG,t]}init(){super.init(),this.viewer.addEventListener(Fn.TransitionDoneEvent.type,this),this.viewer.addEventListener(Fn.PositionUpdatedEvent.type,this),this.viewer.addEventListener(Fn.ZoomUpdatedEvent.type,this)}destroy(){var t,n,r;this.viewer.removeEventListener(Fn.TransitionDoneEvent.type,this),this.viewer.removeEventListener(Fn.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(Fn.ZoomUpdatedEvent.type,this),this.__cleanup(),(n=(t=this.state.errorMaterial)==null?void 0:t.map)==null||n.dispose(),(r=this.state.errorMaterial)==null||r.dispose(),this.adapter.destroy(),delete this.adapter,delete this.state.geom,delete this.state.errorMaterial,super.destroy()}handleEvent(t){switch(t.type){case Fn.PositionUpdatedEvent.type:case Fn.ZoomUpdatedEvent.type:this.__refresh();break;case Fn.TransitionDoneEvent.type:this.state.inTransition=!1,t.completed&&this.__switchMesh(this.viewer.renderer.mesh);break}}supportsTransition(t){return!!t.baseUrl}supportsPreload(t){return!!t.baseUrl}textureCoordsToSphericalCoords(t,n){return this.adapter.textureCoordsToSphericalCoords(t,n)}sphericalCoordsToTextureCoords(t,n){return this.adapter.sphericalCoordsToTextureCoords(t,n)}async loadTexture(t,n=!0){SAe(t,this);const r=$B(t,0,this),i={isEquirectangular:!0,fullWidth:r.width,fullHeight:r.width/2,croppedWidth:r.width,croppedHeight:r.width/2,croppedX:0,croppedY:0,poseHeading:0,posePitch:0,poseRoll:0};if(t.baseUrl){const a=await this.adapter.loadTexture(t.baseUrl,n,t.basePanoData,!0);return{panorama:t,panoData:{...i,baseData:a.panoData},cacheKey:a.cacheKey,texture:a.texture}}else return{panorama:t,panoData:{...i,baseData:null},cacheKey:MAe(t,r),texture:null}}createMesh(t){const n=this.adapter.createMesh(t.baseData??t),r=new Kg(Fg.SPHERE_RADIUS,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1).toNonIndexed();r.clearGroups();let i=0,a=0;for(;i<this.SPHERE_SEGMENTS*Rs;i+=Rs)r.addGroup(i,Rs,a++);for(;i<this.NB_VERTICES-this.SPHERE_SEGMENTS*Rs;i+=F0)r.addGroup(i,F0,a++);for(;i<this.NB_VERTICES;i+=Rs)r.addGroup(i,Rs,a++);const c=[],o=new Yh({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1});for(let _=0;_<this.NB_GROUPS;_++)c.push(o);const f=new Ns(r,c);f.renderOrder=1;const g=new Sh;return g.add(n),g.add(f),g}setTexture(t,n,r){const[i]=Lb(t);n.texture?this.adapter.setTexture(i,{panorama:n.panorama.baseUrl,texture:n.texture,panoData:n.panoData.baseData}):i.visible=!1,r?this.state.inTransition=!0:this.__switchMesh(t)}setTextureOpacity(t,n){const[r]=Lb(t);this.adapter.setTextureOpacity(r,n)}disposeTexture({texture:t}){t==null||t.dispose()}disposeMesh(t){const[n,r]=Lb(t);n.geometry.dispose(),n.material.dispose(),r.geometry.dispose(),r.material.forEach(i=>{var a;(a=i.map)==null||a.dispose(),i.dispose()})}__refresh(){if(!this.state.geom||this.state.inTransition)return;const t=this.viewer.config.panorama,n=this.viewer.getZoomLevel(),r=$B(t,n,this),i=this.state.geom.getAttribute(EAe),a={};for(let c=0;c<this.NB_VERTICES;c+=1)if(kb.fromBufferAttribute(i,c),kb.applyEuler(this.viewer.renderer.sphereCorrection),this.viewer.renderer.isObjectVisible(kb)){let o;c<this.SPHERE_SEGMENTS*Rs?o=Math.floor(c/3):c<this.NB_VERTICES-this.SPHERE_SEGMENTS*Rs?o=Math.floor((c/3-this.SPHERE_SEGMENTS)/2)+this.SPHERE_SEGMENTS:o=Math.floor((c-this.NB_VERTICES-this.SPHERE_SEGMENTS*Rs)/3)+this.SPHERE_HORIZONTAL_SEGMENTS*(this.SPHERE_SEGMENTS-1);const f=Math.floor(o/this.SPHERE_SEGMENTS),g=o-f*this.SPHERE_SEGMENTS;let _=r;for(;_;){const x=Math.floor(f/_.facesByRow),M=Math.floor(g/_.facesByCol);let C=kb.angleTo(this.viewer.state.direction);(x===0||x===_.rows-1)&&(C*=2);const A={row:x,col:M,angle:C,config:_,url:null},L=gP(A);if(a[L]){a[L].angle=Math.min(a[L].angle,C);break}else if(A.url=t.tileUrl(M,x,_.level),A.url){a[L]=A;break}else _=wAe(t,_.level-1,this)}}this.state.tileConfig=r,this.__loadTiles(Object.values(a))}__loadTiles(t){this.queue.disableAllTasks(),t.forEach(n=>{const r=gP(n);this.state.tiles[r]?this.queue.setPriority(r,n.angle):(this.state.tiles[r]=!0,this.queue.enqueue(new mAe(r,n.angle,i=>this.__loadTile(n,i))))}),this.queue.start()}__loadTile(t,n){return this.viewer.textureLoader.loadImage(t.url,null,this.viewer.state.textureData.cacheKey).then(r=>{if(!n.isCancelled()){this.config.debug&&(r=bAe(r,t.config.level,gP(t)));const i=this.config.antialias&&t.config.level>0,a=new Yh({map:Dn.createTexture(r,i)});this.__swapMaterial(t,a,!1),this.viewer.needsUpdate()}}).catch(r=>{!Dn.isAbortError(r)&&!n.isCancelled()&&this.config.showErrorTile&&(this.state.errorMaterial||(this.state.errorMaterial=_Ae()),this.__swapMaterial(t,this.state.errorMaterial,!0),this.viewer.needsUpdate())})}__swapMaterial(t,n,r){const i=this.state.geom.getAttribute(CAe);for(let a=0;a<t.config.facesByCol;a++)for(let c=0;c<t.config.facesByRow;c++){const o=t.col*t.config.facesByCol+a,f=t.row*t.config.facesByRow+c,g=f===0,_=f===this.SPHERE_HORIZONTAL_SEGMENTS-1;let x;if(g?x=o*Rs:_?x=this.NB_VERTICES-this.SPHERE_SEGMENTS*Rs+o*Rs:x=this.SPHERE_SEGMENTS*Rs+(f-1)*this.SPHERE_SEGMENTS*F0+o*F0,r&&this.state.faces[x]>jB||this.state.faces[x]>t.config.level)continue;this.state.faces[x]=r?jB:t.config.level;const M=this.state.geom.groups.find(T=>T.start===x).materialIndex;this.state.materials[M]=n;const C=1-c/t.config.facesByRow,A=1-(c+1)/t.config.facesByRow,L=a/t.config.facesByCol,I=(a+1)/t.config.facesByCol;g?(i.setXY(x,(L+I)/2,C),i.setXY(x+1,L,A),i.setXY(x+2,I,A)):_?(i.setXY(x,I,C),i.setXY(x+1,L,C),i.setXY(x+2,(L+I)/2,A)):(i.setXY(x,I,C),i.setXY(x+1,L,C),i.setXY(x+2,I,A),i.setXY(x+3,L,C),i.setXY(x+4,L,A),i.setXY(x+5,I,A))}i.needsUpdate=!0}__switchMesh(t){const[,n]=Lb(t);if(this.__cleanup(),this.state.materials=n.material,this.state.geom=n.geometry,this.config.debug){const r=xAe(this.state.geom);this.viewer.renderer.addObject(r),this.viewer.renderer.setSphereCorrection(this.viewer.config.sphereCorrection,r)}setTimeout(()=>this.__refresh())}__cleanup(){this.queue.clear(),this.state.tiles={},this.state.faces={},this.state.materials=[],this.state.inTransition=!1}};E2.id="equirectangular-tiles";E2.VERSION="5.13.4";E2.supportsDownload=!1;var eW=E2;function HB(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function PAe(e){if(Array.isArray(e))return e}function AAe(e,t,n){return(t=kAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,c,o=[],f=!0,g=!1;try{if(a=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;f=!1}else for(;!(f=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);f=!0);}catch(_){g=!0,i=_}finally{try{if(!f&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(g)throw i}}return o}}function RAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function eR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GB(Object(n),!0).forEach(function(r){AAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Sm(e,t){return PAe(e)||IAe(e,t)||DAe(e,t)||RAe()}function LAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kAe(e){var t=LAe(e,"string");return typeof t=="symbol"?t:t+""}function FS(e){"@babel/helpers - typeof";return FS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FS(e)}function DAe(e,t){if(e){if(typeof e=="string")return HB(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?HB(e,t):void 0}}function zAe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var tW={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(f,g,_){this.fn=f,this.context=g,this.once=_||!1}function a(f,g,_,x,M){if(typeof _!="function")throw new TypeError("The listener must be a function");var C=new i(_,x||f,M),A=n?n+g:g;return f._events[A]?f._events[A].fn?f._events[A]=[f._events[A],C]:f._events[A].push(C):(f._events[A]=C,f._eventsCount++),f}function c(f,g){--f._eventsCount===0?f._events=new r:delete f._events[g]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var g=[],_,x;if(this._eventsCount===0)return g;for(x in _=this._events)t.call(_,x)&&g.push(n?x.slice(1):x);return Object.getOwnPropertySymbols?g.concat(Object.getOwnPropertySymbols(_)):g},o.prototype.listeners=function(g){var _=n?n+g:g,x=this._events[_];if(!x)return[];if(x.fn)return[x.fn];for(var M=0,C=x.length,A=new Array(C);M<C;M++)A[M]=x[M].fn;return A},o.prototype.listenerCount=function(g){var _=n?n+g:g,x=this._events[_];return x?x.fn?1:x.length:0},o.prototype.emit=function(g,_,x,M,C,A){var L=n?n+g:g;if(!this._events[L])return!1;var I=this._events[L],T=arguments.length,z,k;if(I.fn){switch(I.once&&this.removeListener(g,I.fn,void 0,!0),T){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,_),!0;case 3:return I.fn.call(I.context,_,x),!0;case 4:return I.fn.call(I.context,_,x,M),!0;case 5:return I.fn.call(I.context,_,x,M,C),!0;case 6:return I.fn.call(I.context,_,x,M,C,A),!0}for(k=1,z=new Array(T-1);k<T;k++)z[k-1]=arguments[k];I.fn.apply(I.context,z)}else{var U=I.length,H;for(k=0;k<U;k++)switch(I[k].once&&this.removeListener(g,I[k].fn,void 0,!0),T){case 1:I[k].fn.call(I[k].context);break;case 2:I[k].fn.call(I[k].context,_);break;case 3:I[k].fn.call(I[k].context,_,x);break;case 4:I[k].fn.call(I[k].context,_,x,M);break;default:if(!z)for(H=1,z=new Array(T-1);H<T;H++)z[H-1]=arguments[H];I[k].fn.apply(I[k].context,z)}}return!0},o.prototype.on=function(g,_,x){return a(this,g,_,x,!1)},o.prototype.once=function(g,_,x){return a(this,g,_,x,!0)},o.prototype.removeListener=function(g,_,x,M){var C=n?n+g:g;if(!this._events[C])return this;if(!_)return c(this,C),this;var A=this._events[C];if(A.fn)A.fn===_&&(!M||A.once)&&(!x||A.context===x)&&c(this,C);else{for(var L=0,I=[],T=A.length;L<T;L++)(A[L].fn!==_||M&&!A[L].once||x&&A[L].context!==x)&&I.push(A[L]);I.length?this._events[C]=I.length===1?I[0]:I:c(this,C)}return this},o.prototype.removeAllListeners=function(g){var _;return g?(_=n?n+g:g,this._events[_]&&c(this,_)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o})(tW);var OAe=tW.exports,FAe=zAe(OAe),Db=new FAe,Ls={on:function(t,n){return Db.on(t,n)},once:function(t,n){return Db.once(t,n)},off:function(t,n){return Db.off(t,n)},emit:function(t,n){return Db.emit(t,n)}};Object.freeze(Ls);var NAe=["src","height","width","hideNavbarButton","containerClass","littlePlanet","onPositionChange","onZoomChange","onClick","onDblclick","onReady"],tR=["zoom","fullscreen"];function BAe(e){var t=eR({},e);for(var n in t)NAe.includes(n)&&delete t[n];return t}function UAe(e,t,n,r,i){return(e-t)*(i-r)/(n-t)+r}function WB(e){return e==null?tR:Array.isArray(e)?e:typeof e=="string"?e===""?!1:[e]:e?tR:!1}function $Ae(){var e=$.useState(),t=Sm(e,2),n=t[0],r=t[1],i=$.useCallback(function(a){a&&a!==n&&r(a)},[n]);return[n,i]}var fk=$.forwardRef(function(e,t){var n=$Ae(),r=Sm(n,2),i=r[0],a=r[1],c=$.useMemo(function(){return e},[e.panorama,e.src,e.size,e.canvasBackground,e.navbar,e.height,e.width,e.containerClass,e.hideNavbarButton||!0,e.littlePlanet,e.fishEye,e.lang,e.onPositionChange,e.onZoomChange,e.onClick,e.onDblclick,e.onReady,e.moveSpeed,e.zoomSpeed,e.moveInertia,e.mousewheel,e.mousemove,e.mousewheelCtrlKey,e.touchmoveTwoFingers,e.panoData,e.requestHeaders,e.withCredentials,e.keyboard,e.keyboardActions,e.plugins,e.adapter,e.sphereCorrection,e.minFov,e.maxFov,e.defaultZoomLvl,e.defaultYaw,e.defaultPitch,e.caption,e.description,e.downloadUrl,e.downloadName,e.loadingImg,e.loadingTxt,e.rendererParameters,e.defaultTransition]),o=$.useRef(null),f=130,g=$.useState(-90),_=Sm(g,1),x=_[0],M=$.useState(2),C=Sm(M,1),A=C[0],L=$.useState(0),I=Sm(L,1),T=I[0],z=$.useState(tR),k=Sm(z,2),U=k[0],H=k[1],V=$.useRef(!0);$.useEffect(function(){function J(){var Y=window.innerWidth/window.innerHeight;f=Math.floor(UAe(Y,.5,1.8,140,115))}return window.addEventListener("resize",J),J(),function(){return window.removeEventListener("resize",J)}},[]),$.useEffect(function(){if(i&&!o.current){var J,Y,N,ne,ye,ge,Ne,Ae,ve,Se=new pAe(eR(eR({},BAe(c)),{},{container:i,panorama:c.panorama||c.src,size:{height:c.height,width:c.width||"100px"},fisheye:c.littlePlanet?A:c.fisheye||!1,minFov:(J=c.minFov)!==null&&J!==void 0?J:30,maxFov:c.littlePlanet?f:(Y=c.maxFov)!==null&&Y!==void 0?Y:90,defaultZoomLvl:c.littlePlanet?T:(N=c.defaultZoomLvl)!==null&&N!==void 0?N:50,defaultYaw:(ne=c.defaultYaw)!==null&&ne!==void 0?ne:0,defaultPitch:c.littlePlanet?x:(ye=c.defaultPitch)!==null&&ye!==void 0?ye:0,sphereCorrection:c.sphereCorrection||{pan:0,tilt:0,roll:0},moveSpeed:c.moveSpeed||1,zoomSpeed:c.zoomSpeed||1,moveInertia:(ge=c.moveInertia)!==null&&ge!==void 0?ge:!0,mousewheel:c.littlePlanet?!1:(Ne=c.mousewheel)!==null&&Ne!==void 0?Ne:!0,mousemove:(Ae=c.mousemove)!==null&&Ae!==void 0?Ae:!0,mousewheelCtrlKey:c.mousewheelCtrlKey||!1,touchmoveTwoFingers:c.touchmoveTwoFingers||!1,panoData:c.panoData||void 0,requestHeaders:c.requestHeaders||void 0,withCredentials:c.withCredentials||!1,navbar:WB(c.navbar),lang:c.lang||{},keyboard:c.keyboard||"fullscreen",plugins:(ve=c.plugins)!==null&&ve!==void 0?ve:[]}));Se.addEventListener("ready",function(){c.onReady&&c.onReady(Se)},{once:!0}),Se.addEventListener("click",function(je){c.onClick&&c.onClick(je,Se),c.littlePlanet&&V.current&&(V.current=!1,Se.animate({yaw:0,pitch:x,zoom:75,speed:"3rpm"}).then(function(){Se.animate({yaw:0,pitch:0,zoom:90,speed:"10rpm"}).then(function(){var lt;Se.setOption("maxFov",c.maxFov||70),Se.setOption("mousewheel",(lt=c.mousewheel)!==null&&lt!==void 0?lt:!0)})}))}),Se.addEventListener("dblclick",function(je){c.onDblclick&&c.onDblclick(je,Se)}),Se.addEventListener("zoom-updated",function(je){c.onZoomChange&&c.onZoomChange(je,Se)}),Se.addEventListener("position-updated",function(je){c.onPositionChange&&c.onPositionChange(je.position.pitch,je.position.yaw,Se)});var Me=WB(c.navbar);if(c.littlePlanet){var Ue,Qe,st=`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 20C16.4183 20 20 16.4183 20 12C20 11.8805 19.9974 11.7615 19.9922 11.6433C20.2479 11.4141 20.4882 11.1864 20.7118 10.9611C21.0037 10.6672 21.002 10.1923 20.708 9.90049C20.4336 9.628 20.0014 9.61143 19.7077 9.84972C19.4023 8.75248 18.8688 7.75024 18.1616 6.89725C18.4607 6.84611 18.7436 6.8084 19.0087 6.784C19.4212 6.74604 19.7247 6.38089 19.6868 5.96842C19.6488 5.55595 19.2837 5.25235 18.8712 5.29032C18.4474 5.32932 17.9972 5.39638 17.5262 5.48921C17.3267 5.52851 17.1614 5.64353 17.0543 5.79852C15.6765 4.67424 13.917 4 12 4C7.58172 4 4 7.58172 4 12C4 12.2776 4.01414 12.552 4.04175 12.8223C3.78987 12.7532 3.50899 12.8177 3.31137 13.0159C2.97651 13.3517 2.67596 13.6846 2.415 14.0113C2.15647 14.3349 2.20924 14.8069 2.53287 15.0654C2.8565 15.3239 3.32843 15.2711 3.58696 14.9475C3.78866 14.695 4.02466 14.4302 4.2938 14.1557C4.60754 15.2796 5.16056 16.3037 5.8945 17.1697C5.66824 17.3368 5.54578 17.6248 5.60398 17.919C5.68437 18.3253 6.07894 18.5896 6.48528 18.5092C6.7024 18.4662 6.92455 18.4177 7.15125 18.3637C8.49656 19.3903 10.1771 20 12 20ZM7.15125 18.3637C6.69042 18.012 6.26891 17.6114 5.8945 17.1697C5.98073 17.106 6.08204 17.0599 6.19417 17.0377C7.19089 16.8405 8.33112 16.5084 9.55581 16.0486C9.94359 15.903 10.376 16.0994 10.5216 16.4872C10.6671 16.8749 10.4708 17.3073 10.083 17.4529C9.05325 17.8395 8.0653 18.1459 7.15125 18.3637ZM19.7077 9.84972C19.6869 9.86663 19.6667 9.88483 19.6474 9.90431C18.9609 10.5957 18.0797 11.3337 17.0388 12.0753C16.7014 12.3157 16.6228 12.784 16.8631 13.1213C17.1035 13.4587 17.5718 13.5373 17.9091 13.297C18.6809 12.7471 19.3806 12.1912 19.9922 11.6433C19.965 11.0246 19.8676 10.4241 19.7077 9.84972ZM20.9366 5.37924C20.5336 5.28378 20.1294 5.53313 20.034 5.93619C19.9385 6.33925 20.1879 6.74339 20.5909 6.83886C20.985 6.93219 21.1368 7.07125 21.1932 7.16142C21.2565 7.26269 21.3262 7.52732 21.0363 8.10938C20.8516 8.48014 21.0025 8.93042 21.3732 9.1151C21.744 9.29979 22.1943 9.14894 22.379 8.77818C22.7566 8.02003 22.9422 7.12886 22.4648 6.36582C22.1206 5.81574 21.5416 5.52252 20.9366 5.37924ZM2.81481 16.2501C2.94057 15.8555 2.72259 15.4336 2.32793 15.3078C1.93327 15.1821 1.51138 15.4 1.38562 15.7947C1.19392 16.3963 1.17354 17.0573 1.53488 17.6349C1.98775 18.3587 2.84153 18.6413 3.68907 18.7224C4.1014 18.7619 4.46765 18.4596 4.50712 18.0473C4.54658 17.635 4.24432 17.2687 3.83199 17.2293C3.13763 17.1628 2.88355 16.9624 2.80651 16.8393C2.75679 16.7598 2.70479 16.5954 2.81481 16.2501ZM15.7504 14.704C16.106 14.4915 16.2218 14.0309 16.0093 13.6754C15.7967 13.3199 15.3362 13.204 14.9807 13.4166C14.4991 13.7045 13.9974 13.9881 13.4781 14.2648C12.9445 14.5491 12.4132 14.8149 11.8883 15.0615C11.5134 15.2376 11.3522 15.6843 11.5283 16.0592C11.7044 16.4341 12.1511 16.5953 12.526 16.4192C13.0739 16.1618 13.6277 15.8847 14.1834 15.5887C14.7242 15.3005 15.2474 15.0048 15.7504 14.704Z" fill="rgba(255,255,255,.7)"/>
                </svg>`,ct={id:"resetLittlePlanetButton",content:((Ue=e.lang)===null||Ue===void 0?void 0:Ue.littlePlanetIcon)||st,title:((Qe=e.lang)===null||Qe===void 0?void 0:Qe.littlePlanetButton)||"Reset Little Planet",className:"resetLittlePlanetButton",onClick:function(){V.current=!0,Se.setOption("maxFov",f),Se.setOption("mousewheel",!1),Se.animate({yaw:0,pitch:x,zoom:T,speed:"10rpm"})}};Me!==!1&&!Me.find(function(je){return FS(je)==="object"&&(je==null?void 0:je.id)==="resetLittlePlanetButton"})&&Me.splice(1,0,ct)}if(c.hideNavbarButton){var Xt={id:"hideNavbarButton",content:`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">
                            <g clip-path="url(#clip0_429_11083)">
                            <path d="M7 7.00006L17 17.0001M7 17.0001L17 7.00006" stroke="rgba(255,255,255,.7)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </g>
                            <defs>
                            <clipPath id="clip0_429_11083">
                            <rect width="24" height="24" fill="white"/>
                            </clipPath>
                            </defs>
                            </svg>`,title:"Hide Navbar",className:"hideNavbarButton",onClick:function(){Se.navbar.hide();var lt=document.createElement("a");lt.className="showNavbarButton",lt.innerHTML=`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 26 26" style="enable-background:new 0 0 26 26;" xml:space="preserve" class="icon icon-back-to-top">
                                        <g>
                                        <path d="M13.8,1.3L21.6,9c0.1,0.1,0.1,0.3,0.2,0.4c0.1,0.1,0.1,0.3,0.1,0.4s0,0.3-0.1,0.4c-0.1,0.1-0.1,0.3-0.3,0.4
                                            c-0.1,0.1-0.2,0.2-0.4,0.3c-0.2,0.1-0.3,0.1-0.4,0.1c-0.1,0-0.3,0-0.4-0.1c-0.2-0.1-0.3-0.2-0.4-0.3L14.2,5l0,19.1
                                            c0,0.2-0.1,0.3-0.1,0.5c0,0.1-0.1,0.3-0.3,0.4c-0.1,0.1-0.2,0.2-0.4,0.3c-0.1,0.1-0.3,0.1-0.5,0.1c-0.1,0-0.3,0-0.4-0.1
                                            c-0.1-0.1-0.3-0.1-0.4-0.3c-0.1-0.1-0.2-0.2-0.3-0.4c-0.1-0.1-0.1-0.3-0.1-0.5l0-19.1l-5.7,5.7C6,10.8,5.8,10.9,5.7,11
                                            c-0.1,0.1-0.3,0.1-0.4,0.1c-0.2,0-0.3,0-0.4-0.1c-0.1-0.1-0.3-0.2-0.4-0.3c-0.1-0.1-0.1-0.2-0.2-0.4C4.1,10.2,4,10.1,4.1,9.9
                                            c0-0.1,0-0.3,0.1-0.4c0-0.1,0.1-0.3,0.3-0.4l7.7-7.8c0.1,0,0.2-0.1,0.2-0.1c0,0,0.1-0.1,0.2-0.1c0.1,0,0.2,0,0.2-0.1
                                            c0.1,0,0.1,0,0.2,0c0,0,0.1,0,0.2,0c0.1,0,0.2,0,0.2,0.1c0.1,0,0.1,0.1,0.2,0.1C13.7,1.2,13.8,1.2,13.8,1.3z"></path>
                                        </g>
                                        </svg>`,lt.title="Show Navbar",lt.onclick=function(Ot){Ot.preventDefault(),Se.navbar.show(),lt.remove()},document.body.appendChild(lt)}};Me!==!1&&!Me.find(function(je){return FS(je)==="object"&&(je==null?void 0:je.id)==="hideNavbarButton"})&&Me.push(Xt)}Me!==!1?(Se.setOption("navbar",Me),H(Me)):Se.navbar.hide(),Ls.on("animate",function(je){Se.animate(je)}).on("stop-animation",function(){Se.stopAnimation()}).on("destroy",function(){Se.destroy()}).on("rotate",function(je){Se.rotate(je)}).on("setOption",function(je){var lt=je.option,Ot=je.value;Se.setOption(lt,Ot)}).on("setOptions",function(je){Se.setOptions(je)}).on("zoom",function(je){Se.zoom(je)}).on("zoomIn",function(je){Se.zoomIn(je)}).on("zoomOut",function(je){Se.zoomOut(je)}).on("resize",function(je){Se.resize(je)}).on("enterFullscreen",function(){Se.enterFullscreen()}).on("exitFullscreen",function(){Se.exitFullscreen()}).on("toggleFullscreen",function(){Se.toggleFullscreen()}).on("needsContinuousUpdate",function(je){Se.needsContinuousUpdate(je)}).on("observeObjects",function(je){Se.observeObjects(je)}).on("unobserveObjects",function(je){Se.unobserveObjects(je)}).on("setCursor",function(je){Se.setCursor(je)}).on("setPanorama",function(je){Se.setPanorama(je.path,je.options)}).on("showError",function(je){Se.showError(je)}).on("hideError",function(){Se.hideError()}).on("startKeyboardControl",function(){Se.startKeyboardControl()}).on("stopKeyboardControl",function(){Se.stopKeyboardControl()}),o.current=Se}},[i,c]),$.useEffect(function(){var J=o.current;if(J&&J.container&&J.container.parentNode&&J&&J.container&&J.container.parentNode){var Y,N,ne,ye;(Y=J.renderer)===null||Y===void 0||(N=Y.renderer)===null||N===void 0||N.dispose(),(ne=J.renderer)===null||ne===void 0||(ye=ne.renderer)===null||ye===void 0||ye.forceContextLoss(),J.destroy()}},[o]),$.useEffect(function(){var J,Y=(J=c.panorama)!==null&&J!==void 0?J:c.src;o.current&&Y&&o.current.setPanorama(Y,{})},[c.src,c.panorama]);var q=function(){return{animate:function(N){Ls.emit("animate",N)},destroy:function(){Ls.emit("destroy",{})},createTooltip:function(N){var ne;return(ne=o.current)===null||ne===void 0?void 0:ne.createTooltip(N)},needsContinuousUpdate:function(N){Ls.emit("needsContinuousUpdate",N)},observeObjects:function(N){Ls.emit("observeObjects",N)},unobserveObjects:function(N){Ls.emit("unobserveObjects",N)},setCursor:function(N){Ls.emit("setCursor",N)},stopAnimation:function(){Ls.emit("stop-animation",{})},rotate:function(N){Ls.emit("rotate",N)},setOption:function(N,ne){Ls.emit("setOption",{option:N,value:ne})},setOptions:function(N){var ne;return(ne=o.current)===null||ne===void 0?void 0:ne.setOptions(N)},getCurrentNavbar:function(){return U},zoom:function(N){Ls.emit("zoom",N)},zoomIn:function(N){Ls.emit("zoomIn",{step:N})},zoomOut:function(N){Ls.emit("zoomOut",{step:N})},resize:function(N){var ne;return(ne=o.current)===null||ne===void 0?void 0:ne.resize(N)},enterFullscreen:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.enterFullscreen()},exitFullscreen:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.exitFullscreen()},toggleFullscreen:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.toggleFullscreen()},isFullscreenEnabled:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.isFullscreenEnabled()},getPlugin:function(N){var ne;return(ne=o.current)===null||ne===void 0?void 0:ne.getPlugin(N)},getPosition:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.getPosition()},getZoomLevel:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.getZoomLevel()},getSize:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.getSize()},needsUpdate:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.needsUpdate()},autoSize:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.autoSize()},setPanorama:function(N,ne){var ye;return(ye=o.current)===null||ye===void 0?void 0:ye.setPanorama(N,ne)},showError:function(N){var ne;return(ne=o.current)===null||ne===void 0?void 0:ne.showError(N)},hideError:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.hideError()},startKeyboardControl:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.startKeyboardControl()},stopKeyboardControl:function(){var N;return(N=o.current)===null||N===void 0?void 0:N.stopKeyboardControl()}}};return $.useImperativeHandle(t,q,[o.current,i,c,t]),ty.createElement("div",{className:c.containerClass||"view-container",ref:a})});fk.displayName="ReactPhotoSphereViewer";const VAe=(e,t)=>({width:8192,cols:16,rows:8,baseUrl:`${e}/${t}_thumb.jpg`,tileUrl:(n,r)=>`${e}/${t}_${n}_${r}.jpg`}),jAe=e=>{const{panorama:t,tileRootUrl:n,pixelRootUrl:r,mode:i="light"}=e,a=$.useRef(null),c=$.useRef(null),o=(f,g)=>{var _;return(_=c.current)==null?void 0:_.setRotation(g/Math.PI*180)};return ee.jsxs(ee.Fragment,{children:[ee.jsx(fk,{adapter:eW,src:VAe(r,t.id),height:"100vh",width:"100%",navbar:!1,moveInertia:.9,onPositionChange:o,defaultYaw:e.panorama.yaw??0}),ee.jsxs(MA,{sx:{position:"absolute",m:2.5,top:0,left:0,background:"#000a"},color:"neutral",invertedColors:!0,variant:"solid",children:[ee.jsx(oi,{level:"title-lg",children:t.label}),ee.jsx(a_,{}),ee.jsxs(Ga,{direction:"row",gap:2,children:[ee.jsx(oi,{level:"body-xs",children:"August 2025"}),ee.jsx(a_,{orientation:"vertical"}),ee.jsx(oi,{level:"body-xs",children:"ATS v1.55.2.2"})]})]}),ee.jsx("div",{className:"credits",children:"Images  SCS Software. Captured by Trucker Mudgeon."}),ee.jsxs(s2,{ref:a,style:{position:"absolute",left:20,bottom:20,width:"200px",height:"200px",border:"2px solid black",borderRadius:8,zIndex:100},minZoom:9,maxZoom:14,maxBounds:[t.point.map(f=>f-1),t.point.map(f=>f+1)],mapStyle:c2,attributionControl:!1,initialViewState:{longitude:t.point[0],latitude:t.point[1],zoom:10},children:[ee.jsx(fL,{ref:c,longitude:t.point[0],latitude:t.point[1],rotation:(t.yaw??0)/Math.PI*180,rotationAlignment:"map",children:ee.jsx("div",{className:"street-view-marker"})}),ee.jsx(l2,{tileRootUrl:n,mode:i}),ee.jsx(Ag,{tileRootUrl:n,game:"ats",mode:i,enableIconAutoHide:!0,visibleIcons:Hh,dlcs:Nf}),ee.jsx(Ag,{tileRootUrl:n,game:"ets2",mode:i,enableIconAutoHide:!0,visibleIcons:Hh})]})]})},nW=8192,Mm=512,HAe=nW/360,qB=nW/Mm,pm=100,GAe=e=>{const{pixelRootUrl:t,panorama:n}=e,r=Fj(n.yaw??0)*180/Math.PI+180,i=Math.floor(HAe*r);let a,c;return i%Mm<Mm/2?(c=Math.floor(i/Mm),a=c===0?qB-1:c-1):(a=Math.floor(i/Mm),c=a===qB-1?0:a+1),ee.jsx("div",{style:{overflow:"hidden",width:pm},children:ee.jsxs("div",{style:{display:"flex",position:"relative",left:-r*pm/Mm},children:[ee.jsx("img",{width:pm,height:pm,src:`${t}/${n.id}_${a}_3.jpg`}),ee.jsx("img",{width:pm,height:pm,src:`${t}/${n.id}_${c}_3.jpg`})]})})},XB=(e,[t,n])=>!isNaN(e)&&t<=e&&e<=n,WAe=e=>{const{tileRootUrl:t,pixelRootUrl:n}=e,{mode:r,systemMode:i}=FR(),a=r==="system"?i:r,{longitude:c,latitude:o}=mw[qAe(localStorage.getItem("tm-map"))],[f]=Hce(),g=Number(f.get("mlat")??void 0),_=Number(f.get("mlon")??void 0),x=XB(g,[-90,90])&&XB(_,[-180,180])?{lat:g,lon:_}:void 0,M=new Set([...Hh].filter(Ue=>!Ij.includes(Ue))),[C,A]=$.useState(!0),[L,I]=$.useState(M),[T,z]=$.useState(new Set(Nf)),k=l7(T),U=_S(L,I,Hh),H=_S(T,z,Nf),[V,q]=$.useState(!1),[J,Y]=$.useState(!1),N=$.useRef(null),[ne,ye]=$.useState(!1),[ge,Ne]=$.useState(null),[Ae,ve]=$.useState(null),Se=$.useCallback(()=>Ne(null),[]);$.useEffect(()=>{if(!N.current||!ne||!J)return;const Ue=N.current,Qe=Xt=>{const je=Ue.queryRenderedFeatures(Xt.point,{layers:["photo-spheres"]})[0];if(Ue.getCanvas().style.cursor=je?"pointer":"",je){if((Ae==null?void 0:Ae.id)!==je.properties.id){const lt=je;ve({id:lt.properties.id,point:lt.geometry.coordinates,yaw:lt.properties.yaw,label:lt.properties.label})}}else Ae&&ve(null)},st=Xt=>{const je=Ue.queryRenderedFeatures(Xt.point,{layers:["photo-spheres"]})[0];!je||je.properties.cluster===!0||(ve(null),Ne(Ae))},ct=Xt=>{ge!=null&&Xt.key==="Escape"&&Ne(null)};return ge&&document.addEventListener("keydown",ct),Ue.on("mousemove",Qe),Ue.on("click",st),()=>{Ue.off("mousemove",Qe),Ue.off("click",st),document.removeEventListener("keydown",ct)}},[N.current,ne,ge,Ae,J]);const Me=ee.jsxs(s2,{ref:N,style:{width:"100svw",height:"100svh",display:ge?"none":void 0},hash:!0,minZoom:4,maxZoom:15,mapStyle:c2,attributionControl:!1,initialViewState:{longitude:c,latitude:o,zoom:4},children:[x&&ee.jsx(fL,{longitude:x.lon,latitude:x.lat}),ee.jsxs(l2,{tileRootUrl:t,mode:a,children:[ee.jsx(NA,{tileRootUrl:t,game:"ats",showContours:V}),ee.jsx(NA,{tileRootUrl:t,game:"ets2",showContours:V})]}),ee.jsx(Ag,{tileRootUrl:t,game:"ats",mode:a,enableIconAutoHide:C,visibleIcons:L,dlcs:T}),ee.jsx(Ag,{tileRootUrl:t,game:"ets2",mode:a,enableIconAutoHide:C,visibleIcons:L}),L.has(Ai.CityNames)&&ee.jsx(UA,{game:"ats",mode:a,enableAutoHide:C,enabledStates:k}),L.has(Ai.CityNames)&&ee.jsx(UA,{game:"ets2",mode:a,enableAutoHide:C}),J&&ne&&ee.jsxs(jh,{id:"street-view",type:"geojson",data:"/street-view.geojson",cluster:!1,clusterMaxZoom:7,clusterRadius:10,children:[ee.jsx(dr,{id:"photo-spheres-halo",type:"circle",paint:{"circle-radius":10,"circle-color":a==="light"?"#fff8":"#8884","circle-blur":.75},filter:["in","$type","Point"]}),ee.jsx(dr,{id:"photo-spheres",type:"circle",paint:{"circle-radius":5,"circle-color":"#48f2","circle-stroke-width":2,"circle-stroke-color":"#48f"},filter:["in","$type","Point"]})]}),ee.jsxs(jh,{id:"measure",type:"geojson",data:{type:"FeatureCollection",features:[]},children:[ee.jsx(dr,{id:"measure-lines",type:"line",paint:{"line-color":"#f00","line-width":3,"line-opacity":1},filter:["in","$type","LineString"]}),ee.jsx(dr,{id:"measure-points",type:"circle",paint:{"circle-radius":5,"circle-color":"#fff","circle-stroke-width":3,"circle-stroke-color":"#f00"},filter:["in","$type","Point"]})]}),ee.jsx(dj,{visualizePitch:!0}),ee.jsx(qwe,{visible:J,onToggle:ye}),ee.jsx(hj,{containerId:"fsElem"}),ee.jsx(Xwe,{}),ee.jsx(h9,{}),ee.jsx(uj,{compact:!0,style:{marginLeft:54},customAttribution:" Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a> and <a href='https://forum.scssoft.com/viewtopic.php?p=1946956#p1946956'>krmarci</a>."}),ee.jsx(Hwe,{visibleStates:k,visibleStateDlcs:T}),ee.jsx(u9,{icons:{...U,enableAutoHiding:C,onAutoHidingToggle:A},advanced:{showContours:V,onContoursToggle:q,showPhotoSpheresUi:J,onPhotoSpheresToggleUi:Y},atsDlcs:H}),Ae&&ee.jsx(Rde,{className:"pano-preview-popup",closeButton:!1,closeOnClick:!1,closeOnMove:!0,longitude:Ae.point[0],latitude:Ae.point[1],children:ee.jsx(GAe,{panorama:Ae,pixelRootUrl:n})}),ee.jsx(oye,{})]});return ee.jsxs(ee.Fragment,{children:[Me,ge&&ee.jsxs(ee.Fragment,{children:[ee.jsx(jAe,{tileRootUrl:t,pixelRootUrl:n,panorama:ge,mode:a}),ee.jsx(fu,{sx:{background:"#000a",position:"absolute",borderRadius:"50%",m:2.5,top:0,right:0},size:"lg",variant:"solid",onClick:Se,children:ee.jsx(dL,{})})]})]})};function qAe(e){return e==="europe"?e:"usa"}var XAe=Object.defineProperty,ZAe=(e,t,n)=>t in e?XAe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,YAe=(e,t,n)=>(ZAe(e,t+"",n),n);class KAe{constructor(t){YAe(this,"_kind"),this._kind=t}}function JAe(e,t){const n=e.toString(),r=t.toString();return n>r?1:n<r?-1:0}const QAe=JAe;var eIe=Object.defineProperty,tIe=(e,t,n)=>t in e?eIe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ZB=(e,t,n)=>(tIe(e,typeof t!="symbol"?t+"":t,n),n);function nIe(e,t,n){const r=t*2,i=t*2+1;let a=t;return r<e.length&&n(e[a],e[r])<0&&(a=r),i<e.length&&n(e[a],e[i])<0&&(a=i),a}function pk(e,t,n){const r=nIe(e,t,n);if(r!==t){const i=e[t];e[t]=e[r],e[r]=i,pk(e,r,n)}}function YB(e){for(let t=Math.floor(e.collection.length/2)-1;t>=0;--t)pk(e.collection,t,e.comparator)}class NS extends KAe{constructor({comparator:t=QAe}={}){super("BinaryHeap"),ZB(this,"comparator"),ZB(this,"collection",[]),this.comparator=t}static from(t,n={}){const r=new NS(n);return r.collection=Array.from(t),YB(r),r}clear(){this.collection.length=0}toArray(){return[...this.collection].sort(this.comparator)}get length(){return this.collection.length}top(){if(this.length===0)throw new Error("invalid operation: top() called for empty BinaryHeap");return this.collection[0]}pop(){if(this.length===0)throw new Error("invalid operation: pop() called for empty BinaryHeap");const t=this.collection[0];return this.collection.length>1?(this.collection[0]=this.collection.pop(),pk(this.collection,0,this.comparator)):this.collection.pop(),t}push(t){this.collection.push(t);const n=this.collection;for(let r=n.length-1,i=Math.floor(r/2);r>0&&this.comparator(n[i],n[r])<0;r=i,i=Math.floor(i/2)){const a=n[r];n[r]=n[i],n[i]=a}}merge(t){t instanceof NS?this.collection=this.collection.concat(t.collection):this.collection=this.collection.concat(t.toArray()),YB(this),t.clear()}isEmpty(){return!this.collection.length}}function rIe(e,t,n,r,i){const a=`${e}-${t}-${n}-${r}`,{nodeLUT:c,graph:o}=i,f=Qn(c.get(e)),g=Qn(c.get(t)),_=new oIe({comparator:(z,k)=>{const U=I.get(z)??1/0;return(I.get(k)??1/0)-U}}),x={nodeUid:e,distance:0,direction:n,dlcGuard:-1};_.push(x);const M=new Map,C=new Map;C.set(x,0);const A=z=>zj(z,g),L=(z,k)=>{switch(r){case"shortest":return k.distance;case"smallRoads":return k.isOneLaneRoad?k.distance:k.distance*10;default:throw new zl(r)}},I=new Map;I.set(x,A(f));let T=0;for(;!_.isEmpty();){T++;const z=_.pop();if(z.nodeUid===t)return{success:!0,key:a,mode:r,...iIe(M,z)};const k=o.get(z.nodeUid);if(!k)continue;const U=z.direction==="forward"?k.forward:k.backward;for(const H of U){if(!i.enabledDlcGuards.has(H.dlcGuard))continue;const V=(C.get(z)??1/0)+L(z,H);V<(C.get(H)??1/0)&&(M.set(H,z),C.set(H,V),I.set(H,V+A(Qn(c.get(H.nodeUid)))),_.has(H)||_.push(H))}}return{success:!1,key:a,mode:r,numIters:T}}function iIe(e,t){let n=0;const r=[t];for(;e.has(t);)t=e.get(t),r.unshift(t),n+=t.distance;return r.length===1&&r.push(r[0]),{route:r,distance:n}}class oIe extends NS{constructor(n){super(n);rz(this,"items",new Set)}has(n){return this.items.has(n)}push(n){Pg.checkState(!this.items.has(n)),super.push(n),this.items.add(n)}pop(){const n=super.pop();return Pg.checkState(this.items.has(n)),this.items.delete(n),n}clear(){super.clear(),this.items.clear()}merge(n){super.merge(n);for(const r of this.collection)this.items.add(r)}}const sIe=e=>{const{tileRootUrl:t}=e,{mode:n,systemMode:r}=FR(),i=n==="system"?r:n,[a,c]=$.useState(!0),[o,f]=$.useState(new Set(Hh)),[g,_]=$.useState(new Set(Nf)),x=l7(g),M=_S(o,f,Hh),C=_S(g,_,Nf),[A,L]=$.useState(!1);return ee.jsxs(s2,{style:{width:"100vw",height:"100vh"},minZoom:4,maxZoom:15,maxBounds:[[-135,21],[-84,54]],mapStyle:c2,attributionControl:!1,initialViewState:{longitude:-115,latitude:36,zoom:9},children:[ee.jsx(l2,{tileRootUrl:t,mode:i,children:ee.jsx(NA,{tileRootUrl:t,game:"ats",showContours:A})}),ee.jsx(Ag,{tileRootUrl:t,game:"ats",mode:i,enableIconAutoHide:a,visibleIcons:o,dlcs:g}),ee.jsx(UA,{game:"ats",mode:i,enableAutoHide:a,enabledStates:x}),ee.jsx(jh,{id:"route1",type:"geojson",data:{type:"FeatureCollection",features:[]},children:ee.jsx(dr,{type:"line",paint:{"line-color":["match",["get","mode"],"shortest","#f00","smallRoads","#0f0","#f0f"],"line-width":3,"line-opacity":.7}})}),ee.jsx(dj,{visualizePitch:!0}),ee.jsx(hj,{}),ee.jsx(h9,{}),ee.jsx(uj,{compact:!0,customAttribution:" Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a>."}),ee.jsx(aIe,{dlcs:g}),ee.jsx(u9,{icons:{...M,enableAutoHiding:a,onAutoHidingToggle:c},advanced:{showContours:A,onContoursToggle:L,showPhotoSpheresUi:!1,onPhotoSpheresToggleUi:()=>{}},atsDlcs:C})]})},aIe=e=>{const{current:t}=J_(),n=K_(e.dlcs),[r,i]=$.useState(void 0),[a,c]=$.useState(void 0),[o,f]=$.useState([]),[g,_]=$.useState([]);$.useEffect(()=>{fetch("usa-graph-demo.json").then(q=>q.json()).then(q=>{f(q.demoCompanies.map(QB)),c(lIe(q)),i(q)},()=>console.error("could not load usa-graph-demo.json"))},[]);const[x,M]=$.useState(void 0),[C,A]=$.useState(void 0),L=$.useCallback(q=>{q=Qn(q),M(q.value);let J;if(r!=null){J=Qn(r.demoCompanies.find(ne=>ne.n===q.value));const Y=Qn(r.demoCompanyDefs.find(ne=>ne.t===J.t)),N=new Set(Y.d);_(r.demoCompanies.filter(ne=>N.has(ne.t)).map(QB))}if(!(t==null||a==null)&&(C!=null&&(Qn(t.getSource("route1")).setData({type:"FeatureCollection",features:[]}),A(void 0)),J)){const Y=Qn(a.nodeLUT.get(BigInt(parseInt(J.n,36))));t.flyTo({curve:1,zoom:9,center:[Y.x,Y.y]})}},[t,C,a,r]),I=$.useCallback(q=>{q=Qn(q),A(q.value),!(t==null||a==null)&&T(Qn(x),q.value,t,{...a,enabledDlcGuards:n})},[t,x,a,e.dlcs]),T=(q,J,Y,N)=>{Promise.all([e6(q,J,"shortest",N),e6(q,J,"smallRoads",N)]).then(ne=>{const ye=Qn(Y.getSource("route1"));if(ne.some(Ne=>Ne==null)){alert("Cannot calculate a route "),ye.setData({type:"FeatureCollection",features:[]});return}const ge=ne;ye.setData({type:"FeatureCollection",features:ge}),Y.fitBounds(Oj(ge.flatMap(Ne=>Ne.geometry.coordinates)),{padding:150,curve:1,duration:2500})},ne=>{console.error("error finding route",ne)})},z=new Map;if(r)for(const[,q]of r.demoGraph)for(const J of[...q.b??[],...q.f??[]]){const Y=z.get(J.n)??0;z.set(J.n,Y||J.g)}const k=q=>{if(a==null)return!0;const J=Qn(z.get(q.value));return n.has(J)},U=(q,J)=>q.city!==J.city?q.city.localeCompare(J.city):q.label.localeCompare(J.label),H=o.filter(k).sort(U),V=g.filter(k).sort(U);return ee.jsxs("div",{style:{width:300,margin:20,display:"grid",position:"relative",gridTemplateColumns:"100px auto",alignItems:"center"},children:[ee.jsx("h2",{children:"Start"}),ee.jsx(iS,{options:H,onChange:(q,J)=>J&&L(J),groupBy:q=>q.city,placeholder:"Select...",blurOnSelect:!0,autoComplete:!0,disableClearable:!0,renderGroup:KB}),ee.jsx("h2",{children:"End"}),ee.jsx(iS,{options:V,onChange:(q,J)=>J&&I(J),groupBy:q=>q.city,placeholder:"Select...",blurOnSelect:!0,autoComplete:!0,disableClearable:!0,disabled:x==null,renderGroup:KB},x)]})};function KB(e){return ee.jsxs(ee.Fragment,{children:[ee.jsx(oi,{m:1,level:"body-xs",textTransform:"uppercase",children:e.group}),ee.jsx(DM,{children:e.children}),ee.jsx(CA,{})]})}function lIe(e){const t=new Map,n=new Map;for(const[r,i]of e.demoGraph)t.set(BigInt(parseInt(r,36)),{forward:(i.f??[]).map(JB),backward:(i.b??[]).map(JB)});for(const[r,i]of e.demoNodes)n.set(BigInt(parseInt(r,36)),{x:i[0],y:i[1]});return{graph:t,nodeLUT:n}}function JB(e){return{nodeUid:BigInt(parseInt(e.n,36)),distance:e.l,isOneLaneRoad:e.o,direction:e.d==="f"?"forward":"backward",dlcGuard:e.g}}function QB(e){return{label:e.t,city:e.c,value:e.n}}function e6(e,t,n,r){return new Promise(i=>{const a=rIe(BigInt(parseInt(e,36)),BigInt(parseInt(t,36)),"forward",n,r);if(!a.success){i(void 0);return}i({type:"Feature",geometry:{type:"LineString",coordinates:a.route.map(c=>{const o=Qn(r.nodeLUT.get(c.nodeUid));return[o.x,o.y]})},properties:{distance:a.distance,mode:n}})})}/*!
 * Photo Sphere Viewer / Markers Plugin 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var cIe=Object.defineProperty,uIe=(e,t)=>{for(var n in t)cIe(e,n,{get:t[n],enumerable:!0})},hIe={};uIe(hIe,{EnterMarkerEvent:()=>fW,GotoMarkerDoneEvent:()=>nR,HideMarkersEvent:()=>zy,LeaveMarkerEvent:()=>uW,MarkerVisibilityEvent:()=>oW,MarkersPluginEvent:()=>il,RenderMarkersListEvent:()=>LW,SelectMarkerEvent:()=>gW,SelectMarkerListEvent:()=>_W,SetMarkersEvent:()=>TW,ShowMarkersEvent:()=>Oy,UnselectMarkerEvent:()=>wW});var il=class extends vx{},rW=class iW extends il{constructor(t,n){super(iW.type),this.marker=t,this.visible=n}};rW.type="marker-visibility";var oW=rW,sW=class aW extends il{constructor(t){super(aW.type),this.marker=t}};sW.type="goto-marker-done";var nR=sW,lW=class cW extends il{constructor(t){super(cW.type),this.marker=t}};lW.type="leave-marker";var uW=lW,hW=class dW extends il{constructor(t){super(dW.type),this.marker=t}};hW.type="enter-marker";var fW=hW,pW=class mW extends il{constructor(t,n,r){super(mW.type),this.marker=t,this.doubleClick=n,this.rightClick=r}};pW.type="select-marker";var gW=pW,vW=class yW extends il{constructor(t){super(yW.type),this.marker=t}};vW.type="select-marker-list";var _W=vW,xW=class bW extends il{constructor(t){super(bW.type),this.marker=t}};xW.type="unselect-marker";var wW=xW,SW=class MW extends il{constructor(){super(MW.type)}};SW.type="hide-markers";var zy=SW,CW=class EW extends il{constructor(t){super(EW.type),this.markers=t}};CW.type="set-markers";var TW=CW,PW=class AW extends il{constructor(){super(AW.type)}};PW.type="show-markers";var Oy=PW,IW=class RW extends il{constructor(t){super(RW.type),this.markers=t}};IW.type="render-markers-list";var LW=IW,dIe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 9 81 81"><path fill="currentColor" d="M50.5 90S22.9 51.9 22.9 36.6 35.2 9 50.5 9s27.6 12.4 27.6 27.6S50.5 90 50.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,S_=class extends bs{constructor(e){super(e,{className:"psv-markers-button",icon:dIe,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.plugin.addEventListener(Oy.type,this),this.plugin.addEventListener(zy.type,this),this.toggleActive(!0))}destroy(){this.plugin&&(this.plugin.removeEventListener(Oy.type,this),this.plugin.removeEventListener(zy.type,this)),super.destroy()}isSupported(){return!!this.plugin}handleEvent(e){e instanceof Oy?this.toggleActive(!0):e instanceof zy&&this.toggleActive(!1)}onClick(){this.plugin.toggleAllMarkers()}};S_.id="markers";var kW=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="9 9 81 81"><path fill="currentColor" d="M37.5 90S9.9 51.9 9.9 36.6 22.2 9 37.5 9s27.6 12.4 27.6 27.6S37.5 90 37.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zM86.7 55H70c-1.8 0-3.3-1.5-3.3-3.3s1.5-3.3 3.3-3.3h16.7c1.8 0 3.3 1.5 3.3 3.3S88.5 55 86.7 55zm0-25h-15a3.3 3.3 0 0 1-3.3-3.3c0-1.8 1.5-3.3 3.3-3.3h15c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3zM56.5 73h30c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3h-30a3.3 3.3 0 0 1-3.3-3.3 3.2 3.2 0 0 1 3.3-3.3z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,BS="http://www.w3.org/2000/svg",pi="psvMarker",fIe=Dn.dasherize(pi),N0="marker",Cm="markersList",rR={amount:2,duration:100,easing:"linear"},pIe=(e,t)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
    <h1 class="psv-panel-menu-title">${kW} ${t}</h1>
    <ul class="psv-panel-menu-list">
    ${e.map(n=>`
        <li data-${fIe}="${n.id}" class="psv-panel-menu-item" tabindex="0">
          ${n.type==="image"?`<span class="psv-panel-menu-item-icon"><img src="${n.definition}"/></span>`:""}
          <span class="psv-panel-menu-item-label">${n.getListContent()}</span>
        </li>
    `).join("")}
    </ul>
</div>
`,T2=class extends bs{constructor(e){super(e,{className:" psv-markers-list-button",icon:kW,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.viewer.addEventListener(Fn.ShowPanelEvent.type,this),this.viewer.addEventListener(Fn.HidePanelEvent.type,this))}destroy(){this.viewer.removeEventListener(Fn.ShowPanelEvent.type,this),this.viewer.removeEventListener(Fn.HidePanelEvent.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(e){e instanceof Fn.ShowPanelEvent?this.toggleActive(e.panelId===Cm):e instanceof Fn.HidePanelEvent&&this.toggleActive(!1)}onClick(){this.plugin.toggleMarkersList()}};T2.id="markersList";var t6=new dt,mIe=new ud,n6=new dt,gIe=class extends Go{constructor(t=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(n){n.element instanceof n.element.ownerDocument.defaultView.Element&&n.element.parentNode!==null&&n.element.remove()})})}copy(t,n){return super.copy(t,n),this.element=t.element.cloneNode(!0),this}},nc=new jr,vIe=new jr,yIe=class{constructor(t={}){const n=this;let r,i,a,c;const o={camera:{style:""},objects:new WeakMap},f=t.element!==void 0?t.element:document.createElement("div");f.style.overflow="hidden",this.domElement=f;const g=document.createElement("div");g.style.transformOrigin="0 0",g.style.pointerEvents="none",f.appendChild(g);const _=document.createElement("div");_.style.transformStyle="preserve-3d",g.appendChild(_),this.getSize=function(){return{width:r,height:i}},this.render=function(I,T){const z=T.projectionMatrix.elements[5]*c;T.view&&T.view.enabled?(g.style.transform=`translate( ${-T.view.offsetX*(r/T.view.width)}px, ${-T.view.offsetY*(i/T.view.height)}px )`,g.style.transform+=`scale( ${T.view.fullWidth/T.view.width}, ${T.view.fullHeight/T.view.height} )`):g.style.transform="",I.matrixWorldAutoUpdate===!0&&I.updateMatrixWorld(),T.parent===null&&T.matrixWorldAutoUpdate===!0&&T.updateMatrixWorld();let k,U;T.isOrthographicCamera&&(k=-(T.right+T.left)/2,U=(T.top+T.bottom)/2);const H=T.view&&T.view.enabled?T.view.height/T.view.fullHeight:1,V=T.isOrthographicCamera?`scale( ${H} )scale(`+z+")translate("+x(k)+"px,"+x(U)+"px)"+M(T.matrixWorldInverse):`scale( ${H} )translateZ(`+z+"px)"+M(T.matrixWorldInverse),J=(T.isPerspectiveCamera?"perspective("+z+"px) ":"")+V+"translate("+a+"px,"+c+"px)";o.camera.style!==J&&(_.style.transform=J,o.camera.style=J),L(I,I,T)},this.setSize=function(I,T){r=I,i=T,a=r/2,c=i/2,f.style.width=I+"px",f.style.height=T+"px",g.style.width=I+"px",g.style.height=T+"px",_.style.width=I+"px",_.style.height=T+"px"};function x(I){return Math.abs(I)<1e-10?0:I}function M(I){const T=I.elements;return"matrix3d("+x(T[0])+","+x(-T[1])+","+x(T[2])+","+x(T[3])+","+x(T[4])+","+x(-T[5])+","+x(T[6])+","+x(T[7])+","+x(T[8])+","+x(-T[9])+","+x(T[10])+","+x(T[11])+","+x(T[12])+","+x(-T[13])+","+x(T[14])+","+x(T[15])+")"}function C(I){const T=I.elements;return"translate(-50%,-50%)"+("matrix3d("+x(T[0])+","+x(T[1])+","+x(T[2])+","+x(T[3])+","+x(-T[4])+","+x(-T[5])+","+x(-T[6])+","+x(-T[7])+","+x(T[8])+","+x(T[9])+","+x(T[10])+","+x(T[11])+","+x(T[12])+","+x(T[13])+","+x(T[14])+","+x(T[15])+")")}function A(I){I.isCSS3DObject&&(I.element.style.display="none");for(let T=0,z=I.children.length;T<z;T++)A(I.children[T])}function L(I,T,z,k){if(I.visible===!1){A(I);return}if(I.isCSS3DObject){const U=I.layers.test(z.layers)===!0,H=I.element;if(H.style.display=U===!0?"":"none",U===!0){I.onBeforeRender(n,T,z);let V;I.isCSS3DSprite?(nc.copy(z.matrixWorldInverse),nc.transpose(),I.rotation2D!==0&&nc.multiply(vIe.makeRotationZ(I.rotation2D)),I.matrixWorld.decompose(t6,mIe,n6),nc.setPosition(t6),nc.scale(n6),nc.elements[3]=0,nc.elements[7]=0,nc.elements[11]=0,nc.elements[15]=1,V=C(nc)):V=C(I.matrixWorld);const q=o.objects.get(I);if(q===void 0||q.style!==V){H.style.transform=V;const J={style:V};o.objects.set(I,J)}H.parentNode!==_&&_.appendChild(H),I.onAfterRender(n,T,z)}}for(let U=0,H=I.children.length;U<H;U++)L(I.children[U],T,z)}}},_Ie=class{constructor(e){this.viewer=e,this.element=document.createElement("div"),this.element.className="psv-markers-css3d-container",this.renderer=new yIe({element:this.element}),this.scene=new PS,this.intersectionObserver=new IntersectionObserver(t=>{t.forEach(n=>{const r=n.target[pi];r.config.visible&&(r.viewportIntersection=n.isIntersecting)})},{root:this.element}),e.addEventListener(Fn.ReadyEvent.type,this,{once:!0}),e.addEventListener(Fn.SizeUpdatedEvent.type,this),e.addEventListener(Fn.RenderEvent.type,this)}handleEvent(e){switch(e.type){case Fn.ReadyEvent.type:case Fn.SizeUpdatedEvent.type:this.updateSize();break;case Fn.RenderEvent.type:this.render();break}}destroy(){this.viewer.removeEventListener(Fn.ReadyEvent.type,this),this.viewer.removeEventListener(Fn.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(Fn.RenderEvent.type,this),this.intersectionObserver.disconnect()}updateSize(){const e=this.viewer.getSize();this.renderer.setSize(e.width,e.height)}render(){this.renderer.render(this.scene,this.viewer.renderer.camera)}addObject(e){this.scene.add(e.threeElement),this.intersectionObserver.observe(e.domElement)}removeObject(e){this.scene.remove(e.threeElement),this.intersectionObserver.unobserve(e.domElement)}},Cw=(e=>(e.image="image",e.html="html",e.element="element",e.imageLayer="imageLayer",e.videoLayer="videoLayer",e.elementLayer="elementLayer",e.polygon="polygon",e.polygonPixels="polygonPixels",e.polyline="polyline",e.polylinePixels="polylinePixels",e.square="square",e.rect="rect",e.circle="circle",e.ellipse="ellipse",e.path="path",e))(Cw||{});function iR(e,t=!1){const n=[];if(Object.keys(Cw).forEach(r=>{e[r]&&n.push(r)}),n.length===0&&!t)throw new Sn(`missing marker content, either ${Object.keys(Cw).join(", ")}`);if(n.length>1)throw new Sn(`multiple marker content, either ${Object.keys(Cw).join(", ")}`);return n[0]}var DW=class{constructor(e,t,n){if(this.viewer=e,this.plugin=t,this.state={anchor:null,visible:!1,staticTooltip:!1,position:null,position2D:null,positions3D:null,size:null},!n.id)throw new Sn("missing marker id");this.type=iR(n),this.createElement(),this.update(n)}get id(){return this.config.id}get data(){return this.config.data}get domElement(){return null}get threeElement(){return null}get video(){return null}destroy(){delete this.viewer,delete this.plugin,delete this.element,this.hideTooltip()}is3d(){return!1}isNormal(){return!1}isPoly(){return!1}isSvg(){return!1}isCss3d(){return!1}update(e){const t=iR(e,!0);if(t!==void 0&&t!==this.type)throw new Sn(`cannot change marker ${e.id} type`);if(this.config=Dn.deepmerge(this.config,e),typeof this.config.tooltip=="string"&&(this.config.tooltip={content:this.config.tooltip}),this.config.tooltip&&!this.config.tooltip.trigger&&(this.config.tooltip.trigger="hover"),Dn.isNil(this.config.visible)&&(this.config.visible=!0),Dn.isNil(this.config.zIndex)&&(this.config.zIndex=1),Dn.isNil(this.config.opacity)&&(this.config.opacity=1),this.config.rotation){const n=this.config.rotation;typeof n=="object"?this.config.rotation={yaw:n.yaw?Dn.parseAngle(n.yaw,!0,!1):0,pitch:n.pitch?Dn.parseAngle(n.pitch,!0,!1):0,roll:n.roll?Dn.parseAngle(n.roll,!0,!1):0}:this.config.rotation={yaw:0,pitch:0,roll:Dn.parseAngle(n,!0,!1)}}else this.config.rotation={yaw:0,pitch:0,roll:0};this.state.anchor=Dn.parsePoint(this.config.anchor)}getListContent(){var e;return this.config.listContent?this.config.listContent:(e=this.config.tooltip)!=null&&e.content?this.config.tooltip.content:this.config.html?this.config.html:this.id}showTooltip(e,t,n=!1){var r;if(this.state.visible&&((r=this.config.tooltip)!=null&&r.content)&&this.state.position2D){const i={...this.config.tooltip,style:{pointerEvents:this.state.staticTooltip?"auto":"none"},data:this,top:0,left:0};if(this.isPoly()||this.is3d()||this.isCss3d())if(e||t){const a=Dn.getPosition(this.viewer.container);i.top=t-a.y+10,i.left=e-a.x,i.box={width:20,height:20}}else i.top=this.state.position2D.y,i.left=this.state.position2D.x;else{const a=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);let c=this.state.size.width,o=this.state.size.height;this.config.hoverScale&&!this.state.staticTooltip&&(c*=this.config.hoverScale.amount,o*=this.config.hoverScale.amount),i.top=a.y-o*this.state.anchor.y+o/2,i.left=a.x-c*this.state.anchor.x+c/2,i.box={width:c,height:o}}this.tooltip?n?this.tooltip.update(this.config.tooltip.content,i):this.tooltip.move(i):this.tooltip=this.viewer.createTooltip(i)}}hideTooltip(){this.tooltip&&(this.tooltip.hide(),this.tooltip=null)}},mk=class extends DW{get domElement(){return this.element}constructor(e,t,n){super(e,t,n)}afterCreateElement(){this.element[pi]=this}destroy(){delete this.element[pi],super.destroy()}update(e){super.update(e);const t=this.domElement;t.id=`psv-marker-${this.config.id}`,t.setAttribute("class","psv-marker"),this.state.visible&&t.classList.add("psv-marker--visible"),this.config.tooltip&&t.classList.add("psv-marker--has-tooltip"),this.config.content&&t.classList.add("psv-marker--has-content"),this.config.className&&Dn.addClasses(t,this.config.className),t.style.opacity=`${this.config.opacity}`,t.style.zIndex=`${30+this.config.zIndex}`,this.config.style&&Object.assign(t.style,this.config.style)}},US=class extends mk{constructor(e,t,n){super(e,t,n)}afterCreateElement(){super.afterCreateElement(),this.domElement.addEventListener("transitionend",()=>{this.domElement.style.transition=""})}render({viewerPosition:e,zoomLevel:t,hoveringMarker:n}){this.__updateSize();const r=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);return r.x-=this.state.size.width*this.state.anchor.x,r.y-=this.state.size.height*this.state.anchor.y,this.state.positions3D[0].dot(this.viewer.state.direction)>0&&r.x+this.state.size.width>=0&&r.x-this.state.size.width<=this.viewer.state.size.width&&r.y+this.state.size.height>=0&&r.y-this.state.size.height<=this.viewer.state.size.height?(this.domElement.style.translate=`${r.x}px ${r.y}px 0px`,this.applyScale({zoomLevel:t,viewerPosition:e,mouseover:this===n}),r):null}update(e){if(super.update(e),!Dn.isExtendedPosition(this.config.position))throw new Sn(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(n){throw new Sn(`invalid marker ${this.id} position`,n)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const t=this.domElement;t.classList.add("psv-marker--normal"),this.config.scale&&Array.isArray(this.config.scale)&&(this.config.scale={zoom:this.config.scale}),typeof this.config.hoverScale=="boolean"?this.config.hoverScale=this.config.hoverScale?this.plugin.config.defaultHoverScale||rR:null:typeof this.config.hoverScale=="number"?this.config.hoverScale={amount:this.config.hoverScale}:this.config.hoverScale||(this.config.hoverScale=this.plugin.config.defaultHoverScale),this.config.hoverScale&&(this.config.hoverScale={...this.plugin.config.defaultHoverScale,...this.config.hoverScale}),t.style.rotate=this.config.rotation.roll!==0?mr.radToDeg(this.config.rotation.roll)+"deg":null,t.style.transformOrigin=`${this.state.anchor.x*100}% ${this.state.anchor.y*100}%`}__updateSize(){if(!this.needsUpdateSize)return;const e=this.domElement,t=!this.state.visible||!this.state.size;if(t&&e.classList.add("psv-marker--transparent"),this.isSvg()){const n=e.firstElementChild.getBoundingClientRect();this.state.size={width:n.width,height:n.height}}else this.state.size={width:e.offsetWidth,height:e.offsetHeight};t&&e.classList.remove("psv-marker--transparent"),this.isSvg()&&(e.style.width=this.state.size.width+"px",e.style.height=this.state.size.height+"px"),this.type!=="element"&&(this.needsUpdateSize=!1)}applyScale({zoomLevel:e,viewerPosition:t,mouseover:n}){n!==null&&this.config.hoverScale&&(this.domElement.style.transition=`scale ${this.config.hoverScale.duration}ms ${this.config.hoverScale.easing}`);let r=1;if(typeof this.config.scale=="function")r=this.config.scale(e,t);else if(this.config.scale){if(Array.isArray(this.config.scale.zoom)){const[i,a]=this.config.scale.zoom;r*=i+(a-i)*Fg.EASINGS.inQuad(e/100)}if(Array.isArray(this.config.scale.yaw)){const[i,a]=this.config.scale.yaw,c=mr.degToRad(this.viewer.state.hFov)/2,o=Math.abs(Dn.getShortestArc(this.state.position.yaw,t.yaw));r*=a+(i-a)*Fg.EASINGS.outQuad(Math.max(0,(c-o)/c))}}n&&this.config.hoverScale&&(r*=this.config.hoverScale.amount),this.domElement.style.scale=`${r}`}},xIe=`// https://www.8thwall.com/playground/chromakey-threejs

uniform sampler2D map;
uniform float alpha;
uniform bool keying;
uniform vec3 color;
uniform float similarity;
uniform float smoothness;
uniform float spill;

varying vec2 vUv;

vec2 RGBtoUV(vec3 rgb) {
    return vec2(
        rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,
        rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5
    );
}

void main(void) {
    gl_FragColor = texture2D(map, vUv);

    if (keying) {
        float chromaDist = distance(RGBtoUV(gl_FragColor.rgb), RGBtoUV(color));

        float baseMask = chromaDist - similarity;
        float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);
        gl_FragColor.a *= fullMask * alpha;

        float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);
        float desat = clamp(gl_FragColor.r * 0.2126 + gl_FragColor.g * 0.7152 + gl_FragColor.b * 0.0722, 0., 1.);
        gl_FragColor.rgb = mix(vec3(desat, desat, desat), gl_FragColor.rgb, spillVal);
    } else {
        gl_FragColor.a *= alpha;
    }
}
`,bIe=`varying vec2 vUv;
uniform vec2 repeat;
uniform vec2 offset;

void main() {
    vUv = uv * repeat + offset;
    gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );
}
`,wIe=class extends vu{get map(){return this.uniforms.map.value}set map(e){this.uniforms.map.value=e}set alpha(e){this.uniforms.alpha.value=e}get offset(){return this.uniforms.offset.value}get repeat(){return this.uniforms.repeat.value}set chromaKey(e){this.uniforms.keying.value=(e==null?void 0:e.enabled)===!0,e!=null&&e.enabled&&(typeof e.color=="object"&&"r"in e.color?this.uniforms.color.value.set(e.color.r/255,e.color.g/255,e.color.b/255):this.uniforms.color.value.set(e.color??65280),this.uniforms.similarity.value=e.similarity??.2,this.uniforms.smoothness.value=e.smoothness??.2)}constructor(e){super({transparent:!0,depthTest:!1,depthWrite:!1,uniforms:{map:{value:e==null?void 0:e.map},repeat:{value:new Dr(1,1)},offset:{value:new Dr(0,0)},alpha:{value:(e==null?void 0:e.alpha)??1},keying:{value:!1},color:{value:new Br(65280)},similarity:{value:.2},smoothness:{value:.2},spill:{value:.1}},vertexShader:bIe,fragmentShader:xIe}),this.chromaKey=e==null?void 0:e.chromaKey}};function SIe({src:e,withCredentials:t,muted:n,autoplay:r}){const i=document.createElement("video");return i.crossOrigin=t?"use-credentials":"anonymous",i.loop=!0,i.playsInline=!0,i.autoplay=r,i.muted=n,i.preload="metadata",e instanceof MediaStream?i.srcObject=e:i.src=e,i}function MIe(e,t,n){const[r,i]=e,[a,c]=t,o=Dn.greatArcDistance(e,t),f=Math.sin((1-n)*o)/Math.sin(o),g=Math.sin(n*o)/Math.sin(o),_=f*Math.cos(i)*Math.cos(r)+g*Math.cos(c)*Math.cos(a),x=f*Math.cos(i)*Math.sin(r)+g*Math.cos(c)*Math.sin(a),M=f*Math.sin(i)+g*Math.sin(c);return[Math.atan2(x,_),Math.atan2(M,Math.sqrt(_*_+x*x))]}function CIe(e){const t=[e[0]];let n=0;for(let r=1;r<e.length;r++){const i=e[r-1][0]-e[r][0];i>Math.PI?n+=1:i<-Math.PI&&(n-=1),t.push([e[r][0]+n*2*Math.PI,e[r][1]])}return t}function zW(e){return e.reduce((t,n)=>t.add(n),new dt).normalize()}function EIe(e){const t=CIe(e);let n=0;const r=[];for(let a=0;a<t.length-1;a++){const c=Dn.greatArcDistance(t[a],t[a+1])*Fg.SPHERE_RADIUS;r.push(c),n+=c}let i=0;for(let a=0;a<t.length-1;a++){if(i+r[a]>n/2){const c=(n/2-i)/r[a];return MIe(t[a],t[a+1],c)}i+=r[a]}return t[Math.round(t.length/2)]}var zb=new dt,r6=new dt,vP=new dt,i6=new dt,o6=new dt,s6=new dt;function TIe(e,t,n){zb.copy(n).normalize(),r6.crossVectors(e,t).normalize(),vP.crossVectors(r6,e).normalize(),i6.copy(e).multiplyScalar(-zb.dot(vP)),o6.copy(vP).multiplyScalar(zb.dot(e));const r=new dt().addVectors(i6,o6).normalize();return s6.crossVectors(r,zb),r.applyAxisAngle(s6,.01).multiplyScalar(Fg.SPHERE_RADIUS)}var PIe=class extends DW{get threeElement(){return this.element}get threeMesh(){return this.threeElement.children[0]}get video(){return this.type==="videoLayer"?this.threeMesh.material.map.image:null}constructor(e,t,n){super(e,t,n)}is3d(){return!0}createElement(){const e=new wIe({alpha:0}),t=new mx(1,1),n=new Ns(t,e);n.userData={[pi]:this},Object.defineProperty(n,"visible",{enumerable:!0,get:function(){return this.userData[pi].config.visible},set:function(r){this.userData[pi].config.visible=r}}),this.element=new Sh().add(n),this.type==="videoLayer"&&this.viewer.needsContinuousUpdate(!0)}destroy(){delete this.threeMesh.userData[pi],this.type==="videoLayer"&&(this.video.pause(),this.viewer.needsContinuousUpdate(!1)),super.destroy()}render(){return this.viewer.renderer.isObjectVisible(this.threeMesh)?this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position):null}update(e){var i,a,c;super.update(e);const t=this.threeMesh,n=t.parent,r=t.material;if(Dn.isExtendedPosition(this.config.position)){try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(f){throw new Sn(`invalid marker ${this.id} position`,f)}if(!this.config.size)throw new Sn(`missing marker ${this.id} size`);this.state.size=this.config.size,t.scale.set(this.config.size.width/100,this.config.size.height/100,1),t.position.set(t.scale.x*(.5-this.state.anchor.x),t.scale.y*(this.state.anchor.y-.5),0),t.rotation.set(0,0,0),this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position,n.position),n.lookAt(0,n.position.y,0),t.rotateY(-this.config.rotation.yaw),t.rotateX(-this.config.rotation.pitch),t.rotateZ(-this.config.rotation.roll);const o=t.geometry.getAttribute("position");this.state.positions3D=[0,1,3,2].map(f=>{const g=new dt;return g.fromBufferAttribute(o,f),t.localToWorld(g)})}else{if(((i=this.config.position)==null?void 0:i.length)!==4)throw new Sn(`missing marker ${this.id} position`);let o;try{o=this.config.position.map(x=>this.viewer.dataHelper.cleanPosition(x))}catch(x){throw new Sn(`invalid marker ${this.id} position`,x)}const f=o.map(x=>this.viewer.dataHelper.sphericalCoordsToVector3(x)),g=zW(f);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(g),this.state.positions3D=f;const _=t.geometry.getAttribute("position");[f[0],f[1],f[3],f[2]].forEach((x,M)=>{_.setX(M,x.x),_.setY(M,x.y),_.setZ(M,x.z)}),_.needsUpdate=!0,this.__setTextureWrap(r)}switch(this.type){case"videoLayer":if(this.definition!==this.config.videoLayer){(a=r.map)==null||a.dispose();const o=SIe({src:this.config.videoLayer,withCredentials:this.viewer.config.withCredentials(this.config.videoLayer),muted:!0,autoplay:this.config.autoplay??!0}),f=new LMe(o);r.map=f,r.alpha=0,o.addEventListener("loadedmetadata",()=>{this.viewer&&(r.alpha=this.config.opacity,Dn.isExtendedPosition(this.config.position)||(t.material.userData[pi]={width:o.videoWidth,height:o.videoHeight},this.__setTextureWrap(r)))},{once:!0}),o.autoplay&&o.play(),this.definition=this.config.videoLayer}else r.alpha=this.config.opacity;break;case"imageLayer":if(this.definition!==this.config.imageLayer){(c=r.map)==null||c.dispose();const o=new Ho;r.map=o,r.alpha=0,this.viewer.textureLoader.loadImage(this.config.imageLayer).then(f=>{this.viewer&&(Dn.isExtendedPosition(this.config.position)||(t.material.userData[pi]={width:f.width,height:f.height},this.__setTextureWrap(r)),o.image=f,o.anisotropy=4,o.needsUpdate=!0,r.alpha=this.config.opacity,this.viewer.needsUpdate())}),this.definition=this.config.imageLayer}else r.alpha=this.config.opacity;break}r.chromaKey=this.config.chromaKey,t.renderOrder=1e3+this.config.zIndex,t.geometry.boundingBox=null}__setTextureWrap(e){const t=e.userData[pi];if(!t||!t.height||!t.width){e.repeat.set(1,1),e.offset.set(0,0);return}const n=this.config.position.map(x=>this.viewer.dataHelper.cleanPosition(x)),r=Dn.greatArcDistance([n[0].yaw,n[0].pitch],[n[1].yaw,n[1].pitch]),i=Dn.greatArcDistance([n[3].yaw,n[3].pitch],[n[2].yaw,n[2].pitch]),a=Dn.greatArcDistance([n[1].yaw,n[1].pitch],[n[2].yaw,n[2].pitch]),c=Dn.greatArcDistance([n[0].yaw,n[0].pitch],[n[3].yaw,n[3].pitch]),o=(r+i)/(a+c),f=t.width/t.height;let g=0,_=0;o<f?g=f-o:_=1/f-1/o,e.repeat.set(1-g,1-_),e.offset.set(g/2,_/2)}},AIe=class extends mk{constructor(e,t,n){super(e,t,n),this.viewportIntersection=!1}get threeElement(){return this.object}isCss3d(){return!0}createElement(){this.element=document.createElement("div"),this.object=new gIe(this.element),this.object.userData={[pi]:this},Object.defineProperty(this.object,"visible",{enumerable:!0,get:function(){return this.userData[pi].config.visible},set:function(e){this.userData[pi].config.visible=e}}),this.afterCreateElement()}destroy(){delete this.object.userData[pi],delete this.object,super.destroy()}render({viewerPosition:e,zoomLevel:t}){var i,a;const n=this.domElement;if(this.state.size={width:n.offsetWidth,height:n.offsetHeight},this.state.positions3D[0].dot(this.viewer.state.direction)>0&&this.viewportIntersection){const c=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position);return(a=(i=this.config.elementLayer).updateMarker)==null||a.call(i,{marker:this,position:c,viewerPosition:e,zoomLevel:t,viewerSize:this.viewer.state.size}),c}else return null}update(e){if(super.update(e),!Dn.isExtendedPosition(this.config.position))throw new Sn(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(r){throw new Sn(`invalid marker ${this.id} position`,r)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const t=this.threeElement,n=this.domElement;n.classList.add("psv-marker--css3d"),n.childNodes.forEach(r=>r.remove()),n.appendChild(this.config.elementLayer),this.config.elementLayer.style.display="block",t.position.copy(this.state.positions3D[0]).multiplyScalar(100),t.lookAt(0,this.state.positions3D[0].y*100,0),t.rotateY(-this.config.rotation.yaw),t.rotateX(-this.config.rotation.pitch),t.rotateZ(-this.config.rotation.roll)}},IIe=class extends US{constructor(e,t,n){super(e,t,n)}isNormal(){return!0}createElement(){this.element=document.createElement("div"),this.afterCreateElement()}render(e){var n,r;const t=super.render(e);return t&&this.type==="element"&&((r=(n=this.config.element).updateMarker)==null||r.call(n,{marker:this,position:t,viewerPosition:e.viewerPosition,zoomLevel:e.zoomLevel,viewerSize:this.viewer.state.size})),t}update(e){super.update(e);const t=this.domElement;if(this.config.image&&!this.config.size)throw new Sn(`missing marker ${this.id} size`);switch(this.config.size?(this.needsUpdateSize=!1,this.state.size=this.config.size,t.style.width=this.config.size.width+"px",t.style.height=this.config.size.height+"px"):this.needsUpdateSize=!0,this.type){case"image":this.definition=this.config.image,t.style.backgroundImage=`url("${this.config.image}")`;break;case"html":this.definition=this.config.html,t.innerHTML=this.config.html;break;case"element":this.definition!==this.config.element&&(this.definition=this.config.element,t.childNodes.forEach(n=>n.remove()),t.appendChild(this.config.element),this.config.element.style.display="block");break}}},RIe=class extends mk{constructor(e,t,n){super(e,t,n)}createElement(){this.element=document.createElementNS(BS,"path"),this.element[pi]=this}isPoly(){return!0}get isPixels(){return this.type==="polygonPixels"||this.type==="polylinePixels"}get isPolygon(){return this.type==="polygon"||this.type==="polygonPixels"}get isPolyline(){return this.type==="polyline"||this.type==="polylinePixels"}get coords(){return this.definition}render(){const e=this.__getAllPolyPositions();if(e[0].length>(this.isPolygon?2:1)){const n=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position),r=e.filter(i=>i.length>0).map(i=>{let a="M";return a+=i.map(c=>`${c.x-n.x},${c.y-n.y}`).join("L"),this.isPolygon&&(a+="Z"),a}).join(" ");return this.domElement.setAttributeNS(null,"d",r),this.domElement.setAttributeNS(null,"transform",`translate(${n.x} ${n.y})`),n}else return null}update(e){super.update(e);const t=this.domElement;t.classList.add("psv-marker--poly"),this.config.svgStyle?(Object.entries(this.config.svgStyle).forEach(([n,r])=>{t.setAttributeNS(null,Dn.dasherize(n),r)}),this.isPolyline&&!this.config.svgStyle.fill&&t.setAttributeNS(null,"fill","none")):this.isPolygon?t.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline&&(t.setAttributeNS(null,"fill","none"),t.setAttributeNS(null,"stroke","rgb(0,0,0)"));try{let n=this.config[this.type];if(!Array.isArray(n[0])&&typeof n[0]!="object")for(let r=0;r<n.length;r++)n.splice(r,2,[n[r],n[r+1]]);if(!Array.isArray(n[0][0])&&typeof n[0][0]!="object"&&(n=[n]),this.isPolyline&&n.length>1)throw new Sn("polylines cannot have holes");this.isPixels?this.definition=n.map(r=>r.map(i=>{let a;return Dn.isExtendedPosition(i)?a=this.viewer.dataHelper.cleanPosition(i):a=this.viewer.dataHelper.textureCoordsToSphericalCoords({textureX:i[0],textureY:i[1]}),[a.yaw,a.pitch]})):this.definition=n.map(r=>r.map(i=>{let a;return Dn.isExtendedPosition(i)?a=this.viewer.dataHelper.cleanPosition(i):a=this.viewer.dataHelper.cleanPosition({yaw:i[0],pitch:i[1]}),[a.yaw,a.pitch]}))}catch(n){throw new Sn(`invalid marker ${this.id} position`,n)}if(this.positions3D=this.coords.map(n=>n.map(r=>this.viewer.dataHelper.sphericalCoordsToVector3({yaw:r[0],pitch:r[1]}))),this.isPolygon){const n=zW(this.positions3D[0]);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(n)}else{const n=EIe(this.coords[0]);this.state.position={yaw:n[0],pitch:n[1]}}this.state.positions3D=this.positions3D[0]}__getAllPolyPositions(){return this.positions3D.map(e=>this.__getPolyPositions(e))}__getPolyPositions(e){const t=e.length,n=e.map(i=>({vector:i,visible:i.dot(this.viewer.state.direction)>0})),r=[];return n.forEach((i,a)=>{i.visible||[a===0?n[t-1]:n[a-1],a===t-1?n[0]:n[a+1]].forEach(o=>{o.visible&&r.push({visible:o.vector,invisible:i.vector,index:a})})}),r.reverse().forEach(i=>{n.splice(i.index,0,{vector:TIe(i.visible,i.invisible,this.viewer.state.direction),visible:!0})}),n.filter(i=>i.visible).map(i=>this.viewer.dataHelper.vector3ToViewerCoords(i.vector))}},LIe=class extends US{get svgElement(){return this.domElement.firstElementChild}constructor(e,t,n){super(e,t,n)}isSvg(){return!0}createElement(){const e=this.type==="square"?"rect":this.type,t=document.createElementNS(BS,e);this.element=document.createElementNS(BS,"svg"),this.element.appendChild(t),this.afterCreateElement()}update(e){super.update(e);const t=this.svgElement;switch(this.needsUpdateSize=!0,this.type){case"square":this.definition={x:0,y:0,width:this.config.square,height:this.config.square};break;case"rect":Array.isArray(this.config.rect)?this.definition={x:0,y:0,width:this.config.rect[0],height:this.config.rect[1]}:this.definition={x:0,y:0,width:this.config.rect.width,height:this.config.rect.height};break;case"circle":this.definition={cx:this.config.circle,cy:this.config.circle,r:this.config.circle};break;case"ellipse":Array.isArray(this.config.ellipse)?this.definition={cx:this.config.ellipse[0],cy:this.config.ellipse[1],rx:this.config.ellipse[0],ry:this.config.ellipse[1]}:this.definition={cx:this.config.ellipse.rx,cy:this.config.ellipse.ry,rx:this.config.ellipse.rx,ry:this.config.ellipse.ry};break;case"path":this.definition={d:this.config.path};break}Object.entries(this.definition).forEach(([n,r])=>{t.setAttributeNS(null,n,r)}),this.config.svgStyle?Object.entries(this.config.svgStyle).forEach(([n,r])=>{t.setAttributeNS(null,Dn.dasherize(n),r)}):t.setAttributeNS(null,"fill","rgba(0,0,0,0.5)")}},kIe=Dn.getConfigParser({clickEventOnMarker:!1,gotoMarkerSpeed:"8rpm",markers:null,defaultHoverScale:null},{defaultHoverScale(e){return e?(e===!0&&(e=rR),typeof e=="number"&&(e={amount:e}),{...rR,...e}):null}});function DIe(e){switch(iR(e,!1)){case"image":case"html":case"element":return IIe;case"imageLayer":case"videoLayer":return PIe;case"elementLayer":return AIe;case"polygon":case"polyline":case"polygonPixels":case"polylinePixels":return RIe;case"square":case"rect":case"circle":case"ellipse":case"path":return LIe;default:throw new Sn("invalid marker type")}}var xx=class OW extends uk{constructor(t,n){super(t,n),this.markers={},this.state={allVisible:!0,showAllTooltips:!1,currentMarker:null,hoveringMarker:null,needsReRender:!1,lastClientX:null,lastClientY:null},this.container=document.createElement("div"),this.container.className="psv-markers",this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",r=>r.preventDefault()),this.svgContainer=document.createElementNS(BS,"svg"),this.svgContainer.setAttribute("class","psv-markers-svg-container"),this.container.appendChild(this.svgContainer),this.css3DContainer=new _Ie(t),this.container.appendChild(this.css3DContainer.element),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0)}static withConfig(t){return[OW,t]}init(){super.init(),Dn.checkStylesheet(this.viewer.container,"markers-plugin"),this.viewer.addEventListener(Fn.ClickEvent.type,this),this.viewer.addEventListener(Fn.DoubleClickEvent.type,this),this.viewer.addEventListener(Fn.RenderEvent.type,this),this.viewer.addEventListener(Fn.ConfigChangedEvent.type,this),this.viewer.addEventListener(Fn.ObjectEnterEvent.type,this),this.viewer.addEventListener(Fn.ObjectHoverEvent.type,this),this.viewer.addEventListener(Fn.ObjectLeaveEvent.type,this),this.viewer.addEventListener(Fn.ReadyEvent.type,this,{once:!0})}destroy(){this.clearMarkers(!1),this.viewer.unobserveObjects(pi),this.viewer.removeEventListener(Fn.ClickEvent.type,this),this.viewer.removeEventListener(Fn.DoubleClickEvent.type,this),this.viewer.removeEventListener(Fn.RenderEvent.type,this),this.viewer.removeEventListener(Fn.ObjectEnterEvent.type,this),this.viewer.removeEventListener(Fn.ObjectHoverEvent.type,this),this.viewer.removeEventListener(Fn.ObjectLeaveEvent.type,this),this.viewer.removeEventListener(Fn.ReadyEvent.type,this),this.css3DContainer.destroy(),this.viewer.container.removeChild(this.container),super.destroy()}handleEvent(t){var n;switch(t.type){case Fn.ReadyEvent.type:this.config.markers&&(this.setMarkers(this.config.markers),delete this.config.markers);break;case Fn.RenderEvent.type:this.renderMarkers();break;case Fn.ClickEvent.type:this.__onClick(t,!1);break;case Fn.DoubleClickEvent.type:this.__onClick(t,!0);break;case Fn.ObjectEnterEvent.type:case Fn.ObjectLeaveEvent.type:case Fn.ObjectHoverEvent.type:if(t.userDataKey===pi){const r=t.originalEvent,i=t.object.userData[pi];switch(t.type){case Fn.ObjectEnterEvent.type:(n=i.config.style)!=null&&n.cursor?this.viewer.setCursor(i.config.style.cursor):(i.config.tooltip||i.config.content)&&this.viewer.setCursor("pointer"),this.__onEnterMarker(r,i);break;case Fn.ObjectLeaveEvent.type:this.viewer.setCursor(null),this.__onLeaveMarker(i);break;case Fn.ObjectHoverEvent.type:this.__onHoverMarker(r,i);break}}break;case"mouseenter":{const r=this.__getTargetMarker(Dn.getEventTarget(t));this.__onEnterMarker(t,r);break}case"mouseleave":{const r=this.__getTargetMarker(Dn.getEventTarget(t));this.__onLeaveMarker(r);break}case"mousemove":{const r=this.__getTargetMarker(Dn.getEventTarget(t),!0);this.__onHoverMarker(t,r);break}}}toggleAllMarkers(){this.state.allVisible?this.hideAllMarkers():this.showAllMarkers()}showAllMarkers(){this.state.allVisible=!0,Object.values(this.markers).forEach(t=>{t.config.visible=!0}),this.renderMarkers(),this.dispatchEvent(new Oy)}hideAllMarkers(){this.state.allVisible=!1,Object.values(this.markers).forEach(t=>{t.config.visible=!1}),this.renderMarkers(),this.dispatchEvent(new zy)}toggleAllTooltips(){this.state.showAllTooltips?this.hideAllTooltips():this.showAllTooltips()}showAllTooltips(){this.state.showAllTooltips=!0,Object.values(this.markers).forEach(t=>{t.state.staticTooltip=!0,t.showTooltip()})}hideAllTooltips(){this.state.showAllTooltips=!1,Object.values(this.markers).forEach(t=>{t.state.staticTooltip=!1,t.hideTooltip()})}getNbMarkers(){return Object.keys(this.markers).length}getMarkers(){return Object.values(this.markers)}addMarker(t,n=!0){if(this.markers[t.id])throw new Sn(`marker "${t.id}" already exists`);const r=new(DIe(t))(this.viewer,this,t);r.isPoly()?this.svgContainer.appendChild(r.domElement):r.isCss3d()?this.css3DContainer.addObject(r):r.is3d()?this.viewer.renderer.addObject(r.threeElement):this.container.appendChild(r.domElement),this.markers[r.id]=r,this.state.showAllTooltips&&(r.state.staticTooltip=!0),n&&this.__afterChangeMarkers()}getMarker(t){const n=typeof t=="object"?t.id:t;if(!this.markers[n])throw new Sn(`cannot find marker "${n}"`);return this.markers[n]}getCurrentMarker(){return this.state.currentMarker}updateMarker(t,n=!0){var i;const r=this.getMarker(t.id);r.update(t),n&&(this.__afterChangeMarkers(),(r===this.state.hoveringMarker&&((i=r.config.tooltip)==null?void 0:i.trigger)==="hover"||r.state.staticTooltip)&&r.showTooltip(this.state.lastClientX,this.state.lastClientY,!0))}removeMarker(t,n=!0){const r=this.getMarker(t);r.isPoly()?this.svgContainer.removeChild(r.domElement):r.isCss3d()?this.css3DContainer.removeObject(r):r.is3d()?this.viewer.renderer.removeObject(r.threeElement):this.container.removeChild(r.domElement),this.state.hoveringMarker===r&&(this.state.hoveringMarker=null),this.state.currentMarker===r&&(this.state.currentMarker=null),r.destroy(),delete this.markers[r.id],n&&this.__afterChangeMarkers()}removeMarkers(t,n=!0){t.forEach(r=>this.removeMarker(r,!1)),n&&this.__afterChangeMarkers()}setMarkers(t,n=!0){this.clearMarkers(!1),t==null||t.forEach(r=>{this.addMarker(r,!1)}),n&&this.__afterChangeMarkers()}clearMarkers(t=!0){Object.keys(this.markers).forEach(n=>{this.removeMarker(n,!1)}),t&&this.__afterChangeMarkers()}gotoMarker(t,n=this.config.gotoMarkerSpeed){const r=this.getMarker(t);return n?this.viewer.animate({...r.state.position,zoom:r.config.zoomLvl,speed:n}).then(()=>{this.dispatchEvent(new nR(r))}):(this.viewer.rotate(r.state.position),Dn.isNil(r.config.zoomLvl)||this.viewer.zoom(r.config.zoomLvl),this.dispatchEvent(new nR(r)),Promise.resolve())}hideMarker(t){this.toggleMarker(t,!1)}showMarker(t){this.toggleMarker(t,!0)}showMarkerTooltip(t){const n=this.getMarker(t);n.state.staticTooltip=!0,n.showTooltip()}hideMarkerTooltip(t){const n=this.getMarker(t);n.state.staticTooltip=!1,n.hideTooltip()}toggleMarker(t,n){const r=this.getMarker(t);r.config.visible=Dn.isNil(n)?!r.config.visible:n,this.renderMarkers()}showMarkerPanel(t){const n=this.getMarker(t);n.config.content?this.viewer.panel.show({id:N0,content:n.config.content}):this.hideMarkerPanel()}hideMarkerPanel(){this.viewer.panel.hide(N0)}toggleMarkersList(){this.viewer.panel.isVisible(Cm)?this.hideMarkersList():this.showMarkersList()}showMarkersList(){let t=[];Object.values(this.markers).forEach(r=>{r.config.visible&&!r.config.hideList&&t.push(r)});const n=new LW(t);this.dispatchEvent(n),t=n.markers,this.viewer.panel.show({id:Cm,content:pIe(t,this.viewer.config.lang[S_.id]),noMargin:!0,clickHandler:r=>{const i=Dn.getClosest(r,".psv-panel-menu-item"),a=i?i.dataset[pi]:void 0;if(a){const c=this.getMarker(a);this.dispatchEvent(new _W(c)),this.gotoMarker(c.id),this.hideMarkersList()}}})}hideMarkersList(){this.viewer.panel.hide(Cm)}renderMarkers(){if(this.state.needsReRender){this.state.needsReRender=!1;return}const t=this.viewer.getZoomLevel(),n=this.viewer.getPosition(),r=this.state.hoveringMarker;Object.values(this.markers).forEach(i=>{let a=i.config.visible,c=!1,o=null;a&&(o=i.render({viewerPosition:n,zoomLevel:t,hoveringMarker:r}),a=!!o),c=i.state.visible!==a,i.state.visible=a,i.state.position2D=o,i.domElement&&Dn.toggleClass(i.domElement,"psv-marker--visible",a),a?i.state.staticTooltip?i.showTooltip():i!==this.state.hoveringMarker&&i.hideTooltip():i.hideTooltip(),c&&(this.dispatchEvent(new oW(i,a)),(i.is3d()||i.isCss3d())&&(this.state.needsReRender=!0))}),this.state.needsReRender&&this.viewer.needsUpdate()}__getTargetMarker(t,n=!1){if(t instanceof Node){const r=n?Dn.getClosest(t,".psv-marker"):t;return r?r[pi]:void 0}else return Array.isArray(t)?t.map(r=>r.userData[pi]).filter(r=>!!r).sort((r,i)=>i.config.zIndex-r.config.zIndex)[0]:null}__onEnterMarker(t,n){var r;n&&(this.state.hoveringMarker=n,this.state.lastClientX=t.clientX,this.state.lastClientY=t.clientY,this.dispatchEvent(new fW(n)),n instanceof US&&n.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!0}),!n.state.staticTooltip&&((r=n.config.tooltip)==null?void 0:r.trigger)==="hover"&&n.showTooltip(t.clientX,t.clientY))}__onLeaveMarker(t){var n;t&&(this.dispatchEvent(new uW(t)),t instanceof US&&t.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!1}),this.state.hoveringMarker=null,!t.state.staticTooltip&&((n=t.config.tooltip)==null?void 0:n.trigger)==="hover"?t.hideTooltip():t.state.staticTooltip&&t.showTooltip())}__onHoverMarker(t,n){var r;n&&(this.state.lastClientX=t.clientX,this.state.lastClientY=t.clientY,(n.isPoly()||n.is3d()||n.isCss3d())&&((r=n.config.tooltip)==null?void 0:r.trigger)==="hover"&&n.showTooltip(t.clientX,t.clientY))}__onClick(t,n){var c,o;const r=this.__getTargetMarker(t.data.objects),a=this.__getTargetMarker(t.data.target,!0)||r;this.state.currentMarker&&this.state.currentMarker!==a&&(this.dispatchEvent(new wW(this.state.currentMarker)),this.viewer.panel.hide(N0),!this.state.showAllTooltips&&((c=this.state.currentMarker.config.tooltip)==null?void 0:c.trigger)==="click"&&this.hideMarkerTooltip(this.state.currentMarker.id),this.state.currentMarker=null),a&&(this.state.currentMarker=a,this.dispatchEvent(new gW(a,n,t.data.rightclick)),this.config.clickEventOnMarker?t.data.marker=a:t.stopImmediatePropagation(),this.markers[a.id]&&!t.data.rightclick&&(((o=a.config.tooltip)==null?void 0:o.trigger)==="click"?a.tooltip?this.hideMarkerTooltip(a.id):this.showMarkerTooltip(a.id):this.showMarkerPanel(a.id)))}__afterChangeMarkers(){this.__refreshUi(),this.__checkObjectsObserver(),this.viewer.needsUpdate(),this.dispatchEvent(new TW(this.getMarkers()))}__refreshUi(){var n,r;const t=Object.values(this.markers).filter(i=>!i.config.hideList).length;t===0?(this.viewer.panel.hide(N0),this.viewer.panel.hide(Cm)):this.viewer.panel.isVisible(Cm)?this.showMarkersList():this.viewer.panel.isVisible(N0)&&(this.state.currentMarker?this.showMarkerPanel(this.state.currentMarker.id):this.viewer.panel.hide()),(n=this.viewer.navbar.getButton(S_.id,!1))==null||n.toggle(t>0),(r=this.viewer.navbar.getButton(T2.id,!1))==null||r.toggle(t>0)}__checkObjectsObserver(){Object.values(this.markers).some(n=>n.is3d())?this.viewer.observeObjects(pi):this.viewer.unobserveObjects(pi)}};xx.id="markers";xx.VERSION="5.13.4";xx.configParser=kIe;xx.readonlyOptions=["markers"];var zIe=xx;yu.lang[S_.id]="Markers";yu.lang[T2.id]="Markers list";hk(S_,"caption:left");hk(T2,"caption:left");/*!
 * Photo Sphere Viewer / Virtual Tour Plugin 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var OIe=Object.defineProperty,FIe=(e,t)=>{for(var n in t)OIe(e,n,{get:t[n],enumerable:!0})},NIe={};FIe(NIe,{EnterArrowEvent:()=>VW,LeaveArrowEvent:()=>GW,NodeChangedEvent:()=>BW});var FW=class NW extends vx{constructor(t,n){super(NW.type),this.node=t,this.data=n}};FW.type="node-changed";var BW=FW,UW=class $W extends vx{constructor(t,n){super($W.type),this.link=t,this.node=n}};UW.type="enter-arrow";var VW=UW,jW=class HW extends vx{constructor(t,n){super(HW.type),this.link=t,this.node=n}};jW.type="leave-arrow";var GW=jW,BIe=class extends Go{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Dr(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}},mm=new dt,a6=new jr,l6=new jr,c6=new dt,u6=new dt,UIe=class{constructor(e={}){const t=this;let n,r,i,a;const c={objects:new WeakMap},o=e.element!==void 0?e.element:document.createElement("div");o.style.overflow="hidden",this.domElement=o,this.getSize=function(){return{width:n,height:r}},this.render=function(C,A){C.matrixWorldAutoUpdate===!0&&C.updateMatrixWorld(),A.parent===null&&A.matrixWorldAutoUpdate===!0&&A.updateMatrixWorld(),a6.copy(A.matrixWorldInverse),l6.multiplyMatrices(A.projectionMatrix,a6),g(C,C,A),M(C)},this.setSize=function(C,A){n=C,r=A,i=n/2,a=r/2,o.style.width=C+"px",o.style.height=A+"px"};function f(C){C.isCSS2DObject&&(C.element.style.display="none");for(let A=0,L=C.children.length;A<L;A++)f(C.children[A])}function g(C,A,L){if(C.visible===!1){f(C);return}if(C.isCSS2DObject){mm.setFromMatrixPosition(C.matrixWorld),mm.applyMatrix4(l6);const I=mm.z>=-1&&mm.z<=1&&C.layers.test(L.layers)===!0,T=C.element;T.style.display=I===!0?"":"none",I===!0&&(C.onBeforeRender(t,A,L),T.style.transform="translate("+-100*C.center.x+"%,"+-100*C.center.y+"%)translate("+(mm.x*i+i)+"px,"+(-mm.y*a+a)+"px)",T.parentNode!==o&&o.appendChild(T),C.onAfterRender(t,A,L));const z={distanceToCameraSquared:_(L,C)};c.objects.set(C,z)}for(let I=0,T=C.children.length;I<T;I++)g(C.children[I],A,L)}function _(C,A){return c6.setFromMatrixPosition(C.matrixWorld),u6.setFromMatrixPosition(A.matrixWorld),c6.distanceToSquared(u6)}function x(C){const A=[];return C.traverseVisible(function(L){L.isCSS2DObject&&A.push(L)}),A}function M(C){const A=x(C).sort(function(I,T){if(I.renderOrder!==T.renderOrder)return T.renderOrder-I.renderOrder;const z=c.objects.get(I).distanceToCameraSquared,k=c.objects.get(T).distanceToCameraSquared;return z-k}),L=A.length;for(let I=0,T=A.length;I<T;I++)A[I].element.style.zIndex=L-I}}},h6=new dt,$Ie=new ud,d6=new dt,VIe=class extends Go{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}},rc=new jr,jIe=new jr,HIe=class{constructor(e={}){const t=this;let n,r,i,a;const c={camera:{style:""},objects:new WeakMap},o=e.element!==void 0?e.element:document.createElement("div");o.style.overflow="hidden",this.domElement=o;const f=document.createElement("div");f.style.transformOrigin="0 0",f.style.pointerEvents="none",o.appendChild(f);const g=document.createElement("div");g.style.transformStyle="preserve-3d",f.appendChild(g),this.getSize=function(){return{width:n,height:r}},this.render=function(L,I){const T=I.projectionMatrix.elements[5]*a;I.view&&I.view.enabled?(f.style.transform=`translate( ${-I.view.offsetX*(n/I.view.width)}px, ${-I.view.offsetY*(r/I.view.height)}px )`,f.style.transform+=`scale( ${I.view.fullWidth/I.view.width}, ${I.view.fullHeight/I.view.height} )`):f.style.transform="",L.matrixWorldAutoUpdate===!0&&L.updateMatrixWorld(),I.parent===null&&I.matrixWorldAutoUpdate===!0&&I.updateMatrixWorld();let z,k;I.isOrthographicCamera&&(z=-(I.right+I.left)/2,k=(I.top+I.bottom)/2);const U=I.view&&I.view.enabled?I.view.height/I.view.fullHeight:1,H=I.isOrthographicCamera?`scale( ${U} )scale(`+T+")translate("+_(z)+"px,"+_(k)+"px)"+x(I.matrixWorldInverse):`scale( ${U} )translateZ(`+T+"px)"+x(I.matrixWorldInverse),q=(I.isPerspectiveCamera?"perspective("+T+"px) ":"")+H+"translate("+i+"px,"+a+"px)";c.camera.style!==q&&(g.style.transform=q,c.camera.style=q),A(L,L,I)},this.setSize=function(L,I){n=L,r=I,i=n/2,a=r/2,o.style.width=L+"px",o.style.height=I+"px",f.style.width=L+"px",f.style.height=I+"px",g.style.width=L+"px",g.style.height=I+"px"};function _(L){return Math.abs(L)<1e-10?0:L}function x(L){const I=L.elements;return"matrix3d("+_(I[0])+","+_(-I[1])+","+_(I[2])+","+_(I[3])+","+_(I[4])+","+_(-I[5])+","+_(I[6])+","+_(I[7])+","+_(I[8])+","+_(-I[9])+","+_(I[10])+","+_(I[11])+","+_(I[12])+","+_(-I[13])+","+_(I[14])+","+_(I[15])+")"}function M(L){const I=L.elements;return"translate(-50%,-50%)"+("matrix3d("+_(I[0])+","+_(I[1])+","+_(I[2])+","+_(I[3])+","+_(-I[4])+","+_(-I[5])+","+_(-I[6])+","+_(-I[7])+","+_(I[8])+","+_(I[9])+","+_(I[10])+","+_(I[11])+","+_(I[12])+","+_(I[13])+","+_(I[14])+","+_(I[15])+")")}function C(L){L.isCSS3DObject&&(L.element.style.display="none");for(let I=0,T=L.children.length;I<T;I++)C(L.children[I])}function A(L,I,T,z){if(L.visible===!1){C(L);return}if(L.isCSS3DObject){const k=L.layers.test(T.layers)===!0,U=L.element;if(U.style.display=k===!0?"":"none",k===!0){L.onBeforeRender(t,I,T);let H;L.isCSS3DSprite?(rc.copy(T.matrixWorldInverse),rc.transpose(),L.rotation2D!==0&&rc.multiply(jIe.makeRotationZ(L.rotation2D)),L.matrixWorld.decompose(h6,$Ie,d6),rc.setPosition(h6),rc.scale(d6),rc.elements[3]=0,rc.elements[7]=0,rc.elements[11]=0,rc.elements[15]=1,H=M(rc)):H=M(L.matrixWorld);const V=c.objects.get(L);if(V===void 0||V.style!==H){U.style.transform=H;const q={style:H};c.objects.set(L,q)}U.parentNode!==g&&g.appendChild(U),L.onAfterRender(t,I,T)}}for(let k=0,U=L.children.length;k<U;k++)A(L.children[k],I,T)}}},GIe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
    <path fill-rule="even-odd" fill="currentColor" d="
        M50,50 m45,0
        a45,45 0 1,0 -90,0
        a45,45 0 1,0  90,0

        M50,50 m38,0
        a38,38 0 0,1 -76,0
        a38,38 0 0,1  76,0

        M50,50 m30,0
        a30,30 0 1,0 -60,0
        a30,30 0 1,0  60,0
        
        M50,40 m2.5,-2.5
        l17.5,17.5
        a 2.5,2.5 0 0 1 -5,5
        l-15,-15
        l-15,15
        a 2.5,2.5 0 0 1 -5,-5
        l17.5,-17.5
        a 3.5,3.5 0 0 1 5,0
    "/>
</svg>`,$S="tourLink",gm="__tour-link__",WIe={className:"psv-virtual-tour-tooltip",content:'<div class="psv-virtual-tour-loader"><div></div><div></div><div></div></div>'},qIe={element:()=>{const e=document.createElement("button");return e.className="psv-virtual-tour-arrow",e.innerHTML=GIe,e},size:{width:80,height:80}},yP="arrow",XIe=class extends hd{constructor(e,t){super(e,{className:"psv-virtual-tour-arrows"}),this.plugin=t,this.renderer=this.is3D?new HIe({element:this.container}):new UIe({element:this.container}),this.camera=this.is3D?new pa(30,1):null,this.scene=new PS,this.viewer.addEventListener(Fn.ReadyEvent.type,this,{once:!0}),this.viewer.addEventListener(Fn.PositionUpdatedEvent.type,this),this.viewer.addEventListener(Fn.SizeUpdatedEvent.type,this),this.viewer.addEventListener(Fn.RenderEvent.type,this),this.viewer.addEventListener(Fn.ClickEvent.type,this),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("contextmenu",n=>n.preventDefault())}get is3D(){return this.plugin.is3D}get arrowsPosition(){return this.plugin.config.arrowsPosition}get arrowStyle(){return this.plugin.config.arrowStyle}init(){var e,t;this.is3D&&(this.gallery=this.viewer.getPlugin("gallery"),(e=this.gallery)==null||e.addEventListener("show-gallery",this),(t=this.gallery)==null||t.addEventListener("hide-gallery",this))}destroy(){var e,t;this.viewer.removeEventListener(Fn.ReadyEvent.type,this),this.viewer.removeEventListener(Fn.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(Fn.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(Fn.RenderEvent.type,this),this.viewer.removeEventListener(Fn.ClickEvent.type,this),(e=this.gallery)==null||e.removeEventListener("show-gallery",this),(t=this.gallery)==null||t.removeEventListener("hide-gallery",this),super.destroy()}handleEvent(e){switch(e.type){case Fn.ReadyEvent.type:case Fn.SizeUpdatedEvent.type:case Fn.PositionUpdatedEvent.type:this.__updateCamera();break;case Fn.RenderEvent.type:this.render();break;case Fn.ClickEvent.type:{if(e.data.rightclick)break;const t=this.__getTargetLink(e.data.target,!0);t&&this.plugin.setCurrentNode(t.nodeId,null,t);break}case"mouseenter":{const t=this.__getTargetLink(Dn.getEventTarget(e));t&&this.plugin.__onEnterArrow(t,e);break}case"mouseleave":{const t=this.__getTargetLink(Dn.getEventTarget(e));t&&this.plugin.__onLeaveArrow(t);break}case"mousemove":{this.__getTargetLink(Dn.getEventTarget(e),!0)&&this.plugin.__onHoverArrow(e);break}case"hide-gallery":this.__onToggleGallery(!1);break;case"show-gallery":e.fullscreen||this.__onToggleGallery(!0);break}}__updateCamera(){const e=this.viewer.getSize();if(this.renderer.setSize(e.width,e.height),this.is3D){const t=this.viewer.getPosition();t.pitch=mr.clamp(t.pitch,-this.arrowsPosition.maxPitch,-this.arrowsPosition.minPitch),this.viewer.dataHelper.sphericalCoordsToVector3(t,this.camera.position,e.height*2).negate(),this.camera.lookAt(0,0,0),this.camera.translateY(e.height/3),this.camera.updateProjectionMatrix()}}render(){if(this.is3D){const e=this.viewer.getPosition(),t=[];let n=Number.MAX_SAFE_INTEGER;this.scene.children.forEach(r=>{const i=r.userData[yP];if(i.conflict){const a=Math.abs(Dn.getShortestArc(e.yaw,i.yaw));n=Math.min(n,a),t.push([r,a])}}),t.forEach(([r,i])=>{const a=i!==n;r.element.style.opacity=a?"0.5":null,r.element.style.zIndex=a?"-1":null}),this.renderer.render(this.scene,this.camera)}else this.renderer.render(this.scene,this.viewer.renderer.camera)}clear(){this.scene.clear()}__buildArrowElement(e,t){if(t!=null&&t.image){const n=document.createElement("img");return n.src=t.image,n}else if(t!=null&&t.element)return typeof t.element=="function"?t.element(e):t.element}addLinkArrow(e,t,n=1){let r=this.__buildArrowElement(e,e.arrowStyle);r||(r=this.__buildArrowElement(e,this.arrowStyle)),r[$S]=e;const i={...this.arrowStyle,...e.arrowStyle};if(r.classList.add("psv-virtual-tour-link"),i.className&&Dn.addClasses(r,i.className),i.style&&Object.assign(r.style,i.style),this.is3D){r.style.width=i.size.width*1.5+"px",r.style.height=i.size.height*1.5+"px";let a=!1;this.scene.children.forEach(o=>{const f=o.userData[yP];Math.abs(Dn.getShortestArc(f.yaw,t.yaw))<this.arrowsPosition.linkOverlapAngle&&(f.conflict=!0,a=!0)});const c=new VIe(r);c.userData[yP]={yaw:t.yaw,conflict:a},c.rotation.set(-Math.PI/2,0,Math.PI-t.yaw),this.viewer.dataHelper.sphericalCoordsToVector3({yaw:t.yaw,pitch:0},c.position,n*100),this.scene.add(c)}else{r.style.width=i.size.width+"px",r.style.height=i.size.height+"px",r.style.pointerEvents="auto";const a=new BIe(r);this.viewer.dataHelper.sphericalCoordsToVector3(t,a.position),this.scene.add(a)}}__getTargetLink(e,t=!1){const n=t?Dn.getClosest(e,".psv-virtual-tour-link"):e;return n?n[$S]:void 0}__onToggleGallery(e){e?this.container.style.marginBottom=this.viewer.container.querySelector(".psv-gallery").offsetHeight+"px":this.container.style.marginBottom=""}},WW=class{constructor(e,t){this.plugin=e,this.viewer=t,this.nodes={}}destroy(){}checkNode(e){var t,n;if(!e.id)throw new Sn("No id given for node");if(!e.panorama)throw new Sn(`No panorama provided for node ${e.id}`);if(this.plugin.isGps&&!(((t=e.gps)==null?void 0:t.length)>=2))throw new Sn(`No GPS position provided for node ${e.id}`);if(!this.plugin.isGps&&((n=e.markers)!=null&&n.some(r=>r.gps&&!r.position)))throw new Sn("Cannot use GPS positioning for markers in manual mode");e.links||(Dn.logWarn(`Node ${e.id} has no links`),e.links=[])}checkLink(e,t){if(!t.nodeId)throw new Sn(`Link of node ${e.id} has no target id`);if(t.nodeId===e.id)throw new Sn(`Node ${e.id} links to itself`);if(!this.plugin.isGps&&!Dn.isExtendedPosition(t.position))throw new Sn(`No position provided for link ${t.nodeId} of node ${e.id}`);if(this.plugin.isGps&&!t.gps)throw new Sn(`No GPS position provided for link ${t.nodeId} of node ${e.id}`)}},ZIe=class extends WW{async loadNode(e){if(this.nodes[e])return this.nodes[e];throw new Sn(`Node ${e} not found`)}setNodes(e){if(!(e!=null&&e.length))throw new Sn("No nodes provided");const t={},n={};e.forEach(r=>{if(this.checkNode(r),t[r.id])throw new Sn(`Duplicate node ${r.id}`);t[r.id]=r}),e.forEach(r=>{this.__checkLinks(r,t),r.links.forEach(i=>{n[i.nodeId]=!0})}),e.forEach(r=>{n[r.id]||Dn.logWarn(`Node ${r.id} is never linked to`)}),this.nodes=t}updateNode(e){if(!e.id)throw new Sn("No id given for node");const t=this.nodes[e.id];if(!t)throw new Sn(`Node ${e.id} does not exist`);return Object.assign(t,e),this.checkNode(t),this.__checkLinks(t,this.nodes),t}__checkLinks(e,t){e.links.forEach(n=>{if(!t[n.nodeId])throw new Sn(`Target node ${n.nodeId} of node ${e.id} does not exists`);n.gps=n.gps||t[n.nodeId].gps,this.checkLink(e,n)})}},YIe=class extends WW{constructor(e,t){if(super(e,t),!e.config.getNode)throw new Sn("Missing getNode() option.");this.nodeResolver=e.config.getNode}async loadNode(e){if(this.nodes[e])return this.nodes[e];{const t=await this.nodeResolver(e);return this.checkNode(t),t.links.forEach(n=>{this.checkLink(t,n)}),this.nodes[e]=t,t}}clearCache(){this.nodes={}}};function f6(e,t){const n=p6(e),r=p6(t),i=e[2]??0,a=t[2]??0;let c=0;return i!==a&&(c=Math.atan((a-i)/KIe(n,r))),{yaw:JIe(n,r),pitch:c}}function p6(e){return[mr.degToRad(e[0]),mr.degToRad(e[1])]}function KIe(e,t){return Dn.greatArcDistance(e,t)*6371e3}function JIe(e,t){const[n,r]=e,[i,a]=t,c=Math.sin(i-n)*Math.cos(a),o=Math.cos(r)*Math.sin(a)-Math.sin(r)*Math.cos(a)*Math.cos(i-n);return Math.atan2(c,o)}var gk=Dn.getConfigParser({dataMode:"client",positionMode:"manual",renderMode:"3d",nodes:null,getNode:null,startNodeId:null,preload:!1,transitionOptions:{showLoader:!0,speed:"20rpm",effect:"fade",rotation:!0},linksOnCompass:!0,showLinkTooltip:!0,getLinkTooltip:null,arrowStyle:qIe,arrowsPosition:{minPitch:.3,maxPitch:Math.PI/2,linkOverlapAngle:Math.PI/4,linkPitchOffset:-.1},map:null},{dataMode(e){if(e!=="client"&&e!=="server")throw new Sn("VirtualTourPlugin: invalid dataMode");return e},positionMode(e){if(e!=="gps"&&e!=="manual")throw new Sn("VirtualTourPlugin: invalid positionMode");return e},renderMode(e){if(e!=="3d"&&e!=="2d")throw new Sn("VirtualTourPlugin: invalid renderMode");return e},arrowsPosition(e,{defValue:t}){return{...t,...e}},arrowStyle(e,{defValue:t}){return{...t,...e}},map(e,{rawConfig:t}){if(e){if(t.dataMode==="server")return Dn.logWarn("VirtualTourPlugin: The map cannot be used in server side mode"),null;if(!e.imageUrl)return Dn.logWarn('VirtualTourPlugin: configuring the map requires at least "imageUrl"'),null}return e}}),bx=class qW extends uk{constructor(t,n){super(t,n),this.state={currentNode:null,currentTooltip:null,loadingNode:null,preload:{}},this.arrowsRenderer=new XIe(this.viewer,this)}get is3D(){return this.config.renderMode==="3d"}get isServerSide(){return this.config.dataMode==="server"}get isGps(){return this.config.positionMode==="gps"}static withConfig(t){return[qW,t]}init(){var t,n;super.init(),this.arrowsRenderer.init(),Dn.checkStylesheet(this.viewer.container,"virtual-tour-plugin"),this.markers=this.viewer.getPlugin("markers"),this.compass=this.viewer.getPlugin("compass"),(t=this.markers)!=null&&t.config.markers&&(Dn.logWarn("No default markers can be configured on the MarkersPlugin when using the VirtualTourPlugin. Consider defining `markers` on each tour node."),delete this.markers.config.markers),this.isGps&&(this.plan=this.viewer.getPlugin("plan")),this.isServerSide||(this.gallery=this.viewer.getPlugin("gallery"),this.map=this.viewer.getPlugin("map"),this.config.map&&!this.map&&Dn.logWarn("The map is configured on the VirtualTourPlugin but the MapPlugin is not loaded.")),this.datasource=this.isServerSide?new YIe(this,this.viewer):new ZIe(this,this.viewer),this.map&&(this.map.addEventListener("select-hotspot",this),this.map.setImage(this.config.map.imageUrl)),(n=this.plan)==null||n.addEventListener("select-hotspot",this),this.isServerSide?this.config.startNodeId&&this.setCurrentNode(this.config.startNodeId):this.config.nodes&&(this.setNodes(this.config.nodes,this.config.startNodeId),delete this.config.nodes)}destroy(){var t,n;(t=this.map)==null||t.removeEventListener("select-hotspot",this),(n=this.plan)==null||n.removeEventListener("select-hotspot",this),this.datasource.destroy(),this.arrowsRenderer.destroy(),delete this.datasource,delete this.markers,delete this.compass,delete this.gallery,delete this.arrowsRenderer,super.destroy()}handleEvent(t){var n;if(t instanceof Fn.ClickEvent){const r=(n=t.data.objects.find(i=>i.userData[$S]))==null?void 0:n.userData[$S];r&&this.setCurrentNode(r.nodeId,null,r)}else if(t.type==="select-hotspot"){const r=t.hotspotId;r.startsWith(gm)&&this.setCurrentNode(r.substring(gm.length))}}getCurrentNode(){return this.state.currentNode}setNodes(t,n){if(this.isServerSide)throw new Sn("Cannot set nodes in server side mode");this.__hideTooltip(),this.state.currentNode=null,this.datasource.setNodes(t),n?this.datasource.nodes[n]||(n=t[0].id,Dn.logWarn(`startNodeId not found is provided nodes, resetted to ${n}`)):n=t[0].id,this.setCurrentNode(n),this.__setGalleryItems(),this.__setMapHotspots(),this.__setPlanHotspots()}setCurrentNode(t,n,r){var c;if(t===((c=this.state.currentNode)==null?void 0:c.id)&&!(n!=null&&n.forceUpdate))return Promise.resolve(!0);n!=null&&n.forceUpdate&&this.isServerSide&&this.datasource.clearCache(),this.viewer.hideError(),this.state.loadingNode=t;const i=this.state.currentNode,a=i&&r?this.__getLinkPosition(i,r):null;return Promise.resolve(this.state.preload[t]).then(()=>{if(this.state.loadingNode!==t)throw Dn.getAbortError();return this.datasource.loadNode(t)}).then(o=>{var g,_,x;if(this.state.loadingNode!==t)throw Dn.getAbortError();const f={...gk.defaults.transitionOptions,rotateTo:a,zoomTo:a?this.viewer.getZoomLevel():null,...typeof this.config.transitionOptions=="function"?this.config.transitionOptions(o,i,r):this.config.transitionOptions,...n};return f.effect||(f.effect="none"),this.viewer.panel.hide("description"),this.__hideTooltip(),this.arrowsRenderer.clear(),(g=this.gallery)!=null&&g.config.hideOnClick&&this.gallery.hide(),(_=this.map)!=null&&_.config.minimizeOnHotspotClick&&this.map.minimize(),(x=this.plan)!=null&&x.config.minimizeOnHotspotClick&&this.plan.minimize(),f.rotation&&f.effect==="none"?this.viewer.animate({...f.rotateTo,zoom:f.zoomTo,speed:f.speed}).then(()=>[o,f]):Promise.resolve([o,f])}).then(([o,f])=>{var g,_;if(this.state.loadingNode!==t)throw Dn.getAbortError();return(g=this.markers)==null||g.clearMarkers(),this.config.linksOnCompass&&((_=this.compass)==null||_.clearHotspots()),this.viewer.setPanorama(o.panorama,{caption:o.caption,description:o.description,panoData:o.panoData,sphereCorrection:o.sphereCorrection,showLoader:f.showLoader,position:f.rotateTo,zoom:f.zoomTo,transition:f.effect==="none"?!1:{effect:f.effect,rotation:f.rotation,speed:f.speed}}).then(x=>{if(!x)throw Dn.getAbortError();return o})}).then(o=>{var f;if(this.state.loadingNode!==t)throw Dn.getAbortError();return this.state.currentNode=o,this.map&&this.map.setCenter(this.__getNodeMapPosition(o)??this.map.config.center),(f=this.plan)==null||f.setCoordinates(o.gps),this.__addNodeMarkers(o),this.__renderLinks(o),this.__preload(o),this.state.loadingNode=null,this.dispatchEvent(new BW(o,{fromNode:i,fromLink:r,fromLinkPosition:a})),this.viewer.resetIdleTimer(),!0}).catch(o=>{if(Dn.isAbortError(o))return!1;throw this.viewer.showError(this.viewer.config.lang.loadError),this.viewer.loader.hide(),this.viewer.navbar.setCaption(""),this.state.loadingNode=null,o})}async gotoLink(t,n="8rpm"){const r=this.getLinkPosition(t);n?await this.viewer.animate({...r,speed:n}):this.viewer.rotate(r)}getLinkPosition(t){var r;const n=(r=this.state.currentNode)==null?void 0:r.links.find(i=>i.nodeId===t);if(!n)throw new Sn(`Cannot find link "${t}"`);return this.__getLinkPosition(this.state.currentNode,n)}updateNode(t){var r,i,a;if(this.isServerSide)throw new Sn("Cannot update node in server side mode");const n=this.datasource.updateNode(t);if((t.name||t.thumbnail||t.panorama)&&this.__setGalleryItems(),(t.name||t.gps||t.map)&&this.__setMapHotspots(),(t.name||t.gps||t.plan)&&this.__setPlanHotspots(),((r=this.state.currentNode)==null?void 0:r.id)===n.id){if(this.__hideTooltip(),t.panorama||t.panoData||t.sphereCorrection){this.setCurrentNode(n.id,{forceUpdate:!0});return}t.caption&&this.viewer.setOption("caption",n.caption),t.description&&this.viewer.setOption("description",n.description),(t.links||t.gps)&&this.__renderLinks(n),t.gps&&((i=this.plan)==null||i.setCoordinates(n.gps)),(t.map||t.gps)&&((a=this.map)==null||a.setCenter(this.__getNodeMapPosition(n))),(t.markers||t.gps)&&this.__addNodeMarkers(n)}}__setGalleryItems(){this.gallery&&this.gallery.setItems(Object.values(this.datasource.nodes).filter(t=>t.showInGallery!==!1).map(t=>({id:t.id,panorama:t.panorama,name:t.name,thumbnail:t.thumbnail})),t=>{this.setCurrentNode(t)})}__setMapHotspots(){this.map&&this.map.setHotspots(Object.values(this.datasource.nodes).filter(t=>t.map!==!1).map(t=>({tooltip:t.name,...t.map||{},...this.__getNodeMapPosition(t),id:gm+t.id})))}__setPlanHotspots(){this.plan&&this.plan.setHotspots(Object.values(this.datasource.nodes).filter(t=>t.plan!==!1).map(t=>({tooltip:t.name,...t.plan||{},coordinates:t.gps,id:gm+t.id})))}__renderLinks(t){var r;this.arrowsRenderer.clear();const n=[];t.links.forEach(i=>{var c,o,f;const a=this.__getLinkPosition(t,i);a.yaw+=((c=i.linkOffset)==null?void 0:c.yaw)??0,a.pitch+=((o=i.linkOffset)==null?void 0:o.pitch)??0,this.isGps&&!this.is3D&&(a.pitch+=this.config.arrowsPosition.linkPitchOffset),n.push(a),this.arrowsRenderer.addLinkArrow(i,a,(f=i.linkOffset)==null?void 0:f.depth)}),this.arrowsRenderer.render(),this.config.linksOnCompass&&((r=this.compass)==null||r.setHotspots(n))}__getLinkPosition(t,n){return this.isGps?f6(t.gps,n.gps):this.viewer.dataHelper.cleanPosition(n.position)}async __getTooltipContent(t){const n=await this.datasource.loadNode(t.nodeId),r=[];(n.name||n.thumbnail||n.caption)&&(n.name&&r.push(`<h3>${n.name}</h3>`),n.thumbnail&&r.push(`<img src="${n.thumbnail}">`),n.caption&&r.push(`<p>${n.caption}</p>`));let i=r.join("");return this.config.getLinkTooltip&&(i=this.config.getLinkTooltip(i,t,n)),i}__onEnterArrow(t,n){var a,c;const r=Dn.getPosition(this.viewer.container),i={x:n.clientX-r.x,y:n.clientY-r.y};this.config.showLinkTooltip&&(this.state.currentTooltip=this.viewer.createTooltip({...WIe,left:i.x,top:i.y,box:{width:20,height:20}}),this.__getTooltipContent(t).then(o=>{o?this.state.currentTooltip.update(o):this.__hideTooltip()})),(a=this.map)==null||a.setActiveHotspot(gm+t.nodeId),(c=this.plan)==null||c.setActiveHotspot(gm+t.nodeId),this.dispatchEvent(new VW(t,this.state.currentNode))}__onHoverArrow(t){var i;const n=Dn.getPosition(this.viewer.container),r={x:t.clientX-n.x,y:t.clientY-n.y};(i=this.state.currentTooltip)==null||i.move({left:r.x,top:r.y})}__onLeaveArrow(t){var n,r;this.__hideTooltip(),(n=this.map)==null||n.setActiveHotspot(null),(r=this.plan)==null||r.setActiveHotspot(null),this.dispatchEvent(new GW(t,this.state.currentNode))}__hideTooltip(){var t;(t=this.state.currentTooltip)==null||t.hide(),this.state.currentTooltip=null}__preload(t){this.config.preload&&(this.state.preload[t.id]=!0,this.state.currentNode.links.filter(n=>!this.state.preload[n.nodeId]).filter(n=>typeof this.config.preload=="function"?this.config.preload(this.state.currentNode,n):!0).forEach(n=>{this.state.preload[n.nodeId]=this.datasource.loadNode(n.nodeId).then(r=>this.viewer.textureLoader.preloadPanorama(r.panorama)).then(()=>{this.state.preload[n.nodeId]=!0}).catch(()=>{delete this.state.preload[n.nodeId]})}))}__addNodeMarkers(t){t.markers&&(this.markers?this.markers.setMarkers(t.markers.map(n=>{var r,i;return n.gps&&this.isGps&&(n.position=f6(t.gps,n.gps),(r=n.data)!=null&&r.map&&Object.assign(n.data.map,this.__getGpsMapPosition(n.gps)),(i=n.data)!=null&&i.plan&&(n.data.plan.coordinates=n.gps)),n})):Dn.logWarn(`Node ${t.id} markers ignored because the plugin is not loaded.`))}__getNodeMapPosition(t){const n=this.__getGpsMapPosition(t.gps);return n||(t.map?{x:t.map.x,y:t.map.y}:null)}__getGpsMapPosition(t){const n=this.config.map;return this.isGps&&n&&n.extent&&n.size?{x:mr.mapLinear(t[0],n.extent[0],n.extent[2],0,n.size.width),y:mr.mapLinear(t[1],n.extent[1],n.extent[3],0,n.size.height)}:null}};bx.id="virtual-tour";bx.VERSION="5.13.4";bx.configParser=gk;bx.readonlyOptions=Object.keys(gk.defaults);var m6=bx;const hf=[{id:"0",point:[-92.12572989672026,38.53421432713342]},{id:"1",point:[-92.12304341293509,38.53672723512331]},{id:"2",point:[-92.11945284530871,38.54133496582979]},{id:"3",point:[-92.11576785749503,38.54478606247235]},{id:"4",point:[-92.10778464530942,38.544770729312454]},{id:"5",point:[-92.10258732764407,38.541357585467786]},{id:"6",point:[-92.09670854574377,38.53854148846571]},{id:"7",point:[-92.09328790813723,38.53629576427041]},{id:"8",point:[-92.11176575050796,38.5479069429093]}],QIe={id:"marker-viewpoint",image:"map-icons/viewpoint.png",gps:[-92.102043,38.54042],size:{width:32,height:32}},eRe={id:"marker-photo-trophy",image:"map-icons/photo_sight_captured.png",gps:[-92.157874,38.578638],size:{width:32,height:32}},B0=[QIe,eRe],tRe=e=>t=>({width:8192,cols:16,rows:8,baseUrl:`${e}/${t}_thumb.jpg`,tileUrl:(n,r)=>`${e}/${t}_${n}_${r}.jpg`}),nRe=e=>{const t=i=>({id:`node-${i}`,panorama:e(i),gps:hf[i].point}),n=(...i)=>i.map(a=>({nodeId:`node-${a}`}));return{positionMode:"gps",nodes:[{...t(0),links:n(1)},{...t(1),links:n(0,2)},{...t(2),links:n(1,3)},{...t(3),links:n(2,8)},{...t(4),links:n(8,5),markers:B0},{...t(5),links:n(4,6),markers:B0},{...t(6),links:n(5,7),markers:B0},{...t(7),links:n(6),markers:B0},{...t(8),links:n(3,4),markers:B0}]}},rRe=e=>{const t=$.useRef(null),n=$.useRef(null),r=$.useRef(null),i=tRe(e.pixelRootUrl),a=nRe(i),c=(g,_)=>Qn(r.current).setRotation(_/Math.PI*180),o=({node:g})=>{const[_,x]=Qn(g.gps),M=[_,x];Qn(t.current).panTo(M),Qn(r.current).setLngLat(M)},f=()=>{const g=Qn(n.current);Qn(g.getPlugin(m6)).addEventListener("node-changed",o)};return $.useEffect(()=>{document.title="ATS Street View Proof of Concept"}),ee.jsxs(ee.Fragment,{children:[ee.jsx(fk,{ref:n,adapter:eW,plugins:[m6.withConfig(a),zIe],src:i(0),height:"100vh",width:"100%",navbar:!1,moveInertia:.9,onPositionChange:c,onReady:f}),ee.jsx("div",{className:"credits",children:"Game data and images  SCS Software. Images captured by Trucker Mudgeon."}),ee.jsxs(s2,{ref:t,style:{position:"absolute",left:20,bottom:20,width:"250px",height:"125px",border:"2px solid black",borderRadius:8,zIndex:100},minZoom:4,maxZoom:15,maxBounds:[hf[0].point.map(g=>g-1),hf[0].point.map(g=>g+1)],mapStyle:c2,attributionControl:!1,initialViewState:{longitude:hf[0].point[0],latitude:hf[0].point[1],zoom:12},children:[ee.jsx(fL,{ref:r,longitude:hf[0].point[0],latitude:hf[0].point[1],rotationAlignment:"map",children:ee.jsx("div",{className:"street-view-marker"})}),ee.jsx(l2,{tileRootUrl:e.tileRootUrl,mode:"light"}),ee.jsx(Ag,{tileRootUrl:e.tileRootUrl,game:"ats",mode:"light",enableIconAutoHide:!0,visibleIcons:Hh,dlcs:Nf})]})]})},_P="https://maps.truckermudgeon.com",g6="https://pixels.truckermudgeon.com",iRe=Fce(dce([ee.jsx(nw,{path:"/",element:ee.jsx(WAe,{tileRootUrl:_P,pixelRootUrl:g6})}),ee.jsx(nw,{path:"routes",element:ee.jsx(sIe,{tileRootUrl:_P})}),ee.jsx(nw,{path:"street-view",element:ee.jsx(rRe,{tileRootUrl:_P,pixelRootUrl:g6})})])),oRe=vU({components:{JoyIconButton:{styleOverrides:{root:{backgroundColor:"var(--joy-palette-background-surface)"}}}}}),sRe=document.getElementById("root"),aRe=vV(sRe);aRe.render(ee.jsx($.StrictMode,{children:ee.jsxs(_J,{defaultMode:"system",modeStorageKey:"tm-mode",theme:oRe,children:[ee.jsx(zoe,{}),ee.jsx(Yce,{router:iRe})]})}))});export default lRe();
